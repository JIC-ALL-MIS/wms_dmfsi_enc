var a0_0x5b50dc=a0_0x1c70;function a0_0x5ea5(){var _0x25c5a7=['transfer_finished','then','catch','product_name','find','concat','findOne','secondary_unit','<!DOCTYPE\x20html>','Portuguese','add_transfer_finished','2164ZPtxsb','to_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','from_prod_level','all','$product_details._id','<strong>\x20Regards\x20</strong>','$finalize','<hr\x20class=\x22my-3\x22>','RoomAssigned','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','message','3kQfena','<tr>','/transfer_finished/preview/','status','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.bay','product_date','1790eRagsF','\x20Order\x20Number\x20:\x20','prod_name','<table\x20style=\x22width:\x20100%\x20!important;\x22>','transfer_data','abs','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','An\x20error\x20occurred.','undefined','success','body','MaxStocks_data','$product_details.production_date','findById','max','Ambient','secondary_code','error','</thead>','$product_details.rack','To_invoice','finalize','Portuguese\x20(BR)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.product_code','slice','QA\x20Warehouse','getMonth','/barcode_scanner','Spanish','$product_details.unit','language','batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','to_prod_qty','Finished\x20Goods','</tbody>','New_Qty_Converted','to_warehouse','/transfer/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.storage','get','<h5>','map','$from_warehouse','to_quantity','product','back','_id','string','\x20<>\x20','product_details','MaxStocks_data2','exports','<span\x20style=\x22float:\x20right;\x22>','$product_details.isle','unit','$product_details.pallet','$product_details.invoice','params','\x20</h2>','Rack\x202','</head><body>','8KUgOti','password','flash','from_room','note','/../public','role','/transfer_finished/view','English','</span>','image','Router','host','German','from_bay','../models/all_models','filter','padStart','English\x20(US)','/barcode_scanner3','20888080omfbga','from_room_name','/barcode_scanner2','prod_cat','maxPerUnit','Enabled','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','11wFPnng','expiry_date','from_quantity','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','errors','</tr>','to_prod_level','$product_details.primary_code','</h5>','FROZEN\x20GOODS','<h5\x20style=\x22text-align:\x20left;\x22>','Transfer\x20Mail','ToRoomAssigned','toString','id_transaction','$room','post','primary_code','redirect','/upload/','</div>','from_prod_qty','from_warehouse','$product_details.secondary_code','<tbody\x20style=\x22text-align:\x20center;\x22>','forEach','Arabic\x20(ae)','user','split','TRFF-','product_code3','save','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','to_floorlevel','2128450RLYbeo','$product_details.secondary_unit','/view/add_transfer','length','Error\x20Occurs','sendMail','$product_details.expiry_date','edit_transfer_finished','random','email','Hindi','json','$product_details.bin','Email\x20sent\x20successfully','\x20<=>\x20','3800520yuQUDZ','<h2>\x20','maxProducts','date','/view/:id','Rack\x201','production_date','logo','site_title','$date','warehouse','$product_details.maxProducts','$name','aggregate','Chinese','from_invoice','<div>','True','310514NimbId','to_invoice','getDate','express','11053035rNiYND','product_code','French','$product_details.level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product','$product_details.product_stock','product_stock','DRY\x20GOODS','bay','createTransport','log','$product_details','../middleware/auth','</body></html>','Enclosed','staff','$product_details.floorlevel','floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<html><head><title></title>','invoice','5785776FfBKjz','/CheckingWarehouse','$product.to_room_name','$product.from_room_name','An\x20error\x20occurred\x20while\x20saving\x20data.','$to_warehouse','render','/picking_list/PDF_transfer/','$product_details.product_name','$product_details.batch_code','../public/language/languages.json','$product_details.type','Arabic','getFullYear','</td>','push','to_bay'];a0_0x5ea5=function(){return _0x25c5a7;};return a0_0x5ea5();}(function(_0x42f6dc,_0x3ad057){var _0x463964=a0_0x1c70,_0xbecb8d=_0x42f6dc();while(!![]){try{var _0x17e290=parseInt(_0x463964(0x107))/0x1+-parseInt(_0x463964(0x1cd))/0x2*(-parseInt(_0x463964(0x149))/0x3)+parseInt(_0x463964(0x13d))/0x4*(parseInt(_0x463964(0x150))/0x5)+-parseInt(_0x463964(0xf5))/0x6+parseInt(_0x463964(0x10b))/0x7*(-parseInt(_0x463964(0x190))/0x8)+-parseInt(_0x463964(0x121))/0x9+-parseInt(_0x463964(0x1a4))/0xa*(-parseInt(_0x463964(0x1ab))/0xb);if(_0x17e290===_0x3ad057)break;else _0xbecb8d['push'](_0xbecb8d['shift']());}catch(_0x146193){_0xbecb8d['push'](_0xbecb8d['shift']());}}}(a0_0x5ea5,0xc3c90));function a0_0x1c70(_0x359c8a,_0x25a00c){var _0x5ea533=a0_0x5ea5();return a0_0x1c70=function(_0x1c7083,_0x5651da){_0x1c7083=_0x1c7083-0xf0;var _0x3cbfea=_0x5ea533[_0x1c7083];return _0x3cbfea;},a0_0x1c70(_0x359c8a,_0x25a00c);}const express=require(a0_0x5b50dc(0x10a)),app=express(),router=express[a0_0x5b50dc(0x19b)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x5b50dc(0x19f)),auth=require(a0_0x5b50dc(0x118)),users=require(a0_0x5b50dc(0x12b)),nodemailer=require('nodemailer');router[a0_0x5b50dc(0x17a)]('/view',auth,async(_0x391420,_0xebd7e6)=>{var _0x5f4741=a0_0x5b50dc;try{const {username:_0x14e449,email:_0x556f28,role:_0x16ec6c}=_0x391420[_0x5f4741(0x1c6)],_0xf4c130=_0x391420[_0x5f4741(0x1c6)],_0x3583ce=await profile['findOne']({'email':_0xf4c130[_0x5f4741(0x1d6)]}),_0x13167c=await master_shop[_0x5f4741(0x136)]();let _0x344205;if(_0xf4c130[_0x5f4741(0x196)]==_0x5f4741(0x11b)){const _0xa6b4b0=await staff[_0x5f4741(0x138)]({'email':_0xf4c130['email']});_0x344205=await transfers_finished[_0x5f4741(0x136)]({'from_warehouse':_0xa6b4b0[_0x5f4741(0xff)]});}else _0x344205=await transfers_finished[_0x5f4741(0x102)]([{'$unwind':_0x5f4741(0x110)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x5f4741(0xfe)},'from_warehouse':{'$first':_0x5f4741(0x17d)},'to_warehouse':{'$first':_0x5f4741(0x126)},'from_room_name':{'$addToSet':_0x5f4741(0x124)},'to_room_name':{'$addToSet':_0x5f4741(0x123)},'finalize':{'$first':_0x5f4741(0x144)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x13167c[0x0][_0x5f4741(0x16f)]==_0x5f4741(0x1a2))var _0x34ef4a=users[_0x5f4741(0x198)];else{if(_0x13167c[0x0][_0x5f4741(0x16f)]==_0x5f4741(0xf0))var _0x34ef4a=users['Hindi'];else{if(_0x13167c[0x0][_0x5f4741(0x16f)]==_0x5f4741(0x19d))var _0x34ef4a=users[_0x5f4741(0x19d)];else{if(_0x13167c[0x0][_0x5f4741(0x16f)]==_0x5f4741(0x16d))var _0x34ef4a=users['Spanish'];else{if(_0x13167c[0x0][_0x5f4741(0x16f)]==_0x5f4741(0x10d))var _0x34ef4a=users[_0x5f4741(0x10d)];else{if(_0x13167c[0x0][_0x5f4741(0x16f)]==_0x5f4741(0x166))var _0x34ef4a=users[_0x5f4741(0x13b)];else{if(_0x13167c[0x0][_0x5f4741(0x16f)]==_0x5f4741(0x103))var _0x34ef4a=users[_0x5f4741(0x103)];else{if(_0x13167c[0x0][_0x5f4741(0x16f)]=='Arabic\x20(ae)')var _0x34ef4a=users[_0x5f4741(0x12d)];}}}}}}}_0xebd7e6[_0x5f4741(0x127)](_0x5f4741(0x132),{'success':_0x391420[_0x5f4741(0x192)](_0x5f4741(0x159)),'errors':_0x391420[_0x5f4741(0x192)](_0x5f4741(0x1af)),'role':_0xf4c130,'profile':_0x3583ce,'master_shop':_0x13167c,'transfer':_0x344205,'language':_0x34ef4a});}catch(_0x226b97){console[_0x5f4741(0x116)](_0x226b97);}});async function getRandom8DigitNumber(){var _0x3001c0=a0_0x5b50dc;const _0x3ff26a=0x989680,_0x3931f7=0x5f5e0ff,_0x22b6e9=Math[_0x3001c0(0x11d)](Math[_0x3001c0(0x1d5)]()*(_0x3931f7-_0x3ff26a+0x1))+_0x3ff26a;var _0x52a596;const _0xb23383=await transfers_finished[_0x3001c0(0x138)]({'invoice':_0x3001c0(0x1c8)+_0x22b6e9});return _0xb23383&&_0xb23383['length']>0x0?_0x52a596=_0x3001c0(0x1c8)+_0x22b6e9:_0x52a596=_0x3001c0(0x1c8)+_0x22b6e9,_0x52a596;}router['get'](a0_0x5b50dc(0x1cf),auth,async(_0x678ef3,_0x519dbe)=>{var _0x26c86c=a0_0x5b50dc;try{const {username:_0xa65db0,email:_0x2af8d8,role:_0x379c3f}=_0x678ef3[_0x26c86c(0x1c6)],_0x3d417e=_0x678ef3[_0x26c86c(0x1c6)],_0x56d4c=await profile['findOne']({'email':_0x3d417e[_0x26c86c(0x1d6)]}),_0x2ea4fb=await master_shop[_0x26c86c(0x136)]();let _0x10f8fd;if(_0x3d417e['role']==_0x26c86c(0x11b)){const _0x14d6d9=await staff[_0x26c86c(0x138)]({'email':_0x3d417e[_0x26c86c(0x1d6)]});_0x10f8fd=await warehouse[_0x26c86c(0x102)]([{'$match':{'status':_0x26c86c(0x1a9),'name':_0x14d6d9[_0x26c86c(0xff)],'warehouse_category':_0x26c86c(0x173),'name':{'$ne':_0x26c86c(0x16a)}}},{'$group':{'_id':_0x26c86c(0x101),'name':{'$first':_0x26c86c(0x101)}}}]);}else _0x10f8fd=await warehouse['aggregate']([{'$match':{'status':_0x26c86c(0x1a9),'warehouse_category':_0x26c86c(0x173),'name':{'$ne':_0x26c86c(0x16a)}}},{'$group':{'_id':_0x26c86c(0x101),'name':{'$first':_0x26c86c(0x101)}}}]);const _0x21ac52=await transfers_finished[_0x26c86c(0x136)]({}),_0x4d2567=_0x21ac52['length']+0x1,_0x4a2378=_0x26c86c(0x1c8)+_0x4d2567[_0x26c86c(0x1b8)]()[_0x26c86c(0x1a1)](0x5,'0');if(_0x2ea4fb[0x0]['language']=='English\x20(US)')var _0x26ff06=users[_0x26c86c(0x198)];else{if(_0x2ea4fb[0x0][_0x26c86c(0x16f)]=='Hindi')var _0x26ff06=users[_0x26c86c(0xf0)];else{if(_0x2ea4fb[0x0]['language']=='German')var _0x26ff06=users[_0x26c86c(0x19d)];else{if(_0x2ea4fb[0x0][_0x26c86c(0x16f)]==_0x26c86c(0x16d))var _0x26ff06=users['Spanish'];else{if(_0x2ea4fb[0x0][_0x26c86c(0x16f)]==_0x26c86c(0x10d))var _0x26ff06=users[_0x26c86c(0x10d)];else{if(_0x2ea4fb[0x0][_0x26c86c(0x16f)]=='Portuguese\x20(BR)')var _0x26ff06=users['Portuguese'];else{if(_0x2ea4fb[0x0][_0x26c86c(0x16f)]==_0x26c86c(0x103))var _0x26ff06=users['Chinese'];else{if(_0x2ea4fb[0x0][_0x26c86c(0x16f)]=='Arabic\x20(ae)')var _0x26ff06=users[_0x26c86c(0x12d)];}}}}}}}const _0x4b706d=getRandom8DigitNumber();_0x4b706d['then'](_0x1eb767=>{var _0x4c80ad=_0x26c86c;_0x519dbe[_0x4c80ad(0x127)](_0x4c80ad(0x13c),{'success':_0x678ef3[_0x4c80ad(0x192)](_0x4c80ad(0x159)),'errors':_0x678ef3[_0x4c80ad(0x192)](_0x4c80ad(0x1af)),'role':_0x3d417e,'profile':_0x56d4c,'master_shop':_0x2ea4fb,'warehouse':_0x10f8fd,'language':_0x26ff06,'invoice':_0x1eb767});})[_0x26c86c(0x134)](_0x3d7116=>{var _0x18c496=_0x26c86c;_0x678ef3['flash'](_0x18c496(0x1af),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x519dbe[_0x18c496(0x1bd)](_0x18c496(0x177));});}catch(_0x2c49cc){console['log'](_0x2c49cc);}}),router['post']('/view/add_transfer',auth,async(_0x298ed6,_0x392967)=>{var _0x261e95=a0_0x5b50dc;try{const {date:_0x1c5a48,from_warehouse:_0x1fb4dd,FromRoom_name:_0x13d177,to_warehouse:_0xfa4511,ToRoom_name:_0x1a7587,prod_name:_0x108cd1,from_prod_qty:_0x559a5c,from_prod_level:_0x3156f2,from_prod_isle:_0x457178,from_prod_pallet:_0x3c796f,to_prod_qty:_0x103e0d,to_prod_level:_0x3e67e1,to_prod_isle:_0x87ed93,to_prod_pallet:_0x163403,primary_code:_0x2bdae2,secondary_code:_0xfbf29b,product_code3:_0x3f10a1,note:_0x7f537a,MaxStocks_data2:_0x1221dc,invoice:_0x5983f7,expiry_date:_0x323eaa}=_0x298ed6[_0x261e95(0x15a)];if(typeof _0x108cd1==_0x261e95(0x182))var _0x1ce30b=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x152)]],_0x42b7df=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1c0)]],_0x15c86a=[_0x298ed6[_0x261e95(0x15a)]['from_prod_level']],_0x5a530e=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x175)]],_0x420a31=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1b1)]],_0x50fdbf=[_0x298ed6['body']['primary_code']],_0x439e74=[_0x298ed6[_0x261e95(0x15a)]['secondary_code']],_0x5b6aa8=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1c9)]],_0x837c50=[_0x298ed6[_0x261e95(0x15a)]['MaxStocks_data2']],_0x4fb7c6=[_0x298ed6[_0x261e95(0x15a)]['primary_unit']],_0x5d5179=[_0x298ed6['body']['secondary_unit']],_0x28fc93=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x170)]],_0x26af48=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1ac)]],_0x35f27a=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x14f)]],_0x506c37=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x15b)]],_0x1dadd4=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1a8)]],_0x554392=[_0x298ed6[_0x261e95(0x15a)]['prod_cat']],_0x460c7e=[_0x298ed6['body'][_0x261e95(0x146)]],_0x53e606=[_0x298ed6[_0x261e95(0x15a)]['ToRoomAssigned']],_0x485d99=[_0x298ed6['body']['from_invoice']],_0x18a9d1=[_0x298ed6['body'][_0x261e95(0x108)]],_0x33ff76=[_0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1b9)]];else var _0x1ce30b=[..._0x298ed6[_0x261e95(0x15a)][_0x261e95(0x152)]],_0x42b7df=[..._0x298ed6['body'][_0x261e95(0x1c0)]],_0x15c86a=[..._0x298ed6[_0x261e95(0x15a)][_0x261e95(0x140)]],_0x5a530e=[..._0x298ed6[_0x261e95(0x15a)]['New_Qty_Converted']],_0x420a31=[..._0x298ed6[_0x261e95(0x15a)]['to_prod_level']],_0x50fdbf=[..._0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1bc)]],_0x439e74=[..._0x298ed6[_0x261e95(0x15a)]['secondary_code']],_0x5b6aa8=[..._0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1c9)]],_0x837c50=[..._0x298ed6[_0x261e95(0x15a)][_0x261e95(0x185)]],_0x4fb7c6=[..._0x298ed6['body']['primary_unit']],_0x5d5179=[..._0x298ed6[_0x261e95(0x15a)]['secondary_unit']],_0x28fc93=[..._0x298ed6['body'][_0x261e95(0x170)]],_0x26af48=[..._0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1ac)]],_0x35f27a=[..._0x298ed6[_0x261e95(0x15a)][_0x261e95(0x14f)]],_0x506c37=[..._0x298ed6[_0x261e95(0x15a)]['MaxStocks_data']],_0x1dadd4=[..._0x298ed6['body'][_0x261e95(0x1a8)]],_0x554392=[..._0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1a7)]],_0x460c7e=[..._0x298ed6[_0x261e95(0x15a)]['RoomAssigned']],_0x53e606=[..._0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1b7)]],_0x485d99=[..._0x298ed6['body'][_0x261e95(0x104)]],_0x18a9d1=[..._0x298ed6[_0x261e95(0x15a)]['to_invoice']],_0x33ff76=[..._0x298ed6[_0x261e95(0x15a)][_0x261e95(0x1b9)]];const _0x2f862d=_0x1ce30b[_0x261e95(0x17c)](_0x231ae2=>{return _0x231ae2={'product_name':_0x231ae2};});_0x42b7df[_0x261e95(0x1c4)]((_0x2bef8f,_0x455a8d)=>{var _0x10e498=_0x261e95;_0x2f862d[_0x455a8d][_0x10e498(0x1ad)]=_0x2bef8f;}),_0x15c86a[_0x261e95(0x1c4)]((_0x579501,_0x4e6b68)=>{var _0x45b889=_0x261e95;_0x2f862d[_0x4e6b68][_0x45b889(0x19e)]=_0x579501;}),_0x33ff76[_0x261e95(0x1c4)]((_0x5aae26,_0x2fb20b)=>{_0x2f862d[_0x2fb20b]['id_transaction']=_0x5aae26;}),_0x485d99[_0x261e95(0x1c4)]((_0x45456e,_0x30b0fd)=>{var _0x474fa9=_0x261e95;_0x2f862d[_0x30b0fd][_0x474fa9(0x104)]=_0x45456e;}),_0x18a9d1[_0x261e95(0x1c4)]((_0x2530ea,_0x37b571)=>{var _0x285f83=_0x261e95;_0x2f862d[_0x37b571][_0x285f83(0x164)]=_0x2530ea;}),_0x5a530e[_0x261e95(0x1c4)]((_0x22f66f,_0x4431c5)=>{var _0x5ce38c=_0x261e95;_0x2f862d[_0x4431c5][_0x5ce38c(0x17e)]=_0x22f66f;}),_0x420a31[_0x261e95(0x1c4)]((_0x2205f5,_0x524e13)=>{_0x2f862d[_0x524e13]['to_bay']=_0x2205f5;}),_0x50fdbf[_0x261e95(0x1c4)]((_0x3279f3,_0x2947c6)=>{_0x2f862d[_0x2947c6]['primary_code']=_0x3279f3;}),_0x439e74[_0x261e95(0x1c4)]((_0x536252,_0x39b17c)=>{var _0x230530=_0x261e95;_0x2f862d[_0x39b17c][_0x230530(0x160)]=_0x536252;}),_0x5b6aa8[_0x261e95(0x1c4)]((_0x3b7d9,_0x11c8fe)=>{_0x2f862d[_0x11c8fe]['product_code']=_0x3b7d9;}),_0x837c50['forEach']((_0x1af535,_0x41f655)=>{var _0x4791f9=_0x261e95;_0x2f862d[_0x41f655][_0x4791f9(0xf7)]=_0x1af535;}),_0x4fb7c6['forEach']((_0x4fa4e4,_0x153b96)=>{var _0x3ab068=_0x261e95;_0x2f862d[_0x153b96][_0x3ab068(0x189)]=_0x4fa4e4;}),_0x5d5179[_0x261e95(0x1c4)]((_0x5c513a,_0x4c653e)=>{var _0x167d92=_0x261e95;_0x2f862d[_0x4c653e][_0x167d92(0x139)]=_0x5c513a;}),_0x28fc93['forEach']((_0x478e18,_0x1ba549)=>{_0x2f862d[_0x1ba549]['batch_code']=_0x478e18;}),_0x26af48['forEach']((_0x2bc716,_0x5e0126)=>{var _0x37de5b=_0x261e95;_0x2f862d[_0x5e0126][_0x37de5b(0x1ac)]=_0x2bc716;}),_0x35f27a[_0x261e95(0x1c4)]((_0xefedeb,_0x51f464)=>{var _0x1ab621=_0x261e95;_0x2f862d[_0x51f464][_0x1ab621(0xfb)]=_0xefedeb;}),_0x506c37[_0x261e95(0x1c4)]((_0x33672c,_0x1eece3)=>{var _0x3c9e04=_0x261e95;_0x2f862d[_0x1eece3][_0x3c9e04(0xf7)]=_0x33672c;}),_0x1dadd4[_0x261e95(0x1c4)]((_0x4f071d,_0x5e712b)=>{var _0x587d32=_0x261e95;_0x2f862d[_0x5e712b][_0x587d32(0x1a8)]=_0x4f071d;}),_0x554392[_0x261e95(0x1c4)]((_0x5b87d3,_0x4b7ccb)=>{var _0x56e8b5=_0x261e95;_0x2f862d[_0x4b7ccb][_0x56e8b5(0x1a7)]=_0x5b87d3;}),_0x460c7e[_0x261e95(0x1c4)]((_0x281fad,_0x1072a8)=>{var _0x187e30=_0x261e95;_0x2f862d[_0x1072a8][_0x187e30(0x1a5)]=_0x281fad;}),_0x53e606['forEach']((_0x3dec74,_0x4d371f)=>{var _0x296dc7=_0x261e95;_0x2f862d[_0x4d371f][_0x296dc7(0x13e)]=_0x3dec74;});const _0x213524=_0x2f862d['filter'](_0x1d16c9=>_0x1d16c9[_0x261e95(0x17e)]!=='0'&&_0x1d16c9['to_quantity']!==''||_0x1d16c9['to_floorlevel']!=='0'&&_0x1d16c9[_0x261e95(0x1cc)]!=='');var _0x2c8520=0x0;_0x213524[_0x261e95(0x1c4)](_0x1c689e=>{var _0x4f9559=_0x261e95;parseInt(_0x1c689e['from_quantity'])<parseInt(_0x1c689e[_0x4f9559(0x17e)])&&_0x2c8520++;});if(_0x2c8520!=0x0)return _0x298ed6[_0x261e95(0x192)](_0x261e95(0x1af),_0x261e95(0x1cb)),_0x392967[_0x261e95(0x1bd)](_0x261e95(0x180));const _0x3e79a2=new transfers_finished({'date':_0x1c5a48,'from_warehouse':_0x1fb4dd,'to_warehouse':_0xfa4511,'product':_0x213524,'note':_0x7f537a,'invoice':_0x5983f7}),_0x37e2f6=await _0x3e79a2[_0x261e95(0x1ca)]();_0x298ed6[_0x261e95(0x192)]('success','Product\x20Transfer\x20successfully'),_0x392967[_0x261e95(0x1bd)](_0x261e95(0x14b)+_0x37e2f6['_id']);}catch(_0x3d4851){console['log'](_0x3d4851),_0x392967[_0x261e95(0x14c)](0xc8)[_0x261e95(0xf1)]({'errorMessage':_0x3d4851[_0x261e95(0x148)]});}}),router[a0_0x5b50dc(0x17a)]('/preview/:id',auth,async(_0x496a16,_0x3a25ce)=>{var _0x4c2678=a0_0x5b50dc;try{const {username:_0x35cf25,email:_0x9ecbec,role:_0x176d85}=_0x496a16[_0x4c2678(0x1c6)],_0x3b0ba0=_0x496a16[_0x4c2678(0x1c6)],_0x479642=await profile[_0x4c2678(0x138)]({'email':_0x3b0ba0[_0x4c2678(0x1d6)]}),_0x33f439=await master_shop[_0x4c2678(0x136)](),_0x2d92d2=await transfers_finished[_0x4c2678(0x15d)](_0x496a16[_0x4c2678(0x18c)]['id']);let _0x13368e;if(_0x3b0ba0[_0x4c2678(0x196)]==_0x4c2678(0x11b)){const _0x206945=await staff[_0x4c2678(0x138)]({'email':_0x3b0ba0[_0x4c2678(0x1d6)]});_0x13368e=await warehouse['find']({'status':_0x4c2678(0x1a9),'name':_0x206945[_0x4c2678(0xff)],'warehouse_category':_0x4c2678(0x173)});}else _0x13368e=await warehouse[_0x4c2678(0x136)]({'status':_0x4c2678(0x1a9),'warehouse_category':_0x4c2678(0x173)});const _0x1c6fb9=await warehouse[_0x4c2678(0x102)]([{'$match':{'name':_0x2d92d2['from_warehouse'],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x4c2678(0x117)},{'$group':{'_id':_0x4c2678(0x142),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4c2678(0x14e)},'bin':{'$first':_0x4c2678(0xf2)},'type':{'$first':_0x4c2678(0x12c)},'floorlevel':{'$first':_0x4c2678(0x11c)},'primary_code':{'$first':_0x4c2678(0x1b2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4c2678(0x168)},'storage':{'$first':_0x4c2678(0x179)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x4c2678(0x1ba)},'warehoue_name':{'$first':_0x4c2678(0x101)}}}]),_0x45baad=await product[_0x4c2678(0x136)]({});if(_0x33f439[0x0]['language']==_0x4c2678(0x1a2)){var _0x46ef79=users[_0x4c2678(0x198)];console[_0x4c2678(0x116)](_0x46ef79);}else{if(_0x33f439[0x0][_0x4c2678(0x16f)]==_0x4c2678(0xf0))var _0x46ef79=users[_0x4c2678(0xf0)];else{if(_0x33f439[0x0][_0x4c2678(0x16f)]==_0x4c2678(0x19d))var _0x46ef79=users[_0x4c2678(0x19d)];else{if(_0x33f439[0x0][_0x4c2678(0x16f)]=='Spanish')var _0x46ef79=users['Spanish'];else{if(_0x33f439[0x0]['language']=='French')var _0x46ef79=users[_0x4c2678(0x10d)];else{if(_0x33f439[0x0]['language']=='Portuguese\x20(BR)')var _0x46ef79=users[_0x4c2678(0x13b)];else{if(_0x33f439[0x0]['language']=='Chinese')var _0x46ef79=users[_0x4c2678(0x103)];else{if(_0x33f439[0x0][_0x4c2678(0x16f)]=='Arabic\x20(ae)')var _0x46ef79=users[_0x4c2678(0x12d)];}}}}}}}_0x3a25ce[_0x4c2678(0x127)]('edit_transfer_finished_view',{'success':_0x496a16[_0x4c2678(0x192)](_0x4c2678(0x159)),'errors':_0x496a16[_0x4c2678(0x192)](_0x4c2678(0x1af)),'role':_0x3b0ba0,'profile':_0x479642,'master_shop':_0x33f439,'warehouse':_0x13368e,'transfer':_0x2d92d2,'stock':_0x1c6fb9,'unit':_0x45baad,'language':_0x46ef79});}catch(_0x27953d){console[_0x4c2678(0x116)](_0x27953d);}}),router[a0_0x5b50dc(0x1bb)]('/preview/:id',auth,async(_0x4184a8,_0x18b35c)=>{var _0xd32c2d=a0_0x5b50dc;try{const {invoice:_0x197561,from_warehouse:_0x4ddd33,FromRoom_name:_0xdc130e,to_warehouse:_0x4832f4,ToRoom_name:_0x557852}=_0x4184a8['body'],_0x5aba34=await transfers_finished['findById'](_0x4184a8['params']['id']),_0xeee9f4=_0x5aba34[_0xd32c2d(0x17f)][_0xd32c2d(0x17c)](async _0x46a7c1=>{var _0xbf4124=_0xd32c2d;if(_0x46a7c1['to_quantity']>0x0){var _0x1f6877=await warehouse['findOne']({'name':_0x4ddd33,'room':_0x46a7c1[_0xbf4124(0x1a5)],'warehouse_category':_0xbf4124(0x173)});const _0x53553b=_0x1f6877[_0xbf4124(0x184)][_0xbf4124(0x17c)](_0x21c9ed=>{var _0x4f2cfb=_0xbf4124;_0x21c9ed[_0x4f2cfb(0x135)]==_0x46a7c1[_0x4f2cfb(0x135)]&&_0x21c9ed['bay']==_0x46a7c1[_0x4f2cfb(0x19e)]&&_0x21c9ed[_0x4f2cfb(0x1ac)]==_0x46a7c1['expiry_date']&&_0x21c9ed[_0x4f2cfb(0xfb)]==_0x46a7c1[_0x4f2cfb(0xfb)]&&_0x21c9ed[_0x4f2cfb(0x170)]==_0x46a7c1[_0x4f2cfb(0x170)]&&_0x21c9ed['invoice']==_0x46a7c1[_0x4f2cfb(0x104)]&&(console[_0x4f2cfb(0x116)]('here1',_0x21c9ed[_0x4f2cfb(0x112)]),typeof _0x46a7c1['id_transaction']==_0x4f2cfb(0x158)?_0x21c9ed['product_stock']=Math[_0x4f2cfb(0x15e)](0x0,Math[_0x4f2cfb(0x155)](_0x21c9ed['product_stock'])-Math[_0x4f2cfb(0x155)](_0x46a7c1['to_quantity'])):_0x21c9ed['product_stock']=Math[_0x4f2cfb(0x15e)](0x0,Math[_0x4f2cfb(0x155)](_0x21c9ed[_0x4f2cfb(0x112)])-Math[_0x4f2cfb(0x155)](_0x46a7c1[_0x4f2cfb(0x17e)])));});}return _0x1f6877;});Promise[_0xd32c2d(0x141)](_0xeee9f4)['then'](async _0x41d444=>{var _0x923fd0=_0xd32c2d;try{for(const _0x40d80f of _0x41d444){await _0x40d80f[_0x923fd0(0x1ca)]();}const _0x585483=_0x5aba34[_0x923fd0(0x17f)][_0x923fd0(0x17c)](async _0x3f80b3=>{var _0xf025f=_0x923fd0,_0x1838af=await warehouse[_0xf025f(0x138)]({'name':_0x4832f4,'room':_0x3f80b3['to_room_name']});if(_0x3f80b3[_0xf025f(0x17e)]>0x0){var _0x903a63=0x0;const _0x220874=_0x1838af['product_details'][_0xf025f(0x17c)](_0x53ddbe=>{var _0x3fee5d=_0xf025f;_0x53ddbe[_0x3fee5d(0x135)]==_0x3f80b3['product_name']&&_0x53ddbe[_0x3fee5d(0x114)]==_0x3f80b3[_0x3fee5d(0x131)]&&_0x53ddbe[_0x3fee5d(0x1ac)]==_0x3f80b3['expiry_date']&&_0x53ddbe[_0x3fee5d(0xfb)]==_0x3f80b3[_0x3fee5d(0xfb)]&&_0x53ddbe[_0x3fee5d(0x170)]==_0x3f80b3[_0x3fee5d(0x170)]&&_0x53ddbe[_0x3fee5d(0x120)]==_0x3f80b3[_0x3fee5d(0x164)]&&(typeof _0x3f80b3[_0x3fee5d(0x1b9)]=='undefined'?(console[_0x3fee5d(0x116)]('here2',_0x53ddbe[_0x3fee5d(0x112)]+_0x3fee5d(0x183)+_0x53ddbe['_id']+_0x3fee5d(0xf4)+Math[_0x3fee5d(0x155)](_0x53ddbe[_0x3fee5d(0x112)])+Math['abs'](_0x3f80b3[_0x3fee5d(0x17e)])),_0x53ddbe[_0x3fee5d(0x112)]=Math[_0x3fee5d(0x155)](_0x53ddbe[_0x3fee5d(0x112)])+Math[_0x3fee5d(0x155)](_0x3f80b3[_0x3fee5d(0x17e)])):_0x53ddbe[_0x3fee5d(0x112)]=Math[_0x3fee5d(0x155)](_0x53ddbe[_0x3fee5d(0x112)])+Math[_0x3fee5d(0x155)](_0x3f80b3[_0x3fee5d(0x17e)]),_0x903a63++);});_0x903a63=='0'&&(_0x1838af['product_details']=_0x1838af[_0xf025f(0x184)][_0xf025f(0x137)]({'product_name':_0x3f80b3[_0xf025f(0x135)],'product_stock':_0x3f80b3[_0xf025f(0x17e)],'bay':_0x3f80b3[_0xf025f(0x131)],'product_code':_0x3f80b3[_0xf025f(0x10c)],'primary_code':_0x3f80b3[_0xf025f(0x1bc)],'secondary_code':_0x3f80b3['secondary_code'],'expiry_date':_0x3f80b3[_0xf025f(0x1ac)],'production_date':_0x3f80b3[_0xf025f(0xfb)],'maxProducts':_0x3f80b3[_0xf025f(0xf7)],'batch_code':_0x3f80b3['batch_code'],'secondary_unit':_0x3f80b3[_0xf025f(0x139)],'unit':_0x3f80b3[_0xf025f(0x189)],'maxProducts':_0x3f80b3['maxProducts'],'maxPerUnit':_0x3f80b3[_0xf025f(0x1a8)],'invoice':_0x3f80b3[_0xf025f(0x164)]}));}return _0x1838af;});Promise[_0x923fd0(0x141)](_0x585483)[_0x923fd0(0x133)](async _0x43821a=>{var _0x7326fd=_0x923fd0;try{for(const _0x4cd48f of _0x43821a){await warehouse['updateOne']({'_id':_0x4cd48f['_id']},{'$addToSet':{'product_details':{'$each':_0x4cd48f['product_details']}}});}_0x5aba34[_0x7326fd(0x165)]=_0x7326fd(0x106);const _0xde82e5=await _0x5aba34[_0x7326fd(0x1ca)](),_0x498afb=await master_shop[_0x7326fd(0x136)](),_0x8f99e=await email_settings[_0x7326fd(0x138)](),_0x38cd39=await supervisor_settings[_0x7326fd(0x136)]();var _0x1414b1=_0x5aba34['product'],_0x496960='',_0x3220f0;for(_0x3220f0 in _0x1414b1){var _0x4c990d='FG';_0x5aba34[_0x7326fd(0x176)]==_0x7326fd(0x113)&&(_0x4c990d='DG'),_0x496960+=_0x7326fd(0x14a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1414b1[_0x3220f0][_0x7326fd(0x135)]+_0x7326fd(0x12f)+_0x7326fd(0x147)+_0x1414b1[_0x3220f0][_0x7326fd(0x10c)]+_0x7326fd(0x12f)+_0x7326fd(0x147)+_0x1414b1[_0x3220f0][_0x7326fd(0x17e)]+_0x7326fd(0x12f)+_0x7326fd(0x147)+_0x1414b1[_0x3220f0][_0x7326fd(0x189)]+_0x7326fd(0x12f)+_0x7326fd(0x147)+_0x1414b1[_0x3220f0][_0x7326fd(0x139)]+_0x7326fd(0x12f)+_0x7326fd(0x147)+_0x5aba34['to_warehouse']+_0x7326fd(0x12f)+_0x7326fd(0x147)+_0x1414b1[_0x3220f0][_0x7326fd(0x13e)]+_0x7326fd(0x12f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4c990d+_0x1414b1[_0x3220f0][_0x7326fd(0x131)]+_0x7326fd(0x12f)+_0x7326fd(0x1b0);}let _0x193074=nodemailer[_0x7326fd(0x115)]({'host':_0x8f99e[_0x7326fd(0x19c)],'port':Number(_0x8f99e['port']),'secure':![],'auth':{'user':_0x8f99e['email'],'pass':_0x8f99e[_0x7326fd(0x191)]}}),_0x37e8ad={'from':_0x8f99e[_0x7326fd(0x1d6)],'to':_0x38cd39[0x0]['FGSEmail'],'subject':_0x7326fd(0x1b6),'attachments':[{'filename':'Logo.png','path':__dirname+_0x7326fd(0x195)+_0x7326fd(0x1be)+_0x498afb[0x0][_0x7326fd(0x19a)],'cid':_0x7326fd(0xfc)}],'html':_0x7326fd(0x13a)+_0x7326fd(0x11f)+_0x7326fd(0x18f)+_0x7326fd(0x105)+_0x7326fd(0x1ae)+_0x7326fd(0x105)+_0x7326fd(0x156)+'</div>'+'<div>'+_0x7326fd(0xf6)+_0x498afb[0x0][_0x7326fd(0xfd)]+_0x7326fd(0x18d)+_0x7326fd(0x1bf)+_0x7326fd(0x1bf)+_0x7326fd(0x145)+_0x7326fd(0x105)+_0x7326fd(0x1b5)+_0x7326fd(0x151)+_0x5aba34['invoice']+'\x20'+_0x7326fd(0x187)+'\x20Order\x20Date\x20:\x20'+_0x5aba34['date']+'\x20'+_0x7326fd(0x199)+_0x7326fd(0x1b3)+'</div>'+_0x7326fd(0x153)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x7326fd(0x14a)+_0x7326fd(0x1aa)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x7326fd(0x171)+_0x7326fd(0x178)+_0x7326fd(0x13f)+_0x7326fd(0x167)+_0x7326fd(0x11e)+_0x7326fd(0x10f)+_0x7326fd(0x1b0)+_0x7326fd(0x162)+_0x7326fd(0x1c3)+'\x20'+_0x496960+'\x20'+_0x7326fd(0x174)+'</table>'+'<div>'+_0x7326fd(0x143)+_0x7326fd(0x17b)+_0x498afb[0x0][_0x7326fd(0xfd)]+'</h5>'+_0x7326fd(0x1bf)+_0x7326fd(0x1bf)+_0x7326fd(0x119)};_0x193074[_0x7326fd(0x1d2)](_0x37e8ad,function(_0x4dff71,_0x3cdf79){var _0x1b5fb6=_0x7326fd;_0x4dff71?(console[_0x1b5fb6(0x116)](_0x4dff71),console[_0x1b5fb6(0x116)](_0x1b5fb6(0x1d1))):console[_0x1b5fb6(0x116)](_0x1b5fb6(0xf3));}),_0x4184a8[_0x7326fd(0x192)]('success','Transfer\x20Finalize\x20Successfully'),_0x18b35c[_0x7326fd(0x1bd)](_0x7326fd(0x128)+_0xde82e5[_0x7326fd(0x181)]);}catch(_0x336259){console['error'](_0x336259),_0x18b35c[_0x7326fd(0x14c)](0x1f4)[_0x7326fd(0xf1)]({'error':_0x7326fd(0x14d)});}})[_0x923fd0(0x134)](_0x27511d=>{var _0x28d530=_0x923fd0;console['error'](_0x27511d),_0x18b35c[_0x28d530(0x14c)](0x1f4)['json']({'error':_0x28d530(0x157)});});}catch(_0x390ef3){console[_0x923fd0(0x161)](_0x390ef3),_0x18b35c[_0x923fd0(0x14c)](0x1f4)[_0x923fd0(0xf1)]({'error':_0x923fd0(0x125)});}})['catch'](_0x402abe=>{var _0x13c18c=_0xd32c2d;console[_0x13c18c(0x161)](_0x402abe),_0x18b35c['status'](0x1f4)[_0x13c18c(0xf1)]({'error':_0x13c18c(0x157)});});}catch(_0x546a31){_0x18b35c[_0xd32c2d(0xf1)]({'message':_0x546a31[_0xd32c2d(0x148)]});}});function BayBinSelected(_0x39269e,_0x278359){var _0x57f538=a0_0x5b50dc,_0x2ff355=[];let _0x185a28=[];var _0x30a63e=[];if(_0x39269e==_0x57f538(0x113)){switch(_0x278359){case _0x57f538(0xfa):_0x2ff355=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x57f538(0x18e):_0x2ff355=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x30a63e=['DG'];}else{if(_0x39269e==_0x57f538(0x1b4)){switch(_0x278359){case'Rack\x201':_0x2ff355=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x57f538(0x18e):_0x2ff355=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x30a63e=['FG'];}}return{'levels':_0x2ff355,'identify':_0x30a63e};}router[a0_0x5b50dc(0x17a)](a0_0x5b50dc(0xf9),auth,async(_0x35ee07,_0x3909e2)=>{var _0x44875a=a0_0x5b50dc;try{const {username:_0x114dff,email:_0x50b9ab,role:_0x3ea0af}=_0x35ee07[_0x44875a(0x1c6)],_0x403332=_0x35ee07['user'],_0x501fea=await profile[_0x44875a(0x138)]({'email':_0x403332[_0x44875a(0x1d6)]}),_0x11fe41=await master_shop[_0x44875a(0x136)](),_0x39ff5e=await transfers_finished[_0x44875a(0x15d)](_0x35ee07[_0x44875a(0x18c)]['id']);let _0x38d3c3=new Date(_0x39ff5e['expiry_date']),_0x4c2268=('0'+_0x38d3c3[_0x44875a(0x109)]())['slice'](-0x2),_0x4e0d35=('0'+(_0x38d3c3[_0x44875a(0x16b)]()+0x1))[_0x44875a(0x169)](-0x2),_0x16e105=_0x38d3c3[_0x44875a(0x12e)](),_0x1c8586=_0x16e105+'-'+_0x4e0d35+'-'+_0x4c2268,_0x341e5a;if(_0x403332[_0x44875a(0x196)]=='staff'){const _0x1054d6=await staff[_0x44875a(0x138)]({'email':_0x403332['email']});_0x341e5a=await warehouse[_0x44875a(0x136)]({'status':_0x44875a(0x1a9),'name':_0x1054d6[_0x44875a(0xff)],'warehouse_category':_0x44875a(0x173)});}else _0x341e5a=await warehouse[_0x44875a(0x136)]({'status':_0x44875a(0x1a9),'warehouse_category':'Finished\x20Goods'});const _0x3779b7=await warehouse['aggregate']([{'$match':{'name':_0x39ff5e[_0x44875a(0x1c1)],'room':_0x39ff5e[_0x44875a(0x193)]}},{'$unwind':_0x44875a(0x117)},{'$group':{'_id':_0x44875a(0x142),'name':{'$first':_0x44875a(0x129)},'product_stock':{'$first':_0x44875a(0x111)},'bay':{'$first':_0x44875a(0x14e)},'bin':{'$first':_0x44875a(0xf2)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x44875a(0x11c)},'primary_code':{'$first':_0x44875a(0x1b2)},'secondary_code':{'$first':_0x44875a(0x1c2)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x44875a(0x179)},'rack':{'$first':_0x44875a(0x163)}}}]);var _0x3e9467=[0x1,0x2,0x3,0x4],_0x1446b4=['A','B','C','D','E','F','G','H','I','J'],_0x94f763=[_0x44875a(0x15f),_0x44875a(0x11a)];const _0x50cd41=await product[_0x44875a(0x136)]({}),_0x5addc1=BayBinSelected(_0x39ff5e[_0x44875a(0x176)],_0x39ff5e['to_room']);if(_0x11fe41[0x0][_0x44875a(0x16f)]==_0x44875a(0x1a2)){var _0x55b7eb=users[_0x44875a(0x198)];console[_0x44875a(0x116)](_0x55b7eb);}else{if(_0x11fe41[0x0][_0x44875a(0x16f)]==_0x44875a(0xf0))var _0x55b7eb=users[_0x44875a(0xf0)];else{if(_0x11fe41[0x0][_0x44875a(0x16f)]=='German')var _0x55b7eb=users[_0x44875a(0x19d)];else{if(_0x11fe41[0x0][_0x44875a(0x16f)]=='Spanish')var _0x55b7eb=users[_0x44875a(0x16d)];else{if(_0x11fe41[0x0][_0x44875a(0x16f)]==_0x44875a(0x10d))var _0x55b7eb=users['French'];else{if(_0x11fe41[0x0]['language']=='Portuguese\x20(BR)')var _0x55b7eb=users['Portuguese'];else{if(_0x11fe41[0x0][_0x44875a(0x16f)]==_0x44875a(0x103))var _0x55b7eb=users[_0x44875a(0x103)];else{if(_0x11fe41[0x0][_0x44875a(0x16f)]==_0x44875a(0x1c5))var _0x55b7eb=users[_0x44875a(0x12d)];}}}}}}}_0x3909e2[_0x44875a(0x127)](_0x44875a(0x1d4),{'success':_0x35ee07[_0x44875a(0x192)](_0x44875a(0x159)),'errors':_0x35ee07[_0x44875a(0x192)](_0x44875a(0x1af)),'role':_0x403332,'profile':_0x501fea,'master_shop':_0x11fe41,'warehouse':_0x341e5a,'transfer':_0x39ff5e,'stock':_0x3779b7,'unit':_0x50cd41,'language':_0x55b7eb,'levels':_0x3e9467,'Isle':_0x1446b4,'rooms_data':_0x94f763,'ed_fullDate':_0x1c8586,'dataSelected':_0x5addc1});}catch(_0x591fe3){console['log'](_0x591fe3);}}),router['post'](a0_0x5b50dc(0xf9),auth,async(_0x22d3a1,_0x4e6fd0)=>{var _0x1be536=a0_0x5b50dc;try{const _0x108476=_0x22d3a1[_0x1be536(0x18c)]['id'];console[_0x1be536(0x116)](_0x22d3a1[_0x1be536(0x15a)]);const _0x278cc9=await transfers_finished[_0x1be536(0x15d)](_0x108476);console[_0x1be536(0x116)](_0x1be536(0x154),_0x278cc9);const {date:_0x2d7daa,from_warehouse:_0x5611a6,FromRoom_name:_0x489fef,to_warehouse:_0x30df0c,ToRoom_name:_0x4f8171,prod_name:_0x2d11a3,from_prod_qty:_0x20f9d0,from_prod_level:_0x3f5d5d,from_prod_isle:_0x28b1fe,from_prod_pallet:_0x545c7d,to_prod_qty:_0x4ee891,to_prod_level:_0x2aa14d,to_prod_isle:_0x496eac,to_prod_pallet:_0x491db0,primary_code:_0xea4569,secondary_code:_0x122750,product_code3:_0x523298,note:_0x3518e5,invoice:_0x35ec0d,expiry_date:_0x4b5fd2}=_0x22d3a1[_0x1be536(0x15a)];if(typeof _0x2d11a3==_0x1be536(0x182))var _0x414101=[_0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x152)]],_0x2fd165=[_0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x1c0)]],_0x1fc1e8=[_0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x140)]],_0x2a7978=[_0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x172)]],_0x50a2bc=[_0x22d3a1['body']['to_prod_level']],_0x24f713=[_0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x1bc)]],_0x56d079=[_0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x160)]],_0x460cb9=[_0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x1c9)]],_0x206d1e=[_0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x185)]],_0x33ae60=[_0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x189)]],_0x527378=[_0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x139)]],_0x64ae53=[_0x22d3a1['body'][_0x1be536(0x170)]],_0x399c0f=[_0x22d3a1[_0x1be536(0x15a)]['expiry_date']];else var _0x414101=[..._0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x152)]],_0x2fd165=[..._0x22d3a1[_0x1be536(0x15a)]['from_prod_qty']],_0x1fc1e8=[..._0x22d3a1['body'][_0x1be536(0x140)]],_0x2a7978=[..._0x22d3a1['body']['to_prod_qty']],_0x50a2bc=[..._0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x1b1)]],_0x24f713=[..._0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x1bc)]],_0x56d079=[..._0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x160)]],_0x460cb9=[..._0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x1c9)]],_0x206d1e=[..._0x22d3a1['body'][_0x1be536(0x185)]],_0x33ae60=[..._0x22d3a1[_0x1be536(0x15a)]['unit']],_0x527378=[..._0x22d3a1[_0x1be536(0x15a)]['secondary_unit']],_0x64ae53=[..._0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x170)]],_0x399c0f=[..._0x22d3a1[_0x1be536(0x15a)][_0x1be536(0x1ac)]];const _0x46fbe9=_0x414101['map'](_0x5eb2fb=>{return _0x5eb2fb={'product_name':_0x5eb2fb};});_0x2fd165[_0x1be536(0x1c4)]((_0x45ce37,_0x387c4a)=>{_0x46fbe9[_0x387c4a]['from_quantity']=_0x45ce37;}),_0x1fc1e8[_0x1be536(0x1c4)]((_0x1c7ac1,_0x413128)=>{_0x46fbe9[_0x413128]['from_bay']=_0x1c7ac1;}),_0x2a7978[_0x1be536(0x1c4)]((_0x47d913,_0x39108d)=>{var _0x5e23e3=_0x1be536;_0x46fbe9[_0x39108d][_0x5e23e3(0x17e)]=_0x47d913;}),_0x50a2bc['forEach']((_0x210679,_0x27141b)=>{var _0x214424=_0x1be536;_0x46fbe9[_0x27141b][_0x214424(0x131)]=_0x210679;}),_0x24f713[_0x1be536(0x1c4)]((_0x358519,_0x32166e)=>{var _0x429c09=_0x1be536;_0x46fbe9[_0x32166e][_0x429c09(0x1bc)]=_0x358519;}),_0x56d079[_0x1be536(0x1c4)]((_0x3a943e,_0xead298)=>{var _0x4cea8f=_0x1be536;_0x46fbe9[_0xead298][_0x4cea8f(0x160)]=_0x3a943e;}),_0x460cb9[_0x1be536(0x1c4)]((_0x2225bc,_0x4dd228)=>{_0x46fbe9[_0x4dd228]['product_code']=_0x2225bc;}),_0x206d1e[_0x1be536(0x1c4)]((_0x2ca3a4,_0x2d65ca)=>{var _0x292f8e=_0x1be536;_0x46fbe9[_0x2d65ca][_0x292f8e(0xf7)]=_0x2ca3a4;}),_0x33ae60[_0x1be536(0x1c4)]((_0x2c66ad,_0x26aaec)=>{var _0x4302ba=_0x1be536;_0x46fbe9[_0x26aaec][_0x4302ba(0x189)]=_0x2c66ad;}),_0x527378[_0x1be536(0x1c4)]((_0x1ebf2d,_0x4ff6e8)=>{_0x46fbe9[_0x4ff6e8]['secondary_unit']=_0x1ebf2d;}),_0x64ae53[_0x1be536(0x1c4)]((_0x2d5c36,_0x12fcd3)=>{var _0x54cb9b=_0x1be536;_0x46fbe9[_0x12fcd3][_0x54cb9b(0x170)]=_0x2d5c36;}),_0x399c0f[_0x1be536(0x1c4)]((_0x516ac3,_0x20ad24)=>{_0x46fbe9[_0x20ad24]['expiry_date']=_0x516ac3;});const _0x425cf7=_0x46fbe9[_0x1be536(0x1a0)](_0x16272b=>_0x16272b[_0x1be536(0x17e)]!=='0'&&_0x16272b[_0x1be536(0x17e)]!==''||_0x16272b['to_floorlevel']!=='0'&&_0x16272b[_0x1be536(0x1cc)]!=='');var _0x26c973=0x0;_0x425cf7[_0x1be536(0x1c4)](_0x1ce64c=>{var _0x41afca=_0x1be536;parseInt(_0x1ce64c[_0x41afca(0x1ad)])<parseInt(_0x1ce64c['to_quantity'])&&_0x26c973++;});if(_0x26c973!=0x0)return _0x22d3a1['flash'](_0x1be536(0x1af),_0x1be536(0x1cb)),_0x4e6fd0[_0x1be536(0x1bd)](_0x1be536(0x180));const _0x9f48c8=await warehouse[_0x1be536(0x138)]({'name':_0x278cc9['from_warehouse'],'room':_0x278cc9[_0x1be536(0x193)]});_0x278cc9[_0x1be536(0x17f)][_0x1be536(0x1c4)](_0xa4023d=>{var _0xa01d4=_0x1be536;if(_0xa4023d[_0xa01d4(0x17e)]>0x0){const _0x595fe2=_0x9f48c8[_0xa01d4(0x184)][_0xa01d4(0x17c)](_0x1f748c=>{var _0x50e752=_0xa01d4;_0x1f748c[_0x50e752(0x135)]==_0xa4023d['product_name']&&_0x1f748c[_0x50e752(0x114)]==_0xa4023d['from_bay']&&(_0x1f748c['product_stock']=parseInt(_0x1f748c[_0x50e752(0x112)])+parseInt(_0xa4023d['to_quantity']));});}}),await _0x9f48c8[_0x1be536(0x1ca)]();const _0x47e133=await warehouse[_0x1be536(0x138)]({'name':_0x278cc9['to_warehouse'],'room':_0x278cc9['to_room']});_0x278cc9[_0x1be536(0x17f)][_0x1be536(0x1c4)](_0x13610e=>{var _0x562c6d=_0x1be536;if(_0x13610e[_0x562c6d(0x17e)]>0x0){const _0x47bc07=_0x47e133['product_details'][_0x562c6d(0x17c)](_0x94ff98=>{var _0x3e51d9=_0x562c6d;_0x94ff98['product_name']==_0x13610e[_0x3e51d9(0x135)]&&_0x94ff98[_0x3e51d9(0x114)]==_0x13610e[_0x3e51d9(0x131)]&&(_0x94ff98[_0x3e51d9(0x112)]=parseInt(_0x94ff98[_0x3e51d9(0x112)])-parseInt(_0x13610e[_0x3e51d9(0x17e)]));});}}),await _0x47e133['save'](),_0x278cc9[_0x1be536(0xf8)]=_0x2d7daa,_0x278cc9[_0x1be536(0x1c1)]=_0x5611a6,_0x278cc9[_0x1be536(0x176)]=_0x30df0c,_0x278cc9['product']=_0x425cf7,_0x278cc9[_0x1be536(0x194)]=_0x3518e5,_0x278cc9[_0x1be536(0x120)]=_0x35ec0d;const _0x9c4a67=await _0x278cc9[_0x1be536(0x1ca)](),_0x3f3c15=await warehouse[_0x1be536(0x138)]({'name':_0x5611a6,'room':_0x489fef});_0x9c4a67[_0x1be536(0x17f)][_0x1be536(0x1c4)](_0x4769a0=>{var _0x24cf39=_0x1be536;if(_0x4769a0[_0x24cf39(0x17e)]>0x0){const _0x4ba236=_0x3f3c15[_0x24cf39(0x184)]['map'](_0x3f2289=>{var _0x21303e=_0x24cf39;_0x3f2289[_0x21303e(0x135)]==_0x4769a0[_0x21303e(0x135)]&&_0x3f2289['bay']==_0x4769a0[_0x21303e(0x19e)]&&(_0x3f2289[_0x21303e(0x112)]=parseInt(_0x3f2289[_0x21303e(0x112)])-parseInt(_0x4769a0[_0x21303e(0x17e)]));});}}),await _0x3f3c15['save']();const _0x580fe0=await warehouse[_0x1be536(0x138)]({'name':_0x30df0c,'room':_0x4f8171});_0x9c4a67[_0x1be536(0x17f)][_0x1be536(0x1c4)](_0x38f6dc=>{var _0xf87adf=_0x1be536;if(_0x38f6dc[_0xf87adf(0x17e)]>0x0){var _0x47a753=0x0;const _0x15db5d=_0x580fe0['product_details'][_0xf87adf(0x17c)](_0x3d6eaf=>{var _0x402a70=_0xf87adf;_0x3d6eaf[_0x402a70(0x135)]==_0x38f6dc[_0x402a70(0x135)]&&_0x3d6eaf[_0x402a70(0x114)]==_0x38f6dc[_0x402a70(0x131)]&&(_0x3d6eaf[_0x402a70(0x112)]=parseInt(_0x3d6eaf[_0x402a70(0x112)])+parseInt(_0x38f6dc[_0x402a70(0x17e)]),_0x47a753++);});_0x47a753=='0'&&(_0x580fe0['product_details']=_0x580fe0[_0xf87adf(0x184)][_0xf87adf(0x137)]({'product_name':_0x38f6dc[_0xf87adf(0x135)],'product_stock':_0x38f6dc[_0xf87adf(0x17e)],'bay':_0x38f6dc[_0xf87adf(0x131)],'product_code':_0x38f6dc['product_code'],'primary_code':_0x38f6dc[_0xf87adf(0x1bc)],'secondary_code':_0x38f6dc[_0xf87adf(0x160)],'maxProducts':_0x38f6dc[_0xf87adf(0xf7)]}));}}),await _0x580fe0[_0x1be536(0x1ca)](),_0x22d3a1['flash'](_0x1be536(0x159),'Transfer\x20Edit\x20Successfully'),_0x4e6fd0['redirect'](_0x1be536(0x197));}catch(_0x155ba0){console[_0x1be536(0x116)](_0x155ba0);}}),router['post'](a0_0x5b50dc(0x16c),async(_0x8243bb,_0x21cc04)=>{var _0x4287b1=a0_0x5b50dc;const {FromWareHouse:_0x59c044,FromRoom:_0x220c07,ToWarehouse:_0x127e24,ToRoom:_0x19aff1,primary_code:_0x5bbea0,Roomslist:_0x28c9bc}=_0x8243bb[_0x4287b1(0x15a)],_0xe20a5b=_0x28c9bc[_0x4287b1(0x1c7)](','),_0x437ea4=[];async function _0x5e8b54(_0x589945){var _0x5b00f2=_0x4287b1;const _0x281909=await warehouse[_0x5b00f2(0x102)]([{'$match':{'name':_0x59c044,'room':_0x589945}},{'$unwind':_0x5b00f2(0x117)},{'$match':{'product_details.primary_code':_0x5bbea0}},{'$group':{'_id':_0x5b00f2(0x142),'name':{'$first':_0x5b00f2(0x129)},'instock':{'$first':_0x5b00f2(0x111)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5b00f2(0x168)},'level':{'$first':_0x5b00f2(0x14e)},'isle':{'$first':_0x5b00f2(0xf2)},'type':{'$first':_0x5b00f2(0x12c)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5b00f2(0x16e)},'secondary_unit':{'$first':_0x5b00f2(0x1ce)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5b00f2(0x15c)},'batch_code':{'$first':_0x5b00f2(0x12a)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x5b00f2(0x1ba)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x5b00f2(0x18b)}}}]),_0x4aa676=await warehouse[_0x5b00f2(0x102)]([{'$match':{'name':_0x59c044,'room':_0x589945}},{'$unwind':_0x5b00f2(0x117)},{'$match':{'product_details.secondary_code':_0x5bbea0}},{'$group':{'_id':_0x5b00f2(0x142),'name':{'$first':_0x5b00f2(0x129)},'instock':{'$first':_0x5b00f2(0x111)},'primary_code':{'$first':_0x5b00f2(0x1b2)},'secondary_code':{'$first':_0x5b00f2(0x1c2)},'product_code':{'$first':_0x5b00f2(0x168)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5b00f2(0xf2)},'type':{'$first':_0x5b00f2(0x12c)},'pallet':{'$first':_0x5b00f2(0x11c)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x5b00f2(0x179)},'rack':{'$first':_0x5b00f2(0x163)},'expiry_date':{'$first':_0x5b00f2(0x1d3)},'production_date':{'$first':_0x5b00f2(0x15c)},'batch_code':{'$first':_0x5b00f2(0x12a)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x5b00f2(0x1ba)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x5b00f2(0x18b)}}}]);if(_0x281909['length']>0x0)_0x437ea4[_0x5b00f2(0x130)](_0x281909);else _0x4aa676[_0x5b00f2(0x1d0)]>0x0&&_0x437ea4[_0x5b00f2(0x130)](_0x4aa676);}const _0x13dd8b=_0xe20a5b['map'](_0xe73031=>_0x5e8b54(_0xe73031));await Promise['all'](_0x13dd8b),_0x21cc04[_0x4287b1(0xf1)](_0x437ea4);}),router[a0_0x5b50dc(0x1bb)](a0_0x5b50dc(0x1a6),async(_0x54e5b2,_0x45bcc6)=>{var _0x34383f=a0_0x5b50dc;try{const {FromWareHouse:_0x10d064,FromRoom:_0x5ccdbf,ToWarehouse:_0x454003,ToRoom:_0x4e75d7,secondary_code:_0x399613}=_0x54e5b2['body'],_0x29dbb9=await warehouse[_0x34383f(0x102)]([{'$match':{'name':_0x10d064}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x399613}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x34383f(0x129)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x34383f(0x1c2)},'product_code':{'$first':_0x34383f(0x168)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x34383f(0x10e)},'isle':{'$first':_0x34383f(0x188)},'pallet':{'$first':_0x34383f(0x18a)},'maxProducts':{'$first':_0x34383f(0x100)},'unit':{'$first':_0x34383f(0x16e)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'}}}]);_0x45bcc6[_0x34383f(0x14c)](0xc8)['json'](_0x29dbb9);}catch(_0x5f34e7){_0x45bcc6[_0x34383f(0x14c)](0x194)[_0x34383f(0xf1)]({'message':_0x5f34e7['message']});}}),router[a0_0x5b50dc(0x1bb)](a0_0x5b50dc(0x1a3),async(_0x3894c5,_0x389c9c)=>{var _0x4a6df0=a0_0x5b50dc;try{const {FromWareHouse:_0x474b71,FromRoom:_0x56c05e,ToWarehouse:_0x4f3531,ToRoom:_0x2f8180,product_code:_0x38d7a9}=_0x3894c5['body'],_0xa97951=await warehouse['aggregate']([{'$match':{'name':_0x474b71}},{'$unwind':_0x4a6df0(0x117)},{'$match':{'product_details.product_code':_0x38d7a9}},{'$group':{'_id':_0x4a6df0(0x142),'name':{'$first':_0x4a6df0(0x129)},'primary_code':{'$first':_0x4a6df0(0x1b2)},'secondary_code':{'$first':_0x4a6df0(0x1c2)},'product_code':{'$first':_0x4a6df0(0x168)},'instock':{'$first':_0x4a6df0(0x111)},'warehouse':{'$first':_0x4a6df0(0x101)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x4a6df0(0x188)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x4a6df0(0x100)},'unit':{'$first':_0x4a6df0(0x16e)}}}]);_0x389c9c[_0x4a6df0(0x14c)](0xc8)[_0x4a6df0(0xf1)](_0xa97951);}catch(_0x2db2e0){_0x389c9c[_0x4a6df0(0x14c)](0x194)[_0x4a6df0(0xf1)]({'message':_0x2db2e0['message']});}}),router[a0_0x5b50dc(0x1bb)](a0_0x5b50dc(0x122),async(_0x334312,_0x157525)=>{var _0x58701e=a0_0x5b50dc;const {productCode:_0x5db31b,bay:_0x28f1aa,warehouses:_0x29448b,room:_0x4fd13e}=_0x334312['body'];console[_0x58701e(0x116)](_0x334312[_0x58701e(0x15a)]);try{const _0x26b60b=await warehouse['aggregate']([{'$match':{'name':_0x29448b,'room':_0x4fd13e}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x28f1aa)}},{'$group':{'_id':_0x58701e(0x142),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x58701e(0x111)},'bay':{'$first':_0x58701e(0x14e)},'maxProducts':{'$first':_0x58701e(0x100)}}}]);_0x157525['status'](0xc8)[_0x58701e(0xf1)](_0x26b60b);}catch(_0x4c19df){_0x157525[_0x58701e(0x14c)](0x194)[_0x58701e(0xf1)]({'message':_0x4c19df[_0x58701e(0x148)]});}}),module[a0_0x5b50dc(0x186)]=router;