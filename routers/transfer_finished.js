var a0_0x9a1fa8=a0_0x5e39;(function(_0x5ecc81,_0x5bd3a1){var _0x1072c4=a0_0x5e39,_0x53c838=_0x5ecc81();while(!![]){try{var _0x25cc46=-parseInt(_0x1072c4(0x16a))/0x1*(-parseInt(_0x1072c4(0x17d))/0x2)+parseInt(_0x1072c4(0x1cc))/0x3+-parseInt(_0x1072c4(0x1c2))/0x4*(-parseInt(_0x1072c4(0x1a5))/0x5)+-parseInt(_0x1072c4(0x19b))/0x6*(-parseInt(_0x1072c4(0x1d9))/0x7)+parseInt(_0x1072c4(0x1eb))/0x8+parseInt(_0x1072c4(0x1ce))/0x9*(-parseInt(_0x1072c4(0x1c1))/0xa)+-parseInt(_0x1072c4(0x1a4))/0xb;if(_0x25cc46===_0x5bd3a1)break;else _0x53c838['push'](_0x53c838['shift']());}catch(_0x2d9c17){_0x53c838['push'](_0x53c838['shift']());}}}(a0_0x1f4f,0x95daf));function a0_0x1f4f(){var _0x48a069=['find','success','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','staff','$product_details.maxProducts','German','prod_cat','Portuguese','</tr>','<html><head><title></title>','An\x20error\x20occurred\x20while\x20saving\x20data.','QA\x20Warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product.to_room_name','French','$date','MaxStocks_data2','An\x20error\x20occurred.','$product_details.secondary_code','slice','product_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Transfer\x20Edit\x20Successfully','getFullYear','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Transfer\x20Mail','production_date','<div>','toString','New_Qty_Converted','secondary_code','map','<h2>\x20','add_transfer_finished','/view','$product_details.type','floor','date','$product_details.floorlevel','product_date','params','<span\x20style=\x22float:\x20right;\x22>','/barcode_scanner3','message','Chinese','role','from_prod_level','concat','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','json','$product_details.isle','product_stock','primary_code','$product.from_room_name','finalize','4786WilvsF','length','from_room_name','</div>','Spanish','$product_details.batch_code','get','to_room_name','to_room','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$from_warehouse','save','batch_code','/picking_list/PDF_transfer/','flash','</td>','/view/:id','render','../models/all_models','146wcBopB','exports','/transfer_finished/preview/','bay','product_details','TRFF-','expiry_date','$product_details.rack','product','$product_details.production_date','findById','</span>','Enabled','redirect','../public/language/languages.json','Rack\x202','Ambient','$product_details.level','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','user','Logo.png','product_name','note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.product_stock','<h5>','to_quantity','/preview/:id','image','from_invoice','26952QjVzRZ','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','</table>','invoice','$product_details._id','string','to_prod_level','</body></html>','<!DOCTYPE\x20html>','26776123cYpbvo','680cxWKfX','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<hr\x20class=\x22my-3\x22>','FGSEmail','then','from_quantity','$product_details.product_code','post','$product_details.unit','$_id','/view/add_transfer','$product_details.invoice','English','Rack\x201','$product_details.primary_code','FROZEN\x20GOODS','sendMail','aggregate','\x20Order\x20Date\x20:\x20','</h5>','$finalize','catch','Arabic','secondary_unit','Portuguese\x20(BR)','MaxStocks_data','maxProducts','$product','147190tbVnsH','20624lXrhfQ','$product_details.secondary_unit','to_bay','Finished\x20Goods','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','from_prod_qty','padStart','ToRoomAssigned','Enclosed','RoomAssigned','1410015SOUOjN','$invoice','54mQLXeM','Hindi','$product_details.product_name','prod_name','log','Transfer\x20Finalize\x20Successfully','filter','<strong>\x20Regards\x20</strong>','$product_details.bay','$product_details.storage','warehouse','994YiyEJX','product_code3','/upload/','$room','unit','\x20</h2>','to_warehouse','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<h5\x20style=\x22text-align:\x20left;\x22>','nodemailer','errors','../middleware/auth','split','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','to_prod_qty','findOne','True','7822808BaRfSk','status','Arabic\x20(ae)','To_invoice','from_room','forEach','body','edit_transfer_finished_view','to_invoice','English\x20(US)','maxPerUnit','/../public','$name','</head><body>','DRY\x20GOODS','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.pallet','error','_id','transfer_data','primary_unit','$product_details.expiry_date','<tr>','site_title','$product_details.bin','$product_details','</tbody>','$product_details.maxPerUnit','/transfer/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','from_bay','transfer_finished','to_floorlevel','back','from_warehouse'];a0_0x1f4f=function(){return _0x48a069;};return a0_0x1f4f();}const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x9a1fa8(0x17c)),auth=require(a0_0x9a1fa8(0x1e5)),users=require(a0_0x9a1fa8(0x18b)),nodemailer=require(a0_0x9a1fa8(0x1e3));router[a0_0x9a1fa8(0x170)](a0_0x9a1fa8(0x154),auth,async(_0x19a48c,_0x2f97df)=>{var _0x4c744b=a0_0x9a1fa8;try{const {username:_0x36421d,email:_0x5a03b4,role:_0xbdbb52}=_0x19a48c[_0x4c744b(0x190)],_0x514f8a=_0x19a48c['user'],_0x317343=await profile[_0x4c744b(0x1e9)]({'email':_0x514f8a['email']}),_0x45f9ff=await master_shop[_0x4c744b(0x132)]();let _0xe4f04;if(_0x514f8a[_0x4c744b(0x15f)]==_0x4c744b(0x135)){const _0x1ea1f8=await staff[_0x4c744b(0x1e9)]({'email':_0x514f8a[_0x4c744b(0x1e0)]});_0xe4f04=await transfers_finished[_0x4c744b(0x132)]({'from_warehouse':_0x1ea1f8[_0x4c744b(0x1d8)]});}else _0xe4f04=await transfers_finished[_0x4c744b(0x1b6)]([{'$unwind':_0x4c744b(0x1c0)},{'$group':{'_id':_0x4c744b(0x1ae),'invoice':{'$first':_0x4c744b(0x1cd)},'date':{'$first':_0x4c744b(0x141)},'from_warehouse':{'$first':_0x4c744b(0x174)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x4c744b(0x168)},'to_room_name':{'$addToSet':_0x4c744b(0x13f)},'finalize':{'$first':_0x4c744b(0x1b9)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x45f9ff[0x0][_0x4c744b(0x162)]==_0x4c744b(0x1f4))var _0x3116c1=users[_0x4c744b(0x1b1)];else{if(_0x45f9ff[0x0][_0x4c744b(0x162)]=='Hindi')var _0x3116c1=users['Hindi'];else{if(_0x45f9ff[0x0][_0x4c744b(0x162)]==_0x4c744b(0x137))var _0x3116c1=users[_0x4c744b(0x137)];else{if(_0x45f9ff[0x0][_0x4c744b(0x162)]==_0x4c744b(0x16e))var _0x3116c1=users[_0x4c744b(0x16e)];else{if(_0x45f9ff[0x0]['language']==_0x4c744b(0x140))var _0x3116c1=users[_0x4c744b(0x140)];else{if(_0x45f9ff[0x0][_0x4c744b(0x162)]==_0x4c744b(0x1bd))var _0x3116c1=users[_0x4c744b(0x139)];else{if(_0x45f9ff[0x0]['language']==_0x4c744b(0x15e))var _0x3116c1=users[_0x4c744b(0x15e)];else{if(_0x45f9ff[0x0][_0x4c744b(0x162)]==_0x4c744b(0x1ed))var _0x3116c1=users[_0x4c744b(0x1bb)];}}}}}}}_0x2f97df[_0x4c744b(0x17b)](_0x4c744b(0x12e),{'success':_0x19a48c[_0x4c744b(0x178)]('success'),'errors':_0x19a48c['flash']('errors'),'role':_0x514f8a,'profile':_0x317343,'master_shop':_0x45f9ff,'transfer':_0xe4f04,'language':_0x3116c1});}catch(_0x2b01f7){console[_0x4c744b(0x1d2)](_0x2b01f7);}});async function getRandom8DigitNumber(){var _0x3e523e=a0_0x9a1fa8;const _0x52e7c8=0x989680,_0x3b2675=0x5f5e0ff,_0x1d33d4=Math[_0x3e523e(0x156)](Math['random']()*(_0x3b2675-_0x52e7c8+0x1))+_0x52e7c8;var _0x494da2;const _0x28e429=await transfers_finished[_0x3e523e(0x1e9)]({'invoice':'TRFF-'+_0x1d33d4});return _0x28e429&&_0x28e429[_0x3e523e(0x16b)]>0x0?_0x494da2=_0x3e523e(0x182)+_0x1d33d4:_0x494da2='TRFF-'+_0x1d33d4,_0x494da2;}router[a0_0x9a1fa8(0x170)](a0_0x9a1fa8(0x1af),auth,async(_0xf20fb8,_0x5f2862)=>{var _0xa577c2=a0_0x9a1fa8;try{const {username:_0x1945fc,email:_0x5b3900,role:_0x5147a3}=_0xf20fb8[_0xa577c2(0x190)],_0x267b2b=_0xf20fb8[_0xa577c2(0x190)],_0x4d9434=await profile['findOne']({'email':_0x267b2b[_0xa577c2(0x1e0)]}),_0x4ad1bb=await master_shop[_0xa577c2(0x132)]();let _0x29aee2;if(_0x267b2b[_0xa577c2(0x15f)]==_0xa577c2(0x135)){const _0x44b790=await staff[_0xa577c2(0x1e9)]({'email':_0x267b2b[_0xa577c2(0x1e0)]});_0x29aee2=await warehouse[_0xa577c2(0x1b6)]([{'$match':{'status':_0xa577c2(0x189),'name':_0x44b790[_0xa577c2(0x1d8)],'warehouse_category':_0xa577c2(0x1c5),'name':{'$ne':_0xa577c2(0x13d)}}},{'$group':{'_id':_0xa577c2(0x1f7),'name':{'$first':_0xa577c2(0x1f7)}}}]);}else _0x29aee2=await warehouse[_0xa577c2(0x1b6)]([{'$match':{'status':_0xa577c2(0x189),'warehouse_category':_0xa577c2(0x1c5),'name':{'$ne':_0xa577c2(0x13d)}}},{'$group':{'_id':_0xa577c2(0x1f7),'name':{'$first':_0xa577c2(0x1f7)}}}]);const _0x4a3e23=await transfers_finished['find']({}),_0x2bd08d=_0x4a3e23['length']+0x1,_0x23e574=_0xa577c2(0x182)+_0x2bd08d[_0xa577c2(0x14e)]()[_0xa577c2(0x1c8)](0x5,'0');if(_0x4ad1bb[0x0]['language']==_0xa577c2(0x1f4))var _0x1f6f0b=users[_0xa577c2(0x1b1)];else{if(_0x4ad1bb[0x0][_0xa577c2(0x162)]==_0xa577c2(0x1cf))var _0x1f6f0b=users[_0xa577c2(0x1cf)];else{if(_0x4ad1bb[0x0]['language']==_0xa577c2(0x137))var _0x1f6f0b=users[_0xa577c2(0x137)];else{if(_0x4ad1bb[0x0]['language']==_0xa577c2(0x16e))var _0x1f6f0b=users[_0xa577c2(0x16e)];else{if(_0x4ad1bb[0x0][_0xa577c2(0x162)]==_0xa577c2(0x140))var _0x1f6f0b=users[_0xa577c2(0x140)];else{if(_0x4ad1bb[0x0]['language']=='Portuguese\x20(BR)')var _0x1f6f0b=users[_0xa577c2(0x139)];else{if(_0x4ad1bb[0x0][_0xa577c2(0x162)]==_0xa577c2(0x15e))var _0x1f6f0b=users[_0xa577c2(0x15e)];else{if(_0x4ad1bb[0x0]['language']==_0xa577c2(0x1ed))var _0x1f6f0b=users['Arabic'];}}}}}}}const _0x59bfc6=getRandom8DigitNumber();_0x59bfc6[_0xa577c2(0x1a9)](_0x98d5c7=>{var _0x189a64=_0xa577c2;_0x5f2862['render'](_0x189a64(0x153),{'success':_0xf20fb8[_0x189a64(0x178)](_0x189a64(0x133)),'errors':_0xf20fb8['flash'](_0x189a64(0x1e4)),'role':_0x267b2b,'profile':_0x4d9434,'master_shop':_0x4ad1bb,'warehouse':_0x29aee2,'language':_0x1f6f0b,'invoice':_0x98d5c7});})[_0xa577c2(0x1ba)](_0x127698=>{var _0x17dd1f=_0xa577c2;_0xf20fb8['flash']('errors',_0x17dd1f(0x173)),_0x5f2862[_0x17dd1f(0x18a)](_0x17dd1f(0x12b));});}catch(_0x5ad36a){console[_0xa577c2(0x1d2)](_0x5ad36a);}}),router[a0_0x9a1fa8(0x1ac)](a0_0x9a1fa8(0x1af),auth,async(_0x46cad7,_0x3a0f7a)=>{var _0x4d1923=a0_0x9a1fa8;try{const {date:_0x137f42,from_warehouse:_0x257900,FromRoom_name:_0x60225a,to_warehouse:_0x385204,ToRoom_name:_0x55e124,prod_name:_0x40e1b3,from_prod_qty:_0x27303c,from_prod_level:_0x26ad04,from_prod_isle:_0x4c7ee6,from_prod_pallet:_0x5609c3,to_prod_qty:_0x1c7dfa,to_prod_level:_0x3ba263,to_prod_isle:_0x2f47ca,to_prod_pallet:_0x1b9f9c,primary_code:_0x26988e,secondary_code:_0x37515f,product_code3:_0x3158f8,note:_0x5dbac0,MaxStocks_data2:_0x1ffbc4,invoice:_0x101d74,expiry_date:_0x16f29b}=_0x46cad7[_0x4d1923(0x1f1)];if(typeof _0x40e1b3==_0x4d1923(0x1a0))var _0x45d7cc=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1d1)]],_0x294b98=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1c7)]],_0x511dad=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x160)]],_0x32f20d=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x14f)]],_0x3e1e57=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1a1)]],_0x54f8f4=[_0x46cad7['body'][_0x4d1923(0x167)]],_0x4d6118=[_0x46cad7['body'][_0x4d1923(0x150)]],_0x41718f=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1da)]],_0x228ce5=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x142)]],_0x2473ee=[_0x46cad7[_0x4d1923(0x1f1)]['primary_unit']],_0x279550=[_0x46cad7[_0x4d1923(0x1f1)]['secondary_unit']],_0x2b1e36=[_0x46cad7['body'][_0x4d1923(0x176)]],_0x18e4e5=[_0x46cad7['body'][_0x4d1923(0x183)]],_0x2042d9=[_0x46cad7['body'][_0x4d1923(0x159)]],_0x519248=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1be)]],_0x1be229=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1f5)]],_0x3aefea=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x138)]],_0xacd82e=[_0x46cad7['body'][_0x4d1923(0x1cb)]],_0x4e8159=[_0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1c9)]],_0x27fd4f=[_0x46cad7[_0x4d1923(0x1f1)]['from_invoice']],_0x17d041=[_0x46cad7['body'][_0x4d1923(0x1f3)]];else var _0x45d7cc=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1d1)]],_0x294b98=[..._0x46cad7['body'][_0x4d1923(0x1c7)]],_0x511dad=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x160)]],_0x32f20d=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x14f)]],_0x3e1e57=[..._0x46cad7[_0x4d1923(0x1f1)]['to_prod_level']],_0x54f8f4=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x167)]],_0x4d6118=[..._0x46cad7['body'][_0x4d1923(0x150)]],_0x41718f=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1da)]],_0x228ce5=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x142)]],_0x2473ee=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x123)]],_0x279550=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1bc)]],_0x2b1e36=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x176)]],_0x18e4e5=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x183)]],_0x2042d9=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x159)]],_0x519248=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1be)]],_0x1be229=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1f5)]],_0x3aefea=[..._0x46cad7[_0x4d1923(0x1f1)]['prod_cat']],_0xacd82e=[..._0x46cad7['body'][_0x4d1923(0x1cb)]],_0x4e8159=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1c9)]],_0x27fd4f=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x19a)]],_0x17d041=[..._0x46cad7[_0x4d1923(0x1f1)][_0x4d1923(0x1f3)]];const _0x338c90=_0x45d7cc['map'](_0x2362cf=>{return _0x2362cf={'product_name':_0x2362cf};});_0x294b98[_0x4d1923(0x1f0)]((_0x2aa566,_0x502a68)=>{var _0x4dbca1=_0x4d1923;_0x338c90[_0x502a68][_0x4dbca1(0x1aa)]=_0x2aa566;}),_0x511dad[_0x4d1923(0x1f0)]((_0x2b0995,_0x4ea94)=>{var _0x522da5=_0x4d1923;_0x338c90[_0x4ea94][_0x522da5(0x12d)]=_0x2b0995;}),_0x27fd4f['forEach']((_0x53bb96,_0x595088)=>{_0x338c90[_0x595088]['from_invoice']=_0x53bb96;}),_0x17d041[_0x4d1923(0x1f0)]((_0x70fb9a,_0x1fe342)=>{var _0x4da325=_0x4d1923;_0x338c90[_0x1fe342][_0x4da325(0x1ee)]=_0x70fb9a;}),_0x32f20d['forEach']((_0x2e55f7,_0x31fe0a)=>{var _0x1db237=_0x4d1923;_0x338c90[_0x31fe0a][_0x1db237(0x197)]=_0x2e55f7;}),_0x3e1e57[_0x4d1923(0x1f0)]((_0x1cc711,_0x3a169e)=>{var _0x534b5=_0x4d1923;_0x338c90[_0x3a169e][_0x534b5(0x1c4)]=_0x1cc711;}),_0x54f8f4[_0x4d1923(0x1f0)]((_0x3fd354,_0x2e215b)=>{var _0x28a8d0=_0x4d1923;_0x338c90[_0x2e215b][_0x28a8d0(0x167)]=_0x3fd354;}),_0x4d6118['forEach']((_0x3230c4,_0x18f9c8)=>{var _0x49ea5f=_0x4d1923;_0x338c90[_0x18f9c8][_0x49ea5f(0x150)]=_0x3230c4;}),_0x41718f[_0x4d1923(0x1f0)]((_0x545ada,_0x53c6d8)=>{var _0x36f88e=_0x4d1923;_0x338c90[_0x53c6d8][_0x36f88e(0x146)]=_0x545ada;}),_0x228ce5[_0x4d1923(0x1f0)]((_0x43e8f9,_0x59af55)=>{_0x338c90[_0x59af55]['maxProducts']=_0x43e8f9;}),_0x2473ee['forEach']((_0x365ae8,_0x57f8e4)=>{var _0xc5f115=_0x4d1923;_0x338c90[_0x57f8e4][_0xc5f115(0x1dd)]=_0x365ae8;}),_0x279550[_0x4d1923(0x1f0)]((_0x207918,_0x57ada5)=>{var _0xdd18fb=_0x4d1923;_0x338c90[_0x57ada5][_0xdd18fb(0x1bc)]=_0x207918;}),_0x2b1e36['forEach']((_0x47fc17,_0x2755ec)=>{_0x338c90[_0x2755ec]['batch_code']=_0x47fc17;}),_0x18e4e5[_0x4d1923(0x1f0)]((_0x3f399d,_0x71182d)=>{var _0x9d855e=_0x4d1923;_0x338c90[_0x71182d][_0x9d855e(0x183)]=_0x3f399d;}),_0x2042d9[_0x4d1923(0x1f0)]((_0x18ac48,_0xabdec3)=>{var _0x257495=_0x4d1923;_0x338c90[_0xabdec3][_0x257495(0x14c)]=_0x18ac48;}),_0x519248[_0x4d1923(0x1f0)]((_0x32b57a,_0x34dde5)=>{var _0x12d3c4=_0x4d1923;_0x338c90[_0x34dde5][_0x12d3c4(0x1bf)]=_0x32b57a;}),_0x1be229[_0x4d1923(0x1f0)]((_0x37ed1c,_0x15b5d5)=>{var _0xd6dd5=_0x4d1923;_0x338c90[_0x15b5d5][_0xd6dd5(0x1f5)]=_0x37ed1c;}),_0x3aefea[_0x4d1923(0x1f0)]((_0x44c1df,_0x591932)=>{var _0x1d5e38=_0x4d1923;_0x338c90[_0x591932][_0x1d5e38(0x138)]=_0x44c1df;}),_0xacd82e[_0x4d1923(0x1f0)]((_0x261993,_0x252836)=>{var _0x5d3541=_0x4d1923;_0x338c90[_0x252836][_0x5d3541(0x16c)]=_0x261993;}),_0x4e8159[_0x4d1923(0x1f0)]((_0x2a86e7,_0x5144d7)=>{var _0x4d41eb=_0x4d1923;_0x338c90[_0x5144d7][_0x4d41eb(0x171)]=_0x2a86e7;});const _0xdd141d=_0x338c90[_0x4d1923(0x1d4)](_0x36e5b3=>_0x36e5b3[_0x4d1923(0x197)]!=='0'&&_0x36e5b3['to_quantity']!==''||_0x36e5b3[_0x4d1923(0x12f)]!=='0'&&_0x36e5b3[_0x4d1923(0x12f)]!=='');var _0xe8b8b=0x0;_0xdd141d[_0x4d1923(0x1f0)](_0x31e7d5=>{var _0x32fb91=_0x4d1923;parseInt(_0x31e7d5[_0x32fb91(0x1aa)])<parseInt(_0x31e7d5[_0x32fb91(0x197)])&&_0xe8b8b++;});if(_0xe8b8b!=0x0)return _0x46cad7[_0x4d1923(0x178)](_0x4d1923(0x1e4),_0x4d1923(0x18f)),_0x3a0f7a[_0x4d1923(0x18a)]('back');const _0x2cecee=new transfers_finished({'date':_0x137f42,'from_warehouse':_0x257900,'to_warehouse':_0x385204,'product':_0xdd141d,'note':_0x5dbac0,'invoice':_0x101d74}),_0x5ecb44=await _0x2cecee[_0x4d1923(0x175)]();_0x46cad7[_0x4d1923(0x178)](_0x4d1923(0x133),'Product\x20Transfer\x20successfully'),_0x3a0f7a[_0x4d1923(0x18a)](_0x4d1923(0x17f)+_0x5ecb44[_0x4d1923(0x121)]);}catch(_0x43a327){console['log'](_0x43a327),_0x3a0f7a['status'](0xc8)[_0x4d1923(0x164)]({'errorMessage':_0x43a327[_0x4d1923(0x15d)]});}}),router['get'](a0_0x9a1fa8(0x198),auth,async(_0x5965bc,_0x568164)=>{var _0x173615=a0_0x9a1fa8;try{const {username:_0x269a8c,email:_0x1196bd,role:_0x51e63c}=_0x5965bc[_0x173615(0x190)],_0x2f5736=_0x5965bc[_0x173615(0x190)],_0x1c3523=await profile['findOne']({'email':_0x2f5736[_0x173615(0x1e0)]}),_0x1ab4e3=await master_shop[_0x173615(0x132)](),_0x35a9c6=await transfers_finished[_0x173615(0x187)](_0x5965bc[_0x173615(0x15a)]['id']);let _0x167cf3;if(_0x2f5736[_0x173615(0x15f)]=='staff'){const _0x515ce6=await staff[_0x173615(0x1e9)]({'email':_0x2f5736[_0x173615(0x1e0)]});_0x167cf3=await warehouse['find']({'status':_0x173615(0x189),'name':_0x515ce6['warehouse'],'warehouse_category':_0x173615(0x1c5)});}else _0x167cf3=await warehouse['find']({'status':_0x173615(0x189),'warehouse_category':_0x173615(0x1c5)});const _0x2a528a=await warehouse[_0x173615(0x1b6)]([{'$match':{'name':_0x35a9c6[_0x173615(0x131)],'warehouse_category':_0x173615(0x1c5)}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x173615(0x1d0)},'product_stock':{'$first':_0x173615(0x195)},'bay':{'$first':_0x173615(0x1d6)},'bin':{'$first':_0x173615(0x127)},'type':{'$first':_0x173615(0x155)},'floorlevel':{'$first':_0x173615(0x158)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x173615(0x144)},'product_code':{'$first':_0x173615(0x1ab)},'storage':{'$first':_0x173615(0x1d7)},'rack':{'$first':_0x173615(0x184)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x173615(0x186)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x173615(0x1f7)}}}]),_0x49f632=await product[_0x173615(0x132)]({});if(_0x1ab4e3[0x0][_0x173615(0x162)]=='English\x20(US)'){var _0x296bb3=users[_0x173615(0x1b1)];console[_0x173615(0x1d2)](_0x296bb3);}else{if(_0x1ab4e3[0x0][_0x173615(0x162)]==_0x173615(0x1cf))var _0x296bb3=users[_0x173615(0x1cf)];else{if(_0x1ab4e3[0x0]['language']==_0x173615(0x137))var _0x296bb3=users[_0x173615(0x137)];else{if(_0x1ab4e3[0x0][_0x173615(0x162)]=='Spanish')var _0x296bb3=users[_0x173615(0x16e)];else{if(_0x1ab4e3[0x0][_0x173615(0x162)]==_0x173615(0x140))var _0x296bb3=users[_0x173615(0x140)];else{if(_0x1ab4e3[0x0]['language']==_0x173615(0x1bd))var _0x296bb3=users[_0x173615(0x139)];else{if(_0x1ab4e3[0x0][_0x173615(0x162)]==_0x173615(0x15e))var _0x296bb3=users[_0x173615(0x15e)];else{if(_0x1ab4e3[0x0][_0x173615(0x162)]=='Arabic\x20(ae)')var _0x296bb3=users['Arabic'];}}}}}}}_0x568164[_0x173615(0x17b)](_0x173615(0x1f2),{'success':_0x5965bc[_0x173615(0x178)](_0x173615(0x133)),'errors':_0x5965bc[_0x173615(0x178)]('errors'),'role':_0x2f5736,'profile':_0x1c3523,'master_shop':_0x1ab4e3,'warehouse':_0x167cf3,'transfer':_0x35a9c6,'stock':_0x2a528a,'unit':_0x49f632,'language':_0x296bb3});}catch(_0x512328){console[_0x173615(0x1d2)](_0x512328);}}),router[a0_0x9a1fa8(0x1ac)](a0_0x9a1fa8(0x198),auth,async(_0x17d65c,_0x2f98ab)=>{var _0x52097d=a0_0x9a1fa8;try{const {invoice:_0x31e0f6,from_warehouse:_0x18e6dc,FromRoom_name:_0x38ca1b,to_warehouse:_0x1bb4c4,ToRoom_name:_0x5d0b8c}=_0x17d65c[_0x52097d(0x1f1)],_0x15cf03=await transfers_finished[_0x52097d(0x187)](_0x17d65c[_0x52097d(0x15a)]['id']),_0x1e63e0=_0x15cf03[_0x52097d(0x185)][_0x52097d(0x151)](async _0x2eed25=>{var _0x272f5d=_0x52097d;if(_0x2eed25[_0x272f5d(0x197)]>0x0){var _0x5bf56c=await warehouse['findOne']({'name':_0x18e6dc,'room':_0x2eed25[_0x272f5d(0x16c)],'warehouse_category':'Finished\x20Goods'});const _0x3fa3ec=_0x5bf56c[_0x272f5d(0x181)][_0x272f5d(0x151)](_0x8ac751=>{var _0x10e274=_0x272f5d;_0x8ac751[_0x10e274(0x192)]==_0x2eed25[_0x10e274(0x192)]&&_0x8ac751[_0x10e274(0x180)]==_0x2eed25[_0x10e274(0x12d)]&&_0x8ac751['expiry_date']==_0x2eed25[_0x10e274(0x183)]&&_0x8ac751['production_date']==_0x2eed25['production_date']&&_0x8ac751['batch_code']==_0x2eed25[_0x10e274(0x176)]&&_0x8ac751['invoice']==_0x2eed25[_0x10e274(0x19a)]&&(_0x8ac751[_0x10e274(0x166)]=_0x8ac751[_0x10e274(0x166)]-_0x2eed25[_0x10e274(0x197)]);});}return _0x5bf56c;});Promise['all'](_0x1e63e0)[_0x52097d(0x1a9)](async _0x434d9a=>{var _0x285c33=_0x52097d;try{for(const _0x595280 of _0x434d9a){await _0x595280[_0x285c33(0x175)]();}const _0x466785=_0x15cf03[_0x285c33(0x185)][_0x285c33(0x151)](async _0x4c5843=>{var _0xa28f9c=_0x285c33,_0x47e316=await warehouse[_0xa28f9c(0x1e9)]({'name':_0x1bb4c4,'room':_0x4c5843['to_room_name']});if(_0x4c5843[_0xa28f9c(0x197)]>0x0){var _0x24d5af=0x0;const _0x2fb973=_0x47e316[_0xa28f9c(0x181)]['map'](_0x3dfcb3=>{var _0x3ca7cc=_0xa28f9c;_0x3dfcb3[_0x3ca7cc(0x192)]==_0x4c5843[_0x3ca7cc(0x192)]&&_0x3dfcb3[_0x3ca7cc(0x180)]==_0x4c5843['to_bay']&&_0x3dfcb3[_0x3ca7cc(0x183)]==_0x4c5843[_0x3ca7cc(0x183)]&&_0x3dfcb3['production_date']==_0x4c5843['production_date']&&_0x3dfcb3[_0x3ca7cc(0x176)]==_0x4c5843[_0x3ca7cc(0x176)]&&_0x3dfcb3[_0x3ca7cc(0x19e)]==_0x4c5843[_0x3ca7cc(0x1ee)]&&(_0x3dfcb3[_0x3ca7cc(0x166)]=_0x3dfcb3['product_stock']+_0x4c5843['to_quantity'],_0x24d5af++);});_0x24d5af=='0'&&(_0x47e316[_0xa28f9c(0x181)]=_0x47e316[_0xa28f9c(0x181)][_0xa28f9c(0x161)]({'product_name':_0x4c5843['product_name'],'product_stock':_0x4c5843['to_quantity'],'bay':_0x4c5843[_0xa28f9c(0x1c4)],'product_code':_0x4c5843[_0xa28f9c(0x146)],'primary_code':_0x4c5843[_0xa28f9c(0x167)],'secondary_code':_0x4c5843['secondary_code'],'expiry_date':_0x4c5843[_0xa28f9c(0x183)],'production_date':_0x4c5843[_0xa28f9c(0x14c)],'maxProducts':_0x4c5843['maxProducts'],'batch_code':_0x4c5843['batch_code'],'secondary_unit':_0x4c5843['secondary_unit'],'unit':_0x4c5843[_0xa28f9c(0x1dd)],'maxProducts':_0x4c5843[_0xa28f9c(0x1bf)],'maxPerUnit':_0x4c5843['maxPerUnit'],'invoice':_0x4c5843[_0xa28f9c(0x1ee)]}));}return _0x47e316;});Promise['all'](_0x466785)[_0x285c33(0x1a9)](async _0x1cc649=>{var _0x2e9590=_0x285c33;try{for(const _0x5ed46e of _0x1cc649){await warehouse['updateOne']({'_id':_0x5ed46e[_0x2e9590(0x121)]},{'$addToSet':{'product_details':{'$each':_0x5ed46e['product_details']}}});}_0x15cf03[_0x2e9590(0x169)]=_0x2e9590(0x1ea);const _0x25ab39=await _0x15cf03[_0x2e9590(0x175)](),_0x2bc9bf=await master_shop[_0x2e9590(0x132)](),_0x456001=await email_settings[_0x2e9590(0x1e9)](),_0xf3bcbf=await supervisor_settings[_0x2e9590(0x132)]();var _0x2fdf7f=_0x15cf03[_0x2e9590(0x185)],_0x23a903='',_0x237491;for(_0x237491 in _0x2fdf7f){var _0x3001d3='FG';_0x15cf03[_0x2e9590(0x1df)]==_0x2e9590(0x1f9)&&(_0x3001d3='DG'),_0x23a903+=_0x2e9590(0x125)+_0x2e9590(0x134)+_0x2fdf7f[_0x237491][_0x2e9590(0x192)]+_0x2e9590(0x179)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2fdf7f[_0x237491][_0x2e9590(0x146)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2fdf7f[_0x237491]['to_quantity']+'</td>'+_0x2e9590(0x134)+_0x2fdf7f[_0x237491][_0x2e9590(0x1dd)]+'</td>'+_0x2e9590(0x134)+_0x2fdf7f[_0x237491][_0x2e9590(0x1bc)]+_0x2e9590(0x179)+_0x2e9590(0x134)+_0x15cf03[_0x2e9590(0x1df)]+'</td>'+_0x2e9590(0x134)+_0x2fdf7f[_0x237491][_0x2e9590(0x171)]+_0x2e9590(0x179)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3001d3+_0x2fdf7f[_0x237491][_0x2e9590(0x1c4)]+_0x2e9590(0x179)+'</tr>';}let _0x3bfa89=nodemailer['createTransport']({'host':_0x456001['host'],'port':Number(_0x456001['port']),'secure':![],'auth':{'user':_0x456001[_0x2e9590(0x1e0)],'pass':_0x456001['password']}}),_0x48cc6f={'from':_0x456001[_0x2e9590(0x1e0)],'to':_0xf3bcbf[0x0][_0x2e9590(0x1a8)],'subject':_0x2e9590(0x14b),'attachments':[{'filename':_0x2e9590(0x191),'path':__dirname+_0x2e9590(0x1f6)+_0x2e9590(0x1db)+_0x2bc9bf[0x0][_0x2e9590(0x199)],'cid':'logo'}],'html':_0x2e9590(0x1a3)+_0x2e9590(0x13b)+_0x2e9590(0x1f8)+_0x2e9590(0x14d)+_0x2e9590(0x147)+_0x2e9590(0x14d)+_0x2e9590(0x1c6)+_0x2e9590(0x16d)+_0x2e9590(0x14d)+_0x2e9590(0x152)+_0x2bc9bf[0x0][_0x2e9590(0x126)]+_0x2e9590(0x1de)+_0x2e9590(0x16d)+_0x2e9590(0x16d)+_0x2e9590(0x1a7)+_0x2e9590(0x14d)+_0x2e9590(0x1e2)+'\x20Order\x20Number\x20:\x20'+_0x15cf03[_0x2e9590(0x19e)]+'\x20'+_0x2e9590(0x15b)+_0x2e9590(0x1b7)+_0x15cf03['date']+'\x20'+_0x2e9590(0x188)+_0x2e9590(0x1b8)+'</div>'+_0x2e9590(0x1a6)+_0x2e9590(0x14a)+_0x2e9590(0x125)+_0x2e9590(0x13e)+_0x2e9590(0x1e7)+_0x2e9590(0x163)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x2e9590(0x194)+_0x2e9590(0x1e1)+_0x2e9590(0x12c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x2e9590(0x13a)+'</thead>'+_0x2e9590(0x1fa)+'\x20'+_0x23a903+'\x20'+_0x2e9590(0x129)+_0x2e9590(0x19d)+_0x2e9590(0x14d)+_0x2e9590(0x1d5)+_0x2e9590(0x196)+_0x2bc9bf[0x0][_0x2e9590(0x126)]+_0x2e9590(0x1b8)+_0x2e9590(0x16d)+_0x2e9590(0x16d)+_0x2e9590(0x1a2)};_0x3bfa89[_0x2e9590(0x1b5)](_0x48cc6f,function(_0x1e3aa5,_0x1801b3){var _0x194d8c=_0x2e9590;_0x1e3aa5?(console[_0x194d8c(0x1d2)](_0x1e3aa5),console['log']('Error\x20Occurs')):console[_0x194d8c(0x1d2)]('Email\x20sent\x20successfully');}),_0x17d65c[_0x2e9590(0x178)]('success',_0x2e9590(0x1d3)),_0x2f98ab[_0x2e9590(0x18a)](_0x2e9590(0x177)+_0x25ab39[_0x2e9590(0x121)]);}catch(_0x114230){console[_0x2e9590(0x1fc)](_0x114230),_0x2f98ab[_0x2e9590(0x1ec)](0x1f4)['json']({'error':_0x2e9590(0x19c)});}})['catch'](_0x1b20c1=>{var _0x28fee1=_0x285c33;console[_0x28fee1(0x1fc)](_0x1b20c1),_0x2f98ab['status'](0x1f4)[_0x28fee1(0x164)]({'error':_0x28fee1(0x143)});});}catch(_0x3f2e50){console['error'](_0x3f2e50),_0x2f98ab['status'](0x1f4)[_0x285c33(0x164)]({'error':_0x285c33(0x13c)});}})['catch'](_0x2994b4=>{var _0x3d34e7=_0x52097d;console['error'](_0x2994b4),_0x2f98ab['status'](0x1f4)[_0x3d34e7(0x164)]({'error':_0x3d34e7(0x143)});});}catch(_0x163150){_0x2f98ab[_0x52097d(0x164)]({'message':_0x163150['message']});}});function BayBinSelected(_0x37458f,_0x434fc9){var _0x242d5f=a0_0x9a1fa8,_0x5bed4e=[];let _0x13d9ad=[];var _0x3ef16d=[];if(_0x37458f=='DRY\x20GOODS'){switch(_0x434fc9){case _0x242d5f(0x1b2):_0x5bed4e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x242d5f(0x18c):_0x5bed4e=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x3ef16d=['DG'];}else{if(_0x37458f==_0x242d5f(0x1b4)){switch(_0x434fc9){case _0x242d5f(0x1b2):_0x5bed4e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x242d5f(0x18c):_0x5bed4e=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x3ef16d=['FG'];}}return{'levels':_0x5bed4e,'identify':_0x3ef16d};}function a0_0x5e39(_0x5a163d,_0x253446){var _0x1f4f5b=a0_0x1f4f();return a0_0x5e39=function(_0x5e3948,_0x503e8c){_0x5e3948=_0x5e3948-0x121;var _0x59d745=_0x1f4f5b[_0x5e3948];return _0x59d745;},a0_0x5e39(_0x5a163d,_0x253446);}router[a0_0x9a1fa8(0x170)]('/view/:id',auth,async(_0x38a906,_0x5a1569)=>{var _0x2abb8c=a0_0x9a1fa8;try{const {username:_0x4e52bd,email:_0x317782,role:_0x1305d7}=_0x38a906[_0x2abb8c(0x190)],_0x7269ce=_0x38a906[_0x2abb8c(0x190)],_0x41f8e5=await profile[_0x2abb8c(0x1e9)]({'email':_0x7269ce['email']}),_0x539ccc=await master_shop[_0x2abb8c(0x132)](),_0x1e034a=await transfers_finished['findById'](_0x38a906['params']['id']);let _0x1775f4=new Date(_0x1e034a['expiry_date']),_0x2329d2=('0'+_0x1775f4['getDate']())[_0x2abb8c(0x145)](-0x2),_0x59087d=('0'+(_0x1775f4['getMonth']()+0x1))[_0x2abb8c(0x145)](-0x2),_0xbfb104=_0x1775f4[_0x2abb8c(0x149)](),_0x292e62=_0xbfb104+'-'+_0x59087d+'-'+_0x2329d2,_0x2dc97b;if(_0x7269ce[_0x2abb8c(0x15f)]=='staff'){const _0x1f99be=await staff[_0x2abb8c(0x1e9)]({'email':_0x7269ce[_0x2abb8c(0x1e0)]});_0x2dc97b=await warehouse[_0x2abb8c(0x132)]({'status':_0x2abb8c(0x189),'name':_0x1f99be[_0x2abb8c(0x1d8)],'warehouse_category':_0x2abb8c(0x1c5)});}else _0x2dc97b=await warehouse[_0x2abb8c(0x132)]({'status':_0x2abb8c(0x189),'warehouse_category':_0x2abb8c(0x1c5)});const _0x43e9a7=await warehouse['aggregate']([{'$match':{'name':_0x1e034a[_0x2abb8c(0x131)],'room':_0x1e034a[_0x2abb8c(0x1ef)]}},{'$unwind':_0x2abb8c(0x128)},{'$group':{'_id':_0x2abb8c(0x19f),'name':{'$first':_0x2abb8c(0x1d0)},'product_stock':{'$first':_0x2abb8c(0x195)},'bay':{'$first':_0x2abb8c(0x1d6)},'bin':{'$first':_0x2abb8c(0x127)},'type':{'$first':_0x2abb8c(0x155)},'floorlevel':{'$first':_0x2abb8c(0x158)},'primary_code':{'$first':_0x2abb8c(0x1b3)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2abb8c(0x1ab)},'storage':{'$first':_0x2abb8c(0x1d7)},'rack':{'$first':'$product_details.rack'}}}]);var _0xcf6afb=[0x1,0x2,0x3,0x4],_0x909821=['A','B','C','D','E','F','G','H','I','J'],_0x221318=[_0x2abb8c(0x18d),_0x2abb8c(0x1ca)];const _0x35c3e3=await product['find']({}),_0xa85e17=BayBinSelected(_0x1e034a[_0x2abb8c(0x1df)],_0x1e034a[_0x2abb8c(0x172)]);if(_0x539ccc[0x0][_0x2abb8c(0x162)]==_0x2abb8c(0x1f4)){var _0x1027a8=users[_0x2abb8c(0x1b1)];console['log'](_0x1027a8);}else{if(_0x539ccc[0x0][_0x2abb8c(0x162)]=='Hindi')var _0x1027a8=users[_0x2abb8c(0x1cf)];else{if(_0x539ccc[0x0]['language']==_0x2abb8c(0x137))var _0x1027a8=users[_0x2abb8c(0x137)];else{if(_0x539ccc[0x0][_0x2abb8c(0x162)]=='Spanish')var _0x1027a8=users[_0x2abb8c(0x16e)];else{if(_0x539ccc[0x0][_0x2abb8c(0x162)]==_0x2abb8c(0x140))var _0x1027a8=users['French'];else{if(_0x539ccc[0x0]['language']==_0x2abb8c(0x1bd))var _0x1027a8=users[_0x2abb8c(0x139)];else{if(_0x539ccc[0x0][_0x2abb8c(0x162)]==_0x2abb8c(0x15e))var _0x1027a8=users['Chinese'];else{if(_0x539ccc[0x0][_0x2abb8c(0x162)]==_0x2abb8c(0x1ed))var _0x1027a8=users['Arabic'];}}}}}}}_0x5a1569[_0x2abb8c(0x17b)]('edit_transfer_finished',{'success':_0x38a906[_0x2abb8c(0x178)](_0x2abb8c(0x133)),'errors':_0x38a906['flash']('errors'),'role':_0x7269ce,'profile':_0x41f8e5,'master_shop':_0x539ccc,'warehouse':_0x2dc97b,'transfer':_0x1e034a,'stock':_0x43e9a7,'unit':_0x35c3e3,'language':_0x1027a8,'levels':_0xcf6afb,'Isle':_0x909821,'rooms_data':_0x221318,'ed_fullDate':_0x292e62,'dataSelected':_0xa85e17});}catch(_0x295e00){console[_0x2abb8c(0x1d2)](_0x295e00);}}),router[a0_0x9a1fa8(0x1ac)](a0_0x9a1fa8(0x17a),auth,async(_0x511728,_0x3ed49e)=>{var _0x4e056c=a0_0x9a1fa8;try{const _0x5749be=_0x511728[_0x4e056c(0x15a)]['id'];console['log'](_0x511728[_0x4e056c(0x1f1)]);const _0x500d28=await transfers_finished[_0x4e056c(0x187)](_0x5749be);console[_0x4e056c(0x1d2)](_0x4e056c(0x122),_0x500d28);const {date:_0x3d6e55,from_warehouse:_0x10e959,FromRoom_name:_0x3239eb,to_warehouse:_0x18efce,ToRoom_name:_0x5a7d26,prod_name:_0x287097,from_prod_qty:_0x4a18de,from_prod_level:_0x2fba89,from_prod_isle:_0x5dd2b3,from_prod_pallet:_0x15b11a,to_prod_qty:_0x4d9a2f,to_prod_level:_0x520fcd,to_prod_isle:_0x4925e8,to_prod_pallet:_0xb6deca,primary_code:_0x389468,secondary_code:_0xc33574,product_code3:_0x5546ac,note:_0x54c819,invoice:_0xc4e580,expiry_date:_0x4b9181}=_0x511728['body'];if(typeof _0x287097==_0x4e056c(0x1a0))var _0x4f11ac=[_0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x1d1)]],_0x33ea18=[_0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x1c7)]],_0x5ee418=[_0x511728[_0x4e056c(0x1f1)]['from_prod_level']],_0x120e8b=[_0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x1e8)]],_0x1635f5=[_0x511728[_0x4e056c(0x1f1)]['to_prod_level']],_0x253c0e=[_0x511728['body'][_0x4e056c(0x167)]],_0x43f7e6=[_0x511728['body'][_0x4e056c(0x150)]],_0x47f305=[_0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x1da)]],_0x4d4cf2=[_0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x142)]],_0x56a430=[_0x511728[_0x4e056c(0x1f1)]['unit']],_0x26e8dd=[_0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x1bc)]],_0xc5223a=[_0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x176)]],_0x3de466=[_0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x183)]];else var _0x4f11ac=[..._0x511728['body']['prod_name']],_0x33ea18=[..._0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x1c7)]],_0x5ee418=[..._0x511728[_0x4e056c(0x1f1)]['from_prod_level']],_0x120e8b=[..._0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x1e8)]],_0x1635f5=[..._0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x1a1)]],_0x253c0e=[..._0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x167)]],_0x43f7e6=[..._0x511728[_0x4e056c(0x1f1)]['secondary_code']],_0x47f305=[..._0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x1da)]],_0x4d4cf2=[..._0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x142)]],_0x56a430=[..._0x511728[_0x4e056c(0x1f1)][_0x4e056c(0x1dd)]],_0x26e8dd=[..._0x511728[_0x4e056c(0x1f1)]['secondary_unit']],_0xc5223a=[..._0x511728['body'][_0x4e056c(0x176)]],_0x3de466=[..._0x511728['body'][_0x4e056c(0x183)]];const _0x17df7e=_0x4f11ac[_0x4e056c(0x151)](_0x56550a=>{return _0x56550a={'product_name':_0x56550a};});_0x33ea18['forEach']((_0x33b3b6,_0x337484)=>{var _0x3ce333=_0x4e056c;_0x17df7e[_0x337484][_0x3ce333(0x1aa)]=_0x33b3b6;}),_0x5ee418['forEach']((_0x2eb080,_0x396048)=>{var _0x403d0d=_0x4e056c;_0x17df7e[_0x396048][_0x403d0d(0x12d)]=_0x2eb080;}),_0x120e8b[_0x4e056c(0x1f0)]((_0x15335d,_0x5da497)=>{_0x17df7e[_0x5da497]['to_quantity']=_0x15335d;}),_0x1635f5[_0x4e056c(0x1f0)]((_0x2d3ba9,_0x5677ca)=>{var _0x54293f=_0x4e056c;_0x17df7e[_0x5677ca][_0x54293f(0x1c4)]=_0x2d3ba9;}),_0x253c0e[_0x4e056c(0x1f0)]((_0x1f94de,_0x279cf2)=>{_0x17df7e[_0x279cf2]['primary_code']=_0x1f94de;}),_0x43f7e6[_0x4e056c(0x1f0)]((_0x15e3c6,_0x474231)=>{_0x17df7e[_0x474231]['secondary_code']=_0x15e3c6;}),_0x47f305[_0x4e056c(0x1f0)]((_0x5f1959,_0x4c4648)=>{var _0x47d984=_0x4e056c;_0x17df7e[_0x4c4648][_0x47d984(0x146)]=_0x5f1959;}),_0x4d4cf2['forEach']((_0x4c0dec,_0x489bb6)=>{var _0x2c124b=_0x4e056c;_0x17df7e[_0x489bb6][_0x2c124b(0x1bf)]=_0x4c0dec;}),_0x56a430[_0x4e056c(0x1f0)]((_0x2b00ab,_0x65d8a6)=>{var _0x4a5022=_0x4e056c;_0x17df7e[_0x65d8a6][_0x4a5022(0x1dd)]=_0x2b00ab;}),_0x26e8dd[_0x4e056c(0x1f0)]((_0x57efc8,_0x4672ec)=>{var _0xd899e6=_0x4e056c;_0x17df7e[_0x4672ec][_0xd899e6(0x1bc)]=_0x57efc8;}),_0xc5223a[_0x4e056c(0x1f0)]((_0x184535,_0x8841b4)=>{_0x17df7e[_0x8841b4]['batch_code']=_0x184535;}),_0x3de466['forEach']((_0x23cdfa,_0x5478ef)=>{var _0x89ad54=_0x4e056c;_0x17df7e[_0x5478ef][_0x89ad54(0x183)]=_0x23cdfa;});const _0xe13339=_0x17df7e['filter'](_0x54688e=>_0x54688e[_0x4e056c(0x197)]!=='0'&&_0x54688e[_0x4e056c(0x197)]!==''||_0x54688e[_0x4e056c(0x12f)]!=='0'&&_0x54688e[_0x4e056c(0x12f)]!=='');var _0x3a3044=0x0;_0xe13339['forEach'](_0x11178d=>{var _0x2650d7=_0x4e056c;parseInt(_0x11178d[_0x2650d7(0x1aa)])<parseInt(_0x11178d['to_quantity'])&&_0x3a3044++;});if(_0x3a3044!=0x0)return _0x511728[_0x4e056c(0x178)](_0x4e056c(0x1e4),_0x4e056c(0x18f)),_0x3ed49e[_0x4e056c(0x18a)](_0x4e056c(0x130));const _0x2fdabd=await warehouse[_0x4e056c(0x1e9)]({'name':_0x500d28['from_warehouse'],'room':_0x500d28[_0x4e056c(0x1ef)]});_0x500d28[_0x4e056c(0x185)]['forEach'](_0xd24eb6=>{var _0xd2e185=_0x4e056c;if(_0xd24eb6[_0xd2e185(0x197)]>0x0){const _0xad6def=_0x2fdabd[_0xd2e185(0x181)][_0xd2e185(0x151)](_0x48306d=>{var _0xecbb71=_0xd2e185;_0x48306d['product_name']==_0xd24eb6[_0xecbb71(0x192)]&&_0x48306d[_0xecbb71(0x180)]==_0xd24eb6[_0xecbb71(0x12d)]&&(_0x48306d[_0xecbb71(0x166)]=parseInt(_0x48306d[_0xecbb71(0x166)])+parseInt(_0xd24eb6[_0xecbb71(0x197)]));});}}),await _0x2fdabd[_0x4e056c(0x175)]();const _0x34e07c=await warehouse[_0x4e056c(0x1e9)]({'name':_0x500d28[_0x4e056c(0x1df)],'room':_0x500d28[_0x4e056c(0x172)]});_0x500d28[_0x4e056c(0x185)][_0x4e056c(0x1f0)](_0x86a9b7=>{var _0x5a7fff=_0x4e056c;if(_0x86a9b7[_0x5a7fff(0x197)]>0x0){const _0x5c6602=_0x34e07c[_0x5a7fff(0x181)][_0x5a7fff(0x151)](_0x2da651=>{var _0xe33ff0=_0x5a7fff;_0x2da651[_0xe33ff0(0x192)]==_0x86a9b7[_0xe33ff0(0x192)]&&_0x2da651['bay']==_0x86a9b7['to_bay']&&(_0x2da651['product_stock']=parseInt(_0x2da651[_0xe33ff0(0x166)])-parseInt(_0x86a9b7[_0xe33ff0(0x197)]));});}}),await _0x34e07c[_0x4e056c(0x175)](),_0x500d28[_0x4e056c(0x157)]=_0x3d6e55,_0x500d28[_0x4e056c(0x131)]=_0x10e959,_0x500d28[_0x4e056c(0x1df)]=_0x18efce,_0x500d28[_0x4e056c(0x185)]=_0xe13339,_0x500d28[_0x4e056c(0x193)]=_0x54c819,_0x500d28[_0x4e056c(0x19e)]=_0xc4e580;const _0x270a56=await _0x500d28[_0x4e056c(0x175)](),_0x4c4bf4=await warehouse[_0x4e056c(0x1e9)]({'name':_0x10e959,'room':_0x3239eb});_0x270a56[_0x4e056c(0x185)][_0x4e056c(0x1f0)](_0x1a8650=>{var _0x5dde00=_0x4e056c;if(_0x1a8650[_0x5dde00(0x197)]>0x0){const _0xbf91f5=_0x4c4bf4['product_details'][_0x5dde00(0x151)](_0x22ab15=>{var _0x1a0f8d=_0x5dde00;_0x22ab15[_0x1a0f8d(0x192)]==_0x1a8650[_0x1a0f8d(0x192)]&&_0x22ab15[_0x1a0f8d(0x180)]==_0x1a8650[_0x1a0f8d(0x12d)]&&(_0x22ab15['product_stock']=parseInt(_0x22ab15[_0x1a0f8d(0x166)])-parseInt(_0x1a8650[_0x1a0f8d(0x197)]));});}}),await _0x4c4bf4[_0x4e056c(0x175)]();const _0x1dd516=await warehouse[_0x4e056c(0x1e9)]({'name':_0x18efce,'room':_0x5a7d26});_0x270a56[_0x4e056c(0x185)][_0x4e056c(0x1f0)](_0x39c021=>{var _0x424ae0=_0x4e056c;if(_0x39c021[_0x424ae0(0x197)]>0x0){var _0xd9fbc3=0x0;const _0x557a06=_0x1dd516[_0x424ae0(0x181)]['map'](_0x226707=>{var _0x392283=_0x424ae0;_0x226707['product_name']==_0x39c021['product_name']&&_0x226707[_0x392283(0x180)]==_0x39c021[_0x392283(0x1c4)]&&(_0x226707['product_stock']=parseInt(_0x226707['product_stock'])+parseInt(_0x39c021[_0x392283(0x197)]),_0xd9fbc3++);});_0xd9fbc3=='0'&&(_0x1dd516[_0x424ae0(0x181)]=_0x1dd516[_0x424ae0(0x181)][_0x424ae0(0x161)]({'product_name':_0x39c021[_0x424ae0(0x192)],'product_stock':_0x39c021[_0x424ae0(0x197)],'bay':_0x39c021[_0x424ae0(0x1c4)],'product_code':_0x39c021[_0x424ae0(0x146)],'primary_code':_0x39c021[_0x424ae0(0x167)],'secondary_code':_0x39c021[_0x424ae0(0x150)],'maxProducts':_0x39c021['maxProducts']}));}}),await _0x1dd516['save'](),_0x511728[_0x4e056c(0x178)](_0x4e056c(0x133),_0x4e056c(0x148)),_0x3ed49e[_0x4e056c(0x18a)]('/transfer_finished/view');}catch(_0x72c0d9){console[_0x4e056c(0x1d2)](_0x72c0d9);}}),router[a0_0x9a1fa8(0x1ac)]('/barcode_scanner',async(_0x2d083c,_0x6a62e6)=>{var _0x14f96d=a0_0x9a1fa8;const {FromWareHouse:_0x5b89b5,FromRoom:_0x3e4a6e,ToWarehouse:_0x52909f,ToRoom:_0x1547c7,primary_code:_0x29b616,Roomslist:_0x1a8d5d}=_0x2d083c['body'],_0x21b2ac=_0x1a8d5d[_0x14f96d(0x1e6)](','),_0x412c7a=[];async function _0x470f2b(_0x3255ab){var _0x9947b7=_0x14f96d;const _0x3475fc=await warehouse[_0x9947b7(0x1b6)]([{'$match':{'name':_0x5b89b5,'room':_0x3255ab}},{'$unwind':_0x9947b7(0x128)},{'$match':{'product_details.primary_code':_0x29b616}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x9947b7(0x1d0)},'instock':{'$first':_0x9947b7(0x195)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x9947b7(0x144)},'product_code':{'$first':_0x9947b7(0x1ab)},'level':{'$first':_0x9947b7(0x1d6)},'isle':{'$first':_0x9947b7(0x127)},'type':{'$first':_0x9947b7(0x155)},'pallet':{'$first':_0x9947b7(0x158)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x9947b7(0x1c3)},'storage':{'$first':_0x9947b7(0x1d7)},'rack':{'$first':_0x9947b7(0x184)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x9947b7(0x1dc)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x9947b7(0x1b0)}}}]),_0x4845db=await warehouse[_0x9947b7(0x1b6)]([{'$match':{'name':_0x5b89b5,'room':_0x3255ab}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x29b616}},{'$group':{'_id':_0x9947b7(0x19f),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x9947b7(0x195)},'primary_code':{'$first':_0x9947b7(0x1b3)},'secondary_code':{'$first':_0x9947b7(0x144)},'product_code':{'$first':_0x9947b7(0x1ab)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x9947b7(0x127)},'type':{'$first':_0x9947b7(0x155)},'pallet':{'$first':_0x9947b7(0x158)},'unit':{'$first':_0x9947b7(0x1ad)},'secondary_unit':{'$first':_0x9947b7(0x1c3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x9947b7(0x184)},'expiry_date':{'$first':_0x9947b7(0x124)},'production_date':{'$first':_0x9947b7(0x186)},'batch_code':{'$first':_0x9947b7(0x16f)},'maxPerUnit':{'$first':_0x9947b7(0x12a)},'roomNamed':{'$first':_0x9947b7(0x1dc)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x9947b7(0x1b0)}}}]);if(_0x3475fc[_0x9947b7(0x16b)]>0x0)_0x412c7a['push'](_0x3475fc);else _0x4845db[_0x9947b7(0x16b)]>0x0&&_0x412c7a['push'](_0x4845db);}const _0x1a356d=_0x21b2ac[_0x14f96d(0x151)](_0x1b8ba5=>_0x470f2b(_0x1b8ba5));await Promise['all'](_0x1a356d),_0x6a62e6[_0x14f96d(0x164)](_0x412c7a);}),router['post']('/barcode_scanner2',async(_0x5d2251,_0x39a0b5)=>{var _0x3a215f=a0_0x9a1fa8;try{const {FromWareHouse:_0x1b1b08,FromRoom:_0x3d1909,ToWarehouse:_0x4486fc,ToRoom:_0x5070bd,secondary_code:_0x22d793}=_0x5d2251['body'],_0x35b232=await warehouse[_0x3a215f(0x1b6)]([{'$match':{'name':_0x1b1b08}},{'$unwind':_0x3a215f(0x128)},{'$match':{'product_details.secondary_code':_0x22d793}},{'$group':{'_id':_0x3a215f(0x19f),'name':{'$first':_0x3a215f(0x1d0)},'primary_code':{'$first':_0x3a215f(0x1b3)},'secondary_code':{'$first':_0x3a215f(0x144)},'product_code':{'$first':_0x3a215f(0x1ab)},'instock':{'$first':_0x3a215f(0x195)},'warehouse':{'$first':'$name'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x3a215f(0x165)},'pallet':{'$first':_0x3a215f(0x1fb)},'maxProducts':{'$first':_0x3a215f(0x136)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':_0x3a215f(0x124)},'production_date':{'$first':_0x3a215f(0x186)}}}]);_0x39a0b5[_0x3a215f(0x1ec)](0xc8)[_0x3a215f(0x164)](_0x35b232);}catch(_0x388d69){_0x39a0b5['status'](0x194)['json']({'message':_0x388d69[_0x3a215f(0x15d)]});}}),router[a0_0x9a1fa8(0x1ac)](a0_0x9a1fa8(0x15c),async(_0x21252e,_0x3b7d4c)=>{var _0x351ad2=a0_0x9a1fa8;try{const {FromWareHouse:_0x32b14d,FromRoom:_0x124c57,ToWarehouse:_0x25af50,ToRoom:_0x598ccc,product_code:_0x3fe4ea}=_0x21252e[_0x351ad2(0x1f1)],_0x5cb86a=await warehouse['aggregate']([{'$match':{'name':_0x32b14d}},{'$unwind':_0x351ad2(0x128)},{'$match':{'product_details.product_code':_0x3fe4ea}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x351ad2(0x1d0)},'primary_code':{'$first':_0x351ad2(0x1b3)},'secondary_code':{'$first':_0x351ad2(0x144)},'product_code':{'$first':_0x351ad2(0x1ab)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x351ad2(0x1f7)},'level':{'$first':_0x351ad2(0x18e)},'isle':{'$first':_0x351ad2(0x165)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x351ad2(0x136)},'unit':{'$first':_0x351ad2(0x1ad)}}}]);_0x3b7d4c[_0x351ad2(0x1ec)](0xc8)['json'](_0x5cb86a);}catch(_0x2eb9a6){_0x3b7d4c['status'](0x194)[_0x351ad2(0x164)]({'message':_0x2eb9a6[_0x351ad2(0x15d)]});}}),router[a0_0x9a1fa8(0x1ac)]('/CheckingWarehouse',async(_0x38cb85,_0x807d86)=>{var _0x2410fb=a0_0x9a1fa8;const {productCode:_0x1935df,bay:_0x5e72e8,warehouses:_0x44ea7c,room:_0x2b3fd8}=_0x38cb85[_0x2410fb(0x1f1)];console['log'](_0x38cb85[_0x2410fb(0x1f1)]);try{const _0x46ba05=await warehouse['aggregate']([{'$match':{'name':_0x44ea7c,'room':_0x2b3fd8}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x5e72e8)}},{'$group':{'_id':_0x2410fb(0x19f),'name':{'$first':_0x2410fb(0x1d0)},'product_stock':{'$first':_0x2410fb(0x195)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x807d86[_0x2410fb(0x1ec)](0xc8)[_0x2410fb(0x164)](_0x46ba05);}catch(_0x507b9b){_0x807d86[_0x2410fb(0x1ec)](0x194)[_0x2410fb(0x164)]({'message':_0x507b9b['message']});}}),module[a0_0x9a1fa8(0x17e)]=router;