function a0_0x2454(_0x5a43da,_0x38eec6){var _0x442304=a0_0x4423();return a0_0x2454=function(_0x2454fa,_0x39ad00){_0x2454fa=_0x2454fa-0x84;var _0x524cc3=_0x442304[_0x2454fa];return _0x524cc3;},a0_0x2454(_0x5a43da,_0x38eec6);}var a0_0x5622d7=a0_0x2454;function a0_0x4423(){var _0x198307=['to_quantity','Arabic\x20(ae)','$product.from_room_name','$product_details.type','slice','../models/all_models','findOne','</div>','log','Email\x20sent\x20successfully','invoice','nodemailer','/../public','\x20</h2>','prod_cat','secondary_code','map','forEach','/barcode_scanner3','To_invoice','FROZEN\x20GOODS','$product','$product_details.floorlevel','$product_details.maxProducts','DRY\x20GOODS','from_prod_level','findById','Enclosed','Rack\x201','11BfCmIA','edit_transfer_finished_view','abs','</thead>','primary_code','primary_unit','port','New_Qty_Converted','all','/CheckingWarehouse','filter','<h5>','165561azPGZg','$product_details.maxPerUnit','to_invoice','Portuguese','Spanish','Enabled','/barcode_scanner2','10zyDDEt','TRFF-','\x20Order\x20Date\x20:\x20','email','\x20Order\x20Number\x20:\x20','from_prod_qty','</head><body>','exports','Ambient','note','$product_details.production_date','message','warehouse','prod_name','$product_details.product_stock','json','to_room','express','getMonth','ToRoomAssigned','Transfer\x20Edit\x20Successfully','from_quantity','Transfer\x20Mail','to_bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','errors','$product_details.secondary_code','role','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.rack','/upload/','MaxStocks_data','product_details','Arabic','Product\x20Transfer\x20successfully','from_room_name','Logo.png','id_transaction','<hr\x20class=\x22my-3\x22>','aggregate','</table>','<tbody\x20style=\x22text-align:\x20center;\x22>','/barcode_scanner','to_prod_level','unit','site_title','French','maxPerUnit','English','<tr>','$name','from_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','2354280dksVnS','MaxStocks_data2','$product_details.storage','446679looVTv','body','/transfer_finished/view','secondary_unit','random','$product_details.product_code','$product_details.secondary_unit','user','redirect','4974fjyqvt','\x20<>\x20','$product_details.isle','</h5>','$product_details.pallet','date','post','language','</tr>','/preview/:id','Hindi','465846YWyOLj','</body></html>','product_name','Finished\x20Goods','$product_details','1310764iVfHWy','/view/add_transfer','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','concat','$finalize','$_id','image','to_warehouse','<h2>\x20','maxProducts','back','/transfer_finished/preview/','logo','params','<strong>\x20Regards\x20</strong>','$product_details.product_name','floor','push','success','product_code3','getDate','Portuguese\x20(BR)','Rack\x202','batch_code','$date','<div>','</span>','password','$product_details.unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','catch','status','flash','<!DOCTYPE\x20html>','6300140lKhBOh','/transfer/view','$product_details.expiry_date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','finalize','product_stock','$to_warehouse','product_code','_id','get','split','undefined','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','An\x20error\x20occurred.','24ptSaaY','product','$product_details.batch_code','staff','English\x20(US)','add_transfer_finished','$room','$product_details.level','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','toString','string','to_room_name','</td>','$from_warehouse','render','../middleware/auth','length','error','RoomAssigned','$product.to_room_name','edit_transfer_finished','German','max','find','$product_details.invoice','to_prod_qty','to_floorlevel','/view/:id','expiry_date','There\x27s\x20a\x20error\x20in\x20this\x20transaction','from_bay','$product_details.bin','then','Chinese','save','$product_details._id','\x20<=>\x20','FGSEmail','from_room','$product_details.primary_code','bay','updateOne','transfer_data','product_date','<h5\x20style=\x22text-align:\x20left;\x22>','production_date','from_warehouse'];a0_0x4423=function(){return _0x198307;};return a0_0x4423();}(function(_0x334ead,_0x4765a5){var _0xdee5ad=a0_0x2454,_0x5e75e5=_0x334ead();while(!![]){try{var _0x24a9bd=-parseInt(_0xdee5ad(0xac))/0x1*(parseInt(_0xdee5ad(0x100))/0x2)+parseInt(_0xdee5ad(0xb8))/0x3*(-parseInt(_0xdee5ad(0x141))/0x4)+parseInt(_0xdee5ad(0xbf))/0x5*(-parseInt(_0xdee5ad(0x10b))/0x6)+-parseInt(_0xdee5ad(0x110))/0x7+parseInt(_0xdee5ad(0xf4))/0x8+-parseInt(_0xdee5ad(0xf7))/0x9+parseInt(_0xdee5ad(0x133))/0xa;if(_0x24a9bd===_0x4765a5)break;else _0x5e75e5['push'](_0x5e75e5['shift']());}catch(_0xd84c45){_0x5e75e5['push'](_0x5e75e5['shift']());}}}(a0_0x4423,0x2a657));const express=require(a0_0x5622d7(0xd0)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x5622d7(0x94)),auth=require(a0_0x5622d7(0x150)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x5622d7(0x9a));router['get']('/view',auth,async(_0x4b390e,_0x22dbf5)=>{var _0x69bdf5=a0_0x5622d7;try{const {username:_0x2ae982,email:_0x2f1df9,role:_0x19e42b}=_0x4b390e['user'],_0x356e0f=_0x4b390e[_0x69bdf5(0xfe)],_0x5bf68e=await profile[_0x69bdf5(0x95)]({'email':_0x356e0f['email']}),_0x2650f0=await master_shop['find']();let _0x3268e6;if(_0x356e0f[_0x69bdf5(0xda)]==_0x69bdf5(0x144)){const _0x260b5c=await staff['findOne']({'email':_0x356e0f[_0x69bdf5(0xc2)]});_0x3268e6=await transfers_finished[_0x69bdf5(0x158)]({'from_warehouse':_0x260b5c['warehouse']});}else _0x3268e6=await transfers_finished['aggregate']([{'$unwind':_0x69bdf5(0xa4)},{'$group':{'_id':_0x69bdf5(0x116),'invoice':{'$first':'$invoice'},'date':{'$first':_0x69bdf5(0x129)},'from_warehouse':{'$first':_0x69bdf5(0x14e)},'to_warehouse':{'$first':_0x69bdf5(0x139)},'from_room_name':{'$addToSet':_0x69bdf5(0x91)},'to_room_name':{'$addToSet':_0x69bdf5(0x154)},'finalize':{'$first':_0x69bdf5(0x115)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x2650f0[0x0][_0x69bdf5(0x107)]==_0x69bdf5(0x145))var _0x50181d=users['English'];else{if(_0x2650f0[0x0][_0x69bdf5(0x107)]==_0x69bdf5(0x10a))var _0x50181d=users[_0x69bdf5(0x10a)];else{if(_0x2650f0[0x0][_0x69bdf5(0x107)]=='German')var _0x50181d=users['German'];else{if(_0x2650f0[0x0][_0x69bdf5(0x107)]=='Spanish')var _0x50181d=users[_0x69bdf5(0xbc)];else{if(_0x2650f0[0x0][_0x69bdf5(0x107)]==_0x69bdf5(0xed))var _0x50181d=users[_0x69bdf5(0xed)];else{if(_0x2650f0[0x0][_0x69bdf5(0x107)]==_0x69bdf5(0x126))var _0x50181d=users[_0x69bdf5(0xbb)];else{if(_0x2650f0[0x0][_0x69bdf5(0x107)]==_0x69bdf5(0x162))var _0x50181d=users[_0x69bdf5(0x162)];else{if(_0x2650f0[0x0][_0x69bdf5(0x107)]==_0x69bdf5(0x90))var _0x50181d=users[_0x69bdf5(0xe0)];}}}}}}}_0x22dbf5[_0x69bdf5(0x14f)]('transfer_finished',{'success':_0x4b390e[_0x69bdf5(0x131)](_0x69bdf5(0x123)),'errors':_0x4b390e['flash'](_0x69bdf5(0xd8)),'role':_0x356e0f,'profile':_0x5bf68e,'master_shop':_0x2650f0,'transfer':_0x3268e6,'language':_0x50181d});}catch(_0x29ed82){console[_0x69bdf5(0x97)](_0x29ed82);}});async function getRandom8DigitNumber(){var _0x5920d3=a0_0x5622d7;const _0x3ee7dd=0x989680,_0x101b04=0x5f5e0ff,_0x496549=Math[_0x5920d3(0x121)](Math[_0x5920d3(0xfb)]()*(_0x101b04-_0x3ee7dd+0x1))+_0x3ee7dd;var _0x54e630;const _0x14f697=await transfers_finished['findOne']({'invoice':_0x5920d3(0xc0)+_0x496549});return _0x14f697&&_0x14f697[_0x5920d3(0x151)]>0x0?_0x54e630=_0x5920d3(0xc0)+_0x496549:_0x54e630=_0x5920d3(0xc0)+_0x496549,_0x54e630;}router[a0_0x5622d7(0x13c)](a0_0x5622d7(0x111),auth,async(_0x362cb1,_0x3e130a)=>{var _0x58d012=a0_0x5622d7;try{const {username:_0x1b2a63,email:_0x1092cb,role:_0x4c55e4}=_0x362cb1[_0x58d012(0xfe)],_0x4b8fb1=_0x362cb1[_0x58d012(0xfe)],_0x3eedf1=await profile[_0x58d012(0x95)]({'email':_0x4b8fb1[_0x58d012(0xc2)]}),_0x12b2dc=await master_shop['find']();let _0x2fb7c6;if(_0x4b8fb1[_0x58d012(0xda)]==_0x58d012(0x144)){const _0x18184f=await staff[_0x58d012(0x95)]({'email':_0x4b8fb1[_0x58d012(0xc2)]});_0x2fb7c6=await warehouse[_0x58d012(0xe6)]([{'$match':{'status':'Enabled','name':_0x18184f[_0x58d012(0xcb)],'warehouse_category':'Finished\x20Goods','name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x58d012(0xf1),'name':{'$first':_0x58d012(0xf1)}}}]);}else _0x2fb7c6=await warehouse[_0x58d012(0xe6)]([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods','name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x58d012(0xf1),'name':{'$first':_0x58d012(0xf1)}}}]);const _0x5bf59c=await transfers_finished[_0x58d012(0x158)]({}),_0x165a1b=_0x5bf59c[_0x58d012(0x151)]+0x1,_0x28fe23=_0x58d012(0xc0)+_0x165a1b[_0x58d012(0x14a)]()['padStart'](0x5,'0');if(_0x12b2dc[0x0][_0x58d012(0x107)]==_0x58d012(0x145))var _0x542268=users[_0x58d012(0xef)];else{if(_0x12b2dc[0x0][_0x58d012(0x107)]==_0x58d012(0x10a))var _0x542268=users[_0x58d012(0x10a)];else{if(_0x12b2dc[0x0][_0x58d012(0x107)]==_0x58d012(0x156))var _0x542268=users[_0x58d012(0x156)];else{if(_0x12b2dc[0x0][_0x58d012(0x107)]==_0x58d012(0xbc))var _0x542268=users['Spanish'];else{if(_0x12b2dc[0x0]['language']==_0x58d012(0xed))var _0x542268=users[_0x58d012(0xed)];else{if(_0x12b2dc[0x0][_0x58d012(0x107)]==_0x58d012(0x126))var _0x542268=users[_0x58d012(0xbb)];else{if(_0x12b2dc[0x0]['language']=='Chinese')var _0x542268=users['Chinese'];else{if(_0x12b2dc[0x0]['language']==_0x58d012(0x90))var _0x542268=users[_0x58d012(0xe0)];}}}}}}}const _0x3ec7f0=getRandom8DigitNumber();_0x3ec7f0[_0x58d012(0x161)](_0x27b4c5=>{var _0x2f3674=_0x58d012;_0x3e130a[_0x2f3674(0x14f)](_0x2f3674(0x146),{'success':_0x362cb1[_0x2f3674(0x131)](_0x2f3674(0x123)),'errors':_0x362cb1[_0x2f3674(0x131)](_0x2f3674(0xd8)),'role':_0x4b8fb1,'profile':_0x3eedf1,'master_shop':_0x12b2dc,'warehouse':_0x2fb7c6,'language':_0x542268,'invoice':_0x27b4c5});})[_0x58d012(0x12f)](_0x3df2c7=>{var _0x5ea780=_0x58d012;_0x362cb1[_0x5ea780(0x131)]('errors',_0x5ea780(0x15e)),_0x3e130a[_0x5ea780(0xff)](_0x5ea780(0x134));});}catch(_0x47e0dc){console[_0x58d012(0x97)](_0x47e0dc);}}),router[a0_0x5622d7(0x106)]('/view/add_transfer',auth,async(_0x13ddef,_0x969450)=>{var _0x4ed503=a0_0x5622d7;try{const {date:_0x8a79cb,from_warehouse:_0x32b51a,FromRoom_name:_0x531383,to_warehouse:_0x44bcd8,ToRoom_name:_0x30bcbe,prod_name:_0xa940c1,from_prod_qty:_0x705768,from_prod_level:_0xcf3e16,from_prod_isle:_0x89bbce,from_prod_pallet:_0x8bc65c,to_prod_qty:_0x523d3b,to_prod_level:_0x45b963,to_prod_isle:_0x4c40ba,to_prod_pallet:_0x60835a,primary_code:_0x393d5b,secondary_code:_0x568d59,product_code3:_0x3848bc,note:_0x48ea3c,MaxStocks_data2:_0x3354a0,invoice:_0x350820,expiry_date:_0x70252e}=_0x13ddef[_0x4ed503(0xf8)];if(typeof _0xa940c1==_0x4ed503(0x14b))var _0xc41ea8=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xcc)]],_0x137e9a=[_0x13ddef['body']['from_prod_qty']],_0x13b80f=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xa8)]],_0x24522c=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xb3)]],_0x59756f=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xea)]],_0x12108c=[_0x13ddef['body'][_0x4ed503(0xb0)]],_0x1129f8=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0x9e)]],_0x1bfab8=[_0x13ddef['body']['product_code3']],_0x361c50=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xf5)]],_0x4d7f27=[_0x13ddef[_0x4ed503(0xf8)]['primary_unit']],_0x5c4434=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xfa)]],_0x40b726=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0x128)]],_0x3c28c6=[_0x13ddef['body'][_0x4ed503(0x15d)]],_0x5c0d62=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0x8b)]],_0x295efa=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xde)]],_0x2d8646=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xee)]],_0x4212f4=[_0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0x9d)]],_0x1bd0ff=[_0x13ddef[_0x4ed503(0xf8)]['RoomAssigned']],_0x49517b=[_0x13ddef['body'][_0x4ed503(0xd2)]],_0x1aa2d0=[_0x13ddef['body'][_0x4ed503(0xf2)]],_0x27e510=[_0x13ddef[_0x4ed503(0xf8)]['to_invoice']],_0x1b200d=[_0x13ddef[_0x4ed503(0xf8)]['id_transaction']];else var _0xc41ea8=[..._0x13ddef[_0x4ed503(0xf8)]['prod_name']],_0x137e9a=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xc4)]],_0x13b80f=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xa8)]],_0x24522c=[..._0x13ddef['body'][_0x4ed503(0xb3)]],_0x59756f=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xea)]],_0x12108c=[..._0x13ddef['body'][_0x4ed503(0xb0)]],_0x1129f8=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0x9e)]],_0x1bfab8=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0x124)]],_0x361c50=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xf5)]],_0x4d7f27=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xb1)]],_0x5c4434=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xfa)]],_0x40b726=[..._0x13ddef[_0x4ed503(0xf8)]['batch_code']],_0x3c28c6=[..._0x13ddef[_0x4ed503(0xf8)]['expiry_date']],_0x5c0d62=[..._0x13ddef['body']['product_date']],_0x295efa=[..._0x13ddef[_0x4ed503(0xf8)]['MaxStocks_data']],_0x2d8646=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xee)]],_0x4212f4=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0x9d)]],_0x1bd0ff=[..._0x13ddef['body'][_0x4ed503(0x153)]],_0x49517b=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xd2)]],_0x1aa2d0=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xf2)]],_0x27e510=[..._0x13ddef[_0x4ed503(0xf8)][_0x4ed503(0xba)]],_0x1b200d=[..._0x13ddef[_0x4ed503(0xf8)]['id_transaction']];const _0x410271=_0xc41ea8[_0x4ed503(0x9f)](_0x3f353a=>{return _0x3f353a={'product_name':_0x3f353a};});_0x137e9a[_0x4ed503(0xa0)]((_0x587472,_0x4dd456)=>{var _0x3afee3=_0x4ed503;_0x410271[_0x4dd456][_0x3afee3(0xd4)]=_0x587472;}),_0x13b80f[_0x4ed503(0xa0)]((_0x3226c9,_0x31b322)=>{_0x410271[_0x31b322]['from_bay']=_0x3226c9;}),_0x1b200d[_0x4ed503(0xa0)]((_0x28e93e,_0x53a73f)=>{_0x410271[_0x53a73f]['id_transaction']=_0x28e93e;}),_0x1aa2d0[_0x4ed503(0xa0)]((_0x2970f3,_0x564457)=>{_0x410271[_0x564457]['from_invoice']=_0x2970f3;}),_0x27e510[_0x4ed503(0xa0)]((_0x11b43a,_0x53b1ed)=>{_0x410271[_0x53b1ed]['To_invoice']=_0x11b43a;}),_0x24522c[_0x4ed503(0xa0)]((_0x207998,_0x5680d6)=>{_0x410271[_0x5680d6]['to_quantity']=_0x207998;}),_0x59756f[_0x4ed503(0xa0)]((_0x16cba2,_0x19add4)=>{_0x410271[_0x19add4]['to_bay']=_0x16cba2;}),_0x12108c[_0x4ed503(0xa0)]((_0x526924,_0x18f9b2)=>{var _0x596213=_0x4ed503;_0x410271[_0x18f9b2][_0x596213(0xb0)]=_0x526924;}),_0x1129f8[_0x4ed503(0xa0)]((_0x52a3e8,_0x4806f5)=>{var _0x1d884d=_0x4ed503;_0x410271[_0x4806f5][_0x1d884d(0x9e)]=_0x52a3e8;}),_0x1bfab8[_0x4ed503(0xa0)]((_0x48494f,_0x45cec4)=>{var _0x36f2ac=_0x4ed503;_0x410271[_0x45cec4][_0x36f2ac(0x13a)]=_0x48494f;}),_0x361c50[_0x4ed503(0xa0)]((_0x55cf31,_0x5bd8f8)=>{var _0x42b094=_0x4ed503;_0x410271[_0x5bd8f8][_0x42b094(0x11a)]=_0x55cf31;}),_0x4d7f27[_0x4ed503(0xa0)]((_0x49d2ab,_0x4889a3)=>{var _0x1a54f4=_0x4ed503;_0x410271[_0x4889a3][_0x1a54f4(0xeb)]=_0x49d2ab;}),_0x5c4434['forEach']((_0x245da4,_0x454e6d)=>{var _0x1e9575=_0x4ed503;_0x410271[_0x454e6d][_0x1e9575(0xfa)]=_0x245da4;}),_0x40b726[_0x4ed503(0xa0)]((_0x44fdb8,_0x557002)=>{var _0x589013=_0x4ed503;_0x410271[_0x557002][_0x589013(0x128)]=_0x44fdb8;}),_0x3c28c6[_0x4ed503(0xa0)]((_0x214e6c,_0x7788a1)=>{var _0x907886=_0x4ed503;_0x410271[_0x7788a1][_0x907886(0x15d)]=_0x214e6c;}),_0x5c0d62[_0x4ed503(0xa0)]((_0xb6c0b9,_0x5ea6c8)=>{var _0x4bb222=_0x4ed503;_0x410271[_0x5ea6c8][_0x4bb222(0x8d)]=_0xb6c0b9;}),_0x295efa[_0x4ed503(0xa0)]((_0x1e57c7,_0x34b47c)=>{_0x410271[_0x34b47c]['maxProducts']=_0x1e57c7;}),_0x2d8646[_0x4ed503(0xa0)]((_0x45ace2,_0x2ca41f)=>{var _0x5ee5f6=_0x4ed503;_0x410271[_0x2ca41f][_0x5ee5f6(0xee)]=_0x45ace2;}),_0x4212f4[_0x4ed503(0xa0)]((_0x51db31,_0x595cf2)=>{var _0x4495a3=_0x4ed503;_0x410271[_0x595cf2][_0x4495a3(0x9d)]=_0x51db31;}),_0x1bd0ff['forEach']((_0x424e77,_0x5dcb62)=>{var _0x535fe3=_0x4ed503;_0x410271[_0x5dcb62][_0x535fe3(0xe2)]=_0x424e77;}),_0x49517b[_0x4ed503(0xa0)]((_0x51168e,_0x4ba87d)=>{var _0x546bc3=_0x4ed503;_0x410271[_0x4ba87d][_0x546bc3(0x14c)]=_0x51168e;});const _0x71c9be=_0x410271['filter'](_0x4410c6=>_0x4410c6['to_quantity']!=='0'&&_0x4410c6[_0x4ed503(0x8f)]!==''||_0x4410c6[_0x4ed503(0x15b)]!=='0'&&_0x4410c6[_0x4ed503(0x15b)]!=='');var _0x28fc4d=0x0;_0x71c9be[_0x4ed503(0xa0)](_0x2ca3cf=>{var _0xafd8b1=_0x4ed503;parseInt(_0x2ca3cf[_0xafd8b1(0xd4)])<parseInt(_0x2ca3cf[_0xafd8b1(0x8f)])&&_0x28fc4d++;});if(_0x28fc4d!=0x0)return _0x13ddef[_0x4ed503(0x131)](_0x4ed503(0xd8),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x969450[_0x4ed503(0xff)](_0x4ed503(0x11b));const _0x1799f2=new transfers_finished({'date':_0x8a79cb,'from_warehouse':_0x32b51a,'to_warehouse':_0x44bcd8,'product':_0x71c9be,'note':_0x48ea3c,'invoice':_0x350820}),_0x5c5195=await _0x1799f2[_0x4ed503(0x163)]();_0x13ddef[_0x4ed503(0x131)](_0x4ed503(0x123),_0x4ed503(0xe1)),_0x969450['redirect'](_0x4ed503(0x11c)+_0x5c5195[_0x4ed503(0x13b)]);}catch(_0x1351b4){console[_0x4ed503(0x97)](_0x1351b4),_0x969450[_0x4ed503(0x130)](0xc8)[_0x4ed503(0xce)]({'errorMessage':_0x1351b4[_0x4ed503(0xca)]});}}),router[a0_0x5622d7(0x13c)](a0_0x5622d7(0x109),auth,async(_0x47caf4,_0x4ca19e)=>{var _0x5d31a8=a0_0x5622d7;try{const {username:_0xcfef1c,email:_0x27fc92,role:_0x179284}=_0x47caf4[_0x5d31a8(0xfe)],_0x528c13=_0x47caf4[_0x5d31a8(0xfe)],_0x1cc5b6=await profile[_0x5d31a8(0x95)]({'email':_0x528c13['email']}),_0x3317a4=await master_shop[_0x5d31a8(0x158)](),_0x1a5599=await transfers_finished[_0x5d31a8(0xa9)](_0x47caf4['params']['id']);let _0xf5d46b;if(_0x528c13[_0x5d31a8(0xda)]==_0x5d31a8(0x144)){const _0x24a087=await staff[_0x5d31a8(0x95)]({'email':_0x528c13[_0x5d31a8(0xc2)]});_0xf5d46b=await warehouse[_0x5d31a8(0x158)]({'status':_0x5d31a8(0xbd),'name':_0x24a087[_0x5d31a8(0xcb)],'warehouse_category':_0x5d31a8(0x10e)});}else _0xf5d46b=await warehouse[_0x5d31a8(0x158)]({'status':_0x5d31a8(0xbd),'warehouse_category':'Finished\x20Goods'});const _0x275e53=await warehouse[_0x5d31a8(0xe6)]([{'$match':{'name':_0x1a5599[_0x5d31a8(0x8e)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x5d31a8(0x10f)},{'$group':{'_id':_0x5d31a8(0x164),'name':{'$first':_0x5d31a8(0x120)},'product_stock':{'$first':_0x5d31a8(0xcd)},'bay':{'$first':_0x5d31a8(0x112)},'bin':{'$first':_0x5d31a8(0x160)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5d31a8(0xa5)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5d31a8(0xd9)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5d31a8(0xf6)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5d31a8(0xc9)},'room':{'$first':'$room'},'warehoue_name':{'$first':'$name'}}}]),_0x1a2b65=await product[_0x5d31a8(0x158)]({});if(_0x3317a4[0x0]['language']==_0x5d31a8(0x145)){var _0x19078e=users[_0x5d31a8(0xef)];console[_0x5d31a8(0x97)](_0x19078e);}else{if(_0x3317a4[0x0][_0x5d31a8(0x107)]==_0x5d31a8(0x10a))var _0x19078e=users['Hindi'];else{if(_0x3317a4[0x0][_0x5d31a8(0x107)]==_0x5d31a8(0x156))var _0x19078e=users[_0x5d31a8(0x156)];else{if(_0x3317a4[0x0][_0x5d31a8(0x107)]=='Spanish')var _0x19078e=users['Spanish'];else{if(_0x3317a4[0x0][_0x5d31a8(0x107)]==_0x5d31a8(0xed))var _0x19078e=users[_0x5d31a8(0xed)];else{if(_0x3317a4[0x0][_0x5d31a8(0x107)]==_0x5d31a8(0x126))var _0x19078e=users[_0x5d31a8(0xbb)];else{if(_0x3317a4[0x0]['language']==_0x5d31a8(0x162))var _0x19078e=users[_0x5d31a8(0x162)];else{if(_0x3317a4[0x0][_0x5d31a8(0x107)]==_0x5d31a8(0x90))var _0x19078e=users[_0x5d31a8(0xe0)];}}}}}}}_0x4ca19e[_0x5d31a8(0x14f)](_0x5d31a8(0xad),{'success':_0x47caf4['flash'](_0x5d31a8(0x123)),'errors':_0x47caf4[_0x5d31a8(0x131)](_0x5d31a8(0xd8)),'role':_0x528c13,'profile':_0x1cc5b6,'master_shop':_0x3317a4,'warehouse':_0xf5d46b,'transfer':_0x1a5599,'stock':_0x275e53,'unit':_0x1a2b65,'language':_0x19078e});}catch(_0x48c1c9){console['log'](_0x48c1c9);}}),router[a0_0x5622d7(0x106)](a0_0x5622d7(0x109),auth,async(_0x23d9cf,_0x4c5502)=>{var _0x27488f=a0_0x5622d7;try{const {invoice:_0x5e01ab,from_warehouse:_0x759490,FromRoom_name:_0x9d9a9e,to_warehouse:_0x4dabca,ToRoom_name:_0x40f3ab}=_0x23d9cf[_0x27488f(0xf8)],_0x2a4166=await transfers_finished[_0x27488f(0xa9)](_0x23d9cf['params']['id']),_0x5dd810=_0x2a4166[_0x27488f(0x142)][_0x27488f(0x9f)](async _0x345383=>{var _0xf9e166=_0x27488f;if(_0x345383['to_quantity']>0x0){var _0x134ca3=await warehouse['findOne']({'name':_0x759490,'room':_0x345383['from_room_name'],'warehouse_category':_0xf9e166(0x10e)});const _0x5ad08d=_0x134ca3[_0xf9e166(0xdf)][_0xf9e166(0x9f)](_0x5c2923=>{var _0x1f49a4=_0xf9e166;_0x5c2923['product_name']==_0x345383['product_name']&&_0x5c2923[_0x1f49a4(0x88)]==_0x345383[_0x1f49a4(0x15f)]&&_0x5c2923[_0x1f49a4(0x15d)]==_0x345383[_0x1f49a4(0x15d)]&&_0x5c2923[_0x1f49a4(0x8d)]==_0x345383[_0x1f49a4(0x8d)]&&_0x5c2923[_0x1f49a4(0x128)]==_0x345383['batch_code']&&_0x5c2923[_0x1f49a4(0x99)]==_0x345383[_0x1f49a4(0xf2)]&&(console[_0x1f49a4(0x97)]('here1',_0x5c2923['product_stock']),typeof _0x345383['id_transaction']==_0x1f49a4(0x13e)?_0x5c2923[_0x1f49a4(0x138)]=Math['max'](0x0,Math[_0x1f49a4(0xae)](_0x5c2923[_0x1f49a4(0x138)])-Math[_0x1f49a4(0xae)](_0x345383[_0x1f49a4(0x8f)])):_0x5c2923[_0x1f49a4(0x138)]=Math[_0x1f49a4(0x157)](0x0,Math[_0x1f49a4(0xae)](_0x5c2923['product_stock'])-Math['abs'](_0x345383[_0x1f49a4(0x8f)])));});}return _0x134ca3;});Promise['all'](_0x5dd810)[_0x27488f(0x161)](async _0x5ee5f7=>{var _0x5ba886=_0x27488f;try{for(const _0xc28204 of _0x5ee5f7){await _0xc28204[_0x5ba886(0x163)]();}const _0x1b1d04=_0x2a4166[_0x5ba886(0x142)][_0x5ba886(0x9f)](async _0x4f37e4=>{var _0x5c3b77=_0x5ba886,_0x3e138b=await warehouse[_0x5c3b77(0x95)]({'name':_0x4dabca,'room':_0x4f37e4[_0x5c3b77(0x14c)]});if(_0x4f37e4[_0x5c3b77(0x8f)]>0x0){var _0x411c56=0x0;const _0x4dc2e7=_0x3e138b[_0x5c3b77(0xdf)][_0x5c3b77(0x9f)](_0x3aa6e7=>{var _0x4b3411=_0x5c3b77;_0x3aa6e7[_0x4b3411(0x10d)]==_0x4f37e4[_0x4b3411(0x10d)]&&_0x3aa6e7[_0x4b3411(0x88)]==_0x4f37e4['to_bay']&&_0x3aa6e7[_0x4b3411(0x15d)]==_0x4f37e4[_0x4b3411(0x15d)]&&_0x3aa6e7[_0x4b3411(0x8d)]==_0x4f37e4[_0x4b3411(0x8d)]&&_0x3aa6e7[_0x4b3411(0x128)]==_0x4f37e4['batch_code']&&_0x3aa6e7[_0x4b3411(0x99)]==_0x4f37e4[_0x4b3411(0xa2)]&&(typeof _0x4f37e4[_0x4b3411(0xe4)]==_0x4b3411(0x13e)?(console[_0x4b3411(0x97)]('here2',_0x3aa6e7[_0x4b3411(0x138)]+_0x4b3411(0x101)+_0x3aa6e7[_0x4b3411(0x13b)]+_0x4b3411(0x84)+Math[_0x4b3411(0xae)](_0x3aa6e7[_0x4b3411(0x138)])+Math[_0x4b3411(0xae)](_0x4f37e4[_0x4b3411(0x8f)])),_0x3aa6e7[_0x4b3411(0x138)]=Math[_0x4b3411(0xae)](_0x3aa6e7[_0x4b3411(0x138)])+Math[_0x4b3411(0xae)](_0x4f37e4['to_quantity'])):_0x3aa6e7[_0x4b3411(0x138)]=Math[_0x4b3411(0xae)](_0x3aa6e7['product_stock'])+Math[_0x4b3411(0xae)](_0x4f37e4[_0x4b3411(0x8f)]),_0x411c56++);});_0x411c56=='0'&&(_0x3e138b[_0x5c3b77(0xdf)]=_0x3e138b[_0x5c3b77(0xdf)][_0x5c3b77(0x114)]({'product_name':_0x4f37e4[_0x5c3b77(0x10d)],'product_stock':_0x4f37e4[_0x5c3b77(0x8f)],'bay':_0x4f37e4['to_bay'],'product_code':_0x4f37e4[_0x5c3b77(0x13a)],'primary_code':_0x4f37e4[_0x5c3b77(0xb0)],'secondary_code':_0x4f37e4['secondary_code'],'expiry_date':_0x4f37e4[_0x5c3b77(0x15d)],'production_date':_0x4f37e4[_0x5c3b77(0x8d)],'maxProducts':_0x4f37e4[_0x5c3b77(0x11a)],'batch_code':_0x4f37e4[_0x5c3b77(0x128)],'secondary_unit':_0x4f37e4['secondary_unit'],'unit':_0x4f37e4[_0x5c3b77(0xeb)],'maxProducts':_0x4f37e4['maxProducts'],'maxPerUnit':_0x4f37e4['maxPerUnit'],'invoice':_0x4f37e4[_0x5c3b77(0xa2)]}));}return _0x3e138b;});Promise[_0x5ba886(0xb4)](_0x1b1d04)[_0x5ba886(0x161)](async _0x250a2a=>{var _0x41e2ad=_0x5ba886;try{for(const _0x5e92d8 of _0x250a2a){await warehouse[_0x41e2ad(0x89)]({'_id':_0x5e92d8[_0x41e2ad(0x13b)]},{'$addToSet':{'product_details':{'$each':_0x5e92d8[_0x41e2ad(0xdf)]}}});}_0x2a4166[_0x41e2ad(0x137)]='True';const _0x57ed77=await _0x2a4166['save'](),_0x2f2dca=await master_shop['find'](),_0x46b044=await email_settings[_0x41e2ad(0x95)](),_0x4ffd87=await supervisor_settings[_0x41e2ad(0x158)]();var _0x51309f=_0x2a4166[_0x41e2ad(0x142)],_0x50eff5='',_0x4e2208;for(_0x4e2208 in _0x51309f){var _0x38a496='FG';_0x2a4166[_0x41e2ad(0x118)]==_0x41e2ad(0xa7)&&(_0x38a496='DG'),_0x50eff5+=_0x41e2ad(0xf0)+_0x41e2ad(0x136)+_0x51309f[_0x4e2208][_0x41e2ad(0x10d)]+_0x41e2ad(0x14d)+_0x41e2ad(0x136)+_0x51309f[_0x4e2208][_0x41e2ad(0x13a)]+_0x41e2ad(0x14d)+_0x41e2ad(0x136)+_0x51309f[_0x4e2208][_0x41e2ad(0x8f)]+_0x41e2ad(0x14d)+_0x41e2ad(0x136)+_0x51309f[_0x4e2208][_0x41e2ad(0xeb)]+_0x41e2ad(0x14d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x51309f[_0x4e2208][_0x41e2ad(0xfa)]+_0x41e2ad(0x14d)+_0x41e2ad(0x136)+_0x2a4166[_0x41e2ad(0x118)]+_0x41e2ad(0x14d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x51309f[_0x4e2208][_0x41e2ad(0x14c)]+_0x41e2ad(0x14d)+_0x41e2ad(0x136)+_0x38a496+_0x51309f[_0x4e2208]['to_bay']+_0x41e2ad(0x14d)+_0x41e2ad(0x108);}let _0x26abeb=nodemailer['createTransport']({'host':_0x46b044['host'],'port':Number(_0x46b044[_0x41e2ad(0xb2)]),'secure':![],'auth':{'user':_0x46b044[_0x41e2ad(0xc2)],'pass':_0x46b044[_0x41e2ad(0x12c)]}}),_0x23f1d4={'from':_0x46b044['email'],'to':_0x4ffd87[0x0][_0x41e2ad(0x85)],'subject':_0x41e2ad(0xd5),'attachments':[{'filename':_0x41e2ad(0xe3),'path':__dirname+_0x41e2ad(0x9b)+_0x41e2ad(0xdd)+_0x2f2dca[0x0][_0x41e2ad(0x117)],'cid':_0x41e2ad(0x11d)}],'html':_0x41e2ad(0x132)+'<html><head><title></title>'+_0x41e2ad(0xc5)+_0x41e2ad(0x12a)+_0x41e2ad(0x149)+_0x41e2ad(0x12a)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x41e2ad(0x96)+_0x41e2ad(0x12a)+_0x41e2ad(0x119)+_0x2f2dca[0x0][_0x41e2ad(0xec)]+_0x41e2ad(0x9c)+_0x41e2ad(0x96)+_0x41e2ad(0x96)+_0x41e2ad(0xe5)+_0x41e2ad(0x12a)+_0x41e2ad(0x8c)+_0x41e2ad(0xc3)+_0x2a4166[_0x41e2ad(0x99)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x41e2ad(0xc1)+_0x2a4166[_0x41e2ad(0x105)]+'\x20'+_0x41e2ad(0x12b)+'</h5>'+_0x41e2ad(0x96)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x41e2ad(0xf3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x41e2ad(0x13f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x41e2ad(0xd7)+_0x41e2ad(0x113)+_0x41e2ad(0x12e)+_0x41e2ad(0xdb)+_0x41e2ad(0x108)+_0x41e2ad(0xaf)+_0x41e2ad(0xe8)+'\x20'+_0x50eff5+'\x20'+'</tbody>'+_0x41e2ad(0xe7)+_0x41e2ad(0x12a)+_0x41e2ad(0x11f)+_0x41e2ad(0xb7)+_0x2f2dca[0x0][_0x41e2ad(0xec)]+_0x41e2ad(0x103)+_0x41e2ad(0x96)+_0x41e2ad(0x96)+_0x41e2ad(0x10c)};_0x26abeb['sendMail'](_0x23f1d4,function(_0x395cb6,_0x2143b7){var _0x1c3f61=_0x41e2ad;_0x395cb6?(console['log'](_0x395cb6),console[_0x1c3f61(0x97)]('Error\x20Occurs')):console[_0x1c3f61(0x97)](_0x1c3f61(0x98));}),_0x23d9cf['flash'](_0x41e2ad(0x123),'Transfer\x20Finalize\x20Successfully'),_0x4c5502[_0x41e2ad(0xff)]('/picking_list/PDF_transfer/'+_0x57ed77['_id']);}catch(_0x222b8f){console[_0x41e2ad(0x152)](_0x222b8f),_0x4c5502[_0x41e2ad(0x130)](0x1f4)['json']({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x5ba886(0x12f)](_0x5536de=>{var _0x5e4084=_0x5ba886;console[_0x5e4084(0x152)](_0x5536de),_0x4c5502[_0x5e4084(0x130)](0x1f4)['json']({'error':_0x5e4084(0x140)});});}catch(_0x16f902){console['error'](_0x16f902),_0x4c5502['status'](0x1f4)[_0x5ba886(0xce)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x27488f(0x12f)](_0x4d4f6b=>{var _0x401486=_0x27488f;console['error'](_0x4d4f6b),_0x4c5502['status'](0x1f4)[_0x401486(0xce)]({'error':_0x401486(0x140)});});}catch(_0x1474c0){_0x4c5502['json']({'message':_0x1474c0[_0x27488f(0xca)]});}});function BayBinSelected(_0x423603,_0x8a57e0){var _0x535244=a0_0x5622d7,_0x715537=[];let _0x3dd11f=[];var _0x56a121=[];if(_0x423603=='DRY\x20GOODS'){switch(_0x8a57e0){case _0x535244(0xab):_0x715537=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x535244(0x127):_0x715537=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x56a121=['DG'];}else{if(_0x423603==_0x535244(0xa3)){switch(_0x8a57e0){case _0x535244(0xab):_0x715537=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x715537=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x56a121=['FG'];}}return{'levels':_0x715537,'identify':_0x56a121};}router[a0_0x5622d7(0x13c)]('/view/:id',auth,async(_0x33051c,_0x9c2740)=>{var _0x3d6524=a0_0x5622d7;try{const {username:_0x3b3a65,email:_0x399d99,role:_0x54a3b1}=_0x33051c[_0x3d6524(0xfe)],_0x277833=_0x33051c[_0x3d6524(0xfe)],_0x2bee2a=await profile[_0x3d6524(0x95)]({'email':_0x277833[_0x3d6524(0xc2)]}),_0xeac84c=await master_shop[_0x3d6524(0x158)](),_0x111218=await transfers_finished[_0x3d6524(0xa9)](_0x33051c[_0x3d6524(0x11e)]['id']);let _0x2dc2cd=new Date(_0x111218[_0x3d6524(0x15d)]),_0x10aef9=('0'+_0x2dc2cd[_0x3d6524(0x125)]())[_0x3d6524(0x93)](-0x2),_0x22a403=('0'+(_0x2dc2cd[_0x3d6524(0xd1)]()+0x1))[_0x3d6524(0x93)](-0x2),_0x1917bd=_0x2dc2cd['getFullYear'](),_0x74ad18=_0x1917bd+'-'+_0x22a403+'-'+_0x10aef9,_0x5005ac;if(_0x277833[_0x3d6524(0xda)]==_0x3d6524(0x144)){const _0x391f2f=await staff[_0x3d6524(0x95)]({'email':_0x277833[_0x3d6524(0xc2)]});_0x5005ac=await warehouse['find']({'status':'Enabled','name':_0x391f2f[_0x3d6524(0xcb)],'warehouse_category':'Finished\x20Goods'});}else _0x5005ac=await warehouse['find']({'status':'Enabled','warehouse_category':_0x3d6524(0x10e)});const _0x41b18b=await warehouse[_0x3d6524(0xe6)]([{'$match':{'name':_0x111218[_0x3d6524(0x8e)],'room':_0x111218[_0x3d6524(0x86)]}},{'$unwind':_0x3d6524(0x10f)},{'$group':{'_id':_0x3d6524(0x164),'name':{'$first':_0x3d6524(0x120)},'product_stock':{'$first':_0x3d6524(0xcd)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3d6524(0x92)},'floorlevel':{'$first':_0x3d6524(0xa5)},'primary_code':{'$first':_0x3d6524(0x87)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]);var _0x378fe0=[0x1,0x2,0x3,0x4],_0xf60e68=['A','B','C','D','E','F','G','H','I','J'],_0x5ca73e=[_0x3d6524(0xc7),_0x3d6524(0xaa)];const _0x569d40=await product[_0x3d6524(0x158)]({}),_0x1adc56=BayBinSelected(_0x111218[_0x3d6524(0x118)],_0x111218['to_room']);if(_0xeac84c[0x0][_0x3d6524(0x107)]=='English\x20(US)'){var _0x2c6137=users[_0x3d6524(0xef)];console[_0x3d6524(0x97)](_0x2c6137);}else{if(_0xeac84c[0x0][_0x3d6524(0x107)]=='Hindi')var _0x2c6137=users[_0x3d6524(0x10a)];else{if(_0xeac84c[0x0][_0x3d6524(0x107)]=='German')var _0x2c6137=users[_0x3d6524(0x156)];else{if(_0xeac84c[0x0]['language']==_0x3d6524(0xbc))var _0x2c6137=users[_0x3d6524(0xbc)];else{if(_0xeac84c[0x0]['language']=='French')var _0x2c6137=users['French'];else{if(_0xeac84c[0x0][_0x3d6524(0x107)]==_0x3d6524(0x126))var _0x2c6137=users[_0x3d6524(0xbb)];else{if(_0xeac84c[0x0]['language']=='Chinese')var _0x2c6137=users[_0x3d6524(0x162)];else{if(_0xeac84c[0x0][_0x3d6524(0x107)]==_0x3d6524(0x90))var _0x2c6137=users[_0x3d6524(0xe0)];}}}}}}}_0x9c2740['render'](_0x3d6524(0x155),{'success':_0x33051c[_0x3d6524(0x131)](_0x3d6524(0x123)),'errors':_0x33051c[_0x3d6524(0x131)](_0x3d6524(0xd8)),'role':_0x277833,'profile':_0x2bee2a,'master_shop':_0xeac84c,'warehouse':_0x5005ac,'transfer':_0x111218,'stock':_0x41b18b,'unit':_0x569d40,'language':_0x2c6137,'levels':_0x378fe0,'Isle':_0xf60e68,'rooms_data':_0x5ca73e,'ed_fullDate':_0x74ad18,'dataSelected':_0x1adc56});}catch(_0x487703){console[_0x3d6524(0x97)](_0x487703);}}),router[a0_0x5622d7(0x106)](a0_0x5622d7(0x15c),auth,async(_0x432bf0,_0x404801)=>{var _0x41eb90=a0_0x5622d7;try{const _0xf32388=_0x432bf0[_0x41eb90(0x11e)]['id'];console[_0x41eb90(0x97)](_0x432bf0['body']);const _0x36f69c=await transfers_finished[_0x41eb90(0xa9)](_0xf32388);console['log'](_0x41eb90(0x8a),_0x36f69c);const {date:_0x35bdb4,from_warehouse:_0x5b8a31,FromRoom_name:_0x27d1c5,to_warehouse:_0x479fc2,ToRoom_name:_0x2283c9,prod_name:_0x5173e0,from_prod_qty:_0x114be6,from_prod_level:_0x2537bc,from_prod_isle:_0x468e34,from_prod_pallet:_0x1f2ec8,to_prod_qty:_0x440518,to_prod_level:_0x11e25d,to_prod_isle:_0x1f2607,to_prod_pallet:_0x499aa0,primary_code:_0x3950b2,secondary_code:_0x28cd20,product_code3:_0x1974c0,note:_0x79ae56,invoice:_0x5d79eb,expiry_date:_0xb4f3cf}=_0x432bf0[_0x41eb90(0xf8)];if(typeof _0x5173e0=='string')var _0x31dc56=[_0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0xcc)]],_0xa5a043=[_0x432bf0['body']['from_prod_qty']],_0x14396d=[_0x432bf0['body'][_0x41eb90(0xa8)]],_0x58d622=[_0x432bf0[_0x41eb90(0xf8)]['to_prod_qty']],_0x150345=[_0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0xea)]],_0x1ee8cb=[_0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0xb0)]],_0x212e26=[_0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0x9e)]],_0x1549bc=[_0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0x124)]],_0xff33fc=[_0x432bf0[_0x41eb90(0xf8)]['MaxStocks_data2']],_0x5cd4bb=[_0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0xeb)]],_0x56990b=[_0x432bf0[_0x41eb90(0xf8)]['secondary_unit']],_0x124e7d=[_0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0x128)]],_0x316465=[_0x432bf0[_0x41eb90(0xf8)]['expiry_date']];else var _0x31dc56=[..._0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0xcc)]],_0xa5a043=[..._0x432bf0[_0x41eb90(0xf8)]['from_prod_qty']],_0x14396d=[..._0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0xa8)]],_0x58d622=[..._0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0x15a)]],_0x150345=[..._0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0xea)]],_0x1ee8cb=[..._0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0xb0)]],_0x212e26=[..._0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0x9e)]],_0x1549bc=[..._0x432bf0['body']['product_code3']],_0xff33fc=[..._0x432bf0[_0x41eb90(0xf8)][_0x41eb90(0xf5)]],_0x5cd4bb=[..._0x432bf0['body'][_0x41eb90(0xeb)]],_0x56990b=[..._0x432bf0['body'][_0x41eb90(0xfa)]],_0x124e7d=[..._0x432bf0[_0x41eb90(0xf8)]['batch_code']],_0x316465=[..._0x432bf0['body'][_0x41eb90(0x15d)]];const _0x57a3fc=_0x31dc56[_0x41eb90(0x9f)](_0x32d2b9=>{return _0x32d2b9={'product_name':_0x32d2b9};});_0xa5a043['forEach']((_0x169361,_0x1582c5)=>{var _0x4efb23=_0x41eb90;_0x57a3fc[_0x1582c5][_0x4efb23(0xd4)]=_0x169361;}),_0x14396d['forEach']((_0x5b523b,_0x3f4f7a)=>{var _0x7c885b=_0x41eb90;_0x57a3fc[_0x3f4f7a][_0x7c885b(0x15f)]=_0x5b523b;}),_0x58d622[_0x41eb90(0xa0)]((_0x14da20,_0xe6263a)=>{var _0x40125a=_0x41eb90;_0x57a3fc[_0xe6263a][_0x40125a(0x8f)]=_0x14da20;}),_0x150345['forEach']((_0x23b022,_0x4bb2b6)=>{var _0x3e9ea3=_0x41eb90;_0x57a3fc[_0x4bb2b6][_0x3e9ea3(0xd6)]=_0x23b022;}),_0x1ee8cb[_0x41eb90(0xa0)]((_0xc34145,_0x3e14aa)=>{_0x57a3fc[_0x3e14aa]['primary_code']=_0xc34145;}),_0x212e26[_0x41eb90(0xa0)]((_0x4deb46,_0x3878cf)=>{var _0x5b1d7e=_0x41eb90;_0x57a3fc[_0x3878cf][_0x5b1d7e(0x9e)]=_0x4deb46;}),_0x1549bc[_0x41eb90(0xa0)]((_0x261c9c,_0x3d0374)=>{var _0x3928fd=_0x41eb90;_0x57a3fc[_0x3d0374][_0x3928fd(0x13a)]=_0x261c9c;}),_0xff33fc[_0x41eb90(0xa0)]((_0x22e371,_0x3510e5)=>{var _0x190274=_0x41eb90;_0x57a3fc[_0x3510e5][_0x190274(0x11a)]=_0x22e371;}),_0x5cd4bb[_0x41eb90(0xa0)]((_0x41ce8e,_0x332ea5)=>{var _0x40e8fe=_0x41eb90;_0x57a3fc[_0x332ea5][_0x40e8fe(0xeb)]=_0x41ce8e;}),_0x56990b['forEach']((_0x4b64b6,_0x29f871)=>{_0x57a3fc[_0x29f871]['secondary_unit']=_0x4b64b6;}),_0x124e7d[_0x41eb90(0xa0)]((_0x578ad9,_0x512bd7)=>{_0x57a3fc[_0x512bd7]['batch_code']=_0x578ad9;}),_0x316465[_0x41eb90(0xa0)]((_0x399f50,_0x4dc728)=>{var _0x84cf4c=_0x41eb90;_0x57a3fc[_0x4dc728][_0x84cf4c(0x15d)]=_0x399f50;});const _0x133bb1=_0x57a3fc[_0x41eb90(0xb6)](_0x10d913=>_0x10d913[_0x41eb90(0x8f)]!=='0'&&_0x10d913['to_quantity']!==''||_0x10d913['to_floorlevel']!=='0'&&_0x10d913[_0x41eb90(0x15b)]!=='');var _0xa781ed=0x0;_0x133bb1[_0x41eb90(0xa0)](_0x2d3f3e=>{var _0x3d1b5e=_0x41eb90;parseInt(_0x2d3f3e[_0x3d1b5e(0xd4)])<parseInt(_0x2d3f3e['to_quantity'])&&_0xa781ed++;});if(_0xa781ed!=0x0)return _0x432bf0[_0x41eb90(0x131)](_0x41eb90(0xd8),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x404801['redirect'](_0x41eb90(0x11b));const _0x41bcac=await warehouse[_0x41eb90(0x95)]({'name':_0x36f69c[_0x41eb90(0x8e)],'room':_0x36f69c['from_room']});_0x36f69c['product'][_0x41eb90(0xa0)](_0x231187=>{var _0x5611ca=_0x41eb90;if(_0x231187[_0x5611ca(0x8f)]>0x0){const _0x3724c4=_0x41bcac['product_details'][_0x5611ca(0x9f)](_0xed44c1=>{var _0x4b1f6b=_0x5611ca;_0xed44c1['product_name']==_0x231187[_0x4b1f6b(0x10d)]&&_0xed44c1[_0x4b1f6b(0x88)]==_0x231187[_0x4b1f6b(0x15f)]&&(_0xed44c1[_0x4b1f6b(0x138)]=parseInt(_0xed44c1[_0x4b1f6b(0x138)])+parseInt(_0x231187[_0x4b1f6b(0x8f)]));});}}),await _0x41bcac[_0x41eb90(0x163)]();const _0x492c9f=await warehouse['findOne']({'name':_0x36f69c[_0x41eb90(0x118)],'room':_0x36f69c[_0x41eb90(0xcf)]});_0x36f69c['product']['forEach'](_0xb30b17=>{var _0x41ca6d=_0x41eb90;if(_0xb30b17[_0x41ca6d(0x8f)]>0x0){const _0x137dae=_0x492c9f[_0x41ca6d(0xdf)]['map'](_0x5f2ecd=>{var _0x47710a=_0x41ca6d;_0x5f2ecd[_0x47710a(0x10d)]==_0xb30b17[_0x47710a(0x10d)]&&_0x5f2ecd['bay']==_0xb30b17[_0x47710a(0xd6)]&&(_0x5f2ecd[_0x47710a(0x138)]=parseInt(_0x5f2ecd[_0x47710a(0x138)])-parseInt(_0xb30b17['to_quantity']));});}}),await _0x492c9f[_0x41eb90(0x163)](),_0x36f69c['date']=_0x35bdb4,_0x36f69c[_0x41eb90(0x8e)]=_0x5b8a31,_0x36f69c['to_warehouse']=_0x479fc2,_0x36f69c[_0x41eb90(0x142)]=_0x133bb1,_0x36f69c[_0x41eb90(0xc8)]=_0x79ae56,_0x36f69c[_0x41eb90(0x99)]=_0x5d79eb;const _0x19e24d=await _0x36f69c[_0x41eb90(0x163)](),_0xc7d1ec=await warehouse[_0x41eb90(0x95)]({'name':_0x5b8a31,'room':_0x27d1c5});_0x19e24d['product'][_0x41eb90(0xa0)](_0x1cbcea=>{var _0x33c801=_0x41eb90;if(_0x1cbcea[_0x33c801(0x8f)]>0x0){const _0x114b8d=_0xc7d1ec['product_details']['map'](_0x1a39bc=>{var _0x4aaa51=_0x33c801;_0x1a39bc[_0x4aaa51(0x10d)]==_0x1cbcea[_0x4aaa51(0x10d)]&&_0x1a39bc[_0x4aaa51(0x88)]==_0x1cbcea['from_bay']&&(_0x1a39bc[_0x4aaa51(0x138)]=parseInt(_0x1a39bc[_0x4aaa51(0x138)])-parseInt(_0x1cbcea['to_quantity']));});}}),await _0xc7d1ec[_0x41eb90(0x163)]();const _0x3f021c=await warehouse[_0x41eb90(0x95)]({'name':_0x479fc2,'room':_0x2283c9});_0x19e24d['product'][_0x41eb90(0xa0)](_0x1ba6b5=>{var _0x3e9794=_0x41eb90;if(_0x1ba6b5['to_quantity']>0x0){var _0x13c7c1=0x0;const _0x105030=_0x3f021c['product_details'][_0x3e9794(0x9f)](_0x31e10b=>{var _0x1a1b52=_0x3e9794;_0x31e10b[_0x1a1b52(0x10d)]==_0x1ba6b5['product_name']&&_0x31e10b[_0x1a1b52(0x88)]==_0x1ba6b5[_0x1a1b52(0xd6)]&&(_0x31e10b[_0x1a1b52(0x138)]=parseInt(_0x31e10b['product_stock'])+parseInt(_0x1ba6b5[_0x1a1b52(0x8f)]),_0x13c7c1++);});_0x13c7c1=='0'&&(_0x3f021c[_0x3e9794(0xdf)]=_0x3f021c[_0x3e9794(0xdf)][_0x3e9794(0x114)]({'product_name':_0x1ba6b5[_0x3e9794(0x10d)],'product_stock':_0x1ba6b5[_0x3e9794(0x8f)],'bay':_0x1ba6b5[_0x3e9794(0xd6)],'product_code':_0x1ba6b5[_0x3e9794(0x13a)],'primary_code':_0x1ba6b5[_0x3e9794(0xb0)],'secondary_code':_0x1ba6b5[_0x3e9794(0x9e)],'maxProducts':_0x1ba6b5['maxProducts']}));}}),await _0x3f021c[_0x41eb90(0x163)](),_0x432bf0[_0x41eb90(0x131)](_0x41eb90(0x123),_0x41eb90(0xd3)),_0x404801[_0x41eb90(0xff)](_0x41eb90(0xf9));}catch(_0x26f147){console[_0x41eb90(0x97)](_0x26f147);}}),router['post'](a0_0x5622d7(0xe9),async(_0x3063d9,_0x447980)=>{var _0x143303=a0_0x5622d7;const {FromWareHouse:_0x55f8da,FromRoom:_0x525515,ToWarehouse:_0x2e64ff,ToRoom:_0x4c3883,primary_code:_0xcf21cc,Roomslist:_0x4a1030}=_0x3063d9[_0x143303(0xf8)],_0x1356c4=_0x4a1030[_0x143303(0x13d)](','),_0x15ecf3=[];async function _0x10d756(_0xbe0aa0){var _0x5c6163=_0x143303;const _0x452311=await warehouse[_0x5c6163(0xe6)]([{'$match':{'name':_0x55f8da,'room':_0xbe0aa0}},{'$unwind':_0x5c6163(0x10f)},{'$match':{'product_details.primary_code':_0xcf21cc}},{'$group':{'_id':_0x5c6163(0x164),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x5c6163(0xcd)},'primary_code':{'$first':_0x5c6163(0x87)},'secondary_code':{'$first':_0x5c6163(0xd9)},'product_code':{'$first':_0x5c6163(0xfc)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5c6163(0x160)},'type':{'$first':_0x5c6163(0x92)},'pallet':{'$first':_0x5c6163(0xa5)},'unit':{'$first':_0x5c6163(0x12d)},'secondary_unit':{'$first':_0x5c6163(0xfd)},'storage':{'$first':_0x5c6163(0xf6)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5c6163(0x135)},'production_date':{'$first':_0x5c6163(0xc9)},'batch_code':{'$first':_0x5c6163(0x143)},'maxPerUnit':{'$first':_0x5c6163(0xb9)},'roomNamed':{'$first':_0x5c6163(0x147)},'prod_cat':{'$first':'P'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x2cdcea=await warehouse['aggregate']([{'$match':{'name':_0x55f8da,'room':_0xbe0aa0}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0xcf21cc}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x5c6163(0xcd)},'primary_code':{'$first':_0x5c6163(0x87)},'secondary_code':{'$first':_0x5c6163(0xd9)},'product_code':{'$first':_0x5c6163(0xfc)},'level':{'$first':_0x5c6163(0x112)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x5c6163(0x92)},'pallet':{'$first':_0x5c6163(0xa5)},'unit':{'$first':_0x5c6163(0x12d)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x5c6163(0xf6)},'rack':{'$first':_0x5c6163(0xdc)},'expiry_date':{'$first':_0x5c6163(0x135)},'production_date':{'$first':_0x5c6163(0xc9)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x5c6163(0xb9)},'roomNamed':{'$first':_0x5c6163(0x147)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x5c6163(0x159)}}}]);if(_0x452311[_0x5c6163(0x151)]>0x0)_0x15ecf3[_0x5c6163(0x122)](_0x452311);else _0x2cdcea['length']>0x0&&_0x15ecf3[_0x5c6163(0x122)](_0x2cdcea);}const _0x207a2c=_0x1356c4[_0x143303(0x9f)](_0x2b4249=>_0x10d756(_0x2b4249));await Promise['all'](_0x207a2c),_0x447980[_0x143303(0xce)](_0x15ecf3);}),router[a0_0x5622d7(0x106)](a0_0x5622d7(0xbe),async(_0x3c5154,_0x2fc4b2)=>{var _0x34f053=a0_0x5622d7;try{const {FromWareHouse:_0x5240b7,FromRoom:_0x1ac179,ToWarehouse:_0x2bbb49,ToRoom:_0x5f57e4,secondary_code:_0x2d7a3a}=_0x3c5154[_0x34f053(0xf8)],_0x23b466=await warehouse['aggregate']([{'$match':{'name':_0x5240b7}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x2d7a3a}},{'$group':{'_id':_0x34f053(0x164),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x34f053(0x87)},'secondary_code':{'$first':_0x34f053(0xd9)},'product_code':{'$first':_0x34f053(0xfc)},'instock':{'$first':_0x34f053(0xcd)},'warehouse':{'$first':_0x34f053(0xf1)},'level':{'$first':_0x34f053(0x148)},'isle':{'$first':_0x34f053(0x102)},'pallet':{'$first':_0x34f053(0x104)},'maxProducts':{'$first':_0x34f053(0xa6)},'unit':{'$first':_0x34f053(0x12d)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x34f053(0xc9)}}}]);_0x2fc4b2['status'](0xc8)['json'](_0x23b466);}catch(_0x506a2a){_0x2fc4b2[_0x34f053(0x130)](0x194)['json']({'message':_0x506a2a[_0x34f053(0xca)]});}}),router[a0_0x5622d7(0x106)](a0_0x5622d7(0xa1),async(_0xd0eaca,_0x1bca34)=>{var _0x4d0ea3=a0_0x5622d7;try{const {FromWareHouse:_0x468516,FromRoom:_0x4f6ce9,ToWarehouse:_0x948f41,ToRoom:_0x5dcb8c,product_code:_0x42c7d0}=_0xd0eaca[_0x4d0ea3(0xf8)],_0x43d8bf=await warehouse[_0x4d0ea3(0xe6)]([{'$match':{'name':_0x468516}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x42c7d0}},{'$group':{'_id':_0x4d0ea3(0x164),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x4d0ea3(0x87)},'secondary_code':{'$first':_0x4d0ea3(0xd9)},'product_code':{'$first':_0x4d0ea3(0xfc)},'instock':{'$first':_0x4d0ea3(0xcd)},'warehouse':{'$first':_0x4d0ea3(0xf1)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x4d0ea3(0x104)},'maxProducts':{'$first':_0x4d0ea3(0xa6)},'unit':{'$first':_0x4d0ea3(0x12d)}}}]);_0x1bca34[_0x4d0ea3(0x130)](0xc8)[_0x4d0ea3(0xce)](_0x43d8bf);}catch(_0x18ba09){_0x1bca34[_0x4d0ea3(0x130)](0x194)[_0x4d0ea3(0xce)]({'message':_0x18ba09['message']});}}),router[a0_0x5622d7(0x106)](a0_0x5622d7(0xb5),async(_0xac908,_0x57d3eb)=>{var _0x3bf7c9=a0_0x5622d7;const {productCode:_0x17b05a,bay:_0x25dd35,warehouses:_0x219155,room:_0x5c5f2d}=_0xac908['body'];console[_0x3bf7c9(0x97)](_0xac908[_0x3bf7c9(0xf8)]);try{const _0x3de1e2=await warehouse[_0x3bf7c9(0xe6)]([{'$match':{'name':_0x219155,'room':_0x5c5f2d}},{'$unwind':_0x3bf7c9(0x10f)},{'$match':{'product_details.bay':parseInt(_0x25dd35)}},{'$group':{'_id':_0x3bf7c9(0x164),'name':{'$first':_0x3bf7c9(0x120)},'product_stock':{'$first':_0x3bf7c9(0xcd)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x57d3eb['status'](0xc8)[_0x3bf7c9(0xce)](_0x3de1e2);}catch(_0x2864e4){_0x57d3eb[_0x3bf7c9(0x130)](0x194)[_0x3bf7c9(0xce)]({'message':_0x2864e4['message']});}}),module[a0_0x5622d7(0xc6)]=router;