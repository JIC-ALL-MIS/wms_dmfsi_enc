var a0_0xcbcd38=a0_0x2e2d;function a0_0x54b1(){var _0x4e401c=['to_quantity','$date','port','body','$product_details.isle','/CheckingWarehouse','Spanish','\x20Order\x20Date\x20:\x20','to_room','4xKVhoI','$product_details.product_code','to_prod_qty','edit_transfer_finished_view','$product','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.product_name','find','$product_details.expiry_date','updateOne','render','forEach','641730KPYjtc','$product_details.unit','FROZEN\x20GOODS','51460UuDfka','json','staff','Portuguese','secondary_unit','email','note','errors','True','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','prod_cat','flash','$product_details.batch_code','Enclosed','$product_details.maxPerUnit','$invoice','getFullYear','sendMail','<h2>\x20','save','</td>','/barcode_scanner','$room','To_invoice','exports','_id','add_transfer_finished','$product_details.primary_code','filter','$product_details.bay','password','from_room','../public/language/languages.json','$product_details.level','TRFF-','<strong>\x20Regards\x20</strong>','edit_transfer_finished','310QMlXsj','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','success','$product.to_room_name','Router','<!DOCTYPE\x20html>','Rack\x201','invoice','German','<h5\x20style=\x22text-align:\x20left;\x22>','</head><body>','language','findOne','product_details','primary_unit','random','581342GmcCXY','Finished\x20Goods','</div>','/upload/','to_floorlevel','from_room_name','$to_warehouse','/barcode_scanner2','Email\x20sent\x20successfully','from_quantity','/transfer/view','../models/all_models','date','push','78OjKunu','\x20</h2>','map','110SqIaAG','to_bay','from_prod_level','</h5>','<html><head><title></title>','redirect','</tbody>','expiry_date','$product_details','</table>','MaxStocks_data2','product_date','French','$product_details._id','maxProducts','<hr\x20class=\x22my-3\x22>','nodemailer','Chinese','get','maxPerUnit','product','from_bay','length','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Logo.png','\x20Order\x20Number\x20:\x20','</body></html>','229896Ftnzde','<div>','Transfer\x20Finalize\x20Successfully','ToRoomAssigned','params','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.pallet','aggregate','then','message','There\x27s\x20a\x20error\x20in\x20this\x20transaction','product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','host','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','product_code','$product_details.type','to_room_name','604584ODwiHK','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','prod_name','Enabled','batch_code','$product_details.maxProducts','$product_details.secondary_unit','$name','<tbody\x20style=\x22text-align:\x20center;\x22>','New_Qty_Converted','Arabic\x20(ae)','log','all','$finalize','unit','user','createTransport','69321cqOECK','Error\x20Occurs','product_code3','to_invoice','$product_details.rack','3864RjGgsx','<h5>','from_invoice','production_date','$product_details.product_stock','MaxStocks_data','117pKdnFf','role','toString','</thead>','Hindi','bay','Rack\x202','secondary_code','Transfer\x20Edit\x20Successfully','$product_details.invoice','$product_details.secondary_code','/view/:id','$_id','from_prod_qty','error','Arabic','/barcode_scanner3','express','to_warehouse','to_prod_level','split','from_warehouse','logo','post','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','English','</span>','DRY\x20GOODS','$product_details.storage','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','slice','$product_details.floorlevel','Portuguese\x20(BR)','primary_code','FGSEmail','string','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/preview/:id','English\x20(US)','An\x20error\x20occurred.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','concat','QA\x20Warehouse','findById','/picking_list/PDF_transfer/','status','warehouse','product_name','$product_details.production_date','</tr>','back','getDate','image','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.bin','/view'];a0_0x54b1=function(){return _0x4e401c;};return a0_0x54b1();}function a0_0x2e2d(_0xad4af9,_0x9cc505){var _0x54b163=a0_0x54b1();return a0_0x2e2d=function(_0x2e2d06,_0xf06928){_0x2e2d06=_0x2e2d06-0x1c7;var _0x27b03c=_0x54b163[_0x2e2d06];return _0x27b03c;},a0_0x2e2d(_0xad4af9,_0x9cc505);}(function(_0x4fba60,_0x13ea6c){var _0x38617e=a0_0x2e2d,_0x5f312a=_0x4fba60();while(!![]){try{var _0x132c83=parseInt(_0x38617e(0x1d6))/0x1*(-parseInt(_0x38617e(0x21a))/0x2)+parseInt(_0x38617e(0x26e))/0x3+-parseInt(_0x38617e(0x1e5))/0x4*(-parseInt(_0x38617e(0x20a))/0x5)+-parseInt(_0x38617e(0x228))/0x6*(parseInt(_0x38617e(0x269))/0x7)+parseInt(_0x38617e(0x258))/0x8*(parseInt(_0x38617e(0x274))/0x9)+-parseInt(_0x38617e(0x1e2))/0xa+-parseInt(_0x38617e(0x22b))/0xb*(-parseInt(_0x38617e(0x246))/0xc);if(_0x132c83===_0x13ea6c)break;else _0x5f312a['push'](_0x5f312a['shift']());}catch(_0x55de22){_0x5f312a['push'](_0x5f312a['shift']());}}}(a0_0x54b1,0x96b87));const express=require(a0_0xcbcd38(0x285)),app=express(),router=express[a0_0xcbcd38(0x20e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0xcbcd38(0x225)),auth=require('../middleware/auth'),users=require(a0_0xcbcd38(0x205)),nodemailer=require(a0_0xcbcd38(0x23b));router['get'](a0_0xcbcd38(0x1cc),auth,async(_0x255a2f,_0x23bc1a)=>{var _0x1f72ed=a0_0xcbcd38;try{const {username:_0x332a81,email:_0x3051b7,role:_0xbb3da9}=_0x255a2f[_0x1f72ed(0x267)],_0x4bb2e7=_0x255a2f[_0x1f72ed(0x267)],_0x12a783=await profile[_0x1f72ed(0x216)]({'email':_0x4bb2e7[_0x1f72ed(0x1ea)]}),_0x317bee=await master_shop[_0x1f72ed(0x1dd)]();let _0x1acd8c;if(_0x4bb2e7['role']==_0x1f72ed(0x1e7)){const _0x3c0ec2=await staff['findOne']({'email':_0x4bb2e7[_0x1f72ed(0x1ea)]});_0x1acd8c=await transfers_finished[_0x1f72ed(0x1dd)]({'from_warehouse':_0x3c0ec2[_0x1f72ed(0x2a2)]});}else _0x1acd8c=await transfers_finished['aggregate']([{'$unwind':_0x1f72ed(0x1da)},{'$group':{'_id':_0x1f72ed(0x280),'invoice':{'$first':_0x1f72ed(0x1f4)},'date':{'$first':_0x1f72ed(0x1ce)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x1f72ed(0x220)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x1f72ed(0x20d)},'finalize':{'$first':_0x1f72ed(0x265)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x317bee[0x0][_0x1f72ed(0x215)]=='English\x20(US)')var _0xce1f35=users[_0x1f72ed(0x28d)];else{if(_0x317bee[0x0][_0x1f72ed(0x215)]==_0x1f72ed(0x278))var _0xce1f35=users[_0x1f72ed(0x278)];else{if(_0x317bee[0x0][_0x1f72ed(0x215)]=='German')var _0xce1f35=users[_0x1f72ed(0x212)];else{if(_0x317bee[0x0][_0x1f72ed(0x215)]==_0x1f72ed(0x1d3))var _0xce1f35=users[_0x1f72ed(0x1d3)];else{if(_0x317bee[0x0][_0x1f72ed(0x215)]==_0x1f72ed(0x237))var _0xce1f35=users['French'];else{if(_0x317bee[0x0][_0x1f72ed(0x215)]==_0x1f72ed(0x294))var _0xce1f35=users[_0x1f72ed(0x1e8)];else{if(_0x317bee[0x0][_0x1f72ed(0x215)]=='Chinese')var _0xce1f35=users[_0x1f72ed(0x23c)];else{if(_0x317bee[0x0][_0x1f72ed(0x215)]==_0x1f72ed(0x262))var _0xce1f35=users['Arabic'];}}}}}}}_0x23bc1a[_0x1f72ed(0x1e0)]('transfer_finished',{'success':_0x255a2f['flash'](_0x1f72ed(0x20c)),'errors':_0x255a2f['flash'](_0x1f72ed(0x1ec)),'role':_0x4bb2e7,'profile':_0x12a783,'master_shop':_0x317bee,'transfer':_0x1acd8c,'language':_0xce1f35});}catch(_0x5dc37b){console[_0x1f72ed(0x263)](_0x5dc37b);}});async function getRandom8DigitNumber(){var _0x29de0f=a0_0xcbcd38;const _0x2552f9=0x989680,_0x31da92=0x5f5e0ff,_0x5ef259=Math['floor'](Math[_0x29de0f(0x219)]()*(_0x31da92-_0x2552f9+0x1))+_0x2552f9;var _0xa70bf4;const _0x2ca441=await transfers_finished[_0x29de0f(0x216)]({'invoice':_0x29de0f(0x207)+_0x5ef259});return _0x2ca441&&_0x2ca441[_0x29de0f(0x241)]>0x0?_0xa70bf4='TRFF-'+_0x5ef259:_0xa70bf4=_0x29de0f(0x207)+_0x5ef259,_0xa70bf4;}router['get']('/view/add_transfer',auth,async(_0x227c27,_0x3685a6)=>{var _0x2ac56c=a0_0xcbcd38;try{const {username:_0x3bdc9d,email:_0x185e01,role:_0x52d003}=_0x227c27[_0x2ac56c(0x267)],_0x21d4c5=_0x227c27[_0x2ac56c(0x267)],_0x1dc771=await profile[_0x2ac56c(0x216)]({'email':_0x21d4c5[_0x2ac56c(0x1ea)]}),_0x4840f7=await master_shop[_0x2ac56c(0x1dd)]();let _0x55d369;if(_0x21d4c5[_0x2ac56c(0x275)]=='staff'){const _0x383721=await staff['findOne']({'email':_0x21d4c5['email']});_0x55d369=await warehouse[_0x2ac56c(0x24d)]([{'$match':{'status':_0x2ac56c(0x25b),'name':_0x383721[_0x2ac56c(0x2a2)],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x2ac56c(0x29e)}}},{'$group':{'_id':_0x2ac56c(0x25f),'name':{'$first':_0x2ac56c(0x25f)}}}]);}else _0x55d369=await warehouse[_0x2ac56c(0x24d)]([{'$match':{'status':_0x2ac56c(0x25b),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x2ac56c(0x29e)}}},{'$group':{'_id':'$name','name':{'$first':_0x2ac56c(0x25f)}}}]);const _0x3be17f=await transfers_finished[_0x2ac56c(0x1dd)]({}),_0x56c998=_0x3be17f['length']+0x1,_0x217abd=_0x2ac56c(0x207)+_0x56c998[_0x2ac56c(0x276)]()['padStart'](0x5,'0');if(_0x4840f7[0x0][_0x2ac56c(0x215)]=='English\x20(US)')var _0x43e5b0=users[_0x2ac56c(0x28d)];else{if(_0x4840f7[0x0][_0x2ac56c(0x215)]==_0x2ac56c(0x278))var _0x43e5b0=users[_0x2ac56c(0x278)];else{if(_0x4840f7[0x0][_0x2ac56c(0x215)]=='German')var _0x43e5b0=users[_0x2ac56c(0x212)];else{if(_0x4840f7[0x0][_0x2ac56c(0x215)]=='Spanish')var _0x43e5b0=users[_0x2ac56c(0x1d3)];else{if(_0x4840f7[0x0]['language']==_0x2ac56c(0x237))var _0x43e5b0=users[_0x2ac56c(0x237)];else{if(_0x4840f7[0x0][_0x2ac56c(0x215)]=='Portuguese\x20(BR)')var _0x43e5b0=users[_0x2ac56c(0x1e8)];else{if(_0x4840f7[0x0][_0x2ac56c(0x215)]==_0x2ac56c(0x23c))var _0x43e5b0=users[_0x2ac56c(0x23c)];else{if(_0x4840f7[0x0][_0x2ac56c(0x215)]==_0x2ac56c(0x262))var _0x43e5b0=users[_0x2ac56c(0x283)];}}}}}}}const _0x5e8109=getRandom8DigitNumber();_0x5e8109[_0x2ac56c(0x24e)](_0x73c16d=>{var _0x5f1221=_0x2ac56c;_0x3685a6['render'](_0x5f1221(0x1ff),{'success':_0x227c27[_0x5f1221(0x1f0)](_0x5f1221(0x20c)),'errors':_0x227c27[_0x5f1221(0x1f0)](_0x5f1221(0x1ec)),'role':_0x21d4c5,'profile':_0x1dc771,'master_shop':_0x4840f7,'warehouse':_0x55d369,'language':_0x43e5b0,'invoice':_0x73c16d});})['catch'](_0x301c65=>{var _0x196a65=_0x2ac56c;_0x227c27[_0x196a65(0x1f0)](_0x196a65(0x1ec),_0x196a65(0x250)),_0x3685a6[_0x196a65(0x230)](_0x196a65(0x224));});}catch(_0x25ee64){console[_0x2ac56c(0x263)](_0x25ee64);}}),router[a0_0xcbcd38(0x28b)]('/view/add_transfer',auth,async(_0x27faf4,_0x4c6380)=>{var _0x55fd3d=a0_0xcbcd38;try{const {date:_0x3e9271,from_warehouse:_0x207543,FromRoom_name:_0xd4d9c3,to_warehouse:_0x526a7d,ToRoom_name:_0xa25ce3,prod_name:_0x36004a,from_prod_qty:_0x471a98,from_prod_level:_0x237e3f,from_prod_isle:_0x15d6c2,from_prod_pallet:_0x45de4a,to_prod_qty:_0x3f9b0c,to_prod_level:_0x445b91,to_prod_isle:_0x116fa0,to_prod_pallet:_0x36cc33,primary_code:_0x232f2c,secondary_code:_0x5b8d47,product_code3:_0x12821c,note:_0x549c7f,MaxStocks_data2:_0x6d9f4d,invoice:_0x1c622f,expiry_date:_0x467085}=_0x27faf4[_0x55fd3d(0x1d0)];if(typeof _0x36004a==_0x55fd3d(0x297))var _0x2b2570=[_0x27faf4[_0x55fd3d(0x1d0)]['prod_name']],_0x5c0771=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x281)]],_0x3eeb6f=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x22d)]],_0x3cef20=[_0x27faf4[_0x55fd3d(0x1d0)]['New_Qty_Converted']],_0x2044e1=[_0x27faf4[_0x55fd3d(0x1d0)]['to_prod_level']],_0xc4c21=[_0x27faf4[_0x55fd3d(0x1d0)]['primary_code']],_0x1639b4=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x27b)]],_0x4ee268=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x26b)]],_0x3876e3=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x235)]],_0x1cfb82=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x218)]],_0x57ad6e=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x1e9)]],_0x59e6d3=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x25c)]],_0x2b08df=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x232)]],_0x1117d8=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x236)]],_0x56bf5e=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x273)]],_0x560cc2=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x23e)]],_0x8fed38=[_0x27faf4['body'][_0x55fd3d(0x1ef)]],_0x1bf690=[_0x27faf4[_0x55fd3d(0x1d0)]['RoomAssigned']],_0x1e58d9=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x249)]],_0xf330b4=[_0x27faf4['body']['from_invoice']],_0x430c6b=[_0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x26c)]];else var _0x2b2570=[..._0x27faf4['body'][_0x55fd3d(0x25a)]],_0x5c0771=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x281)]],_0x3eeb6f=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x22d)]],_0x3cef20=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x261)]],_0x2044e1=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x287)]],_0xc4c21=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x295)]],_0x1639b4=[..._0x27faf4['body'][_0x55fd3d(0x27b)]],_0x4ee268=[..._0x27faf4[_0x55fd3d(0x1d0)]['product_code3']],_0x3876e3=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x235)]],_0x1cfb82=[..._0x27faf4[_0x55fd3d(0x1d0)]['primary_unit']],_0x57ad6e=[..._0x27faf4['body'][_0x55fd3d(0x1e9)]],_0x59e6d3=[..._0x27faf4['body'][_0x55fd3d(0x25c)]],_0x2b08df=[..._0x27faf4[_0x55fd3d(0x1d0)]['expiry_date']],_0x1117d8=[..._0x27faf4['body']['product_date']],_0x56bf5e=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x273)]],_0x560cc2=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x23e)]],_0x8fed38=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x1ef)]],_0x1bf690=[..._0x27faf4[_0x55fd3d(0x1d0)]['RoomAssigned']],_0x1e58d9=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x249)]],_0xf330b4=[..._0x27faf4[_0x55fd3d(0x1d0)][_0x55fd3d(0x270)]],_0x430c6b=[..._0x27faf4['body'][_0x55fd3d(0x26c)]];const _0x548eb1=_0x2b2570[_0x55fd3d(0x22a)](_0x5a5637=>{return _0x5a5637={'product_name':_0x5a5637};});_0x5c0771[_0x55fd3d(0x1e1)]((_0x216d8d,_0x5ca194)=>{_0x548eb1[_0x5ca194]['from_quantity']=_0x216d8d;}),_0x3eeb6f[_0x55fd3d(0x1e1)]((_0x58c632,_0x34b847)=>{_0x548eb1[_0x34b847]['from_bay']=_0x58c632;}),_0xf330b4[_0x55fd3d(0x1e1)]((_0x28d999,_0x5c8997)=>{var _0x3ccbd5=_0x55fd3d;_0x548eb1[_0x5c8997][_0x3ccbd5(0x270)]=_0x28d999;}),_0x430c6b[_0x55fd3d(0x1e1)]((_0x15c180,_0x4c8138)=>{var _0x263bdf=_0x55fd3d;_0x548eb1[_0x4c8138][_0x263bdf(0x1fc)]=_0x15c180;}),_0x3cef20['forEach']((_0x12a3f3,_0x452102)=>{var _0x1544e6=_0x55fd3d;_0x548eb1[_0x452102][_0x1544e6(0x1cd)]=_0x12a3f3;}),_0x2044e1['forEach']((_0x26368b,_0x106087)=>{var _0x4811d8=_0x55fd3d;_0x548eb1[_0x106087][_0x4811d8(0x22c)]=_0x26368b;}),_0xc4c21['forEach']((_0x460e68,_0x13642c)=>{var _0x2a8f9d=_0x55fd3d;_0x548eb1[_0x13642c][_0x2a8f9d(0x295)]=_0x460e68;}),_0x1639b4[_0x55fd3d(0x1e1)]((_0x288795,_0x4ef6c0)=>{var _0x34aff3=_0x55fd3d;_0x548eb1[_0x4ef6c0][_0x34aff3(0x27b)]=_0x288795;}),_0x4ee268[_0x55fd3d(0x1e1)]((_0x4871fc,_0x12e283)=>{var _0x3f1cbb=_0x55fd3d;_0x548eb1[_0x12e283][_0x3f1cbb(0x255)]=_0x4871fc;}),_0x3876e3[_0x55fd3d(0x1e1)]((_0x645990,_0x19a013)=>{var _0x4ad906=_0x55fd3d;_0x548eb1[_0x19a013][_0x4ad906(0x239)]=_0x645990;}),_0x1cfb82[_0x55fd3d(0x1e1)]((_0x5bc34e,_0x535446)=>{var _0x1c50d4=_0x55fd3d;_0x548eb1[_0x535446][_0x1c50d4(0x266)]=_0x5bc34e;}),_0x57ad6e[_0x55fd3d(0x1e1)]((_0x5db79a,_0x445656)=>{var _0xc4ac54=_0x55fd3d;_0x548eb1[_0x445656][_0xc4ac54(0x1e9)]=_0x5db79a;}),_0x59e6d3[_0x55fd3d(0x1e1)]((_0x2656c0,_0x1ce593)=>{var _0x286c45=_0x55fd3d;_0x548eb1[_0x1ce593][_0x286c45(0x25c)]=_0x2656c0;}),_0x2b08df[_0x55fd3d(0x1e1)]((_0x572e25,_0x5c7193)=>{var _0x245bdc=_0x55fd3d;_0x548eb1[_0x5c7193][_0x245bdc(0x232)]=_0x572e25;}),_0x1117d8[_0x55fd3d(0x1e1)]((_0xdd52e8,_0x3171e9)=>{_0x548eb1[_0x3171e9]['production_date']=_0xdd52e8;}),_0x56bf5e['forEach']((_0x363f89,_0x16e87d)=>{_0x548eb1[_0x16e87d]['maxProducts']=_0x363f89;}),_0x560cc2[_0x55fd3d(0x1e1)]((_0x4e7d5d,_0x3897ae)=>{var _0xbf90ed=_0x55fd3d;_0x548eb1[_0x3897ae][_0xbf90ed(0x23e)]=_0x4e7d5d;}),_0x8fed38[_0x55fd3d(0x1e1)]((_0x200afb,_0x409f8e)=>{var _0x15f203=_0x55fd3d;_0x548eb1[_0x409f8e][_0x15f203(0x1ef)]=_0x200afb;}),_0x1bf690[_0x55fd3d(0x1e1)]((_0x2aef1f,_0x239427)=>{_0x548eb1[_0x239427]['from_room_name']=_0x2aef1f;}),_0x1e58d9['forEach']((_0x2f88d5,_0x29477f)=>{var _0x20d207=_0x55fd3d;_0x548eb1[_0x29477f][_0x20d207(0x257)]=_0x2f88d5;});const _0x54f6ab=_0x548eb1[_0x55fd3d(0x201)](_0x5e21f9=>_0x5e21f9[_0x55fd3d(0x1cd)]!=='0'&&_0x5e21f9[_0x55fd3d(0x1cd)]!==''||_0x5e21f9[_0x55fd3d(0x21e)]!=='0'&&_0x5e21f9[_0x55fd3d(0x21e)]!=='');var _0x3d154b=0x0;_0x54f6ab['forEach'](_0x59a7d6=>{var _0x2e1439=_0x55fd3d;parseInt(_0x59a7d6[_0x2e1439(0x223)])<parseInt(_0x59a7d6[_0x2e1439(0x1cd)])&&_0x3d154b++;});if(_0x3d154b!=0x0)return _0x27faf4[_0x55fd3d(0x1f0)](_0x55fd3d(0x1ec),_0x55fd3d(0x20b)),_0x4c6380[_0x55fd3d(0x230)](_0x55fd3d(0x1c7));const _0x226392=new transfers_finished({'date':_0x3e9271,'from_warehouse':_0x207543,'to_warehouse':_0x526a7d,'product':_0x54f6ab,'note':_0x549c7f,'invoice':_0x1c622f}),_0x5cc3ed=await _0x226392[_0x55fd3d(0x1f8)]();_0x27faf4[_0x55fd3d(0x1f0)]('success','Product\x20Transfer\x20successfully'),_0x4c6380[_0x55fd3d(0x230)]('/transfer_finished/preview/'+_0x5cc3ed[_0x55fd3d(0x1fe)]);}catch(_0x2fe265){console[_0x55fd3d(0x263)](_0x2fe265),_0x4c6380[_0x55fd3d(0x2a1)](0xc8)['json']({'errorMessage':_0x2fe265[_0x55fd3d(0x24f)]});}}),router[a0_0xcbcd38(0x23d)]('/preview/:id',auth,async(_0x6b4ebc,_0x1b526a)=>{var _0x4d315a=a0_0xcbcd38;try{const {username:_0xb591cd,email:_0x496a55,role:_0x49fcee}=_0x6b4ebc[_0x4d315a(0x267)],_0x286260=_0x6b4ebc[_0x4d315a(0x267)],_0x4e6cc5=await profile[_0x4d315a(0x216)]({'email':_0x286260[_0x4d315a(0x1ea)]}),_0x3b1dcc=await master_shop['find'](),_0x5badbe=await transfers_finished[_0x4d315a(0x29f)](_0x6b4ebc[_0x4d315a(0x24a)]['id']);let _0x59e11e;if(_0x286260[_0x4d315a(0x275)]==_0x4d315a(0x1e7)){const _0x372f55=await staff['findOne']({'email':_0x286260['email']});_0x59e11e=await warehouse[_0x4d315a(0x1dd)]({'status':_0x4d315a(0x25b),'name':_0x372f55[_0x4d315a(0x2a2)],'warehouse_category':_0x4d315a(0x21b)});}else _0x59e11e=await warehouse['find']({'status':'Enabled','warehouse_category':_0x4d315a(0x21b)});const _0x2b6581=await warehouse[_0x4d315a(0x24d)]([{'$match':{'name':_0x5badbe[_0x4d315a(0x289)],'warehouse_category':_0x4d315a(0x21b)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4d315a(0x238),'name':{'$first':_0x4d315a(0x1dc)},'product_stock':{'$first':_0x4d315a(0x272)},'bay':{'$first':_0x4d315a(0x202)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4d315a(0x256)},'floorlevel':{'$first':_0x4d315a(0x293)},'primary_code':{'$first':_0x4d315a(0x200)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4d315a(0x290)},'rack':{'$first':_0x4d315a(0x26d)},'expiry_date':{'$first':_0x4d315a(0x1de)},'production_date':{'$first':_0x4d315a(0x2a4)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x4d315a(0x25f)}}}]),_0x15172e=await product['find']({});if(_0x3b1dcc[0x0][_0x4d315a(0x215)]==_0x4d315a(0x29a)){var _0x5b1f28=users[_0x4d315a(0x28d)];console[_0x4d315a(0x263)](_0x5b1f28);}else{if(_0x3b1dcc[0x0][_0x4d315a(0x215)]==_0x4d315a(0x278))var _0x5b1f28=users[_0x4d315a(0x278)];else{if(_0x3b1dcc[0x0]['language']=='German')var _0x5b1f28=users['German'];else{if(_0x3b1dcc[0x0]['language']==_0x4d315a(0x1d3))var _0x5b1f28=users[_0x4d315a(0x1d3)];else{if(_0x3b1dcc[0x0]['language']=='French')var _0x5b1f28=users[_0x4d315a(0x237)];else{if(_0x3b1dcc[0x0][_0x4d315a(0x215)]==_0x4d315a(0x294))var _0x5b1f28=users[_0x4d315a(0x1e8)];else{if(_0x3b1dcc[0x0][_0x4d315a(0x215)]==_0x4d315a(0x23c))var _0x5b1f28=users[_0x4d315a(0x23c)];else{if(_0x3b1dcc[0x0][_0x4d315a(0x215)]==_0x4d315a(0x262))var _0x5b1f28=users[_0x4d315a(0x283)];}}}}}}}_0x1b526a['render'](_0x4d315a(0x1d9),{'success':_0x6b4ebc[_0x4d315a(0x1f0)]('success'),'errors':_0x6b4ebc[_0x4d315a(0x1f0)](_0x4d315a(0x1ec)),'role':_0x286260,'profile':_0x4e6cc5,'master_shop':_0x3b1dcc,'warehouse':_0x59e11e,'transfer':_0x5badbe,'stock':_0x2b6581,'unit':_0x15172e,'language':_0x5b1f28});}catch(_0x24d81f){console[_0x4d315a(0x263)](_0x24d81f);}}),router['post'](a0_0xcbcd38(0x299),auth,async(_0x45a224,_0x22a029)=>{var _0x4c2a89=a0_0xcbcd38;try{const {invoice:_0x57526e,from_warehouse:_0xd4cb61,FromRoom_name:_0x29348e,to_warehouse:_0x20df78,ToRoom_name:_0x43a9bf}=_0x45a224['body'],_0x59ca00=await transfers_finished[_0x4c2a89(0x29f)](_0x45a224[_0x4c2a89(0x24a)]['id']),_0x301ef6=_0x59ca00[_0x4c2a89(0x23f)]['map'](async _0x494223=>{var _0x1471ef=_0x4c2a89;if(_0x494223[_0x1471ef(0x1cd)]>0x0){var _0x58a0ca=await warehouse[_0x1471ef(0x216)]({'name':_0xd4cb61,'room':_0x494223[_0x1471ef(0x21f)],'warehouse_category':_0x1471ef(0x21b)});const _0x46ebad=_0x58a0ca[_0x1471ef(0x217)][_0x1471ef(0x22a)](_0x3f232a=>{var _0x24f687=_0x1471ef;_0x3f232a[_0x24f687(0x2a3)]==_0x494223[_0x24f687(0x2a3)]&&_0x3f232a[_0x24f687(0x279)]==_0x494223[_0x24f687(0x240)]&&_0x3f232a['expiry_date']==_0x494223['expiry_date']&&_0x3f232a[_0x24f687(0x271)]==_0x494223[_0x24f687(0x271)]&&_0x3f232a[_0x24f687(0x25c)]==_0x494223[_0x24f687(0x25c)]&&_0x3f232a[_0x24f687(0x211)]==_0x494223[_0x24f687(0x270)]&&(_0x3f232a[_0x24f687(0x251)]=_0x3f232a[_0x24f687(0x251)]-_0x494223[_0x24f687(0x1cd)]);});}return _0x58a0ca;});Promise[_0x4c2a89(0x264)](_0x301ef6)['then'](async _0x288a16=>{var _0xa49734=_0x4c2a89;try{for(const _0x96a960 of _0x288a16){await _0x96a960[_0xa49734(0x1f8)]();}const _0x291b70=_0x59ca00[_0xa49734(0x23f)]['map'](async _0x220c2b=>{var _0x4cc650=_0xa49734,_0x3852d0=await warehouse[_0x4cc650(0x216)]({'name':_0x20df78,'room':_0x220c2b[_0x4cc650(0x257)]});if(_0x220c2b['to_quantity']>0x0){var _0x86c330=0x0;const _0x1ff6f2=_0x3852d0[_0x4cc650(0x217)][_0x4cc650(0x22a)](_0x55adbc=>{var _0x4c95c1=_0x4cc650;_0x55adbc[_0x4c95c1(0x2a3)]==_0x220c2b[_0x4c95c1(0x2a3)]&&_0x55adbc[_0x4c95c1(0x279)]==_0x220c2b[_0x4c95c1(0x22c)]&&_0x55adbc[_0x4c95c1(0x232)]==_0x220c2b[_0x4c95c1(0x232)]&&_0x55adbc[_0x4c95c1(0x271)]==_0x220c2b['production_date']&&_0x55adbc[_0x4c95c1(0x25c)]==_0x220c2b[_0x4c95c1(0x25c)]&&_0x55adbc[_0x4c95c1(0x211)]==_0x220c2b['To_invoice']&&(_0x55adbc[_0x4c95c1(0x251)]=_0x55adbc[_0x4c95c1(0x251)]+_0x220c2b[_0x4c95c1(0x1cd)],_0x86c330++);});_0x86c330=='0'&&(_0x3852d0[_0x4cc650(0x217)]=_0x3852d0[_0x4cc650(0x217)][_0x4cc650(0x29d)]({'product_name':_0x220c2b['product_name'],'product_stock':_0x220c2b['to_quantity'],'bay':_0x220c2b['to_bay'],'product_code':_0x220c2b[_0x4cc650(0x255)],'primary_code':_0x220c2b[_0x4cc650(0x295)],'secondary_code':_0x220c2b[_0x4cc650(0x27b)],'expiry_date':_0x220c2b[_0x4cc650(0x232)],'production_date':_0x220c2b['production_date'],'maxProducts':_0x220c2b[_0x4cc650(0x239)],'batch_code':_0x220c2b['batch_code'],'secondary_unit':_0x220c2b[_0x4cc650(0x1e9)],'unit':_0x220c2b[_0x4cc650(0x266)],'maxProducts':_0x220c2b[_0x4cc650(0x239)],'maxPerUnit':_0x220c2b[_0x4cc650(0x23e)],'invoice':_0x220c2b[_0x4cc650(0x1fc)]}));}return _0x3852d0;});Promise['all'](_0x291b70)[_0xa49734(0x24e)](async _0x337939=>{var _0x4ee39a=_0xa49734;try{for(const _0x3d2a6c of _0x337939){await warehouse[_0x4ee39a(0x1df)]({'_id':_0x3d2a6c[_0x4ee39a(0x1fe)]},{'$addToSet':{'product_details':{'$each':_0x3d2a6c[_0x4ee39a(0x217)]}}});}_0x59ca00['finalize']=_0x4ee39a(0x1ed);const _0x1cd162=await _0x59ca00[_0x4ee39a(0x1f8)](),_0x58ccc1=await master_shop[_0x4ee39a(0x1dd)](),_0x4bae31=await email_settings[_0x4ee39a(0x216)](),_0x4068bf=await supervisor_settings['find']();var _0x404859=_0x59ca00[_0x4ee39a(0x23f)],_0x27862b='',_0x3b9f14;for(_0x3b9f14 in _0x404859){var _0x211c7e='FG';_0x59ca00['to_warehouse']==_0x4ee39a(0x28f)&&(_0x211c7e='DG'),_0x27862b+='<tr>'+_0x4ee39a(0x1ee)+_0x404859[_0x3b9f14][_0x4ee39a(0x2a3)]+_0x4ee39a(0x1f9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x404859[_0x3b9f14][_0x4ee39a(0x255)]+_0x4ee39a(0x1f9)+_0x4ee39a(0x1ee)+_0x404859[_0x3b9f14][_0x4ee39a(0x1cd)]+_0x4ee39a(0x1f9)+_0x4ee39a(0x1ee)+_0x404859[_0x3b9f14][_0x4ee39a(0x266)]+_0x4ee39a(0x1f9)+_0x4ee39a(0x1ee)+_0x404859[_0x3b9f14]['secondary_unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x59ca00[_0x4ee39a(0x286)]+'</td>'+_0x4ee39a(0x1ee)+_0x404859[_0x3b9f14][_0x4ee39a(0x257)]+_0x4ee39a(0x1f9)+_0x4ee39a(0x1ee)+_0x211c7e+_0x404859[_0x3b9f14]['to_bay']+_0x4ee39a(0x1f9)+'</tr>';}let _0x3b2d2e=nodemailer[_0x4ee39a(0x268)]({'host':_0x4bae31[_0x4ee39a(0x253)],'port':Number(_0x4bae31[_0x4ee39a(0x1cf)]),'secure':![],'auth':{'user':_0x4bae31[_0x4ee39a(0x1ea)],'pass':_0x4bae31[_0x4ee39a(0x203)]}}),_0x32c060={'from':_0x4bae31[_0x4ee39a(0x1ea)],'to':_0x4068bf[0x0][_0x4ee39a(0x296)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x4ee39a(0x243),'path':__dirname+'/../public'+_0x4ee39a(0x21d)+_0x58ccc1[0x0][_0x4ee39a(0x1c9)],'cid':_0x4ee39a(0x28a)}],'html':_0x4ee39a(0x20f)+_0x4ee39a(0x22f)+_0x4ee39a(0x214)+_0x4ee39a(0x247)+_0x4ee39a(0x242)+_0x4ee39a(0x247)+_0x4ee39a(0x291)+'</div>'+_0x4ee39a(0x247)+_0x4ee39a(0x1f7)+_0x58ccc1[0x0]['site_title']+_0x4ee39a(0x229)+'</div>'+_0x4ee39a(0x21c)+_0x4ee39a(0x23a)+'<div>'+_0x4ee39a(0x213)+_0x4ee39a(0x244)+_0x59ca00[_0x4ee39a(0x211)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x4ee39a(0x1d4)+_0x59ca00[_0x4ee39a(0x226)]+'\x20'+_0x4ee39a(0x28e)+_0x4ee39a(0x22e)+_0x4ee39a(0x21c)+_0x4ee39a(0x1db)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x4ee39a(0x1ca)+_0x4ee39a(0x254)+_0x4ee39a(0x28c)+_0x4ee39a(0x298)+_0x4ee39a(0x24b)+_0x4ee39a(0x29c)+_0x4ee39a(0x252)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x4ee39a(0x2a5)+_0x4ee39a(0x277)+_0x4ee39a(0x260)+'\x20'+_0x27862b+'\x20'+_0x4ee39a(0x231)+_0x4ee39a(0x234)+_0x4ee39a(0x247)+_0x4ee39a(0x208)+_0x4ee39a(0x26f)+_0x58ccc1[0x0]['site_title']+_0x4ee39a(0x22e)+'</div>'+_0x4ee39a(0x21c)+_0x4ee39a(0x245)};_0x3b2d2e[_0x4ee39a(0x1f6)](_0x32c060,function(_0x26a55b,_0x191758){var _0x445c45=_0x4ee39a;_0x26a55b?(console[_0x445c45(0x263)](_0x26a55b),console[_0x445c45(0x263)](_0x445c45(0x26a))):console[_0x445c45(0x263)](_0x445c45(0x222));}),_0x45a224[_0x4ee39a(0x1f0)](_0x4ee39a(0x20c),_0x4ee39a(0x248)),_0x22a029[_0x4ee39a(0x230)](_0x4ee39a(0x2a0)+_0x1cd162[_0x4ee39a(0x1fe)]);}catch(_0x371700){console[_0x4ee39a(0x282)](_0x371700),_0x22a029[_0x4ee39a(0x2a1)](0x1f4)[_0x4ee39a(0x1e6)]({'error':_0x4ee39a(0x259)});}})['catch'](_0x2ff3f7=>{var _0x4d9e5e=_0xa49734;console['error'](_0x2ff3f7),_0x22a029['status'](0x1f4)[_0x4d9e5e(0x1e6)]({'error':_0x4d9e5e(0x29b)});});}catch(_0x295f98){console['error'](_0x295f98),_0x22a029[_0xa49734(0x2a1)](0x1f4)[_0xa49734(0x1e6)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})['catch'](_0x2c441f=>{var _0x41a75c=_0x4c2a89;console[_0x41a75c(0x282)](_0x2c441f),_0x22a029['status'](0x1f4)[_0x41a75c(0x1e6)]({'error':_0x41a75c(0x29b)});});}catch(_0x5ac1fb){_0x22a029['json']({'message':_0x5ac1fb[_0x4c2a89(0x24f)]});}});function BayBinSelected(_0x603642,_0x4d8719){var _0x59cfaa=a0_0xcbcd38,_0x3a5d3d=[];let _0x43375e=[];var _0x2cb4e9=[];if(_0x603642==_0x59cfaa(0x28f)){switch(_0x4d8719){case _0x59cfaa(0x210):_0x3a5d3d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x59cfaa(0x27a):_0x3a5d3d=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x2cb4e9=['DG'];}else{if(_0x603642==_0x59cfaa(0x1e4)){switch(_0x4d8719){case _0x59cfaa(0x210):_0x3a5d3d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x3a5d3d=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x2cb4e9=['FG'];}}return{'levels':_0x3a5d3d,'identify':_0x2cb4e9};}router['get']('/view/:id',auth,async(_0xbe103b,_0x47d067)=>{var _0x493675=a0_0xcbcd38;try{const {username:_0x57f1f0,email:_0xf9782,role:_0x3b334c}=_0xbe103b[_0x493675(0x267)],_0x4523b4=_0xbe103b[_0x493675(0x267)],_0x15f653=await profile[_0x493675(0x216)]({'email':_0x4523b4[_0x493675(0x1ea)]}),_0x219adc=await master_shop[_0x493675(0x1dd)](),_0x3f6353=await transfers_finished[_0x493675(0x29f)](_0xbe103b[_0x493675(0x24a)]['id']);let _0x1c69c8=new Date(_0x3f6353['expiry_date']),_0x37a05a=('0'+_0x1c69c8[_0x493675(0x1c8)]())[_0x493675(0x292)](-0x2),_0x31e52e=('0'+(_0x1c69c8['getMonth']()+0x1))[_0x493675(0x292)](-0x2),_0x48e549=_0x1c69c8[_0x493675(0x1f5)](),_0x19ea2e=_0x48e549+'-'+_0x31e52e+'-'+_0x37a05a,_0x27f82f;if(_0x4523b4['role']==_0x493675(0x1e7)){const _0x376fe4=await staff[_0x493675(0x216)]({'email':_0x4523b4[_0x493675(0x1ea)]});_0x27f82f=await warehouse[_0x493675(0x1dd)]({'status':'Enabled','name':_0x376fe4['warehouse'],'warehouse_category':_0x493675(0x21b)});}else _0x27f82f=await warehouse['find']({'status':_0x493675(0x25b),'warehouse_category':_0x493675(0x21b)});const _0x4b84bc=await warehouse[_0x493675(0x24d)]([{'$match':{'name':_0x3f6353['from_warehouse'],'room':_0x3f6353['from_room']}},{'$unwind':_0x493675(0x233)},{'$group':{'_id':_0x493675(0x238),'name':{'$first':_0x493675(0x1dc)},'product_stock':{'$first':_0x493675(0x272)},'bay':{'$first':_0x493675(0x202)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x493675(0x256)},'floorlevel':{'$first':_0x493675(0x293)},'primary_code':{'$first':_0x493675(0x200)},'secondary_code':{'$first':_0x493675(0x27e)},'product_code':{'$first':_0x493675(0x1d7)},'storage':{'$first':_0x493675(0x290)},'rack':{'$first':'$product_details.rack'}}}]);var _0x36d8c4=[0x1,0x2,0x3,0x4],_0x454183=['A','B','C','D','E','F','G','H','I','J'],_0x1b2436=['Ambient',_0x493675(0x1f2)];const _0x2f12f0=await product[_0x493675(0x1dd)]({}),_0x29cdc5=BayBinSelected(_0x3f6353[_0x493675(0x286)],_0x3f6353[_0x493675(0x1d5)]);if(_0x219adc[0x0][_0x493675(0x215)]==_0x493675(0x29a)){var _0x26c1f0=users['English'];console[_0x493675(0x263)](_0x26c1f0);}else{if(_0x219adc[0x0][_0x493675(0x215)]==_0x493675(0x278))var _0x26c1f0=users[_0x493675(0x278)];else{if(_0x219adc[0x0]['language']==_0x493675(0x212))var _0x26c1f0=users[_0x493675(0x212)];else{if(_0x219adc[0x0][_0x493675(0x215)]=='Spanish')var _0x26c1f0=users[_0x493675(0x1d3)];else{if(_0x219adc[0x0]['language']==_0x493675(0x237))var _0x26c1f0=users[_0x493675(0x237)];else{if(_0x219adc[0x0]['language']==_0x493675(0x294))var _0x26c1f0=users['Portuguese'];else{if(_0x219adc[0x0]['language']==_0x493675(0x23c))var _0x26c1f0=users[_0x493675(0x23c)];else{if(_0x219adc[0x0][_0x493675(0x215)]==_0x493675(0x262))var _0x26c1f0=users[_0x493675(0x283)];}}}}}}}_0x47d067[_0x493675(0x1e0)](_0x493675(0x209),{'success':_0xbe103b[_0x493675(0x1f0)](_0x493675(0x20c)),'errors':_0xbe103b[_0x493675(0x1f0)]('errors'),'role':_0x4523b4,'profile':_0x15f653,'master_shop':_0x219adc,'warehouse':_0x27f82f,'transfer':_0x3f6353,'stock':_0x4b84bc,'unit':_0x2f12f0,'language':_0x26c1f0,'levels':_0x36d8c4,'Isle':_0x454183,'rooms_data':_0x1b2436,'ed_fullDate':_0x19ea2e,'dataSelected':_0x29cdc5});}catch(_0x80b4be){console[_0x493675(0x263)](_0x80b4be);}}),router[a0_0xcbcd38(0x28b)](a0_0xcbcd38(0x27f),auth,async(_0x20a8b5,_0x23ef76)=>{var _0x50812d=a0_0xcbcd38;try{const _0x59798f=_0x20a8b5['params']['id'];console[_0x50812d(0x263)](_0x20a8b5[_0x50812d(0x1d0)]);const _0x4df2e7=await transfers_finished[_0x50812d(0x29f)](_0x59798f);console[_0x50812d(0x263)]('transfer_data',_0x4df2e7);const {date:_0x7c977d,from_warehouse:_0x2d13cd,FromRoom_name:_0x7003c0,to_warehouse:_0x542865,ToRoom_name:_0x5252eb,prod_name:_0x4e82d4,from_prod_qty:_0x331c2a,from_prod_level:_0xdc91ef,from_prod_isle:_0x8e8080,from_prod_pallet:_0x233d09,to_prod_qty:_0x2da36e,to_prod_level:_0x9d7a61,to_prod_isle:_0x5d26ff,to_prod_pallet:_0x233a2b,primary_code:_0x4515b1,secondary_code:_0x4c62b5,product_code3:_0xdd9b14,note:_0x4cefed,invoice:_0x3af93d,expiry_date:_0x15b11b}=_0x20a8b5[_0x50812d(0x1d0)];if(typeof _0x4e82d4==_0x50812d(0x297))var _0x5b27f9=[_0x20a8b5[_0x50812d(0x1d0)]['prod_name']],_0x4eb8c1=[_0x20a8b5[_0x50812d(0x1d0)]['from_prod_qty']],_0x2ec40c=[_0x20a8b5[_0x50812d(0x1d0)]['from_prod_level']],_0x3f5f63=[_0x20a8b5['body'][_0x50812d(0x1d8)]],_0xa947b8=[_0x20a8b5[_0x50812d(0x1d0)]['to_prod_level']],_0x2a770b=[_0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x295)]],_0x51ee4a=[_0x20a8b5[_0x50812d(0x1d0)]['secondary_code']],_0x163074=[_0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x26b)]],_0x4a6a90=[_0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x235)]],_0x2d8f65=[_0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x266)]],_0x1ce820=[_0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x1e9)]],_0x1fa469=[_0x20a8b5['body']['batch_code']],_0xe2cab4=[_0x20a8b5[_0x50812d(0x1d0)]['expiry_date']];else var _0x5b27f9=[..._0x20a8b5['body'][_0x50812d(0x25a)]],_0x4eb8c1=[..._0x20a8b5['body']['from_prod_qty']],_0x2ec40c=[..._0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x22d)]],_0x3f5f63=[..._0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x1d8)]],_0xa947b8=[..._0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x287)]],_0x2a770b=[..._0x20a8b5['body'][_0x50812d(0x295)]],_0x51ee4a=[..._0x20a8b5[_0x50812d(0x1d0)]['secondary_code']],_0x163074=[..._0x20a8b5['body'][_0x50812d(0x26b)]],_0x4a6a90=[..._0x20a8b5[_0x50812d(0x1d0)]['MaxStocks_data2']],_0x2d8f65=[..._0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x266)]],_0x1ce820=[..._0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x1e9)]],_0x1fa469=[..._0x20a8b5['body'][_0x50812d(0x25c)]],_0xe2cab4=[..._0x20a8b5[_0x50812d(0x1d0)][_0x50812d(0x232)]];const _0xd73305=_0x5b27f9['map'](_0x2a158f=>{return _0x2a158f={'product_name':_0x2a158f};});_0x4eb8c1[_0x50812d(0x1e1)]((_0x3dc57e,_0x3ceb93)=>{var _0x22f647=_0x50812d;_0xd73305[_0x3ceb93][_0x22f647(0x223)]=_0x3dc57e;}),_0x2ec40c['forEach']((_0xe7b4a,_0xbdf4e5)=>{var _0x4f6021=_0x50812d;_0xd73305[_0xbdf4e5][_0x4f6021(0x240)]=_0xe7b4a;}),_0x3f5f63[_0x50812d(0x1e1)]((_0x4ed2c5,_0x31d913)=>{var _0xc69cd9=_0x50812d;_0xd73305[_0x31d913][_0xc69cd9(0x1cd)]=_0x4ed2c5;}),_0xa947b8[_0x50812d(0x1e1)]((_0x1526dc,_0x16a897)=>{_0xd73305[_0x16a897]['to_bay']=_0x1526dc;}),_0x2a770b['forEach']((_0x5cafd9,_0x23dc7d)=>{var _0x436746=_0x50812d;_0xd73305[_0x23dc7d][_0x436746(0x295)]=_0x5cafd9;}),_0x51ee4a[_0x50812d(0x1e1)]((_0x265ae0,_0x210b7e)=>{var _0x271aba=_0x50812d;_0xd73305[_0x210b7e][_0x271aba(0x27b)]=_0x265ae0;}),_0x163074['forEach']((_0x70a87e,_0x25fb27)=>{var _0x3bb116=_0x50812d;_0xd73305[_0x25fb27][_0x3bb116(0x255)]=_0x70a87e;}),_0x4a6a90[_0x50812d(0x1e1)]((_0x3647bc,_0x59e286)=>{var _0x2b0a73=_0x50812d;_0xd73305[_0x59e286][_0x2b0a73(0x239)]=_0x3647bc;}),_0x2d8f65[_0x50812d(0x1e1)]((_0x3fd221,_0xa14d69)=>{var _0x5be1d7=_0x50812d;_0xd73305[_0xa14d69][_0x5be1d7(0x266)]=_0x3fd221;}),_0x1ce820[_0x50812d(0x1e1)]((_0x193457,_0x21595f)=>{var _0x562bb3=_0x50812d;_0xd73305[_0x21595f][_0x562bb3(0x1e9)]=_0x193457;}),_0x1fa469[_0x50812d(0x1e1)]((_0x2ce261,_0x367de9)=>{_0xd73305[_0x367de9]['batch_code']=_0x2ce261;}),_0xe2cab4['forEach']((_0x476208,_0x36b3b6)=>{var _0x1440bd=_0x50812d;_0xd73305[_0x36b3b6][_0x1440bd(0x232)]=_0x476208;});const _0x2ed9d4=_0xd73305[_0x50812d(0x201)](_0x1f94d4=>_0x1f94d4[_0x50812d(0x1cd)]!=='0'&&_0x1f94d4[_0x50812d(0x1cd)]!==''||_0x1f94d4[_0x50812d(0x21e)]!=='0'&&_0x1f94d4['to_floorlevel']!=='');var _0x26909f=0x0;_0x2ed9d4['forEach'](_0x15c3d5=>{var _0x57495c=_0x50812d;parseInt(_0x15c3d5[_0x57495c(0x223)])<parseInt(_0x15c3d5[_0x57495c(0x1cd)])&&_0x26909f++;});if(_0x26909f!=0x0)return _0x20a8b5[_0x50812d(0x1f0)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x23ef76[_0x50812d(0x230)](_0x50812d(0x1c7));const _0x421f52=await warehouse[_0x50812d(0x216)]({'name':_0x4df2e7[_0x50812d(0x289)],'room':_0x4df2e7[_0x50812d(0x204)]});_0x4df2e7['product'][_0x50812d(0x1e1)](_0x5a3285=>{var _0x765fad=_0x50812d;if(_0x5a3285[_0x765fad(0x1cd)]>0x0){const _0xe63b25=_0x421f52[_0x765fad(0x217)][_0x765fad(0x22a)](_0xd4f7b2=>{var _0x24f2ec=_0x765fad;_0xd4f7b2[_0x24f2ec(0x2a3)]==_0x5a3285[_0x24f2ec(0x2a3)]&&_0xd4f7b2[_0x24f2ec(0x279)]==_0x5a3285[_0x24f2ec(0x240)]&&(_0xd4f7b2[_0x24f2ec(0x251)]=parseInt(_0xd4f7b2[_0x24f2ec(0x251)])+parseInt(_0x5a3285['to_quantity']));});}}),await _0x421f52[_0x50812d(0x1f8)]();const _0x336600=await warehouse[_0x50812d(0x216)]({'name':_0x4df2e7[_0x50812d(0x286)],'room':_0x4df2e7['to_room']});_0x4df2e7[_0x50812d(0x23f)][_0x50812d(0x1e1)](_0x4d750a=>{var _0x45c5d2=_0x50812d;if(_0x4d750a[_0x45c5d2(0x1cd)]>0x0){const _0x107b93=_0x336600[_0x45c5d2(0x217)][_0x45c5d2(0x22a)](_0x52c2d7=>{var _0x57f953=_0x45c5d2;_0x52c2d7[_0x57f953(0x2a3)]==_0x4d750a['product_name']&&_0x52c2d7[_0x57f953(0x279)]==_0x4d750a[_0x57f953(0x22c)]&&(_0x52c2d7['product_stock']=parseInt(_0x52c2d7[_0x57f953(0x251)])-parseInt(_0x4d750a[_0x57f953(0x1cd)]));});}}),await _0x336600['save'](),_0x4df2e7['date']=_0x7c977d,_0x4df2e7['from_warehouse']=_0x2d13cd,_0x4df2e7[_0x50812d(0x286)]=_0x542865,_0x4df2e7[_0x50812d(0x23f)]=_0x2ed9d4,_0x4df2e7[_0x50812d(0x1eb)]=_0x4cefed,_0x4df2e7[_0x50812d(0x211)]=_0x3af93d;const _0x57e2d3=await _0x4df2e7['save'](),_0x2b0404=await warehouse[_0x50812d(0x216)]({'name':_0x2d13cd,'room':_0x7003c0});_0x57e2d3[_0x50812d(0x23f)]['forEach'](_0x5b0075=>{var _0x342b02=_0x50812d;if(_0x5b0075[_0x342b02(0x1cd)]>0x0){const _0x555890=_0x2b0404['product_details'][_0x342b02(0x22a)](_0x435f23=>{var _0x17f7e0=_0x342b02;_0x435f23[_0x17f7e0(0x2a3)]==_0x5b0075[_0x17f7e0(0x2a3)]&&_0x435f23[_0x17f7e0(0x279)]==_0x5b0075[_0x17f7e0(0x240)]&&(_0x435f23[_0x17f7e0(0x251)]=parseInt(_0x435f23[_0x17f7e0(0x251)])-parseInt(_0x5b0075[_0x17f7e0(0x1cd)]));});}}),await _0x2b0404[_0x50812d(0x1f8)]();const _0x560ec6=await warehouse[_0x50812d(0x216)]({'name':_0x542865,'room':_0x5252eb});_0x57e2d3[_0x50812d(0x23f)]['forEach'](_0x51fd64=>{var _0x3890ab=_0x50812d;if(_0x51fd64[_0x3890ab(0x1cd)]>0x0){var _0x15560c=0x0;const _0x2e1b9f=_0x560ec6[_0x3890ab(0x217)][_0x3890ab(0x22a)](_0x37f7db=>{var _0x2a80d6=_0x3890ab;_0x37f7db[_0x2a80d6(0x2a3)]==_0x51fd64[_0x2a80d6(0x2a3)]&&_0x37f7db[_0x2a80d6(0x279)]==_0x51fd64[_0x2a80d6(0x22c)]&&(_0x37f7db[_0x2a80d6(0x251)]=parseInt(_0x37f7db[_0x2a80d6(0x251)])+parseInt(_0x51fd64[_0x2a80d6(0x1cd)]),_0x15560c++);});_0x15560c=='0'&&(_0x560ec6[_0x3890ab(0x217)]=_0x560ec6[_0x3890ab(0x217)][_0x3890ab(0x29d)]({'product_name':_0x51fd64[_0x3890ab(0x2a3)],'product_stock':_0x51fd64[_0x3890ab(0x1cd)],'bay':_0x51fd64[_0x3890ab(0x22c)],'product_code':_0x51fd64[_0x3890ab(0x255)],'primary_code':_0x51fd64[_0x3890ab(0x295)],'secondary_code':_0x51fd64[_0x3890ab(0x27b)],'maxProducts':_0x51fd64[_0x3890ab(0x239)]}));}}),await _0x560ec6[_0x50812d(0x1f8)](),_0x20a8b5[_0x50812d(0x1f0)](_0x50812d(0x20c),_0x50812d(0x27c)),_0x23ef76['redirect']('/transfer_finished/view');}catch(_0x121c3c){console[_0x50812d(0x263)](_0x121c3c);}}),router[a0_0xcbcd38(0x28b)](a0_0xcbcd38(0x1fa),async(_0x2dd88c,_0x1e4894)=>{var _0x4077cf=a0_0xcbcd38;const {FromWareHouse:_0x24d4ce,FromRoom:_0x8487ab,ToWarehouse:_0x4872da,ToRoom:_0x2a7eea,primary_code:_0x39fd79,Roomslist:_0x14478d}=_0x2dd88c[_0x4077cf(0x1d0)],_0x5e92d6=_0x14478d[_0x4077cf(0x288)](','),_0x1b7153=[];async function _0x7be318(_0x227d64){var _0x1596eb=_0x4077cf;const _0x5e96b6=await warehouse[_0x1596eb(0x24d)]([{'$match':{'name':_0x24d4ce,'room':_0x227d64}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x39fd79}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1596eb(0x1dc)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1596eb(0x27e)},'product_code':{'$first':_0x1596eb(0x1d7)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x1596eb(0x1cb)},'type':{'$first':_0x1596eb(0x256)},'pallet':{'$first':_0x1596eb(0x293)},'unit':{'$first':_0x1596eb(0x1e3)},'secondary_unit':{'$first':_0x1596eb(0x25e)},'storage':{'$first':_0x1596eb(0x290)},'rack':{'$first':_0x1596eb(0x26d)},'expiry_date':{'$first':_0x1596eb(0x1de)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x1596eb(0x1f1)},'maxPerUnit':{'$first':_0x1596eb(0x1f3)},'roomNamed':{'$first':_0x1596eb(0x1fb)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x1596eb(0x27d)}}}]),_0x1424a6=await warehouse[_0x1596eb(0x24d)]([{'$match':{'name':_0x24d4ce,'room':_0x227d64}},{'$unwind':_0x1596eb(0x233)},{'$match':{'product_details.secondary_code':_0x39fd79}},{'$group':{'_id':_0x1596eb(0x238),'name':{'$first':_0x1596eb(0x1dc)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x1596eb(0x200)},'secondary_code':{'$first':_0x1596eb(0x27e)},'product_code':{'$first':_0x1596eb(0x1d7)},'level':{'$first':_0x1596eb(0x202)},'isle':{'$first':_0x1596eb(0x1cb)},'type':{'$first':_0x1596eb(0x256)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1596eb(0x1de)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x1596eb(0x1f1)},'maxPerUnit':{'$first':_0x1596eb(0x1f3)},'roomNamed':{'$first':_0x1596eb(0x1fb)},'prod_cat':{'$first':'S'},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x5e96b6[_0x1596eb(0x241)]>0x0)_0x1b7153[_0x1596eb(0x227)](_0x5e96b6);else _0x1424a6[_0x1596eb(0x241)]>0x0&&_0x1b7153[_0x1596eb(0x227)](_0x1424a6);}const _0x537102=_0x5e92d6[_0x4077cf(0x22a)](_0x2287c0=>_0x7be318(_0x2287c0));await Promise[_0x4077cf(0x264)](_0x537102),_0x1e4894[_0x4077cf(0x1e6)](_0x1b7153);}),router[a0_0xcbcd38(0x28b)](a0_0xcbcd38(0x221),async(_0xb5a216,_0x3bf33c)=>{var _0x442627=a0_0xcbcd38;try{const {FromWareHouse:_0x511dd0,FromRoom:_0x4170cd,ToWarehouse:_0x30c58e,ToRoom:_0x5e6e53,secondary_code:_0xf2ff14}=_0xb5a216[_0x442627(0x1d0)],_0x4577a3=await warehouse[_0x442627(0x24d)]([{'$match':{'name':_0x511dd0}},{'$unwind':_0x442627(0x233)},{'$match':{'product_details.secondary_code':_0xf2ff14}},{'$group':{'_id':_0x442627(0x238),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x442627(0x200)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x442627(0x1d7)},'instock':{'$first':_0x442627(0x272)},'warehouse':{'$first':_0x442627(0x25f)},'level':{'$first':_0x442627(0x206)},'isle':{'$first':_0x442627(0x1d1)},'pallet':{'$first':_0x442627(0x24c)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x442627(0x1e3)},'expiry_date':{'$first':_0x442627(0x1de)},'production_date':{'$first':'$product_details.production_date'}}}]);_0x3bf33c[_0x442627(0x2a1)](0xc8)[_0x442627(0x1e6)](_0x4577a3);}catch(_0x481bd9){_0x3bf33c['status'](0x194)[_0x442627(0x1e6)]({'message':_0x481bd9[_0x442627(0x24f)]});}}),router[a0_0xcbcd38(0x28b)](a0_0xcbcd38(0x284),async(_0x2c6578,_0x526f44)=>{var _0x496722=a0_0xcbcd38;try{const {FromWareHouse:_0x34f01d,FromRoom:_0x1b9729,ToWarehouse:_0x131d91,ToRoom:_0x283a3a,product_code:_0x4b819a}=_0x2c6578[_0x496722(0x1d0)],_0x2d36d1=await warehouse['aggregate']([{'$match':{'name':_0x34f01d}},{'$unwind':_0x496722(0x233)},{'$match':{'product_details.product_code':_0x4b819a}},{'$group':{'_id':_0x496722(0x238),'name':{'$first':_0x496722(0x1dc)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x496722(0x27e)},'product_code':{'$first':_0x496722(0x1d7)},'instock':{'$first':_0x496722(0x272)},'warehouse':{'$first':'$name'},'level':{'$first':_0x496722(0x206)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x496722(0x24c)},'maxProducts':{'$first':_0x496722(0x25d)},'unit':{'$first':_0x496722(0x1e3)}}}]);_0x526f44[_0x496722(0x2a1)](0xc8)['json'](_0x2d36d1);}catch(_0x387554){_0x526f44[_0x496722(0x2a1)](0x194)[_0x496722(0x1e6)]({'message':_0x387554[_0x496722(0x24f)]});}}),router[a0_0xcbcd38(0x28b)](a0_0xcbcd38(0x1d2),async(_0x14ffce,_0x43a0da)=>{var _0x13057e=a0_0xcbcd38;const {productCode:_0x5c85e0,bay:_0x4c7f47,warehouses:_0x556431,room:_0x176da2}=_0x14ffce['body'];console[_0x13057e(0x263)](_0x14ffce[_0x13057e(0x1d0)]);try{const _0x95bfd4=await warehouse[_0x13057e(0x24d)]([{'$match':{'name':_0x556431,'room':_0x176da2}},{'$unwind':_0x13057e(0x233)},{'$match':{'product_details.bay':parseInt(_0x4c7f47)}},{'$group':{'_id':_0x13057e(0x238),'name':{'$first':_0x13057e(0x1dc)},'product_stock':{'$first':_0x13057e(0x272)},'bay':{'$first':_0x13057e(0x202)},'maxProducts':{'$first':_0x13057e(0x25d)}}}]);_0x43a0da[_0x13057e(0x2a1)](0xc8)['json'](_0x95bfd4);}catch(_0x50cec7){_0x43a0da[_0x13057e(0x2a1)](0x194)['json']({'message':_0x50cec7[_0x13057e(0x24f)]});}}),module[a0_0xcbcd38(0x1fd)]=router;