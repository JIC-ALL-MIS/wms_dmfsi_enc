var a0_0x4528a8=a0_0x5661;(function(_0x505e40,_0x30df6b){var _0x2186f1=a0_0x5661,_0x11c76e=_0x505e40();while(!![]){try{var _0x577d55=parseInt(_0x2186f1(0xa1))/0x1+parseInt(_0x2186f1(0xb5))/0x2*(-parseInt(_0x2186f1(0x129))/0x3)+-parseInt(_0x2186f1(0x119))/0x4*(-parseInt(_0x2186f1(0x134))/0x5)+parseInt(_0x2186f1(0x90))/0x6+parseInt(_0x2186f1(0x79))/0x7+parseInt(_0x2186f1(0x11a))/0x8*(-parseInt(_0x2186f1(0x136))/0x9)+-parseInt(_0x2186f1(0x130))/0xa;if(_0x577d55===_0x30df6b)break;else _0x11c76e['push'](_0x11c76e['shift']());}catch(_0x573990){_0x11c76e['push'](_0x11c76e['shift']());}}}(a0_0x9257,0x8529e));const express=require(a0_0x4528a8(0x144)),app=express(),router=express[a0_0x4528a8(0x115)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x4528a8(0x70)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x4528a8(0xe0));router['get']('/view',auth,async(_0x4fb56e,_0x53a06d)=>{var _0x5851df=a0_0x4528a8;try{const {username:_0x489578,email:_0x10349c,role:_0x52216c}=_0x4fb56e['user'],_0xef0493=_0x4fb56e[_0x5851df(0xa6)],_0x5ac4ac=await profile['findOne']({'email':_0xef0493[_0x5851df(0xdc)]}),_0x243aa7=await master_shop[_0x5851df(0x76)]();let _0xe99ed1;if(_0xef0493[_0x5851df(0x106)]==_0x5851df(0xb6)){const _0x2f8e22=await staff['findOne']({'email':_0xef0493[_0x5851df(0xdc)]});_0xe99ed1=await transfers_finished[_0x5851df(0x76)]({'from_warehouse':_0x2f8e22[_0x5851df(0xde)]});}else _0xe99ed1=await transfers_finished[_0x5851df(0xa9)]([{'$unwind':_0x5851df(0x8a)},{'$group':{'_id':_0x5851df(0x102),'invoice':{'$first':_0x5851df(0xaa)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x5851df(0xbc)},'to_warehouse':{'$first':_0x5851df(0xa4)},'from_room_name':{'$addToSet':_0x5851df(0x13c)},'to_room_name':{'$addToSet':_0x5851df(0x10e)},'finalize':{'$first':_0x5851df(0x13d)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x243aa7[0x0][_0x5851df(0xec)]==_0x5851df(0x89))var _0x8ab89=users[_0x5851df(0xc9)];else{if(_0x243aa7[0x0][_0x5851df(0xec)]==_0x5851df(0xe4))var _0x8ab89=users[_0x5851df(0xe4)];else{if(_0x243aa7[0x0]['language']==_0x5851df(0x88))var _0x8ab89=users['German'];else{if(_0x243aa7[0x0][_0x5851df(0xec)]=='Spanish')var _0x8ab89=users['Spanish'];else{if(_0x243aa7[0x0][_0x5851df(0xec)]=='French')var _0x8ab89=users[_0x5851df(0x113)];else{if(_0x243aa7[0x0][_0x5851df(0xec)]==_0x5851df(0x8f))var _0x8ab89=users[_0x5851df(0xf1)];else{if(_0x243aa7[0x0]['language']=='Chinese')var _0x8ab89=users[_0x5851df(0x123)];else{if(_0x243aa7[0x0][_0x5851df(0xec)]==_0x5851df(0x140))var _0x8ab89=users[_0x5851df(0xc0)];}}}}}}}_0x53a06d[_0x5851df(0xe6)]('transfer_finished',{'success':_0x4fb56e[_0x5851df(0x8d)](_0x5851df(0x137)),'errors':_0x4fb56e[_0x5851df(0x8d)]('errors'),'role':_0xef0493,'profile':_0x5ac4ac,'master_shop':_0x243aa7,'transfer':_0xe99ed1,'language':_0x8ab89});}catch(_0x11b2df){console['log'](_0x11b2df);}});async function getRandom8DigitNumber(){var _0x21a5b0=a0_0x4528a8;const _0x399614=0x989680,_0x27a70e=0x5f5e0ff,_0x3112b8=Math[_0x21a5b0(0x95)](Math[_0x21a5b0(0xc5)]()*(_0x27a70e-_0x399614+0x1))+_0x399614;var _0x255ae5;const _0x1b87e7=await transfers_finished[_0x21a5b0(0x7b)]({'invoice':_0x21a5b0(0xe1)+_0x3112b8});return _0x1b87e7&&_0x1b87e7[_0x21a5b0(0x10a)]>0x0?_0x255ae5=_0x21a5b0(0xe1)+_0x3112b8:_0x255ae5=_0x21a5b0(0xe1)+_0x3112b8,_0x255ae5;}function a0_0x5661(_0x483ec4,_0x2a2dec){var _0x9257b5=a0_0x9257();return a0_0x5661=function(_0x5661f1,_0x56e3aa){_0x5661f1=_0x5661f1-0x6a;var _0x44f8a1=_0x9257b5[_0x5661f1];return _0x44f8a1;},a0_0x5661(_0x483ec4,_0x2a2dec);}router[a0_0x4528a8(0x125)](a0_0x4528a8(0xf0),auth,async(_0x555269,_0x587159)=>{var _0x26b5ef=a0_0x4528a8;try{const {username:_0x31c550,email:_0x2f72bf,role:_0x130c44}=_0x555269[_0x26b5ef(0xa6)],_0x103ddd=_0x555269[_0x26b5ef(0xa6)],_0x40cb34=await profile['findOne']({'email':_0x103ddd['email']}),_0x4dafd8=await master_shop[_0x26b5ef(0x76)]();let _0x170bd1;if(_0x103ddd[_0x26b5ef(0x106)]==_0x26b5ef(0xb6)){const _0x3b9198=await staff[_0x26b5ef(0x7b)]({'email':_0x103ddd['email']});_0x170bd1=await warehouse[_0x26b5ef(0xa9)]([{'$match':{'status':_0x26b5ef(0xa3),'name':_0x3b9198[_0x26b5ef(0xde)],'warehouse_category':'Finished\x20Goods','name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x26b5ef(0xdf),'name':{'$first':_0x26b5ef(0xdf)}}}]);}else _0x170bd1=await warehouse[_0x26b5ef(0xa9)]([{'$match':{'status':_0x26b5ef(0xa3),'warehouse_category':_0x26b5ef(0x75),'name':{'$ne':_0x26b5ef(0xad)}}},{'$group':{'_id':_0x26b5ef(0xdf),'name':{'$first':'$name'}}}]);const _0x3a507c=await transfers_finished[_0x26b5ef(0x76)]({}),_0xa8a5c9=_0x3a507c[_0x26b5ef(0x10a)]+0x1,_0x50d4ad=_0x26b5ef(0xe1)+_0xa8a5c9[_0x26b5ef(0x87)]()[_0x26b5ef(0xc2)](0x5,'0');if(_0x4dafd8[0x0][_0x26b5ef(0xec)]==_0x26b5ef(0x89))var _0x33aaca=users['English'];else{if(_0x4dafd8[0x0][_0x26b5ef(0xec)]==_0x26b5ef(0xe4))var _0x33aaca=users[_0x26b5ef(0xe4)];else{if(_0x4dafd8[0x0]['language']==_0x26b5ef(0x88))var _0x33aaca=users[_0x26b5ef(0x88)];else{if(_0x4dafd8[0x0][_0x26b5ef(0xec)]==_0x26b5ef(0xe5))var _0x33aaca=users[_0x26b5ef(0xe5)];else{if(_0x4dafd8[0x0][_0x26b5ef(0xec)]==_0x26b5ef(0x113))var _0x33aaca=users['French'];else{if(_0x4dafd8[0x0][_0x26b5ef(0xec)]==_0x26b5ef(0x8f))var _0x33aaca=users[_0x26b5ef(0xf1)];else{if(_0x4dafd8[0x0][_0x26b5ef(0xec)]=='Chinese')var _0x33aaca=users[_0x26b5ef(0x123)];else{if(_0x4dafd8[0x0]['language']==_0x26b5ef(0x140))var _0x33aaca=users['Arabic'];}}}}}}}const _0x325bce=getRandom8DigitNumber();_0x325bce[_0x26b5ef(0x8e)](_0x3f54fe=>{var _0x479eb2=_0x26b5ef;_0x587159[_0x479eb2(0xe6)](_0x479eb2(0xa2),{'success':_0x555269['flash'](_0x479eb2(0x137)),'errors':_0x555269[_0x479eb2(0x8d)]('errors'),'role':_0x103ddd,'profile':_0x40cb34,'master_shop':_0x4dafd8,'warehouse':_0x170bd1,'language':_0x33aaca,'invoice':_0x3f54fe});})[_0x26b5ef(0xcf)](_0x83fde5=>{var _0x1708eb=_0x26b5ef;_0x555269[_0x1708eb(0x8d)](_0x1708eb(0xd0),_0x1708eb(0xac)),_0x587159['redirect'](_0x1708eb(0x12b));});}catch(_0x528f92){console[_0x26b5ef(0xa7)](_0x528f92);}}),router[a0_0x4528a8(0x12a)](a0_0x4528a8(0xf0),auth,async(_0x2c2ae0,_0xef7a4)=>{var _0x473b6f=a0_0x4528a8;try{const {date:_0x5b47c8,from_warehouse:_0x15b691,FromRoom_name:_0x4a3ee2,to_warehouse:_0x2a0f24,ToRoom_name:_0x1058d7,prod_name:_0x42aa77,from_prod_qty:_0x37e736,from_prod_level:_0x454126,from_prod_isle:_0xde7c04,from_prod_pallet:_0x2107f1,to_prod_qty:_0x5cd24a,to_prod_level:_0x5ec5a0,to_prod_isle:_0x1e778a,to_prod_pallet:_0x4ba2c0,primary_code:_0xe11ad8,secondary_code:_0x57f99c,product_code3:_0x2bde39,note:_0x29d3cd,MaxStocks_data2:_0x56301d,invoice:_0x8edae6,expiry_date:_0x493d09}=_0x2c2ae0[_0x473b6f(0xbd)];if(typeof _0x42aa77=='string')var _0x4ca574=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x11d)]],_0x1c7e77=[_0x2c2ae0[_0x473b6f(0xbd)]['from_prod_qty']],_0x1d72d9=[_0x2c2ae0[_0x473b6f(0xbd)]['from_prod_level']],_0x408963=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xb3)]],_0x3a207d=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x104)]],_0x121d26=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x10f)]],_0x1fa84e=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x83)]],_0x378e53=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x9f)]],_0x5979ed=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xf5)]],_0x14f5eb=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xea)]],_0x4a9e4d=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xf3)]],_0x4c29ef=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x13f)]],_0xdbe086=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xbb)]],_0xd47363=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x85)]],_0x2741e7=[_0x2c2ae0['body'][_0x473b6f(0xeb)]],_0x2589c9=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x132)]],_0x530f3f=[_0x2c2ae0[_0x473b6f(0xbd)]['prod_cat']],_0x4ff7ca=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x8b)]],_0x14c529=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x78)]],_0x5da9fd=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xd2)]],_0x4cb7ba=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xb1)]],_0x55045b=[_0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x7c)]];else var _0x4ca574=[..._0x2c2ae0['body']['prod_name']],_0x1c7e77=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xd1)]],_0x1d72d9=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x146)]],_0x408963=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xb3)]],_0x3a207d=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x104)]],_0x121d26=[..._0x2c2ae0[_0x473b6f(0xbd)]['primary_code']],_0x1fa84e=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x83)]],_0x378e53=[..._0x2c2ae0['body'][_0x473b6f(0x9f)]],_0x5979ed=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xf5)]],_0x14f5eb=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xea)]],_0x4a9e4d=[..._0x2c2ae0[_0x473b6f(0xbd)]['secondary_unit']],_0x4c29ef=[..._0x2c2ae0['body'][_0x473b6f(0x13f)]],_0xdbe086=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0xbb)]],_0xd47363=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x85)]],_0x2741e7=[..._0x2c2ae0['body'][_0x473b6f(0xeb)]],_0x2589c9=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x132)]],_0x530f3f=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x12f)]],_0x4ff7ca=[..._0x2c2ae0['body'][_0x473b6f(0x8b)]],_0x14c529=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x78)]],_0x5da9fd=[..._0x2c2ae0['body']['from_invoice']],_0x4cb7ba=[..._0x2c2ae0['body'][_0x473b6f(0xb1)]],_0x55045b=[..._0x2c2ae0[_0x473b6f(0xbd)][_0x473b6f(0x7c)]];const _0x354dc3=_0x4ca574[_0x473b6f(0xfc)](_0x2277b1=>{return _0x2277b1={'product_name':_0x2277b1};});_0x1c7e77[_0x473b6f(0xd4)]((_0x3d0b08,_0x141f8c)=>{var _0x4103e1=_0x473b6f;_0x354dc3[_0x141f8c][_0x4103e1(0x11e)]=_0x3d0b08;}),_0x1d72d9[_0x473b6f(0xd4)]((_0x15ea33,_0xd2dc1a)=>{var _0x40b7ca=_0x473b6f;_0x354dc3[_0xd2dc1a][_0x40b7ca(0x8c)]=_0x15ea33;}),_0x55045b[_0x473b6f(0xd4)]((_0x5e1abd,_0xee344c)=>{_0x354dc3[_0xee344c]['id_transaction']=_0x5e1abd;}),_0x5da9fd[_0x473b6f(0xd4)]((_0x27787a,_0x598059)=>{var _0x8d8ec1=_0x473b6f;_0x354dc3[_0x598059][_0x8d8ec1(0xd2)]=_0x27787a;}),_0x4cb7ba[_0x473b6f(0xd4)]((_0x17b094,_0x32db1a)=>{var _0x40434d=_0x473b6f;_0x354dc3[_0x32db1a][_0x40434d(0x6d)]=_0x17b094;}),_0x408963[_0x473b6f(0xd4)]((_0x536312,_0x36ae22)=>{var _0x12d326=_0x473b6f;_0x354dc3[_0x36ae22][_0x12d326(0x107)]=_0x536312;}),_0x3a207d['forEach']((_0x317091,_0x57654c)=>{var _0x8a3a4e=_0x473b6f;_0x354dc3[_0x57654c][_0x8a3a4e(0x96)]=_0x317091;}),_0x121d26['forEach']((_0x35e290,_0x5db306)=>{var _0x48ca2a=_0x473b6f;_0x354dc3[_0x5db306][_0x48ca2a(0x10f)]=_0x35e290;}),_0x1fa84e[_0x473b6f(0xd4)]((_0x4cae1d,_0x196ea8)=>{_0x354dc3[_0x196ea8]['secondary_code']=_0x4cae1d;}),_0x378e53[_0x473b6f(0xd4)]((_0x1face1,_0x39539c)=>{var _0x1959ea=_0x473b6f;_0x354dc3[_0x39539c][_0x1959ea(0x11b)]=_0x1face1;}),_0x5979ed['forEach']((_0x3afdb5,_0x1c1d57)=>{var _0x2cfcfe=_0x473b6f;_0x354dc3[_0x1c1d57][_0x2cfcfe(0x6c)]=_0x3afdb5;}),_0x14f5eb[_0x473b6f(0xd4)]((_0x176aca,_0x49d91b)=>{var _0x4b9d81=_0x473b6f;_0x354dc3[_0x49d91b][_0x4b9d81(0x143)]=_0x176aca;}),_0x4a9e4d[_0x473b6f(0xd4)]((_0x372d11,_0x1570e7)=>{var _0xa437e2=_0x473b6f;_0x354dc3[_0x1570e7][_0xa437e2(0xf3)]=_0x372d11;}),_0x4c29ef['forEach']((_0x18b861,_0x37b8d0)=>{_0x354dc3[_0x37b8d0]['batch_code']=_0x18b861;}),_0xdbe086[_0x473b6f(0xd4)]((_0x142149,_0x23768e)=>{var _0x538904=_0x473b6f;_0x354dc3[_0x23768e][_0x538904(0xbb)]=_0x142149;}),_0xd47363[_0x473b6f(0xd4)]((_0x27d713,_0x25a9fc)=>{var _0x29625c=_0x473b6f;_0x354dc3[_0x25a9fc][_0x29625c(0x114)]=_0x27d713;}),_0x2741e7[_0x473b6f(0xd4)]((_0x1029e0,_0x4fec9a)=>{var _0xfa790f=_0x473b6f;_0x354dc3[_0x4fec9a][_0xfa790f(0x6c)]=_0x1029e0;}),_0x2589c9['forEach']((_0x4e1aed,_0x1dffc5)=>{var _0x5b46aa=_0x473b6f;_0x354dc3[_0x1dffc5][_0x5b46aa(0x132)]=_0x4e1aed;}),_0x530f3f[_0x473b6f(0xd4)]((_0x525687,_0x49ef71)=>{_0x354dc3[_0x49ef71]['prod_cat']=_0x525687;}),_0x4ff7ca['forEach']((_0x54f293,_0x3a7039)=>{_0x354dc3[_0x3a7039]['from_room_name']=_0x54f293;}),_0x14c529[_0x473b6f(0xd4)]((_0x5a93e0,_0x38b8e6)=>{var _0x41d759=_0x473b6f;_0x354dc3[_0x38b8e6][_0x41d759(0x12d)]=_0x5a93e0;});const _0x32c8df=_0x354dc3[_0x473b6f(0x9b)](_0x48f425=>_0x48f425[_0x473b6f(0x107)]!=='0'&&_0x48f425[_0x473b6f(0x107)]!==''||_0x48f425[_0x473b6f(0x101)]!=='0'&&_0x48f425[_0x473b6f(0x101)]!=='');var _0x116c9b=0x0;_0x32c8df[_0x473b6f(0xd4)](_0x4fc1a0=>{var _0x4d73d9=_0x473b6f;parseInt(_0x4fc1a0[_0x4d73d9(0x11e)])<parseInt(_0x4fc1a0[_0x4d73d9(0x107)])&&_0x116c9b++;});if(_0x116c9b!=0x0)return _0x2c2ae0[_0x473b6f(0x8d)](_0x473b6f(0xd0),_0x473b6f(0x73)),_0xef7a4[_0x473b6f(0x120)](_0x473b6f(0x13b));const _0x5877ff=new transfers_finished({'date':_0x5b47c8,'from_warehouse':_0x15b691,'to_warehouse':_0x2a0f24,'product':_0x32c8df,'note':_0x29d3cd,'invoice':_0x8edae6}),_0x5c6f90=await _0x5877ff['save']();_0x2c2ae0['flash'](_0x473b6f(0x137),_0x473b6f(0x6e)),_0xef7a4[_0x473b6f(0x120)](_0x473b6f(0x94)+_0x5c6f90[_0x473b6f(0xf6)]);}catch(_0x17c71f){console[_0x473b6f(0xa7)](_0x17c71f),_0xef7a4['status'](0xc8)[_0x473b6f(0xdb)]({'errorMessage':_0x17c71f[_0x473b6f(0xe9)]});}}),router[a0_0x4528a8(0x125)](a0_0x4528a8(0x116),auth,async(_0x50510e,_0x1c63de)=>{var _0x5856c1=a0_0x4528a8;try{const {username:_0xa598a2,email:_0x27714f,role:_0x52080a}=_0x50510e[_0x5856c1(0xa6)],_0x20f5ba=_0x50510e[_0x5856c1(0xa6)],_0x42438e=await profile[_0x5856c1(0x7b)]({'email':_0x20f5ba[_0x5856c1(0xdc)]}),_0x225c06=await master_shop['find'](),_0x5dc456=await transfers_finished[_0x5856c1(0x93)](_0x50510e[_0x5856c1(0x133)]['id']);let _0x531239;if(_0x20f5ba[_0x5856c1(0x106)]==_0x5856c1(0xb6)){const _0x121181=await staff[_0x5856c1(0x7b)]({'email':_0x20f5ba['email']});_0x531239=await warehouse[_0x5856c1(0x76)]({'status':_0x5856c1(0xa3),'name':_0x121181[_0x5856c1(0xde)],'warehouse_category':_0x5856c1(0x75)});}else _0x531239=await warehouse['find']({'status':_0x5856c1(0xa3),'warehouse_category':_0x5856c1(0x75)});const _0xe91113=await warehouse[_0x5856c1(0xa9)]([{'$match':{'name':_0x5dc456['from_warehouse'],'warehouse_category':_0x5856c1(0x75)}},{'$unwind':_0x5856c1(0x142)},{'$group':{'_id':_0x5856c1(0x92),'name':{'$first':_0x5856c1(0xb0)},'product_stock':{'$first':_0x5856c1(0x108)},'bay':{'$first':_0x5856c1(0x9d)},'bin':{'$first':_0x5856c1(0x127)},'type':{'$first':_0x5856c1(0x12e)},'floorlevel':{'$first':_0x5856c1(0x103)},'primary_code':{'$first':_0x5856c1(0xa5)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5856c1(0xbe)},'storage':{'$first':_0x5856c1(0x6f)},'rack':{'$first':_0x5856c1(0x112)},'expiry_date':{'$first':_0x5856c1(0x135)},'production_date':{'$first':_0x5856c1(0x98)},'room':{'$first':_0x5856c1(0xed)},'warehoue_name':{'$first':_0x5856c1(0xdf)}}}]),_0x32a938=await product['find']({});if(_0x225c06[0x0][_0x5856c1(0xec)]==_0x5856c1(0x89)){var _0x186905=users[_0x5856c1(0xc9)];console[_0x5856c1(0xa7)](_0x186905);}else{if(_0x225c06[0x0][_0x5856c1(0xec)]==_0x5856c1(0xe4))var _0x186905=users[_0x5856c1(0xe4)];else{if(_0x225c06[0x0][_0x5856c1(0xec)]==_0x5856c1(0x88))var _0x186905=users[_0x5856c1(0x88)];else{if(_0x225c06[0x0][_0x5856c1(0xec)]==_0x5856c1(0xe5))var _0x186905=users[_0x5856c1(0xe5)];else{if(_0x225c06[0x0][_0x5856c1(0xec)]==_0x5856c1(0x113))var _0x186905=users['French'];else{if(_0x225c06[0x0][_0x5856c1(0xec)]==_0x5856c1(0x8f))var _0x186905=users[_0x5856c1(0xf1)];else{if(_0x225c06[0x0][_0x5856c1(0xec)]==_0x5856c1(0x123))var _0x186905=users[_0x5856c1(0x123)];else{if(_0x225c06[0x0][_0x5856c1(0xec)]==_0x5856c1(0x140))var _0x186905=users['Arabic'];}}}}}}}_0x1c63de[_0x5856c1(0xe6)](_0x5856c1(0xb9),{'success':_0x50510e[_0x5856c1(0x8d)](_0x5856c1(0x137)),'errors':_0x50510e[_0x5856c1(0x8d)](_0x5856c1(0xd0)),'role':_0x20f5ba,'profile':_0x42438e,'master_shop':_0x225c06,'warehouse':_0x531239,'transfer':_0x5dc456,'stock':_0xe91113,'unit':_0x32a938,'language':_0x186905});}catch(_0x7f7767){console['log'](_0x7f7767);}}),router[a0_0x4528a8(0x12a)](a0_0x4528a8(0x116),auth,async(_0x3fcc1a,_0x424f85)=>{var _0x18ed7d=a0_0x4528a8;try{const {invoice:_0x3df69b,from_warehouse:_0x534782,FromRoom_name:_0x6e9d95,to_warehouse:_0x2d57c7,ToRoom_name:_0x575972}=_0x3fcc1a['body'],_0x67f257=await transfers_finished['findById'](_0x3fcc1a[_0x18ed7d(0x133)]['id']),_0x7b691e=_0x67f257[_0x18ed7d(0xd9)]['map'](async _0x245607=>{var _0x57c0b2=_0x18ed7d;if(_0x245607[_0x57c0b2(0x107)]>0x0){var _0x2f42a7=await warehouse[_0x57c0b2(0x7b)]({'name':_0x534782,'room':_0x245607['from_room_name'],'warehouse_category':_0x57c0b2(0x75)});const _0x31359e=_0x2f42a7[_0x57c0b2(0xca)][_0x57c0b2(0xfc)](_0x1bdbcf=>{var _0xc5342a=_0x57c0b2;_0x1bdbcf[_0xc5342a(0x6a)]==_0x245607['product_name']&&_0x1bdbcf[_0xc5342a(0x100)]==_0x245607[_0xc5342a(0x8c)]&&_0x1bdbcf['expiry_date']==_0x245607['expiry_date']&&_0x1bdbcf[_0xc5342a(0x114)]==_0x245607[_0xc5342a(0x114)]&&_0x1bdbcf[_0xc5342a(0x13f)]==_0x245607[_0xc5342a(0x13f)]&&_0x1bdbcf[_0xc5342a(0xab)]==_0x245607['from_invoice']&&(console[_0xc5342a(0xa7)](_0xc5342a(0xc8),_0x1bdbcf['product_stock']),typeof _0x245607['id_transaction']==_0xc5342a(0x122)?_0x1bdbcf[_0xc5342a(0x7f)]=Math['max'](0x0,Math[_0xc5342a(0xb8)](_0x1bdbcf[_0xc5342a(0x7f)])-Math[_0xc5342a(0xb8)](_0x245607[_0xc5342a(0x107)])):_0x1bdbcf[_0xc5342a(0x7f)]=Math[_0xc5342a(0x91)](0x0,Math[_0xc5342a(0xb8)](_0x1bdbcf['product_stock'])-Math[_0xc5342a(0xb8)](_0x245607[_0xc5342a(0x107)])));});}return _0x2f42a7;});Promise[_0x18ed7d(0x128)](_0x7b691e)['then'](async _0x3617d8=>{var _0x1a4579=_0x18ed7d;try{for(const _0x416c8e of _0x3617d8){await _0x416c8e[_0x1a4579(0xc1)]();}const _0xc893eb=_0x67f257[_0x1a4579(0xd9)][_0x1a4579(0xfc)](async _0x418556=>{var _0x2e1e6b=_0x1a4579,_0x5be486=await warehouse['findOne']({'name':_0x2d57c7,'room':_0x418556[_0x2e1e6b(0x12d)]});if(_0x418556[_0x2e1e6b(0x107)]>0x0){var _0x23f6fa=0x0;const _0x3b994f=_0x5be486[_0x2e1e6b(0xca)]['map'](_0x3aa84b=>{var _0xfefaf7=_0x2e1e6b;_0x3aa84b[_0xfefaf7(0x6a)]==_0x418556['product_name']&&_0x3aa84b[_0xfefaf7(0x100)]==_0x418556[_0xfefaf7(0x96)]&&_0x3aa84b[_0xfefaf7(0xbb)]==_0x418556['expiry_date']&&_0x3aa84b['production_date']==_0x418556[_0xfefaf7(0x114)]&&_0x3aa84b[_0xfefaf7(0x13f)]==_0x418556['batch_code']&&_0x3aa84b[_0xfefaf7(0xab)]==_0x418556[_0xfefaf7(0x6d)]&&(typeof _0x418556[_0xfefaf7(0x7c)]==_0xfefaf7(0x122)?(console[_0xfefaf7(0xa7)](_0xfefaf7(0xc4),_0x3aa84b['product_stock']+_0xfefaf7(0x131)+_0x3aa84b[_0xfefaf7(0xf6)]+_0xfefaf7(0xcc)+Math['abs'](_0x3aa84b[_0xfefaf7(0x7f)])+Math[_0xfefaf7(0xb8)](_0x418556[_0xfefaf7(0x107)])),_0x3aa84b[_0xfefaf7(0x7f)]=Math[_0xfefaf7(0xb8)](_0x3aa84b[_0xfefaf7(0x7f)])+Math[_0xfefaf7(0xb8)](_0x418556[_0xfefaf7(0x107)])):_0x3aa84b[_0xfefaf7(0x7f)]=Math[_0xfefaf7(0xb8)](_0x3aa84b[_0xfefaf7(0x7f)])+Math[_0xfefaf7(0xb8)](_0x418556[_0xfefaf7(0x107)]),_0x23f6fa++);});_0x23f6fa=='0'&&(_0x5be486[_0x2e1e6b(0xca)]=_0x5be486[_0x2e1e6b(0xca)][_0x2e1e6b(0x80)]({'product_name':_0x418556[_0x2e1e6b(0x6a)],'product_stock':_0x418556[_0x2e1e6b(0x107)],'bay':_0x418556[_0x2e1e6b(0x96)],'product_code':_0x418556[_0x2e1e6b(0x11b)],'primary_code':_0x418556[_0x2e1e6b(0x10f)],'secondary_code':_0x418556[_0x2e1e6b(0x83)],'expiry_date':_0x418556[_0x2e1e6b(0xbb)],'production_date':_0x418556[_0x2e1e6b(0x114)],'maxProducts':_0x418556[_0x2e1e6b(0x6c)],'batch_code':_0x418556[_0x2e1e6b(0x13f)],'secondary_unit':_0x418556[_0x2e1e6b(0xf3)],'unit':_0x418556['unit'],'maxProducts':_0x418556[_0x2e1e6b(0x6c)],'maxPerUnit':_0x418556[_0x2e1e6b(0x132)],'invoice':_0x418556[_0x2e1e6b(0x6d)]}));}return _0x5be486;});Promise[_0x1a4579(0x128)](_0xc893eb)['then'](async _0x81c06c=>{var _0x5489b2=_0x1a4579;try{for(const _0xbd31a0 of _0x81c06c){await warehouse[_0x5489b2(0x84)]({'_id':_0xbd31a0[_0x5489b2(0xf6)]},{'$addToSet':{'product_details':{'$each':_0xbd31a0[_0x5489b2(0xca)]}}});}_0x67f257['finalize']=_0x5489b2(0x12c);const _0x488a35=await _0x67f257[_0x5489b2(0xc1)](),_0x5d86a7=await master_shop[_0x5489b2(0x76)](),_0x17fb4b=await email_settings[_0x5489b2(0x7b)](),_0x4336d5=await supervisor_settings[_0x5489b2(0x76)]();var _0x2bfe57=_0x67f257[_0x5489b2(0xd9)],_0x227d4a='',_0x3b77f2;for(_0x3b77f2 in _0x2bfe57){var _0x4e55f4='FG';_0x67f257[_0x5489b2(0xe7)]==_0x5489b2(0xc7)&&(_0x4e55f4='DG'),_0x227d4a+='<tr>'+_0x5489b2(0x7d)+_0x2bfe57[_0x3b77f2][_0x5489b2(0x6a)]+'</td>'+_0x5489b2(0x7d)+_0x2bfe57[_0x3b77f2][_0x5489b2(0x11b)]+_0x5489b2(0x9a)+_0x5489b2(0x7d)+_0x2bfe57[_0x3b77f2][_0x5489b2(0x107)]+'</td>'+_0x5489b2(0x7d)+_0x2bfe57[_0x3b77f2][_0x5489b2(0x143)]+_0x5489b2(0x9a)+_0x5489b2(0x7d)+_0x2bfe57[_0x3b77f2][_0x5489b2(0xf3)]+'</td>'+_0x5489b2(0x7d)+_0x67f257[_0x5489b2(0xe7)]+_0x5489b2(0x9a)+_0x5489b2(0x7d)+_0x2bfe57[_0x3b77f2][_0x5489b2(0x12d)]+'</td>'+_0x5489b2(0x7d)+_0x4e55f4+_0x2bfe57[_0x3b77f2]['to_bay']+_0x5489b2(0x9a)+'</tr>';}let _0x5998f8=nodemailer[_0x5489b2(0x117)]({'host':_0x17fb4b['host'],'port':Number(_0x17fb4b[_0x5489b2(0x139)]),'secure':![],'auth':{'user':_0x17fb4b[_0x5489b2(0xdc)],'pass':_0x17fb4b[_0x5489b2(0x147)]}}),_0x3b80c3={'from':_0x17fb4b['email'],'to':_0x4336d5[0x0][_0x5489b2(0x126)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x5489b2(0xff),'path':__dirname+'/../public'+_0x5489b2(0x118)+_0x5d86a7[0x0][_0x5489b2(0x105)],'cid':'logo'}],'html':_0x5489b2(0xf9)+'<html><head><title></title>'+_0x5489b2(0x138)+_0x5489b2(0x7a)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x5489b2(0x7a)+_0x5489b2(0xfd)+'</div>'+_0x5489b2(0x7a)+'<h2>\x20'+_0x5d86a7[0x0][_0x5489b2(0x74)]+_0x5489b2(0xd8)+_0x5489b2(0xf7)+_0x5489b2(0xf7)+'<hr\x20class=\x22my-3\x22>'+_0x5489b2(0x7a)+_0x5489b2(0x10d)+'\x20Order\x20Number\x20:\x20'+_0x67f257['invoice']+'\x20'+_0x5489b2(0x97)+_0x5489b2(0x6b)+_0x67f257[_0x5489b2(0xa8)]+'\x20'+_0x5489b2(0xd3)+_0x5489b2(0xc3)+'</div>'+_0x5489b2(0x13a)+_0x5489b2(0xee)+'<tr>'+_0x5489b2(0xfb)+_0x5489b2(0xbf)+_0x5489b2(0xb4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x5489b2(0x10b)+_0x5489b2(0x9e)+_0x5489b2(0x81)+_0x5489b2(0xd7)+_0x5489b2(0xfa)+_0x5489b2(0xda)+'\x20'+_0x227d4a+'\x20'+_0x5489b2(0xe2)+_0x5489b2(0x13e)+_0x5489b2(0x7a)+_0x5489b2(0xb2)+'<h5>'+_0x5d86a7[0x0][_0x5489b2(0x74)]+_0x5489b2(0xc3)+_0x5489b2(0xf7)+_0x5489b2(0xf7)+_0x5489b2(0x124)};_0x5998f8['sendMail'](_0x3b80c3,function(_0x462f0f,_0x9a2034){var _0x3a4459=_0x5489b2;_0x462f0f?(console['log'](_0x462f0f),console[_0x3a4459(0xa7)](_0x3a4459(0xae))):console[_0x3a4459(0xa7)](_0x3a4459(0xc6));}),_0x3fcc1a[_0x5489b2(0x8d)](_0x5489b2(0x137),_0x5489b2(0xf2)),_0x424f85[_0x5489b2(0x120)](_0x5489b2(0x72)+_0x488a35[_0x5489b2(0xf6)]);}catch(_0x2bd27f){console['error'](_0x2bd27f),_0x424f85[_0x5489b2(0x121)](0x1f4)[_0x5489b2(0xdb)]({'error':_0x5489b2(0xfe)});}})[_0x1a4579(0xcf)](_0x5c8530=>{var _0x503543=_0x1a4579;console['error'](_0x5c8530),_0x424f85[_0x503543(0x121)](0x1f4)['json']({'error':_0x503543(0xb7)});});}catch(_0x2df0ca){console[_0x1a4579(0x110)](_0x2df0ca),_0x424f85[_0x1a4579(0x121)](0x1f4)[_0x1a4579(0xdb)]({'error':_0x1a4579(0x109)});}})[_0x18ed7d(0xcf)](_0x239996=>{var _0x39fe10=_0x18ed7d;console[_0x39fe10(0x110)](_0x239996),_0x424f85[_0x39fe10(0x121)](0x1f4)[_0x39fe10(0xdb)]({'error':'An\x20error\x20occurred.'});});}catch(_0x4ac54a){_0x424f85[_0x18ed7d(0xdb)]({'message':_0x4ac54a[_0x18ed7d(0xe9)]});}});function BayBinSelected(_0x3bccab,_0x2f76b4){var _0x1fe92c=a0_0x4528a8,_0x308962=[];let _0x1f30f0=[];var _0x200cc6=[];if(_0x3bccab=='DRY\x20GOODS'){switch(_0x2f76b4){case _0x1fe92c(0xf8):_0x308962=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x1fe92c(0x86):_0x308962=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x200cc6=['DG'];}else{if(_0x3bccab=='FROZEN\x20GOODS'){switch(_0x2f76b4){case'Rack\x201':_0x308962=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x1fe92c(0x86):_0x308962=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x200cc6=['FG'];}}return{'levels':_0x308962,'identify':_0x200cc6};}function a0_0x9257(){var _0x17fbff=['back','$product.from_room_name','$finalize','</table>','batch_code','Arabic\x20(ae)','$product_details.invoice','$product_details','unit','express','$product_details.pallet','from_prod_level','password','product_name','\x20Order\x20Date\x20:\x20','maxProducts','To_invoice','Product\x20Transfer\x20successfully','$product_details.storage','../models/all_models','to_prod_qty','/picking_list/PDF_transfer/','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','site_title','Finished\x20Goods','find','push','ToRoomAssigned','422779yVXeJE','<div>','findOne','id_transaction','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.unit','product_stock','concat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.maxProducts','secondary_code','updateOne','product_date','Rack\x202','toString','German','English\x20(US)','$product','RoomAssigned','from_bay','flash','then','Portuguese\x20(BR)','1131450VYcPbf','max','$product_details._id','findById','/transfer_finished/preview/','floor','to_bay','<span\x20style=\x22float:\x20right;\x22>','$product_details.production_date','Ambient','</td>','filter','edit_transfer_finished','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','product_code3','$product_details.level','479534afHhIx','add_transfer_finished','Enabled','$to_warehouse','$product_details.primary_code','user','log','date','aggregate','$invoice','invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','QA\x20Warehouse','Error\x20Occurs','/view/:id','$product_details.product_name','to_invoice','<strong>\x20Regards\x20</strong>','New_Qty_Converted','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','62vjxjqv','staff','An\x20error\x20occurred.','abs','edit_transfer_finished_view','exports','expiry_date','$from_warehouse','body','$product_details.product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Arabic','save','padStart','</h5>','here2','random','Email\x20sent\x20successfully','DRY\x20GOODS','here1','English','product_details','$product_details.secondary_code','\x20<=>\x20','/barcode_scanner3','$product_details.maxPerUnit','catch','errors','from_prod_qty','from_invoice','</span>','forEach','split','from_room','</tr>','\x20</h2>','product','<tbody\x20style=\x22text-align:\x20center;\x22>','json','email','$product_details.batch_code','warehouse','$name','nodemailer','TRFF-','</tbody>','Transfer\x20Edit\x20Successfully','Hindi','Spanish','render','to_warehouse','from_warehouse','message','primary_unit','MaxStocks_data','language','$room','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','to_room','/view/add_transfer','Portuguese','Transfer\x20Finalize\x20Successfully','secondary_unit','getMonth','MaxStocks_data2','_id','</div>','Rack\x201','<!DOCTYPE\x20html>','</thead>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','map','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','Logo.png','bay','to_floorlevel','$_id','$product_details.floorlevel','to_prod_level','image','role','to_quantity','$product_details.product_stock','An\x20error\x20occurred\x20while\x20saving\x20data.','length','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.secondary_unit','<h5\x20style=\x22text-align:\x20left;\x22>','$product.to_room_name','primary_code','error','/barcode_scanner','$product_details.rack','French','production_date','Router','/preview/:id','createTransport','/upload/','243596EPJEtD','146232qLpNao','product_code','$product_details.isle','prod_name','from_quantity','slice','redirect','status','undefined','Chinese','</body></html>','get','FGSEmail','$product_details.bin','all','3393OLpBJG','post','/transfer/view','True','to_room_name','$product_details.type','prod_cat','1601310RCtLFm','\x20<>\x20','maxPerUnit','params','10dLwpjf','$product_details.expiry_date','54UXENVP','success','</head><body>','port','<table\x20style=\x22width:\x20100%\x20!important;\x22>'];a0_0x9257=function(){return _0x17fbff;};return a0_0x9257();}router[a0_0x4528a8(0x125)]('/view/:id',auth,async(_0x3177fd,_0x22f856)=>{var _0x5890b6=a0_0x4528a8;try{const {username:_0x521f1c,email:_0x17853c,role:_0x2c1635}=_0x3177fd[_0x5890b6(0xa6)],_0x305f16=_0x3177fd[_0x5890b6(0xa6)],_0x50aa1e=await profile['findOne']({'email':_0x305f16[_0x5890b6(0xdc)]}),_0x3a7cc2=await master_shop[_0x5890b6(0x76)](),_0x254aac=await transfers_finished['findById'](_0x3177fd[_0x5890b6(0x133)]['id']);let _0x87a431=new Date(_0x254aac[_0x5890b6(0xbb)]),_0xce12c4=('0'+_0x87a431['getDate']())['slice'](-0x2),_0x54c06d=('0'+(_0x87a431[_0x5890b6(0xf4)]()+0x1))[_0x5890b6(0x11f)](-0x2),_0x2fc806=_0x87a431['getFullYear'](),_0x50ddae=_0x2fc806+'-'+_0x54c06d+'-'+_0xce12c4,_0x46641a;if(_0x305f16[_0x5890b6(0x106)]==_0x5890b6(0xb6)){const _0x12ed73=await staff[_0x5890b6(0x7b)]({'email':_0x305f16[_0x5890b6(0xdc)]});_0x46641a=await warehouse[_0x5890b6(0x76)]({'status':_0x5890b6(0xa3),'name':_0x12ed73[_0x5890b6(0xde)],'warehouse_category':_0x5890b6(0x75)});}else _0x46641a=await warehouse[_0x5890b6(0x76)]({'status':_0x5890b6(0xa3),'warehouse_category':_0x5890b6(0x75)});const _0x117950=await warehouse[_0x5890b6(0xa9)]([{'$match':{'name':_0x254aac[_0x5890b6(0xe8)],'room':_0x254aac['from_room']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5890b6(0x92),'name':{'$first':_0x5890b6(0xb0)},'product_stock':{'$first':_0x5890b6(0x108)},'bay':{'$first':_0x5890b6(0x9d)},'bin':{'$first':_0x5890b6(0x127)},'type':{'$first':_0x5890b6(0x12e)},'floorlevel':{'$first':_0x5890b6(0x103)},'primary_code':{'$first':_0x5890b6(0xa5)},'secondary_code':{'$first':_0x5890b6(0xcb)},'product_code':{'$first':_0x5890b6(0xbe)},'storage':{'$first':_0x5890b6(0x6f)},'rack':{'$first':_0x5890b6(0x112)}}}]);var _0x2b94c6=[0x1,0x2,0x3,0x4],_0x5b5079=['A','B','C','D','E','F','G','H','I','J'],_0x2e9c13=[_0x5890b6(0x99),'Enclosed'];const _0x337909=await product[_0x5890b6(0x76)]({}),_0x51d4a9=BayBinSelected(_0x254aac[_0x5890b6(0xe7)],_0x254aac[_0x5890b6(0xef)]);if(_0x3a7cc2[0x0][_0x5890b6(0xec)]==_0x5890b6(0x89)){var _0x22afc2=users[_0x5890b6(0xc9)];console[_0x5890b6(0xa7)](_0x22afc2);}else{if(_0x3a7cc2[0x0][_0x5890b6(0xec)]==_0x5890b6(0xe4))var _0x22afc2=users['Hindi'];else{if(_0x3a7cc2[0x0][_0x5890b6(0xec)]==_0x5890b6(0x88))var _0x22afc2=users[_0x5890b6(0x88)];else{if(_0x3a7cc2[0x0]['language']==_0x5890b6(0xe5))var _0x22afc2=users[_0x5890b6(0xe5)];else{if(_0x3a7cc2[0x0][_0x5890b6(0xec)]==_0x5890b6(0x113))var _0x22afc2=users['French'];else{if(_0x3a7cc2[0x0][_0x5890b6(0xec)]==_0x5890b6(0x8f))var _0x22afc2=users[_0x5890b6(0xf1)];else{if(_0x3a7cc2[0x0][_0x5890b6(0xec)]==_0x5890b6(0x123))var _0x22afc2=users[_0x5890b6(0x123)];else{if(_0x3a7cc2[0x0][_0x5890b6(0xec)]==_0x5890b6(0x140))var _0x22afc2=users[_0x5890b6(0xc0)];}}}}}}}_0x22f856['render'](_0x5890b6(0x9c),{'success':_0x3177fd['flash'](_0x5890b6(0x137)),'errors':_0x3177fd[_0x5890b6(0x8d)](_0x5890b6(0xd0)),'role':_0x305f16,'profile':_0x50aa1e,'master_shop':_0x3a7cc2,'warehouse':_0x46641a,'transfer':_0x254aac,'stock':_0x117950,'unit':_0x337909,'language':_0x22afc2,'levels':_0x2b94c6,'Isle':_0x5b5079,'rooms_data':_0x2e9c13,'ed_fullDate':_0x50ddae,'dataSelected':_0x51d4a9});}catch(_0x3329e3){console[_0x5890b6(0xa7)](_0x3329e3);}}),router[a0_0x4528a8(0x12a)](a0_0x4528a8(0xaf),auth,async(_0x384f29,_0x567c03)=>{var _0x212fa3=a0_0x4528a8;try{const _0x5be28e=_0x384f29[_0x212fa3(0x133)]['id'];console['log'](_0x384f29[_0x212fa3(0xbd)]);const _0x5d4c04=await transfers_finished['findById'](_0x5be28e);console[_0x212fa3(0xa7)]('transfer_data',_0x5d4c04);const {date:_0x3bfe05,from_warehouse:_0x19f0c5,FromRoom_name:_0x30b823,to_warehouse:_0x162f39,ToRoom_name:_0x23ff20,prod_name:_0x5e5503,from_prod_qty:_0x4a2271,from_prod_level:_0x2f4493,from_prod_isle:_0x94dfe9,from_prod_pallet:_0x5b74ac,to_prod_qty:_0x15dd61,to_prod_level:_0x31fd03,to_prod_isle:_0x5096c6,to_prod_pallet:_0x58a5d6,primary_code:_0x1737aa,secondary_code:_0x5b6f78,product_code3:_0x14dc07,note:_0x53e0af,invoice:_0x1ecf6c,expiry_date:_0x309857}=_0x384f29['body'];if(typeof _0x5e5503=='string')var _0x296ba0=[_0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x11d)]],_0x55814e=[_0x384f29['body'][_0x212fa3(0xd1)]],_0x3952f3=[_0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x146)]],_0x829137=[_0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x71)]],_0x44aa95=[_0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x104)]],_0x14cd08=[_0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x10f)]],_0x26e97c=[_0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x83)]],_0x1c12aa=[_0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x9f)]],_0x5ba302=[_0x384f29[_0x212fa3(0xbd)]['MaxStocks_data2']],_0x5ad119=[_0x384f29['body'][_0x212fa3(0x143)]],_0x85160d=[_0x384f29[_0x212fa3(0xbd)][_0x212fa3(0xf3)]],_0x39cf62=[_0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x13f)]],_0x1518ca=[_0x384f29['body'][_0x212fa3(0xbb)]];else var _0x296ba0=[..._0x384f29['body']['prod_name']],_0x55814e=[..._0x384f29[_0x212fa3(0xbd)]['from_prod_qty']],_0x3952f3=[..._0x384f29['body'][_0x212fa3(0x146)]],_0x829137=[..._0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x71)]],_0x44aa95=[..._0x384f29['body'][_0x212fa3(0x104)]],_0x14cd08=[..._0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x10f)]],_0x26e97c=[..._0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x83)]],_0x1c12aa=[..._0x384f29['body'][_0x212fa3(0x9f)]],_0x5ba302=[..._0x384f29[_0x212fa3(0xbd)][_0x212fa3(0xf5)]],_0x5ad119=[..._0x384f29[_0x212fa3(0xbd)][_0x212fa3(0x143)]],_0x85160d=[..._0x384f29[_0x212fa3(0xbd)][_0x212fa3(0xf3)]],_0x39cf62=[..._0x384f29[_0x212fa3(0xbd)]['batch_code']],_0x1518ca=[..._0x384f29[_0x212fa3(0xbd)][_0x212fa3(0xbb)]];const _0x391955=_0x296ba0[_0x212fa3(0xfc)](_0x51f69e=>{return _0x51f69e={'product_name':_0x51f69e};});_0x55814e[_0x212fa3(0xd4)]((_0x3a69d1,_0x36f37c)=>{var _0x3ce9e1=_0x212fa3;_0x391955[_0x36f37c][_0x3ce9e1(0x11e)]=_0x3a69d1;}),_0x3952f3['forEach']((_0x42617a,_0x35c72e)=>{var _0x566356=_0x212fa3;_0x391955[_0x35c72e][_0x566356(0x8c)]=_0x42617a;}),_0x829137[_0x212fa3(0xd4)]((_0x740ba8,_0x24d986)=>{var _0x478ff0=_0x212fa3;_0x391955[_0x24d986][_0x478ff0(0x107)]=_0x740ba8;}),_0x44aa95[_0x212fa3(0xd4)]((_0x32d1ce,_0x36b1c5)=>{var _0x46e9e3=_0x212fa3;_0x391955[_0x36b1c5][_0x46e9e3(0x96)]=_0x32d1ce;}),_0x14cd08[_0x212fa3(0xd4)]((_0x1ecae0,_0xbfbd5e)=>{var _0x4f8737=_0x212fa3;_0x391955[_0xbfbd5e][_0x4f8737(0x10f)]=_0x1ecae0;}),_0x26e97c[_0x212fa3(0xd4)]((_0x4baee2,_0x3bcf67)=>{var _0x2beedd=_0x212fa3;_0x391955[_0x3bcf67][_0x2beedd(0x83)]=_0x4baee2;}),_0x1c12aa[_0x212fa3(0xd4)]((_0xec1d23,_0x49dbf9)=>{var _0x9cb263=_0x212fa3;_0x391955[_0x49dbf9][_0x9cb263(0x11b)]=_0xec1d23;}),_0x5ba302['forEach']((_0x4caada,_0x40d347)=>{var _0x4df203=_0x212fa3;_0x391955[_0x40d347][_0x4df203(0x6c)]=_0x4caada;}),_0x5ad119['forEach']((_0x5c17be,_0x4c77d5)=>{_0x391955[_0x4c77d5]['unit']=_0x5c17be;}),_0x85160d[_0x212fa3(0xd4)]((_0x3bd21e,_0x35202b)=>{var _0x28739a=_0x212fa3;_0x391955[_0x35202b][_0x28739a(0xf3)]=_0x3bd21e;}),_0x39cf62['forEach']((_0x169892,_0x502f09)=>{var _0xea671c=_0x212fa3;_0x391955[_0x502f09][_0xea671c(0x13f)]=_0x169892;}),_0x1518ca[_0x212fa3(0xd4)]((_0x10a614,_0x387876)=>{var _0x108106=_0x212fa3;_0x391955[_0x387876][_0x108106(0xbb)]=_0x10a614;});const _0x3f29fa=_0x391955[_0x212fa3(0x9b)](_0x1950d5=>_0x1950d5[_0x212fa3(0x107)]!=='0'&&_0x1950d5[_0x212fa3(0x107)]!==''||_0x1950d5[_0x212fa3(0x101)]!=='0'&&_0x1950d5[_0x212fa3(0x101)]!=='');var _0xc5fbae=0x0;_0x3f29fa[_0x212fa3(0xd4)](_0x43a59c=>{var _0x108068=_0x212fa3;parseInt(_0x43a59c[_0x108068(0x11e)])<parseInt(_0x43a59c[_0x108068(0x107)])&&_0xc5fbae++;});if(_0xc5fbae!=0x0)return _0x384f29[_0x212fa3(0x8d)](_0x212fa3(0xd0),_0x212fa3(0x73)),_0x567c03['redirect']('back');const _0x39db5a=await warehouse[_0x212fa3(0x7b)]({'name':_0x5d4c04[_0x212fa3(0xe8)],'room':_0x5d4c04[_0x212fa3(0xd6)]});_0x5d4c04['product'][_0x212fa3(0xd4)](_0x5eef0d=>{var _0x58a325=_0x212fa3;if(_0x5eef0d[_0x58a325(0x107)]>0x0){const _0x251a02=_0x39db5a[_0x58a325(0xca)]['map'](_0x57282a=>{var _0x3c484d=_0x58a325;_0x57282a[_0x3c484d(0x6a)]==_0x5eef0d[_0x3c484d(0x6a)]&&_0x57282a[_0x3c484d(0x100)]==_0x5eef0d[_0x3c484d(0x8c)]&&(_0x57282a[_0x3c484d(0x7f)]=parseInt(_0x57282a[_0x3c484d(0x7f)])+parseInt(_0x5eef0d[_0x3c484d(0x107)]));});}}),await _0x39db5a[_0x212fa3(0xc1)]();const _0x509a10=await warehouse[_0x212fa3(0x7b)]({'name':_0x5d4c04[_0x212fa3(0xe7)],'room':_0x5d4c04['to_room']});_0x5d4c04[_0x212fa3(0xd9)]['forEach'](_0x5b891e=>{var _0x29fa8f=_0x212fa3;if(_0x5b891e[_0x29fa8f(0x107)]>0x0){const _0x11b9f4=_0x509a10[_0x29fa8f(0xca)]['map'](_0x4b3ab7=>{var _0x1ff43f=_0x29fa8f;_0x4b3ab7['product_name']==_0x5b891e['product_name']&&_0x4b3ab7[_0x1ff43f(0x100)]==_0x5b891e[_0x1ff43f(0x96)]&&(_0x4b3ab7[_0x1ff43f(0x7f)]=parseInt(_0x4b3ab7[_0x1ff43f(0x7f)])-parseInt(_0x5b891e[_0x1ff43f(0x107)]));});}}),await _0x509a10['save'](),_0x5d4c04[_0x212fa3(0xa8)]=_0x3bfe05,_0x5d4c04['from_warehouse']=_0x19f0c5,_0x5d4c04[_0x212fa3(0xe7)]=_0x162f39,_0x5d4c04[_0x212fa3(0xd9)]=_0x3f29fa,_0x5d4c04['note']=_0x53e0af,_0x5d4c04['invoice']=_0x1ecf6c;const _0x55daeb=await _0x5d4c04[_0x212fa3(0xc1)](),_0x1f6081=await warehouse[_0x212fa3(0x7b)]({'name':_0x19f0c5,'room':_0x30b823});_0x55daeb['product'][_0x212fa3(0xd4)](_0x5baaef=>{var _0x319486=_0x212fa3;if(_0x5baaef[_0x319486(0x107)]>0x0){const _0x53063e=_0x1f6081[_0x319486(0xca)][_0x319486(0xfc)](_0x483017=>{var _0x38aa45=_0x319486;_0x483017['product_name']==_0x5baaef[_0x38aa45(0x6a)]&&_0x483017[_0x38aa45(0x100)]==_0x5baaef['from_bay']&&(_0x483017[_0x38aa45(0x7f)]=parseInt(_0x483017[_0x38aa45(0x7f)])-parseInt(_0x5baaef[_0x38aa45(0x107)]));});}}),await _0x1f6081[_0x212fa3(0xc1)]();const _0x45e18f=await warehouse['findOne']({'name':_0x162f39,'room':_0x23ff20});_0x55daeb[_0x212fa3(0xd9)][_0x212fa3(0xd4)](_0x453cfc=>{var _0x4887ea=_0x212fa3;if(_0x453cfc[_0x4887ea(0x107)]>0x0){var _0x1a0f79=0x0;const _0x696b1a=_0x45e18f[_0x4887ea(0xca)][_0x4887ea(0xfc)](_0x4f807e=>{var _0x302a92=_0x4887ea;_0x4f807e[_0x302a92(0x6a)]==_0x453cfc[_0x302a92(0x6a)]&&_0x4f807e[_0x302a92(0x100)]==_0x453cfc[_0x302a92(0x96)]&&(_0x4f807e['product_stock']=parseInt(_0x4f807e[_0x302a92(0x7f)])+parseInt(_0x453cfc[_0x302a92(0x107)]),_0x1a0f79++);});_0x1a0f79=='0'&&(_0x45e18f[_0x4887ea(0xca)]=_0x45e18f['product_details'][_0x4887ea(0x80)]({'product_name':_0x453cfc[_0x4887ea(0x6a)],'product_stock':_0x453cfc[_0x4887ea(0x107)],'bay':_0x453cfc[_0x4887ea(0x96)],'product_code':_0x453cfc[_0x4887ea(0x11b)],'primary_code':_0x453cfc['primary_code'],'secondary_code':_0x453cfc[_0x4887ea(0x83)],'maxProducts':_0x453cfc[_0x4887ea(0x6c)]}));}}),await _0x45e18f['save'](),_0x384f29[_0x212fa3(0x8d)](_0x212fa3(0x137),_0x212fa3(0xe3)),_0x567c03[_0x212fa3(0x120)]('/transfer_finished/view');}catch(_0x4168f0){console['log'](_0x4168f0);}}),router[a0_0x4528a8(0x12a)](a0_0x4528a8(0x111),async(_0x2577dd,_0x252efb)=>{var _0x2f2cc5=a0_0x4528a8;const {FromWareHouse:_0x2142f3,FromRoom:_0x3aa522,ToWarehouse:_0xd6258b,ToRoom:_0x549f05,primary_code:_0x3b1fd5,Roomslist:_0x1d76e4}=_0x2577dd['body'],_0x109e35=_0x1d76e4[_0x2f2cc5(0xd5)](','),_0x24b239=[];async function _0x596251(_0x4661a2){var _0x28adce=_0x2f2cc5;const _0x50a577=await warehouse[_0x28adce(0xa9)]([{'$match':{'name':_0x2142f3,'room':_0x4661a2}},{'$unwind':_0x28adce(0x142)},{'$match':{'product_details.primary_code':_0x3b1fd5}},{'$group':{'_id':_0x28adce(0x92),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x28adce(0x108)},'primary_code':{'$first':_0x28adce(0xa5)},'secondary_code':{'$first':_0x28adce(0xcb)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x28adce(0x9d)},'isle':{'$first':_0x28adce(0x127)},'type':{'$first':_0x28adce(0x12e)},'pallet':{'$first':_0x28adce(0x103)},'unit':{'$first':_0x28adce(0x7e)},'secondary_unit':{'$first':_0x28adce(0x10c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x28adce(0x112)},'expiry_date':{'$first':_0x28adce(0x135)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x28adce(0xdd)},'maxPerUnit':{'$first':_0x28adce(0xce)},'roomNamed':{'$first':_0x28adce(0xed)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x28adce(0x141)}}}]),_0x36eed9=await warehouse[_0x28adce(0xa9)]([{'$match':{'name':_0x2142f3,'room':_0x4661a2}},{'$unwind':_0x28adce(0x142)},{'$match':{'product_details.secondary_code':_0x3b1fd5}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x28adce(0xb0)},'instock':{'$first':_0x28adce(0x108)},'primary_code':{'$first':_0x28adce(0xa5)},'secondary_code':{'$first':_0x28adce(0xcb)},'product_code':{'$first':_0x28adce(0xbe)},'level':{'$first':_0x28adce(0x9d)},'isle':{'$first':_0x28adce(0x127)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x28adce(0x103)},'unit':{'$first':_0x28adce(0x7e)},'secondary_unit':{'$first':_0x28adce(0x10c)},'storage':{'$first':_0x28adce(0x6f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x28adce(0xed)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x28adce(0x141)}}}]);if(_0x50a577['length']>0x0)_0x24b239[_0x28adce(0x77)](_0x50a577);else _0x36eed9['length']>0x0&&_0x24b239[_0x28adce(0x77)](_0x36eed9);}const _0x38e51e=_0x109e35[_0x2f2cc5(0xfc)](_0x487936=>_0x596251(_0x487936));await Promise[_0x2f2cc5(0x128)](_0x38e51e),_0x252efb['json'](_0x24b239);}),router[a0_0x4528a8(0x12a)]('/barcode_scanner2',async(_0x4c92f8,_0x160142)=>{var _0x458422=a0_0x4528a8;try{const {FromWareHouse:_0x987fc1,FromRoom:_0x29ad18,ToWarehouse:_0x54c7d8,ToRoom:_0xa36f87,secondary_code:_0x47d503}=_0x4c92f8[_0x458422(0xbd)],_0x49bdb7=await warehouse[_0x458422(0xa9)]([{'$match':{'name':_0x987fc1}},{'$unwind':_0x458422(0x142)},{'$match':{'product_details.secondary_code':_0x47d503}},{'$group':{'_id':_0x458422(0x92),'name':{'$first':_0x458422(0xb0)},'primary_code':{'$first':_0x458422(0xa5)},'secondary_code':{'$first':_0x458422(0xcb)},'product_code':{'$first':_0x458422(0xbe)},'instock':{'$first':_0x458422(0x108)},'warehouse':{'$first':'$name'},'level':{'$first':_0x458422(0xa0)},'isle':{'$first':_0x458422(0x11c)},'pallet':{'$first':_0x458422(0x145)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':_0x458422(0x135)},'production_date':{'$first':_0x458422(0x98)}}}]);_0x160142[_0x458422(0x121)](0xc8)['json'](_0x49bdb7);}catch(_0x5a9588){_0x160142[_0x458422(0x121)](0x194)[_0x458422(0xdb)]({'message':_0x5a9588[_0x458422(0xe9)]});}}),router[a0_0x4528a8(0x12a)](a0_0x4528a8(0xcd),async(_0x2c6178,_0xb3db33)=>{var _0x5cc306=a0_0x4528a8;try{const {FromWareHouse:_0x34a276,FromRoom:_0x1a0e69,ToWarehouse:_0xb651cc,ToRoom:_0x40a533,product_code:_0x479b70}=_0x2c6178['body'],_0xd9172c=await warehouse[_0x5cc306(0xa9)]([{'$match':{'name':_0x34a276}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x479b70}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5cc306(0xb0)},'primary_code':{'$first':_0x5cc306(0xa5)},'secondary_code':{'$first':_0x5cc306(0xcb)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x5cc306(0x108)},'warehouse':{'$first':_0x5cc306(0xdf)},'level':{'$first':_0x5cc306(0xa0)},'isle':{'$first':_0x5cc306(0x11c)},'pallet':{'$first':_0x5cc306(0x145)},'maxProducts':{'$first':_0x5cc306(0x82)},'unit':{'$first':_0x5cc306(0x7e)}}}]);_0xb3db33[_0x5cc306(0x121)](0xc8)[_0x5cc306(0xdb)](_0xd9172c);}catch(_0xd26e56){_0xb3db33['status'](0x194)[_0x5cc306(0xdb)]({'message':_0xd26e56['message']});}}),router[a0_0x4528a8(0x12a)]('/CheckingWarehouse',async(_0x22c1a8,_0x5f3144)=>{var _0x5749d8=a0_0x4528a8;const {productCode:_0x4e0581,bay:_0x38e1d6,warehouses:_0x3f8cc7,room:_0x2af3ca}=_0x22c1a8[_0x5749d8(0xbd)];console['log'](_0x22c1a8[_0x5749d8(0xbd)]);try{const _0x320d85=await warehouse[_0x5749d8(0xa9)]([{'$match':{'name':_0x3f8cc7,'room':_0x2af3ca}},{'$unwind':_0x5749d8(0x142)},{'$match':{'product_details.bay':parseInt(_0x38e1d6)}},{'$group':{'_id':_0x5749d8(0x92),'name':{'$first':_0x5749d8(0xb0)},'product_stock':{'$first':_0x5749d8(0x108)},'bay':{'$first':_0x5749d8(0x9d)},'maxProducts':{'$first':_0x5749d8(0x82)}}}]);_0x5f3144[_0x5749d8(0x121)](0xc8)['json'](_0x320d85);}catch(_0x5ec791){_0x5f3144[_0x5749d8(0x121)](0x194)[_0x5749d8(0xdb)]({'message':_0x5ec791['message']});}}),module[a0_0x4528a8(0xba)]=router;