function a0_0x32c4(_0x36b1ac,_0x44807c){var _0x32be52=a0_0x32be();return a0_0x32c4=function(_0x32c4f4,_0x1bb358){_0x32c4f4=_0x32c4f4-0xb6;var _0x2155de=_0x32be52[_0x32c4f4];return _0x2155de;},a0_0x32c4(_0x36b1ac,_0x44807c);}function a0_0x32be(){var _0x2c2bac=['_id','Arabic','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','Email\x20sent\x20successfully','product_details','email','map','findOne','Router','from_quantity','$product_details.batch_code','$product_details.product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','save','random','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','from_prod_qty','New_Qty_Converted','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','FROZEN\x20GOODS','There\x27s\x20a\x20error\x20in\x20this\x20transaction','868848Kqumlh','render','Portuguese','then','Spanish','/barcode_scanner3','$product_details.maxProducts','error','$product_details.bay','</h5>','$finalize','$product_details.level','params','$product_details._id','ToRoomAssigned','unit','/barcode_scanner2','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','prod_name','to_floorlevel','/preview/:id','/transfer_finished/preview/','DRY\x20GOODS','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','<hr\x20class=\x22my-3\x22>','slice','To_invoice','$product_details.secondary_unit','1931181lymIwa','express','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','body','$product_details.product_name','product_name','222dmEYWq','../models/all_models','product_date','</tr>','<span\x20style=\x22float:\x20right;\x22>','\x20Order\x20Date\x20:\x20','Hindi','FGSEmail','findById','Rack\x201','$product','/view/:id','/view/add_transfer','sendMail','catch','An\x20error\x20occurred.','<h2>\x20','getMonth','from_invoice','True','915850ZGnDqN','$name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','</thead>','RoomAssigned','\x20Order\x20Number\x20:\x20','</head><body>','toString','$product_details.floorlevel','primary_code','secondary_code','message','to_bay','Enclosed','status','198414slzmdO','Arabic\x20(ae)','forEach','abs','$date','<tr>','id_transaction','bay','port','Transfer\x20Mail','</table>','31996242CGeJLY','/barcode_scanner','finalize','<!DOCTYPE\x20html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','TRFF-','$product_details.bin','date','push','transfer_data','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</body></html>','add_transfer_finished','filter','expiry_date','staff','batch_code','image','aggregate','$product_details.storage','here2','to_invoice','$product_details.production_date','from_bay','password','<h5>','\x20<=>\x20','English','success','note','<h5\x20style=\x22text-align:\x20left;\x22>','get','post','logo','<div>','from_room','to_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','../public/language/languages.json','primary_unit','to_quantity','user','/transfer_finished/view','$product_details.expiry_date','getDate','here1','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','errors','$product.from_room_name','$product_details.maxPerUnit','$product.to_room_name','<table\x20style=\x22width:\x20100%\x20!important;\x22>','production_date','2264EohIjk','product_stock','back','json','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.unit','maxPerUnit','MaxStocks_data2','host','64495MZIjUw','</td>','Chinese','</div>','from_warehouse','redirect','Enabled','$product_details.secondary_code','to_warehouse','role','$product_details.invoice','Ambient','22064YgGvLi','\x20<>\x20','maxProducts','find','invoice','site_title','/picking_list/PDF_transfer/','$product_details.pallet','/upload/','Portuguese\x20(BR)','$product_details','max','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Finished\x20Goods','$room','../middleware/auth','/transfer/view','padStart','product','Rack\x202','French','string','secondary_unit','concat','to_prod_qty','$from_warehouse','$product_details.product_stock','language','warehouse','flash','to_room','product_code3','to_prod_level','<html><head><title></title>','Product\x20Transfer\x20successfully','English\x20(US)','$product_details.rack','$product_details.isle','German','undefined','prod_cat','Error\x20Occurs','Logo.png','$product_details.type','QA\x20Warehouse','from_prod_level','Transfer\x20Finalize\x20Successfully','length','$product_details.primary_code','log'];a0_0x32be=function(){return _0x2c2bac;};return a0_0x32be();}var a0_0x2e201b=a0_0x32c4;(function(_0x5aecc5,_0x5dcf95){var _0x44b394=a0_0x32c4,_0xf88a72=_0x5aecc5();while(!![]){try{var _0x3f5b9d=-parseInt(_0x44b394(0x135))/0x1+parseInt(_0x44b394(0x144))/0x2+-parseInt(_0x44b394(0x11b))/0x3+-parseInt(_0x44b394(0xff))/0x4+parseInt(_0x44b394(0x18d))/0x5*(-parseInt(_0x44b394(0x121))/0x6)+-parseInt(_0x44b394(0xb7))/0x7*(parseInt(_0x44b394(0x184))/0x8)+parseInt(_0x44b394(0x14f))/0x9;if(_0x3f5b9d===_0x5dcf95)break;else _0xf88a72['push'](_0xf88a72['shift']());}catch(_0xdd4cc3){_0xf88a72['push'](_0xf88a72['shift']());}}}(a0_0x32be,0x7c175));const express=require(a0_0x2e201b(0x11c)),app=express(),router=express[a0_0x2e201b(0xf1)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x2e201b(0x122)),auth=require(a0_0x2e201b(0xc6)),users=require(a0_0x2e201b(0x175)),nodemailer=require('nodemailer');router['get']('/view',auth,async(_0xbdcd32,_0x5e9eeb)=>{var _0x2bfa2b=a0_0x2e201b;try{const {username:_0x43cc39,email:_0x228a4d,role:_0x328437}=_0xbdcd32['user'],_0xcec7d5=_0xbdcd32[_0x2bfa2b(0x178)],_0x45abd7=await profile[_0x2bfa2b(0xf0)]({'email':_0xcec7d5[_0x2bfa2b(0xee)]}),_0x6783bc=await master_shop['find']();let _0x590bf1;if(_0xcec7d5[_0x2bfa2b(0x196)]==_0x2bfa2b(0x15e)){const _0x104a30=await staff[_0x2bfa2b(0xf0)]({'email':_0xcec7d5['email']});_0x590bf1=await transfers_finished[_0x2bfa2b(0xba)]({'from_warehouse':_0x104a30[_0x2bfa2b(0xd3)]});}else _0x590bf1=await transfers_finished['aggregate']([{'$unwind':_0x2bfa2b(0x12b)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x2bfa2b(0x148)},'from_warehouse':{'$first':_0x2bfa2b(0xd0)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x2bfa2b(0x17f)},'to_room_name':{'$addToSet':_0x2bfa2b(0x181)},'finalize':{'$first':_0x2bfa2b(0x109)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x6783bc[0x0]['language']==_0x2bfa2b(0xda))var _0x3ac6d4=users[_0x2bfa2b(0x16a)];else{if(_0x6783bc[0x0][_0x2bfa2b(0xd2)]==_0x2bfa2b(0x127))var _0x3ac6d4=users['Hindi'];else{if(_0x6783bc[0x0][_0x2bfa2b(0xd2)]=='German')var _0x3ac6d4=users[_0x2bfa2b(0xdd)];else{if(_0x6783bc[0x0][_0x2bfa2b(0xd2)]==_0x2bfa2b(0x103))var _0x3ac6d4=users['Spanish'];else{if(_0x6783bc[0x0][_0x2bfa2b(0xd2)]==_0x2bfa2b(0xcb))var _0x3ac6d4=users[_0x2bfa2b(0xcb)];else{if(_0x6783bc[0x0][_0x2bfa2b(0xd2)]==_0x2bfa2b(0xc0))var _0x3ac6d4=users[_0x2bfa2b(0x101)];else{if(_0x6783bc[0x0][_0x2bfa2b(0xd2)]==_0x2bfa2b(0x18f))var _0x3ac6d4=users[_0x2bfa2b(0x18f)];else{if(_0x6783bc[0x0][_0x2bfa2b(0xd2)]==_0x2bfa2b(0x145))var _0x3ac6d4=users[_0x2bfa2b(0xea)];}}}}}}}_0x5e9eeb[_0x2bfa2b(0x100)]('transfer_finished',{'success':_0xbdcd32['flash']('success'),'errors':_0xbdcd32[_0x2bfa2b(0xd4)](_0x2bfa2b(0x17e)),'role':_0xcec7d5,'profile':_0x45abd7,'master_shop':_0x6783bc,'transfer':_0x590bf1,'language':_0x3ac6d4});}catch(_0x2d6444){console[_0x2bfa2b(0xe8)](_0x2d6444);}});async function getRandom8DigitNumber(){var _0x491d32=a0_0x2e201b;const _0xb9ed8c=0x989680,_0x22e127=0x5f5e0ff,_0x56de23=Math['floor'](Math[_0x491d32(0xf7)]()*(_0x22e127-_0xb9ed8c+0x1))+_0xb9ed8c;var _0x274d97;const _0x49c77b=await transfers_finished['findOne']({'invoice':'TRFF-'+_0x56de23});return _0x49c77b&&_0x49c77b[_0x491d32(0xe6)]>0x0?_0x274d97=_0x491d32(0x154)+_0x56de23:_0x274d97=_0x491d32(0x154)+_0x56de23,_0x274d97;}router[a0_0x2e201b(0x16e)]('/view/add_transfer',auth,async(_0x4641e1,_0x2f9823)=>{var _0x4ecada=a0_0x2e201b;try{const {username:_0x8d2ff9,email:_0x5e524f,role:_0x5ef707}=_0x4641e1[_0x4ecada(0x178)],_0x5c630f=_0x4641e1[_0x4ecada(0x178)],_0x53b5b4=await profile[_0x4ecada(0xf0)]({'email':_0x5c630f['email']}),_0x15a7fc=await master_shop[_0x4ecada(0xba)]();let _0x303b5f;if(_0x5c630f[_0x4ecada(0x196)]=='staff'){const _0x2c2c62=await staff['findOne']({'email':_0x5c630f['email']});_0x303b5f=await warehouse[_0x4ecada(0x161)]([{'$match':{'status':_0x4ecada(0x193),'name':_0x2c2c62[_0x4ecada(0xd3)],'warehouse_category':_0x4ecada(0xc4),'name':{'$ne':_0x4ecada(0xe3)}}},{'$group':{'_id':_0x4ecada(0x136),'name':{'$first':_0x4ecada(0x136)}}}]);}else _0x303b5f=await warehouse[_0x4ecada(0x161)]([{'$match':{'status':_0x4ecada(0x193),'warehouse_category':_0x4ecada(0xc4),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x4ecada(0x136),'name':{'$first':'$name'}}}]);const _0x4012b7=await transfers_finished[_0x4ecada(0xba)]({}),_0x15331a=_0x4012b7[_0x4ecada(0xe6)]+0x1,_0x40174a=_0x4ecada(0x154)+_0x15331a[_0x4ecada(0x13c)]()[_0x4ecada(0xc8)](0x5,'0');if(_0x15a7fc[0x0]['language']=='English\x20(US)')var _0x319a74=users[_0x4ecada(0x16a)];else{if(_0x15a7fc[0x0][_0x4ecada(0xd2)]==_0x4ecada(0x127))var _0x319a74=users[_0x4ecada(0x127)];else{if(_0x15a7fc[0x0][_0x4ecada(0xd2)]==_0x4ecada(0xdd))var _0x319a74=users[_0x4ecada(0xdd)];else{if(_0x15a7fc[0x0]['language']==_0x4ecada(0x103))var _0x319a74=users[_0x4ecada(0x103)];else{if(_0x15a7fc[0x0][_0x4ecada(0xd2)]==_0x4ecada(0xcb))var _0x319a74=users[_0x4ecada(0xcb)];else{if(_0x15a7fc[0x0][_0x4ecada(0xd2)]=='Portuguese\x20(BR)')var _0x319a74=users[_0x4ecada(0x101)];else{if(_0x15a7fc[0x0][_0x4ecada(0xd2)]==_0x4ecada(0x18f))var _0x319a74=users['Chinese'];else{if(_0x15a7fc[0x0]['language']==_0x4ecada(0x145))var _0x319a74=users[_0x4ecada(0xea)];}}}}}}}const _0x203848=getRandom8DigitNumber();_0x203848[_0x4ecada(0x102)](_0x288904=>{var _0x14e845=_0x4ecada;_0x2f9823['render'](_0x14e845(0x15b),{'success':_0x4641e1[_0x14e845(0xd4)](_0x14e845(0x16b)),'errors':_0x4641e1['flash'](_0x14e845(0x17e)),'role':_0x5c630f,'profile':_0x53b5b4,'master_shop':_0x15a7fc,'warehouse':_0x303b5f,'language':_0x319a74,'invoice':_0x288904});})[_0x4ecada(0x12f)](_0x1fbe7d=>{var _0x1cb35a=_0x4ecada;_0x4641e1[_0x1cb35a(0xd4)](_0x1cb35a(0x17e),_0x1cb35a(0xfe)),_0x2f9823['redirect'](_0x1cb35a(0xc7));});}catch(_0x1a4d7d){console[_0x4ecada(0xe8)](_0x1a4d7d);}}),router[a0_0x2e201b(0x16f)](a0_0x2e201b(0x12d),auth,async(_0x1773b0,_0x2a4515)=>{var _0x2ba60f=a0_0x2e201b;try{const {date:_0x7705e8,from_warehouse:_0x146334,FromRoom_name:_0x112267,to_warehouse:_0x4ed817,ToRoom_name:_0x1bc09f,prod_name:_0x543166,from_prod_qty:_0x4daa7d,from_prod_level:_0x2a69ba,from_prod_isle:_0x103629,from_prod_pallet:_0x5cdcb4,to_prod_qty:_0x5d2f85,to_prod_level:_0x4b20c9,to_prod_isle:_0x17ee98,to_prod_pallet:_0xdd6c56,primary_code:_0x4e3c44,secondary_code:_0x316ee8,product_code3:_0x1ba0de,note:_0x20a239,MaxStocks_data2:_0x424a65,invoice:_0x4f094b,expiry_date:_0x42b782}=_0x1773b0[_0x2ba60f(0x11e)];if(typeof _0x543166=='string')var _0x62311c=[_0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x111)]],_0x21d1d2=[_0x1773b0['body'][_0x2ba60f(0xf9)]],_0x5f225a=[_0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0xe4)]],_0x446255=[_0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0xfa)]],_0x4e3fd1=[_0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0xd7)]],_0x5c69a7=[_0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x13e)]],_0x454ffb=[_0x1773b0['body'][_0x2ba60f(0x13f)]],_0x59ccfb=[_0x1773b0['body']['product_code3']],_0x583b0e=[_0x1773b0['body'][_0x2ba60f(0x18b)]],_0x327e61=[_0x1773b0[_0x2ba60f(0x11e)]['primary_unit']],_0x3ec551=[_0x1773b0[_0x2ba60f(0x11e)]['secondary_unit']],_0x505107=[_0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x15f)]],_0x36e4e3=[_0x1773b0['body'][_0x2ba60f(0x15d)]],_0x48e74c=[_0x1773b0['body'][_0x2ba60f(0x123)]],_0x58289f=[_0x1773b0[_0x2ba60f(0x11e)]['MaxStocks_data']],_0x286fb9=[_0x1773b0[_0x2ba60f(0x11e)]['maxPerUnit']],_0x4471a3=[_0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0xdf)]],_0x2025b5=[_0x1773b0['body']['RoomAssigned']],_0x3e0003=[_0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x10d)]],_0x17b9ce=[_0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x133)]],_0x510d8f=[_0x1773b0[_0x2ba60f(0x11e)]['to_invoice']],_0x55dffb=[_0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x14a)]];else var _0x62311c=[..._0x1773b0['body'][_0x2ba60f(0x111)]],_0x21d1d2=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0xf9)]],_0x5f225a=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0xe4)]],_0x446255=[..._0x1773b0['body'][_0x2ba60f(0xfa)]],_0x4e3fd1=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0xd7)]],_0x5c69a7=[..._0x1773b0['body'][_0x2ba60f(0x13e)]],_0x454ffb=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x13f)]],_0x59ccfb=[..._0x1773b0['body'][_0x2ba60f(0xd6)]],_0x583b0e=[..._0x1773b0[_0x2ba60f(0x11e)]['MaxStocks_data2']],_0x327e61=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x176)]],_0x3ec551=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0xcd)]],_0x505107=[..._0x1773b0[_0x2ba60f(0x11e)]['batch_code']],_0x36e4e3=[..._0x1773b0['body'][_0x2ba60f(0x15d)]],_0x48e74c=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x123)]],_0x58289f=[..._0x1773b0[_0x2ba60f(0x11e)]['MaxStocks_data']],_0x286fb9=[..._0x1773b0['body'][_0x2ba60f(0x18a)]],_0x4471a3=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0xdf)]],_0x2025b5=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x139)]],_0x3e0003=[..._0x1773b0['body'][_0x2ba60f(0x10d)]],_0x17b9ce=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x133)]],_0x510d8f=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x164)]],_0x55dffb=[..._0x1773b0[_0x2ba60f(0x11e)][_0x2ba60f(0x14a)]];const _0x3fe511=_0x62311c[_0x2ba60f(0xef)](_0x11e0f1=>{return _0x11e0f1={'product_name':_0x11e0f1};});_0x21d1d2[_0x2ba60f(0x146)]((_0x53dbe7,_0x1a591a)=>{var _0x5dbb90=_0x2ba60f;_0x3fe511[_0x1a591a][_0x5dbb90(0xf2)]=_0x53dbe7;}),_0x5f225a['forEach']((_0x517729,_0x2c8786)=>{var _0x2d2566=_0x2ba60f;_0x3fe511[_0x2c8786][_0x2d2566(0x166)]=_0x517729;}),_0x55dffb[_0x2ba60f(0x146)]((_0x2b80a7,_0x361073)=>{var _0x1bf990=_0x2ba60f;_0x3fe511[_0x361073][_0x1bf990(0x14a)]=_0x2b80a7;}),_0x17b9ce[_0x2ba60f(0x146)]((_0x554c2e,_0x2f8467)=>{var _0xed4289=_0x2ba60f;_0x3fe511[_0x2f8467][_0xed4289(0x133)]=_0x554c2e;}),_0x510d8f[_0x2ba60f(0x146)]((_0x3565ac,_0x34e9bc)=>{var _0x116e55=_0x2ba60f;_0x3fe511[_0x34e9bc][_0x116e55(0x119)]=_0x3565ac;}),_0x446255[_0x2ba60f(0x146)]((_0x4d6b7e,_0x54000d)=>{_0x3fe511[_0x54000d]['to_quantity']=_0x4d6b7e;}),_0x4e3fd1[_0x2ba60f(0x146)]((_0x3363d7,_0x3d7d01)=>{var _0x2cfc7a=_0x2ba60f;_0x3fe511[_0x3d7d01][_0x2cfc7a(0x141)]=_0x3363d7;}),_0x5c69a7['forEach']((_0x1c5921,_0x2ab751)=>{var _0x5cb747=_0x2ba60f;_0x3fe511[_0x2ab751][_0x5cb747(0x13e)]=_0x1c5921;}),_0x454ffb['forEach']((_0x315812,_0xd65b56)=>{var _0x4f6f8a=_0x2ba60f;_0x3fe511[_0xd65b56][_0x4f6f8a(0x13f)]=_0x315812;}),_0x59ccfb['forEach']((_0x20b469,_0x491f57)=>{_0x3fe511[_0x491f57]['product_code']=_0x20b469;}),_0x583b0e[_0x2ba60f(0x146)]((_0xcb0a5e,_0xebfb2f)=>{_0x3fe511[_0xebfb2f]['maxProducts']=_0xcb0a5e;}),_0x327e61['forEach']((_0x2e7146,_0x5d1746)=>{_0x3fe511[_0x5d1746]['unit']=_0x2e7146;}),_0x3ec551[_0x2ba60f(0x146)]((_0x3a6224,_0x5a4792)=>{_0x3fe511[_0x5a4792]['secondary_unit']=_0x3a6224;}),_0x505107[_0x2ba60f(0x146)]((_0x4826b2,_0xf329e6)=>{var _0x2c2b1a=_0x2ba60f;_0x3fe511[_0xf329e6][_0x2c2b1a(0x15f)]=_0x4826b2;}),_0x36e4e3[_0x2ba60f(0x146)]((_0x572a90,_0x47ccf9)=>{_0x3fe511[_0x47ccf9]['expiry_date']=_0x572a90;}),_0x48e74c[_0x2ba60f(0x146)]((_0x40a7e1,_0x3aa83b)=>{var _0x301539=_0x2ba60f;_0x3fe511[_0x3aa83b][_0x301539(0x183)]=_0x40a7e1;}),_0x58289f['forEach']((_0x4293cc,_0x4dfa33)=>{var _0x5f53e3=_0x2ba60f;_0x3fe511[_0x4dfa33][_0x5f53e3(0xb9)]=_0x4293cc;}),_0x286fb9[_0x2ba60f(0x146)]((_0x4ba3fe,_0x27ee86)=>{_0x3fe511[_0x27ee86]['maxPerUnit']=_0x4ba3fe;}),_0x4471a3['forEach']((_0x5d91a4,_0x2e06ea)=>{_0x3fe511[_0x2e06ea]['prod_cat']=_0x5d91a4;}),_0x2025b5[_0x2ba60f(0x146)]((_0x19e9b3,_0x4d49c7)=>{_0x3fe511[_0x4d49c7]['from_room_name']=_0x19e9b3;}),_0x3e0003[_0x2ba60f(0x146)]((_0x115c90,_0x396f9c)=>{var _0x438ecf=_0x2ba60f;_0x3fe511[_0x396f9c][_0x438ecf(0x173)]=_0x115c90;});const _0x125f69=_0x3fe511['filter'](_0x3baed2=>_0x3baed2[_0x2ba60f(0x177)]!=='0'&&_0x3baed2['to_quantity']!==''||_0x3baed2[_0x2ba60f(0x112)]!=='0'&&_0x3baed2[_0x2ba60f(0x112)]!=='');var _0x1a7c84=0x0;_0x125f69[_0x2ba60f(0x146)](_0x52b948=>{var _0x4c352b=_0x2ba60f;parseInt(_0x52b948[_0x4c352b(0xf2)])<parseInt(_0x52b948[_0x4c352b(0x177)])&&_0x1a7c84++;});if(_0x1a7c84!=0x0)return _0x1773b0[_0x2ba60f(0xd4)](_0x2ba60f(0x17e),_0x2ba60f(0xf8)),_0x2a4515[_0x2ba60f(0x192)]('back');const _0x43f717=new transfers_finished({'date':_0x7705e8,'from_warehouse':_0x146334,'to_warehouse':_0x4ed817,'product':_0x125f69,'note':_0x20a239,'invoice':_0x4f094b}),_0xeba19b=await _0x43f717[_0x2ba60f(0xf6)]();_0x1773b0[_0x2ba60f(0xd4)]('success',_0x2ba60f(0xd9)),_0x2a4515[_0x2ba60f(0x192)](_0x2ba60f(0x114)+_0xeba19b[_0x2ba60f(0xe9)]);}catch(_0x53d07b){console[_0x2ba60f(0xe8)](_0x53d07b),_0x2a4515[_0x2ba60f(0x143)](0xc8)[_0x2ba60f(0x187)]({'errorMessage':_0x53d07b[_0x2ba60f(0x140)]});}}),router['get'](a0_0x2e201b(0x113),auth,async(_0x28bffb,_0x2a490f)=>{var _0x4a7523=a0_0x2e201b;try{const {username:_0xe6771d,email:_0x1470d6,role:_0x153e03}=_0x28bffb[_0x4a7523(0x178)],_0x5d920a=_0x28bffb[_0x4a7523(0x178)],_0x48337c=await profile[_0x4a7523(0xf0)]({'email':_0x5d920a[_0x4a7523(0xee)]}),_0x265754=await master_shop[_0x4a7523(0xba)](),_0x50019d=await transfers_finished['findById'](_0x28bffb[_0x4a7523(0x10b)]['id']);let _0x3106a0;if(_0x5d920a[_0x4a7523(0x196)]==_0x4a7523(0x15e)){const _0x5abf9c=await staff[_0x4a7523(0xf0)]({'email':_0x5d920a[_0x4a7523(0xee)]});_0x3106a0=await warehouse[_0x4a7523(0xba)]({'status':'Enabled','name':_0x5abf9c['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x3106a0=await warehouse['find']({'status':_0x4a7523(0x193),'warehouse_category':'Finished\x20Goods'});const _0x4125a3=await warehouse['aggregate']([{'$match':{'name':_0x50019d[_0x4a7523(0x191)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x4a7523(0xc1)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4a7523(0x11f)},'product_stock':{'$first':_0x4a7523(0xd1)},'bay':{'$first':_0x4a7523(0x107)},'bin':{'$first':_0x4a7523(0x155)},'type':{'$first':_0x4a7523(0xe2)},'floorlevel':{'$first':_0x4a7523(0x13d)},'primary_code':{'$first':_0x4a7523(0xe7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4a7523(0xf4)},'storage':{'$first':_0x4a7523(0x162)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4a7523(0x165)},'room':{'$first':_0x4a7523(0xc5)},'warehoue_name':{'$first':_0x4a7523(0x136)}}}]),_0x55c586=await product['find']({});if(_0x265754[0x0][_0x4a7523(0xd2)]==_0x4a7523(0xda)){var _0x34973f=users['English'];console['log'](_0x34973f);}else{if(_0x265754[0x0][_0x4a7523(0xd2)]==_0x4a7523(0x127))var _0x34973f=users['Hindi'];else{if(_0x265754[0x0]['language']==_0x4a7523(0xdd))var _0x34973f=users[_0x4a7523(0xdd)];else{if(_0x265754[0x0][_0x4a7523(0xd2)]==_0x4a7523(0x103))var _0x34973f=users['Spanish'];else{if(_0x265754[0x0][_0x4a7523(0xd2)]=='French')var _0x34973f=users[_0x4a7523(0xcb)];else{if(_0x265754[0x0][_0x4a7523(0xd2)]==_0x4a7523(0xc0))var _0x34973f=users[_0x4a7523(0x101)];else{if(_0x265754[0x0][_0x4a7523(0xd2)]==_0x4a7523(0x18f))var _0x34973f=users[_0x4a7523(0x18f)];else{if(_0x265754[0x0][_0x4a7523(0xd2)]==_0x4a7523(0x145))var _0x34973f=users[_0x4a7523(0xea)];}}}}}}}_0x2a490f[_0x4a7523(0x100)]('edit_transfer_finished_view',{'success':_0x28bffb[_0x4a7523(0xd4)](_0x4a7523(0x16b)),'errors':_0x28bffb[_0x4a7523(0xd4)](_0x4a7523(0x17e)),'role':_0x5d920a,'profile':_0x48337c,'master_shop':_0x265754,'warehouse':_0x3106a0,'transfer':_0x50019d,'stock':_0x4125a3,'unit':_0x55c586,'language':_0x34973f});}catch(_0x3d246a){console['log'](_0x3d246a);}}),router['post'](a0_0x2e201b(0x113),auth,async(_0x1f577a,_0x28aae4)=>{var _0x3f4c10=a0_0x2e201b;try{const {invoice:_0x2c1a11,from_warehouse:_0x1cd8fb,FromRoom_name:_0x15d52a,to_warehouse:_0x1f782c,ToRoom_name:_0x5b7425}=_0x1f577a[_0x3f4c10(0x11e)],_0x3747fa=await transfers_finished['findById'](_0x1f577a[_0x3f4c10(0x10b)]['id']),_0x63798c=_0x3747fa[_0x3f4c10(0xc9)]['map'](async _0x2f9dc1=>{var _0x5aad0a=_0x3f4c10;if(_0x2f9dc1[_0x5aad0a(0x177)]>0x0){var _0x45e273=await warehouse[_0x5aad0a(0xf0)]({'name':_0x1cd8fb,'room':_0x2f9dc1['from_room_name'],'warehouse_category':_0x5aad0a(0xc4)});const _0x231d0c=_0x45e273[_0x5aad0a(0xed)][_0x5aad0a(0xef)](_0x1cdbdf=>{var _0x2719aa=_0x5aad0a;_0x1cdbdf[_0x2719aa(0x120)]==_0x2f9dc1[_0x2719aa(0x120)]&&_0x1cdbdf[_0x2719aa(0x14b)]==_0x2f9dc1['from_bay']&&_0x1cdbdf[_0x2719aa(0x15d)]==_0x2f9dc1[_0x2719aa(0x15d)]&&_0x1cdbdf[_0x2719aa(0x183)]==_0x2f9dc1[_0x2719aa(0x183)]&&_0x1cdbdf['batch_code']==_0x2f9dc1['batch_code']&&_0x1cdbdf[_0x2719aa(0xbb)]==_0x2f9dc1['from_invoice']&&(console[_0x2719aa(0xe8)](_0x2719aa(0x17c),_0x1cdbdf[_0x2719aa(0x185)]),typeof _0x2f9dc1[_0x2719aa(0x14a)]==_0x2719aa(0xde)?_0x1cdbdf[_0x2719aa(0x185)]=Math[_0x2719aa(0xc2)](0x0,Math[_0x2719aa(0x147)](_0x1cdbdf[_0x2719aa(0x185)])-Math[_0x2719aa(0x147)](_0x2f9dc1[_0x2719aa(0x177)])):_0x1cdbdf[_0x2719aa(0x185)]=Math[_0x2719aa(0xc2)](0x0,Math[_0x2719aa(0x147)](_0x1cdbdf[_0x2719aa(0x185)])-Math['abs'](_0x2f9dc1[_0x2719aa(0x177)])));});}return _0x45e273;});Promise['all'](_0x63798c)[_0x3f4c10(0x102)](async _0x3c2af2=>{var _0x16b432=_0x3f4c10;try{for(const _0x5e4d56 of _0x3c2af2){await _0x5e4d56['save']();}const _0x38340a=_0x3747fa[_0x16b432(0xc9)][_0x16b432(0xef)](async _0x575a06=>{var _0x514001=_0x16b432,_0x5cddf7=await warehouse[_0x514001(0xf0)]({'name':_0x1f782c,'room':_0x575a06[_0x514001(0x173)]});if(_0x575a06['to_quantity']>0x0){var _0x3f1b63=0x0;const _0x2778a3=_0x5cddf7[_0x514001(0xed)][_0x514001(0xef)](_0x530f59=>{var _0x47c0ab=_0x514001;_0x530f59[_0x47c0ab(0x120)]==_0x575a06['product_name']&&_0x530f59[_0x47c0ab(0x14b)]==_0x575a06[_0x47c0ab(0x141)]&&_0x530f59[_0x47c0ab(0x15d)]==_0x575a06[_0x47c0ab(0x15d)]&&_0x530f59['production_date']==_0x575a06[_0x47c0ab(0x183)]&&_0x530f59[_0x47c0ab(0x15f)]==_0x575a06['batch_code']&&_0x530f59[_0x47c0ab(0xbb)]==_0x575a06[_0x47c0ab(0x119)]&&(typeof _0x575a06[_0x47c0ab(0x14a)]==_0x47c0ab(0xde)?(console[_0x47c0ab(0xe8)](_0x47c0ab(0x163),_0x530f59[_0x47c0ab(0x185)]+_0x47c0ab(0xb8)+_0x530f59[_0x47c0ab(0xe9)]+_0x47c0ab(0x169)+Math[_0x47c0ab(0x147)](_0x530f59['product_stock'])+Math['abs'](_0x575a06['to_quantity'])),_0x530f59['product_stock']=Math[_0x47c0ab(0x147)](_0x530f59['product_stock'])+Math[_0x47c0ab(0x147)](_0x575a06['to_quantity'])):_0x530f59['product_stock']=Math[_0x47c0ab(0x147)](_0x530f59[_0x47c0ab(0x185)])+Math[_0x47c0ab(0x147)](_0x575a06[_0x47c0ab(0x177)]),_0x3f1b63++);});_0x3f1b63=='0'&&(_0x5cddf7[_0x514001(0xed)]=_0x5cddf7['product_details']['concat']({'product_name':_0x575a06['product_name'],'product_stock':_0x575a06[_0x514001(0x177)],'bay':_0x575a06['to_bay'],'product_code':_0x575a06[_0x514001(0xfb)],'primary_code':_0x575a06['primary_code'],'secondary_code':_0x575a06[_0x514001(0x13f)],'expiry_date':_0x575a06['expiry_date'],'production_date':_0x575a06[_0x514001(0x183)],'maxProducts':_0x575a06[_0x514001(0xb9)],'batch_code':_0x575a06[_0x514001(0x15f)],'secondary_unit':_0x575a06[_0x514001(0xcd)],'unit':_0x575a06['unit'],'maxProducts':_0x575a06['maxProducts'],'maxPerUnit':_0x575a06[_0x514001(0x18a)],'invoice':_0x575a06[_0x514001(0x119)]}));}return _0x5cddf7;});Promise['all'](_0x38340a)['then'](async _0x4fcd5d=>{var _0x1e49f5=_0x16b432;try{for(const _0x301c86 of _0x4fcd5d){await warehouse['updateOne']({'_id':_0x301c86[_0x1e49f5(0xe9)]},{'$addToSet':{'product_details':{'$each':_0x301c86['product_details']}}});}_0x3747fa[_0x1e49f5(0x151)]=_0x1e49f5(0x134);const _0x59dd68=await _0x3747fa[_0x1e49f5(0xf6)](),_0x55eaa8=await master_shop['find'](),_0x180a06=await email_settings[_0x1e49f5(0xf0)](),_0x308c8b=await supervisor_settings['find']();var _0x1f4ecd=_0x3747fa[_0x1e49f5(0xc9)],_0x22788e='',_0x913126;for(_0x913126 in _0x1f4ecd){var _0x591795='FG';_0x3747fa[_0x1e49f5(0x195)]==_0x1e49f5(0x115)&&(_0x591795='DG'),_0x22788e+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1f4ecd[_0x913126]['product_name']+_0x1e49f5(0x18e)+_0x1e49f5(0x11d)+_0x1f4ecd[_0x913126][_0x1e49f5(0xfb)]+_0x1e49f5(0x18e)+_0x1e49f5(0x11d)+_0x1f4ecd[_0x913126]['to_quantity']+_0x1e49f5(0x18e)+_0x1e49f5(0x11d)+_0x1f4ecd[_0x913126][_0x1e49f5(0x10e)]+_0x1e49f5(0x18e)+_0x1e49f5(0x11d)+_0x1f4ecd[_0x913126][_0x1e49f5(0xcd)]+_0x1e49f5(0x18e)+_0x1e49f5(0x11d)+_0x3747fa['to_warehouse']+_0x1e49f5(0x18e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1f4ecd[_0x913126][_0x1e49f5(0x173)]+_0x1e49f5(0x18e)+_0x1e49f5(0x11d)+_0x591795+_0x1f4ecd[_0x913126][_0x1e49f5(0x141)]+_0x1e49f5(0x18e)+_0x1e49f5(0x124);}let _0x445d90=nodemailer['createTransport']({'host':_0x180a06[_0x1e49f5(0x18c)],'port':Number(_0x180a06[_0x1e49f5(0x14c)]),'secure':![],'auth':{'user':_0x180a06[_0x1e49f5(0xee)],'pass':_0x180a06[_0x1e49f5(0x167)]}}),_0x56d52a={'from':_0x180a06[_0x1e49f5(0xee)],'to':_0x308c8b[0x0][_0x1e49f5(0x128)],'subject':_0x1e49f5(0x14d),'attachments':[{'filename':_0x1e49f5(0xe1),'path':__dirname+'/../public'+_0x1e49f5(0xbf)+_0x55eaa8[0x0][_0x1e49f5(0x160)],'cid':_0x1e49f5(0x170)}],'html':_0x1e49f5(0x152)+_0x1e49f5(0xd8)+_0x1e49f5(0x13b)+_0x1e49f5(0x171)+_0x1e49f5(0x110)+_0x1e49f5(0x171)+_0x1e49f5(0x188)+'</div>'+'<div>'+_0x1e49f5(0x131)+_0x55eaa8[0x0][_0x1e49f5(0xbc)]+'\x20</h2>'+_0x1e49f5(0x190)+_0x1e49f5(0x190)+_0x1e49f5(0x117)+_0x1e49f5(0x171)+_0x1e49f5(0x16d)+_0x1e49f5(0x13a)+_0x3747fa[_0x1e49f5(0xbb)]+'\x20'+_0x1e49f5(0x125)+_0x1e49f5(0x126)+_0x3747fa[_0x1e49f5(0x156)]+'\x20'+'</span>'+_0x1e49f5(0x108)+'</div>'+_0x1e49f5(0x182)+_0x1e49f5(0x159)+_0x1e49f5(0x149)+_0x1e49f5(0x174)+_0x1e49f5(0x153)+_0x1e49f5(0xf5)+_0x1e49f5(0x17d)+_0x1e49f5(0x116)+_0x1e49f5(0xc3)+_0x1e49f5(0xfc)+_0x1e49f5(0x137)+_0x1e49f5(0x124)+_0x1e49f5(0x138)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x22788e+'\x20'+'</tbody>'+_0x1e49f5(0x14e)+_0x1e49f5(0x171)+'<strong>\x20Regards\x20</strong>'+_0x1e49f5(0x168)+_0x55eaa8[0x0][_0x1e49f5(0xbc)]+_0x1e49f5(0x108)+_0x1e49f5(0x190)+'</div>'+_0x1e49f5(0x15a)};_0x445d90[_0x1e49f5(0x12e)](_0x56d52a,function(_0x4465d2,_0x189a8f){var _0x55c9a6=_0x1e49f5;_0x4465d2?(console[_0x55c9a6(0xe8)](_0x4465d2),console[_0x55c9a6(0xe8)](_0x55c9a6(0xe0))):console['log'](_0x55c9a6(0xec));}),_0x1f577a[_0x1e49f5(0xd4)](_0x1e49f5(0x16b),_0x1e49f5(0xe5)),_0x28aae4['redirect'](_0x1e49f5(0xbd)+_0x59dd68[_0x1e49f5(0xe9)]);}catch(_0x5ab53f){console[_0x1e49f5(0x106)](_0x5ab53f),_0x28aae4[_0x1e49f5(0x143)](0x1f4)['json']({'error':_0x1e49f5(0xeb)});}})[_0x16b432(0x12f)](_0x4e37c6=>{var _0x24dd8e=_0x16b432;console[_0x24dd8e(0x106)](_0x4e37c6),_0x28aae4['status'](0x1f4)[_0x24dd8e(0x187)]({'error':_0x24dd8e(0x130)});});}catch(_0x57ad7c){console['error'](_0x57ad7c),_0x28aae4[_0x16b432(0x143)](0x1f4)[_0x16b432(0x187)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x3f4c10(0x12f)](_0x16b7bb=>{var _0x8ea621=_0x3f4c10;console[_0x8ea621(0x106)](_0x16b7bb),_0x28aae4[_0x8ea621(0x143)](0x1f4)['json']({'error':_0x8ea621(0x130)});});}catch(_0x5b7f24){_0x28aae4['json']({'message':_0x5b7f24[_0x3f4c10(0x140)]});}});function BayBinSelected(_0x26e5b5,_0xa51242){var _0x24ffbb=a0_0x2e201b,_0x3dcc31=[];let _0x49e55c=[];var _0x37a394=[];if(_0x26e5b5==_0x24ffbb(0x115)){switch(_0xa51242){case _0x24ffbb(0x12a):_0x3dcc31=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x3dcc31=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x37a394=['DG'];}else{if(_0x26e5b5==_0x24ffbb(0xfd)){switch(_0xa51242){case'Rack\x201':_0x3dcc31=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x24ffbb(0xca):_0x3dcc31=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x37a394=['FG'];}}return{'levels':_0x3dcc31,'identify':_0x37a394};}router['get'](a0_0x2e201b(0x12c),auth,async(_0x16740a,_0x568b46)=>{var _0x114827=a0_0x2e201b;try{const {username:_0x56087f,email:_0x1e272f,role:_0x280f6b}=_0x16740a['user'],_0x376892=_0x16740a['user'],_0x126432=await profile[_0x114827(0xf0)]({'email':_0x376892[_0x114827(0xee)]}),_0x4d4763=await master_shop[_0x114827(0xba)](),_0x554725=await transfers_finished[_0x114827(0x129)](_0x16740a[_0x114827(0x10b)]['id']);let _0x52a5a2=new Date(_0x554725['expiry_date']),_0x1e24ec=('0'+_0x52a5a2[_0x114827(0x17b)]())[_0x114827(0x118)](-0x2),_0x4a7493=('0'+(_0x52a5a2[_0x114827(0x132)]()+0x1))[_0x114827(0x118)](-0x2),_0x324f95=_0x52a5a2['getFullYear'](),_0x5aaf64=_0x324f95+'-'+_0x4a7493+'-'+_0x1e24ec,_0x24a6c9;if(_0x376892[_0x114827(0x196)]==_0x114827(0x15e)){const _0x5f21ac=await staff[_0x114827(0xf0)]({'email':_0x376892[_0x114827(0xee)]});_0x24a6c9=await warehouse[_0x114827(0xba)]({'status':'Enabled','name':_0x5f21ac['warehouse'],'warehouse_category':_0x114827(0xc4)});}else _0x24a6c9=await warehouse['find']({'status':'Enabled','warehouse_category':'Finished\x20Goods'});const _0x45d210=await warehouse[_0x114827(0x161)]([{'$match':{'name':_0x554725['from_warehouse'],'room':_0x554725[_0x114827(0x172)]}},{'$unwind':_0x114827(0xc1)},{'$group':{'_id':_0x114827(0x10c),'name':{'$first':_0x114827(0x11f)},'product_stock':{'$first':_0x114827(0xd1)},'bay':{'$first':_0x114827(0x107)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x114827(0xe2)},'floorlevel':{'$first':_0x114827(0x13d)},'primary_code':{'$first':_0x114827(0xe7)},'secondary_code':{'$first':_0x114827(0x194)},'product_code':{'$first':_0x114827(0xf4)},'storage':{'$first':_0x114827(0x162)},'rack':{'$first':'$product_details.rack'}}}]);var _0x4c5cef=[0x1,0x2,0x3,0x4],_0x4d95ba=['A','B','C','D','E','F','G','H','I','J'],_0x5d6fcc=[_0x114827(0xb6),_0x114827(0x142)];const _0x272132=await product['find']({}),_0x262242=BayBinSelected(_0x554725['to_warehouse'],_0x554725['to_room']);if(_0x4d4763[0x0][_0x114827(0xd2)]==_0x114827(0xda)){var _0x6053df=users[_0x114827(0x16a)];console['log'](_0x6053df);}else{if(_0x4d4763[0x0]['language']=='Hindi')var _0x6053df=users[_0x114827(0x127)];else{if(_0x4d4763[0x0][_0x114827(0xd2)]==_0x114827(0xdd))var _0x6053df=users[_0x114827(0xdd)];else{if(_0x4d4763[0x0][_0x114827(0xd2)]==_0x114827(0x103))var _0x6053df=users[_0x114827(0x103)];else{if(_0x4d4763[0x0][_0x114827(0xd2)]==_0x114827(0xcb))var _0x6053df=users[_0x114827(0xcb)];else{if(_0x4d4763[0x0][_0x114827(0xd2)]==_0x114827(0xc0))var _0x6053df=users['Portuguese'];else{if(_0x4d4763[0x0][_0x114827(0xd2)]==_0x114827(0x18f))var _0x6053df=users['Chinese'];else{if(_0x4d4763[0x0][_0x114827(0xd2)]==_0x114827(0x145))var _0x6053df=users[_0x114827(0xea)];}}}}}}}_0x568b46[_0x114827(0x100)]('edit_transfer_finished',{'success':_0x16740a['flash']('success'),'errors':_0x16740a[_0x114827(0xd4)](_0x114827(0x17e)),'role':_0x376892,'profile':_0x126432,'master_shop':_0x4d4763,'warehouse':_0x24a6c9,'transfer':_0x554725,'stock':_0x45d210,'unit':_0x272132,'language':_0x6053df,'levels':_0x4c5cef,'Isle':_0x4d95ba,'rooms_data':_0x5d6fcc,'ed_fullDate':_0x5aaf64,'dataSelected':_0x262242});}catch(_0x2489d6){console[_0x114827(0xe8)](_0x2489d6);}}),router[a0_0x2e201b(0x16f)](a0_0x2e201b(0x12c),auth,async(_0x2b9048,_0x4922fb)=>{var _0x44725a=a0_0x2e201b;try{const _0x12de67=_0x2b9048[_0x44725a(0x10b)]['id'];console['log'](_0x2b9048[_0x44725a(0x11e)]);const _0xb0bbd3=await transfers_finished[_0x44725a(0x129)](_0x12de67);console[_0x44725a(0xe8)](_0x44725a(0x158),_0xb0bbd3);const {date:_0x4c84b2,from_warehouse:_0x17131c,FromRoom_name:_0x265b09,to_warehouse:_0x1faef4,ToRoom_name:_0x55a952,prod_name:_0x1c5450,from_prod_qty:_0x27e798,from_prod_level:_0x575768,from_prod_isle:_0x181f76,from_prod_pallet:_0x25c8bd,to_prod_qty:_0x43d23e,to_prod_level:_0x5750ff,to_prod_isle:_0x254c29,to_prod_pallet:_0x2eb785,primary_code:_0x2a2045,secondary_code:_0x3bf3c4,product_code3:_0x525bfa,note:_0x4e8cd9,invoice:_0x42eb70,expiry_date:_0x35df10}=_0x2b9048[_0x44725a(0x11e)];if(typeof _0x1c5450==_0x44725a(0xcc))var _0x539737=[_0x2b9048['body'][_0x44725a(0x111)]],_0x102111=[_0x2b9048['body'][_0x44725a(0xf9)]],_0x6ce9dd=[_0x2b9048[_0x44725a(0x11e)]['from_prod_level']],_0xe6bf15=[_0x2b9048[_0x44725a(0x11e)][_0x44725a(0xcf)]],_0x22d629=[_0x2b9048[_0x44725a(0x11e)][_0x44725a(0xd7)]],_0x54ee64=[_0x2b9048[_0x44725a(0x11e)][_0x44725a(0x13e)]],_0x5a7924=[_0x2b9048[_0x44725a(0x11e)][_0x44725a(0x13f)]],_0x2bd2af=[_0x2b9048[_0x44725a(0x11e)][_0x44725a(0xd6)]],_0x5e0696=[_0x2b9048[_0x44725a(0x11e)][_0x44725a(0x18b)]],_0x56bb3b=[_0x2b9048[_0x44725a(0x11e)]['unit']],_0x14ce1c=[_0x2b9048[_0x44725a(0x11e)][_0x44725a(0xcd)]],_0x457b3d=[_0x2b9048['body'][_0x44725a(0x15f)]],_0x77992e=[_0x2b9048['body'][_0x44725a(0x15d)]];else var _0x539737=[..._0x2b9048[_0x44725a(0x11e)][_0x44725a(0x111)]],_0x102111=[..._0x2b9048[_0x44725a(0x11e)][_0x44725a(0xf9)]],_0x6ce9dd=[..._0x2b9048[_0x44725a(0x11e)][_0x44725a(0xe4)]],_0xe6bf15=[..._0x2b9048[_0x44725a(0x11e)][_0x44725a(0xcf)]],_0x22d629=[..._0x2b9048[_0x44725a(0x11e)][_0x44725a(0xd7)]],_0x54ee64=[..._0x2b9048[_0x44725a(0x11e)][_0x44725a(0x13e)]],_0x5a7924=[..._0x2b9048[_0x44725a(0x11e)][_0x44725a(0x13f)]],_0x2bd2af=[..._0x2b9048['body'][_0x44725a(0xd6)]],_0x5e0696=[..._0x2b9048[_0x44725a(0x11e)][_0x44725a(0x18b)]],_0x56bb3b=[..._0x2b9048[_0x44725a(0x11e)][_0x44725a(0x10e)]],_0x14ce1c=[..._0x2b9048['body']['secondary_unit']],_0x457b3d=[..._0x2b9048[_0x44725a(0x11e)][_0x44725a(0x15f)]],_0x77992e=[..._0x2b9048[_0x44725a(0x11e)]['expiry_date']];const _0xc7166a=_0x539737[_0x44725a(0xef)](_0x90faa=>{return _0x90faa={'product_name':_0x90faa};});_0x102111[_0x44725a(0x146)]((_0x5e7846,_0x5830e8)=>{var _0x1763be=_0x44725a;_0xc7166a[_0x5830e8][_0x1763be(0xf2)]=_0x5e7846;}),_0x6ce9dd[_0x44725a(0x146)]((_0x547efd,_0x4a28c4)=>{var _0x41b2cf=_0x44725a;_0xc7166a[_0x4a28c4][_0x41b2cf(0x166)]=_0x547efd;}),_0xe6bf15[_0x44725a(0x146)]((_0x4b6c79,_0x577d8d)=>{var _0x1cf20c=_0x44725a;_0xc7166a[_0x577d8d][_0x1cf20c(0x177)]=_0x4b6c79;}),_0x22d629[_0x44725a(0x146)]((_0x5944a8,_0x2131e8)=>{var _0x295eb6=_0x44725a;_0xc7166a[_0x2131e8][_0x295eb6(0x141)]=_0x5944a8;}),_0x54ee64['forEach']((_0x4bc2e2,_0x13304d)=>{var _0x2c6e2d=_0x44725a;_0xc7166a[_0x13304d][_0x2c6e2d(0x13e)]=_0x4bc2e2;}),_0x5a7924[_0x44725a(0x146)]((_0x207f60,_0x3b5d9d)=>{var _0xb045a0=_0x44725a;_0xc7166a[_0x3b5d9d][_0xb045a0(0x13f)]=_0x207f60;}),_0x2bd2af[_0x44725a(0x146)]((_0x247de1,_0x4e685a)=>{var _0x9d57af=_0x44725a;_0xc7166a[_0x4e685a][_0x9d57af(0xfb)]=_0x247de1;}),_0x5e0696['forEach']((_0x2a7a80,_0x36b7eb)=>{_0xc7166a[_0x36b7eb]['maxProducts']=_0x2a7a80;}),_0x56bb3b[_0x44725a(0x146)]((_0x153f0a,_0x1afc13)=>{var _0x55ddf3=_0x44725a;_0xc7166a[_0x1afc13][_0x55ddf3(0x10e)]=_0x153f0a;}),_0x14ce1c[_0x44725a(0x146)]((_0x3b8598,_0x2a7abf)=>{var _0x1305ec=_0x44725a;_0xc7166a[_0x2a7abf][_0x1305ec(0xcd)]=_0x3b8598;}),_0x457b3d[_0x44725a(0x146)]((_0x469ecb,_0x4c4efe)=>{var _0x5e4c6c=_0x44725a;_0xc7166a[_0x4c4efe][_0x5e4c6c(0x15f)]=_0x469ecb;}),_0x77992e[_0x44725a(0x146)]((_0x35cf8f,_0x48e23e)=>{_0xc7166a[_0x48e23e]['expiry_date']=_0x35cf8f;});const _0xf3ca55=_0xc7166a[_0x44725a(0x15c)](_0x24de18=>_0x24de18[_0x44725a(0x177)]!=='0'&&_0x24de18[_0x44725a(0x177)]!==''||_0x24de18[_0x44725a(0x112)]!=='0'&&_0x24de18[_0x44725a(0x112)]!=='');var _0xf85800=0x0;_0xf3ca55['forEach'](_0x55c0d8=>{var _0x1638ca=_0x44725a;parseInt(_0x55c0d8['from_quantity'])<parseInt(_0x55c0d8[_0x1638ca(0x177)])&&_0xf85800++;});if(_0xf85800!=0x0)return _0x2b9048['flash']('errors',_0x44725a(0xf8)),_0x4922fb[_0x44725a(0x192)](_0x44725a(0x186));const _0x5c1c80=await warehouse[_0x44725a(0xf0)]({'name':_0xb0bbd3['from_warehouse'],'room':_0xb0bbd3[_0x44725a(0x172)]});_0xb0bbd3[_0x44725a(0xc9)]['forEach'](_0x516ea9=>{var _0x402c62=_0x44725a;if(_0x516ea9['to_quantity']>0x0){const _0x1cb738=_0x5c1c80[_0x402c62(0xed)][_0x402c62(0xef)](_0x3a9fb7=>{var _0x5f086a=_0x402c62;_0x3a9fb7[_0x5f086a(0x120)]==_0x516ea9[_0x5f086a(0x120)]&&_0x3a9fb7[_0x5f086a(0x14b)]==_0x516ea9['from_bay']&&(_0x3a9fb7[_0x5f086a(0x185)]=parseInt(_0x3a9fb7[_0x5f086a(0x185)])+parseInt(_0x516ea9['to_quantity']));});}}),await _0x5c1c80['save']();const _0x277036=await warehouse[_0x44725a(0xf0)]({'name':_0xb0bbd3[_0x44725a(0x195)],'room':_0xb0bbd3[_0x44725a(0xd5)]});_0xb0bbd3[_0x44725a(0xc9)][_0x44725a(0x146)](_0x5ac58a=>{var _0x593de9=_0x44725a;if(_0x5ac58a[_0x593de9(0x177)]>0x0){const _0x38e861=_0x277036[_0x593de9(0xed)][_0x593de9(0xef)](_0x4135a1=>{var _0x107f21=_0x593de9;_0x4135a1[_0x107f21(0x120)]==_0x5ac58a[_0x107f21(0x120)]&&_0x4135a1['bay']==_0x5ac58a[_0x107f21(0x141)]&&(_0x4135a1[_0x107f21(0x185)]=parseInt(_0x4135a1[_0x107f21(0x185)])-parseInt(_0x5ac58a[_0x107f21(0x177)]));});}}),await _0x277036[_0x44725a(0xf6)](),_0xb0bbd3['date']=_0x4c84b2,_0xb0bbd3[_0x44725a(0x191)]=_0x17131c,_0xb0bbd3[_0x44725a(0x195)]=_0x1faef4,_0xb0bbd3['product']=_0xf3ca55,_0xb0bbd3[_0x44725a(0x16c)]=_0x4e8cd9,_0xb0bbd3[_0x44725a(0xbb)]=_0x42eb70;const _0x15bc28=await _0xb0bbd3[_0x44725a(0xf6)](),_0x4cc256=await warehouse[_0x44725a(0xf0)]({'name':_0x17131c,'room':_0x265b09});_0x15bc28['product'][_0x44725a(0x146)](_0x578aa8=>{var _0x20de99=_0x44725a;if(_0x578aa8[_0x20de99(0x177)]>0x0){const _0x4e70df=_0x4cc256['product_details'][_0x20de99(0xef)](_0x28e44a=>{var _0x358723=_0x20de99;_0x28e44a[_0x358723(0x120)]==_0x578aa8[_0x358723(0x120)]&&_0x28e44a['bay']==_0x578aa8['from_bay']&&(_0x28e44a[_0x358723(0x185)]=parseInt(_0x28e44a[_0x358723(0x185)])-parseInt(_0x578aa8[_0x358723(0x177)]));});}}),await _0x4cc256[_0x44725a(0xf6)]();const _0x1babe5=await warehouse[_0x44725a(0xf0)]({'name':_0x1faef4,'room':_0x55a952});_0x15bc28[_0x44725a(0xc9)][_0x44725a(0x146)](_0x4b7609=>{var _0x3890c8=_0x44725a;if(_0x4b7609['to_quantity']>0x0){var _0x276ed2=0x0;const _0x422d86=_0x1babe5[_0x3890c8(0xed)][_0x3890c8(0xef)](_0x2cb889=>{var _0x2250ed=_0x3890c8;_0x2cb889['product_name']==_0x4b7609[_0x2250ed(0x120)]&&_0x2cb889[_0x2250ed(0x14b)]==_0x4b7609['to_bay']&&(_0x2cb889[_0x2250ed(0x185)]=parseInt(_0x2cb889['product_stock'])+parseInt(_0x4b7609[_0x2250ed(0x177)]),_0x276ed2++);});_0x276ed2=='0'&&(_0x1babe5[_0x3890c8(0xed)]=_0x1babe5[_0x3890c8(0xed)][_0x3890c8(0xce)]({'product_name':_0x4b7609[_0x3890c8(0x120)],'product_stock':_0x4b7609[_0x3890c8(0x177)],'bay':_0x4b7609[_0x3890c8(0x141)],'product_code':_0x4b7609[_0x3890c8(0xfb)],'primary_code':_0x4b7609[_0x3890c8(0x13e)],'secondary_code':_0x4b7609[_0x3890c8(0x13f)],'maxProducts':_0x4b7609[_0x3890c8(0xb9)]}));}}),await _0x1babe5[_0x44725a(0xf6)](),_0x2b9048[_0x44725a(0xd4)](_0x44725a(0x16b),'Transfer\x20Edit\x20Successfully'),_0x4922fb[_0x44725a(0x192)](_0x44725a(0x179));}catch(_0xfb531e){console[_0x44725a(0xe8)](_0xfb531e);}}),router[a0_0x2e201b(0x16f)](a0_0x2e201b(0x150),async(_0x165cc8,_0x302491)=>{var _0x14c205=a0_0x2e201b;const {FromWareHouse:_0x4958d6,FromRoom:_0x6a83fc,ToWarehouse:_0x5e48f7,ToRoom:_0x57642f,primary_code:_0x18ac6f,Roomslist:_0x2b39fb}=_0x165cc8['body'],_0x46ae1d=_0x2b39fb['split'](','),_0x459ca8=[];async function _0x943e75(_0x3dcca4){var _0x429337=a0_0x32c4;const _0xa700eb=await warehouse[_0x429337(0x161)]([{'$match':{'name':_0x4958d6,'room':_0x3dcca4}},{'$unwind':_0x429337(0xc1)},{'$match':{'product_details.primary_code':_0x18ac6f}},{'$group':{'_id':_0x429337(0x10c),'name':{'$first':_0x429337(0x11f)},'instock':{'$first':_0x429337(0xd1)},'primary_code':{'$first':_0x429337(0xe7)},'secondary_code':{'$first':_0x429337(0x194)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x429337(0x155)},'type':{'$first':_0x429337(0xe2)},'pallet':{'$first':_0x429337(0x13d)},'unit':{'$first':_0x429337(0x189)},'secondary_unit':{'$first':_0x429337(0x11a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x429337(0x17a)},'production_date':{'$first':_0x429337(0x165)},'batch_code':{'$first':_0x429337(0xf3)},'maxPerUnit':{'$first':_0x429337(0x180)},'roomNamed':{'$first':_0x429337(0xc5)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x429337(0x197)}}}]),_0x31a414=await warehouse[_0x429337(0x161)]([{'$match':{'name':_0x4958d6,'room':_0x3dcca4}},{'$unwind':_0x429337(0xc1)},{'$match':{'product_details.secondary_code':_0x18ac6f}},{'$group':{'_id':_0x429337(0x10c),'name':{'$first':_0x429337(0x11f)},'instock':{'$first':_0x429337(0xd1)},'primary_code':{'$first':_0x429337(0xe7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x429337(0xf4)},'level':{'$first':_0x429337(0x107)},'isle':{'$first':_0x429337(0x155)},'type':{'$first':_0x429337(0xe2)},'pallet':{'$first':_0x429337(0x13d)},'unit':{'$first':_0x429337(0x189)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x429337(0xdb)},'expiry_date':{'$first':_0x429337(0x17a)},'production_date':{'$first':_0x429337(0x165)},'batch_code':{'$first':_0x429337(0xf3)},'maxPerUnit':{'$first':_0x429337(0x180)},'roomNamed':{'$first':_0x429337(0xc5)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x429337(0x197)}}}]);if(_0xa700eb[_0x429337(0xe6)]>0x0)_0x459ca8[_0x429337(0x157)](_0xa700eb);else _0x31a414[_0x429337(0xe6)]>0x0&&_0x459ca8[_0x429337(0x157)](_0x31a414);}const _0x1138ad=_0x46ae1d[_0x14c205(0xef)](_0x53b85b=>_0x943e75(_0x53b85b));await Promise['all'](_0x1138ad),_0x302491['json'](_0x459ca8);}),router['post'](a0_0x2e201b(0x10f),async(_0x55a9bb,_0x5cc888)=>{var _0x401f41=a0_0x2e201b;try{const {FromWareHouse:_0x45cea9,FromRoom:_0x8cec72,ToWarehouse:_0x213180,ToRoom:_0x246324,secondary_code:_0x424404}=_0x55a9bb[_0x401f41(0x11e)],_0x4fe08e=await warehouse['aggregate']([{'$match':{'name':_0x45cea9}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x424404}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x401f41(0x11f)},'primary_code':{'$first':_0x401f41(0xe7)},'secondary_code':{'$first':_0x401f41(0x194)},'product_code':{'$first':_0x401f41(0xf4)},'instock':{'$first':_0x401f41(0xd1)},'warehouse':{'$first':_0x401f41(0x136)},'level':{'$first':_0x401f41(0x10a)},'isle':{'$first':_0x401f41(0xdc)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x401f41(0x105)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x401f41(0x165)}}}]);_0x5cc888[_0x401f41(0x143)](0xc8)[_0x401f41(0x187)](_0x4fe08e);}catch(_0x156c1d){_0x5cc888['status'](0x194)[_0x401f41(0x187)]({'message':_0x156c1d[_0x401f41(0x140)]});}}),router[a0_0x2e201b(0x16f)](a0_0x2e201b(0x104),async(_0x5eabfe,_0x11f77c)=>{var _0x557aea=a0_0x2e201b;try{const {FromWareHouse:_0x631117,FromRoom:_0x587d58,ToWarehouse:_0x439ffa,ToRoom:_0x114e05,product_code:_0x395a21}=_0x5eabfe[_0x557aea(0x11e)],_0x46aff3=await warehouse[_0x557aea(0x161)]([{'$match':{'name':_0x631117}},{'$unwind':_0x557aea(0xc1)},{'$match':{'product_details.product_code':_0x395a21}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x557aea(0x11f)},'primary_code':{'$first':_0x557aea(0xe7)},'secondary_code':{'$first':_0x557aea(0x194)},'product_code':{'$first':_0x557aea(0xf4)},'instock':{'$first':_0x557aea(0xd1)},'warehouse':{'$first':_0x557aea(0x136)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x557aea(0xdc)},'pallet':{'$first':_0x557aea(0xbe)},'maxProducts':{'$first':_0x557aea(0x105)},'unit':{'$first':_0x557aea(0x189)}}}]);_0x11f77c[_0x557aea(0x143)](0xc8)[_0x557aea(0x187)](_0x46aff3);}catch(_0x40f55a){_0x11f77c[_0x557aea(0x143)](0x194)[_0x557aea(0x187)]({'message':_0x40f55a[_0x557aea(0x140)]});}}),router[a0_0x2e201b(0x16f)]('/CheckingWarehouse',async(_0xf9fcca,_0x14c94c)=>{var _0x4d811b=a0_0x2e201b;const {productCode:_0x21289a,bay:_0x1146a9,warehouses:_0x2420b5,room:_0x1c4a90}=_0xf9fcca['body'];console[_0x4d811b(0xe8)](_0xf9fcca[_0x4d811b(0x11e)]);try{const _0x14b2dd=await warehouse[_0x4d811b(0x161)]([{'$match':{'name':_0x2420b5,'room':_0x1c4a90}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x1146a9)}},{'$group':{'_id':_0x4d811b(0x10c),'name':{'$first':_0x4d811b(0x11f)},'product_stock':{'$first':_0x4d811b(0xd1)},'bay':{'$first':_0x4d811b(0x107)},'maxProducts':{'$first':_0x4d811b(0x105)}}}]);_0x14c94c[_0x4d811b(0x143)](0xc8)['json'](_0x14b2dd);}catch(_0x12928c){_0x14c94c['status'](0x194)[_0x4d811b(0x187)]({'message':_0x12928c[_0x4d811b(0x140)]});}}),module['exports']=router;