var a0_0x329a7a=a0_0x12f3;function a0_0x1267(){var _0x3af535=['Portuguese','Enabled','$customer_docs','c_payment','German','old_warehouse_data','success','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','invoice','$product_details.bay','forEach','ToRoom','1012684okvAfe','Router','primary_code_QA','Portuguese\x20(BR)','stocks_QA','$product_details.floorlevel','product_name','suppliers','688AdnaRL','6435576agxrxk','bin','warehouse_name','flash','findOne','redirect','/view/:id','product_details','return_qty_QA','stock','40686voZOzk','sales_quantity','errors','language','new\x20new_data','product_stock','save','product_name_QA','get','slice','1qmOevC','Arabic\x20(ae)','$product_details.product_stock','customer_docs','exports','$product_details._id','getFullYear','message','type','primary_code','QA\x20Warehouse','map','$product_details.product_code','../middleware/auth','Spanish','922344PmSEyY','39519NFacyd','log','22YfNRLr','secondary_code','$product_details.product_name','foreach\x20newproduct','name','customer','secondary_code_QA','render','sales_quantity_QA','return_sale_QA','English\x20(US)','aggregate','/invoice/:id','return_sale_edit_finished','$product_details.primary_code','body','English','data','ToWarehouse','return_qty','user','date','Finished\x20Goods','Return\x20Rooms','$product_details.type','master','bay','string','due_amount','floorlevel','88340HDzXPJ','$name','Hindi','Chinese','find','return_sale','note','subtract','purchase\x20return\x20successfully','status','$product_details','product_code','json','5aGepoX','express','types','$product_details.bin','params','Arabic','238owjBQb','/sales_return_finished/view','sale_qty','payment\x20successfull','297530fsDflX','email','post','findById','stocks','French','/sales_return/view','paid_amount'];a0_0x1267=function(){return _0x3af535;};return a0_0x1267();}function a0_0x12f3(_0x3cc7e1,_0xfe08e6){var _0x126762=a0_0x1267();return a0_0x12f3=function(_0x12f362,_0x37dec4){_0x12f362=_0x12f362-0x1f2;var _0xe47920=_0x126762[_0x12f362];return _0xe47920;},a0_0x12f3(_0x3cc7e1,_0xfe08e6);}(function(_0x5b95f9,_0x28095c){var _0x36de5f=a0_0x12f3,_0xabd813=_0x5b95f9();while(!![]){try{var _0x356b0a=parseInt(_0x36de5f(0x200))/0x1*(-parseInt(_0x36de5f(0x230))/0x2)+-parseInt(_0x36de5f(0x20f))/0x3+parseInt(_0x36de5f(0x25b))/0x4*(parseInt(_0x36de5f(0x23d))/0x5)+parseInt(_0x36de5f(0x1f6))/0x6*(parseInt(_0x36de5f(0x243))/0x7)+-parseInt(_0x36de5f(0x263))/0x8*(parseInt(_0x36de5f(0x210))/0x9)+parseInt(_0x36de5f(0x247))/0xa*(-parseInt(_0x36de5f(0x212))/0xb)+parseInt(_0x36de5f(0x264))/0xc;if(_0x356b0a===_0x28095c)break;else _0xabd813['push'](_0xabd813['shift']());}catch(_0x533694){_0xabd813['push'](_0xabd813['shift']());}}}(a0_0x1267,0x38769));const express=require(a0_0x329a7a(0x23e)),app=express(),router=express[a0_0x329a7a(0x25c)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require(a0_0x329a7a(0x20d)),users=require('../public/language/languages.json');router[a0_0x329a7a(0x1fe)]('/view',auth,async(_0x318aae,_0x133382)=>{var _0x4c45f2=a0_0x329a7a;try{const {username:_0x4c32c4,email:_0x226a45,role:_0x14d67e}=_0x318aae[_0x4c45f2(0x226)],_0xb67aab=_0x318aae[_0x4c45f2(0x226)],_0x36dcc6=await profile[_0x4c45f2(0x268)]({'email':_0xb67aab[_0x4c45f2(0x248)]}),_0x12de64=await master_shop['find'](),_0x3803cb=await sales_return_finished[_0x4c45f2(0x21d)]([{'$lookup':{'from':'customers','localField':'customer','foreignField':_0x4c45f2(0x216),'as':_0x4c45f2(0x203)}},{'$unwind':_0x4c45f2(0x251)}]);if(_0x12de64[0x0][_0x4c45f2(0x1f9)]==_0x4c45f2(0x21c)){var _0x5a46f4=users[_0x4c45f2(0x222)];console[_0x4c45f2(0x211)](_0x5a46f4);}else{if(_0x12de64[0x0][_0x4c45f2(0x1f9)]==_0x4c45f2(0x232))var _0x5a46f4=users[_0x4c45f2(0x232)];else{if(_0x12de64[0x0][_0x4c45f2(0x1f9)]==_0x4c45f2(0x253))var _0x5a46f4=users[_0x4c45f2(0x253)];else{if(_0x12de64[0x0][_0x4c45f2(0x1f9)]==_0x4c45f2(0x20e))var _0x5a46f4=users[_0x4c45f2(0x20e)];else{if(_0x12de64[0x0][_0x4c45f2(0x1f9)]==_0x4c45f2(0x24c))var _0x5a46f4=users[_0x4c45f2(0x24c)];else{if(_0x12de64[0x0][_0x4c45f2(0x1f9)]==_0x4c45f2(0x25e))var _0x5a46f4=users[_0x4c45f2(0x24f)];else{if(_0x12de64[0x0][_0x4c45f2(0x1f9)]=='Chinese')var _0x5a46f4=users[_0x4c45f2(0x233)];else{if(_0x12de64[0x0]['language']==_0x4c45f2(0x201))var _0x5a46f4=users[_0x4c45f2(0x242)];}}}}}}}_0x133382['render']('sales_return_finished',{'success':_0x318aae[_0x4c45f2(0x267)]('success'),'errors':_0x318aae[_0x4c45f2(0x267)](_0x4c45f2(0x1f8)),'role':_0xb67aab,'profile':_0x36dcc6,'master_shop':_0x12de64,'user':_0x3803cb,'language':_0x5a46f4});}catch(_0x17c7a4){console[_0x4c45f2(0x211)](_0x17c7a4);}}),router[a0_0x329a7a(0x1fe)](a0_0x329a7a(0x1f2),auth,async(_0x371919,_0x381fd1)=>{var _0x1438bb=a0_0x329a7a;try{const {username:_0x263330,email:_0xa67b45,role:_0x1d8519}=_0x371919[_0x1438bb(0x226)],_0x40e231=_0x371919[_0x1438bb(0x226)],_0x2d1c1e=await profile['findOne']({'email':_0x40e231['email']}),_0x43c987=await master_shop[_0x1438bb(0x234)]();console[_0x1438bb(0x211)](_0x1438bb(0x22b),_0x43c987);const _0x8bdc0=_0x371919[_0x1438bb(0x241)]['id'];console[_0x1438bb(0x211)](_0x8bdc0);var _0x2a9515=[_0x1438bb(0x229)];const _0x451957=await sales_return_finished[_0x1438bb(0x24a)](_0x8bdc0),_0x91fb17=await warehouse['aggregate']([{'$match':{'name':_0x451957[_0x1438bb(0x224)],'room':_0x451957[_0x1438bb(0x25a)]}},{'$unwind':_0x1438bb(0x23a)},{'$group':{'_id':_0x1438bb(0x205),'name':{'$first':_0x1438bb(0x214)},'product_stock':{'$first':_0x1438bb(0x202)},'bay':{'$first':_0x1438bb(0x258)},'bin':{'$first':_0x1438bb(0x240)},'type':{'$first':_0x1438bb(0x22a)},'floorlevel':{'$first':_0x1438bb(0x260)},'primary_code':{'$first':_0x1438bb(0x220)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1438bb(0x20c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]);console['log'](_0x91fb17);const _0x28ec0f=await warehouse[_0x1438bb(0x21d)]([{'$match':{'status':_0x1438bb(0x250),'warehouse_category':_0x1438bb(0x228)}},{'$group':{'_id':'$name','name':{'$first':_0x1438bb(0x231)}}},{'$sort':{'name':0x1}}]),_0x16ce6e=await warehouse[_0x1438bb(0x21d)]([{'$match':{'status':_0x1438bb(0x250),'name':_0x1438bb(0x20a)}},{'$group':{'_id':_0x1438bb(0x231),'name':{'$first':_0x1438bb(0x231)}}},{'$sort':{'name':0x1}}]),_0x2bfe64=await product[_0x1438bb(0x234)]({});if(_0x43c987[0x0][_0x1438bb(0x1f9)]=='English\x20(US)'){var _0xd792ef=users['English'];console['log'](_0xd792ef);}else{if(_0x43c987[0x0]['language']==_0x1438bb(0x232))var _0xd792ef=users[_0x1438bb(0x232)];else{if(_0x43c987[0x0][_0x1438bb(0x1f9)]=='German')var _0xd792ef=users[_0x1438bb(0x253)];else{if(_0x43c987[0x0][_0x1438bb(0x1f9)]=='Spanish')var _0xd792ef=users['Spanish'];else{if(_0x43c987[0x0][_0x1438bb(0x1f9)]==_0x1438bb(0x24c))var _0xd792ef=users[_0x1438bb(0x24c)];else{if(_0x43c987[0x0][_0x1438bb(0x1f9)]==_0x1438bb(0x25e))var _0xd792ef=users[_0x1438bb(0x24f)];else{if(_0x43c987[0x0][_0x1438bb(0x1f9)]==_0x1438bb(0x233))var _0xd792ef=users[_0x1438bb(0x233)];else{if(_0x43c987[0x0][_0x1438bb(0x1f9)]=='Arabic\x20(ae)')var _0xd792ef=users[_0x1438bb(0x242)];}}}}}}}_0x381fd1[_0x1438bb(0x219)](_0x1438bb(0x21f),{'success':_0x371919[_0x1438bb(0x267)](_0x1438bb(0x255)),'errors':_0x371919[_0x1438bb(0x267)](_0x1438bb(0x1f8)),'role':_0x40e231,'profile':_0x2d1c1e,'master_shop':_0x43c987,'user':_0x451957,'stock':_0x91fb17,'unit':_0x2bfe64,'language':_0xd792ef,'warehouses':_0x28ec0f,'rooms':_0x2a9515,'warehouse_QA':_0x16ce6e});}catch(_0x4ed889){console[_0x1438bb(0x211)](_0x4ed889);}}),router[a0_0x329a7a(0x249)](a0_0x329a7a(0x1f2),auth,async(_0x36caa0,_0x11b7c0)=>{var _0x372218=a0_0x329a7a;if(_0x36caa0[_0x372218(0x221)]['for_categorize']=='QA')try{const _0x466a8a=_0x36caa0[_0x372218(0x241)]['id'],_0x1e102c=await sales_return[_0x372218(0x268)]({'invoice':_0x36caa0[_0x372218(0x221)][_0x372218(0x257)]}),_0x537e26=await warehouse[_0x372218(0x268)]({'name':_0x1e102c[_0x372218(0x224)],'room':_0x1e102c[_0x372218(0x25a)]}),{invoice:_0x5be327,customer:_0x258329,date:_0x4c95d3,warehouse_name:_0xbe414b,product_name:_0xea02f,primary_code:_0x37c0de,secondary_code:_0x2147cc,product_code:_0x2b3f1f,sales_quantity:_0x463c3d,stocks:_0x5e1d1a,return_qty:_0x154cd0,note:_0x10b19c,to_warehouse_name_QA:_0x416d8e,to_Room_name_QA:_0x4a6b9a}=_0x36caa0[_0x372218(0x221)];if(typeof product_name_QA==_0x372218(0x22d))var _0x57b328=[_0x36caa0['body'][_0x372218(0x1fd)]],_0x401dbb=[_0x36caa0['body'][_0x372218(0x25d)]],_0x2d8a29=[_0x36caa0[_0x372218(0x221)][_0x372218(0x218)]],_0x55eb8c=[_0x36caa0[_0x372218(0x221)]['product_code_QA']],_0x2fc11a=[_0x36caa0[_0x372218(0x221)]['sales_quantity_QA']],_0x477a39=[_0x36caa0[_0x372218(0x221)][_0x372218(0x25f)]],_0x3e9fc0=[_0x36caa0[_0x372218(0x221)][_0x372218(0x1f4)]];else var _0x57b328=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x1fd)]],_0x401dbb=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x25d)]],_0x2d8a29=[..._0x36caa0['body']['secondary_code_QA']],_0x55eb8c=[..._0x36caa0[_0x372218(0x221)]['product_code_QA']],_0x2fc11a=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x21a)]],_0x477a39=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x25f)]],_0x3e9fc0=[..._0x36caa0['body'][_0x372218(0x1f4)]];const _0x503283=_0x57b328['map'](_0x11d9cf=>{return _0x11d9cf={'product_name':_0x11d9cf};});_0x401dbb['forEach']((_0x4cab73,_0x3b3732)=>{var _0x2ef044=_0x372218;_0x503283[_0x3b3732][_0x2ef044(0x209)]=_0x4cab73;}),_0x2d8a29['forEach']((_0x2ae204,_0x3689eb)=>{var _0x2a4c5f=_0x372218;_0x503283[_0x3689eb][_0x2a4c5f(0x213)]=_0x2ae204;}),_0x55eb8c[_0x372218(0x259)]((_0x3bdcea,_0x51b7f0)=>{var _0x48a7b7=_0x372218;_0x503283[_0x51b7f0][_0x48a7b7(0x23b)]=_0x3bdcea;}),_0x2fc11a[_0x372218(0x259)]((_0x3099cf,_0x30a3c6)=>{_0x503283[_0x30a3c6]['sale_qty']=_0x3099cf;}),_0x477a39['forEach']((_0x1b4046,_0x50986c)=>{var _0xeaa4a8=_0x372218;_0x503283[_0x50986c][_0xeaa4a8(0x1f5)]=_0x1b4046;}),_0x3e9fc0['forEach']((_0x1ac11f,_0x476a02)=>{_0x503283[_0x476a02]['return_qty']=_0x1ac11f;}),_0x1e102c[_0x372218(0x21b)][_0x372218(0x259)](_0x37e094=>{var _0x54a402=_0x372218;const _0x3a364c=_0x537e26['product_details'][_0x54a402(0x20b)](_0xa1dfde=>{var _0xd7a6a9=_0x54a402;_0xa1dfde[_0xd7a6a9(0x261)]==_0x37e094[_0xd7a6a9(0x261)]&&(_0xa1dfde[_0xd7a6a9(0x1fb)]=parseInt(_0xa1dfde[_0xd7a6a9(0x1fb)])+parseInt(_0x37e094[_0xd7a6a9(0x225)]));});}),await _0x537e26[_0x372218(0x1fc)](),_0x1e102c[_0x372218(0x257)]=_0x5be327,_0x1e102c[_0x372218(0x217)]=_0x258329,_0x1e102c[_0x372218(0x227)]=_0x4c95d3,_0x1e102c[_0x372218(0x266)]=_0xbe414b,_0x1e102c['return_sale_QA']=_0x503283,_0x1e102c[_0x372218(0x236)]=_0x10b19c,_0x1e102c['ToWarehouse']=_0x416d8e,_0x1e102c[_0x372218(0x25a)]=_0x4a6b9a;const _0x1ab7d8=await _0x1e102c['save'](),_0x2f1c6f=await c_payment_data['findOne']({'invoice':_0x36caa0[_0x372218(0x221)][_0x372218(0x257)],'reason':'Sale\x20Return'});_0x2f1c6f[_0x372218(0x262)]=_0x36caa0['body'][_0x372218(0x262)],_0x2f1c6f[_0x372218(0x227)]=_0x36caa0[_0x372218(0x221)][_0x372218(0x227)],await _0x2f1c6f['save'](),_0x36caa0[_0x372218(0x267)](_0x372218(0x255),_0x372218(0x238)),_0x11b7c0[_0x372218(0x269)](_0x372218(0x244));}catch(_0x43adb6){console[_0x372218(0x211)](_0x43adb6),_0x11b7c0[_0x372218(0x239)](0xc8)[_0x372218(0x23c)]({'message':_0x43adb6[_0x372218(0x207)]});}else try{const _0x34a615=_0x36caa0[_0x372218(0x241)]['id'];console[_0x372218(0x211)](_0x34a615);const _0x4e545e=await sales_return[_0x372218(0x268)]({'invoice':_0x36caa0['body'][_0x372218(0x257)]});console[_0x372218(0x211)]('old_data',_0x4e545e);const _0x146939=await warehouse[_0x372218(0x268)]({'name':_0x4e545e[_0x372218(0x224)],'room':_0x4e545e[_0x372218(0x25a)]});console[_0x372218(0x211)](_0x372218(0x254),_0x146939);const {invoice:_0x5431c0,customer:_0x51701b,date:_0x3f037c,warehouse_name:_0x17e848,product_name:_0xb24574,primary_code:_0x287322,secondary_code:_0x14e4bd,product_code:_0x583a98,sales_quantity:_0x172940,stocks:_0x191f59,return_qty:_0x3feb0d,note:_0x30ece6,to_warehouse_name:_0x32d3e5,to_Room_name:_0x2e1d36}=_0x36caa0[_0x372218(0x221)];console[_0x372218(0x211)](_0x36caa0[_0x372218(0x221)]);if(typeof _0xb24574==_0x372218(0x22d))var _0x57b328=[_0x36caa0[_0x372218(0x221)][_0x372218(0x261)]],_0x401dbb=[_0x36caa0[_0x372218(0x221)][_0x372218(0x209)]],_0x2d8a29=[_0x36caa0[_0x372218(0x221)][_0x372218(0x213)]],_0x55eb8c=[_0x36caa0[_0x372218(0x221)][_0x372218(0x23b)]],_0x2fc11a=[_0x36caa0[_0x372218(0x221)][_0x372218(0x1f7)]],_0x477a39=[_0x36caa0[_0x372218(0x221)][_0x372218(0x24b)]],_0x3e9fc0=[_0x36caa0[_0x372218(0x221)]['return_qty']],_0x2e2a05=[_0x36caa0[_0x372218(0x221)][_0x372218(0x22c)]],_0x171e21=[_0x36caa0['body'][_0x372218(0x265)]],_0x2c77b0=[_0x36caa0[_0x372218(0x221)][_0x372218(0x23f)]],_0x174443=[_0x36caa0[_0x372218(0x221)][_0x372218(0x22f)]];else var _0x57b328=[..._0x36caa0['body'][_0x372218(0x261)]],_0x401dbb=[..._0x36caa0[_0x372218(0x221)]['primary_code']],_0x2d8a29=[..._0x36caa0['body']['secondary_code']],_0x55eb8c=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x23b)]],_0x2fc11a=[..._0x36caa0[_0x372218(0x221)]['sales_quantity']],_0x477a39=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x24b)]],_0x3e9fc0=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x225)]],_0x2e2a05=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x22c)]],_0x171e21=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x265)]],_0x2c77b0=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x23f)]],_0x174443=[..._0x36caa0[_0x372218(0x221)][_0x372218(0x22f)]];const _0x5da793=_0x57b328[_0x372218(0x20b)](_0x490757=>{return _0x490757={'product_name':_0x490757};});_0x401dbb['forEach']((_0x28a81c,_0x36a635)=>{var _0x330d69=_0x372218;_0x5da793[_0x36a635][_0x330d69(0x209)]=_0x28a81c;}),_0x2d8a29[_0x372218(0x259)]((_0x4a5ab4,_0x5a4a11)=>{_0x5da793[_0x5a4a11]['secondary_code']=_0x4a5ab4;}),_0x55eb8c[_0x372218(0x259)]((_0x59d600,_0x1076a2)=>{var _0x1ff669=_0x372218;_0x5da793[_0x1076a2][_0x1ff669(0x23b)]=_0x59d600;}),_0x2fc11a[_0x372218(0x259)]((_0xb46460,_0x306c75)=>{var _0x3d83aa=_0x372218;_0x5da793[_0x306c75][_0x3d83aa(0x245)]=_0xb46460;}),_0x477a39[_0x372218(0x259)]((_0x570122,_0x13fa03)=>{var _0x39266f=_0x372218;_0x5da793[_0x13fa03][_0x39266f(0x1f5)]=_0x570122;}),_0x3e9fc0[_0x372218(0x259)]((_0x3006a2,_0x11d5be)=>{var _0x139d60=_0x372218;_0x5da793[_0x11d5be][_0x139d60(0x225)]=_0x3006a2;}),_0x2e2a05['forEach']((_0x3c6416,_0x3cda3a)=>{var _0xa05953=_0x372218;_0x5da793[_0x3cda3a][_0xa05953(0x22c)]=_0x3c6416;}),_0x171e21['forEach']((_0x38b45f,_0x57a19e)=>{var _0x4bb4a4=_0x372218;_0x5da793[_0x57a19e][_0x4bb4a4(0x265)]=_0x38b45f;}),_0x2c77b0[_0x372218(0x259)]((_0x1d8b2d,_0x3f746d)=>{var _0x55fa26=_0x372218;_0x5da793[_0x3f746d][_0x55fa26(0x208)]=_0x1d8b2d;}),_0x174443[_0x372218(0x259)]((_0x44523f,_0xe0b44b)=>{_0x5da793[_0xe0b44b]['floorlevel']=_0x44523f;});var _0x51eb3b=0x0;_0x5da793['forEach'](_0xc560da=>{var _0x445404=_0x372218;console['log'](_0x445404(0x215),_0xc560da),(parseInt(_0xc560da[_0x445404(0x245)])<parseInt(_0xc560da['return_qty'])||parseInt(_0xc560da[_0x445404(0x1f5)])<parseInt(_0xc560da[_0x445404(0x225)])&&parseInt(_0xc560da[_0x445404(0x245)])>parseInt(_0xc560da['return_qty'])||parseInt(_0xc560da['return_qty'])==0x0)&&_0x51eb3b++;});if(_0x51eb3b!=0x0)return _0x36caa0[_0x372218(0x267)](_0x372218(0x1f8),_0x372218(0x256)),_0x11b7c0[_0x372218(0x269)]('back');_0x4e545e[_0x372218(0x235)][_0x372218(0x259)](_0x3beb88=>{var _0xe234eb=_0x372218;const _0x3e117b=_0x146939[_0xe234eb(0x1f3)]['map'](_0x350c4b=>{var _0x3a42a5=_0xe234eb;_0x350c4b['product_name']==_0x3beb88[_0x3a42a5(0x261)]&&_0x350c4b['floorlevel']==_0x3beb88[_0x3a42a5(0x22f)]&&_0x350c4b[_0x3a42a5(0x208)]==_0x3beb88['type']&&_0x350c4b['bin']==_0x3beb88['bin']&&_0x350c4b[_0x3a42a5(0x22c)]==_0x3beb88['bay']&&(_0x350c4b[_0x3a42a5(0x1fb)]=parseInt(_0x350c4b[_0x3a42a5(0x1fb)])+parseInt(_0x3beb88['return_qty']));});}),console[_0x372218(0x211)](_0x372218(0x254),_0x146939),await _0x146939[_0x372218(0x1fc)](),_0x4e545e[_0x372218(0x257)]=_0x5431c0,_0x4e545e['customer']=_0x51701b,_0x4e545e[_0x372218(0x227)]=_0x3f037c,_0x4e545e[_0x372218(0x266)]=_0x17e848,_0x4e545e[_0x372218(0x235)]=_0x5da793,_0x4e545e[_0x372218(0x236)]=_0x30ece6,_0x4e545e[_0x372218(0x224)]=_0x32d3e5,_0x4e545e[_0x372218(0x25a)]=_0x2e1d36;const _0x2f2122=await _0x4e545e[_0x372218(0x1fc)]();console[_0x372218(0x211)](_0x372218(0x1fa),_0x2f2122);const _0x209e65=await c_payment_data[_0x372218(0x268)]({'invoice':_0x36caa0[_0x372218(0x221)][_0x372218(0x257)],'reason':'Sale\x20Return'});_0x209e65[_0x372218(0x262)]=_0x36caa0[_0x372218(0x221)][_0x372218(0x262)],_0x209e65[_0x372218(0x227)]=_0x36caa0[_0x372218(0x221)][_0x372218(0x227)],await _0x209e65['save'](),_0x36caa0['flash'](_0x372218(0x255),_0x372218(0x238)),_0x11b7c0[_0x372218(0x269)](_0x372218(0x24d));}catch(_0x2ffc66){console[_0x372218(0x211)](_0x2ffc66),_0x11b7c0[_0x372218(0x239)](0xc8)[_0x372218(0x23c)]({'message':_0x2ffc66[_0x372218(0x207)]});}}),router[a0_0x329a7a(0x249)]('/give_payment/:id',auth,async(_0x4fadf8,_0x21ec48)=>{var _0x42495d=a0_0x329a7a;try{const _0x1d2799=_0x4fadf8[_0x42495d(0x241)]['id'],{invoice:_0x5c4d3b,customer:_0x537c0b,payable_to_customer:_0x48e319,paid_amount:_0x1bcfc3}=_0x4fadf8[_0x42495d(0x221)],_0x5042f4=await sales_return[_0x42495d(0x24a)](_0x1d2799);console[_0x42495d(0x211)](_0x42495d(0x223),_0x5042f4),console[_0x42495d(0x211)](_0x48e319),console['log'](_0x1bcfc3);var _0x4d4382=_0x48e319-_0x1bcfc3;console['log'](_0x42495d(0x237),_0x4d4382),_0x5042f4[_0x42495d(0x24e)]=parseFloat(_0x1bcfc3)+parseFloat(_0x5042f4[_0x42495d(0x24e)]),_0x5042f4[_0x42495d(0x22e)]=_0x4d4382,console[_0x42495d(0x211)](_0x5042f4);const _0x18e961=await _0x5042f4[_0x42495d(0x1fc)]();console['log'](0x1b207);const _0x4c5e66=await c_payment_data['findOne']({'invoice':_0x4fadf8['body'][_0x42495d(0x257)],'reason':'Sale\x20Return'});console[_0x42495d(0x211)](_0x42495d(0x252),_0x4c5e66),_0x4c5e66['amount']=_0x4d4382,await _0x4c5e66[_0x42495d(0x1fc)]();let _0x19a4fd=new Date(),_0x30e59c=('0'+_0x19a4fd['getDate']())[_0x42495d(0x1ff)](-0x2),_0x213da2=('0'+(_0x19a4fd['getMonth']()+0x1))[_0x42495d(0x1ff)](-0x2),_0x390e4e=_0x19a4fd[_0x42495d(0x206)](),_0x1ddb50=_0x390e4e+'-'+_0x213da2+'-'+_0x30e59c;const _0x58fc2b=new customer_payment({'invoice':_0x5c4d3b,'date':_0x390e4e+'-'+_0x213da2+'-'+_0x30e59c,'customer':_0x537c0b,'reason':'Returned\x20Payment\x20For\x20Sale\x20Return','amount':_0x1bcfc3}),_0x26e0cc=await _0x58fc2b['save']();_0x4fadf8[_0x42495d(0x267)]('success',_0x42495d(0x246)),_0x21ec48[_0x42495d(0x269)](_0x42495d(0x24d));}catch(_0x378922){console[_0x42495d(0x211)](_0x378922);}}),router[a0_0x329a7a(0x1fe)](a0_0x329a7a(0x21e),auth,async(_0x33359d,_0x5a5286)=>{var _0x4d58b5=a0_0x329a7a;try{const {username:_0x5ce866,email:_0x281a69,role:_0x562e32}=_0x33359d['user'],_0x361c6f=_0x33359d[_0x4d58b5(0x226)],_0x5064c4=await profile[_0x4d58b5(0x268)]({'email':_0x361c6f['email']}),_0x15c06a=await master_shop[_0x4d58b5(0x234)]();console[_0x4d58b5(0x211)](_0x4d58b5(0x22b),_0x15c06a);const _0xc78391=_0x33359d[_0x4d58b5(0x241)]['id'],_0x288096=await sales_return[_0x4d58b5(0x24a)](_0xc78391);console['log'](_0x288096);const _0x3fb47a=await customer[_0x4d58b5(0x268)]({'name':_0x288096[_0x4d58b5(0x217)]});console['log'](_0x3fb47a);if(_0x15c06a[0x0]['language']=='English\x20(US)'){var _0x4df814=users[_0x4d58b5(0x222)];console[_0x4d58b5(0x211)](_0x4df814);}else{if(_0x15c06a[0x0][_0x4d58b5(0x1f9)]=='Hindi')var _0x4df814=users[_0x4d58b5(0x232)];else{if(_0x15c06a[0x0][_0x4d58b5(0x1f9)]==_0x4d58b5(0x253))var _0x4df814=users[_0x4d58b5(0x253)];else{if(_0x15c06a[0x0]['language']==_0x4d58b5(0x20e))var _0x4df814=users[_0x4d58b5(0x20e)];else{if(_0x15c06a[0x0]['language']==_0x4d58b5(0x24c))var _0x4df814=users['French'];else{if(_0x15c06a[0x0]['language']=='Portuguese\x20(BR)')var _0x4df814=users[_0x4d58b5(0x24f)];else{if(_0x15c06a[0x0][_0x4d58b5(0x1f9)]==_0x4d58b5(0x233))var _0x4df814=users[_0x4d58b5(0x233)];else{if(_0x15c06a[0x0][_0x4d58b5(0x1f9)]==_0x4d58b5(0x201))var _0x4df814=users['Arabic'];}}}}}}}_0x5a5286[_0x4d58b5(0x219)]('sales_return_invoice',{'success':_0x33359d[_0x4d58b5(0x267)](_0x4d58b5(0x255)),'errors':_0x33359d['flash'](_0x4d58b5(0x1f8)),'role':_0x361c6f,'profile':_0x5064c4,'master_shop':_0x15c06a,'customers':_0x3fb47a,'sales':_0x288096,'language':_0x4df814});}catch(_0x34df02){console['log'](_0x34df02);}}),module[a0_0x329a7a(0x204)]=router;