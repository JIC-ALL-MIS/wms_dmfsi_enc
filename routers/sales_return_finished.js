var a0_0x2f0f9d=a0_0x100a;(function(_0xf09a9d,_0x2b558e){var _0x2a8b1e=a0_0x100a,_0x529299=_0xf09a9d();while(!![]){try{var _0x507500=parseInt(_0x2a8b1e(0xdd))/0x1+-parseInt(_0x2a8b1e(0xf0))/0x2*(parseInt(_0x2a8b1e(0x107))/0x3)+-parseInt(_0x2a8b1e(0x101))/0x4+-parseInt(_0x2a8b1e(0xee))/0x5+-parseInt(_0x2a8b1e(0x10f))/0x6*(-parseInt(_0x2a8b1e(0xb5))/0x7)+parseInt(_0x2a8b1e(0x106))/0x8*(parseInt(_0x2a8b1e(0x10c))/0x9)+parseInt(_0x2a8b1e(0xec))/0xa*(-parseInt(_0x2a8b1e(0xeb))/0xb);if(_0x507500===_0x2b558e)break;else _0x529299['push'](_0x529299['shift']());}catch(_0x4d3415){_0x529299['push'](_0x529299['shift']());}}}(a0_0x1ba0,0x1e7c7));const express=require(a0_0x2f0f9d(0xc1)),app=express(),router=express[a0_0x2f0f9d(0x10d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require(a0_0x2f0f9d(0xc6)),users=require('../public/language/languages.json');router[a0_0x2f0f9d(0xed)]('/view',auth,async(_0x14b60c,_0x9660b5)=>{var _0x49d695=a0_0x2f0f9d;try{const {username:_0x3e5f6d,email:_0x2c8ff9,role:_0x5f0642}=_0x14b60c[_0x49d695(0xda)],_0x30c2f1=_0x14b60c['user'],_0x11f19a=await profile[_0x49d695(0xd8)]({'email':_0x30c2f1['email']}),_0x3ee940=await master_shop[_0x49d695(0xf3)](),_0x30a12f=await sales_return_finished[_0x49d695(0xca)]([{'$lookup':{'from':_0x49d695(0xb7),'localField':_0x49d695(0xf1),'foreignField':_0x49d695(0xdf),'as':_0x49d695(0x10e)}},{'$unwind':_0x49d695(0xf6)}]);if(_0x3ee940[0x0][_0x49d695(0x113)]==_0x49d695(0x11b)){var _0x463d3f=users[_0x49d695(0xbb)];console['log'](_0x463d3f);}else{if(_0x3ee940[0x0][_0x49d695(0x113)]==_0x49d695(0x121))var _0x463d3f=users[_0x49d695(0x121)];else{if(_0x3ee940[0x0][_0x49d695(0x113)]==_0x49d695(0xff))var _0x463d3f=users[_0x49d695(0xff)];else{if(_0x3ee940[0x0]['language']==_0x49d695(0xbf))var _0x463d3f=users[_0x49d695(0xbf)];else{if(_0x3ee940[0x0][_0x49d695(0x113)]==_0x49d695(0xe0))var _0x463d3f=users['French'];else{if(_0x3ee940[0x0]['language']=='Portuguese\x20(BR)')var _0x463d3f=users['Portuguese'];else{if(_0x3ee940[0x0][_0x49d695(0x113)]==_0x49d695(0xc8))var _0x463d3f=users[_0x49d695(0xc8)];else{if(_0x3ee940[0x0]['language']==_0x49d695(0x124))var _0x463d3f=users['Arabic'];}}}}}}}_0x9660b5['render'](_0x49d695(0xd7),{'success':_0x14b60c['flash'](_0x49d695(0x100)),'errors':_0x14b60c[_0x49d695(0xd2)](_0x49d695(0xe4)),'role':_0x30c2f1,'profile':_0x11f19a,'master_shop':_0x3ee940,'user':_0x30a12f,'language':_0x463d3f});}catch(_0x336e9d){console['log'](_0x336e9d);}}),router[a0_0x2f0f9d(0xed)](a0_0x2f0f9d(0xce),auth,async(_0x445118,_0x21e4ef)=>{var _0xcaee14=a0_0x2f0f9d;try{const {username:_0x1755f4,email:_0x2cc3f2,role:_0x17c518}=_0x445118[_0xcaee14(0xda)],_0xa5008d=_0x445118[_0xcaee14(0xda)],_0x4a030d=await profile[_0xcaee14(0xd8)]({'email':_0xa5008d['email']}),_0x5a5ded=await master_shop[_0xcaee14(0xf3)]();console[_0xcaee14(0xbd)](_0xcaee14(0xe8),_0x5a5ded);const _0x50de76=_0x445118[_0xcaee14(0xd6)]['id'];console[_0xcaee14(0xbd)](_0x50de76);var _0x336bed=[_0xcaee14(0xfb)];const _0x2d3bb3=await sales_return_finished[_0xcaee14(0xd5)](_0x50de76),_0x3c074c=await warehouse[_0xcaee14(0xca)]([{'$match':{'name':_0x2d3bb3[_0xcaee14(0xdc)],'room':_0x2d3bb3[_0xcaee14(0xcc)]}},{'$unwind':_0xcaee14(0xf8)},{'$group':{'_id':_0xcaee14(0x119),'name':{'$first':_0xcaee14(0xea)},'product_stock':{'$first':_0xcaee14(0xc0)},'bay':{'$first':_0xcaee14(0x118)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xcaee14(0xb2)},'floorlevel':{'$first':_0xcaee14(0x120)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xcaee14(0xdb)},'product_code':{'$first':_0xcaee14(0xcf)},'storage':{'$first':_0xcaee14(0xf5)},'rack':{'$first':'$product_details.rack'}}}]);console['log'](_0x3c074c);const _0x5b6a8b=await warehouse[_0xcaee14(0xca)]([{'$match':{'status':_0xcaee14(0xb3),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0xcaee14(0xba),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x56631e=await warehouse[_0xcaee14(0xca)]([{'$match':{'status':_0xcaee14(0xb3),'name':_0xcaee14(0xc4)}},{'$group':{'_id':_0xcaee14(0xba),'name':{'$first':_0xcaee14(0xba)}}},{'$sort':{'name':0x1}}]),_0x5749b2=await product[_0xcaee14(0xf3)]({});if(_0x5a5ded[0x0][_0xcaee14(0x113)]==_0xcaee14(0x11b)){var _0x449752=users[_0xcaee14(0xbb)];console[_0xcaee14(0xbd)](_0x449752);}else{if(_0x5a5ded[0x0]['language']==_0xcaee14(0x121))var _0x449752=users[_0xcaee14(0x121)];else{if(_0x5a5ded[0x0][_0xcaee14(0x113)]=='German')var _0x449752=users[_0xcaee14(0xff)];else{if(_0x5a5ded[0x0][_0xcaee14(0x113)]=='Spanish')var _0x449752=users[_0xcaee14(0xbf)];else{if(_0x5a5ded[0x0][_0xcaee14(0x113)]=='French')var _0x449752=users[_0xcaee14(0xe0)];else{if(_0x5a5ded[0x0][_0xcaee14(0x113)]==_0xcaee14(0xd9))var _0x449752=users[_0xcaee14(0xc7)];else{if(_0x5a5ded[0x0][_0xcaee14(0x113)]==_0xcaee14(0xc8))var _0x449752=users[_0xcaee14(0xc8)];else{if(_0x5a5ded[0x0]['language']==_0xcaee14(0x124))var _0x449752=users['Arabic'];}}}}}}}_0x21e4ef[_0xcaee14(0xe6)](_0xcaee14(0xfe),{'success':_0x445118[_0xcaee14(0xd2)](_0xcaee14(0x100)),'errors':_0x445118[_0xcaee14(0xd2)](_0xcaee14(0xe4)),'role':_0xa5008d,'profile':_0x4a030d,'master_shop':_0x5a5ded,'user':_0x2d3bb3,'stock':_0x3c074c,'unit':_0x5749b2,'language':_0x449752,'warehouses':_0x5b6a8b,'rooms':_0x336bed,'warehouse_QA':_0x56631e});}catch(_0x57a80f){console[_0xcaee14(0xbd)](_0x57a80f);}}),router[a0_0x2f0f9d(0xfd)](a0_0x2f0f9d(0xce),auth,async(_0x94dfb6,_0x5bb0ad)=>{var _0x58765b=a0_0x2f0f9d;if(_0x94dfb6[_0x58765b(0x112)][_0x58765b(0x11c)]=='QA')try{const _0x5d1eb2=_0x94dfb6[_0x58765b(0xd6)]['id'],_0x13d62b=await sales_return[_0x58765b(0xd8)]({'invoice':_0x94dfb6[_0x58765b(0x112)]['invoice']}),_0xaaf7c3=await warehouse[_0x58765b(0xd8)]({'name':_0x13d62b[_0x58765b(0xdc)],'room':_0x13d62b['ToRoom']}),{invoice:_0xe01854,customer:_0x352f17,date:_0x4d28d4,warehouse_name:_0x532f31,product_name:_0xf028c3,primary_code:_0x4349f6,secondary_code:_0x3aa802,product_code:_0x10ab69,sales_quantity:_0xeb5ca4,stocks:_0x545582,return_qty:_0x224f25,note:_0x133f0d,to_warehouse_name_QA:_0x55a610,to_Room_name_QA:_0x45eb7a}=_0x94dfb6[_0x58765b(0x112)];if(typeof product_name_QA==_0x58765b(0xd0))var _0xec5c87=[_0x94dfb6[_0x58765b(0x112)][_0x58765b(0xef)]],_0x1eba05=[_0x94dfb6['body']['primary_code_QA']],_0x1bf237=[_0x94dfb6['body']['secondary_code_QA']],_0x551c76=[_0x94dfb6['body']['product_code_QA']],_0x362808=[_0x94dfb6[_0x58765b(0x112)][_0x58765b(0xe9)]],_0x28b0f4=[_0x94dfb6[_0x58765b(0x112)][_0x58765b(0x125)]],_0x482f63=[_0x94dfb6[_0x58765b(0x112)][_0x58765b(0xaf)]];else var _0xec5c87=[..._0x94dfb6[_0x58765b(0x112)][_0x58765b(0xef)]],_0x1eba05=[..._0x94dfb6[_0x58765b(0x112)]['primary_code_QA']],_0x1bf237=[..._0x94dfb6[_0x58765b(0x112)][_0x58765b(0xbe)]],_0x551c76=[..._0x94dfb6[_0x58765b(0x112)]['product_code_QA']],_0x362808=[..._0x94dfb6['body'][_0x58765b(0xe9)]],_0x28b0f4=[..._0x94dfb6[_0x58765b(0x112)]['stocks_QA']],_0x482f63=[..._0x94dfb6[_0x58765b(0x112)][_0x58765b(0xaf)]];const _0x1c7b55=_0xec5c87[_0x58765b(0x115)](_0x321c4e=>{return _0x321c4e={'product_name':_0x321c4e};});_0x1eba05[_0x58765b(0x104)]((_0x4bace9,_0x2e1248)=>{var _0x2035ab=_0x58765b;_0x1c7b55[_0x2e1248][_0x2035ab(0x117)]=_0x4bace9;}),_0x1bf237[_0x58765b(0x104)]((_0x5155e2,_0x5d93a3)=>{var _0xb404df=_0x58765b;_0x1c7b55[_0x5d93a3][_0xb404df(0xd1)]=_0x5155e2;}),_0x551c76[_0x58765b(0x104)]((_0x5431b0,_0x5cdec5)=>{var _0xa0ad6f=_0x58765b;_0x1c7b55[_0x5cdec5][_0xa0ad6f(0x108)]=_0x5431b0;}),_0x362808[_0x58765b(0x104)]((_0x4ba0ae,_0x33d6ea)=>{var _0x392bab=_0x58765b;_0x1c7b55[_0x33d6ea][_0x392bab(0xd3)]=_0x4ba0ae;}),_0x28b0f4['forEach']((_0x20b8c2,_0x504b68)=>{var _0x2af32d=_0x58765b;_0x1c7b55[_0x504b68][_0x2af32d(0xc2)]=_0x20b8c2;}),_0x482f63[_0x58765b(0x104)]((_0x2d9e5a,_0x5d1213)=>{var _0x11c376=_0x58765b;_0x1c7b55[_0x5d1213][_0x11c376(0xfc)]=_0x2d9e5a;}),_0x13d62b[_0x58765b(0xf4)]['forEach'](_0x260f57=>{var _0x39dac1=_0x58765b;const _0x4e785b=_0xaaf7c3['product_details'][_0x39dac1(0x115)](_0x59db6d=>{var _0x1f41df=_0x39dac1;_0x59db6d[_0x1f41df(0xde)]==_0x260f57[_0x1f41df(0xde)]&&(_0x59db6d[_0x1f41df(0xb6)]=parseInt(_0x59db6d['product_stock'])+parseInt(_0x260f57[_0x1f41df(0xfc)]));});}),await _0xaaf7c3[_0x58765b(0xb4)](),_0x13d62b['invoice']=_0xe01854,_0x13d62b[_0x58765b(0xf1)]=_0x352f17,_0x13d62b['date']=_0x4d28d4,_0x13d62b['warehouse_name']=_0x532f31,_0x13d62b[_0x58765b(0xf4)]=_0x1c7b55,_0x13d62b[_0x58765b(0x122)]=_0x133f0d,_0x13d62b[_0x58765b(0xdc)]=_0x55a610,_0x13d62b[_0x58765b(0xcc)]=_0x45eb7a;const _0x487f52=await _0x13d62b[_0x58765b(0xb4)](),_0x142d9d=await c_payment_data[_0x58765b(0xd8)]({'invoice':_0x94dfb6[_0x58765b(0x112)][_0x58765b(0xc3)],'reason':_0x58765b(0x105)});_0x142d9d[_0x58765b(0xe5)]=_0x94dfb6[_0x58765b(0x112)]['suppliers'],_0x142d9d[_0x58765b(0xcd)]=_0x94dfb6[_0x58765b(0x112)][_0x58765b(0xcd)],await _0x142d9d[_0x58765b(0xb4)](),_0x94dfb6[_0x58765b(0xd2)](_0x58765b(0x100),_0x58765b(0xe2)),_0x5bb0ad['redirect'](_0x58765b(0xfa));}catch(_0xa13ce){console[_0x58765b(0xbd)](_0xa13ce),_0x5bb0ad[_0x58765b(0xb1)](0xc8)[_0x58765b(0x123)]({'message':_0xa13ce['message']});}else try{const _0x4179dc=_0x94dfb6['params']['id'];console[_0x58765b(0xbd)](_0x4179dc);const _0x59598a=await sales_return[_0x58765b(0xd8)]({'invoice':_0x94dfb6[_0x58765b(0x112)][_0x58765b(0xc3)]});console[_0x58765b(0xbd)](_0x58765b(0x109),_0x59598a);const _0x4dc9e=await warehouse['findOne']({'name':_0x59598a[_0x58765b(0xdc)],'room':_0x59598a[_0x58765b(0xcc)]});console['log']('old_warehouse_data',_0x4dc9e);const {invoice:_0x493286,customer:_0xe56262,date:_0x39aaed,warehouse_name:_0x216798,product_name:_0x366a4c,primary_code:_0x30eca3,secondary_code:_0x4178b2,product_code:_0xe28935,sales_quantity:_0x3586ad,stocks:_0x39d536,return_qty:_0x4468dc,note:_0x2934cc,to_warehouse_name:_0x2fd40e,to_Room_name:_0x2468f2}=_0x94dfb6[_0x58765b(0x112)];console[_0x58765b(0xbd)](_0x94dfb6['body']);if(typeof _0x366a4c==_0x58765b(0xd0))var _0xec5c87=[_0x94dfb6['body'][_0x58765b(0xde)]],_0x1eba05=[_0x94dfb6['body'][_0x58765b(0x117)]],_0x1bf237=[_0x94dfb6[_0x58765b(0x112)]['secondary_code']],_0x551c76=[_0x94dfb6[_0x58765b(0x112)][_0x58765b(0x108)]],_0x362808=[_0x94dfb6[_0x58765b(0x112)][_0x58765b(0x11d)]],_0x28b0f4=[_0x94dfb6[_0x58765b(0x112)][_0x58765b(0xc5)]],_0x482f63=[_0x94dfb6[_0x58765b(0x112)]['return_qty']],_0x3d2df1=[_0x94dfb6['body'][_0x58765b(0xd4)]],_0x1037e3=[_0x94dfb6[_0x58765b(0x112)][_0x58765b(0x11f)]],_0xdbb8ce=[_0x94dfb6[_0x58765b(0x112)]['types']],_0x179754=[_0x94dfb6[_0x58765b(0x112)][_0x58765b(0x116)]];else var _0xec5c87=[..._0x94dfb6[_0x58765b(0x112)]['product_name']],_0x1eba05=[..._0x94dfb6[_0x58765b(0x112)][_0x58765b(0x117)]],_0x1bf237=[..._0x94dfb6['body'][_0x58765b(0xd1)]],_0x551c76=[..._0x94dfb6['body']['product_code']],_0x362808=[..._0x94dfb6[_0x58765b(0x112)][_0x58765b(0x11d)]],_0x28b0f4=[..._0x94dfb6[_0x58765b(0x112)][_0x58765b(0xc5)]],_0x482f63=[..._0x94dfb6[_0x58765b(0x112)]['return_qty']],_0x3d2df1=[..._0x94dfb6[_0x58765b(0x112)][_0x58765b(0xd4)]],_0x1037e3=[..._0x94dfb6['body'][_0x58765b(0x11f)]],_0xdbb8ce=[..._0x94dfb6['body'][_0x58765b(0xf2)]],_0x179754=[..._0x94dfb6[_0x58765b(0x112)][_0x58765b(0x116)]];const _0x3e1f83=_0xec5c87[_0x58765b(0x115)](_0x2a1ba3=>{return _0x2a1ba3={'product_name':_0x2a1ba3};});_0x1eba05[_0x58765b(0x104)]((_0x344dc7,_0x4fd1cf)=>{var _0x3327fc=_0x58765b;_0x3e1f83[_0x4fd1cf][_0x3327fc(0x117)]=_0x344dc7;}),_0x1bf237[_0x58765b(0x104)]((_0x36b948,_0xf5c4da)=>{var _0x243ad9=_0x58765b;_0x3e1f83[_0xf5c4da][_0x243ad9(0xd1)]=_0x36b948;}),_0x551c76['forEach']((_0x35cf96,_0x3cae68)=>{var _0x254661=_0x58765b;_0x3e1f83[_0x3cae68][_0x254661(0x108)]=_0x35cf96;}),_0x362808[_0x58765b(0x104)]((_0x1bca54,_0x22c8f0)=>{var _0x42271b=_0x58765b;_0x3e1f83[_0x22c8f0][_0x42271b(0xd3)]=_0x1bca54;}),_0x28b0f4['forEach']((_0x4808cd,_0x15f16d)=>{var _0x1d9ccc=_0x58765b;_0x3e1f83[_0x15f16d][_0x1d9ccc(0xc2)]=_0x4808cd;}),_0x482f63[_0x58765b(0x104)]((_0x18b74d,_0x45745d)=>{_0x3e1f83[_0x45745d]['return_qty']=_0x18b74d;}),_0x3d2df1[_0x58765b(0x104)]((_0x456ab8,_0x5172ee)=>{var _0x3a9cf0=_0x58765b;_0x3e1f83[_0x5172ee][_0x3a9cf0(0xd4)]=_0x456ab8;}),_0x1037e3[_0x58765b(0x104)]((_0x4b2293,_0x261a6e)=>{var _0x18672e=_0x58765b;_0x3e1f83[_0x261a6e][_0x18672e(0x11f)]=_0x4b2293;}),_0xdbb8ce[_0x58765b(0x104)]((_0x3f699d,_0x379f0a)=>{_0x3e1f83[_0x379f0a]['type']=_0x3f699d;}),_0x179754[_0x58765b(0x104)]((_0x508366,_0x14ba36)=>{var _0x5cfba9=_0x58765b;_0x3e1f83[_0x14ba36][_0x5cfba9(0x116)]=_0x508366;});var _0x2a3627=0x0;_0x3e1f83[_0x58765b(0x104)](_0x5e53e6=>{var _0x28da34=_0x58765b;console['log'](_0x28da34(0x114),_0x5e53e6),(parseInt(_0x5e53e6[_0x28da34(0xd3)])<parseInt(_0x5e53e6[_0x28da34(0xfc)])||parseInt(_0x5e53e6[_0x28da34(0xc2)])<parseInt(_0x5e53e6[_0x28da34(0xfc)])&&parseInt(_0x5e53e6[_0x28da34(0xd3)])>parseInt(_0x5e53e6[_0x28da34(0xfc)])||parseInt(_0x5e53e6['return_qty'])==0x0)&&_0x2a3627++;});if(_0x2a3627!=0x0)return _0x94dfb6['flash'](_0x58765b(0xe4),_0x58765b(0x110)),_0x5bb0ad[_0x58765b(0xe1)](_0x58765b(0x10a));_0x59598a['return_sale'][_0x58765b(0x104)](_0x4d977c=>{var _0x3383d8=_0x58765b;const _0x31921d=_0x4dc9e[_0x3383d8(0x10b)][_0x3383d8(0x115)](_0x280e76=>{var _0xe1b722=_0x3383d8;_0x280e76[_0xe1b722(0xde)]==_0x4d977c[_0xe1b722(0xde)]&&_0x280e76['floorlevel']==_0x4d977c[_0xe1b722(0x116)]&&_0x280e76[_0xe1b722(0xf7)]==_0x4d977c['type']&&_0x280e76['bin']==_0x4d977c[_0xe1b722(0x11f)]&&_0x280e76[_0xe1b722(0xd4)]==_0x4d977c[_0xe1b722(0xd4)]&&(_0x280e76[_0xe1b722(0xb6)]=parseInt(_0x280e76['product_stock'])+parseInt(_0x4d977c[_0xe1b722(0xfc)]));});}),console[_0x58765b(0xbd)](_0x58765b(0xc9),_0x4dc9e),await _0x4dc9e[_0x58765b(0xb4)](),_0x59598a[_0x58765b(0xc3)]=_0x493286,_0x59598a[_0x58765b(0xf1)]=_0xe56262,_0x59598a[_0x58765b(0xcd)]=_0x39aaed,_0x59598a['warehouse_name']=_0x216798,_0x59598a[_0x58765b(0xe3)]=_0x3e1f83,_0x59598a['note']=_0x2934cc,_0x59598a['ToWarehouse']=_0x2fd40e,_0x59598a[_0x58765b(0xcc)]=_0x2468f2;const _0x31d089=await _0x59598a['save']();console[_0x58765b(0xbd)]('new\x20new_data',_0x31d089);const _0x4646e2=await c_payment_data[_0x58765b(0xd8)]({'invoice':_0x94dfb6[_0x58765b(0x112)][_0x58765b(0xc3)],'reason':_0x58765b(0x105)});_0x4646e2[_0x58765b(0xe5)]=_0x94dfb6[_0x58765b(0x112)]['suppliers'],_0x4646e2[_0x58765b(0xcd)]=_0x94dfb6[_0x58765b(0x112)][_0x58765b(0xcd)],await _0x4646e2[_0x58765b(0xb4)](),_0x94dfb6[_0x58765b(0xd2)](_0x58765b(0x100),_0x58765b(0xe2)),_0x5bb0ad[_0x58765b(0xe1)]('/sales_return/view');}catch(_0x290309){console['log'](_0x290309),_0x5bb0ad[_0x58765b(0xb1)](0xc8)[_0x58765b(0x123)]({'message':_0x290309['message']});}}),router[a0_0x2f0f9d(0xfd)](a0_0x2f0f9d(0xe7),auth,async(_0x455615,_0x16b1c6)=>{var _0x2be210=a0_0x2f0f9d;try{const _0xc85cf=_0x455615[_0x2be210(0xd6)]['id'],{invoice:_0xd7cbac,customer:_0x4df8ab,payable_to_customer:_0x4c1cb6,paid_amount:_0x396016}=_0x455615[_0x2be210(0x112)],_0x42885b=await sales_return[_0x2be210(0xd5)](_0xc85cf);console[_0x2be210(0xbd)]('data',_0x42885b),console['log'](_0x4c1cb6),console[_0x2be210(0xbd)](_0x396016);var _0x21c9e2=_0x4c1cb6-_0x396016;console[_0x2be210(0xbd)]('subtract',_0x21c9e2),_0x42885b[_0x2be210(0xb9)]=parseFloat(_0x396016)+parseFloat(_0x42885b['paid_amount']),_0x42885b[_0x2be210(0x11a)]=_0x21c9e2,console[_0x2be210(0xbd)](_0x42885b);const _0xbbb9e=await _0x42885b[_0x2be210(0xb4)]();console[_0x2be210(0xbd)](0x1b207);const _0x391a13=await c_payment_data[_0x2be210(0xd8)]({'invoice':_0x455615[_0x2be210(0x112)][_0x2be210(0xc3)],'reason':_0x2be210(0x105)});console[_0x2be210(0xbd)]('c_payment',_0x391a13),_0x391a13['amount']=_0x21c9e2,await _0x391a13['save']();let _0x16a6e5=new Date(),_0x56a51b=('0'+_0x16a6e5[_0x2be210(0xb0)]())[_0x2be210(0xb8)](-0x2),_0x3cee1e=('0'+(_0x16a6e5['getMonth']()+0x1))[_0x2be210(0xb8)](-0x2),_0x588e56=_0x16a6e5[_0x2be210(0xf9)](),_0x2d6ecd=_0x588e56+'-'+_0x3cee1e+'-'+_0x56a51b;const _0x55ff5c=new customer_payment({'invoice':_0xd7cbac,'date':_0x588e56+'-'+_0x3cee1e+'-'+_0x56a51b,'customer':_0x4df8ab,'reason':_0x2be210(0x11e),'amount':_0x396016}),_0x363628=await _0x55ff5c[_0x2be210(0xb4)]();_0x455615['flash'](_0x2be210(0x100),'payment\x20successfull'),_0x16b1c6[_0x2be210(0xe1)]('/sales_return/view');}catch(_0x2cf81f){console[_0x2be210(0xbd)](_0x2cf81f);}}),router['get'](a0_0x2f0f9d(0x103),auth,async(_0x302c4c,_0x74a21f)=>{var _0x53eeb5=a0_0x2f0f9d;try{const {username:_0x4c5d6a,email:_0x3bd846,role:_0x3e6445}=_0x302c4c[_0x53eeb5(0xda)],_0x3cdcf2=_0x302c4c[_0x53eeb5(0xda)],_0x290a6d=await profile['findOne']({'email':_0x3cdcf2[_0x53eeb5(0xcb)]}),_0x41e9ea=await master_shop[_0x53eeb5(0xf3)]();console[_0x53eeb5(0xbd)](_0x53eeb5(0xe8),_0x41e9ea);const _0x4c5905=_0x302c4c[_0x53eeb5(0xd6)]['id'],_0x410830=await sales_return[_0x53eeb5(0xd5)](_0x4c5905);console['log'](_0x410830);const _0x12950a=await customer[_0x53eeb5(0xd8)]({'name':_0x410830[_0x53eeb5(0xf1)]});console[_0x53eeb5(0xbd)](_0x12950a);if(_0x41e9ea[0x0][_0x53eeb5(0x113)]=='English\x20(US)'){var _0x567fb1=users[_0x53eeb5(0xbb)];console[_0x53eeb5(0xbd)](_0x567fb1);}else{if(_0x41e9ea[0x0][_0x53eeb5(0x113)]==_0x53eeb5(0x121))var _0x567fb1=users[_0x53eeb5(0x121)];else{if(_0x41e9ea[0x0]['language']==_0x53eeb5(0xff))var _0x567fb1=users['German'];else{if(_0x41e9ea[0x0][_0x53eeb5(0x113)]==_0x53eeb5(0xbf))var _0x567fb1=users['Spanish'];else{if(_0x41e9ea[0x0][_0x53eeb5(0x113)]==_0x53eeb5(0xe0))var _0x567fb1=users[_0x53eeb5(0xe0)];else{if(_0x41e9ea[0x0]['language']==_0x53eeb5(0xd9))var _0x567fb1=users[_0x53eeb5(0xc7)];else{if(_0x41e9ea[0x0][_0x53eeb5(0x113)]==_0x53eeb5(0xc8))var _0x567fb1=users[_0x53eeb5(0xc8)];else{if(_0x41e9ea[0x0][_0x53eeb5(0x113)]=='Arabic\x20(ae)')var _0x567fb1=users[_0x53eeb5(0x111)];}}}}}}}_0x74a21f['render'](_0x53eeb5(0x102),{'success':_0x302c4c[_0x53eeb5(0xd2)](_0x53eeb5(0x100)),'errors':_0x302c4c[_0x53eeb5(0xd2)](_0x53eeb5(0xe4)),'role':_0x3cdcf2,'profile':_0x290a6d,'master_shop':_0x41e9ea,'customers':_0x12950a,'sales':_0x410830,'language':_0x567fb1});}catch(_0x3da8d1){console[_0x53eeb5(0xbd)](_0x3da8d1);}}),module[a0_0x2f0f9d(0xbc)]=router;function a0_0x100a(_0x35265e,_0x2e5bd8){var _0x1ba084=a0_0x1ba0();return a0_0x100a=function(_0x100aa9,_0x3da763){_0x100aa9=_0x100aa9-0xaf;var _0x2529e4=_0x1ba084[_0x100aa9];return _0x2529e4;},a0_0x100a(_0x35265e,_0x2e5bd8);}function a0_0x1ba0(){var _0x30a9f2=['save','74669KLjZiH','product_stock','customers','slice','paid_amount','$name','English','exports','log','secondary_code_QA','Spanish','$product_details.product_stock','express','stock','invoice','QA\x20Warehouse','stocks','../middleware/auth','Portuguese','Chinese','old_warehouse_data','aggregate','email','ToRoom','date','/view/:id','$product_details.product_code','string','secondary_code','flash','sale_qty','bay','findById','params','sales_return_finished','findOne','Portuguese\x20(BR)','user','$product_details.secondary_code','ToWarehouse','189820DZmnLR','product_name','name','French','redirect','purchase\x20return\x20successfully','return_sale','errors','suppliers','render','/give_payment/:id','master','sales_quantity_QA','$product_details.product_name','11UuCulp','1073300HIqoNY','get','560115vGSsQv','product_name_QA','144628mZPPWK','customer','types','find','return_sale_QA','$product_details.storage','$customer_docs','type','$product_details','getFullYear','/sales_return_finished/view','Return\x20Rooms','return_qty','post','return_sale_edit_finished','German','success','410844pVzyqv','sales_return_invoice','/invoice/:id','forEach','Sale\x20Return','200ggeWNX','3XoWEJs','product_code','old_data','back','product_details','72513HILWzM','Router','customer_docs','72JkApJb','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','Arabic','body','language','foreach\x20newproduct','map','floorlevel','primary_code','$product_details.bay','$product_details._id','due_amount','English\x20(US)','for_categorize','sales_quantity','Returned\x20Payment\x20For\x20Sale\x20Return','bin','$product_details.floorlevel','Hindi','note','json','Arabic\x20(ae)','stocks_QA','return_qty_QA','getDate','status','$product_details.type','Enabled'];a0_0x1ba0=function(){return _0x30a9f2;};return a0_0x1ba0();}