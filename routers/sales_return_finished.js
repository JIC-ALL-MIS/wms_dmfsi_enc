var a0_0x39c283=a0_0x4bda;(function(_0x132bb4,_0x1ce7e9){var _0x48d38f=a0_0x4bda,_0x480090=_0x132bb4();while(!![]){try{var _0x409296=-parseInt(_0x48d38f(0xfd))/0x1*(-parseInt(_0x48d38f(0x9f))/0x2)+-parseInt(_0x48d38f(0xdc))/0x3+parseInt(_0x48d38f(0x100))/0x4*(-parseInt(_0x48d38f(0x108))/0x5)+-parseInt(_0x48d38f(0xee))/0x6*(-parseInt(_0x48d38f(0x109))/0x7)+parseInt(_0x48d38f(0xd5))/0x8+-parseInt(_0x48d38f(0xdb))/0x9+parseInt(_0x48d38f(0xec))/0xa;if(_0x409296===_0x1ce7e9)break;else _0x480090['push'](_0x480090['shift']());}catch(_0x3355b1){_0x480090['push'](_0x480090['shift']());}}}(a0_0x13e3,0x722b3));function a0_0x13e3(){var _0x52966b=['QA\x20Warehouse','product_code_QA','Chinese','types','map','product_name_QA','$customer_docs','log','English\x20(US)','invoice','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','purchase\x20return\x20successfully','/view/:id','string','7290090dTSiWK','English','888kiOpTd','status','Finished\x20Goods','ToRoom','/view','subtract','stocks','back','foreach\x20newproduct','params','aggregate','findById','old_warehouse_data','$product_details.product_name','bin','1MHMPDU','/sales_return/view','data','2772fDDOzh','message','due_amount','suppliers','$product_details','bay','render','return_qty_QA','315IGgQoj','3157mxnQlj','/sales_return_finished/view','body','Spanish','new\x20new_data','ToWarehouse','$name','$product_details.product_stock','$product_details._id','date','get','return_sale','584042FKwdDP','product_details','customer','findOne','sales_quantity','Portuguese\x20(BR)','stock','product_name','email','Arabic\x20(ae)','primary_code_QA','sales_return_finished','success','language','Sale\x20Return','Hindi','errors','for_categorize','Enabled','slice','sale_qty','save','user','$product_details.floorlevel','getFullYear','../middleware/auth','French','flash','Portuguese','return_qty','note','Arabic','c_payment','/give_payment/:id','amount','payment\x20successfull','$product_details.secondary_code','product_stock','$product_details.bay','../public/language/languages.json','$product_details.type','Router','floorlevel','German','$product_details.bin','warehouse_name','primary_code','secondary_code','paid_amount','type','find','post','old_data','forEach','6554040zUHgGI','json','customer_docs','../models/all_models','redirect','product_code','8148213iCfgmn','1471146pIBsqP','exports'];a0_0x13e3=function(){return _0x52966b;};return a0_0x13e3();}function a0_0x4bda(_0x145989,_0x70d8f9){var _0x13e33c=a0_0x13e3();return a0_0x4bda=function(_0x4bda6e,_0x3db8b5){_0x4bda6e=_0x4bda6e-0x9b;var _0x5140f3=_0x13e33c[_0x4bda6e];return _0x5140f3;},a0_0x4bda(_0x145989,_0x70d8f9);}const express=require('express'),app=express(),router=express[a0_0x39c283(0xc8)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x39c283(0xd8)),auth=require(a0_0x39c283(0xb8)),users=require(a0_0x39c283(0xc6));router[a0_0x39c283(0x9d)](a0_0x39c283(0xf2),auth,async(_0x247dc0,_0x1fc6db)=>{var _0x4fa83b=a0_0x39c283;try{const {username:_0x42d1b9,email:_0x556606,role:_0x401050}=_0x247dc0[_0x4fa83b(0xb5)],_0x38787c=_0x247dc0[_0x4fa83b(0xb5)],_0x2cf291=await profile[_0x4fa83b(0xa2)]({'email':_0x38787c['email']}),_0x4fe506=await master_shop['find'](),_0x52da28=await sales_return_finished['aggregate']([{'$lookup':{'from':'customers','localField':_0x4fa83b(0xa1),'foreignField':'name','as':_0x4fa83b(0xd7)}},{'$unwind':_0x4fa83b(0xe4)}]);if(_0x4fe506[0x0][_0x4fa83b(0xac)]==_0x4fa83b(0xe6)){var _0x145061=users['English'];console[_0x4fa83b(0xe5)](_0x145061);}else{if(_0x4fe506[0x0]['language']==_0x4fa83b(0xae))var _0x145061=users[_0x4fa83b(0xae)];else{if(_0x4fe506[0x0]['language']==_0x4fa83b(0xca))var _0x145061=users['German'];else{if(_0x4fe506[0x0][_0x4fa83b(0xac)]==_0x4fa83b(0x10c))var _0x145061=users[_0x4fa83b(0x10c)];else{if(_0x4fe506[0x0][_0x4fa83b(0xac)]==_0x4fa83b(0xb9))var _0x145061=users[_0x4fa83b(0xb9)];else{if(_0x4fe506[0x0][_0x4fa83b(0xac)]==_0x4fa83b(0xa4))var _0x145061=users[_0x4fa83b(0xbb)];else{if(_0x4fe506[0x0][_0x4fa83b(0xac)]==_0x4fa83b(0xe0))var _0x145061=users[_0x4fa83b(0xe0)];else{if(_0x4fe506[0x0][_0x4fa83b(0xac)]==_0x4fa83b(0xa8))var _0x145061=users[_0x4fa83b(0xbe)];}}}}}}}_0x1fc6db['render'](_0x4fa83b(0xaa),{'success':_0x247dc0[_0x4fa83b(0xba)](_0x4fa83b(0xab)),'errors':_0x247dc0[_0x4fa83b(0xba)]('errors'),'role':_0x38787c,'profile':_0x2cf291,'master_shop':_0x4fe506,'user':_0x52da28,'language':_0x145061});}catch(_0x215df4){console['log'](_0x215df4);}}),router[a0_0x39c283(0x9d)](a0_0x39c283(0xea),auth,async(_0xc1e170,_0x17f023)=>{var _0x384c4b=a0_0x39c283;try{const {username:_0xe24d8e,email:_0x59988f,role:_0x49ed47}=_0xc1e170[_0x384c4b(0xb5)],_0x205c84=_0xc1e170[_0x384c4b(0xb5)],_0x83dee2=await profile[_0x384c4b(0xa2)]({'email':_0x205c84[_0x384c4b(0xa7)]}),_0x4e75db=await master_shop['find']();console[_0x384c4b(0xe5)]('master',_0x4e75db);const _0x4b0b45=_0xc1e170[_0x384c4b(0xf7)]['id'];console[_0x384c4b(0xe5)](_0x4b0b45);var _0x3d583b=['Return\x20Rooms'];const _0x1b3386=await sales_return_finished[_0x384c4b(0xf9)](_0x4b0b45),_0x13a902=await warehouse['aggregate']([{'$match':{'name':_0x1b3386[_0x384c4b(0x10e)],'room':_0x1b3386[_0x384c4b(0xf1)]}},{'$unwind':_0x384c4b(0x104)},{'$group':{'_id':_0x384c4b(0x9b),'name':{'$first':_0x384c4b(0xfb)},'product_stock':{'$first':_0x384c4b(0x110)},'bay':{'$first':_0x384c4b(0xc5)},'bin':{'$first':_0x384c4b(0xcb)},'type':{'$first':_0x384c4b(0xc7)},'floorlevel':{'$first':_0x384c4b(0xb6)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x384c4b(0xc3)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]);console[_0x384c4b(0xe5)](_0x13a902);const _0x4fdada=await warehouse[_0x384c4b(0xf8)]([{'$match':{'status':_0x384c4b(0xb1),'warehouse_category':_0x384c4b(0xf0)}},{'$group':{'_id':_0x384c4b(0x10f),'name':{'$first':_0x384c4b(0x10f)}}},{'$sort':{'name':0x1}}]),_0x4429b6=await warehouse['aggregate']([{'$match':{'status':_0x384c4b(0xb1),'name':_0x384c4b(0xde)}},{'$group':{'_id':_0x384c4b(0x10f),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x52b465=await product[_0x384c4b(0xd1)]({});if(_0x4e75db[0x0][_0x384c4b(0xac)]==_0x384c4b(0xe6)){var _0x1eabf2=users[_0x384c4b(0xed)];console['log'](_0x1eabf2);}else{if(_0x4e75db[0x0]['language']==_0x384c4b(0xae))var _0x1eabf2=users[_0x384c4b(0xae)];else{if(_0x4e75db[0x0]['language']=='German')var _0x1eabf2=users[_0x384c4b(0xca)];else{if(_0x4e75db[0x0]['language']==_0x384c4b(0x10c))var _0x1eabf2=users['Spanish'];else{if(_0x4e75db[0x0][_0x384c4b(0xac)]=='French')var _0x1eabf2=users[_0x384c4b(0xb9)];else{if(_0x4e75db[0x0][_0x384c4b(0xac)]=='Portuguese\x20(BR)')var _0x1eabf2=users[_0x384c4b(0xbb)];else{if(_0x4e75db[0x0][_0x384c4b(0xac)]=='Chinese')var _0x1eabf2=users[_0x384c4b(0xe0)];else{if(_0x4e75db[0x0][_0x384c4b(0xac)]==_0x384c4b(0xa8))var _0x1eabf2=users[_0x384c4b(0xbe)];}}}}}}}_0x17f023[_0x384c4b(0x106)]('return_sale_edit_finished',{'success':_0xc1e170[_0x384c4b(0xba)](_0x384c4b(0xab)),'errors':_0xc1e170[_0x384c4b(0xba)]('errors'),'role':_0x205c84,'profile':_0x83dee2,'master_shop':_0x4e75db,'user':_0x1b3386,'stock':_0x13a902,'unit':_0x52b465,'language':_0x1eabf2,'warehouses':_0x4fdada,'rooms':_0x3d583b,'warehouse_QA':_0x4429b6});}catch(_0x2730c2){console['log'](_0x2730c2);}}),router[a0_0x39c283(0xd2)](a0_0x39c283(0xea),auth,async(_0x2edc85,_0x18490a)=>{var _0x4b52aa=a0_0x39c283;if(_0x2edc85['body'][_0x4b52aa(0xb0)]=='QA')try{const _0x516684=_0x2edc85[_0x4b52aa(0xf7)]['id'],_0x3f71b7=await sales_return[_0x4b52aa(0xa2)]({'invoice':_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xe7)]}),_0x3919b1=await warehouse[_0x4b52aa(0xa2)]({'name':_0x3f71b7[_0x4b52aa(0x10e)],'room':_0x3f71b7[_0x4b52aa(0xf1)]}),{invoice:_0xe1ebaf,customer:_0x1deedc,date:_0x21c4e5,warehouse_name:_0x167a2f,product_name:_0x21871e,primary_code:_0x5a4fd1,secondary_code:_0x5779ff,product_code:_0x57d042,sales_quantity:_0x44fd07,stocks:_0x436e2c,return_qty:_0x265ed2,note:_0x1e025d,to_warehouse_name_QA:_0x3142fc,to_Room_name_QA:_0x7d1249}=_0x2edc85[_0x4b52aa(0x10b)];if(typeof product_name_QA=='string')var _0x46f08d=[_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xe3)]],_0x104b5b=[_0x2edc85[_0x4b52aa(0x10b)]['primary_code_QA']],_0x1dcda3=[_0x2edc85[_0x4b52aa(0x10b)]['secondary_code_QA']],_0x53bf35=[_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xdf)]],_0x4bf54d=[_0x2edc85[_0x4b52aa(0x10b)]['sales_quantity_QA']],_0x383be1=[_0x2edc85[_0x4b52aa(0x10b)]['stocks_QA']],_0x3fb6dc=[_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0x107)]];else var _0x46f08d=[..._0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xe3)]],_0x104b5b=[..._0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xa9)]],_0x1dcda3=[..._0x2edc85[_0x4b52aa(0x10b)]['secondary_code_QA']],_0x53bf35=[..._0x2edc85[_0x4b52aa(0x10b)]['product_code_QA']],_0x4bf54d=[..._0x2edc85['body']['sales_quantity_QA']],_0x383be1=[..._0x2edc85[_0x4b52aa(0x10b)]['stocks_QA']],_0x3fb6dc=[..._0x2edc85[_0x4b52aa(0x10b)]['return_qty_QA']];const _0x2ddbdc=_0x46f08d[_0x4b52aa(0xe2)](_0x505c43=>{return _0x505c43={'product_name':_0x505c43};});_0x104b5b[_0x4b52aa(0xd4)]((_0xac4db3,_0x14de96)=>{var _0x28066a=_0x4b52aa;_0x2ddbdc[_0x14de96][_0x28066a(0xcd)]=_0xac4db3;}),_0x1dcda3[_0x4b52aa(0xd4)]((_0x4a2c92,_0x4cbc7b)=>{_0x2ddbdc[_0x4cbc7b]['secondary_code']=_0x4a2c92;}),_0x53bf35[_0x4b52aa(0xd4)]((_0x509f7b,_0x2aabe9)=>{var _0x241a38=_0x4b52aa;_0x2ddbdc[_0x2aabe9][_0x241a38(0xda)]=_0x509f7b;}),_0x4bf54d[_0x4b52aa(0xd4)]((_0x8f8739,_0x557179)=>{_0x2ddbdc[_0x557179]['sale_qty']=_0x8f8739;}),_0x383be1[_0x4b52aa(0xd4)]((_0x1e3ada,_0x357bee)=>{var _0x101fda=_0x4b52aa;_0x2ddbdc[_0x357bee][_0x101fda(0xa5)]=_0x1e3ada;}),_0x3fb6dc[_0x4b52aa(0xd4)]((_0x48b1b4,_0x42bf9a)=>{var _0x49b622=_0x4b52aa;_0x2ddbdc[_0x42bf9a][_0x49b622(0xbc)]=_0x48b1b4;}),_0x3f71b7['return_sale_QA'][_0x4b52aa(0xd4)](_0x1803c5=>{var _0x393fde=_0x4b52aa;const _0xd3495d=_0x3919b1[_0x393fde(0xa0)][_0x393fde(0xe2)](_0x2a69ee=>{var _0x38f304=_0x393fde;_0x2a69ee['product_name']==_0x1803c5[_0x38f304(0xa6)]&&(_0x2a69ee[_0x38f304(0xc4)]=parseInt(_0x2a69ee[_0x38f304(0xc4)])+parseInt(_0x1803c5['return_qty']));});}),await _0x3919b1[_0x4b52aa(0xb4)](),_0x3f71b7[_0x4b52aa(0xe7)]=_0xe1ebaf,_0x3f71b7[_0x4b52aa(0xa1)]=_0x1deedc,_0x3f71b7[_0x4b52aa(0x9c)]=_0x21c4e5,_0x3f71b7[_0x4b52aa(0xcc)]=_0x167a2f,_0x3f71b7['return_sale_QA']=_0x2ddbdc,_0x3f71b7[_0x4b52aa(0xbd)]=_0x1e025d,_0x3f71b7[_0x4b52aa(0x10e)]=_0x3142fc,_0x3f71b7[_0x4b52aa(0xf1)]=_0x7d1249;const _0x1e14b5=await _0x3f71b7['save'](),_0x277889=await c_payment_data[_0x4b52aa(0xa2)]({'invoice':_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xe7)],'reason':_0x4b52aa(0xad)});_0x277889[_0x4b52aa(0x103)]=_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0x103)],_0x277889[_0x4b52aa(0x9c)]=_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0x9c)],await _0x277889['save'](),_0x2edc85['flash'](_0x4b52aa(0xab),'purchase\x20return\x20successfully'),_0x18490a['redirect'](_0x4b52aa(0x10a));}catch(_0x24326d){console[_0x4b52aa(0xe5)](_0x24326d),_0x18490a[_0x4b52aa(0xef)](0xc8)['json']({'message':_0x24326d['message']});}else try{const _0xbc2abb=_0x2edc85['params']['id'];console[_0x4b52aa(0xe5)](_0xbc2abb);const _0x14b57d=await sales_return[_0x4b52aa(0xa2)]({'invoice':_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xe7)]});console[_0x4b52aa(0xe5)](_0x4b52aa(0xd3),_0x14b57d);const _0x3e9e85=await warehouse[_0x4b52aa(0xa2)]({'name':_0x14b57d[_0x4b52aa(0x10e)],'room':_0x14b57d[_0x4b52aa(0xf1)]});console[_0x4b52aa(0xe5)](_0x4b52aa(0xfa),_0x3e9e85);const {invoice:_0x460367,customer:_0x7193f3,date:_0x4efa50,warehouse_name:_0x428c51,product_name:_0x208634,primary_code:_0x422226,secondary_code:_0x1001a3,product_code:_0x5346cc,sales_quantity:_0xd3a786,stocks:_0x2b58f2,return_qty:_0x115e6f,note:_0x529826,to_warehouse_name:_0x5384ac,to_Room_name:_0x4decf0}=_0x2edc85['body'];console[_0x4b52aa(0xe5)](_0x2edc85[_0x4b52aa(0x10b)]);if(typeof _0x208634==_0x4b52aa(0xeb))var _0x46f08d=[_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xa6)]],_0x104b5b=[_0x2edc85[_0x4b52aa(0x10b)]['primary_code']],_0x1dcda3=[_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xce)]],_0x53bf35=[_0x2edc85[_0x4b52aa(0x10b)]['product_code']],_0x4bf54d=[_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xa3)]],_0x383be1=[_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xf4)]],_0x3fb6dc=[_0x2edc85['body']['return_qty']],_0x29c28b=[_0x2edc85['body'][_0x4b52aa(0x105)]],_0x19dd38=[_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xfc)]],_0x3f55a7=[_0x2edc85['body'][_0x4b52aa(0xe1)]],_0x581a8e=[_0x2edc85['body'][_0x4b52aa(0xc9)]];else var _0x46f08d=[..._0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xa6)]],_0x104b5b=[..._0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xcd)]],_0x1dcda3=[..._0x2edc85[_0x4b52aa(0x10b)]['secondary_code']],_0x53bf35=[..._0x2edc85[_0x4b52aa(0x10b)]['product_code']],_0x4bf54d=[..._0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xa3)]],_0x383be1=[..._0x2edc85['body'][_0x4b52aa(0xf4)]],_0x3fb6dc=[..._0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xbc)]],_0x29c28b=[..._0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0x105)]],_0x19dd38=[..._0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xfc)]],_0x3f55a7=[..._0x2edc85['body'][_0x4b52aa(0xe1)]],_0x581a8e=[..._0x2edc85['body'][_0x4b52aa(0xc9)]];const _0x191566=_0x46f08d[_0x4b52aa(0xe2)](_0xb8dbd=>{return _0xb8dbd={'product_name':_0xb8dbd};});_0x104b5b[_0x4b52aa(0xd4)]((_0x30ead7,_0x436ae7)=>{var _0x5ef88a=_0x4b52aa;_0x191566[_0x436ae7][_0x5ef88a(0xcd)]=_0x30ead7;}),_0x1dcda3[_0x4b52aa(0xd4)]((_0x289e48,_0x464fe2)=>{_0x191566[_0x464fe2]['secondary_code']=_0x289e48;}),_0x53bf35[_0x4b52aa(0xd4)]((_0x10613b,_0x4252ed)=>{_0x191566[_0x4252ed]['product_code']=_0x10613b;}),_0x4bf54d['forEach']((_0x376779,_0x3a3c60)=>{var _0xe3ea1=_0x4b52aa;_0x191566[_0x3a3c60][_0xe3ea1(0xb3)]=_0x376779;}),_0x383be1['forEach']((_0x5ea8cb,_0x719246)=>{_0x191566[_0x719246]['stock']=_0x5ea8cb;}),_0x3fb6dc[_0x4b52aa(0xd4)]((_0x3e4199,_0x4c1d2e)=>{_0x191566[_0x4c1d2e]['return_qty']=_0x3e4199;}),_0x29c28b[_0x4b52aa(0xd4)]((_0x39b3ab,_0x2c9c17)=>{_0x191566[_0x2c9c17]['bay']=_0x39b3ab;}),_0x19dd38[_0x4b52aa(0xd4)]((_0x4da353,_0x5b3bdd)=>{var _0x4a9e6c=_0x4b52aa;_0x191566[_0x5b3bdd][_0x4a9e6c(0xfc)]=_0x4da353;}),_0x3f55a7[_0x4b52aa(0xd4)]((_0x5e00b4,_0x2954be)=>{var _0x2a0896=_0x4b52aa;_0x191566[_0x2954be][_0x2a0896(0xd0)]=_0x5e00b4;}),_0x581a8e[_0x4b52aa(0xd4)]((_0x4ecb4d,_0x2113b9)=>{var _0x55094d=_0x4b52aa;_0x191566[_0x2113b9][_0x55094d(0xc9)]=_0x4ecb4d;});var _0x40d3d5=0x0;_0x191566[_0x4b52aa(0xd4)](_0x4e8574=>{var _0x4f0a0d=_0x4b52aa;console['log'](_0x4f0a0d(0xf6),_0x4e8574),(parseInt(_0x4e8574[_0x4f0a0d(0xb3)])<parseInt(_0x4e8574[_0x4f0a0d(0xbc)])||parseInt(_0x4e8574[_0x4f0a0d(0xa5)])<parseInt(_0x4e8574[_0x4f0a0d(0xbc)])&&parseInt(_0x4e8574[_0x4f0a0d(0xb3)])>parseInt(_0x4e8574['return_qty'])||parseInt(_0x4e8574[_0x4f0a0d(0xbc)])==0x0)&&_0x40d3d5++;});if(_0x40d3d5!=0x0)return _0x2edc85['flash'](_0x4b52aa(0xaf),_0x4b52aa(0xe8)),_0x18490a['redirect'](_0x4b52aa(0xf5));_0x14b57d[_0x4b52aa(0x9e)]['forEach'](_0x173b51=>{var _0x2e972e=_0x4b52aa;const _0x2c0cb4=_0x3e9e85[_0x2e972e(0xa0)][_0x2e972e(0xe2)](_0x290a3a=>{var _0x40174e=_0x2e972e;_0x290a3a[_0x40174e(0xa6)]==_0x173b51[_0x40174e(0xa6)]&&_0x290a3a[_0x40174e(0xc9)]==_0x173b51[_0x40174e(0xc9)]&&_0x290a3a[_0x40174e(0xd0)]==_0x173b51[_0x40174e(0xd0)]&&_0x290a3a['bin']==_0x173b51[_0x40174e(0xfc)]&&_0x290a3a[_0x40174e(0x105)]==_0x173b51[_0x40174e(0x105)]&&(_0x290a3a[_0x40174e(0xc4)]=parseInt(_0x290a3a[_0x40174e(0xc4)])+parseInt(_0x173b51[_0x40174e(0xbc)]));});}),console[_0x4b52aa(0xe5)]('old_warehouse_data',_0x3e9e85),await _0x3e9e85[_0x4b52aa(0xb4)](),_0x14b57d[_0x4b52aa(0xe7)]=_0x460367,_0x14b57d[_0x4b52aa(0xa1)]=_0x7193f3,_0x14b57d['date']=_0x4efa50,_0x14b57d[_0x4b52aa(0xcc)]=_0x428c51,_0x14b57d[_0x4b52aa(0x9e)]=_0x191566,_0x14b57d[_0x4b52aa(0xbd)]=_0x529826,_0x14b57d[_0x4b52aa(0x10e)]=_0x5384ac,_0x14b57d[_0x4b52aa(0xf1)]=_0x4decf0;const _0x2f3e32=await _0x14b57d['save']();console[_0x4b52aa(0xe5)](_0x4b52aa(0x10d),_0x2f3e32);const _0xa40d74=await c_payment_data[_0x4b52aa(0xa2)]({'invoice':_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0xe7)],'reason':_0x4b52aa(0xad)});_0xa40d74['suppliers']=_0x2edc85[_0x4b52aa(0x10b)][_0x4b52aa(0x103)],_0xa40d74[_0x4b52aa(0x9c)]=_0x2edc85['body'][_0x4b52aa(0x9c)],await _0xa40d74[_0x4b52aa(0xb4)](),_0x2edc85[_0x4b52aa(0xba)](_0x4b52aa(0xab),_0x4b52aa(0xe9)),_0x18490a[_0x4b52aa(0xd9)](_0x4b52aa(0xfe));}catch(_0x38982a){console[_0x4b52aa(0xe5)](_0x38982a),_0x18490a[_0x4b52aa(0xef)](0xc8)[_0x4b52aa(0xd6)]({'message':_0x38982a[_0x4b52aa(0x101)]});}}),router[a0_0x39c283(0xd2)](a0_0x39c283(0xc0),auth,async(_0x144107,_0xe4f7fe)=>{var _0x1e52d3=a0_0x39c283;try{const _0x5d4b85=_0x144107[_0x1e52d3(0xf7)]['id'],{invoice:_0x47b3ce,customer:_0xcfc220,payable_to_customer:_0x418877,paid_amount:_0xdff360}=_0x144107[_0x1e52d3(0x10b)],_0x24baba=await sales_return['findById'](_0x5d4b85);console[_0x1e52d3(0xe5)](_0x1e52d3(0xff),_0x24baba),console[_0x1e52d3(0xe5)](_0x418877),console[_0x1e52d3(0xe5)](_0xdff360);var _0xf178c1=_0x418877-_0xdff360;console[_0x1e52d3(0xe5)](_0x1e52d3(0xf3),_0xf178c1),_0x24baba[_0x1e52d3(0xcf)]=parseFloat(_0xdff360)+parseFloat(_0x24baba['paid_amount']),_0x24baba[_0x1e52d3(0x102)]=_0xf178c1,console[_0x1e52d3(0xe5)](_0x24baba);const _0x53a3f5=await _0x24baba[_0x1e52d3(0xb4)]();console[_0x1e52d3(0xe5)](0x1b207);const _0x5c7e36=await c_payment_data[_0x1e52d3(0xa2)]({'invoice':_0x144107[_0x1e52d3(0x10b)][_0x1e52d3(0xe7)],'reason':_0x1e52d3(0xad)});console[_0x1e52d3(0xe5)](_0x1e52d3(0xbf),_0x5c7e36),_0x5c7e36[_0x1e52d3(0xc1)]=_0xf178c1,await _0x5c7e36[_0x1e52d3(0xb4)]();let _0x11ed15=new Date(),_0x53d9dd=('0'+_0x11ed15['getDate']())[_0x1e52d3(0xb2)](-0x2),_0x3d2c20=('0'+(_0x11ed15['getMonth']()+0x1))[_0x1e52d3(0xb2)](-0x2),_0x50d8af=_0x11ed15[_0x1e52d3(0xb7)](),_0x4a1e5f=_0x50d8af+'-'+_0x3d2c20+'-'+_0x53d9dd;const _0x18139e=new customer_payment({'invoice':_0x47b3ce,'date':_0x50d8af+'-'+_0x3d2c20+'-'+_0x53d9dd,'customer':_0xcfc220,'reason':'Returned\x20Payment\x20For\x20Sale\x20Return','amount':_0xdff360}),_0x4ef3e8=await _0x18139e[_0x1e52d3(0xb4)]();_0x144107[_0x1e52d3(0xba)](_0x1e52d3(0xab),_0x1e52d3(0xc2)),_0xe4f7fe[_0x1e52d3(0xd9)](_0x1e52d3(0xfe));}catch(_0x393c80){console['log'](_0x393c80);}}),router['get']('/invoice/:id',auth,async(_0x22da12,_0x4a3ad5)=>{var _0x5351b1=a0_0x39c283;try{const {username:_0x3a406b,email:_0x1b26e7,role:_0x30e392}=_0x22da12[_0x5351b1(0xb5)],_0x5e8bc9=_0x22da12[_0x5351b1(0xb5)],_0xb1ed6=await profile[_0x5351b1(0xa2)]({'email':_0x5e8bc9[_0x5351b1(0xa7)]}),_0x599132=await master_shop[_0x5351b1(0xd1)]();console['log']('master',_0x599132);const _0x3504a6=_0x22da12[_0x5351b1(0xf7)]['id'],_0xc628f2=await sales_return[_0x5351b1(0xf9)](_0x3504a6);console[_0x5351b1(0xe5)](_0xc628f2);const _0x45806f=await customer[_0x5351b1(0xa2)]({'name':_0xc628f2[_0x5351b1(0xa1)]});console['log'](_0x45806f);if(_0x599132[0x0][_0x5351b1(0xac)]==_0x5351b1(0xe6)){var _0x50f9da=users['English'];console[_0x5351b1(0xe5)](_0x50f9da);}else{if(_0x599132[0x0]['language']==_0x5351b1(0xae))var _0x50f9da=users[_0x5351b1(0xae)];else{if(_0x599132[0x0][_0x5351b1(0xac)]=='German')var _0x50f9da=users[_0x5351b1(0xca)];else{if(_0x599132[0x0][_0x5351b1(0xac)]==_0x5351b1(0x10c))var _0x50f9da=users['Spanish'];else{if(_0x599132[0x0][_0x5351b1(0xac)]==_0x5351b1(0xb9))var _0x50f9da=users['French'];else{if(_0x599132[0x0]['language']=='Portuguese\x20(BR)')var _0x50f9da=users[_0x5351b1(0xbb)];else{if(_0x599132[0x0][_0x5351b1(0xac)]=='Chinese')var _0x50f9da=users[_0x5351b1(0xe0)];else{if(_0x599132[0x0]['language']==_0x5351b1(0xa8))var _0x50f9da=users[_0x5351b1(0xbe)];}}}}}}}_0x4a3ad5[_0x5351b1(0x106)]('sales_return_invoice',{'success':_0x22da12[_0x5351b1(0xba)](_0x5351b1(0xab)),'errors':_0x22da12[_0x5351b1(0xba)]('errors'),'role':_0x5e8bc9,'profile':_0xb1ed6,'master_shop':_0x599132,'customers':_0x45806f,'sales':_0xc628f2,'language':_0x50f9da});}catch(_0x2060a3){console[_0x5351b1(0xe5)](_0x2060a3);}}),module[a0_0x39c283(0xdd)]=router;