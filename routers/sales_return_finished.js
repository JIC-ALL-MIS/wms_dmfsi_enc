var a0_0x4c6e00=a0_0x1ba6;(function(_0x352abf,_0x1f5f21){var _0x538657=a0_0x1ba6,_0x2727b7=_0x352abf();while(!![]){try{var _0x54082a=-parseInt(_0x538657(0x18d))/0x1+parseInt(_0x538657(0x13a))/0x2*(-parseInt(_0x538657(0x18f))/0x3)+parseInt(_0x538657(0x142))/0x4*(-parseInt(_0x538657(0x12b))/0x5)+-parseInt(_0x538657(0x145))/0x6+parseInt(_0x538657(0x176))/0x7+-parseInt(_0x538657(0x178))/0x8*(-parseInt(_0x538657(0x139))/0x9)+parseInt(_0x538657(0x137))/0xa*(parseInt(_0x538657(0x135))/0xb);if(_0x54082a===_0x1f5f21)break;else _0x2727b7['push'](_0x2727b7['shift']());}catch(_0x1cd374){_0x2727b7['push'](_0x2727b7['shift']());}}}(a0_0x1f82,0x740d9));const express=require(a0_0x4c6e00(0x16f)),app=express(),router=express[a0_0x4c6e00(0x151)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x4c6e00(0x177)),auth=require(a0_0x4c6e00(0x130)),users=require(a0_0x4c6e00(0x159));function a0_0x1ba6(_0x190ab2,_0x2f236a){var _0x1f8230=a0_0x1f82();return a0_0x1ba6=function(_0x1ba642,_0x5ab18b){_0x1ba642=_0x1ba642-0x120;var _0x306c39=_0x1f8230[_0x1ba642];return _0x306c39;},a0_0x1ba6(_0x190ab2,_0x2f236a);}function a0_0x1f82(){var _0x526246=['product_code_QA','$product_details.type','status','types','French','$product_details.secondary_code','../public/language/languages.json','findById','Finished\x20Goods','get','Portuguese','Arabic\x20(ae)','secondary_code_QA','product_stock','sale_qty','Returned\x20Payment\x20For\x20Sale\x20Return','warehouse_name','bin','English\x20(US)','secondary_code','English','paid_amount','map','Arabic','product_name','German','product_code','forEach','express','aggregate','findOne','stocks','success','$product_details.product_stock','message','5490730KqIWmc','../models/all_models','70384NUEmKQ','invoice','Sale\x20Return','body','primary_code_QA','customer_docs','getFullYear','Return\x20Rooms','flash','product_name_QA','stock','sales_return_invoice','email','save','$name','$product_details.product_name','exports','old_warehouse_data','return_sale','purchase\x20return\x20successfully','Portuguese\x20(BR)','70659IeTOTK','old_data','753lkugiA','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','Spanish','return_sale_QA','language','string','/sales_return_finished/view','note','/sales_return/view','params','foreach\x20newproduct','find','/invoice/:id','ToWarehouse','ToRoom','Hindi','getMonth','$product_details.floorlevel','5onoQfb','back','sales_return_finished','post','user','../middleware/auth','type','$product_details.bay','suppliers','/view/:id','158785IvjujL','bay','400lbLvNL','return_sale_edit_finished','54oPmsRT','942BEOVnL','date','Enabled','$product_details.storage','log','getDate','new\x20new_data','payment\x20successfull','20220zmDrZf','master','redirect','4471740JIQvIY','render','sales_quantity','amount','floorlevel','errors','customer','return_qty','primary_code','name','Chinese','slice','Router','c_payment'];a0_0x1f82=function(){return _0x526246;};return a0_0x1f82();}router['get']('/view',auth,async(_0x5d29a5,_0x30e450)=>{var _0x412bdc=a0_0x4c6e00;try{const {username:_0x16f4ff,email:_0x4dff81,role:_0x17ba56}=_0x5d29a5['user'],_0x29ea0e=_0x5d29a5['user'],_0x795a6f=await profile[_0x412bdc(0x171)]({'email':_0x29ea0e['email']}),_0x5b70ec=await master_shop[_0x412bdc(0x124)](),_0x557038=await sales_return_finished['aggregate']([{'$lookup':{'from':'customers','localField':_0x412bdc(0x14b),'foreignField':_0x412bdc(0x14e),'as':_0x412bdc(0x17d)}},{'$unwind':'$customer_docs'}]);if(_0x5b70ec[0x0][_0x412bdc(0x193)]==_0x412bdc(0x165)){var _0x29dcd9=users['English'];console[_0x412bdc(0x13e)](_0x29dcd9);}else{if(_0x5b70ec[0x0][_0x412bdc(0x193)]==_0x412bdc(0x128))var _0x29dcd9=users[_0x412bdc(0x128)];else{if(_0x5b70ec[0x0]['language']=='German')var _0x29dcd9=users[_0x412bdc(0x16c)];else{if(_0x5b70ec[0x0]['language']==_0x412bdc(0x191))var _0x29dcd9=users[_0x412bdc(0x191)];else{if(_0x5b70ec[0x0][_0x412bdc(0x193)]==_0x412bdc(0x157))var _0x29dcd9=users[_0x412bdc(0x157)];else{if(_0x5b70ec[0x0][_0x412bdc(0x193)]==_0x412bdc(0x18c))var _0x29dcd9=users[_0x412bdc(0x15d)];else{if(_0x5b70ec[0x0][_0x412bdc(0x193)]=='Chinese')var _0x29dcd9=users['Chinese'];else{if(_0x5b70ec[0x0][_0x412bdc(0x193)]==_0x412bdc(0x15e))var _0x29dcd9=users[_0x412bdc(0x16a)];}}}}}}}_0x30e450[_0x412bdc(0x146)](_0x412bdc(0x12d),{'success':_0x5d29a5['flash']('success'),'errors':_0x5d29a5[_0x412bdc(0x180)](_0x412bdc(0x14a)),'role':_0x29ea0e,'profile':_0x795a6f,'master_shop':_0x5b70ec,'user':_0x557038,'language':_0x29dcd9});}catch(_0x2db6f4){console[_0x412bdc(0x13e)](_0x2db6f4);}}),router[a0_0x4c6e00(0x15c)](a0_0x4c6e00(0x134),auth,async(_0x4a4c57,_0x29d403)=>{var _0x8f2319=a0_0x4c6e00;try{const {username:_0x23bc92,email:_0x19fe43,role:_0x143954}=_0x4a4c57[_0x8f2319(0x12f)],_0x8b30ea=_0x4a4c57['user'],_0x300992=await profile[_0x8f2319(0x171)]({'email':_0x8b30ea[_0x8f2319(0x184)]}),_0x55ed1e=await master_shop[_0x8f2319(0x124)]();console[_0x8f2319(0x13e)](_0x8f2319(0x143),_0x55ed1e);const _0x508b84=_0x4a4c57[_0x8f2319(0x122)]['id'];console['log'](_0x508b84);var _0x5d4b77=[_0x8f2319(0x17f)];const _0x4ae5db=await sales_return_finished[_0x8f2319(0x15a)](_0x508b84),_0x5f4cb3=await warehouse[_0x8f2319(0x170)]([{'$match':{'name':_0x4ae5db[_0x8f2319(0x126)],'room':_0x4ae5db[_0x8f2319(0x127)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x8f2319(0x187)},'product_stock':{'$first':_0x8f2319(0x174)},'bay':{'$first':_0x8f2319(0x132)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x8f2319(0x154)},'floorlevel':{'$first':_0x8f2319(0x12a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x8f2319(0x158)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x8f2319(0x13d)},'rack':{'$first':'$product_details.rack'}}}]);console[_0x8f2319(0x13e)](_0x5f4cb3);const _0x433dbb=await warehouse[_0x8f2319(0x170)]([{'$match':{'status':'Enabled','warehouse_category':_0x8f2319(0x15b)}},{'$group':{'_id':_0x8f2319(0x186),'name':{'$first':_0x8f2319(0x186)}}},{'$sort':{'name':0x1}}]),_0x121e1e=await warehouse[_0x8f2319(0x170)]([{'$match':{'status':_0x8f2319(0x13c),'name':'QA\x20Warehouse'}},{'$group':{'_id':_0x8f2319(0x186),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x59b90d=await product[_0x8f2319(0x124)]({});if(_0x55ed1e[0x0]['language']==_0x8f2319(0x165)){var _0x58b809=users[_0x8f2319(0x167)];console[_0x8f2319(0x13e)](_0x58b809);}else{if(_0x55ed1e[0x0][_0x8f2319(0x193)]==_0x8f2319(0x128))var _0x58b809=users['Hindi'];else{if(_0x55ed1e[0x0]['language']==_0x8f2319(0x16c))var _0x58b809=users[_0x8f2319(0x16c)];else{if(_0x55ed1e[0x0][_0x8f2319(0x193)]=='Spanish')var _0x58b809=users[_0x8f2319(0x191)];else{if(_0x55ed1e[0x0][_0x8f2319(0x193)]==_0x8f2319(0x157))var _0x58b809=users['French'];else{if(_0x55ed1e[0x0]['language']==_0x8f2319(0x18c))var _0x58b809=users[_0x8f2319(0x15d)];else{if(_0x55ed1e[0x0][_0x8f2319(0x193)]=='Chinese')var _0x58b809=users['Chinese'];else{if(_0x55ed1e[0x0][_0x8f2319(0x193)]==_0x8f2319(0x15e))var _0x58b809=users[_0x8f2319(0x16a)];}}}}}}}_0x29d403[_0x8f2319(0x146)](_0x8f2319(0x138),{'success':_0x4a4c57[_0x8f2319(0x180)](_0x8f2319(0x173)),'errors':_0x4a4c57[_0x8f2319(0x180)](_0x8f2319(0x14a)),'role':_0x8b30ea,'profile':_0x300992,'master_shop':_0x55ed1e,'user':_0x4ae5db,'stock':_0x5f4cb3,'unit':_0x59b90d,'language':_0x58b809,'warehouses':_0x433dbb,'rooms':_0x5d4b77,'warehouse_QA':_0x121e1e});}catch(_0x485b95){console[_0x8f2319(0x13e)](_0x485b95);}}),router[a0_0x4c6e00(0x12e)](a0_0x4c6e00(0x134),auth,async(_0x57cef4,_0x2aa5cb)=>{var _0xe86f70=a0_0x4c6e00;if(_0x57cef4[_0xe86f70(0x17b)]['for_categorize']=='QA')try{const _0x487502=_0x57cef4[_0xe86f70(0x122)]['id'],_0x1142e9=await sales_return[_0xe86f70(0x171)]({'invoice':_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x179)]}),_0x1421e0=await warehouse[_0xe86f70(0x171)]({'name':_0x1142e9[_0xe86f70(0x126)],'room':_0x1142e9[_0xe86f70(0x127)]}),{invoice:_0x3f992a,customer:_0x883a41,date:_0x59a145,warehouse_name:_0x563300,product_name:_0x15afee,primary_code:_0x2f1cd7,secondary_code:_0x2f2e15,product_code:_0x263917,sales_quantity:_0x592cd5,stocks:_0x280da6,return_qty:_0x457d37,note:_0x269460,to_warehouse_name_QA:_0x3786b7,to_Room_name_QA:_0x5258bd}=_0x57cef4[_0xe86f70(0x17b)];if(typeof product_name_QA==_0xe86f70(0x194))var _0x16bcc2=[_0x57cef4['body'][_0xe86f70(0x181)]],_0x5b1fd0=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x17c)]],_0x4d47e6=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x15f)]],_0x5bdb8d=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x153)]],_0x395c20=[_0x57cef4[_0xe86f70(0x17b)]['sales_quantity_QA']],_0x347c7e=[_0x57cef4['body']['stocks_QA']],_0x1d1b7c=[_0x57cef4['body']['return_qty_QA']];else var _0x16bcc2=[..._0x57cef4['body'][_0xe86f70(0x181)]],_0x5b1fd0=[..._0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x17c)]],_0x4d47e6=[..._0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x15f)]],_0x5bdb8d=[..._0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x153)]],_0x395c20=[..._0x57cef4[_0xe86f70(0x17b)]['sales_quantity_QA']],_0x347c7e=[..._0x57cef4[_0xe86f70(0x17b)]['stocks_QA']],_0x1d1b7c=[..._0x57cef4[_0xe86f70(0x17b)]['return_qty_QA']];const _0xc8c8a5=_0x16bcc2[_0xe86f70(0x169)](_0x371977=>{return _0x371977={'product_name':_0x371977};});_0x5b1fd0[_0xe86f70(0x16e)]((_0x34842c,_0x329ca7)=>{var _0x34acd7=_0xe86f70;_0xc8c8a5[_0x329ca7][_0x34acd7(0x14d)]=_0x34842c;}),_0x4d47e6['forEach']((_0x133556,_0x1db76b)=>{var _0x1dfc21=_0xe86f70;_0xc8c8a5[_0x1db76b][_0x1dfc21(0x166)]=_0x133556;}),_0x5bdb8d[_0xe86f70(0x16e)]((_0x3d4253,_0x27b490)=>{var _0x5cb793=_0xe86f70;_0xc8c8a5[_0x27b490][_0x5cb793(0x16d)]=_0x3d4253;}),_0x395c20[_0xe86f70(0x16e)]((_0x4daa8f,_0xb3e4e2)=>{_0xc8c8a5[_0xb3e4e2]['sale_qty']=_0x4daa8f;}),_0x347c7e[_0xe86f70(0x16e)]((_0x303149,_0x1065d9)=>{_0xc8c8a5[_0x1065d9]['stock']=_0x303149;}),_0x1d1b7c[_0xe86f70(0x16e)]((_0x57cb85,_0x4ef489)=>{_0xc8c8a5[_0x4ef489]['return_qty']=_0x57cb85;}),_0x1142e9[_0xe86f70(0x192)][_0xe86f70(0x16e)](_0x4edc28=>{var _0x4672c1=_0xe86f70;const _0x1d5c52=_0x1421e0['product_details'][_0x4672c1(0x169)](_0x44d27e=>{var _0x4296df=_0x4672c1;_0x44d27e[_0x4296df(0x16b)]==_0x4edc28[_0x4296df(0x16b)]&&(_0x44d27e[_0x4296df(0x160)]=parseInt(_0x44d27e[_0x4296df(0x160)])+parseInt(_0x4edc28[_0x4296df(0x14c)]));});}),await _0x1421e0[_0xe86f70(0x185)](),_0x1142e9['invoice']=_0x3f992a,_0x1142e9[_0xe86f70(0x14b)]=_0x883a41,_0x1142e9[_0xe86f70(0x13b)]=_0x59a145,_0x1142e9[_0xe86f70(0x163)]=_0x563300,_0x1142e9[_0xe86f70(0x192)]=_0xc8c8a5,_0x1142e9[_0xe86f70(0x120)]=_0x269460,_0x1142e9['ToWarehouse']=_0x3786b7,_0x1142e9[_0xe86f70(0x127)]=_0x5258bd;const _0x1cc149=await _0x1142e9[_0xe86f70(0x185)](),_0x315375=await c_payment_data[_0xe86f70(0x171)]({'invoice':_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x179)],'reason':_0xe86f70(0x17a)});_0x315375[_0xe86f70(0x133)]=_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x133)],_0x315375['date']=_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x13b)],await _0x315375[_0xe86f70(0x185)](),_0x57cef4[_0xe86f70(0x180)](_0xe86f70(0x173),_0xe86f70(0x18b)),_0x2aa5cb[_0xe86f70(0x144)](_0xe86f70(0x195));}catch(_0x5af7ac){console[_0xe86f70(0x13e)](_0x5af7ac),_0x2aa5cb[_0xe86f70(0x155)](0xc8)['json']({'message':_0x5af7ac[_0xe86f70(0x175)]});}else try{const _0x11bed0=_0x57cef4['params']['id'];console[_0xe86f70(0x13e)](_0x11bed0);const _0x5e7299=await sales_return[_0xe86f70(0x171)]({'invoice':_0x57cef4[_0xe86f70(0x17b)]['invoice']});console['log'](_0xe86f70(0x18e),_0x5e7299);const _0x8dbeb8=await warehouse[_0xe86f70(0x171)]({'name':_0x5e7299[_0xe86f70(0x126)],'room':_0x5e7299[_0xe86f70(0x127)]});console['log'](_0xe86f70(0x189),_0x8dbeb8);const {invoice:_0x549940,customer:_0xf091cb,date:_0x4e53ca,warehouse_name:_0xd80c74,product_name:_0xac740b,primary_code:_0xf3a03d,secondary_code:_0x176fb7,product_code:_0x155e01,sales_quantity:_0x4568f8,stocks:_0x48add2,return_qty:_0x100c4c,note:_0x5c8718,to_warehouse_name:_0x1aabf4,to_Room_name:_0x44213f}=_0x57cef4[_0xe86f70(0x17b)];console[_0xe86f70(0x13e)](_0x57cef4[_0xe86f70(0x17b)]);if(typeof _0xac740b==_0xe86f70(0x194))var _0x16bcc2=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x16b)]],_0x5b1fd0=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x14d)]],_0x4d47e6=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x166)]],_0x5bdb8d=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x16d)]],_0x395c20=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x147)]],_0x347c7e=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x172)]],_0x1d1b7c=[_0x57cef4[_0xe86f70(0x17b)]['return_qty']],_0x2c8fb0=[_0x57cef4[_0xe86f70(0x17b)]['bay']],_0x1fd6ce=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x164)]],_0x585bfe=[_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x156)]],_0x1826c6=[_0x57cef4['body'][_0xe86f70(0x149)]];else var _0x16bcc2=[..._0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x16b)]],_0x5b1fd0=[..._0x57cef4[_0xe86f70(0x17b)]['primary_code']],_0x4d47e6=[..._0x57cef4[_0xe86f70(0x17b)]['secondary_code']],_0x5bdb8d=[..._0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x16d)]],_0x395c20=[..._0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x147)]],_0x347c7e=[..._0x57cef4[_0xe86f70(0x17b)]['stocks']],_0x1d1b7c=[..._0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x14c)]],_0x2c8fb0=[..._0x57cef4['body'][_0xe86f70(0x136)]],_0x1fd6ce=[..._0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x164)]],_0x585bfe=[..._0x57cef4[_0xe86f70(0x17b)]['types']],_0x1826c6=[..._0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x149)]];const _0x535fc7=_0x16bcc2[_0xe86f70(0x169)](_0x131857=>{return _0x131857={'product_name':_0x131857};});_0x5b1fd0['forEach']((_0xd63606,_0x4ee0fe)=>{var _0xc10fe7=_0xe86f70;_0x535fc7[_0x4ee0fe][_0xc10fe7(0x14d)]=_0xd63606;}),_0x4d47e6[_0xe86f70(0x16e)]((_0x5ef2d0,_0x12e2d6)=>{_0x535fc7[_0x12e2d6]['secondary_code']=_0x5ef2d0;}),_0x5bdb8d[_0xe86f70(0x16e)]((_0x2691d6,_0x394a20)=>{_0x535fc7[_0x394a20]['product_code']=_0x2691d6;}),_0x395c20[_0xe86f70(0x16e)]((_0x4a5815,_0x142490)=>{var _0x435cc1=_0xe86f70;_0x535fc7[_0x142490][_0x435cc1(0x161)]=_0x4a5815;}),_0x347c7e['forEach']((_0x705295,_0x3b4436)=>{_0x535fc7[_0x3b4436]['stock']=_0x705295;}),_0x1d1b7c[_0xe86f70(0x16e)]((_0xc5e910,_0x393fdc)=>{var _0x1149ec=_0xe86f70;_0x535fc7[_0x393fdc][_0x1149ec(0x14c)]=_0xc5e910;}),_0x2c8fb0[_0xe86f70(0x16e)]((_0x16cfcb,_0x4f9479)=>{var _0x5f09d2=_0xe86f70;_0x535fc7[_0x4f9479][_0x5f09d2(0x136)]=_0x16cfcb;}),_0x1fd6ce[_0xe86f70(0x16e)]((_0x11ab11,_0x4f6120)=>{var _0x37cd20=_0xe86f70;_0x535fc7[_0x4f6120][_0x37cd20(0x164)]=_0x11ab11;}),_0x585bfe[_0xe86f70(0x16e)]((_0x4ace1a,_0x3f8ca8)=>{var _0x280400=_0xe86f70;_0x535fc7[_0x3f8ca8][_0x280400(0x131)]=_0x4ace1a;}),_0x1826c6['forEach']((_0x403d3c,_0x465d7a)=>{var _0xf91f74=_0xe86f70;_0x535fc7[_0x465d7a][_0xf91f74(0x149)]=_0x403d3c;});var _0x5077ad=0x0;_0x535fc7[_0xe86f70(0x16e)](_0x273d12=>{var _0x273cec=_0xe86f70;console[_0x273cec(0x13e)](_0x273cec(0x123),_0x273d12),(parseInt(_0x273d12[_0x273cec(0x161)])<parseInt(_0x273d12[_0x273cec(0x14c)])||parseInt(_0x273d12[_0x273cec(0x182)])<parseInt(_0x273d12[_0x273cec(0x14c)])&&parseInt(_0x273d12[_0x273cec(0x161)])>parseInt(_0x273d12[_0x273cec(0x14c)])||parseInt(_0x273d12[_0x273cec(0x14c)])==0x0)&&_0x5077ad++;});if(_0x5077ad!=0x0)return _0x57cef4[_0xe86f70(0x180)](_0xe86f70(0x14a),_0xe86f70(0x190)),_0x2aa5cb[_0xe86f70(0x144)](_0xe86f70(0x12c));_0x5e7299[_0xe86f70(0x18a)]['forEach'](_0x120edc=>{var _0x46a61b=_0xe86f70;const _0x117bdd=_0x8dbeb8['product_details'][_0x46a61b(0x169)](_0x293e12=>{var _0x1cb04c=_0x46a61b;_0x293e12[_0x1cb04c(0x16b)]==_0x120edc[_0x1cb04c(0x16b)]&&_0x293e12['floorlevel']==_0x120edc['floorlevel']&&_0x293e12['type']==_0x120edc[_0x1cb04c(0x131)]&&_0x293e12[_0x1cb04c(0x164)]==_0x120edc['bin']&&_0x293e12['bay']==_0x120edc[_0x1cb04c(0x136)]&&(_0x293e12[_0x1cb04c(0x160)]=parseInt(_0x293e12[_0x1cb04c(0x160)])+parseInt(_0x120edc[_0x1cb04c(0x14c)]));});}),console[_0xe86f70(0x13e)](_0xe86f70(0x189),_0x8dbeb8),await _0x8dbeb8[_0xe86f70(0x185)](),_0x5e7299[_0xe86f70(0x179)]=_0x549940,_0x5e7299[_0xe86f70(0x14b)]=_0xf091cb,_0x5e7299[_0xe86f70(0x13b)]=_0x4e53ca,_0x5e7299[_0xe86f70(0x163)]=_0xd80c74,_0x5e7299['return_sale']=_0x535fc7,_0x5e7299[_0xe86f70(0x120)]=_0x5c8718,_0x5e7299['ToWarehouse']=_0x1aabf4,_0x5e7299['ToRoom']=_0x44213f;const _0xb39e15=await _0x5e7299['save']();console['log'](_0xe86f70(0x140),_0xb39e15);const _0x36756d=await c_payment_data[_0xe86f70(0x171)]({'invoice':_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x179)],'reason':_0xe86f70(0x17a)});_0x36756d['suppliers']=_0x57cef4['body']['suppliers'],_0x36756d[_0xe86f70(0x13b)]=_0x57cef4[_0xe86f70(0x17b)][_0xe86f70(0x13b)],await _0x36756d['save'](),_0x57cef4[_0xe86f70(0x180)](_0xe86f70(0x173),_0xe86f70(0x18b)),_0x2aa5cb[_0xe86f70(0x144)](_0xe86f70(0x121));}catch(_0x4be1fe){console[_0xe86f70(0x13e)](_0x4be1fe),_0x2aa5cb[_0xe86f70(0x155)](0xc8)['json']({'message':_0x4be1fe[_0xe86f70(0x175)]});}}),router[a0_0x4c6e00(0x12e)]('/give_payment/:id',auth,async(_0x1ddc01,_0xf8deb9)=>{var _0x309379=a0_0x4c6e00;try{const _0x1d12e0=_0x1ddc01[_0x309379(0x122)]['id'],{invoice:_0x47b84a,customer:_0x1a10e8,payable_to_customer:_0x9fd29a,paid_amount:_0x12cb8e}=_0x1ddc01[_0x309379(0x17b)],_0x25a1f5=await sales_return[_0x309379(0x15a)](_0x1d12e0);console[_0x309379(0x13e)]('data',_0x25a1f5),console[_0x309379(0x13e)](_0x9fd29a),console[_0x309379(0x13e)](_0x12cb8e);var _0xa49777=_0x9fd29a-_0x12cb8e;console['log']('subtract',_0xa49777),_0x25a1f5['paid_amount']=parseFloat(_0x12cb8e)+parseFloat(_0x25a1f5[_0x309379(0x168)]),_0x25a1f5['due_amount']=_0xa49777,console[_0x309379(0x13e)](_0x25a1f5);const _0x4ddd6f=await _0x25a1f5[_0x309379(0x185)]();console['log'](0x1b207);const _0x711cfa=await c_payment_data['findOne']({'invoice':_0x1ddc01[_0x309379(0x17b)][_0x309379(0x179)],'reason':'Sale\x20Return'});console[_0x309379(0x13e)](_0x309379(0x152),_0x711cfa),_0x711cfa[_0x309379(0x148)]=_0xa49777,await _0x711cfa['save']();let _0x248787=new Date(),_0x12550d=('0'+_0x248787[_0x309379(0x13f)]())[_0x309379(0x150)](-0x2),_0x2f7435=('0'+(_0x248787[_0x309379(0x129)]()+0x1))['slice'](-0x2),_0xbe4dba=_0x248787[_0x309379(0x17e)](),_0x43f223=_0xbe4dba+'-'+_0x2f7435+'-'+_0x12550d;const _0x292fe3=new customer_payment({'invoice':_0x47b84a,'date':_0xbe4dba+'-'+_0x2f7435+'-'+_0x12550d,'customer':_0x1a10e8,'reason':_0x309379(0x162),'amount':_0x12cb8e}),_0x38f1d3=await _0x292fe3['save']();_0x1ddc01[_0x309379(0x180)](_0x309379(0x173),_0x309379(0x141)),_0xf8deb9[_0x309379(0x144)](_0x309379(0x121));}catch(_0x39cdcc){console[_0x309379(0x13e)](_0x39cdcc);}}),router[a0_0x4c6e00(0x15c)](a0_0x4c6e00(0x125),auth,async(_0x236d7f,_0x162b5a)=>{var _0x23affe=a0_0x4c6e00;try{const {username:_0x5140ce,email:_0x569056,role:_0x20c36e}=_0x236d7f[_0x23affe(0x12f)],_0x297edc=_0x236d7f[_0x23affe(0x12f)],_0x343dc5=await profile['findOne']({'email':_0x297edc[_0x23affe(0x184)]}),_0x2c4ca8=await master_shop[_0x23affe(0x124)]();console[_0x23affe(0x13e)](_0x23affe(0x143),_0x2c4ca8);const _0x5df249=_0x236d7f[_0x23affe(0x122)]['id'],_0x2f674e=await sales_return[_0x23affe(0x15a)](_0x5df249);console[_0x23affe(0x13e)](_0x2f674e);const _0x3eea16=await customer[_0x23affe(0x171)]({'name':_0x2f674e[_0x23affe(0x14b)]});console['log'](_0x3eea16);if(_0x2c4ca8[0x0][_0x23affe(0x193)]==_0x23affe(0x165)){var _0x513d97=users[_0x23affe(0x167)];console[_0x23affe(0x13e)](_0x513d97);}else{if(_0x2c4ca8[0x0][_0x23affe(0x193)]==_0x23affe(0x128))var _0x513d97=users['Hindi'];else{if(_0x2c4ca8[0x0]['language']=='German')var _0x513d97=users[_0x23affe(0x16c)];else{if(_0x2c4ca8[0x0][_0x23affe(0x193)]==_0x23affe(0x191))var _0x513d97=users[_0x23affe(0x191)];else{if(_0x2c4ca8[0x0][_0x23affe(0x193)]==_0x23affe(0x157))var _0x513d97=users[_0x23affe(0x157)];else{if(_0x2c4ca8[0x0][_0x23affe(0x193)]=='Portuguese\x20(BR)')var _0x513d97=users[_0x23affe(0x15d)];else{if(_0x2c4ca8[0x0][_0x23affe(0x193)]==_0x23affe(0x14f))var _0x513d97=users['Chinese'];else{if(_0x2c4ca8[0x0]['language']=='Arabic\x20(ae)')var _0x513d97=users[_0x23affe(0x16a)];}}}}}}}_0x162b5a[_0x23affe(0x146)](_0x23affe(0x183),{'success':_0x236d7f[_0x23affe(0x180)]('success'),'errors':_0x236d7f[_0x23affe(0x180)](_0x23affe(0x14a)),'role':_0x297edc,'profile':_0x343dc5,'master_shop':_0x2c4ca8,'customers':_0x3eea16,'sales':_0x2f674e,'language':_0x513d97});}catch(_0x394061){console['log'](_0x394061);}}),module[a0_0x4c6e00(0x188)]=router;