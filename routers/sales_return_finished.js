var a0_0x536d18=a0_0x2e16;(function(_0x189a32,_0x22a2c7){var _0x3b9f6b=a0_0x2e16,_0x3505ad=_0x189a32();while(!![]){try{var _0x4aecc7=-parseInt(_0x3b9f6b(0x221))/0x1*(-parseInt(_0x3b9f6b(0x213))/0x2)+-parseInt(_0x3b9f6b(0x1f9))/0x3*(parseInt(_0x3b9f6b(0x21a))/0x4)+parseInt(_0x3b9f6b(0x1df))/0x5+parseInt(_0x3b9f6b(0x1e2))/0x6*(parseInt(_0x3b9f6b(0x24a))/0x7)+-parseInt(_0x3b9f6b(0x1ea))/0x8*(parseInt(_0x3b9f6b(0x228))/0x9)+parseInt(_0x3b9f6b(0x24d))/0xa+parseInt(_0x3b9f6b(0x238))/0xb*(-parseInt(_0x3b9f6b(0x21f))/0xc);if(_0x4aecc7===_0x22a2c7)break;else _0x3505ad['push'](_0x3505ad['shift']());}catch(_0x2105c8){_0x3505ad['push'](_0x3505ad['shift']());}}}(a0_0x15cd,0x705cb));function a0_0x2e16(_0x1541f2,_0x28310b){var _0x15cd92=a0_0x15cd();return a0_0x2e16=function(_0x2e16ee,_0x4f8277){_0x2e16ee=_0x2e16ee-0x1d5;var _0x2a4bf9=_0x15cd92[_0x2e16ee];return _0x2a4bf9;},a0_0x2e16(_0x1541f2,_0x28310b);}const express=require('express'),app=express(),router=express[a0_0x536d18(0x1e5)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x536d18(0x1d8)),auth=require('../middleware/auth'),users=require(a0_0x536d18(0x210));router[a0_0x536d18(0x205)](a0_0x536d18(0x217),auth,async(_0x3624eb,_0x4b43f0)=>{var _0x51309e=a0_0x536d18;try{const {username:_0x5bb46e,email:_0x5b357d,role:_0x50aabb}=_0x3624eb['user'],_0x1be935=_0x3624eb[_0x51309e(0x206)],_0xe26649=await profile[_0x51309e(0x1f0)]({'email':_0x1be935[_0x51309e(0x1fa)]}),_0xec6af5=await master_shop[_0x51309e(0x24e)](),_0x450d5f=await sales_return_finished[_0x51309e(0x1e7)]([{'$lookup':{'from':_0x51309e(0x1ef),'localField':_0x51309e(0x21c),'foreignField':_0x51309e(0x1fd),'as':_0x51309e(0x1d7)}},{'$unwind':_0x51309e(0x22b)}]);if(_0xec6af5[0x0][_0x51309e(0x1dc)]==_0x51309e(0x1e0)){var _0x1b327e=users['English'];console[_0x51309e(0x203)](_0x1b327e);}else{if(_0xec6af5[0x0][_0x51309e(0x1dc)]==_0x51309e(0x250))var _0x1b327e=users[_0x51309e(0x250)];else{if(_0xec6af5[0x0][_0x51309e(0x1dc)]==_0x51309e(0x240))var _0x1b327e=users['German'];else{if(_0xec6af5[0x0][_0x51309e(0x1dc)]==_0x51309e(0x220))var _0x1b327e=users[_0x51309e(0x220)];else{if(_0xec6af5[0x0][_0x51309e(0x1dc)]==_0x51309e(0x234))var _0x1b327e=users[_0x51309e(0x234)];else{if(_0xec6af5[0x0][_0x51309e(0x1dc)]==_0x51309e(0x233))var _0x1b327e=users[_0x51309e(0x211)];else{if(_0xec6af5[0x0]['language']==_0x51309e(0x243))var _0x1b327e=users[_0x51309e(0x243)];else{if(_0xec6af5[0x0][_0x51309e(0x1dc)]==_0x51309e(0x24f))var _0x1b327e=users[_0x51309e(0x223)];}}}}}}}_0x4b43f0[_0x51309e(0x202)](_0x51309e(0x1d6),{'success':_0x3624eb[_0x51309e(0x1d5)](_0x51309e(0x1e6)),'errors':_0x3624eb[_0x51309e(0x1d5)](_0x51309e(0x214)),'role':_0x1be935,'profile':_0xe26649,'master_shop':_0xec6af5,'user':_0x450d5f,'language':_0x1b327e});}catch(_0x42a76c){console['log'](_0x42a76c);}}),router[a0_0x536d18(0x205)]('/view/:id',auth,async(_0x585c2e,_0xed2eb1)=>{var _0x27ce6a=a0_0x536d18;try{const {username:_0x24cf9c,email:_0x540ba9,role:_0x47b3df}=_0x585c2e['user'],_0x53f966=_0x585c2e['user'],_0x3d9469=await profile[_0x27ce6a(0x1f0)]({'email':_0x53f966['email']}),_0x414feb=await master_shop['find']();console[_0x27ce6a(0x203)]('master',_0x414feb);const _0x29a12c=_0x585c2e[_0x27ce6a(0x22e)]['id'];console['log'](_0x29a12c);var _0x205bb4=[_0x27ce6a(0x219)];const _0x4f42ca=await sales_return_finished[_0x27ce6a(0x1f5)](_0x29a12c),_0x889a7=await warehouse[_0x27ce6a(0x1e7)]([{'$match':{'name':_0x4f42ca[_0x27ce6a(0x23d)],'room':_0x4f42ca[_0x27ce6a(0x244)]}},{'$unwind':_0x27ce6a(0x229)},{'$group':{'_id':_0x27ce6a(0x208),'name':{'$first':_0x27ce6a(0x22f)},'product_stock':{'$first':_0x27ce6a(0x207)},'bay':{'$first':_0x27ce6a(0x21b)},'bin':{'$first':_0x27ce6a(0x1fe)},'type':{'$first':_0x27ce6a(0x21d)},'floorlevel':{'$first':_0x27ce6a(0x242)},'primary_code':{'$first':_0x27ce6a(0x20b)},'secondary_code':{'$first':_0x27ce6a(0x20a)},'product_code':{'$first':_0x27ce6a(0x224)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x27ce6a(0x1eb)}}}]);console['log'](_0x889a7);const _0x592e89=await warehouse[_0x27ce6a(0x1e7)]([{'$match':{'status':_0x27ce6a(0x1e3),'warehouse_category':_0x27ce6a(0x1d9)}},{'$group':{'_id':'$name','name':{'$first':_0x27ce6a(0x231)}}},{'$sort':{'name':0x1}}]),_0x15d8a6=await warehouse[_0x27ce6a(0x1e7)]([{'$match':{'status':_0x27ce6a(0x1e3),'name':_0x27ce6a(0x23c)}},{'$group':{'_id':_0x27ce6a(0x231),'name':{'$first':_0x27ce6a(0x231)}}},{'$sort':{'name':0x1}}]),_0x12e314=await product[_0x27ce6a(0x24e)]({});if(_0x414feb[0x0]['language']=='English\x20(US)'){var _0x47661d=users[_0x27ce6a(0x1ec)];console[_0x27ce6a(0x203)](_0x47661d);}else{if(_0x414feb[0x0]['language']==_0x27ce6a(0x250))var _0x47661d=users[_0x27ce6a(0x250)];else{if(_0x414feb[0x0][_0x27ce6a(0x1dc)]==_0x27ce6a(0x240))var _0x47661d=users[_0x27ce6a(0x240)];else{if(_0x414feb[0x0][_0x27ce6a(0x1dc)]==_0x27ce6a(0x220))var _0x47661d=users[_0x27ce6a(0x220)];else{if(_0x414feb[0x0][_0x27ce6a(0x1dc)]==_0x27ce6a(0x234))var _0x47661d=users[_0x27ce6a(0x234)];else{if(_0x414feb[0x0][_0x27ce6a(0x1dc)]==_0x27ce6a(0x233))var _0x47661d=users[_0x27ce6a(0x211)];else{if(_0x414feb[0x0]['language']=='Chinese')var _0x47661d=users['Chinese'];else{if(_0x414feb[0x0][_0x27ce6a(0x1dc)]==_0x27ce6a(0x24f))var _0x47661d=users[_0x27ce6a(0x223)];}}}}}}}_0xed2eb1[_0x27ce6a(0x202)](_0x27ce6a(0x1de),{'success':_0x585c2e['flash'](_0x27ce6a(0x1e6)),'errors':_0x585c2e['flash']('errors'),'role':_0x53f966,'profile':_0x3d9469,'master_shop':_0x414feb,'user':_0x4f42ca,'stock':_0x889a7,'unit':_0x12e314,'language':_0x47661d,'warehouses':_0x592e89,'rooms':_0x205bb4,'warehouse_QA':_0x15d8a6});}catch(_0x1d3eba){console['log'](_0x1d3eba);}}),router[a0_0x536d18(0x254)]('/view/:id',auth,async(_0x82f6a0,_0xdda83c)=>{var _0x10af25=a0_0x536d18;if(_0x82f6a0[_0x10af25(0x23e)]['for_categorize']=='QA')try{const _0x1f3b77=_0x82f6a0[_0x10af25(0x22e)]['id'],_0x5c119e=await sales_return[_0x10af25(0x1f0)]({'invoice':_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x239)]}),_0x269d79=await warehouse[_0x10af25(0x1f0)]({'name':_0x5c119e[_0x10af25(0x23d)],'room':_0x5c119e[_0x10af25(0x244)]}),{invoice:_0x1459ec,customer:_0x1cd288,date:_0x48724b,warehouse_name:_0x1c2d0b,product_name:_0x18e98b,primary_code:_0x28d8b2,secondary_code:_0x3aadc6,product_code:_0xf7bff4,sales_quantity:_0x40045b,stocks:_0x25ea60,return_qty:_0x398a0b,note:_0x570ed8,to_warehouse_name_QA:_0x281923,to_Room_name_QA:_0x13ffa7}=_0x82f6a0[_0x10af25(0x23e)];if(typeof product_name_QA==_0x10af25(0x1ee))var _0x2371a3=[_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x20d)]],_0x1ee0d1=[_0x82f6a0[_0x10af25(0x23e)]['primary_code_QA']],_0x3c0191=[_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x1f7)]],_0x5a448b=[_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x1ff)]],_0x3ab43d=[_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x222)]],_0x26274a=[_0x82f6a0['body'][_0x10af25(0x22d)]],_0x474f10=[_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x1f8)]];else var _0x2371a3=[..._0x82f6a0[_0x10af25(0x23e)]['product_name_QA']],_0x1ee0d1=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x248)]],_0x3c0191=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x1f7)]],_0x5a448b=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x1ff)]],_0x3ab43d=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x222)]],_0x26274a=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x22d)]],_0x474f10=[..._0x82f6a0['body'][_0x10af25(0x1f8)]];const _0x4ae5cf=_0x2371a3['map'](_0x427e97=>{return _0x427e97={'product_name':_0x427e97};});_0x1ee0d1[_0x10af25(0x1dd)]((_0x6e9815,_0x469f2b)=>{var _0x1fefc8=_0x10af25;_0x4ae5cf[_0x469f2b][_0x1fefc8(0x1da)]=_0x6e9815;}),_0x3c0191[_0x10af25(0x1dd)]((_0x1fe26b,_0x249202)=>{var _0x16a1e7=_0x10af25;_0x4ae5cf[_0x249202][_0x16a1e7(0x226)]=_0x1fe26b;}),_0x5a448b['forEach']((_0x4cf3c3,_0x5a7ffa)=>{var _0x52d57f=_0x10af25;_0x4ae5cf[_0x5a7ffa][_0x52d57f(0x245)]=_0x4cf3c3;}),_0x3ab43d[_0x10af25(0x1dd)]((_0x1d5e00,_0x4b43df)=>{var _0x266e72=_0x10af25;_0x4ae5cf[_0x4b43df][_0x266e72(0x215)]=_0x1d5e00;}),_0x26274a[_0x10af25(0x1dd)]((_0x57d42a,_0x12caee)=>{_0x4ae5cf[_0x12caee]['stock']=_0x57d42a;}),_0x474f10[_0x10af25(0x1dd)]((_0x19a611,_0x578d2d)=>{var _0x2820e0=_0x10af25;_0x4ae5cf[_0x578d2d][_0x2820e0(0x22c)]=_0x19a611;}),_0x5c119e['return_sale_QA'][_0x10af25(0x1dd)](_0x158b21=>{var _0x17bd11=_0x10af25;const _0x5b34f2=_0x269d79[_0x17bd11(0x20f)][_0x17bd11(0x1fb)](_0x534931=>{var _0x418caf=_0x17bd11;_0x534931[_0x418caf(0x23b)]==_0x158b21[_0x418caf(0x23b)]&&(_0x534931[_0x418caf(0x1e4)]=parseInt(_0x534931[_0x418caf(0x1e4)])+parseInt(_0x158b21['return_qty']));});}),await _0x269d79['save'](),_0x5c119e[_0x10af25(0x239)]=_0x1459ec,_0x5c119e[_0x10af25(0x21c)]=_0x1cd288,_0x5c119e['date']=_0x48724b,_0x5c119e[_0x10af25(0x201)]=_0x1c2d0b,_0x5c119e[_0x10af25(0x1ed)]=_0x4ae5cf,_0x5c119e[_0x10af25(0x246)]=_0x570ed8,_0x5c119e['ToWarehouse']=_0x281923,_0x5c119e[_0x10af25(0x244)]=_0x13ffa7;const _0x37de67=await _0x5c119e[_0x10af25(0x227)](),_0xb44910=await c_payment_data[_0x10af25(0x1f0)]({'invoice':_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x239)],'reason':_0x10af25(0x241)});_0xb44910[_0x10af25(0x1e9)]=_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x1e9)],_0xb44910['date']=_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x236)],await _0xb44910[_0x10af25(0x227)](),_0x82f6a0[_0x10af25(0x1d5)](_0x10af25(0x1e6),'purchase\x20return\x20successfully'),_0xdda83c['redirect'](_0x10af25(0x1db));}catch(_0x267170){console[_0x10af25(0x203)](_0x267170),_0xdda83c[_0x10af25(0x1e8)](0xc8)['json']({'message':_0x267170['message']});}else try{const _0xa39082=_0x82f6a0[_0x10af25(0x22e)]['id'];console[_0x10af25(0x203)](_0xa39082);const _0x11be7e=await sales_return[_0x10af25(0x1f0)]({'invoice':_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x239)]});console[_0x10af25(0x203)]('old_data',_0x11be7e);const _0xdb4271=await warehouse[_0x10af25(0x1f0)]({'name':_0x11be7e[_0x10af25(0x23d)],'room':_0x11be7e[_0x10af25(0x244)]});console[_0x10af25(0x203)](_0x10af25(0x24b),_0xdb4271);const {invoice:_0x9cf5d9,customer:_0x42dba8,date:_0x4d2ad1,warehouse_name:_0x46a8bf,product_name:_0x5d4bce,primary_code:_0x547536,secondary_code:_0x524fa0,product_code:_0x9852c0,sales_quantity:_0xbe0ec7,stocks:_0x3f8986,return_qty:_0x5f379d,note:_0x430064,to_warehouse_name:_0x12c637,to_Room_name:_0x3914d1}=_0x82f6a0[_0x10af25(0x23e)];console[_0x10af25(0x203)](_0x82f6a0[_0x10af25(0x23e)]);if(typeof _0x5d4bce==_0x10af25(0x1ee))var _0x2371a3=[_0x82f6a0[_0x10af25(0x23e)]['product_name']],_0x1ee0d1=[_0x82f6a0[_0x10af25(0x23e)]['primary_code']],_0x3c0191=[_0x82f6a0[_0x10af25(0x23e)]['secondary_code']],_0x5a448b=[_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x245)]],_0x3ab43d=[_0x82f6a0['body'][_0x10af25(0x1f3)]],_0x26274a=[_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x21e)]],_0x474f10=[_0x82f6a0['body'][_0x10af25(0x22c)]],_0x1dd79e=[_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x20e)]],_0x14193a=[_0x82f6a0[_0x10af25(0x23e)]['bin']],_0xbf0e02=[_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x23f)]],_0x206531=[_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x1f4)]];else var _0x2371a3=[..._0x82f6a0[_0x10af25(0x23e)]['product_name']],_0x1ee0d1=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x1da)]],_0x3c0191=[..._0x82f6a0['body'][_0x10af25(0x226)]],_0x5a448b=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x245)]],_0x3ab43d=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x1f3)]],_0x26274a=[..._0x82f6a0['body'][_0x10af25(0x21e)]],_0x474f10=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x22c)]],_0x1dd79e=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x20e)]],_0x14193a=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x209)]],_0xbf0e02=[..._0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x23f)]],_0x206531=[..._0x82f6a0['body']['floorlevel']];const _0x51d4c7=_0x2371a3['map'](_0x2e352d=>{return _0x2e352d={'product_name':_0x2e352d};});_0x1ee0d1[_0x10af25(0x1dd)]((_0x4900e3,_0x217a99)=>{_0x51d4c7[_0x217a99]['primary_code']=_0x4900e3;}),_0x3c0191[_0x10af25(0x1dd)]((_0x201db2,_0x504f4c)=>{_0x51d4c7[_0x504f4c]['secondary_code']=_0x201db2;}),_0x5a448b[_0x10af25(0x1dd)]((_0x2f43a,_0x75f151)=>{var _0x127c78=_0x10af25;_0x51d4c7[_0x75f151][_0x127c78(0x245)]=_0x2f43a;}),_0x3ab43d[_0x10af25(0x1dd)]((_0x2b8127,_0x122d42)=>{var _0xa5f377=_0x10af25;_0x51d4c7[_0x122d42][_0xa5f377(0x215)]=_0x2b8127;}),_0x26274a['forEach']((_0x8e1ce7,_0x15ff70)=>{var _0x320850=_0x10af25;_0x51d4c7[_0x15ff70][_0x320850(0x212)]=_0x8e1ce7;}),_0x474f10[_0x10af25(0x1dd)]((_0x4c4699,_0x12a2de)=>{_0x51d4c7[_0x12a2de]['return_qty']=_0x4c4699;}),_0x1dd79e[_0x10af25(0x1dd)]((_0x117394,_0x5f20a7)=>{var _0xf6b277=_0x10af25;_0x51d4c7[_0x5f20a7][_0xf6b277(0x20e)]=_0x117394;}),_0x14193a['forEach']((_0x25a567,_0x493679)=>{var _0x2b9796=_0x10af25;_0x51d4c7[_0x493679][_0x2b9796(0x209)]=_0x25a567;}),_0xbf0e02[_0x10af25(0x1dd)]((_0x5aa521,_0x11ac29)=>{var _0x1e9921=_0x10af25;_0x51d4c7[_0x11ac29][_0x1e9921(0x1e1)]=_0x5aa521;}),_0x206531['forEach']((_0x3fc59a,_0x32ecfd)=>{_0x51d4c7[_0x32ecfd]['floorlevel']=_0x3fc59a;});var _0x5440db=0x0;_0x51d4c7[_0x10af25(0x1dd)](_0x5ca4fd=>{var _0x3bcec9=_0x10af25;console[_0x3bcec9(0x203)](_0x3bcec9(0x235),_0x5ca4fd),(parseInt(_0x5ca4fd[_0x3bcec9(0x215)])<parseInt(_0x5ca4fd['return_qty'])||parseInt(_0x5ca4fd[_0x3bcec9(0x212)])<parseInt(_0x5ca4fd[_0x3bcec9(0x22c)])&&parseInt(_0x5ca4fd[_0x3bcec9(0x215)])>parseInt(_0x5ca4fd[_0x3bcec9(0x22c)])||parseInt(_0x5ca4fd[_0x3bcec9(0x22c)])==0x0)&&_0x5440db++;});if(_0x5440db!=0x0)return _0x82f6a0['flash'](_0x10af25(0x214),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0xdda83c['redirect'](_0x10af25(0x216));_0x11be7e['return_sale'][_0x10af25(0x1dd)](_0x5d7ad6=>{var _0x25f388=_0x10af25;const _0x551c81=_0xdb4271[_0x25f388(0x20f)][_0x25f388(0x1fb)](_0x3d7758=>{var _0x31a0a9=_0x25f388;_0x3d7758[_0x31a0a9(0x23b)]==_0x5d7ad6[_0x31a0a9(0x23b)]&&_0x3d7758[_0x31a0a9(0x1f4)]==_0x5d7ad6['floorlevel']&&_0x3d7758['type']==_0x5d7ad6['type']&&_0x3d7758[_0x31a0a9(0x209)]==_0x5d7ad6[_0x31a0a9(0x209)]&&_0x3d7758[_0x31a0a9(0x20e)]==_0x5d7ad6[_0x31a0a9(0x20e)]&&(_0x3d7758[_0x31a0a9(0x1e4)]=parseInt(_0x3d7758[_0x31a0a9(0x1e4)])+parseInt(_0x5d7ad6[_0x31a0a9(0x22c)]));});}),console[_0x10af25(0x203)](_0x10af25(0x24b),_0xdb4271),await _0xdb4271['save'](),_0x11be7e[_0x10af25(0x239)]=_0x9cf5d9,_0x11be7e[_0x10af25(0x21c)]=_0x42dba8,_0x11be7e[_0x10af25(0x236)]=_0x4d2ad1,_0x11be7e[_0x10af25(0x201)]=_0x46a8bf,_0x11be7e[_0x10af25(0x23a)]=_0x51d4c7,_0x11be7e['note']=_0x430064,_0x11be7e[_0x10af25(0x23d)]=_0x12c637,_0x11be7e['ToRoom']=_0x3914d1;const _0x3f4f01=await _0x11be7e[_0x10af25(0x227)]();console[_0x10af25(0x203)](_0x10af25(0x249),_0x3f4f01);const _0x4af339=await c_payment_data[_0x10af25(0x1f0)]({'invoice':_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x239)],'reason':_0x10af25(0x241)});_0x4af339[_0x10af25(0x1e9)]=_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x1e9)],_0x4af339['date']=_0x82f6a0[_0x10af25(0x23e)][_0x10af25(0x236)],await _0x4af339['save'](),_0x82f6a0['flash'](_0x10af25(0x1e6),_0x10af25(0x1f2)),_0xdda83c[_0x10af25(0x230)](_0x10af25(0x218));}catch(_0x57cd7c){console['log'](_0x57cd7c),_0xdda83c[_0x10af25(0x1e8)](0xc8)[_0x10af25(0x1fc)]({'message':_0x57cd7c[_0x10af25(0x225)]});}}),router[a0_0x536d18(0x254)](a0_0x536d18(0x232),auth,async(_0x187ebb,_0x48c3fb)=>{var _0x3f079e=a0_0x536d18;try{const _0x1943ce=_0x187ebb[_0x3f079e(0x22e)]['id'],{invoice:_0x4de947,customer:_0x2cfb88,payable_to_customer:_0xc32e9,paid_amount:_0x30a888}=_0x187ebb[_0x3f079e(0x23e)],_0x215c99=await sales_return[_0x3f079e(0x1f5)](_0x1943ce);console[_0x3f079e(0x203)]('data',_0x215c99),console[_0x3f079e(0x203)](_0xc32e9),console[_0x3f079e(0x203)](_0x30a888);var _0x371de6=_0xc32e9-_0x30a888;console['log'](_0x3f079e(0x24c),_0x371de6),_0x215c99[_0x3f079e(0x1f1)]=parseFloat(_0x30a888)+parseFloat(_0x215c99[_0x3f079e(0x1f1)]),_0x215c99[_0x3f079e(0x204)]=_0x371de6,console[_0x3f079e(0x203)](_0x215c99);const _0x327bbb=await _0x215c99['save']();console[_0x3f079e(0x203)](0x1b207);const _0x325bc3=await c_payment_data[_0x3f079e(0x1f0)]({'invoice':_0x187ebb[_0x3f079e(0x23e)][_0x3f079e(0x239)],'reason':'Sale\x20Return'});console[_0x3f079e(0x203)](_0x3f079e(0x20c),_0x325bc3),_0x325bc3[_0x3f079e(0x1f6)]=_0x371de6,await _0x325bc3[_0x3f079e(0x227)]();let _0x52dde8=new Date(),_0x4db9c6=('0'+_0x52dde8[_0x3f079e(0x237)]())[_0x3f079e(0x22a)](-0x2),_0x5c1278=('0'+(_0x52dde8['getMonth']()+0x1))[_0x3f079e(0x22a)](-0x2),_0x38f694=_0x52dde8[_0x3f079e(0x253)](),_0x1787f0=_0x38f694+'-'+_0x5c1278+'-'+_0x4db9c6;const _0x85d928=new customer_payment({'invoice':_0x4de947,'date':_0x38f694+'-'+_0x5c1278+'-'+_0x4db9c6,'customer':_0x2cfb88,'reason':_0x3f079e(0x252),'amount':_0x30a888}),_0x27d69a=await _0x85d928['save']();_0x187ebb[_0x3f079e(0x1d5)](_0x3f079e(0x1e6),_0x3f079e(0x200)),_0x48c3fb[_0x3f079e(0x230)](_0x3f079e(0x218));}catch(_0x50dc54){console[_0x3f079e(0x203)](_0x50dc54);}}),router[a0_0x536d18(0x205)](a0_0x536d18(0x251),auth,async(_0x2e33aa,_0x3f0651)=>{var _0x5da96f=a0_0x536d18;try{const {username:_0x220ddb,email:_0x2c5c15,role:_0x4419cd}=_0x2e33aa[_0x5da96f(0x206)],_0x592a3d=_0x2e33aa['user'],_0x1977a7=await profile[_0x5da96f(0x1f0)]({'email':_0x592a3d[_0x5da96f(0x1fa)]}),_0x4b4be3=await master_shop[_0x5da96f(0x24e)]();console[_0x5da96f(0x203)]('master',_0x4b4be3);const _0x138ac1=_0x2e33aa[_0x5da96f(0x22e)]['id'],_0xafd040=await sales_return['findById'](_0x138ac1);console[_0x5da96f(0x203)](_0xafd040);const _0x57f8d2=await customer['findOne']({'name':_0xafd040[_0x5da96f(0x21c)]});console[_0x5da96f(0x203)](_0x57f8d2);if(_0x4b4be3[0x0][_0x5da96f(0x1dc)]==_0x5da96f(0x1e0)){var _0x16cf75=users['English'];console['log'](_0x16cf75);}else{if(_0x4b4be3[0x0][_0x5da96f(0x1dc)]==_0x5da96f(0x250))var _0x16cf75=users[_0x5da96f(0x250)];else{if(_0x4b4be3[0x0][_0x5da96f(0x1dc)]==_0x5da96f(0x240))var _0x16cf75=users[_0x5da96f(0x240)];else{if(_0x4b4be3[0x0][_0x5da96f(0x1dc)]=='Spanish')var _0x16cf75=users[_0x5da96f(0x220)];else{if(_0x4b4be3[0x0]['language']==_0x5da96f(0x234))var _0x16cf75=users[_0x5da96f(0x234)];else{if(_0x4b4be3[0x0][_0x5da96f(0x1dc)]==_0x5da96f(0x233))var _0x16cf75=users[_0x5da96f(0x211)];else{if(_0x4b4be3[0x0][_0x5da96f(0x1dc)]==_0x5da96f(0x243))var _0x16cf75=users[_0x5da96f(0x243)];else{if(_0x4b4be3[0x0]['language']==_0x5da96f(0x24f))var _0x16cf75=users['Arabic'];}}}}}}}_0x3f0651[_0x5da96f(0x202)](_0x5da96f(0x247),{'success':_0x2e33aa[_0x5da96f(0x1d5)](_0x5da96f(0x1e6)),'errors':_0x2e33aa[_0x5da96f(0x1d5)](_0x5da96f(0x214)),'role':_0x592a3d,'profile':_0x1977a7,'master_shop':_0x4b4be3,'customers':_0x57f8d2,'sales':_0xafd040,'language':_0x16cf75});}catch(_0x10e167){console[_0x5da96f(0x203)](_0x10e167);}}),module['exports']=router;function a0_0x15cd(){var _0x597164=['stocks','3612qgxkLe','Spanish','35SoCtql','sales_quantity_QA','Arabic','$product_details.product_code','message','secondary_code','save','4381785WSMifc','$product_details','slice','$customer_docs','return_qty','stocks_QA','params','$product_details.product_name','redirect','$name','/give_payment/:id','Portuguese\x20(BR)','French','foreach\x20newproduct','date','getDate','37796ervWqB','invoice','return_sale','product_name','QA\x20Warehouse','ToWarehouse','body','types','German','Sale\x20Return','$product_details.floorlevel','Chinese','ToRoom','product_code','note','sales_return_invoice','primary_code_QA','new\x20new_data','535696vbDBuX','old_warehouse_data','subtract','7707430HxjhkA','find','Arabic\x20(ae)','Hindi','/invoice/:id','Returned\x20Payment\x20For\x20Sale\x20Return','getFullYear','post','flash','sales_return_finished','customer_docs','../models/all_models','Finished\x20Goods','primary_code','/sales_return_finished/view','language','forEach','return_sale_edit_finished','2964050vlOzrx','English\x20(US)','type','48jQtsOn','Enabled','product_stock','Router','success','aggregate','status','suppliers','8QmgrWG','$product_details.rack','English','return_sale_QA','string','customers','findOne','paid_amount','purchase\x20return\x20successfully','sales_quantity','floorlevel','findById','amount','secondary_code_QA','return_qty_QA','863319XtYJCU','email','map','json','name','$product_details.bin','product_code_QA','payment\x20successfull','warehouse_name','render','log','due_amount','get','user','$product_details.product_stock','$product_details._id','bin','$product_details.secondary_code','$product_details.primary_code','c_payment','product_name_QA','bay','product_details','../public/language/languages.json','Portuguese','stock','33206szhMnb','errors','sale_qty','back','/view','/sales_return/view','Return\x20Rooms','8PfWcjW','$product_details.bay','customer','$product_details.type'];a0_0x15cd=function(){return _0x597164;};return a0_0x15cd();}