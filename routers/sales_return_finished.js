var a0_0x180067=a0_0x4fed;(function(_0xdb20e2,_0x228016){var _0x2083dd=a0_0x4fed,_0x256e44=_0xdb20e2();while(!![]){try{var _0x146ce0=-parseInt(_0x2083dd(0x135))/0x1*(parseInt(_0x2083dd(0x102))/0x2)+-parseInt(_0x2083dd(0x13d))/0x3+parseInt(_0x2083dd(0xfc))/0x4*(parseInt(_0x2083dd(0x132))/0x5)+-parseInt(_0x2083dd(0x10a))/0x6+parseInt(_0x2083dd(0x10e))/0x7*(parseInt(_0x2083dd(0x129))/0x8)+-parseInt(_0x2083dd(0xe5))/0x9*(parseInt(_0x2083dd(0xf7))/0xa)+parseInt(_0x2083dd(0x131))/0xb*(parseInt(_0x2083dd(0xf8))/0xc);if(_0x146ce0===_0x228016)break;else _0x256e44['push'](_0x256e44['shift']());}catch(_0x1a2081){_0x256e44['push'](_0x256e44['shift']());}}}(a0_0x2efa,0xf3ea0));const express=require(a0_0x180067(0x141)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x180067(0x149)),auth=require(a0_0x180067(0x156)),users=require(a0_0x180067(0xe6));router[a0_0x180067(0x13e)](a0_0x180067(0xea),auth,async(_0x2890b5,_0x295b4f)=>{var _0x1d1b1b=a0_0x180067;try{const {username:_0x7e73a,email:_0x3aa092,role:_0x5d5f6e}=_0x2890b5['user'],_0x24a56a=_0x2890b5[_0x1d1b1b(0x15b)],_0x317300=await profile['findOne']({'email':_0x24a56a[_0x1d1b1b(0x155)]}),_0x3d4e76=await master_shop['find'](),_0x58610e=await sales_return_finished[_0x1d1b1b(0xf0)]([{'$lookup':{'from':'customers','localField':_0x1d1b1b(0x144),'foreignField':_0x1d1b1b(0x152),'as':_0x1d1b1b(0x159)}},{'$unwind':_0x1d1b1b(0x113)}]);if(_0x3d4e76[0x0]['language']==_0x1d1b1b(0x105)){var _0x431b0d=users[_0x1d1b1b(0x139)];console[_0x1d1b1b(0x130)](_0x431b0d);}else{if(_0x3d4e76[0x0][_0x1d1b1b(0x14c)]==_0x1d1b1b(0xf6))var _0x431b0d=users[_0x1d1b1b(0xf6)];else{if(_0x3d4e76[0x0][_0x1d1b1b(0x14c)]==_0x1d1b1b(0x127))var _0x431b0d=users[_0x1d1b1b(0x127)];else{if(_0x3d4e76[0x0]['language']=='Spanish')var _0x431b0d=users[_0x1d1b1b(0x134)];else{if(_0x3d4e76[0x0][_0x1d1b1b(0x14c)]=='French')var _0x431b0d=users[_0x1d1b1b(0x123)];else{if(_0x3d4e76[0x0]['language']=='Portuguese\x20(BR)')var _0x431b0d=users['Portuguese'];else{if(_0x3d4e76[0x0]['language']==_0x1d1b1b(0xf9))var _0x431b0d=users[_0x1d1b1b(0xf9)];else{if(_0x3d4e76[0x0]['language']==_0x1d1b1b(0x112))var _0x431b0d=users[_0x1d1b1b(0x145)];}}}}}}}_0x295b4f[_0x1d1b1b(0x14a)](_0x1d1b1b(0x11b),{'success':_0x2890b5[_0x1d1b1b(0x11f)](_0x1d1b1b(0x14b)),'errors':_0x2890b5[_0x1d1b1b(0x11f)]('errors'),'role':_0x24a56a,'profile':_0x317300,'master_shop':_0x3d4e76,'user':_0x58610e,'language':_0x431b0d});}catch(_0x9b3d24){console[_0x1d1b1b(0x130)](_0x9b3d24);}}),router[a0_0x180067(0x13e)](a0_0x180067(0x161),auth,async(_0x1424a2,_0x22718c)=>{var _0x48fa86=a0_0x180067;try{const {username:_0x1f864f,email:_0x3b3e3b,role:_0x558d4c}=_0x1424a2[_0x48fa86(0x15b)],_0x465244=_0x1424a2[_0x48fa86(0x15b)],_0x29a9e4=await profile[_0x48fa86(0x119)]({'email':_0x465244[_0x48fa86(0x155)]}),_0x498926=await master_shop[_0x48fa86(0x12b)]();console[_0x48fa86(0x130)]('master',_0x498926);const _0x58e421=_0x1424a2[_0x48fa86(0x150)]['id'];console[_0x48fa86(0x130)](_0x58e421);var _0x1eadcc=['Return\x20Rooms'];const _0x172c73=await sales_return_finished[_0x48fa86(0x115)](_0x58e421),_0x39355f=await warehouse[_0x48fa86(0xf0)]([{'$match':{'name':_0x172c73[_0x48fa86(0x140)],'room':_0x172c73[_0x48fa86(0xf4)]}},{'$unwind':_0x48fa86(0x114)},{'$group':{'_id':_0x48fa86(0xf1),'name':{'$first':_0x48fa86(0x104)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x48fa86(0x11c)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x48fa86(0xf3)},'floorlevel':{'$first':_0x48fa86(0x15e)},'primary_code':{'$first':_0x48fa86(0x157)},'secondary_code':{'$first':_0x48fa86(0x154)},'product_code':{'$first':_0x48fa86(0x160)},'storage':{'$first':_0x48fa86(0x158)},'rack':{'$first':_0x48fa86(0xe8)}}}]);console['log'](_0x39355f);const _0x4c96bf=await warehouse['aggregate']([{'$match':{'status':_0x48fa86(0x11d),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x48fa86(0x124),'name':{'$first':_0x48fa86(0x124)}}},{'$sort':{'name':0x1}}]),_0x4dc946=await warehouse[_0x48fa86(0xf0)]([{'$match':{'status':'Enabled','name':'QA\x20Warehouse'}},{'$group':{'_id':_0x48fa86(0x124),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0xa0e78e=await product['find']({});if(_0x498926[0x0]['language']==_0x48fa86(0x105)){var _0xff98ab=users['English'];console[_0x48fa86(0x130)](_0xff98ab);}else{if(_0x498926[0x0][_0x48fa86(0x14c)]==_0x48fa86(0xf6))var _0xff98ab=users[_0x48fa86(0xf6)];else{if(_0x498926[0x0][_0x48fa86(0x14c)]=='German')var _0xff98ab=users[_0x48fa86(0x127)];else{if(_0x498926[0x0][_0x48fa86(0x14c)]==_0x48fa86(0x134))var _0xff98ab=users[_0x48fa86(0x134)];else{if(_0x498926[0x0]['language']=='French')var _0xff98ab=users[_0x48fa86(0x123)];else{if(_0x498926[0x0][_0x48fa86(0x14c)]==_0x48fa86(0xeb))var _0xff98ab=users[_0x48fa86(0xe9)];else{if(_0x498926[0x0][_0x48fa86(0x14c)]==_0x48fa86(0xf9))var _0xff98ab=users[_0x48fa86(0xf9)];else{if(_0x498926[0x0][_0x48fa86(0x14c)]=='Arabic\x20(ae)')var _0xff98ab=users[_0x48fa86(0x145)];}}}}}}}_0x22718c[_0x48fa86(0x14a)](_0x48fa86(0xec),{'success':_0x1424a2['flash'](_0x48fa86(0x14b)),'errors':_0x1424a2[_0x48fa86(0x11f)](_0x48fa86(0x128)),'role':_0x465244,'profile':_0x29a9e4,'master_shop':_0x498926,'user':_0x172c73,'stock':_0x39355f,'unit':_0xa0e78e,'language':_0xff98ab,'warehouses':_0x4c96bf,'rooms':_0x1eadcc,'warehouse_QA':_0x4dc946});}catch(_0x48e324){console[_0x48fa86(0x130)](_0x48e324);}}),router[a0_0x180067(0x109)]('/view/:id',auth,async(_0x44c812,_0x9507ba)=>{var _0x2edb1b=a0_0x180067;if(_0x44c812['body'][_0x2edb1b(0x13a)]=='QA')try{const _0x2bec54=_0x44c812[_0x2edb1b(0x150)]['id'],_0x44059e=await sales_return[_0x2edb1b(0x119)]({'invoice':_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x117)]}),_0x378dc1=await warehouse[_0x2edb1b(0x119)]({'name':_0x44059e['ToWarehouse'],'room':_0x44059e[_0x2edb1b(0xf4)]}),{invoice:_0x872b54,customer:_0x4dc557,date:_0x3aaf2,warehouse_name:_0x4b0f5b,product_name:_0x282be3,primary_code:_0x59be68,secondary_code:_0x2d38cd,product_code:_0x41fdbc,sales_quantity:_0x2bf40d,stocks:_0x5afa8b,return_qty:_0x432b30,note:_0x1e9e15,to_warehouse_name_QA:_0xd3cfab,to_Room_name_QA:_0x504c4d}=_0x44c812[_0x2edb1b(0x116)];if(typeof product_name_QA=='string')var _0x4e1b97=[_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x122)]],_0x4efa70=[_0x44c812['body'][_0x2edb1b(0x121)]],_0x48eeb7=[_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x120)]],_0x2c9371=[_0x44c812['body'][_0x2edb1b(0x153)]],_0x40e54a=[_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x12d)]],_0x40bbe9=[_0x44c812[_0x2edb1b(0x116)]['stocks_QA']],_0x414991=[_0x44c812['body'][_0x2edb1b(0x110)]];else var _0x4e1b97=[..._0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x122)]],_0x4efa70=[..._0x44c812[_0x2edb1b(0x116)]['primary_code_QA']],_0x48eeb7=[..._0x44c812['body'][_0x2edb1b(0x120)]],_0x2c9371=[..._0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x153)]],_0x40e54a=[..._0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x12d)]],_0x40bbe9=[..._0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x13b)]],_0x414991=[..._0x44c812['body'][_0x2edb1b(0x110)]];const _0x5d84af=_0x4e1b97[_0x2edb1b(0x143)](_0xbe36e0=>{return _0xbe36e0={'product_name':_0xbe36e0};});_0x4efa70['forEach']((_0x3ccaf1,_0x4cd9c9)=>{var _0x81e6ff=_0x2edb1b;_0x5d84af[_0x4cd9c9][_0x81e6ff(0xed)]=_0x3ccaf1;}),_0x48eeb7[_0x2edb1b(0x12f)]((_0xe60ba2,_0x47fef7)=>{var _0x5e0649=_0x2edb1b;_0x5d84af[_0x47fef7][_0x5e0649(0x151)]=_0xe60ba2;}),_0x2c9371[_0x2edb1b(0x12f)]((_0x38ff43,_0x211bc1)=>{var _0xf142ce=_0x2edb1b;_0x5d84af[_0x211bc1][_0xf142ce(0xee)]=_0x38ff43;}),_0x40e54a['forEach']((_0x51d6f2,_0x570dbe)=>{_0x5d84af[_0x570dbe]['sale_qty']=_0x51d6f2;}),_0x40bbe9[_0x2edb1b(0x12f)]((_0x5c5831,_0x49a094)=>{var _0x1da0d5=_0x2edb1b;_0x5d84af[_0x49a094][_0x1da0d5(0xfb)]=_0x5c5831;}),_0x414991[_0x2edb1b(0x12f)]((_0x84807b,_0x3985f9)=>{var _0x32452e=_0x2edb1b;_0x5d84af[_0x3985f9][_0x32452e(0x12e)]=_0x84807b;}),_0x44059e[_0x2edb1b(0x10d)][_0x2edb1b(0x12f)](_0x53549d=>{var _0x2837fc=_0x2edb1b;const _0x459bb8=_0x378dc1[_0x2837fc(0x108)][_0x2837fc(0x143)](_0x29d603=>{var _0x6227c5=_0x2837fc;_0x29d603['product_name']==_0x53549d[_0x6227c5(0x125)]&&(_0x29d603['product_stock']=parseInt(_0x29d603['product_stock'])+parseInt(_0x53549d[_0x6227c5(0x12e)]));});}),await _0x378dc1['save'](),_0x44059e[_0x2edb1b(0x117)]=_0x872b54,_0x44059e[_0x2edb1b(0x144)]=_0x4dc557,_0x44059e[_0x2edb1b(0x103)]=_0x3aaf2,_0x44059e[_0x2edb1b(0x15a)]=_0x4b0f5b,_0x44059e[_0x2edb1b(0x10d)]=_0x5d84af,_0x44059e['note']=_0x1e9e15,_0x44059e[_0x2edb1b(0x140)]=_0xd3cfab,_0x44059e[_0x2edb1b(0xf4)]=_0x504c4d;const _0x5dc705=await _0x44059e[_0x2edb1b(0x10f)](),_0x49c4db=await c_payment_data[_0x2edb1b(0x119)]({'invoice':_0x44c812['body'][_0x2edb1b(0x117)],'reason':_0x2edb1b(0x12c)});_0x49c4db[_0x2edb1b(0xfa)]=_0x44c812[_0x2edb1b(0x116)]['suppliers'],_0x49c4db['date']=_0x44c812['body']['date'],await _0x49c4db[_0x2edb1b(0x10f)](),_0x44c812[_0x2edb1b(0x11f)](_0x2edb1b(0x14b),'purchase\x20return\x20successfully'),_0x9507ba['redirect'](_0x2edb1b(0x106));}catch(_0x23aeeb){console[_0x2edb1b(0x130)](_0x23aeeb),_0x9507ba[_0x2edb1b(0x126)](0xc8)['json']({'message':_0x23aeeb[_0x2edb1b(0x148)]});}else try{const _0x373319=_0x44c812[_0x2edb1b(0x150)]['id'];console[_0x2edb1b(0x130)](_0x373319);const _0x5a2434=await sales_return[_0x2edb1b(0x119)]({'invoice':_0x44c812['body'][_0x2edb1b(0x117)]});console[_0x2edb1b(0x130)](_0x2edb1b(0x15f),_0x5a2434);const _0x2ddac8=await warehouse[_0x2edb1b(0x119)]({'name':_0x5a2434[_0x2edb1b(0x140)],'room':_0x5a2434[_0x2edb1b(0xf4)]});console[_0x2edb1b(0x130)]('old_warehouse_data',_0x2ddac8);const {invoice:_0x7055a5,customer:_0x13d595,date:_0x30939e,warehouse_name:_0xecd781,product_name:_0x3ef4bb,primary_code:_0x7beb56,secondary_code:_0xc5c95e,product_code:_0x16cbc0,sales_quantity:_0xa887dc,stocks:_0x40d330,return_qty:_0x5234d9,note:_0x56074d,to_warehouse_name:_0x1769a2,to_Room_name:_0x3919af}=_0x44c812[_0x2edb1b(0x116)];console[_0x2edb1b(0x130)](_0x44c812['body']);if(typeof _0x3ef4bb==_0x2edb1b(0x142))var _0x4e1b97=[_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x125)]],_0x4efa70=[_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0xed)]],_0x48eeb7=[_0x44c812['body'][_0x2edb1b(0x151)]],_0x2c9371=[_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0xee)]],_0x40e54a=[_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x10c)]],_0x40bbe9=[_0x44c812['body'][_0x2edb1b(0xe7)]],_0x414991=[_0x44c812['body']['return_qty']],_0x444deb=[_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0xe4)]],_0x27290b=[_0x44c812[_0x2edb1b(0x116)]['bin']],_0x5a6877=[_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0xfd)]],_0x4e163d=[_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x14e)]];else var _0x4e1b97=[..._0x44c812['body'][_0x2edb1b(0x125)]],_0x4efa70=[..._0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0xed)]],_0x48eeb7=[..._0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x151)]],_0x2c9371=[..._0x44c812['body'][_0x2edb1b(0xee)]],_0x40e54a=[..._0x44c812[_0x2edb1b(0x116)]['sales_quantity']],_0x40bbe9=[..._0x44c812[_0x2edb1b(0x116)]['stocks']],_0x414991=[..._0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x12e)]],_0x444deb=[..._0x44c812[_0x2edb1b(0x116)]['bay']],_0x27290b=[..._0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x12a)]],_0x5a6877=[..._0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0xfd)]],_0x4e163d=[..._0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0x14e)]];const _0x5d4cd1=_0x4e1b97[_0x2edb1b(0x143)](_0x4e3701=>{return _0x4e3701={'product_name':_0x4e3701};});_0x4efa70[_0x2edb1b(0x12f)]((_0xecb290,_0x3236e2)=>{var _0x254d2b=_0x2edb1b;_0x5d4cd1[_0x3236e2][_0x254d2b(0xed)]=_0xecb290;}),_0x48eeb7[_0x2edb1b(0x12f)]((_0x468792,_0x3acf95)=>{var _0x2bac8e=_0x2edb1b;_0x5d4cd1[_0x3acf95][_0x2bac8e(0x151)]=_0x468792;}),_0x2c9371[_0x2edb1b(0x12f)]((_0x2f5408,_0x4a224d)=>{var _0x45e5da=_0x2edb1b;_0x5d4cd1[_0x4a224d][_0x45e5da(0xee)]=_0x2f5408;}),_0x40e54a['forEach']((_0x21fcec,_0x3beff3)=>{_0x5d4cd1[_0x3beff3]['sale_qty']=_0x21fcec;}),_0x40bbe9[_0x2edb1b(0x12f)]((_0x8a6382,_0x42dfc5)=>{var _0x87c896=_0x2edb1b;_0x5d4cd1[_0x42dfc5][_0x87c896(0xfb)]=_0x8a6382;}),_0x414991[_0x2edb1b(0x12f)]((_0x1d6e00,_0x125823)=>{_0x5d4cd1[_0x125823]['return_qty']=_0x1d6e00;}),_0x444deb[_0x2edb1b(0x12f)]((_0x4c98f2,_0x59441a)=>{_0x5d4cd1[_0x59441a]['bay']=_0x4c98f2;}),_0x27290b['forEach']((_0x3079be,_0x2f4a67)=>{var _0x3b7202=_0x2edb1b;_0x5d4cd1[_0x2f4a67][_0x3b7202(0x12a)]=_0x3079be;}),_0x5a6877[_0x2edb1b(0x12f)]((_0x82cccb,_0x4d1860)=>{var _0x2098e4=_0x2edb1b;_0x5d4cd1[_0x4d1860][_0x2098e4(0x14d)]=_0x82cccb;}),_0x4e163d[_0x2edb1b(0x12f)]((_0x3593d6,_0x5b3581)=>{var _0x384eb2=_0x2edb1b;_0x5d4cd1[_0x5b3581][_0x384eb2(0x14e)]=_0x3593d6;});var _0x44d392=0x0;_0x5d4cd1[_0x2edb1b(0x12f)](_0x1d8e57=>{var _0x1b0a93=_0x2edb1b;console[_0x1b0a93(0x130)](_0x1b0a93(0x107),_0x1d8e57),(parseInt(_0x1d8e57[_0x1b0a93(0x137)])<parseInt(_0x1d8e57[_0x1b0a93(0x12e)])||parseInt(_0x1d8e57[_0x1b0a93(0xfb)])<parseInt(_0x1d8e57[_0x1b0a93(0x12e)])&&parseInt(_0x1d8e57[_0x1b0a93(0x137)])>parseInt(_0x1d8e57['return_qty'])||parseInt(_0x1d8e57['return_qty'])==0x0)&&_0x44d392++;});if(_0x44d392!=0x0)return _0x44c812['flash'](_0x2edb1b(0x128),_0x2edb1b(0xff)),_0x9507ba[_0x2edb1b(0x100)](_0x2edb1b(0x11a));_0x5a2434['return_sale'][_0x2edb1b(0x12f)](_0xd92504=>{var _0xa93ecf=_0x2edb1b;const _0x2a3726=_0x2ddac8[_0xa93ecf(0x108)]['map'](_0x30df25=>{var _0x3fc317=_0xa93ecf;_0x30df25['product_name']==_0xd92504[_0x3fc317(0x125)]&&_0x30df25[_0x3fc317(0x14e)]==_0xd92504['floorlevel']&&_0x30df25[_0x3fc317(0x14d)]==_0xd92504[_0x3fc317(0x14d)]&&_0x30df25[_0x3fc317(0x12a)]==_0xd92504[_0x3fc317(0x12a)]&&_0x30df25[_0x3fc317(0xe4)]==_0xd92504['bay']&&(_0x30df25[_0x3fc317(0x13c)]=parseInt(_0x30df25[_0x3fc317(0x13c)])+parseInt(_0xd92504[_0x3fc317(0x12e)]));});}),console[_0x2edb1b(0x130)](_0x2edb1b(0xfe),_0x2ddac8),await _0x2ddac8[_0x2edb1b(0x10f)](),_0x5a2434[_0x2edb1b(0x117)]=_0x7055a5,_0x5a2434[_0x2edb1b(0x144)]=_0x13d595,_0x5a2434[_0x2edb1b(0x103)]=_0x30939e,_0x5a2434[_0x2edb1b(0x15a)]=_0xecd781,_0x5a2434['return_sale']=_0x5d4cd1,_0x5a2434[_0x2edb1b(0x13f)]=_0x56074d,_0x5a2434[_0x2edb1b(0x140)]=_0x1769a2,_0x5a2434[_0x2edb1b(0xf4)]=_0x3919af;const _0x57bcad=await _0x5a2434[_0x2edb1b(0x10f)]();console[_0x2edb1b(0x130)](_0x2edb1b(0x10b),_0x57bcad);const _0x28a3c6=await c_payment_data['findOne']({'invoice':_0x44c812['body']['invoice'],'reason':_0x2edb1b(0x12c)});_0x28a3c6[_0x2edb1b(0xfa)]=_0x44c812[_0x2edb1b(0x116)][_0x2edb1b(0xfa)],_0x28a3c6['date']=_0x44c812['body'][_0x2edb1b(0x103)],await _0x28a3c6[_0x2edb1b(0x10f)](),_0x44c812[_0x2edb1b(0x11f)](_0x2edb1b(0x14b),_0x2edb1b(0x14f)),_0x9507ba[_0x2edb1b(0x100)](_0x2edb1b(0x146));}catch(_0x435e68){console['log'](_0x435e68),_0x9507ba['status'](0xc8)[_0x2edb1b(0x138)]({'message':_0x435e68[_0x2edb1b(0x148)]});}}),router[a0_0x180067(0x109)](a0_0x180067(0x136),auth,async(_0x5ab2cf,_0x2257ea)=>{var _0x35fe8a=a0_0x180067;try{const _0x4c57ef=_0x5ab2cf[_0x35fe8a(0x150)]['id'],{invoice:_0x57521e,customer:_0x4e240a,payable_to_customer:_0x889b3c,paid_amount:_0x3732fa}=_0x5ab2cf[_0x35fe8a(0x116)],_0x515b14=await sales_return[_0x35fe8a(0x115)](_0x4c57ef);console['log']('data',_0x515b14),console[_0x35fe8a(0x130)](_0x889b3c),console[_0x35fe8a(0x130)](_0x3732fa);var _0xdeaa2e=_0x889b3c-_0x3732fa;console[_0x35fe8a(0x130)](_0x35fe8a(0x111),_0xdeaa2e),_0x515b14['paid_amount']=parseFloat(_0x3732fa)+parseFloat(_0x515b14[_0x35fe8a(0x11e)]),_0x515b14[_0x35fe8a(0x147)]=_0xdeaa2e,console[_0x35fe8a(0x130)](_0x515b14);const _0x12494e=await _0x515b14[_0x35fe8a(0x10f)]();console[_0x35fe8a(0x130)](0x1b207);const _0x27e7fc=await c_payment_data['findOne']({'invoice':_0x5ab2cf[_0x35fe8a(0x116)][_0x35fe8a(0x117)],'reason':'Sale\x20Return'});console['log']('c_payment',_0x27e7fc),_0x27e7fc['amount']=_0xdeaa2e,await _0x27e7fc[_0x35fe8a(0x10f)]();let _0x586c3f=new Date(),_0x4a8387=('0'+_0x586c3f[_0x35fe8a(0xef)]())[_0x35fe8a(0x118)](-0x2),_0x1dcebd=('0'+(_0x586c3f[_0x35fe8a(0x101)]()+0x1))[_0x35fe8a(0x118)](-0x2),_0x18bb60=_0x586c3f[_0x35fe8a(0x15c)](),_0xd77fde=_0x18bb60+'-'+_0x1dcebd+'-'+_0x4a8387;const _0x2f6b4f=new customer_payment({'invoice':_0x57521e,'date':_0x18bb60+'-'+_0x1dcebd+'-'+_0x4a8387,'customer':_0x4e240a,'reason':_0x35fe8a(0x133),'amount':_0x3732fa}),_0x397692=await _0x2f6b4f[_0x35fe8a(0x10f)]();_0x5ab2cf[_0x35fe8a(0x11f)](_0x35fe8a(0x14b),_0x35fe8a(0xf2)),_0x2257ea[_0x35fe8a(0x100)](_0x35fe8a(0x146));}catch(_0x323f55){console[_0x35fe8a(0x130)](_0x323f55);}}),router[a0_0x180067(0x13e)]('/invoice/:id',auth,async(_0x760ac8,_0x34b597)=>{var _0x3f3021=a0_0x180067;try{const {username:_0x3caf4c,email:_0x8e4267,role:_0x3a2f2a}=_0x760ac8[_0x3f3021(0x15b)],_0x6ef7d2=_0x760ac8[_0x3f3021(0x15b)],_0x3fdd19=await profile[_0x3f3021(0x119)]({'email':_0x6ef7d2[_0x3f3021(0x155)]}),_0x146592=await master_shop[_0x3f3021(0x12b)]();console[_0x3f3021(0x130)](_0x3f3021(0xf5),_0x146592);const _0x4d30fc=_0x760ac8['params']['id'],_0x4a1c1c=await sales_return[_0x3f3021(0x115)](_0x4d30fc);console[_0x3f3021(0x130)](_0x4a1c1c);const _0x36054a=await customer['findOne']({'name':_0x4a1c1c[_0x3f3021(0x144)]});console['log'](_0x36054a);if(_0x146592[0x0][_0x3f3021(0x14c)]==_0x3f3021(0x105)){var _0xd18878=users[_0x3f3021(0x139)];console[_0x3f3021(0x130)](_0xd18878);}else{if(_0x146592[0x0]['language']==_0x3f3021(0xf6))var _0xd18878=users[_0x3f3021(0xf6)];else{if(_0x146592[0x0][_0x3f3021(0x14c)]==_0x3f3021(0x127))var _0xd18878=users[_0x3f3021(0x127)];else{if(_0x146592[0x0]['language']==_0x3f3021(0x134))var _0xd18878=users[_0x3f3021(0x134)];else{if(_0x146592[0x0]['language']==_0x3f3021(0x123))var _0xd18878=users[_0x3f3021(0x123)];else{if(_0x146592[0x0][_0x3f3021(0x14c)]==_0x3f3021(0xeb))var _0xd18878=users[_0x3f3021(0xe9)];else{if(_0x146592[0x0][_0x3f3021(0x14c)]==_0x3f3021(0xf9))var _0xd18878=users['Chinese'];else{if(_0x146592[0x0]['language']==_0x3f3021(0x112))var _0xd18878=users['Arabic'];}}}}}}}_0x34b597[_0x3f3021(0x14a)]('sales_return_invoice',{'success':_0x760ac8[_0x3f3021(0x11f)]('success'),'errors':_0x760ac8[_0x3f3021(0x11f)](_0x3f3021(0x128)),'role':_0x6ef7d2,'profile':_0x3fdd19,'master_shop':_0x146592,'customers':_0x36054a,'sales':_0x4a1c1c,'language':_0xd18878});}catch(_0x1d72e6){console[_0x3f3021(0x130)](_0x1d72e6);}}),module[a0_0x180067(0x15d)]=router;function a0_0x4fed(_0xe63081,_0x3e314a){var _0x2efab8=a0_0x2efa();return a0_0x4fed=function(_0x4fedd7,_0x49b530){_0x4fedd7=_0x4fedd7-0xe4;var _0x11db88=_0x2efab8[_0x4fedd7];return _0x11db88;},a0_0x4fed(_0xe63081,_0x3e314a);}function a0_0x2efa(){var _0x340f73=['forEach','log','17160539WWPish','3223060zPriML','Returned\x20Payment\x20For\x20Sale\x20Return','Spanish','8389tFJWMH','/give_payment/:id','sale_qty','json','English','for_categorize','stocks_QA','product_stock','1521996RUMtTn','get','note','ToWarehouse','express','string','map','customer','Arabic','/sales_return/view','due_amount','message','../models/all_models','render','success','language','type','floorlevel','purchase\x20return\x20successfully','params','secondary_code','name','product_code_QA','$product_details.secondary_code','email','../middleware/auth','$product_details.primary_code','$product_details.storage','customer_docs','warehouse_name','user','getFullYear','exports','$product_details.floorlevel','old_data','$product_details.product_code','/view/:id','bay','9PKciHF','../public/language/languages.json','stocks','$product_details.rack','Portuguese','/view','Portuguese\x20(BR)','return_sale_edit_finished','primary_code','product_code','getDate','aggregate','$product_details._id','payment\x20successfull','$product_details.type','ToRoom','master','Hindi','4916770UUDpsx','12XQbChw','Chinese','suppliers','stock','8KbiDyR','types','old_warehouse_data','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','redirect','getMonth','262zEoKvk','date','$product_details.product_name','English\x20(US)','/sales_return_finished/view','foreach\x20newproduct','product_details','post','6438456NPTBtW','new\x20new_data','sales_quantity','return_sale_QA','9245901lhWHJz','save','return_qty_QA','subtract','Arabic\x20(ae)','$customer_docs','$product_details','findById','body','invoice','slice','findOne','back','sales_return_finished','$product_details.bay','Enabled','paid_amount','flash','secondary_code_QA','primary_code_QA','product_name_QA','French','$name','product_name','status','German','errors','8XsqopC','bin','find','Sale\x20Return','sales_quantity_QA','return_qty'];a0_0x2efa=function(){return _0x340f73;};return a0_0x2efa();}