function a0_0x47d5(){var _0x59cbb5=['map','sale_qty','return_sale_edit_finished','foreach\x20newproduct','email','Arabic\x20(ae)','return_sale','Returned\x20Payment\x20For\x20Sale\x20Return','json','$product_details.primary_code','$product_details.product_name','German','Router','save','$product_details.floorlevel','/view','customer','note','find','params','suppliers','bin','$product_details.storage','secondary_code_QA','/sales_return_finished/view','user','6111936oRIypt','for_categorize','c_payment','240945lxOPxH','Enabled','invoice','product_name','body','errors','QA\x20Warehouse','673224DEgbFK','render','ToWarehouse','amount','master','language','$product_details.bin','224lTKlNA','/view/:id','$product_details.product_code','name','stocks','types','../public/language/languages.json','message','bay','success','$product_details.secondary_code','forEach','sales_return_invoice','log','type','product_code','aggregate','old_warehouse_data','status','$product_details.rack','sales_return_finished','594950LbjDtJ','Return\x20Rooms','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','back','Portuguese','$product_details.type','getMonth','English','purchase\x20return\x20successfully','paid_amount','Sale\x20Return','$product_details.bay','data','Arabic','return_sale_QA','getFullYear','slice','stocks_QA','../middleware/auth','523486xsSLsS','product_details','findOne','string','primary_code','Chinese','express','return_qty','Spanish','stock','2JqFmZS','166008bcAGUh','secondary_code','product_name_QA','get','$customer_docs','French','Hindi','floorlevel','/give_payment/:id','return_qty_QA','warehouse_name','$product_details','$name','/sales_return/view','$product_details._id','Portuguese\x20(BR)','customers','ToRoom','post','5836140XmjTyF','product_code_QA','product_stock','primary_code_QA','redirect','../models/all_models','findById','sales_quantity','getDate','date','English\x20(US)','due_amount','27BnioaJ','flash','sales_quantity_QA'];a0_0x47d5=function(){return _0x59cbb5;};return a0_0x47d5();}var a0_0x5588eb=a0_0x4e22;(function(_0x56d0a2,_0x3e85cb){var _0x5d3142=a0_0x4e22,_0x465163=_0x56d0a2();while(!![]){try{var _0x3690e7=parseInt(_0x5d3142(0xff))/0x1+parseInt(_0x5d3142(0x109))/0x2*(parseInt(_0x5d3142(0x149))/0x3)+parseInt(_0x5d3142(0x150))/0x4+-parseInt(_0x5d3142(0x16c))/0x5+-parseInt(_0x5d3142(0x10a))/0x6*(-parseInt(_0x5d3142(0x157))/0x7)+parseInt(_0x5d3142(0x146))/0x8+-parseInt(_0x5d3142(0x129))/0x9*(parseInt(_0x5d3142(0x11d))/0xa);if(_0x3690e7===_0x3e85cb)break;else _0x465163['push'](_0x465163['shift']());}catch(_0x162f80){_0x465163['push'](_0x465163['shift']());}}}(a0_0x47d5,0x86adb));function a0_0x4e22(_0x58016c,_0x4c5021){var _0x47d58a=a0_0x47d5();return a0_0x4e22=function(_0x4e2260,_0x1caa0a){_0x4e2260=_0x4e2260-0xfd;var _0x7441ad=_0x47d58a[_0x4e2260];return _0x7441ad;},a0_0x4e22(_0x58016c,_0x4c5021);}const express=require(a0_0x5588eb(0x105)),app=express(),router=express[a0_0x5588eb(0x138)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x5588eb(0x122)),auth=require(a0_0x5588eb(0xfe)),users=require(a0_0x5588eb(0x15d));router[a0_0x5588eb(0x10d)](a0_0x5588eb(0x13b),auth,async(_0x10dbfb,_0x3b977a)=>{var _0x171195=a0_0x5588eb;try{const {username:_0x578a4b,email:_0xd2b9f9,role:_0x387511}=_0x10dbfb[_0x171195(0x145)],_0x433bb8=_0x10dbfb[_0x171195(0x145)],_0x4e8a8a=await profile[_0x171195(0x101)]({'email':_0x433bb8[_0x171195(0x130)]}),_0x33504c=await master_shop['find'](),_0x49cb78=await sales_return_finished[_0x171195(0x167)]([{'$lookup':{'from':_0x171195(0x11a),'localField':_0x171195(0x13c),'foreignField':_0x171195(0x15a),'as':'customer_docs'}},{'$unwind':_0x171195(0x10e)}]);if(_0x33504c[0x0][_0x171195(0x155)]==_0x171195(0x127)){var _0x2fa2b8=users[_0x171195(0x173)];console[_0x171195(0x164)](_0x2fa2b8);}else{if(_0x33504c[0x0][_0x171195(0x155)]==_0x171195(0x110))var _0x2fa2b8=users[_0x171195(0x110)];else{if(_0x33504c[0x0]['language']==_0x171195(0x137))var _0x2fa2b8=users[_0x171195(0x137)];else{if(_0x33504c[0x0][_0x171195(0x155)]==_0x171195(0x107))var _0x2fa2b8=users[_0x171195(0x107)];else{if(_0x33504c[0x0][_0x171195(0x155)]==_0x171195(0x10f))var _0x2fa2b8=users[_0x171195(0x10f)];else{if(_0x33504c[0x0][_0x171195(0x155)]==_0x171195(0x119))var _0x2fa2b8=users[_0x171195(0x170)];else{if(_0x33504c[0x0]['language']==_0x171195(0x104))var _0x2fa2b8=users[_0x171195(0x104)];else{if(_0x33504c[0x0][_0x171195(0x155)]==_0x171195(0x131))var _0x2fa2b8=users[_0x171195(0x179)];}}}}}}}_0x3b977a[_0x171195(0x151)](_0x171195(0x16b),{'success':_0x10dbfb[_0x171195(0x12a)](_0x171195(0x160)),'errors':_0x10dbfb['flash']('errors'),'role':_0x433bb8,'profile':_0x4e8a8a,'master_shop':_0x33504c,'user':_0x49cb78,'language':_0x2fa2b8});}catch(_0x9c9c0e){console[_0x171195(0x164)](_0x9c9c0e);}}),router['get'](a0_0x5588eb(0x158),auth,async(_0x436d12,_0x3af490)=>{var _0x487304=a0_0x5588eb;try{const {username:_0x41cdd8,email:_0x5ddd5b,role:_0x1e86ab}=_0x436d12[_0x487304(0x145)],_0x98983c=_0x436d12[_0x487304(0x145)],_0x1eef4a=await profile['findOne']({'email':_0x98983c['email']}),_0x561d3f=await master_shop[_0x487304(0x13e)]();console['log'](_0x487304(0x154),_0x561d3f);const _0x653c48=_0x436d12[_0x487304(0x13f)]['id'];console[_0x487304(0x164)](_0x653c48);var _0x41b03c=[_0x487304(0x16d)];const _0x5524ba=await sales_return_finished[_0x487304(0x123)](_0x653c48),_0x4bf193=await warehouse['aggregate']([{'$match':{'name':_0x5524ba['ToWarehouse'],'room':_0x5524ba[_0x487304(0x11b)]}},{'$unwind':_0x487304(0x115)},{'$group':{'_id':_0x487304(0x118),'name':{'$first':_0x487304(0x136)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x487304(0x177)},'bin':{'$first':_0x487304(0x156)},'type':{'$first':_0x487304(0x171)},'floorlevel':{'$first':_0x487304(0x13a)},'primary_code':{'$first':_0x487304(0x135)},'secondary_code':{'$first':_0x487304(0x161)},'product_code':{'$first':_0x487304(0x159)},'storage':{'$first':_0x487304(0x142)},'rack':{'$first':_0x487304(0x16a)}}}]);console[_0x487304(0x164)](_0x4bf193);const _0x59a9a1=await warehouse[_0x487304(0x167)]([{'$match':{'status':_0x487304(0x14a),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':'$name','name':{'$first':_0x487304(0x116)}}},{'$sort':{'name':0x1}}]),_0x2d5c84=await warehouse[_0x487304(0x167)]([{'$match':{'status':_0x487304(0x14a),'name':_0x487304(0x14f)}},{'$group':{'_id':_0x487304(0x116),'name':{'$first':_0x487304(0x116)}}},{'$sort':{'name':0x1}}]),_0x3df317=await product['find']({});if(_0x561d3f[0x0][_0x487304(0x155)]=='English\x20(US)'){var _0x2a0a18=users[_0x487304(0x173)];console[_0x487304(0x164)](_0x2a0a18);}else{if(_0x561d3f[0x0][_0x487304(0x155)]==_0x487304(0x110))var _0x2a0a18=users[_0x487304(0x110)];else{if(_0x561d3f[0x0][_0x487304(0x155)]=='German')var _0x2a0a18=users['German'];else{if(_0x561d3f[0x0][_0x487304(0x155)]==_0x487304(0x107))var _0x2a0a18=users[_0x487304(0x107)];else{if(_0x561d3f[0x0][_0x487304(0x155)]=='French')var _0x2a0a18=users['French'];else{if(_0x561d3f[0x0][_0x487304(0x155)]==_0x487304(0x119))var _0x2a0a18=users[_0x487304(0x170)];else{if(_0x561d3f[0x0][_0x487304(0x155)]==_0x487304(0x104))var _0x2a0a18=users[_0x487304(0x104)];else{if(_0x561d3f[0x0][_0x487304(0x155)]=='Arabic\x20(ae)')var _0x2a0a18=users[_0x487304(0x179)];}}}}}}}_0x3af490[_0x487304(0x151)](_0x487304(0x12e),{'success':_0x436d12['flash'](_0x487304(0x160)),'errors':_0x436d12[_0x487304(0x12a)](_0x487304(0x14e)),'role':_0x98983c,'profile':_0x1eef4a,'master_shop':_0x561d3f,'user':_0x5524ba,'stock':_0x4bf193,'unit':_0x3df317,'language':_0x2a0a18,'warehouses':_0x59a9a1,'rooms':_0x41b03c,'warehouse_QA':_0x2d5c84});}catch(_0x3e4e36){console[_0x487304(0x164)](_0x3e4e36);}}),router[a0_0x5588eb(0x11c)](a0_0x5588eb(0x158),auth,async(_0x2a22a0,_0x2eda7a)=>{var _0x232838=a0_0x5588eb;if(_0x2a22a0['body'][_0x232838(0x147)]=='QA')try{const _0x54ac98=_0x2a22a0[_0x232838(0x13f)]['id'],_0x50240f=await sales_return[_0x232838(0x101)]({'invoice':_0x2a22a0[_0x232838(0x14d)][_0x232838(0x14b)]}),_0xf93bdf=await warehouse[_0x232838(0x101)]({'name':_0x50240f[_0x232838(0x152)],'room':_0x50240f[_0x232838(0x11b)]}),{invoice:_0x253f08,customer:_0x40be2a,date:_0x19b89c,warehouse_name:_0x35345e,product_name:_0x55d01c,primary_code:_0xcb99b3,secondary_code:_0x2db866,product_code:_0x554593,sales_quantity:_0x4006c0,stocks:_0x30f38c,return_qty:_0x467753,note:_0x530af8,to_warehouse_name_QA:_0x3fd996,to_Room_name_QA:_0x51e313}=_0x2a22a0[_0x232838(0x14d)];if(typeof product_name_QA=='string')var _0xe8b16e=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x10c)]],_0x175875=[_0x2a22a0[_0x232838(0x14d)]['primary_code_QA']],_0x2d8d6c=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x143)]],_0x518a88=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x11e)]],_0x465e02=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x12b)]],_0x276e6c=[_0x2a22a0['body'][_0x232838(0xfd)]],_0xb1ab0d=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x113)]];else var _0xe8b16e=[..._0x2a22a0[_0x232838(0x14d)][_0x232838(0x10c)]],_0x175875=[..._0x2a22a0[_0x232838(0x14d)][_0x232838(0x120)]],_0x2d8d6c=[..._0x2a22a0['body'][_0x232838(0x143)]],_0x518a88=[..._0x2a22a0[_0x232838(0x14d)][_0x232838(0x11e)]],_0x465e02=[..._0x2a22a0[_0x232838(0x14d)][_0x232838(0x12b)]],_0x276e6c=[..._0x2a22a0[_0x232838(0x14d)]['stocks_QA']],_0xb1ab0d=[..._0x2a22a0[_0x232838(0x14d)][_0x232838(0x113)]];const _0x5f516a=_0xe8b16e['map'](_0x2bd8d3=>{return _0x2bd8d3={'product_name':_0x2bd8d3};});_0x175875[_0x232838(0x162)]((_0x2c2c44,_0x24509a)=>{var _0x30ff54=_0x232838;_0x5f516a[_0x24509a][_0x30ff54(0x103)]=_0x2c2c44;}),_0x2d8d6c[_0x232838(0x162)]((_0xcd30a,_0x4e26ba)=>{var _0x56e899=_0x232838;_0x5f516a[_0x4e26ba][_0x56e899(0x10b)]=_0xcd30a;}),_0x518a88[_0x232838(0x162)]((_0x2fffd1,_0x21974b)=>{var _0x78a9f9=_0x232838;_0x5f516a[_0x21974b][_0x78a9f9(0x166)]=_0x2fffd1;}),_0x465e02[_0x232838(0x162)]((_0x5450cc,_0x2425f4)=>{var _0x1a6508=_0x232838;_0x5f516a[_0x2425f4][_0x1a6508(0x12d)]=_0x5450cc;}),_0x276e6c['forEach']((_0x5e071e,_0x2a580c)=>{var _0xb96a74=_0x232838;_0x5f516a[_0x2a580c][_0xb96a74(0x108)]=_0x5e071e;}),_0xb1ab0d[_0x232838(0x162)]((_0x3712d3,_0x5a2c11)=>{_0x5f516a[_0x5a2c11]['return_qty']=_0x3712d3;}),_0x50240f[_0x232838(0x17a)][_0x232838(0x162)](_0x1c6c55=>{var _0x5cca2e=_0x232838;const _0x3011a2=_0xf93bdf['product_details'][_0x5cca2e(0x12c)](_0x32bca8=>{var _0x42794e=_0x5cca2e;_0x32bca8[_0x42794e(0x14c)]==_0x1c6c55[_0x42794e(0x14c)]&&(_0x32bca8[_0x42794e(0x11f)]=parseInt(_0x32bca8[_0x42794e(0x11f)])+parseInt(_0x1c6c55[_0x42794e(0x106)]));});}),await _0xf93bdf[_0x232838(0x139)](),_0x50240f[_0x232838(0x14b)]=_0x253f08,_0x50240f[_0x232838(0x13c)]=_0x40be2a,_0x50240f[_0x232838(0x126)]=_0x19b89c,_0x50240f[_0x232838(0x114)]=_0x35345e,_0x50240f[_0x232838(0x17a)]=_0x5f516a,_0x50240f[_0x232838(0x13d)]=_0x530af8,_0x50240f[_0x232838(0x152)]=_0x3fd996,_0x50240f['ToRoom']=_0x51e313;const _0x426eb1=await _0x50240f[_0x232838(0x139)](),_0x210415=await c_payment_data['findOne']({'invoice':_0x2a22a0[_0x232838(0x14d)][_0x232838(0x14b)],'reason':_0x232838(0x176)});_0x210415[_0x232838(0x140)]=_0x2a22a0['body'][_0x232838(0x140)],_0x210415[_0x232838(0x126)]=_0x2a22a0['body']['date'],await _0x210415[_0x232838(0x139)](),_0x2a22a0[_0x232838(0x12a)](_0x232838(0x160),_0x232838(0x174)),_0x2eda7a['redirect'](_0x232838(0x144));}catch(_0x417d43){console['log'](_0x417d43),_0x2eda7a['status'](0xc8)[_0x232838(0x134)]({'message':_0x417d43['message']});}else try{const _0x3531cb=_0x2a22a0[_0x232838(0x13f)]['id'];console[_0x232838(0x164)](_0x3531cb);const _0x2d932d=await sales_return[_0x232838(0x101)]({'invoice':_0x2a22a0[_0x232838(0x14d)][_0x232838(0x14b)]});console[_0x232838(0x164)]('old_data',_0x2d932d);const _0x51f84c=await warehouse['findOne']({'name':_0x2d932d[_0x232838(0x152)],'room':_0x2d932d['ToRoom']});console[_0x232838(0x164)]('old_warehouse_data',_0x51f84c);const {invoice:_0x4ccd6b,customer:_0x43996b,date:_0x3237cf,warehouse_name:_0xba5de8,product_name:_0x2ff173,primary_code:_0x2ee6f4,secondary_code:_0x1ec59f,product_code:_0x5d97d5,sales_quantity:_0x3a0efe,stocks:_0x1ccc37,return_qty:_0x3cebdb,note:_0x31a333,to_warehouse_name:_0x4b3820,to_Room_name:_0x5be6b6}=_0x2a22a0[_0x232838(0x14d)];console[_0x232838(0x164)](_0x2a22a0[_0x232838(0x14d)]);if(typeof _0x2ff173==_0x232838(0x102))var _0xe8b16e=[_0x2a22a0[_0x232838(0x14d)]['product_name']],_0x175875=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x103)]],_0x2d8d6c=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x10b)]],_0x518a88=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x166)]],_0x465e02=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x124)]],_0x276e6c=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x15b)]],_0xb1ab0d=[_0x2a22a0['body'][_0x232838(0x106)]],_0xd823e6=[_0x2a22a0['body']['bay']],_0x453dfa=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x141)]],_0x3ce414=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x15c)]],_0x5b73cd=[_0x2a22a0[_0x232838(0x14d)][_0x232838(0x111)]];else var _0xe8b16e=[..._0x2a22a0['body']['product_name']],_0x175875=[..._0x2a22a0[_0x232838(0x14d)][_0x232838(0x103)]],_0x2d8d6c=[..._0x2a22a0[_0x232838(0x14d)][_0x232838(0x10b)]],_0x518a88=[..._0x2a22a0[_0x232838(0x14d)]['product_code']],_0x465e02=[..._0x2a22a0['body'][_0x232838(0x124)]],_0x276e6c=[..._0x2a22a0[_0x232838(0x14d)][_0x232838(0x15b)]],_0xb1ab0d=[..._0x2a22a0['body']['return_qty']],_0xd823e6=[..._0x2a22a0[_0x232838(0x14d)][_0x232838(0x15f)]],_0x453dfa=[..._0x2a22a0['body']['bin']],_0x3ce414=[..._0x2a22a0[_0x232838(0x14d)][_0x232838(0x15c)]],_0x5b73cd=[..._0x2a22a0[_0x232838(0x14d)]['floorlevel']];const _0x26c48c=_0xe8b16e[_0x232838(0x12c)](_0x2203d4=>{return _0x2203d4={'product_name':_0x2203d4};});_0x175875['forEach']((_0x324d36,_0x599546)=>{_0x26c48c[_0x599546]['primary_code']=_0x324d36;}),_0x2d8d6c[_0x232838(0x162)]((_0x133fa4,_0x3dc0d9)=>{var _0x308464=_0x232838;_0x26c48c[_0x3dc0d9][_0x308464(0x10b)]=_0x133fa4;}),_0x518a88[_0x232838(0x162)]((_0x4e4066,_0x30a73e)=>{var _0x4e47ba=_0x232838;_0x26c48c[_0x30a73e][_0x4e47ba(0x166)]=_0x4e4066;}),_0x465e02[_0x232838(0x162)]((_0x369c5c,_0x45afe3)=>{_0x26c48c[_0x45afe3]['sale_qty']=_0x369c5c;}),_0x276e6c[_0x232838(0x162)]((_0x3dac47,_0xae02fc)=>{var _0x5410b6=_0x232838;_0x26c48c[_0xae02fc][_0x5410b6(0x108)]=_0x3dac47;}),_0xb1ab0d['forEach']((_0x216a0c,_0x3d1559)=>{var _0x3c1b55=_0x232838;_0x26c48c[_0x3d1559][_0x3c1b55(0x106)]=_0x216a0c;}),_0xd823e6[_0x232838(0x162)]((_0x1bbfbc,_0x790157)=>{var _0x20eb66=_0x232838;_0x26c48c[_0x790157][_0x20eb66(0x15f)]=_0x1bbfbc;}),_0x453dfa[_0x232838(0x162)]((_0x47496f,_0x16c65e)=>{var _0x6577e8=_0x232838;_0x26c48c[_0x16c65e][_0x6577e8(0x141)]=_0x47496f;}),_0x3ce414['forEach']((_0x57a0d9,_0x529213)=>{var _0x7564c9=_0x232838;_0x26c48c[_0x529213][_0x7564c9(0x165)]=_0x57a0d9;}),_0x5b73cd['forEach']((_0xefcca0,_0x599b22)=>{var _0x3a37a4=_0x232838;_0x26c48c[_0x599b22][_0x3a37a4(0x111)]=_0xefcca0;});var _0x206d2d=0x0;_0x26c48c[_0x232838(0x162)](_0x4fbf9c=>{var _0xaefbf8=_0x232838;console[_0xaefbf8(0x164)](_0xaefbf8(0x12f),_0x4fbf9c),(parseInt(_0x4fbf9c[_0xaefbf8(0x12d)])<parseInt(_0x4fbf9c[_0xaefbf8(0x106)])||parseInt(_0x4fbf9c[_0xaefbf8(0x108)])<parseInt(_0x4fbf9c[_0xaefbf8(0x106)])&&parseInt(_0x4fbf9c[_0xaefbf8(0x12d)])>parseInt(_0x4fbf9c[_0xaefbf8(0x106)])||parseInt(_0x4fbf9c[_0xaefbf8(0x106)])==0x0)&&_0x206d2d++;});if(_0x206d2d!=0x0)return _0x2a22a0[_0x232838(0x12a)](_0x232838(0x14e),_0x232838(0x16e)),_0x2eda7a[_0x232838(0x121)](_0x232838(0x16f));_0x2d932d[_0x232838(0x132)][_0x232838(0x162)](_0x2f2760=>{var _0x4332cf=_0x232838;const _0x1b83c9=_0x51f84c[_0x4332cf(0x100)][_0x4332cf(0x12c)](_0x1742a0=>{var _0x1c3e70=_0x4332cf;_0x1742a0['product_name']==_0x2f2760['product_name']&&_0x1742a0[_0x1c3e70(0x111)]==_0x2f2760[_0x1c3e70(0x111)]&&_0x1742a0[_0x1c3e70(0x165)]==_0x2f2760[_0x1c3e70(0x165)]&&_0x1742a0['bin']==_0x2f2760[_0x1c3e70(0x141)]&&_0x1742a0[_0x1c3e70(0x15f)]==_0x2f2760[_0x1c3e70(0x15f)]&&(_0x1742a0[_0x1c3e70(0x11f)]=parseInt(_0x1742a0[_0x1c3e70(0x11f)])+parseInt(_0x2f2760[_0x1c3e70(0x106)]));});}),console['log'](_0x232838(0x168),_0x51f84c),await _0x51f84c[_0x232838(0x139)](),_0x2d932d[_0x232838(0x14b)]=_0x4ccd6b,_0x2d932d[_0x232838(0x13c)]=_0x43996b,_0x2d932d['date']=_0x3237cf,_0x2d932d[_0x232838(0x114)]=_0xba5de8,_0x2d932d[_0x232838(0x132)]=_0x26c48c,_0x2d932d[_0x232838(0x13d)]=_0x31a333,_0x2d932d['ToWarehouse']=_0x4b3820,_0x2d932d[_0x232838(0x11b)]=_0x5be6b6;const _0x128acc=await _0x2d932d[_0x232838(0x139)]();console[_0x232838(0x164)]('new\x20new_data',_0x128acc);const _0x4d8b8d=await c_payment_data[_0x232838(0x101)]({'invoice':_0x2a22a0[_0x232838(0x14d)][_0x232838(0x14b)],'reason':_0x232838(0x176)});_0x4d8b8d[_0x232838(0x140)]=_0x2a22a0[_0x232838(0x14d)][_0x232838(0x140)],_0x4d8b8d['date']=_0x2a22a0['body']['date'],await _0x4d8b8d[_0x232838(0x139)](),_0x2a22a0[_0x232838(0x12a)](_0x232838(0x160),_0x232838(0x174)),_0x2eda7a[_0x232838(0x121)](_0x232838(0x117));}catch(_0x3c62e3){console[_0x232838(0x164)](_0x3c62e3),_0x2eda7a[_0x232838(0x169)](0xc8)['json']({'message':_0x3c62e3[_0x232838(0x15e)]});}}),router[a0_0x5588eb(0x11c)](a0_0x5588eb(0x112),auth,async(_0x6a6f80,_0x57d0e3)=>{var _0x1c34f7=a0_0x5588eb;try{const _0x32e0fb=_0x6a6f80[_0x1c34f7(0x13f)]['id'],{invoice:_0x21ccac,customer:_0x55e5a4,payable_to_customer:_0x5e6761,paid_amount:_0x42ea37}=_0x6a6f80[_0x1c34f7(0x14d)],_0xfd69e4=await sales_return[_0x1c34f7(0x123)](_0x32e0fb);console[_0x1c34f7(0x164)](_0x1c34f7(0x178),_0xfd69e4),console[_0x1c34f7(0x164)](_0x5e6761),console[_0x1c34f7(0x164)](_0x42ea37);var _0x18f2d8=_0x5e6761-_0x42ea37;console['log']('subtract',_0x18f2d8),_0xfd69e4[_0x1c34f7(0x175)]=parseFloat(_0x42ea37)+parseFloat(_0xfd69e4[_0x1c34f7(0x175)]),_0xfd69e4[_0x1c34f7(0x128)]=_0x18f2d8,console['log'](_0xfd69e4);const _0x4d064a=await _0xfd69e4[_0x1c34f7(0x139)]();console[_0x1c34f7(0x164)](0x1b207);const _0x5ef668=await c_payment_data[_0x1c34f7(0x101)]({'invoice':_0x6a6f80[_0x1c34f7(0x14d)][_0x1c34f7(0x14b)],'reason':_0x1c34f7(0x176)});console['log'](_0x1c34f7(0x148),_0x5ef668),_0x5ef668[_0x1c34f7(0x153)]=_0x18f2d8,await _0x5ef668[_0x1c34f7(0x139)]();let _0x38ba0f=new Date(),_0x4fea19=('0'+_0x38ba0f[_0x1c34f7(0x125)]())[_0x1c34f7(0x17c)](-0x2),_0x5f2610=('0'+(_0x38ba0f[_0x1c34f7(0x172)]()+0x1))[_0x1c34f7(0x17c)](-0x2),_0xb8a308=_0x38ba0f[_0x1c34f7(0x17b)](),_0x5b85d6=_0xb8a308+'-'+_0x5f2610+'-'+_0x4fea19;const _0x17f1fb=new customer_payment({'invoice':_0x21ccac,'date':_0xb8a308+'-'+_0x5f2610+'-'+_0x4fea19,'customer':_0x55e5a4,'reason':_0x1c34f7(0x133),'amount':_0x42ea37}),_0x56f0e6=await _0x17f1fb[_0x1c34f7(0x139)]();_0x6a6f80[_0x1c34f7(0x12a)](_0x1c34f7(0x160),'payment\x20successfull'),_0x57d0e3['redirect'](_0x1c34f7(0x117));}catch(_0x46c447){console[_0x1c34f7(0x164)](_0x46c447);}}),router[a0_0x5588eb(0x10d)]('/invoice/:id',auth,async(_0xfae663,_0x534b65)=>{var _0x5b1689=a0_0x5588eb;try{const {username:_0x53a1c5,email:_0x783f7c,role:_0x46a0e2}=_0xfae663[_0x5b1689(0x145)],_0x5b6af3=_0xfae663[_0x5b1689(0x145)],_0x11b5e3=await profile['findOne']({'email':_0x5b6af3['email']}),_0x4764e5=await master_shop[_0x5b1689(0x13e)]();console[_0x5b1689(0x164)](_0x5b1689(0x154),_0x4764e5);const _0x4ae9bd=_0xfae663[_0x5b1689(0x13f)]['id'],_0x5a4e85=await sales_return['findById'](_0x4ae9bd);console['log'](_0x5a4e85);const _0x293568=await customer[_0x5b1689(0x101)]({'name':_0x5a4e85[_0x5b1689(0x13c)]});console[_0x5b1689(0x164)](_0x293568);if(_0x4764e5[0x0]['language']=='English\x20(US)'){var _0xc0bd2=users['English'];console[_0x5b1689(0x164)](_0xc0bd2);}else{if(_0x4764e5[0x0][_0x5b1689(0x155)]==_0x5b1689(0x110))var _0xc0bd2=users[_0x5b1689(0x110)];else{if(_0x4764e5[0x0][_0x5b1689(0x155)]==_0x5b1689(0x137))var _0xc0bd2=users['German'];else{if(_0x4764e5[0x0][_0x5b1689(0x155)]==_0x5b1689(0x107))var _0xc0bd2=users[_0x5b1689(0x107)];else{if(_0x4764e5[0x0]['language']==_0x5b1689(0x10f))var _0xc0bd2=users[_0x5b1689(0x10f)];else{if(_0x4764e5[0x0][_0x5b1689(0x155)]==_0x5b1689(0x119))var _0xc0bd2=users['Portuguese'];else{if(_0x4764e5[0x0]['language']=='Chinese')var _0xc0bd2=users[_0x5b1689(0x104)];else{if(_0x4764e5[0x0][_0x5b1689(0x155)]==_0x5b1689(0x131))var _0xc0bd2=users[_0x5b1689(0x179)];}}}}}}}_0x534b65[_0x5b1689(0x151)](_0x5b1689(0x163),{'success':_0xfae663[_0x5b1689(0x12a)](_0x5b1689(0x160)),'errors':_0xfae663['flash'](_0x5b1689(0x14e)),'role':_0x5b6af3,'profile':_0x11b5e3,'master_shop':_0x4764e5,'customers':_0x293568,'sales':_0x5a4e85,'language':_0xc0bd2});}catch(_0x3db1b6){console['log'](_0x3db1b6);}}),module['exports']=router;