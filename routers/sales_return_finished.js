var a0_0x361603=a0_0x5ad3;(function(_0x3ccdaa,_0x53428c){var _0x5375a9=a0_0x5ad3,_0x5dec4e=_0x3ccdaa();while(!![]){try{var _0x21b250=-parseInt(_0x5375a9(0xbf))/0x1+-parseInt(_0x5375a9(0xc0))/0x2*(-parseInt(_0x5375a9(0x126))/0x3)+parseInt(_0x5375a9(0x12c))/0x4*(-parseInt(_0x5375a9(0xfd))/0x5)+-parseInt(_0x5375a9(0x10e))/0x6+-parseInt(_0x5375a9(0x121))/0x7*(parseInt(_0x5375a9(0x12b))/0x8)+-parseInt(_0x5375a9(0x124))/0x9*(-parseInt(_0x5375a9(0x108))/0xa)+parseInt(_0x5375a9(0x11c))/0xb;if(_0x21b250===_0x53428c)break;else _0x5dec4e['push'](_0x5dec4e['shift']());}catch(_0x2c25a7){_0x5dec4e['push'](_0x5dec4e['shift']());}}}(a0_0x1167,0x4e17d));function a0_0x5ad3(_0x10cc43,_0x148b16){var _0x116720=a0_0x1167();return a0_0x5ad3=function(_0x5ad339,_0xb30466){_0x5ad339=_0x5ad339-0xb5;var _0x30e3bb=_0x116720[_0x5ad339];return _0x30e3bb;},a0_0x5ad3(_0x10cc43,_0x148b16);}function a0_0x1167(){var _0x5783a0=['/invoice/:id','secondary_code','old_data','note','post','$product_details.product_code','errors','return_sale','customer_docs','Arabic','invoice','ToRoom','/sales_return/view','type','ToWarehouse','/view/:id','back','customers','string','types','redirect','due_amount','paid_amount','findOne','sales_quantity','getFullYear','product_code_QA','bin','sales_return_finished','success','aggregate','$product_details.rack','English\x20(US)','render','Hindi','$product_details.bin','log','/give_payment/:id','subtract','status','master','sales_quantity_QA','primary_code','payment\x20successfull','new\x20new_data','return_sale_edit_finished','Finished\x20Goods','flash','Returned\x20Payment\x20For\x20Sale\x20Return','old_warehouse_data','$product_details.product_stock','5hVBXEr','name','map','body','stocks','$product_details.floorlevel','$product_details.primary_code','find','../models/all_models','Sale\x20Return','stocks_QA','64140irVZWC','get','$product_details.storage','product_details','for_categorize','params','3464916KGpvyT','bay','warehouse_name','secondary_code_QA','save','product_stock','Chinese','user','$customer_docs','customer','suppliers','email','Arabic\x20(ae)','Portuguese\x20(BR)','9881564lxRkfn','floorlevel','../middleware/auth','$product_details','date','26131iarCwH','message','product_code','477kJTGqO','$name','4074vKWbSV','return_qty','primary_code_QA','product_name','purchase\x20return\x20successfully','464RMXGvB','284996wSiKli','$product_details.product_name','slice','amount','sale_qty','/view','English','stock','return_qty_QA','French','Spanish','return_sale_QA','getDate','../public/language/languages.json','language','exports','json','562398kQDOdr','750wnlWCI','Router','forEach','QA\x20Warehouse','$product_details._id','findById','Portuguese','Enabled','product_name_QA','German'];a0_0x1167=function(){return _0x5783a0;};return a0_0x1167();}const express=require('express'),app=express(),router=express[a0_0x361603(0xc1)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x361603(0x105)),auth=require(a0_0x361603(0x11e)),users=require(a0_0x361603(0xbb));router[a0_0x361603(0x109)](a0_0x361603(0x131),auth,async(_0x49695c,_0xab5544)=>{var _0x517f64=a0_0x361603;try{const {username:_0x20b349,email:_0x560ed9,role:_0x55345a}=_0x49695c['user'],_0x251d71=_0x49695c[_0x517f64(0x115)],_0x197b29=await profile['findOne']({'email':_0x251d71[_0x517f64(0x119)]}),_0xf44d4c=await master_shop[_0x517f64(0x104)](),_0x3532df=await sales_return_finished[_0x517f64(0xe8)]([{'$lookup':{'from':_0x517f64(0xdb),'localField':_0x517f64(0x117),'foreignField':_0x517f64(0xfe),'as':_0x517f64(0xd2)}},{'$unwind':_0x517f64(0x116)}]);if(_0xf44d4c[0x0][_0x517f64(0xbc)]=='English\x20(US)'){var _0x2d611f=users[_0x517f64(0x132)];console[_0x517f64(0xee)](_0x2d611f);}else{if(_0xf44d4c[0x0][_0x517f64(0xbc)]==_0x517f64(0xec))var _0x2d611f=users['Hindi'];else{if(_0xf44d4c[0x0][_0x517f64(0xbc)]=='German')var _0x2d611f=users[_0x517f64(0xc9)];else{if(_0xf44d4c[0x0][_0x517f64(0xbc)]==_0x517f64(0xb8))var _0x2d611f=users['Spanish'];else{if(_0xf44d4c[0x0][_0x517f64(0xbc)]==_0x517f64(0xb7))var _0x2d611f=users[_0x517f64(0xb7)];else{if(_0xf44d4c[0x0]['language']==_0x517f64(0x11b))var _0x2d611f=users['Portuguese'];else{if(_0xf44d4c[0x0][_0x517f64(0xbc)]==_0x517f64(0x114))var _0x2d611f=users['Chinese'];else{if(_0xf44d4c[0x0][_0x517f64(0xbc)]==_0x517f64(0x11a))var _0x2d611f=users[_0x517f64(0xd3)];}}}}}}}_0xab5544['render'](_0x517f64(0xe6),{'success':_0x49695c[_0x517f64(0xf9)](_0x517f64(0xe7)),'errors':_0x49695c[_0x517f64(0xf9)](_0x517f64(0xd0)),'role':_0x251d71,'profile':_0x197b29,'master_shop':_0xf44d4c,'user':_0x3532df,'language':_0x2d611f});}catch(_0x552a49){console[_0x517f64(0xee)](_0x552a49);}}),router[a0_0x361603(0x109)]('/view/:id',auth,async(_0x498fbc,_0xfff92e)=>{var _0x48683a=a0_0x361603;try{const {username:_0x536d87,email:_0x2524a3,role:_0x19bb24}=_0x498fbc['user'],_0x39893c=_0x498fbc['user'],_0x19ed58=await profile['findOne']({'email':_0x39893c[_0x48683a(0x119)]}),_0x39adaa=await master_shop[_0x48683a(0x104)]();console['log'](_0x48683a(0xf2),_0x39adaa);const _0x46ded9=_0x498fbc[_0x48683a(0x10d)]['id'];console[_0x48683a(0xee)](_0x46ded9);var _0x848492=['Return\x20Rooms'];const _0x3357cb=await sales_return_finished[_0x48683a(0xc5)](_0x46ded9),_0x442d80=await warehouse[_0x48683a(0xe8)]([{'$match':{'name':_0x3357cb[_0x48683a(0xd8)],'room':_0x3357cb[_0x48683a(0xd5)]}},{'$unwind':_0x48683a(0x11f)},{'$group':{'_id':_0x48683a(0xc4),'name':{'$first':_0x48683a(0x12d)},'product_stock':{'$first':_0x48683a(0xfc)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x48683a(0xed)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x48683a(0x102)},'primary_code':{'$first':_0x48683a(0x103)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x48683a(0xcf)},'storage':{'$first':_0x48683a(0x10a)},'rack':{'$first':_0x48683a(0xe9)}}}]);console['log'](_0x442d80);const _0x1ad9f4=await warehouse[_0x48683a(0xe8)]([{'$match':{'status':_0x48683a(0xc7),'warehouse_category':_0x48683a(0xf8)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x37d9aa=await warehouse[_0x48683a(0xe8)]([{'$match':{'status':_0x48683a(0xc7),'name':_0x48683a(0xc3)}},{'$group':{'_id':_0x48683a(0x125),'name':{'$first':_0x48683a(0x125)}}},{'$sort':{'name':0x1}}]),_0x631b0f=await product[_0x48683a(0x104)]({});if(_0x39adaa[0x0][_0x48683a(0xbc)]==_0x48683a(0xea)){var _0x32b599=users[_0x48683a(0x132)];console[_0x48683a(0xee)](_0x32b599);}else{if(_0x39adaa[0x0][_0x48683a(0xbc)]==_0x48683a(0xec))var _0x32b599=users['Hindi'];else{if(_0x39adaa[0x0][_0x48683a(0xbc)]==_0x48683a(0xc9))var _0x32b599=users[_0x48683a(0xc9)];else{if(_0x39adaa[0x0][_0x48683a(0xbc)]==_0x48683a(0xb8))var _0x32b599=users['Spanish'];else{if(_0x39adaa[0x0][_0x48683a(0xbc)]==_0x48683a(0xb7))var _0x32b599=users[_0x48683a(0xb7)];else{if(_0x39adaa[0x0][_0x48683a(0xbc)]=='Portuguese\x20(BR)')var _0x32b599=users[_0x48683a(0xc6)];else{if(_0x39adaa[0x0][_0x48683a(0xbc)]==_0x48683a(0x114))var _0x32b599=users[_0x48683a(0x114)];else{if(_0x39adaa[0x0][_0x48683a(0xbc)]==_0x48683a(0x11a))var _0x32b599=users[_0x48683a(0xd3)];}}}}}}}_0xfff92e[_0x48683a(0xeb)](_0x48683a(0xf7),{'success':_0x498fbc[_0x48683a(0xf9)]('success'),'errors':_0x498fbc[_0x48683a(0xf9)](_0x48683a(0xd0)),'role':_0x39893c,'profile':_0x19ed58,'master_shop':_0x39adaa,'user':_0x3357cb,'stock':_0x442d80,'unit':_0x631b0f,'language':_0x32b599,'warehouses':_0x1ad9f4,'rooms':_0x848492,'warehouse_QA':_0x37d9aa});}catch(_0x2d2331){console['log'](_0x2d2331);}}),router[a0_0x361603(0xce)](a0_0x361603(0xd9),auth,async(_0x38a5c9,_0x4dc56f)=>{var _0x256a1c=a0_0x361603;if(_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x10c)]=='QA')try{const _0x3a449f=_0x38a5c9[_0x256a1c(0x10d)]['id'],_0x1e5f90=await sales_return[_0x256a1c(0xe1)]({'invoice':_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xd4)]}),_0x54d8ba=await warehouse[_0x256a1c(0xe1)]({'name':_0x1e5f90[_0x256a1c(0xd8)],'room':_0x1e5f90[_0x256a1c(0xd5)]}),{invoice:_0x392162,customer:_0x18e47b,date:_0x4dea3f,warehouse_name:_0x19cfde,product_name:_0x323b31,primary_code:_0x35b1d8,secondary_code:_0x2090d2,product_code:_0x1ab8c6,sales_quantity:_0x533c4f,stocks:_0x41c0a0,return_qty:_0x320a39,note:_0x4f89b3,to_warehouse_name_QA:_0x229b90,to_Room_name_QA:_0x4682a0}=_0x38a5c9['body'];if(typeof product_name_QA==_0x256a1c(0xdc))var _0x3197aa=[_0x38a5c9['body']['product_name_QA']],_0x2eb5c8=[_0x38a5c9[_0x256a1c(0x100)]['primary_code_QA']],_0xaad486=[_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x111)]],_0x4f9a44=[_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xe4)]],_0x522675=[_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xf3)]],_0x2c6d66=[_0x38a5c9[_0x256a1c(0x100)]['stocks_QA']],_0x13da02=[_0x38a5c9[_0x256a1c(0x100)]['return_qty_QA']];else var _0x3197aa=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xc8)]],_0x2eb5c8=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x128)]],_0xaad486=[..._0x38a5c9['body'][_0x256a1c(0x111)]],_0x4f9a44=[..._0x38a5c9['body'][_0x256a1c(0xe4)]],_0x522675=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xf3)]],_0x2c6d66=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x107)]],_0x13da02=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xb6)]];const _0x52fb2d=_0x3197aa[_0x256a1c(0xff)](_0x5312b1=>{return _0x5312b1={'product_name':_0x5312b1};});_0x2eb5c8[_0x256a1c(0xc2)]((_0x5b9810,_0x1d9636)=>{_0x52fb2d[_0x1d9636]['primary_code']=_0x5b9810;}),_0xaad486['forEach']((_0x33963d,_0x396b8e)=>{var _0x52a9a3=_0x256a1c;_0x52fb2d[_0x396b8e][_0x52a9a3(0xcb)]=_0x33963d;}),_0x4f9a44[_0x256a1c(0xc2)]((_0x1d1de7,_0x4faf21)=>{var _0x1f9d6d=_0x256a1c;_0x52fb2d[_0x4faf21][_0x1f9d6d(0x123)]=_0x1d1de7;}),_0x522675[_0x256a1c(0xc2)]((_0xbc33b8,_0x2c4f82)=>{var _0x1dce2d=_0x256a1c;_0x52fb2d[_0x2c4f82][_0x1dce2d(0x130)]=_0xbc33b8;}),_0x2c6d66[_0x256a1c(0xc2)]((_0x45a2e7,_0x501423)=>{var _0x2f73b4=_0x256a1c;_0x52fb2d[_0x501423][_0x2f73b4(0xb5)]=_0x45a2e7;}),_0x13da02['forEach']((_0x3687b7,_0x3f20c5)=>{var _0x947e38=_0x256a1c;_0x52fb2d[_0x3f20c5][_0x947e38(0x127)]=_0x3687b7;}),_0x1e5f90['return_sale_QA'][_0x256a1c(0xc2)](_0x257d2d=>{var _0x653dae=_0x256a1c;const _0x577f8a=_0x54d8ba[_0x653dae(0x10b)]['map'](_0x55a0ee=>{var _0x5dccea=_0x653dae;_0x55a0ee[_0x5dccea(0x129)]==_0x257d2d['product_name']&&(_0x55a0ee[_0x5dccea(0x113)]=parseInt(_0x55a0ee['product_stock'])+parseInt(_0x257d2d[_0x5dccea(0x127)]));});}),await _0x54d8ba[_0x256a1c(0x112)](),_0x1e5f90[_0x256a1c(0xd4)]=_0x392162,_0x1e5f90['customer']=_0x18e47b,_0x1e5f90['date']=_0x4dea3f,_0x1e5f90[_0x256a1c(0x110)]=_0x19cfde,_0x1e5f90[_0x256a1c(0xb9)]=_0x52fb2d,_0x1e5f90['note']=_0x4f89b3,_0x1e5f90[_0x256a1c(0xd8)]=_0x229b90,_0x1e5f90[_0x256a1c(0xd5)]=_0x4682a0;const _0x36b1b7=await _0x1e5f90[_0x256a1c(0x112)](),_0x364f34=await c_payment_data['findOne']({'invoice':_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xd4)],'reason':_0x256a1c(0x106)});_0x364f34[_0x256a1c(0x118)]=_0x38a5c9[_0x256a1c(0x100)]['suppliers'],_0x364f34['date']=_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x120)],await _0x364f34['save'](),_0x38a5c9[_0x256a1c(0xf9)](_0x256a1c(0xe7),_0x256a1c(0x12a)),_0x4dc56f[_0x256a1c(0xde)]('/sales_return_finished/view');}catch(_0xba1174){console['log'](_0xba1174),_0x4dc56f[_0x256a1c(0xf1)](0xc8)['json']({'message':_0xba1174[_0x256a1c(0x122)]});}else try{const _0x11527f=_0x38a5c9[_0x256a1c(0x10d)]['id'];console[_0x256a1c(0xee)](_0x11527f);const _0x5b49db=await sales_return[_0x256a1c(0xe1)]({'invoice':_0x38a5c9['body'][_0x256a1c(0xd4)]});console[_0x256a1c(0xee)](_0x256a1c(0xcc),_0x5b49db);const _0x1ea18b=await warehouse[_0x256a1c(0xe1)]({'name':_0x5b49db[_0x256a1c(0xd8)],'room':_0x5b49db['ToRoom']});console[_0x256a1c(0xee)]('old_warehouse_data',_0x1ea18b);const {invoice:_0x2cebde,customer:_0x1c230f,date:_0x434fcb,warehouse_name:_0x541f37,product_name:_0x21cd26,primary_code:_0x396ffb,secondary_code:_0x2b6913,product_code:_0x39da79,sales_quantity:_0xc0d8c4,stocks:_0x51a329,return_qty:_0x2db371,note:_0x118cf2,to_warehouse_name:_0x46fe76,to_Room_name:_0x1cfc6d}=_0x38a5c9[_0x256a1c(0x100)];console[_0x256a1c(0xee)](_0x38a5c9[_0x256a1c(0x100)]);if(typeof _0x21cd26==_0x256a1c(0xdc))var _0x3197aa=[_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x129)]],_0x2eb5c8=[_0x38a5c9[_0x256a1c(0x100)]['primary_code']],_0xaad486=[_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xcb)]],_0x4f9a44=[_0x38a5c9['body'][_0x256a1c(0x123)]],_0x522675=[_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xe2)]],_0x2c6d66=[_0x38a5c9[_0x256a1c(0x100)]['stocks']],_0x13da02=[_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x127)]],_0x4ed35d=[_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x10f)]],_0x3c2bb4=[_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xe5)]],_0x15a224=[_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xdd)]],_0x1abc26=[_0x38a5c9[_0x256a1c(0x100)]['floorlevel']];else var _0x3197aa=[..._0x38a5c9['body'][_0x256a1c(0x129)]],_0x2eb5c8=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xf4)]],_0xaad486=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xcb)]],_0x4f9a44=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x123)]],_0x522675=[..._0x38a5c9['body'][_0x256a1c(0xe2)]],_0x2c6d66=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x101)]],_0x13da02=[..._0x38a5c9[_0x256a1c(0x100)]['return_qty']],_0x4ed35d=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x10f)]],_0x3c2bb4=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xe5)]],_0x15a224=[..._0x38a5c9['body']['types']],_0x1abc26=[..._0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x11d)]];const _0x9cea61=_0x3197aa['map'](_0x4e02ca=>{return _0x4e02ca={'product_name':_0x4e02ca};});_0x2eb5c8[_0x256a1c(0xc2)]((_0x340b6f,_0x43da93)=>{var _0x168dbc=_0x256a1c;_0x9cea61[_0x43da93][_0x168dbc(0xf4)]=_0x340b6f;}),_0xaad486[_0x256a1c(0xc2)]((_0x442684,_0x59e139)=>{var _0x2c8169=_0x256a1c;_0x9cea61[_0x59e139][_0x2c8169(0xcb)]=_0x442684;}),_0x4f9a44[_0x256a1c(0xc2)]((_0xec1e02,_0x282db4)=>{var _0x238f56=_0x256a1c;_0x9cea61[_0x282db4][_0x238f56(0x123)]=_0xec1e02;}),_0x522675['forEach']((_0x1cee13,_0x1efc8e)=>{_0x9cea61[_0x1efc8e]['sale_qty']=_0x1cee13;}),_0x2c6d66[_0x256a1c(0xc2)]((_0x16ec30,_0x442a93)=>{_0x9cea61[_0x442a93]['stock']=_0x16ec30;}),_0x13da02['forEach']((_0x4d5ea3,_0x4163ee)=>{var _0x87a643=_0x256a1c;_0x9cea61[_0x4163ee][_0x87a643(0x127)]=_0x4d5ea3;}),_0x4ed35d['forEach']((_0x10db21,_0x1b9a21)=>{_0x9cea61[_0x1b9a21]['bay']=_0x10db21;}),_0x3c2bb4['forEach']((_0x283be0,_0xaa5687)=>{var _0x113306=_0x256a1c;_0x9cea61[_0xaa5687][_0x113306(0xe5)]=_0x283be0;}),_0x15a224[_0x256a1c(0xc2)]((_0x2e42ba,_0x5d2762)=>{var _0xfd2870=_0x256a1c;_0x9cea61[_0x5d2762][_0xfd2870(0xd7)]=_0x2e42ba;}),_0x1abc26[_0x256a1c(0xc2)]((_0x4e2472,_0xa86dfa)=>{_0x9cea61[_0xa86dfa]['floorlevel']=_0x4e2472;});var _0x2f5f0a=0x0;_0x9cea61['forEach'](_0x3b73d8=>{var _0x343b8f=_0x256a1c;console[_0x343b8f(0xee)]('foreach\x20newproduct',_0x3b73d8),(parseInt(_0x3b73d8[_0x343b8f(0x130)])<parseInt(_0x3b73d8[_0x343b8f(0x127)])||parseInt(_0x3b73d8[_0x343b8f(0xb5)])<parseInt(_0x3b73d8[_0x343b8f(0x127)])&&parseInt(_0x3b73d8[_0x343b8f(0x130)])>parseInt(_0x3b73d8['return_qty'])||parseInt(_0x3b73d8[_0x343b8f(0x127)])==0x0)&&_0x2f5f0a++;});if(_0x2f5f0a!=0x0)return _0x38a5c9['flash']('errors','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x4dc56f[_0x256a1c(0xde)](_0x256a1c(0xda));_0x5b49db[_0x256a1c(0xd1)][_0x256a1c(0xc2)](_0x36ec79=>{var _0x642e1a=_0x256a1c;const _0x55a6b9=_0x1ea18b[_0x642e1a(0x10b)]['map'](_0x244835=>{var _0x236857=_0x642e1a;_0x244835['product_name']==_0x36ec79[_0x236857(0x129)]&&_0x244835[_0x236857(0x11d)]==_0x36ec79['floorlevel']&&_0x244835[_0x236857(0xd7)]==_0x36ec79[_0x236857(0xd7)]&&_0x244835[_0x236857(0xe5)]==_0x36ec79[_0x236857(0xe5)]&&_0x244835[_0x236857(0x10f)]==_0x36ec79[_0x236857(0x10f)]&&(_0x244835[_0x236857(0x113)]=parseInt(_0x244835['product_stock'])+parseInt(_0x36ec79[_0x236857(0x127)]));});}),console['log'](_0x256a1c(0xfb),_0x1ea18b),await _0x1ea18b[_0x256a1c(0x112)](),_0x5b49db[_0x256a1c(0xd4)]=_0x2cebde,_0x5b49db[_0x256a1c(0x117)]=_0x1c230f,_0x5b49db['date']=_0x434fcb,_0x5b49db['warehouse_name']=_0x541f37,_0x5b49db[_0x256a1c(0xd1)]=_0x9cea61,_0x5b49db[_0x256a1c(0xcd)]=_0x118cf2,_0x5b49db[_0x256a1c(0xd8)]=_0x46fe76,_0x5b49db[_0x256a1c(0xd5)]=_0x1cfc6d;const _0x3294a5=await _0x5b49db['save']();console[_0x256a1c(0xee)](_0x256a1c(0xf6),_0x3294a5);const _0x589eb7=await c_payment_data[_0x256a1c(0xe1)]({'invoice':_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0xd4)],'reason':_0x256a1c(0x106)});_0x589eb7[_0x256a1c(0x118)]=_0x38a5c9[_0x256a1c(0x100)][_0x256a1c(0x118)],_0x589eb7[_0x256a1c(0x120)]=_0x38a5c9['body']['date'],await _0x589eb7[_0x256a1c(0x112)](),_0x38a5c9[_0x256a1c(0xf9)](_0x256a1c(0xe7),'purchase\x20return\x20successfully'),_0x4dc56f[_0x256a1c(0xde)](_0x256a1c(0xd6));}catch(_0x15d11d){console[_0x256a1c(0xee)](_0x15d11d),_0x4dc56f[_0x256a1c(0xf1)](0xc8)[_0x256a1c(0xbe)]({'message':_0x15d11d[_0x256a1c(0x122)]});}}),router[a0_0x361603(0xce)](a0_0x361603(0xef),auth,async(_0x33fcec,_0x20d996)=>{var _0x5986f9=a0_0x361603;try{const _0x1fac3d=_0x33fcec['params']['id'],{invoice:_0x4d1e9f,customer:_0x1679e3,payable_to_customer:_0x19021b,paid_amount:_0x4a6e54}=_0x33fcec['body'],_0x5d033a=await sales_return['findById'](_0x1fac3d);console[_0x5986f9(0xee)]('data',_0x5d033a),console[_0x5986f9(0xee)](_0x19021b),console[_0x5986f9(0xee)](_0x4a6e54);var _0x37c44c=_0x19021b-_0x4a6e54;console[_0x5986f9(0xee)](_0x5986f9(0xf0),_0x37c44c),_0x5d033a[_0x5986f9(0xe0)]=parseFloat(_0x4a6e54)+parseFloat(_0x5d033a[_0x5986f9(0xe0)]),_0x5d033a[_0x5986f9(0xdf)]=_0x37c44c,console[_0x5986f9(0xee)](_0x5d033a);const _0x57b524=await _0x5d033a['save']();console[_0x5986f9(0xee)](0x1b207);const _0x36ad4d=await c_payment_data[_0x5986f9(0xe1)]({'invoice':_0x33fcec[_0x5986f9(0x100)][_0x5986f9(0xd4)],'reason':_0x5986f9(0x106)});console[_0x5986f9(0xee)]('c_payment',_0x36ad4d),_0x36ad4d[_0x5986f9(0x12f)]=_0x37c44c,await _0x36ad4d[_0x5986f9(0x112)]();let _0x68293c=new Date(),_0x1317fd=('0'+_0x68293c[_0x5986f9(0xba)]())[_0x5986f9(0x12e)](-0x2),_0x59a012=('0'+(_0x68293c['getMonth']()+0x1))[_0x5986f9(0x12e)](-0x2),_0x17f8bf=_0x68293c[_0x5986f9(0xe3)](),_0x44bac0=_0x17f8bf+'-'+_0x59a012+'-'+_0x1317fd;const _0x719af0=new customer_payment({'invoice':_0x4d1e9f,'date':_0x17f8bf+'-'+_0x59a012+'-'+_0x1317fd,'customer':_0x1679e3,'reason':_0x5986f9(0xfa),'amount':_0x4a6e54}),_0x26b2d5=await _0x719af0['save']();_0x33fcec[_0x5986f9(0xf9)](_0x5986f9(0xe7),_0x5986f9(0xf5)),_0x20d996[_0x5986f9(0xde)]('/sales_return/view');}catch(_0xc64940){console[_0x5986f9(0xee)](_0xc64940);}}),router[a0_0x361603(0x109)](a0_0x361603(0xca),auth,async(_0x5ac41e,_0x439ad8)=>{var _0x3a9716=a0_0x361603;try{const {username:_0x3b2d3b,email:_0x3887e3,role:_0x50a43e}=_0x5ac41e[_0x3a9716(0x115)],_0x48fd08=_0x5ac41e[_0x3a9716(0x115)],_0x24e121=await profile[_0x3a9716(0xe1)]({'email':_0x48fd08[_0x3a9716(0x119)]}),_0x4210b6=await master_shop[_0x3a9716(0x104)]();console[_0x3a9716(0xee)](_0x3a9716(0xf2),_0x4210b6);const _0x576cf6=_0x5ac41e[_0x3a9716(0x10d)]['id'],_0x395402=await sales_return['findById'](_0x576cf6);console['log'](_0x395402);const _0x242be9=await customer[_0x3a9716(0xe1)]({'name':_0x395402[_0x3a9716(0x117)]});console[_0x3a9716(0xee)](_0x242be9);if(_0x4210b6[0x0]['language']=='English\x20(US)'){var _0xe3fa46=users['English'];console[_0x3a9716(0xee)](_0xe3fa46);}else{if(_0x4210b6[0x0]['language']==_0x3a9716(0xec))var _0xe3fa46=users[_0x3a9716(0xec)];else{if(_0x4210b6[0x0][_0x3a9716(0xbc)]==_0x3a9716(0xc9))var _0xe3fa46=users['German'];else{if(_0x4210b6[0x0][_0x3a9716(0xbc)]==_0x3a9716(0xb8))var _0xe3fa46=users[_0x3a9716(0xb8)];else{if(_0x4210b6[0x0][_0x3a9716(0xbc)]==_0x3a9716(0xb7))var _0xe3fa46=users['French'];else{if(_0x4210b6[0x0][_0x3a9716(0xbc)]=='Portuguese\x20(BR)')var _0xe3fa46=users['Portuguese'];else{if(_0x4210b6[0x0]['language']==_0x3a9716(0x114))var _0xe3fa46=users[_0x3a9716(0x114)];else{if(_0x4210b6[0x0][_0x3a9716(0xbc)]==_0x3a9716(0x11a))var _0xe3fa46=users[_0x3a9716(0xd3)];}}}}}}}_0x439ad8[_0x3a9716(0xeb)]('sales_return_invoice',{'success':_0x5ac41e[_0x3a9716(0xf9)](_0x3a9716(0xe7)),'errors':_0x5ac41e['flash'](_0x3a9716(0xd0)),'role':_0x48fd08,'profile':_0x24e121,'master_shop':_0x4210b6,'customers':_0x242be9,'sales':_0x395402,'language':_0xe3fa46});}catch(_0x3e7213){console[_0x3a9716(0xee)](_0x3e7213);}}),module[a0_0x361603(0xbd)]=router;