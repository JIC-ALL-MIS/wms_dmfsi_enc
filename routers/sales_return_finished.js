function a0_0x18a6(_0x564820,_0x3de3e1){var _0x186e7f=a0_0x186e();return a0_0x18a6=function(_0x18a632,_0x2c9547){_0x18a632=_0x18a632-0x1d4;var _0x4eaa24=_0x186e7f[_0x18a632];return _0x4eaa24;},a0_0x18a6(_0x564820,_0x3de3e1);}var a0_0x186172=a0_0x18a6;(function(_0x5363e3,_0x481332){var _0x160b1d=a0_0x18a6,_0x106789=_0x5363e3();while(!![]){try{var _0x26d335=-parseInt(_0x160b1d(0x1e9))/0x1*(parseInt(_0x160b1d(0x22f))/0x2)+parseInt(_0x160b1d(0x1f6))/0x3*(-parseInt(_0x160b1d(0x1de))/0x4)+-parseInt(_0x160b1d(0x22c))/0x5+parseInt(_0x160b1d(0x248))/0x6+-parseInt(_0x160b1d(0x1f2))/0x7*(-parseInt(_0x160b1d(0x21f))/0x8)+parseInt(_0x160b1d(0x20f))/0x9*(parseInt(_0x160b1d(0x1fe))/0xa)+parseInt(_0x160b1d(0x1e3))/0xb;if(_0x26d335===_0x481332)break;else _0x106789['push'](_0x106789['shift']());}catch(_0x36f4b5){_0x106789['push'](_0x106789['shift']());}}}(a0_0x186e,0xec68b));const express=require(a0_0x186172(0x230)),app=express(),router=express[a0_0x186172(0x1f8)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x186172(0x250)),auth=require(a0_0x186172(0x210)),users=require(a0_0x186172(0x226));router['get'](a0_0x186172(0x23e),auth,async(_0x135480,_0x50b922)=>{var _0x55d725=a0_0x186172;try{const {username:_0x339483,email:_0x266702,role:_0x242e4e}=_0x135480['user'],_0x53e834=_0x135480[_0x55d725(0x209)],_0x51d115=await profile[_0x55d725(0x1fb)]({'email':_0x53e834['email']}),_0x465fe4=await master_shop[_0x55d725(0x237)](),_0xbb0636=await sales_return_finished['aggregate']([{'$lookup':{'from':_0x55d725(0x234),'localField':_0x55d725(0x221),'foreignField':_0x55d725(0x246),'as':_0x55d725(0x235)}},{'$unwind':'$customer_docs'}]);if(_0x465fe4[0x0][_0x55d725(0x20c)]==_0x55d725(0x23c)){var _0xa4d5e8=users[_0x55d725(0x203)];console[_0x55d725(0x242)](_0xa4d5e8);}else{if(_0x465fe4[0x0][_0x55d725(0x20c)]==_0x55d725(0x1e8))var _0xa4d5e8=users[_0x55d725(0x1e8)];else{if(_0x465fe4[0x0][_0x55d725(0x20c)]=='German')var _0xa4d5e8=users[_0x55d725(0x21c)];else{if(_0x465fe4[0x0][_0x55d725(0x20c)]==_0x55d725(0x1f0))var _0xa4d5e8=users['Spanish'];else{if(_0x465fe4[0x0]['language']=='French')var _0xa4d5e8=users[_0x55d725(0x202)];else{if(_0x465fe4[0x0][_0x55d725(0x20c)]=='Portuguese\x20(BR)')var _0xa4d5e8=users[_0x55d725(0x1f3)];else{if(_0x465fe4[0x0][_0x55d725(0x20c)]==_0x55d725(0x249))var _0xa4d5e8=users[_0x55d725(0x249)];else{if(_0x465fe4[0x0][_0x55d725(0x20c)]==_0x55d725(0x1e4))var _0xa4d5e8=users[_0x55d725(0x21b)];}}}}}}}_0x50b922[_0x55d725(0x1e0)]('sales_return_finished',{'success':_0x135480['flash']('success'),'errors':_0x135480[_0x55d725(0x1df)]('errors'),'role':_0x53e834,'profile':_0x51d115,'master_shop':_0x465fe4,'user':_0xbb0636,'language':_0xa4d5e8});}catch(_0x4d5ba6){console['log'](_0x4d5ba6);}}),router[a0_0x186172(0x236)]('/view/:id',auth,async(_0x478c7f,_0x4580d6)=>{var _0x101d88=a0_0x186172;try{const {username:_0x4cf0a9,email:_0x10a54d,role:_0x9e190d}=_0x478c7f[_0x101d88(0x209)],_0x4890a3=_0x478c7f[_0x101d88(0x209)],_0x5e3239=await profile['findOne']({'email':_0x4890a3[_0x101d88(0x24d)]}),_0x56f9e7=await master_shop['find']();console[_0x101d88(0x242)](_0x101d88(0x241),_0x56f9e7);const _0x91a9c2=_0x478c7f[_0x101d88(0x247)]['id'];console[_0x101d88(0x242)](_0x91a9c2);var _0x267bad=['Return\x20Rooms'];const _0x2077df=await sales_return_finished[_0x101d88(0x211)](_0x91a9c2),_0x5a5c95=await warehouse['aggregate']([{'$match':{'name':_0x2077df[_0x101d88(0x23b)],'room':_0x2077df[_0x101d88(0x1f4)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x101d88(0x212),'name':{'$first':_0x101d88(0x217)},'product_stock':{'$first':_0x101d88(0x216)},'bay':{'$first':_0x101d88(0x1e1)},'bin':{'$first':_0x101d88(0x1f1)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x101d88(0x224)},'primary_code':{'$first':_0x101d88(0x22e)},'secondary_code':{'$first':_0x101d88(0x1f9)},'product_code':{'$first':_0x101d88(0x1fc)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x101d88(0x1f7)}}}]);console[_0x101d88(0x242)](_0x5a5c95);const _0x327d42=await warehouse[_0x101d88(0x1db)]([{'$match':{'status':_0x101d88(0x228),'warehouse_category':_0x101d88(0x232)}},{'$group':{'_id':'$name','name':{'$first':_0x101d88(0x1dc)}}},{'$sort':{'name':0x1}}]),_0x262362=await warehouse['aggregate']([{'$match':{'status':_0x101d88(0x228),'name':_0x101d88(0x24f)}},{'$group':{'_id':_0x101d88(0x1dc),'name':{'$first':_0x101d88(0x1dc)}}},{'$sort':{'name':0x1}}]),_0x15269d=await product[_0x101d88(0x237)]({});if(_0x56f9e7[0x0][_0x101d88(0x20c)]==_0x101d88(0x23c)){var _0xbc5c04=users['English'];console[_0x101d88(0x242)](_0xbc5c04);}else{if(_0x56f9e7[0x0][_0x101d88(0x20c)]==_0x101d88(0x1e8))var _0xbc5c04=users[_0x101d88(0x1e8)];else{if(_0x56f9e7[0x0][_0x101d88(0x20c)]==_0x101d88(0x21c))var _0xbc5c04=users[_0x101d88(0x21c)];else{if(_0x56f9e7[0x0][_0x101d88(0x20c)]==_0x101d88(0x1f0))var _0xbc5c04=users['Spanish'];else{if(_0x56f9e7[0x0][_0x101d88(0x20c)]==_0x101d88(0x202))var _0xbc5c04=users[_0x101d88(0x202)];else{if(_0x56f9e7[0x0][_0x101d88(0x20c)]==_0x101d88(0x207))var _0xbc5c04=users['Portuguese'];else{if(_0x56f9e7[0x0][_0x101d88(0x20c)]=='Chinese')var _0xbc5c04=users[_0x101d88(0x249)];else{if(_0x56f9e7[0x0][_0x101d88(0x20c)]=='Arabic\x20(ae)')var _0xbc5c04=users[_0x101d88(0x21b)];}}}}}}}_0x4580d6[_0x101d88(0x1e0)](_0x101d88(0x1ed),{'success':_0x478c7f[_0x101d88(0x1df)](_0x101d88(0x1ef)),'errors':_0x478c7f[_0x101d88(0x1df)]('errors'),'role':_0x4890a3,'profile':_0x5e3239,'master_shop':_0x56f9e7,'user':_0x2077df,'stock':_0x5a5c95,'unit':_0x15269d,'language':_0xbc5c04,'warehouses':_0x327d42,'rooms':_0x267bad,'warehouse_QA':_0x262362});}catch(_0x35e981){console['log'](_0x35e981);}}),router[a0_0x186172(0x240)]('/view/:id',auth,async(_0x3e30dc,_0x3a3620)=>{var _0x5b0b7a=a0_0x186172;if(_0x3e30dc[_0x5b0b7a(0x20d)]['for_categorize']=='QA')try{const _0x296c72=_0x3e30dc[_0x5b0b7a(0x247)]['id'],_0x2ef0b3=await sales_return[_0x5b0b7a(0x1fb)]({'invoice':_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x219)]}),_0x173860=await warehouse[_0x5b0b7a(0x1fb)]({'name':_0x2ef0b3[_0x5b0b7a(0x23b)],'room':_0x2ef0b3[_0x5b0b7a(0x1f4)]}),{invoice:_0x2aa992,customer:_0x30e4e8,date:_0x5acaa1,warehouse_name:_0x22ca3a,product_name:_0x28d6b6,primary_code:_0x381071,secondary_code:_0x5e63f4,product_code:_0x1649de,sales_quantity:_0x3cf74a,stocks:_0x51ef49,return_qty:_0x442082,note:_0xa352f1,to_warehouse_name_QA:_0x42195e,to_Room_name_QA:_0x4d774f}=_0x3e30dc[_0x5b0b7a(0x20d)];if(typeof product_name_QA==_0x5b0b7a(0x1e2))var _0x425b9e=[_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x1d9)]],_0x35c42d=[_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x1e7)]],_0x1fed70=[_0x3e30dc['body'][_0x5b0b7a(0x20b)]],_0x53c309=[_0x3e30dc[_0x5b0b7a(0x20d)]['product_code_QA']],_0x58a9d4=[_0x3e30dc['body'][_0x5b0b7a(0x22b)]],_0x52cbae=[_0x3e30dc[_0x5b0b7a(0x20d)]['stocks_QA']],_0x3301af=[_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x1dd)]];else var _0x425b9e=[..._0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x1d9)]],_0x35c42d=[..._0x3e30dc[_0x5b0b7a(0x20d)]['primary_code_QA']],_0x1fed70=[..._0x3e30dc[_0x5b0b7a(0x20d)]['secondary_code_QA']],_0x53c309=[..._0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x205)]],_0x58a9d4=[..._0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x22b)]],_0x52cbae=[..._0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x1ec)]],_0x3301af=[..._0x3e30dc['body'][_0x5b0b7a(0x1dd)]];const _0x6081d7=_0x425b9e[_0x5b0b7a(0x1d6)](_0x2d914f=>{return _0x2d914f={'product_name':_0x2d914f};});_0x35c42d[_0x5b0b7a(0x24c)]((_0x497e0a,_0x425c33)=>{_0x6081d7[_0x425c33]['primary_code']=_0x497e0a;}),_0x1fed70[_0x5b0b7a(0x24c)]((_0x51a1d6,_0x55eebf)=>{var _0x17887b=_0x5b0b7a;_0x6081d7[_0x55eebf][_0x17887b(0x251)]=_0x51a1d6;}),_0x53c309['forEach']((_0x36e2df,_0x370ce6)=>{var _0x5090ed=_0x5b0b7a;_0x6081d7[_0x370ce6][_0x5090ed(0x208)]=_0x36e2df;}),_0x58a9d4[_0x5b0b7a(0x24c)]((_0x15513b,_0x18b071)=>{var _0x195a40=_0x5b0b7a;_0x6081d7[_0x18b071][_0x195a40(0x231)]=_0x15513b;}),_0x52cbae[_0x5b0b7a(0x24c)]((_0x65dd12,_0x3ab0db)=>{var _0x36e846=_0x5b0b7a;_0x6081d7[_0x3ab0db][_0x36e846(0x24a)]=_0x65dd12;}),_0x3301af[_0x5b0b7a(0x24c)]((_0x4d9cd2,_0x1da00b)=>{_0x6081d7[_0x1da00b]['return_qty']=_0x4d9cd2;}),_0x2ef0b3[_0x5b0b7a(0x206)][_0x5b0b7a(0x24c)](_0x16ce74=>{var _0x3747c0=_0x5b0b7a;const _0x2e7f4e=_0x173860[_0x3747c0(0x223)]['map'](_0x1ec8d=>{var _0x8d1cc6=_0x3747c0;_0x1ec8d[_0x8d1cc6(0x218)]==_0x16ce74[_0x8d1cc6(0x218)]&&(_0x1ec8d[_0x8d1cc6(0x1eb)]=parseInt(_0x1ec8d[_0x8d1cc6(0x1eb)])+parseInt(_0x16ce74[_0x8d1cc6(0x245)]));});}),await _0x173860[_0x5b0b7a(0x21a)](),_0x2ef0b3['invoice']=_0x2aa992,_0x2ef0b3[_0x5b0b7a(0x221)]=_0x30e4e8,_0x2ef0b3[_0x5b0b7a(0x243)]=_0x5acaa1,_0x2ef0b3[_0x5b0b7a(0x22a)]=_0x22ca3a,_0x2ef0b3[_0x5b0b7a(0x206)]=_0x6081d7,_0x2ef0b3[_0x5b0b7a(0x1d4)]=_0xa352f1,_0x2ef0b3[_0x5b0b7a(0x23b)]=_0x42195e,_0x2ef0b3[_0x5b0b7a(0x1f4)]=_0x4d774f;const _0x3ef0c1=await _0x2ef0b3['save'](),_0x32d040=await c_payment_data['findOne']({'invoice':_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x219)],'reason':_0x5b0b7a(0x220)});_0x32d040[_0x5b0b7a(0x238)]=_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x238)],_0x32d040[_0x5b0b7a(0x243)]=_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x243)],await _0x32d040[_0x5b0b7a(0x21a)](),_0x3e30dc[_0x5b0b7a(0x1df)](_0x5b0b7a(0x1ef),_0x5b0b7a(0x213)),_0x3a3620[_0x5b0b7a(0x239)](_0x5b0b7a(0x24e));}catch(_0xb6f89d){console[_0x5b0b7a(0x242)](_0xb6f89d),_0x3a3620[_0x5b0b7a(0x1ff)](0xc8)[_0x5b0b7a(0x215)]({'message':_0xb6f89d[_0x5b0b7a(0x222)]});}else try{const _0x152718=_0x3e30dc['params']['id'];console[_0x5b0b7a(0x242)](_0x152718);const _0x3eeee6=await sales_return[_0x5b0b7a(0x1fb)]({'invoice':_0x3e30dc[_0x5b0b7a(0x20d)]['invoice']});console[_0x5b0b7a(0x242)]('old_data',_0x3eeee6);const _0x4b5ddb=await warehouse[_0x5b0b7a(0x1fb)]({'name':_0x3eeee6[_0x5b0b7a(0x23b)],'room':_0x3eeee6[_0x5b0b7a(0x1f4)]});console['log'](_0x5b0b7a(0x233),_0x4b5ddb);const {invoice:_0xf0f3cf,customer:_0x3dc0db,date:_0x22d7b1,warehouse_name:_0x33d1b2,product_name:_0x1697b4,primary_code:_0x133765,secondary_code:_0x37bcf1,product_code:_0x4e9cd5,sales_quantity:_0x10c073,stocks:_0x1906a6,return_qty:_0x5d1339,note:_0x554788,to_warehouse_name:_0x49dc17,to_Room_name:_0x436632}=_0x3e30dc[_0x5b0b7a(0x20d)];console[_0x5b0b7a(0x242)](_0x3e30dc[_0x5b0b7a(0x20d)]);if(typeof _0x1697b4==_0x5b0b7a(0x1e2))var _0x425b9e=[_0x3e30dc['body']['product_name']],_0x35c42d=[_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x20a)]],_0x1fed70=[_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x251)]],_0x53c309=[_0x3e30dc[_0x5b0b7a(0x20d)]['product_code']],_0x58a9d4=[_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x1da)]],_0x52cbae=[_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x24b)]],_0x3301af=[_0x3e30dc['body'][_0x5b0b7a(0x245)]],_0x3bf62e=[_0x3e30dc['body'][_0x5b0b7a(0x23f)]],_0x464408=[_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x23d)]],_0x206f3b=[_0x3e30dc['body'][_0x5b0b7a(0x1d8)]],_0xe9b6d6=[_0x3e30dc[_0x5b0b7a(0x20d)]['floorlevel']];else var _0x425b9e=[..._0x3e30dc['body'][_0x5b0b7a(0x218)]],_0x35c42d=[..._0x3e30dc['body'][_0x5b0b7a(0x20a)]],_0x1fed70=[..._0x3e30dc[_0x5b0b7a(0x20d)]['secondary_code']],_0x53c309=[..._0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x208)]],_0x58a9d4=[..._0x3e30dc[_0x5b0b7a(0x20d)]['sales_quantity']],_0x52cbae=[..._0x3e30dc[_0x5b0b7a(0x20d)]['stocks']],_0x3301af=[..._0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x245)]],_0x3bf62e=[..._0x3e30dc[_0x5b0b7a(0x20d)]['bay']],_0x464408=[..._0x3e30dc[_0x5b0b7a(0x20d)]['bin']],_0x206f3b=[..._0x3e30dc[_0x5b0b7a(0x20d)]['types']],_0xe9b6d6=[..._0x3e30dc[_0x5b0b7a(0x20d)]['floorlevel']];const _0x5e3644=_0x425b9e['map'](_0x3fabaf=>{return _0x3fabaf={'product_name':_0x3fabaf};});_0x35c42d['forEach']((_0xc1980f,_0x2a76f9)=>{_0x5e3644[_0x2a76f9]['primary_code']=_0xc1980f;}),_0x1fed70[_0x5b0b7a(0x24c)]((_0x4df566,_0xdade8)=>{var _0x56ff44=_0x5b0b7a;_0x5e3644[_0xdade8][_0x56ff44(0x251)]=_0x4df566;}),_0x53c309[_0x5b0b7a(0x24c)]((_0x19391c,_0x2cd294)=>{var _0x3712b1=_0x5b0b7a;_0x5e3644[_0x2cd294][_0x3712b1(0x208)]=_0x19391c;}),_0x58a9d4[_0x5b0b7a(0x24c)]((_0x328edf,_0x44a730)=>{var _0x31e09c=_0x5b0b7a;_0x5e3644[_0x44a730][_0x31e09c(0x231)]=_0x328edf;}),_0x52cbae[_0x5b0b7a(0x24c)]((_0x3a80f1,_0x330068)=>{var _0x1291a7=_0x5b0b7a;_0x5e3644[_0x330068][_0x1291a7(0x24a)]=_0x3a80f1;}),_0x3301af['forEach']((_0x9e1fc0,_0x55e9b8)=>{var _0x2f6fd6=_0x5b0b7a;_0x5e3644[_0x55e9b8][_0x2f6fd6(0x245)]=_0x9e1fc0;}),_0x3bf62e[_0x5b0b7a(0x24c)]((_0x595c1a,_0x201e25)=>{var _0x26577e=_0x5b0b7a;_0x5e3644[_0x201e25][_0x26577e(0x23f)]=_0x595c1a;}),_0x464408[_0x5b0b7a(0x24c)]((_0x28603b,_0x56aafe)=>{_0x5e3644[_0x56aafe]['bin']=_0x28603b;}),_0x206f3b[_0x5b0b7a(0x24c)]((_0x2ec261,_0x294e33)=>{_0x5e3644[_0x294e33]['type']=_0x2ec261;}),_0xe9b6d6[_0x5b0b7a(0x24c)]((_0x4cd3cc,_0x1b41e6)=>{var _0x1bd601=_0x5b0b7a;_0x5e3644[_0x1b41e6][_0x1bd601(0x229)]=_0x4cd3cc;});var _0x280df7=0x0;_0x5e3644[_0x5b0b7a(0x24c)](_0x3c5bb4=>{var _0x514327=_0x5b0b7a;console['log'](_0x514327(0x214),_0x3c5bb4),(parseInt(_0x3c5bb4[_0x514327(0x231)])<parseInt(_0x3c5bb4['return_qty'])||parseInt(_0x3c5bb4['stock'])<parseInt(_0x3c5bb4[_0x514327(0x245)])&&parseInt(_0x3c5bb4[_0x514327(0x231)])>parseInt(_0x3c5bb4['return_qty'])||parseInt(_0x3c5bb4['return_qty'])==0x0)&&_0x280df7++;});if(_0x280df7!=0x0)return _0x3e30dc['flash']('errors',_0x5b0b7a(0x1ee)),_0x3a3620[_0x5b0b7a(0x239)](_0x5b0b7a(0x244));_0x3eeee6[_0x5b0b7a(0x23a)][_0x5b0b7a(0x24c)](_0x35a8e7=>{var _0x4295ca=_0x5b0b7a;const _0x56750e=_0x4b5ddb[_0x4295ca(0x223)][_0x4295ca(0x1d6)](_0x118b7d=>{var _0x254047=_0x4295ca;_0x118b7d['product_name']==_0x35a8e7[_0x254047(0x218)]&&_0x118b7d['floorlevel']==_0x35a8e7[_0x254047(0x229)]&&_0x118b7d[_0x254047(0x1e6)]==_0x35a8e7[_0x254047(0x1e6)]&&_0x118b7d['bin']==_0x35a8e7[_0x254047(0x23d)]&&_0x118b7d[_0x254047(0x23f)]==_0x35a8e7[_0x254047(0x23f)]&&(_0x118b7d[_0x254047(0x1eb)]=parseInt(_0x118b7d[_0x254047(0x1eb)])+parseInt(_0x35a8e7[_0x254047(0x245)]));});}),console['log']('old_warehouse_data',_0x4b5ddb),await _0x4b5ddb['save'](),_0x3eeee6[_0x5b0b7a(0x219)]=_0xf0f3cf,_0x3eeee6[_0x5b0b7a(0x221)]=_0x3dc0db,_0x3eeee6['date']=_0x22d7b1,_0x3eeee6[_0x5b0b7a(0x22a)]=_0x33d1b2,_0x3eeee6['return_sale']=_0x5e3644,_0x3eeee6[_0x5b0b7a(0x1d4)]=_0x554788,_0x3eeee6['ToWarehouse']=_0x49dc17,_0x3eeee6[_0x5b0b7a(0x1f4)]=_0x436632;const _0x22a503=await _0x3eeee6['save']();console[_0x5b0b7a(0x242)](_0x5b0b7a(0x204),_0x22a503);const _0x4ec1de=await c_payment_data[_0x5b0b7a(0x1fb)]({'invoice':_0x3e30dc['body'][_0x5b0b7a(0x219)],'reason':'Sale\x20Return'});_0x4ec1de['suppliers']=_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x238)],_0x4ec1de[_0x5b0b7a(0x243)]=_0x3e30dc[_0x5b0b7a(0x20d)][_0x5b0b7a(0x243)],await _0x4ec1de['save'](),_0x3e30dc[_0x5b0b7a(0x1df)](_0x5b0b7a(0x1ef),_0x5b0b7a(0x213)),_0x3a3620['redirect'](_0x5b0b7a(0x225));}catch(_0x27cb99){console[_0x5b0b7a(0x242)](_0x27cb99),_0x3a3620[_0x5b0b7a(0x1ff)](0xc8)['json']({'message':_0x27cb99[_0x5b0b7a(0x222)]});}}),router[a0_0x186172(0x240)]('/give_payment/:id',auth,async(_0x4eab63,_0x41bade)=>{var _0x39eb64=a0_0x186172;try{const _0x128c4f=_0x4eab63[_0x39eb64(0x247)]['id'],{invoice:_0x4c0551,customer:_0x4746a0,payable_to_customer:_0x2c39aa,paid_amount:_0x65fb0c}=_0x4eab63[_0x39eb64(0x20d)],_0x49f99f=await sales_return[_0x39eb64(0x211)](_0x128c4f);console['log'](_0x39eb64(0x1d7),_0x49f99f),console['log'](_0x2c39aa),console[_0x39eb64(0x242)](_0x65fb0c);var _0xbac67d=_0x2c39aa-_0x65fb0c;console[_0x39eb64(0x242)](_0x39eb64(0x201),_0xbac67d),_0x49f99f[_0x39eb64(0x20e)]=parseFloat(_0x65fb0c)+parseFloat(_0x49f99f[_0x39eb64(0x20e)]),_0x49f99f[_0x39eb64(0x21e)]=_0xbac67d,console['log'](_0x49f99f);const _0x25987a=await _0x49f99f['save']();console[_0x39eb64(0x242)](0x1b207);const _0x4b3893=await c_payment_data[_0x39eb64(0x1fb)]({'invoice':_0x4eab63['body']['invoice'],'reason':_0x39eb64(0x220)});console[_0x39eb64(0x242)](_0x39eb64(0x1f5),_0x4b3893),_0x4b3893[_0x39eb64(0x1e5)]=_0xbac67d,await _0x4b3893[_0x39eb64(0x21a)]();let _0x481adb=new Date(),_0x15e033=('0'+_0x481adb[_0x39eb64(0x200)]())['slice'](-0x2),_0x17b7ca=('0'+(_0x481adb[_0x39eb64(0x21d)]()+0x1))[_0x39eb64(0x1fd)](-0x2),_0x36a72e=_0x481adb['getFullYear'](),_0x9e0fc3=_0x36a72e+'-'+_0x17b7ca+'-'+_0x15e033;const _0x1dd996=new customer_payment({'invoice':_0x4c0551,'date':_0x36a72e+'-'+_0x17b7ca+'-'+_0x15e033,'customer':_0x4746a0,'reason':_0x39eb64(0x1fa),'amount':_0x65fb0c}),_0x1ff0df=await _0x1dd996['save']();_0x4eab63[_0x39eb64(0x1df)](_0x39eb64(0x1ef),_0x39eb64(0x22d)),_0x41bade[_0x39eb64(0x239)](_0x39eb64(0x225));}catch(_0x237311){console['log'](_0x237311);}}),router[a0_0x186172(0x236)]('/invoice/:id',auth,async(_0x313792,_0x1cc3d1)=>{var _0x48c4fa=a0_0x186172;try{const {username:_0x4dee96,email:_0x3d1bba,role:_0x286e97}=_0x313792[_0x48c4fa(0x209)],_0x1f3171=_0x313792[_0x48c4fa(0x209)],_0x5017ef=await profile['findOne']({'email':_0x1f3171[_0x48c4fa(0x24d)]}),_0x30f70b=await master_shop[_0x48c4fa(0x237)]();console[_0x48c4fa(0x242)](_0x48c4fa(0x241),_0x30f70b);const _0x4a3708=_0x313792['params']['id'],_0x39eef0=await sales_return['findById'](_0x4a3708);console[_0x48c4fa(0x242)](_0x39eef0);const _0x17d9cf=await customer[_0x48c4fa(0x1fb)]({'name':_0x39eef0[_0x48c4fa(0x221)]});console['log'](_0x17d9cf);if(_0x30f70b[0x0][_0x48c4fa(0x20c)]==_0x48c4fa(0x23c)){var _0x1a2748=users[_0x48c4fa(0x203)];console[_0x48c4fa(0x242)](_0x1a2748);}else{if(_0x30f70b[0x0][_0x48c4fa(0x20c)]==_0x48c4fa(0x1e8))var _0x1a2748=users[_0x48c4fa(0x1e8)];else{if(_0x30f70b[0x0][_0x48c4fa(0x20c)]==_0x48c4fa(0x21c))var _0x1a2748=users[_0x48c4fa(0x21c)];else{if(_0x30f70b[0x0][_0x48c4fa(0x20c)]=='Spanish')var _0x1a2748=users[_0x48c4fa(0x1f0)];else{if(_0x30f70b[0x0]['language']=='French')var _0x1a2748=users[_0x48c4fa(0x202)];else{if(_0x30f70b[0x0][_0x48c4fa(0x20c)]==_0x48c4fa(0x207))var _0x1a2748=users[_0x48c4fa(0x1f3)];else{if(_0x30f70b[0x0][_0x48c4fa(0x20c)]==_0x48c4fa(0x249))var _0x1a2748=users[_0x48c4fa(0x249)];else{if(_0x30f70b[0x0][_0x48c4fa(0x20c)]=='Arabic\x20(ae)')var _0x1a2748=users[_0x48c4fa(0x21b)];}}}}}}}_0x1cc3d1['render'](_0x48c4fa(0x1d5),{'success':_0x313792[_0x48c4fa(0x1df)](_0x48c4fa(0x1ef)),'errors':_0x313792[_0x48c4fa(0x1df)](_0x48c4fa(0x227)),'role':_0x1f3171,'profile':_0x5017ef,'master_shop':_0x30f70b,'customers':_0x17d9cf,'sales':_0x39eef0,'language':_0x1a2748});}catch(_0x304296){console[_0x48c4fa(0x242)](_0x304296);}}),module[a0_0x186172(0x1ea)]=router;function a0_0x186e(){var _0x160786=['bin','/view','bay','post','master','log','date','back','return_qty','name','params','6205782PGdBGf','Chinese','stock','stocks','forEach','email','/sales_return_finished/view','QA\x20Warehouse','../models/all_models','secondary_code','note','sales_return_invoice','map','data','types','product_name_QA','sales_quantity','aggregate','$name','return_qty_QA','8vYcQSJ','flash','render','$product_details.bay','string','11505329Hnnapp','Arabic\x20(ae)','amount','type','primary_code_QA','Hindi','38234IDdmLE','exports','product_stock','stocks_QA','return_sale_edit_finished','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','success','Spanish','$product_details.bin','8157373PdbpPL','Portuguese','ToRoom','c_payment','1217844OjYdkz','$product_details.rack','Router','$product_details.secondary_code','Returned\x20Payment\x20For\x20Sale\x20Return','findOne','$product_details.product_code','slice','220bUGasy','status','getDate','subtract','French','English','new\x20new_data','product_code_QA','return_sale_QA','Portuguese\x20(BR)','product_code','user','primary_code','secondary_code_QA','language','body','paid_amount','178911SyjutZ','../middleware/auth','findById','$product_details._id','purchase\x20return\x20successfully','foreach\x20newproduct','json','$product_details.product_stock','$product_details.product_name','product_name','invoice','save','Arabic','German','getMonth','due_amount','8wcVgSl','Sale\x20Return','customer','message','product_details','$product_details.floorlevel','/sales_return/view','../public/language/languages.json','errors','Enabled','floorlevel','warehouse_name','sales_quantity_QA','7219390UCRdPY','payment\x20successfull','$product_details.primary_code','24FTfmlE','express','sale_qty','Finished\x20Goods','old_warehouse_data','customers','customer_docs','get','find','suppliers','redirect','return_sale','ToWarehouse','English\x20(US)'];a0_0x186e=function(){return _0x160786;};return a0_0x186e();}