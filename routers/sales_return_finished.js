var a0_0x10bf46=a0_0x2ea4;function a0_0x2ea4(_0x5b736e,_0x3cf3dd){var _0x386f0f=a0_0x386f();return a0_0x2ea4=function(_0x2ea481,_0x444bf1){_0x2ea481=_0x2ea481-0x148;var _0x52951a=_0x386f0f[_0x2ea481];return _0x52951a;},a0_0x2ea4(_0x5b736e,_0x3cf3dd);}(function(_0x49d37c,_0x40e2ce){var _0x538125=a0_0x2ea4,_0x402abb=_0x49d37c();while(!![]){try{var _0x221ff5=-parseInt(_0x538125(0x168))/0x1*(-parseInt(_0x538125(0x15e))/0x2)+parseInt(_0x538125(0x18d))/0x3+parseInt(_0x538125(0x1a5))/0x4+parseInt(_0x538125(0x175))/0x5+-parseInt(_0x538125(0x1ab))/0x6+-parseInt(_0x538125(0x1bb))/0x7+-parseInt(_0x538125(0x1b1))/0x8;if(_0x221ff5===_0x40e2ce)break;else _0x402abb['push'](_0x402abb['shift']());}catch(_0x4a52eb){_0x402abb['push'](_0x402abb['shift']());}}}(a0_0x386f,0x21151));const express=require(a0_0x10bf46(0x182)),app=express(),router=express[a0_0x10bf46(0x152)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x10bf46(0x1a4)),auth=require('../middleware/auth'),users=require('../public/language/languages.json');router[a0_0x10bf46(0x1b4)](a0_0x10bf46(0x14f),auth,async(_0xb9e140,_0x2b6fbc)=>{var _0x1ba302=a0_0x10bf46;try{const {username:_0x6316aa,email:_0x24235b,role:_0x2f06f1}=_0xb9e140['user'],_0x102864=_0xb9e140[_0x1ba302(0x1ac)],_0x53dbec=await profile[_0x1ba302(0x155)]({'email':_0x102864['email']}),_0x550fbf=await master_shop['find'](),_0x26d016=await sales_return_finished['aggregate']([{'$lookup':{'from':'customers','localField':_0x1ba302(0x15a),'foreignField':'name','as':_0x1ba302(0x167)}},{'$unwind':_0x1ba302(0x149)}]);if(_0x550fbf[0x0]['language']==_0x1ba302(0x1b6)){var _0x434559=users[_0x1ba302(0x154)];console[_0x1ba302(0x14b)](_0x434559);}else{if(_0x550fbf[0x0][_0x1ba302(0x188)]==_0x1ba302(0x186))var _0x434559=users[_0x1ba302(0x186)];else{if(_0x550fbf[0x0][_0x1ba302(0x188)]==_0x1ba302(0x153))var _0x434559=users['German'];else{if(_0x550fbf[0x0][_0x1ba302(0x188)]==_0x1ba302(0x18f))var _0x434559=users[_0x1ba302(0x18f)];else{if(_0x550fbf[0x0][_0x1ba302(0x188)]==_0x1ba302(0x19e))var _0x434559=users[_0x1ba302(0x19e)];else{if(_0x550fbf[0x0][_0x1ba302(0x188)]=='Portuguese\x20(BR)')var _0x434559=users[_0x1ba302(0x19a)];else{if(_0x550fbf[0x0][_0x1ba302(0x188)]==_0x1ba302(0x192))var _0x434559=users['Chinese'];else{if(_0x550fbf[0x0][_0x1ba302(0x188)]==_0x1ba302(0x1a6))var _0x434559=users[_0x1ba302(0x163)];}}}}}}}_0x2b6fbc[_0x1ba302(0x1a9)](_0x1ba302(0x1b9),{'success':_0xb9e140[_0x1ba302(0x162)]('success'),'errors':_0xb9e140[_0x1ba302(0x162)]('errors'),'role':_0x102864,'profile':_0x53dbec,'master_shop':_0x550fbf,'user':_0x26d016,'language':_0x434559});}catch(_0x43b915){console[_0x1ba302(0x14b)](_0x43b915);}}),router[a0_0x10bf46(0x1b4)]('/view/:id',auth,async(_0x2dee7f,_0x5bb549)=>{var _0x9faff=a0_0x10bf46;try{const {username:_0x364721,email:_0x26f097,role:_0x2d427b}=_0x2dee7f[_0x9faff(0x1ac)],_0x41a7d2=_0x2dee7f[_0x9faff(0x1ac)],_0x291ea8=await profile[_0x9faff(0x155)]({'email':_0x41a7d2[_0x9faff(0x17f)]}),_0x29383a=await master_shop['find']();console[_0x9faff(0x14b)](_0x9faff(0x183),_0x29383a);const _0x1165fc=_0x2dee7f['params']['id'];console['log'](_0x1165fc);var _0x513b5f=[_0x9faff(0x1b8)];const _0x4b5ff8=await sales_return_finished[_0x9faff(0x16b)](_0x1165fc),_0x50fa99=await warehouse[_0x9faff(0x173)]([{'$match':{'name':_0x4b5ff8[_0x9faff(0x1a1)],'room':_0x4b5ff8['ToRoom']}},{'$unwind':_0x9faff(0x18c)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x9faff(0x169)},'product_stock':{'$first':_0x9faff(0x1b3)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x9faff(0x16f)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x9faff(0x199)},'secondary_code':{'$first':_0x9faff(0x17b)},'product_code':{'$first':_0x9faff(0x177)},'storage':{'$first':_0x9faff(0x1aa)},'rack':{'$first':'$product_details.rack'}}}]);console[_0x9faff(0x14b)](_0x50fa99);const _0x1d50d7=await warehouse[_0x9faff(0x173)]([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x9faff(0x19f),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x124d2d=await warehouse['aggregate']([{'$match':{'status':_0x9faff(0x158),'name':_0x9faff(0x185)}},{'$group':{'_id':_0x9faff(0x19f),'name':{'$first':_0x9faff(0x19f)}}},{'$sort':{'name':0x1}}]),_0x8b8b76=await product[_0x9faff(0x184)]({});if(_0x29383a[0x0]['language']==_0x9faff(0x1b6)){var _0xdcd307=users[_0x9faff(0x154)];console[_0x9faff(0x14b)](_0xdcd307);}else{if(_0x29383a[0x0][_0x9faff(0x188)]==_0x9faff(0x186))var _0xdcd307=users[_0x9faff(0x186)];else{if(_0x29383a[0x0][_0x9faff(0x188)]==_0x9faff(0x153))var _0xdcd307=users[_0x9faff(0x153)];else{if(_0x29383a[0x0]['language']==_0x9faff(0x18f))var _0xdcd307=users['Spanish'];else{if(_0x29383a[0x0]['language']==_0x9faff(0x19e))var _0xdcd307=users[_0x9faff(0x19e)];else{if(_0x29383a[0x0][_0x9faff(0x188)]==_0x9faff(0x159))var _0xdcd307=users[_0x9faff(0x19a)];else{if(_0x29383a[0x0][_0x9faff(0x188)]==_0x9faff(0x192))var _0xdcd307=users[_0x9faff(0x192)];else{if(_0x29383a[0x0][_0x9faff(0x188)]==_0x9faff(0x1a6))var _0xdcd307=users[_0x9faff(0x163)];}}}}}}}_0x5bb549[_0x9faff(0x1a9)]('return_sale_edit_finished',{'success':_0x2dee7f[_0x9faff(0x162)](_0x9faff(0x176)),'errors':_0x2dee7f[_0x9faff(0x162)](_0x9faff(0x150)),'role':_0x41a7d2,'profile':_0x291ea8,'master_shop':_0x29383a,'user':_0x4b5ff8,'stock':_0x50fa99,'unit':_0x8b8b76,'language':_0xdcd307,'warehouses':_0x1d50d7,'rooms':_0x513b5f,'warehouse_QA':_0x124d2d});}catch(_0x521827){console[_0x9faff(0x14b)](_0x521827);}}),router[a0_0x10bf46(0x190)](a0_0x10bf46(0x1b7),auth,async(_0x2c404d,_0x7e39dc)=>{var _0x439dac=a0_0x10bf46;if(_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x197)]=='QA')try{const _0x449f7c=_0x2c404d[_0x439dac(0x18e)]['id'],_0x8d5bc9=await sales_return[_0x439dac(0x155)]({'invoice':_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x14e)]}),_0x243207=await warehouse[_0x439dac(0x155)]({'name':_0x8d5bc9[_0x439dac(0x1a1)],'room':_0x8d5bc9[_0x439dac(0x17e)]}),{invoice:_0x4de175,customer:_0xc739c,date:_0x5b66b8,warehouse_name:_0x41ec44,product_name:_0x30aa1e,primary_code:_0x495e19,secondary_code:_0x429a68,product_code:_0x4afb18,sales_quantity:_0x3188b7,stocks:_0x82ce54,return_qty:_0x1f8a8e,note:_0x4f2d10,to_warehouse_name_QA:_0xf0efdf,to_Room_name_QA:_0x1000cf}=_0x2c404d[_0x439dac(0x1a8)];if(typeof product_name_QA=='string')var _0x5ee837=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x157)]],_0x41f06c=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x191)]],_0x1bc63a=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x1a2)]],_0x39990d=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x19d)]],_0x40eb97=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x15f)]],_0x45f90a=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x171)]],_0x375a6b=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x15c)]];else var _0x5ee837=[..._0x2c404d['body']['product_name_QA']],_0x41f06c=[..._0x2c404d['body'][_0x439dac(0x191)]],_0x1bc63a=[..._0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x1a2)]],_0x39990d=[..._0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x19d)]],_0x40eb97=[..._0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x15f)]],_0x45f90a=[..._0x2c404d['body'][_0x439dac(0x171)]],_0x375a6b=[..._0x2c404d[_0x439dac(0x1a8)]['return_qty_QA']];const _0x3b3083=_0x5ee837[_0x439dac(0x1b0)](_0x2dda28=>{return _0x2dda28={'product_name':_0x2dda28};});_0x41f06c[_0x439dac(0x180)]((_0x502ed8,_0x148c99)=>{var _0x31bd1c=_0x439dac;_0x3b3083[_0x148c99][_0x31bd1c(0x160)]=_0x502ed8;}),_0x1bc63a['forEach']((_0x43ce6a,_0x1eef57)=>{_0x3b3083[_0x1eef57]['secondary_code']=_0x43ce6a;}),_0x39990d[_0x439dac(0x180)]((_0x3d2dad,_0xdc5bf5)=>{var _0x41e666=_0x439dac;_0x3b3083[_0xdc5bf5][_0x41e666(0x19b)]=_0x3d2dad;}),_0x40eb97[_0x439dac(0x180)]((_0x56e937,_0x2bcf12)=>{_0x3b3083[_0x2bcf12]['sale_qty']=_0x56e937;}),_0x45f90a['forEach']((_0x25f320,_0x3ffe0e)=>{_0x3b3083[_0x3ffe0e]['stock']=_0x25f320;}),_0x375a6b['forEach']((_0x43dbe2,_0x2879fe)=>{var _0x1852a6=_0x439dac;_0x3b3083[_0x2879fe][_0x1852a6(0x16a)]=_0x43dbe2;}),_0x8d5bc9[_0x439dac(0x189)][_0x439dac(0x180)](_0x55e145=>{var _0x34a830=_0x439dac;const _0x3d66df=_0x243207[_0x34a830(0x14d)][_0x34a830(0x1b0)](_0x297153=>{var _0x5a1c1e=_0x34a830;_0x297153[_0x5a1c1e(0x165)]==_0x55e145[_0x5a1c1e(0x165)]&&(_0x297153[_0x5a1c1e(0x1bc)]=parseInt(_0x297153[_0x5a1c1e(0x1bc)])+parseInt(_0x55e145[_0x5a1c1e(0x16a)]));});}),await _0x243207[_0x439dac(0x172)](),_0x8d5bc9['invoice']=_0x4de175,_0x8d5bc9[_0x439dac(0x15a)]=_0xc739c,_0x8d5bc9['date']=_0x5b66b8,_0x8d5bc9[_0x439dac(0x194)]=_0x41ec44,_0x8d5bc9[_0x439dac(0x189)]=_0x3b3083,_0x8d5bc9[_0x439dac(0x151)]=_0x4f2d10,_0x8d5bc9[_0x439dac(0x1a1)]=_0xf0efdf,_0x8d5bc9[_0x439dac(0x17e)]=_0x1000cf;const _0x4c8e95=await _0x8d5bc9[_0x439dac(0x172)](),_0x52a5c9=await c_payment_data[_0x439dac(0x155)]({'invoice':_0x2c404d['body'][_0x439dac(0x14e)],'reason':_0x439dac(0x17d)});_0x52a5c9[_0x439dac(0x181)]=_0x2c404d[_0x439dac(0x1a8)]['suppliers'],_0x52a5c9[_0x439dac(0x14c)]=_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x14c)],await _0x52a5c9[_0x439dac(0x172)](),_0x2c404d[_0x439dac(0x162)](_0x439dac(0x176),_0x439dac(0x1bd)),_0x7e39dc[_0x439dac(0x196)](_0x439dac(0x148));}catch(_0x452eb0){console[_0x439dac(0x14b)](_0x452eb0),_0x7e39dc[_0x439dac(0x179)](0xc8)[_0x439dac(0x17c)]({'message':_0x452eb0[_0x439dac(0x1be)]});}else try{const _0xb676c=_0x2c404d['params']['id'];console[_0x439dac(0x14b)](_0xb676c);const _0x115a8e=await sales_return[_0x439dac(0x155)]({'invoice':_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x14e)]});console[_0x439dac(0x14b)](_0x439dac(0x1a3),_0x115a8e);const _0x357417=await warehouse[_0x439dac(0x155)]({'name':_0x115a8e[_0x439dac(0x1a1)],'room':_0x115a8e[_0x439dac(0x17e)]});console['log'](_0x439dac(0x17a),_0x357417);const {invoice:_0x2a9d6c,customer:_0x23cf47,date:_0x32287e,warehouse_name:_0x6b31d5,product_name:_0x5dbe9b,primary_code:_0x310637,secondary_code:_0x439330,product_code:_0x3aa809,sales_quantity:_0x5a91d7,stocks:_0x5e1758,return_qty:_0x75bda0,note:_0xb2f733,to_warehouse_name:_0x2dd104,to_Room_name:_0x2b9983}=_0x2c404d[_0x439dac(0x1a8)];console['log'](_0x2c404d[_0x439dac(0x1a8)]);if(typeof _0x5dbe9b==_0x439dac(0x1ae))var _0x5ee837=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x165)]],_0x41f06c=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x160)]],_0x1bc63a=[_0x2c404d[_0x439dac(0x1a8)]['secondary_code']],_0x39990d=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x19b)]],_0x40eb97=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x15d)]],_0x45f90a=[_0x2c404d['body'][_0x439dac(0x19c)]],_0x375a6b=[_0x2c404d['body'][_0x439dac(0x16a)]],_0x4fa20d=[_0x2c404d[_0x439dac(0x1a8)]['bay']],_0x15574e=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x174)]],_0x5027ee=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x187)]],_0x263827=[_0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x1ba)]];else var _0x5ee837=[..._0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x165)]],_0x41f06c=[..._0x2c404d['body']['primary_code']],_0x1bc63a=[..._0x2c404d['body'][_0x439dac(0x14a)]],_0x39990d=[..._0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x19b)]],_0x40eb97=[..._0x2c404d['body'][_0x439dac(0x15d)]],_0x45f90a=[..._0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x19c)]],_0x375a6b=[..._0x2c404d['body'][_0x439dac(0x16a)]],_0x4fa20d=[..._0x2c404d['body']['bay']],_0x15574e=[..._0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x174)]],_0x5027ee=[..._0x2c404d[_0x439dac(0x1a8)][_0x439dac(0x187)]],_0x263827=[..._0x2c404d['body'][_0x439dac(0x1ba)]];const _0x95f385=_0x5ee837['map'](_0x59481f=>{return _0x59481f={'product_name':_0x59481f};});_0x41f06c[_0x439dac(0x180)]((_0x3fb942,_0x34078d)=>{var _0x14bc67=_0x439dac;_0x95f385[_0x34078d][_0x14bc67(0x160)]=_0x3fb942;}),_0x1bc63a['forEach']((_0x794d53,_0x26e76d)=>{var _0x27fe75=_0x439dac;_0x95f385[_0x26e76d][_0x27fe75(0x14a)]=_0x794d53;}),_0x39990d['forEach']((_0x256445,_0x4a6fac)=>{var _0x35a60f=_0x439dac;_0x95f385[_0x4a6fac][_0x35a60f(0x19b)]=_0x256445;}),_0x40eb97[_0x439dac(0x180)]((_0x66ef3b,_0x43c4e5)=>{var _0x1e43c8=_0x439dac;_0x95f385[_0x43c4e5][_0x1e43c8(0x16c)]=_0x66ef3b;}),_0x45f90a[_0x439dac(0x180)]((_0x17abfd,_0x1aaa22)=>{var _0x406c76=_0x439dac;_0x95f385[_0x1aaa22][_0x406c76(0x195)]=_0x17abfd;}),_0x375a6b[_0x439dac(0x180)]((_0x2916f4,_0x380856)=>{_0x95f385[_0x380856]['return_qty']=_0x2916f4;}),_0x4fa20d[_0x439dac(0x180)]((_0x467bdf,_0x594702)=>{var _0x2a61bd=_0x439dac;_0x95f385[_0x594702][_0x2a61bd(0x1a7)]=_0x467bdf;}),_0x15574e['forEach']((_0x282a31,_0x733e65)=>{var _0x205b62=_0x439dac;_0x95f385[_0x733e65][_0x205b62(0x174)]=_0x282a31;}),_0x5027ee[_0x439dac(0x180)]((_0x194fd8,_0x549ff5)=>{var _0x8fea54=_0x439dac;_0x95f385[_0x549ff5][_0x8fea54(0x16d)]=_0x194fd8;}),_0x263827[_0x439dac(0x180)]((_0x27baa9,_0x500913)=>{var _0x4a3193=_0x439dac;_0x95f385[_0x500913][_0x4a3193(0x1ba)]=_0x27baa9;});var _0x24edde=0x0;_0x95f385[_0x439dac(0x180)](_0xcfd9ad=>{var _0x45dbcd=_0x439dac;console[_0x45dbcd(0x14b)](_0x45dbcd(0x1b5),_0xcfd9ad),(parseInt(_0xcfd9ad['sale_qty'])<parseInt(_0xcfd9ad[_0x45dbcd(0x16a)])||parseInt(_0xcfd9ad['stock'])<parseInt(_0xcfd9ad[_0x45dbcd(0x16a)])&&parseInt(_0xcfd9ad['sale_qty'])>parseInt(_0xcfd9ad[_0x45dbcd(0x16a)])||parseInt(_0xcfd9ad[_0x45dbcd(0x16a)])==0x0)&&_0x24edde++;});if(_0x24edde!=0x0)return _0x2c404d['flash'](_0x439dac(0x150),_0x439dac(0x170)),_0x7e39dc[_0x439dac(0x196)](_0x439dac(0x18b));_0x115a8e['return_sale'][_0x439dac(0x180)](_0x37fe88=>{var _0x2d2820=_0x439dac;const _0x226609=_0x357417[_0x2d2820(0x14d)][_0x2d2820(0x1b0)](_0x2d9b76=>{var _0x4ca3cc=_0x2d2820;_0x2d9b76['product_name']==_0x37fe88['product_name']&&_0x2d9b76[_0x4ca3cc(0x1ba)]==_0x37fe88[_0x4ca3cc(0x1ba)]&&_0x2d9b76[_0x4ca3cc(0x16d)]==_0x37fe88['type']&&_0x2d9b76[_0x4ca3cc(0x174)]==_0x37fe88[_0x4ca3cc(0x174)]&&_0x2d9b76[_0x4ca3cc(0x1a7)]==_0x37fe88['bay']&&(_0x2d9b76['product_stock']=parseInt(_0x2d9b76['product_stock'])+parseInt(_0x37fe88['return_qty']));});}),console[_0x439dac(0x14b)](_0x439dac(0x17a),_0x357417),await _0x357417[_0x439dac(0x172)](),_0x115a8e['invoice']=_0x2a9d6c,_0x115a8e[_0x439dac(0x15a)]=_0x23cf47,_0x115a8e[_0x439dac(0x14c)]=_0x32287e,_0x115a8e[_0x439dac(0x194)]=_0x6b31d5,_0x115a8e[_0x439dac(0x15b)]=_0x95f385,_0x115a8e[_0x439dac(0x151)]=_0xb2f733,_0x115a8e[_0x439dac(0x1a1)]=_0x2dd104,_0x115a8e[_0x439dac(0x17e)]=_0x2b9983;const _0x391912=await _0x115a8e['save']();console[_0x439dac(0x14b)](_0x439dac(0x1a0),_0x391912);const _0x32ed98=await c_payment_data['findOne']({'invoice':_0x2c404d[_0x439dac(0x1a8)]['invoice'],'reason':_0x439dac(0x17d)});_0x32ed98['suppliers']=_0x2c404d['body'][_0x439dac(0x181)],_0x32ed98[_0x439dac(0x14c)]=_0x2c404d['body'][_0x439dac(0x14c)],await _0x32ed98['save'](),_0x2c404d[_0x439dac(0x162)](_0x439dac(0x176),_0x439dac(0x1bd)),_0x7e39dc[_0x439dac(0x196)]('/sales_return/view');}catch(_0x5c6b52){console['log'](_0x5c6b52),_0x7e39dc['status'](0xc8)[_0x439dac(0x17c)]({'message':_0x5c6b52[_0x439dac(0x1be)]});}}),router['post'](a0_0x10bf46(0x1b2),auth,async(_0xc6ce56,_0x319099)=>{var _0x45f377=a0_0x10bf46;try{const _0x33e958=_0xc6ce56[_0x45f377(0x18e)]['id'],{invoice:_0x4b05da,customer:_0x39d15d,payable_to_customer:_0x574acb,paid_amount:_0x36410e}=_0xc6ce56['body'],_0x1bdcbf=await sales_return[_0x45f377(0x16b)](_0x33e958);console[_0x45f377(0x14b)](_0x45f377(0x156),_0x1bdcbf),console['log'](_0x574acb),console[_0x45f377(0x14b)](_0x36410e);var _0x5500b1=_0x574acb-_0x36410e;console[_0x45f377(0x14b)]('subtract',_0x5500b1),_0x1bdcbf[_0x45f377(0x1af)]=parseFloat(_0x36410e)+parseFloat(_0x1bdcbf[_0x45f377(0x1af)]),_0x1bdcbf['due_amount']=_0x5500b1,console[_0x45f377(0x14b)](_0x1bdcbf);const _0x5ecde4=await _0x1bdcbf[_0x45f377(0x172)]();console[_0x45f377(0x14b)](0x1b207);const _0x18d86c=await c_payment_data[_0x45f377(0x155)]({'invoice':_0xc6ce56[_0x45f377(0x1a8)][_0x45f377(0x14e)],'reason':'Sale\x20Return'});console[_0x45f377(0x14b)](_0x45f377(0x178),_0x18d86c),_0x18d86c[_0x45f377(0x1ad)]=_0x5500b1,await _0x18d86c['save']();let _0x44ebfa=new Date(),_0x51cdee=('0'+_0x44ebfa[_0x45f377(0x164)]())['slice'](-0x2),_0x5c5705=('0'+(_0x44ebfa[_0x45f377(0x16e)]()+0x1))['slice'](-0x2),_0x431d54=_0x44ebfa['getFullYear'](),_0x4890b9=_0x431d54+'-'+_0x5c5705+'-'+_0x51cdee;const _0x2ba90b=new customer_payment({'invoice':_0x4b05da,'date':_0x431d54+'-'+_0x5c5705+'-'+_0x51cdee,'customer':_0x39d15d,'reason':_0x45f377(0x161),'amount':_0x36410e}),_0x2524c2=await _0x2ba90b['save']();_0xc6ce56['flash'](_0x45f377(0x176),_0x45f377(0x166)),_0x319099[_0x45f377(0x196)](_0x45f377(0x18a));}catch(_0x343845){console[_0x45f377(0x14b)](_0x343845);}}),router[a0_0x10bf46(0x1b4)](a0_0x10bf46(0x193),auth,async(_0x4ae7be,_0x593501)=>{var _0x253dfa=a0_0x10bf46;try{const {username:_0x399010,email:_0x54c86f,role:_0x209a51}=_0x4ae7be[_0x253dfa(0x1ac)],_0x2a0e8e=_0x4ae7be['user'],_0x2a4ff9=await profile[_0x253dfa(0x155)]({'email':_0x2a0e8e[_0x253dfa(0x17f)]}),_0x4f30fc=await master_shop['find']();console[_0x253dfa(0x14b)](_0x253dfa(0x183),_0x4f30fc);const _0x235a70=_0x4ae7be['params']['id'],_0x499a8f=await sales_return[_0x253dfa(0x16b)](_0x235a70);console['log'](_0x499a8f);const _0x4cc70f=await customer[_0x253dfa(0x155)]({'name':_0x499a8f[_0x253dfa(0x15a)]});console['log'](_0x4cc70f);if(_0x4f30fc[0x0]['language']==_0x253dfa(0x1b6)){var _0x300385=users[_0x253dfa(0x154)];console[_0x253dfa(0x14b)](_0x300385);}else{if(_0x4f30fc[0x0][_0x253dfa(0x188)]==_0x253dfa(0x186))var _0x300385=users[_0x253dfa(0x186)];else{if(_0x4f30fc[0x0]['language']==_0x253dfa(0x153))var _0x300385=users[_0x253dfa(0x153)];else{if(_0x4f30fc[0x0][_0x253dfa(0x188)]=='Spanish')var _0x300385=users[_0x253dfa(0x18f)];else{if(_0x4f30fc[0x0]['language']=='French')var _0x300385=users[_0x253dfa(0x19e)];else{if(_0x4f30fc[0x0]['language']==_0x253dfa(0x159))var _0x300385=users['Portuguese'];else{if(_0x4f30fc[0x0][_0x253dfa(0x188)]==_0x253dfa(0x192))var _0x300385=users[_0x253dfa(0x192)];else{if(_0x4f30fc[0x0][_0x253dfa(0x188)]=='Arabic\x20(ae)')var _0x300385=users['Arabic'];}}}}}}}_0x593501[_0x253dfa(0x1a9)]('sales_return_invoice',{'success':_0x4ae7be[_0x253dfa(0x162)](_0x253dfa(0x176)),'errors':_0x4ae7be[_0x253dfa(0x162)](_0x253dfa(0x150)),'role':_0x2a0e8e,'profile':_0x2a4ff9,'master_shop':_0x4f30fc,'customers':_0x4cc70f,'sales':_0x499a8f,'language':_0x300385});}catch(_0x34e49e){console['log'](_0x34e49e);}}),module[a0_0x10bf46(0x198)]=router;function a0_0x386f(){var _0x3d1c50=['aggregate','bin','631530BwHJAU','success','$product_details.product_code','c_payment','status','old_warehouse_data','$product_details.secondary_code','json','Sale\x20Return','ToRoom','email','forEach','suppliers','express','master','find','QA\x20Warehouse','Hindi','types','language','return_sale_QA','/sales_return/view','back','$product_details','652815mGsbUc','params','Spanish','post','primary_code_QA','Chinese','/invoice/:id','warehouse_name','stock','redirect','for_categorize','exports','$product_details.primary_code','Portuguese','product_code','stocks','product_code_QA','French','$name','new\x20new_data','ToWarehouse','secondary_code_QA','old_data','../models/all_models','6248MCkDIM','Arabic\x20(ae)','bay','body','render','$product_details.storage','331038YrZgTy','user','amount','string','paid_amount','map','1567896cFLYUK','/give_payment/:id','$product_details.product_stock','get','foreach\x20newproduct','English\x20(US)','/view/:id','Return\x20Rooms','sales_return_finished','floorlevel','1396339GfkcJm','product_stock','purchase\x20return\x20successfully','message','/sales_return_finished/view','$customer_docs','secondary_code','log','date','product_details','invoice','/view','errors','note','Router','German','English','findOne','data','product_name_QA','Enabled','Portuguese\x20(BR)','customer','return_sale','return_qty_QA','sales_quantity','3146mXIpmR','sales_quantity_QA','primary_code','Returned\x20Payment\x20For\x20Sale\x20Return','flash','Arabic','getDate','product_name','payment\x20successfull','customer_docs','153KnZfNs','$product_details.product_name','return_qty','findById','sale_qty','type','getMonth','$product_details.type','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','stocks_QA','save'];a0_0x386f=function(){return _0x3d1c50;};return a0_0x386f();}