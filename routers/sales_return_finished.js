var a0_0x3fca52=a0_0x355b;function a0_0x2855(){var _0x1eaf8f=['sale_qty','customers','$product_details','product_stock','params','Spanish','$product_details.rack','purchase\x20return\x20successfully','old_data','message','secondary_code','aggregate','6261sjMSDz','/sales_return/view','French','render','$product_details.product_name','paid_amount','stocks','1092736qEiwKU','warehouse_name','forEach','Finished\x20Goods','$product_details.floorlevel','$name','primary_code','customer','return_sale','Hindi','post','Enabled','Returned\x20Payment\x20For\x20Sale\x20Return','c_payment','/view/:id','stock','$product_details.bay','../models/all_models','master','478830xAZXJO','suppliers','customer_docs','product_code_QA','save','Arabic\x20(ae)','findById','status','/view','old_warehouse_data','map','$product_details.type','$product_details.bin','sales_return_finished','back','German','Portuguese','$product_details._id','date','product_name','English\x20(US)','ToRoom','flash','sales_return_invoice','Portuguese\x20(BR)','English','$product_details.product_stock','redirect','types','return_qty','52UeRkoJ','1314047yOvfHQ','$customer_docs','string','Return\x20Rooms','ToWarehouse','product_details','user','sales_quantity','$product_details.product_code','errors','sales_quantity_QA','success','body','note','findOne','return_sale_edit_finished','find','getMonth','1261815xbKPBv','2328FhRFgI','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','product_code','stocks_QA','get','due_amount','return_sale_QA','getDate','for_categorize','bay','product_name_QA','exports','56952iAWzjj','20SMeDQu','primary_code_QA','Sale\x20Return','bin','Chinese','json','log','foreach\x20newproduct','../middleware/auth','email','language','type','$product_details.primary_code','slice','Arabic','invoice','floorlevel','QA\x20Warehouse','$product_details.storage'];a0_0x2855=function(){return _0x1eaf8f;};return a0_0x2855();}(function(_0x5e6a48,_0x31b779){var _0x476f33=a0_0x355b,_0x438be9=_0x5e6a48();while(!![]){try{var _0x201c70=parseInt(_0x476f33(0x14a))/0x1*(parseInt(_0x476f33(0x136))/0x2)+-parseInt(_0x476f33(0xfe))/0x3*(parseInt(_0x476f33(0xdf))/0x4)+parseInt(_0x476f33(0x149))/0x5+-parseInt(_0x476f33(0x118))/0x6+-parseInt(_0x476f33(0x137))/0x7+parseInt(_0x476f33(0x105))/0x8+parseInt(_0x476f33(0xde))/0x9;if(_0x201c70===_0x31b779)break;else _0x438be9['push'](_0x438be9['shift']());}catch(_0xe4c20d){_0x438be9['push'](_0x438be9['shift']());}}}(a0_0x2855,0x2b6ba));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x3fca52(0x116)),auth=require(a0_0x3fca52(0xe7)),users=require('../public/language/languages.json');function a0_0x355b(_0x417c02,_0x264780){var _0x2855e5=a0_0x2855();return a0_0x355b=function(_0x355b44,_0x3d1ba7){_0x355b44=_0x355b44-0xdc;var _0xcb4877=_0x2855e5[_0x355b44];return _0xcb4877;},a0_0x355b(_0x417c02,_0x264780);}router[a0_0x3fca52(0x14e)](a0_0x3fca52(0x120),auth,async(_0x506350,_0x36f1ba)=>{var _0x1f68d1=a0_0x3fca52;try{const {username:_0x3bb1e9,email:_0x28f659,role:_0x40ee9c}=_0x506350[_0x1f68d1(0x13d)],_0x30267b=_0x506350[_0x1f68d1(0x13d)],_0x3e9715=await profile['findOne']({'email':_0x30267b[_0x1f68d1(0xe8)]}),_0x5ee805=await master_shop[_0x1f68d1(0x147)](),_0x3fe50b=await sales_return_finished[_0x1f68d1(0xfd)]([{'$lookup':{'from':_0x1f68d1(0xf3),'localField':_0x1f68d1(0x10c),'foreignField':'name','as':_0x1f68d1(0x11a)}},{'$unwind':_0x1f68d1(0x138)}]);if(_0x5ee805[0x0][_0x1f68d1(0xe9)]==_0x1f68d1(0x12c)){var _0x579c79=users[_0x1f68d1(0x131)];console[_0x1f68d1(0xe5)](_0x579c79);}else{if(_0x5ee805[0x0]['language']==_0x1f68d1(0x10e))var _0x579c79=users['Hindi'];else{if(_0x5ee805[0x0][_0x1f68d1(0xe9)]==_0x1f68d1(0x127))var _0x579c79=users[_0x1f68d1(0x127)];else{if(_0x5ee805[0x0][_0x1f68d1(0xe9)]==_0x1f68d1(0xf7))var _0x579c79=users[_0x1f68d1(0xf7)];else{if(_0x5ee805[0x0][_0x1f68d1(0xe9)]==_0x1f68d1(0x100))var _0x579c79=users[_0x1f68d1(0x100)];else{if(_0x5ee805[0x0][_0x1f68d1(0xe9)]=='Portuguese\x20(BR)')var _0x579c79=users[_0x1f68d1(0x128)];else{if(_0x5ee805[0x0][_0x1f68d1(0xe9)]==_0x1f68d1(0xe3))var _0x579c79=users[_0x1f68d1(0xe3)];else{if(_0x5ee805[0x0][_0x1f68d1(0xe9)]==_0x1f68d1(0x11d))var _0x579c79=users['Arabic'];}}}}}}}_0x36f1ba[_0x1f68d1(0x101)](_0x1f68d1(0x125),{'success':_0x506350[_0x1f68d1(0x12e)](_0x1f68d1(0x142)),'errors':_0x506350[_0x1f68d1(0x12e)](_0x1f68d1(0x140)),'role':_0x30267b,'profile':_0x3e9715,'master_shop':_0x5ee805,'user':_0x3fe50b,'language':_0x579c79});}catch(_0x15c880){console[_0x1f68d1(0xe5)](_0x15c880);}}),router['get']('/view/:id',auth,async(_0x47be12,_0x4cb693)=>{var _0xe02bb2=a0_0x3fca52;try{const {username:_0x386bf7,email:_0x1462ac,role:_0x49bba2}=_0x47be12['user'],_0x3dcf3e=_0x47be12[_0xe02bb2(0x13d)],_0x125046=await profile[_0xe02bb2(0x145)]({'email':_0x3dcf3e[_0xe02bb2(0xe8)]}),_0x15ea81=await master_shop['find']();console[_0xe02bb2(0xe5)]('master',_0x15ea81);const _0x374d6b=_0x47be12[_0xe02bb2(0xf6)]['id'];console[_0xe02bb2(0xe5)](_0x374d6b);var _0x1526ce=[_0xe02bb2(0x13a)];const _0xdd4e23=await sales_return_finished[_0xe02bb2(0x11e)](_0x374d6b),_0x434111=await warehouse[_0xe02bb2(0xfd)]([{'$match':{'name':_0xdd4e23['ToWarehouse'],'room':_0xdd4e23[_0xe02bb2(0x12d)]}},{'$unwind':_0xe02bb2(0xf4)},{'$group':{'_id':_0xe02bb2(0x129),'name':{'$first':_0xe02bb2(0x102)},'product_stock':{'$first':_0xe02bb2(0x132)},'bay':{'$first':_0xe02bb2(0x115)},'bin':{'$first':_0xe02bb2(0x124)},'type':{'$first':_0xe02bb2(0x123)},'floorlevel':{'$first':_0xe02bb2(0x109)},'primary_code':{'$first':_0xe02bb2(0xeb)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xe02bb2(0x13f)},'storage':{'$first':_0xe02bb2(0xf1)},'rack':{'$first':_0xe02bb2(0xf8)}}}]);console[_0xe02bb2(0xe5)](_0x434111);const _0x34ccd=await warehouse[_0xe02bb2(0xfd)]([{'$match':{'status':_0xe02bb2(0x110),'warehouse_category':_0xe02bb2(0x108)}},{'$group':{'_id':_0xe02bb2(0x10a),'name':{'$first':_0xe02bb2(0x10a)}}},{'$sort':{'name':0x1}}]),_0x163ce1=await warehouse[_0xe02bb2(0xfd)]([{'$match':{'status':_0xe02bb2(0x110),'name':_0xe02bb2(0xf0)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x184623=await product[_0xe02bb2(0x147)]({});if(_0x15ea81[0x0][_0xe02bb2(0xe9)]==_0xe02bb2(0x12c)){var _0x524d74=users[_0xe02bb2(0x131)];console[_0xe02bb2(0xe5)](_0x524d74);}else{if(_0x15ea81[0x0][_0xe02bb2(0xe9)]==_0xe02bb2(0x10e))var _0x524d74=users['Hindi'];else{if(_0x15ea81[0x0][_0xe02bb2(0xe9)]=='German')var _0x524d74=users[_0xe02bb2(0x127)];else{if(_0x15ea81[0x0][_0xe02bb2(0xe9)]==_0xe02bb2(0xf7))var _0x524d74=users[_0xe02bb2(0xf7)];else{if(_0x15ea81[0x0][_0xe02bb2(0xe9)]==_0xe02bb2(0x100))var _0x524d74=users[_0xe02bb2(0x100)];else{if(_0x15ea81[0x0]['language']==_0xe02bb2(0x130))var _0x524d74=users[_0xe02bb2(0x128)];else{if(_0x15ea81[0x0]['language']==_0xe02bb2(0xe3))var _0x524d74=users[_0xe02bb2(0xe3)];else{if(_0x15ea81[0x0][_0xe02bb2(0xe9)]=='Arabic\x20(ae)')var _0x524d74=users[_0xe02bb2(0xed)];}}}}}}}_0x4cb693[_0xe02bb2(0x101)](_0xe02bb2(0x146),{'success':_0x47be12['flash'](_0xe02bb2(0x142)),'errors':_0x47be12[_0xe02bb2(0x12e)](_0xe02bb2(0x140)),'role':_0x3dcf3e,'profile':_0x125046,'master_shop':_0x15ea81,'user':_0xdd4e23,'stock':_0x434111,'unit':_0x184623,'language':_0x524d74,'warehouses':_0x34ccd,'rooms':_0x1526ce,'warehouse_QA':_0x163ce1});}catch(_0x538323){console[_0xe02bb2(0xe5)](_0x538323);}}),router[a0_0x3fca52(0x10f)](a0_0x3fca52(0x113),auth,async(_0x3d474c,_0xff403b)=>{var _0x418813=a0_0x3fca52;if(_0x3d474c[_0x418813(0x143)][_0x418813(0x152)]=='QA')try{const _0x155a3c=_0x3d474c['params']['id'],_0xfdc105=await sales_return['findOne']({'invoice':_0x3d474c['body'][_0x418813(0xee)]}),_0x2ce791=await warehouse[_0x418813(0x145)]({'name':_0xfdc105[_0x418813(0x13b)],'room':_0xfdc105[_0x418813(0x12d)]}),{invoice:_0x4d1281,customer:_0x132fbb,date:_0x1a4b64,warehouse_name:_0x3e4acc,product_name:_0x559372,primary_code:_0x2e6b7b,secondary_code:_0x7a02c3,product_code:_0x57c17f,sales_quantity:_0x32b87b,stocks:_0x591ae6,return_qty:_0x1067e6,note:_0xf7ef54,to_warehouse_name_QA:_0x44698c,to_Room_name_QA:_0x32f6c5}=_0x3d474c[_0x418813(0x143)];if(typeof product_name_QA=='string')var _0x267716=[_0x3d474c[_0x418813(0x143)][_0x418813(0xdc)]],_0x331189=[_0x3d474c[_0x418813(0x143)][_0x418813(0xe0)]],_0x34365c=[_0x3d474c['body']['secondary_code_QA']],_0x1aa5e9=[_0x3d474c[_0x418813(0x143)][_0x418813(0x11b)]],_0x45b1c4=[_0x3d474c[_0x418813(0x143)]['sales_quantity_QA']],_0x4c5de6=[_0x3d474c['body'][_0x418813(0x14d)]],_0x16e3ff=[_0x3d474c[_0x418813(0x143)]['return_qty_QA']];else var _0x267716=[..._0x3d474c[_0x418813(0x143)][_0x418813(0xdc)]],_0x331189=[..._0x3d474c['body']['primary_code_QA']],_0x34365c=[..._0x3d474c['body']['secondary_code_QA']],_0x1aa5e9=[..._0x3d474c['body'][_0x418813(0x11b)]],_0x45b1c4=[..._0x3d474c[_0x418813(0x143)][_0x418813(0x141)]],_0x4c5de6=[..._0x3d474c[_0x418813(0x143)]['stocks_QA']],_0x16e3ff=[..._0x3d474c[_0x418813(0x143)]['return_qty_QA']];const _0x36031e=_0x267716[_0x418813(0x122)](_0x248499=>{return _0x248499={'product_name':_0x248499};});_0x331189['forEach']((_0x26a258,_0x4c09c9)=>{_0x36031e[_0x4c09c9]['primary_code']=_0x26a258;}),_0x34365c['forEach']((_0x1e1e81,_0x511a2e)=>{_0x36031e[_0x511a2e]['secondary_code']=_0x1e1e81;}),_0x1aa5e9[_0x418813(0x107)]((_0x458ce9,_0x11ad1b)=>{var _0x3eacb1=_0x418813;_0x36031e[_0x11ad1b][_0x3eacb1(0x14c)]=_0x458ce9;}),_0x45b1c4[_0x418813(0x107)]((_0x273ce6,_0x220c57)=>{var _0x481517=_0x418813;_0x36031e[_0x220c57][_0x481517(0xf2)]=_0x273ce6;}),_0x4c5de6[_0x418813(0x107)]((_0x50ca3f,_0x59833b)=>{var _0x4ed4ed=_0x418813;_0x36031e[_0x59833b][_0x4ed4ed(0x114)]=_0x50ca3f;}),_0x16e3ff[_0x418813(0x107)]((_0x14f31a,_0x947141)=>{var _0x13b44f=_0x418813;_0x36031e[_0x947141][_0x13b44f(0x135)]=_0x14f31a;}),_0xfdc105[_0x418813(0x150)]['forEach'](_0x4194ba=>{var _0x3a5cc1=_0x418813;const _0x3efd40=_0x2ce791[_0x3a5cc1(0x13c)][_0x3a5cc1(0x122)](_0x17e872=>{var _0x47238a=_0x3a5cc1;_0x17e872[_0x47238a(0x12b)]==_0x4194ba[_0x47238a(0x12b)]&&(_0x17e872[_0x47238a(0xf5)]=parseInt(_0x17e872['product_stock'])+parseInt(_0x4194ba[_0x47238a(0x135)]));});}),await _0x2ce791[_0x418813(0x11c)](),_0xfdc105[_0x418813(0xee)]=_0x4d1281,_0xfdc105[_0x418813(0x10c)]=_0x132fbb,_0xfdc105[_0x418813(0x12a)]=_0x1a4b64,_0xfdc105['warehouse_name']=_0x3e4acc,_0xfdc105[_0x418813(0x150)]=_0x36031e,_0xfdc105[_0x418813(0x144)]=_0xf7ef54,_0xfdc105[_0x418813(0x13b)]=_0x44698c,_0xfdc105['ToRoom']=_0x32f6c5;const _0x3e259e=await _0xfdc105[_0x418813(0x11c)](),_0x549ad3=await c_payment_data[_0x418813(0x145)]({'invoice':_0x3d474c['body'][_0x418813(0xee)],'reason':_0x418813(0xe1)});_0x549ad3['suppliers']=_0x3d474c[_0x418813(0x143)][_0x418813(0x119)],_0x549ad3[_0x418813(0x12a)]=_0x3d474c[_0x418813(0x143)]['date'],await _0x549ad3['save'](),_0x3d474c[_0x418813(0x12e)]('success',_0x418813(0xf9)),_0xff403b[_0x418813(0x133)]('/sales_return_finished/view');}catch(_0x12e589){console[_0x418813(0xe5)](_0x12e589),_0xff403b[_0x418813(0x11f)](0xc8)[_0x418813(0xe4)]({'message':_0x12e589['message']});}else try{const _0x1f0be8=_0x3d474c[_0x418813(0xf6)]['id'];console[_0x418813(0xe5)](_0x1f0be8);const _0x2ffa8f=await sales_return[_0x418813(0x145)]({'invoice':_0x3d474c['body']['invoice']});console[_0x418813(0xe5)](_0x418813(0xfa),_0x2ffa8f);const _0x5678d5=await warehouse[_0x418813(0x145)]({'name':_0x2ffa8f['ToWarehouse'],'room':_0x2ffa8f[_0x418813(0x12d)]});console[_0x418813(0xe5)](_0x418813(0x121),_0x5678d5);const {invoice:_0x363318,customer:_0x2d50b6,date:_0xa0c187,warehouse_name:_0x31de16,product_name:_0x2931d2,primary_code:_0x4139ac,secondary_code:_0x2f4414,product_code:_0x1826e1,sales_quantity:_0x2bacec,stocks:_0x3be4fb,return_qty:_0x5c1c84,note:_0x124157,to_warehouse_name:_0x20e679,to_Room_name:_0x594471}=_0x3d474c['body'];console['log'](_0x3d474c[_0x418813(0x143)]);if(typeof _0x2931d2==_0x418813(0x139))var _0x267716=[_0x3d474c[_0x418813(0x143)][_0x418813(0x12b)]],_0x331189=[_0x3d474c[_0x418813(0x143)][_0x418813(0x10b)]],_0x34365c=[_0x3d474c[_0x418813(0x143)][_0x418813(0xfc)]],_0x1aa5e9=[_0x3d474c['body'][_0x418813(0x14c)]],_0x45b1c4=[_0x3d474c[_0x418813(0x143)]['sales_quantity']],_0x4c5de6=[_0x3d474c[_0x418813(0x143)][_0x418813(0x104)]],_0x16e3ff=[_0x3d474c[_0x418813(0x143)][_0x418813(0x135)]],_0x21048a=[_0x3d474c[_0x418813(0x143)]['bay']],_0x5c5c94=[_0x3d474c[_0x418813(0x143)][_0x418813(0xe2)]],_0x327df4=[_0x3d474c[_0x418813(0x143)][_0x418813(0x134)]],_0x5d17c3=[_0x3d474c[_0x418813(0x143)][_0x418813(0xef)]];else var _0x267716=[..._0x3d474c[_0x418813(0x143)][_0x418813(0x12b)]],_0x331189=[..._0x3d474c[_0x418813(0x143)][_0x418813(0x10b)]],_0x34365c=[..._0x3d474c['body'][_0x418813(0xfc)]],_0x1aa5e9=[..._0x3d474c['body']['product_code']],_0x45b1c4=[..._0x3d474c['body'][_0x418813(0x13e)]],_0x4c5de6=[..._0x3d474c['body'][_0x418813(0x104)]],_0x16e3ff=[..._0x3d474c[_0x418813(0x143)][_0x418813(0x135)]],_0x21048a=[..._0x3d474c[_0x418813(0x143)]['bay']],_0x5c5c94=[..._0x3d474c[_0x418813(0x143)][_0x418813(0xe2)]],_0x327df4=[..._0x3d474c[_0x418813(0x143)]['types']],_0x5d17c3=[..._0x3d474c['body']['floorlevel']];const _0x4bf308=_0x267716[_0x418813(0x122)](_0x33e724=>{return _0x33e724={'product_name':_0x33e724};});_0x331189[_0x418813(0x107)]((_0x1a1c60,_0x2143ec)=>{_0x4bf308[_0x2143ec]['primary_code']=_0x1a1c60;}),_0x34365c['forEach']((_0x2c1b70,_0x3f7a95)=>{var _0x3aa701=_0x418813;_0x4bf308[_0x3f7a95][_0x3aa701(0xfc)]=_0x2c1b70;}),_0x1aa5e9[_0x418813(0x107)]((_0xda7457,_0x49a798)=>{_0x4bf308[_0x49a798]['product_code']=_0xda7457;}),_0x45b1c4[_0x418813(0x107)]((_0x30503a,_0x10a308)=>{var _0x5ea79a=_0x418813;_0x4bf308[_0x10a308][_0x5ea79a(0xf2)]=_0x30503a;}),_0x4c5de6[_0x418813(0x107)]((_0x288cff,_0x2fb7b2)=>{_0x4bf308[_0x2fb7b2]['stock']=_0x288cff;}),_0x16e3ff[_0x418813(0x107)]((_0x44246f,_0x1a367f)=>{var _0x31f85b=_0x418813;_0x4bf308[_0x1a367f][_0x31f85b(0x135)]=_0x44246f;}),_0x21048a[_0x418813(0x107)]((_0x461b47,_0x2be0ce)=>{var _0x9c3878=_0x418813;_0x4bf308[_0x2be0ce][_0x9c3878(0x153)]=_0x461b47;}),_0x5c5c94[_0x418813(0x107)]((_0x561d4e,_0x451475)=>{var _0x3c882b=_0x418813;_0x4bf308[_0x451475][_0x3c882b(0xe2)]=_0x561d4e;}),_0x327df4[_0x418813(0x107)]((_0x34a594,_0x2e85c7)=>{var _0xb8dfc4=_0x418813;_0x4bf308[_0x2e85c7][_0xb8dfc4(0xea)]=_0x34a594;}),_0x5d17c3['forEach']((_0x50af22,_0x5db17b)=>{var _0x575e3f=_0x418813;_0x4bf308[_0x5db17b][_0x575e3f(0xef)]=_0x50af22;});var _0x5a0b26=0x0;_0x4bf308['forEach'](_0x5ca7a5=>{var _0x4afa6b=_0x418813;console[_0x4afa6b(0xe5)](_0x4afa6b(0xe6),_0x5ca7a5),(parseInt(_0x5ca7a5[_0x4afa6b(0xf2)])<parseInt(_0x5ca7a5['return_qty'])||parseInt(_0x5ca7a5[_0x4afa6b(0x114)])<parseInt(_0x5ca7a5[_0x4afa6b(0x135)])&&parseInt(_0x5ca7a5[_0x4afa6b(0xf2)])>parseInt(_0x5ca7a5[_0x4afa6b(0x135)])||parseInt(_0x5ca7a5[_0x4afa6b(0x135)])==0x0)&&_0x5a0b26++;});if(_0x5a0b26!=0x0)return _0x3d474c[_0x418813(0x12e)](_0x418813(0x140),_0x418813(0x14b)),_0xff403b[_0x418813(0x133)](_0x418813(0x126));_0x2ffa8f[_0x418813(0x10d)][_0x418813(0x107)](_0x177408=>{var _0x4826f1=_0x418813;const _0x34548f=_0x5678d5[_0x4826f1(0x13c)]['map'](_0x46c52d=>{var _0x19f88d=_0x4826f1;_0x46c52d[_0x19f88d(0x12b)]==_0x177408[_0x19f88d(0x12b)]&&_0x46c52d[_0x19f88d(0xef)]==_0x177408[_0x19f88d(0xef)]&&_0x46c52d[_0x19f88d(0xea)]==_0x177408['type']&&_0x46c52d[_0x19f88d(0xe2)]==_0x177408[_0x19f88d(0xe2)]&&_0x46c52d[_0x19f88d(0x153)]==_0x177408[_0x19f88d(0x153)]&&(_0x46c52d[_0x19f88d(0xf5)]=parseInt(_0x46c52d[_0x19f88d(0xf5)])+parseInt(_0x177408[_0x19f88d(0x135)]));});}),console[_0x418813(0xe5)](_0x418813(0x121),_0x5678d5),await _0x5678d5[_0x418813(0x11c)](),_0x2ffa8f[_0x418813(0xee)]=_0x363318,_0x2ffa8f[_0x418813(0x10c)]=_0x2d50b6,_0x2ffa8f[_0x418813(0x12a)]=_0xa0c187,_0x2ffa8f[_0x418813(0x106)]=_0x31de16,_0x2ffa8f['return_sale']=_0x4bf308,_0x2ffa8f['note']=_0x124157,_0x2ffa8f[_0x418813(0x13b)]=_0x20e679,_0x2ffa8f[_0x418813(0x12d)]=_0x594471;const _0x3bbd0d=await _0x2ffa8f[_0x418813(0x11c)]();console['log']('new\x20new_data',_0x3bbd0d);const _0x4ed995=await c_payment_data[_0x418813(0x145)]({'invoice':_0x3d474c[_0x418813(0x143)]['invoice'],'reason':_0x418813(0xe1)});_0x4ed995['suppliers']=_0x3d474c[_0x418813(0x143)][_0x418813(0x119)],_0x4ed995[_0x418813(0x12a)]=_0x3d474c[_0x418813(0x143)][_0x418813(0x12a)],await _0x4ed995['save'](),_0x3d474c[_0x418813(0x12e)](_0x418813(0x142),_0x418813(0xf9)),_0xff403b['redirect'](_0x418813(0xff));}catch(_0x433bf2){console[_0x418813(0xe5)](_0x433bf2),_0xff403b[_0x418813(0x11f)](0xc8)[_0x418813(0xe4)]({'message':_0x433bf2[_0x418813(0xfb)]});}}),router['post']('/give_payment/:id',auth,async(_0x568baf,_0x5a284d)=>{var _0x446cfd=a0_0x3fca52;try{const _0x2e620c=_0x568baf[_0x446cfd(0xf6)]['id'],{invoice:_0x3835fa,customer:_0x1cc5de,payable_to_customer:_0x56224c,paid_amount:_0x3f56ec}=_0x568baf[_0x446cfd(0x143)],_0x408749=await sales_return['findById'](_0x2e620c);console['log']('data',_0x408749),console[_0x446cfd(0xe5)](_0x56224c),console['log'](_0x3f56ec);var _0x3cd195=_0x56224c-_0x3f56ec;console[_0x446cfd(0xe5)]('subtract',_0x3cd195),_0x408749['paid_amount']=parseFloat(_0x3f56ec)+parseFloat(_0x408749[_0x446cfd(0x103)]),_0x408749[_0x446cfd(0x14f)]=_0x3cd195,console['log'](_0x408749);const _0xbde82d=await _0x408749[_0x446cfd(0x11c)]();console[_0x446cfd(0xe5)](0x1b207);const _0x3f29ce=await c_payment_data['findOne']({'invoice':_0x568baf[_0x446cfd(0x143)][_0x446cfd(0xee)],'reason':_0x446cfd(0xe1)});console['log'](_0x446cfd(0x112),_0x3f29ce),_0x3f29ce['amount']=_0x3cd195,await _0x3f29ce['save']();let _0x30d4f4=new Date(),_0x455001=('0'+_0x30d4f4[_0x446cfd(0x151)]())[_0x446cfd(0xec)](-0x2),_0x96e2e7=('0'+(_0x30d4f4[_0x446cfd(0x148)]()+0x1))[_0x446cfd(0xec)](-0x2),_0x223047=_0x30d4f4['getFullYear'](),_0x2e4b09=_0x223047+'-'+_0x96e2e7+'-'+_0x455001;const _0x185cdc=new customer_payment({'invoice':_0x3835fa,'date':_0x223047+'-'+_0x96e2e7+'-'+_0x455001,'customer':_0x1cc5de,'reason':_0x446cfd(0x111),'amount':_0x3f56ec}),_0x3e3d9e=await _0x185cdc[_0x446cfd(0x11c)]();_0x568baf[_0x446cfd(0x12e)]('success','payment\x20successfull'),_0x5a284d[_0x446cfd(0x133)](_0x446cfd(0xff));}catch(_0xfdaadc){console[_0x446cfd(0xe5)](_0xfdaadc);}}),router[a0_0x3fca52(0x14e)]('/invoice/:id',auth,async(_0x2a4d00,_0x2a291a)=>{var _0x2c85c9=a0_0x3fca52;try{const {username:_0xfe2ec0,email:_0x52884f,role:_0x509d27}=_0x2a4d00[_0x2c85c9(0x13d)],_0x18087c=_0x2a4d00[_0x2c85c9(0x13d)],_0x446c33=await profile[_0x2c85c9(0x145)]({'email':_0x18087c['email']}),_0x34f4ca=await master_shop[_0x2c85c9(0x147)]();console[_0x2c85c9(0xe5)](_0x2c85c9(0x117),_0x34f4ca);const _0x685b35=_0x2a4d00[_0x2c85c9(0xf6)]['id'],_0x3d3e27=await sales_return[_0x2c85c9(0x11e)](_0x685b35);console[_0x2c85c9(0xe5)](_0x3d3e27);const _0x526bd0=await customer[_0x2c85c9(0x145)]({'name':_0x3d3e27['customer']});console[_0x2c85c9(0xe5)](_0x526bd0);if(_0x34f4ca[0x0][_0x2c85c9(0xe9)]==_0x2c85c9(0x12c)){var _0x54bc97=users[_0x2c85c9(0x131)];console['log'](_0x54bc97);}else{if(_0x34f4ca[0x0][_0x2c85c9(0xe9)]=='Hindi')var _0x54bc97=users[_0x2c85c9(0x10e)];else{if(_0x34f4ca[0x0][_0x2c85c9(0xe9)]==_0x2c85c9(0x127))var _0x54bc97=users[_0x2c85c9(0x127)];else{if(_0x34f4ca[0x0][_0x2c85c9(0xe9)]==_0x2c85c9(0xf7))var _0x54bc97=users[_0x2c85c9(0xf7)];else{if(_0x34f4ca[0x0]['language']==_0x2c85c9(0x100))var _0x54bc97=users['French'];else{if(_0x34f4ca[0x0]['language']==_0x2c85c9(0x130))var _0x54bc97=users[_0x2c85c9(0x128)];else{if(_0x34f4ca[0x0][_0x2c85c9(0xe9)]==_0x2c85c9(0xe3))var _0x54bc97=users[_0x2c85c9(0xe3)];else{if(_0x34f4ca[0x0]['language']=='Arabic\x20(ae)')var _0x54bc97=users[_0x2c85c9(0xed)];}}}}}}}_0x2a291a['render'](_0x2c85c9(0x12f),{'success':_0x2a4d00[_0x2c85c9(0x12e)]('success'),'errors':_0x2a4d00[_0x2c85c9(0x12e)]('errors'),'role':_0x18087c,'profile':_0x446c33,'master_shop':_0x34f4ca,'customers':_0x526bd0,'sales':_0x3d3e27,'language':_0x54bc97});}catch(_0x4b0fdc){console['log'](_0x4b0fdc);}}),module[a0_0x3fca52(0xdd)]=router;