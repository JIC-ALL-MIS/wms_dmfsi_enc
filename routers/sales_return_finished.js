var a0_0x465e5a=a0_0x2e20;(function(_0x5a19fe,_0x398f3b){var _0x1fbd5c=a0_0x2e20,_0x1f754c=_0x5a19fe();while(!![]){try{var _0x3ed35f=parseInt(_0x1fbd5c(0x173))/0x1+-parseInt(_0x1fbd5c(0x153))/0x2+parseInt(_0x1fbd5c(0x164))/0x3*(-parseInt(_0x1fbd5c(0x190))/0x4)+parseInt(_0x1fbd5c(0x1b5))/0x5*(-parseInt(_0x1fbd5c(0x156))/0x6)+-parseInt(_0x1fbd5c(0x183))/0x7*(-parseInt(_0x1fbd5c(0x1ad))/0x8)+-parseInt(_0x1fbd5c(0x15c))/0x9+parseInt(_0x1fbd5c(0x184))/0xa;if(_0x3ed35f===_0x398f3b)break;else _0x1f754c['push'](_0x1f754c['shift']());}catch(_0x3ec633){_0x1f754c['push'](_0x1f754c['shift']());}}}(a0_0xbabc,0xc0b39));const express=require('express'),app=express(),router=express[a0_0x465e5a(0x195)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require(a0_0x465e5a(0x194)),users=require(a0_0x465e5a(0x17c));function a0_0x2e20(_0x214c2f,_0x2249d5){var _0xbabcf6=a0_0xbabc();return a0_0x2e20=function(_0x2e20a2,_0x32c951){_0x2e20a2=_0x2e20a2-0x14c;var _0x499c85=_0xbabcf6[_0x2e20a2];return _0x499c85;},a0_0x2e20(_0x214c2f,_0x2249d5);}function a0_0xbabc(){var _0x5af354=['secondary_code','getMonth','note','Sale\x20Return','body','$product_details.secondary_code','Returned\x20Payment\x20For\x20Sale\x20Return','get','4wIXBCY','success','floorlevel','$product_details.floorlevel','../middleware/auth','Router','customer','warehouse_name','amount','payment\x20successfull','old_data','Spanish','sales_return_finished','post','customer_docs','sales_return_invoice','Hindi','errors','old_warehouse_data','bay','message','purchase\x20return\x20successfully','subtract','sales_quantity_QA','name','French','type','master','foreach\x20newproduct','32QIcvIl','return_sale_edit_finished','stocks','getFullYear','aggregate','English','Chinese','product_name','12500GuTrIP','ToWarehouse','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','email','secondary_code_QA','primary_code_QA','$product_details.product_name','slice','suppliers','/sales_return/view','render','flash','return_qty_QA','$product_details.bin','$product_details.product_code','back','due_amount','findById','Return\x20Rooms','/view/:id','681740diYjxU','types','user','3186GSrslm','Arabic','log','German','for_categorize','find','164088TFPoRO','language','$customer_docs','new\x20new_data','ToRoom','redirect','stock','map','975678qdLYnX','Arabic\x20(ae)','sales_quantity','string','Finished\x20Goods','json','return_sale','return_sale_QA','English\x20(US)','/view','exports','Portuguese\x20(BR)','c_payment','/invoice/:id','product_name_QA','74417arhrzG','forEach','invoice','Enabled','date','$product_details._id','$name','product_stock','primary_code','../public/language/languages.json','product_code','product_details','return_qty','stocks_QA','sale_qty','findOne','407519UvHzpf','24938480yvjcyr','save','bin','params'];a0_0xbabc=function(){return _0x5af354;};return a0_0xbabc();}router[a0_0x465e5a(0x18f)](a0_0x465e5a(0x16d),auth,async(_0x100a9a,_0x4c8b62)=>{var _0x233412=a0_0x465e5a;try{const {username:_0x25ac4d,email:_0x58bf3d,role:_0x11c5f9}=_0x100a9a[_0x233412(0x155)],_0x4df0a9=_0x100a9a['user'],_0x355e32=await profile[_0x233412(0x182)]({'email':_0x4df0a9[_0x233412(0x1b8)]}),_0x577b72=await master_shop[_0x233412(0x15b)](),_0x265a5e=await sales_return_finished[_0x233412(0x1b1)]([{'$lookup':{'from':'customers','localField':_0x233412(0x196),'foreignField':_0x233412(0x1a8),'as':_0x233412(0x19e)}},{'$unwind':_0x233412(0x15e)}]);if(_0x577b72[0x0][_0x233412(0x15d)]==_0x233412(0x16c)){var _0x3cbc65=users[_0x233412(0x1b2)];console[_0x233412(0x158)](_0x3cbc65);}else{if(_0x577b72[0x0][_0x233412(0x15d)]=='Hindi')var _0x3cbc65=users[_0x233412(0x1a0)];else{if(_0x577b72[0x0][_0x233412(0x15d)]=='German')var _0x3cbc65=users['German'];else{if(_0x577b72[0x0][_0x233412(0x15d)]==_0x233412(0x19b))var _0x3cbc65=users[_0x233412(0x19b)];else{if(_0x577b72[0x0][_0x233412(0x15d)]=='French')var _0x3cbc65=users[_0x233412(0x1a9)];else{if(_0x577b72[0x0][_0x233412(0x15d)]==_0x233412(0x16f))var _0x3cbc65=users['Portuguese'];else{if(_0x577b72[0x0][_0x233412(0x15d)]==_0x233412(0x1b3))var _0x3cbc65=users[_0x233412(0x1b3)];else{if(_0x577b72[0x0][_0x233412(0x15d)]==_0x233412(0x165))var _0x3cbc65=users[_0x233412(0x157)];}}}}}}}_0x4c8b62[_0x233412(0x1bf)](_0x233412(0x19c),{'success':_0x100a9a[_0x233412(0x1c0)]('success'),'errors':_0x100a9a[_0x233412(0x1c0)]('errors'),'role':_0x4df0a9,'profile':_0x355e32,'master_shop':_0x577b72,'user':_0x265a5e,'language':_0x3cbc65});}catch(_0x5bcc41){console[_0x233412(0x158)](_0x5bcc41);}}),router[a0_0x465e5a(0x18f)](a0_0x465e5a(0x152),auth,async(_0x26d5b7,_0x35cc78)=>{var _0x5967c5=a0_0x465e5a;try{const {username:_0x1d73d2,email:_0x5ca35d,role:_0x4931fc}=_0x26d5b7['user'],_0x1cdc15=_0x26d5b7[_0x5967c5(0x155)],_0x32c148=await profile[_0x5967c5(0x182)]({'email':_0x1cdc15[_0x5967c5(0x1b8)]}),_0x4fdc3a=await master_shop['find']();console[_0x5967c5(0x158)](_0x5967c5(0x1ab),_0x4fdc3a);const _0x18feef=_0x26d5b7['params']['id'];console[_0x5967c5(0x158)](_0x18feef);var _0x5cfb41=[_0x5967c5(0x151)];const _0x3624da=await sales_return_finished[_0x5967c5(0x150)](_0x18feef),_0x5a8d14=await warehouse[_0x5967c5(0x1b1)]([{'$match':{'name':_0x3624da['ToWarehouse'],'room':_0x3624da['ToRoom']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5967c5(0x178),'name':{'$first':_0x5967c5(0x1bb)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x5967c5(0x14c)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5967c5(0x193)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5967c5(0x18d)},'product_code':{'$first':_0x5967c5(0x14d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]);console[_0x5967c5(0x158)](_0x5a8d14);const _0x23fe04=await warehouse[_0x5967c5(0x1b1)]([{'$match':{'status':_0x5967c5(0x176),'warehouse_category':_0x5967c5(0x168)}},{'$group':{'_id':'$name','name':{'$first':_0x5967c5(0x179)}}},{'$sort':{'name':0x1}}]),_0xf576aa=await warehouse['aggregate']([{'$match':{'status':_0x5967c5(0x176),'name':'QA\x20Warehouse'}},{'$group':{'_id':'$name','name':{'$first':_0x5967c5(0x179)}}},{'$sort':{'name':0x1}}]),_0x5dfeaa=await product[_0x5967c5(0x15b)]({});if(_0x4fdc3a[0x0][_0x5967c5(0x15d)]==_0x5967c5(0x16c)){var _0x4e6231=users[_0x5967c5(0x1b2)];console['log'](_0x4e6231);}else{if(_0x4fdc3a[0x0]['language']==_0x5967c5(0x1a0))var _0x4e6231=users[_0x5967c5(0x1a0)];else{if(_0x4fdc3a[0x0][_0x5967c5(0x15d)]=='German')var _0x4e6231=users['German'];else{if(_0x4fdc3a[0x0]['language']=='Spanish')var _0x4e6231=users[_0x5967c5(0x19b)];else{if(_0x4fdc3a[0x0][_0x5967c5(0x15d)]==_0x5967c5(0x1a9))var _0x4e6231=users[_0x5967c5(0x1a9)];else{if(_0x4fdc3a[0x0][_0x5967c5(0x15d)]==_0x5967c5(0x16f))var _0x4e6231=users['Portuguese'];else{if(_0x4fdc3a[0x0][_0x5967c5(0x15d)]=='Chinese')var _0x4e6231=users['Chinese'];else{if(_0x4fdc3a[0x0][_0x5967c5(0x15d)]==_0x5967c5(0x165))var _0x4e6231=users[_0x5967c5(0x157)];}}}}}}}_0x35cc78[_0x5967c5(0x1bf)](_0x5967c5(0x1ae),{'success':_0x26d5b7[_0x5967c5(0x1c0)](_0x5967c5(0x191)),'errors':_0x26d5b7[_0x5967c5(0x1c0)]('errors'),'role':_0x1cdc15,'profile':_0x32c148,'master_shop':_0x4fdc3a,'user':_0x3624da,'stock':_0x5a8d14,'unit':_0x5dfeaa,'language':_0x4e6231,'warehouses':_0x23fe04,'rooms':_0x5cfb41,'warehouse_QA':_0xf576aa});}catch(_0x5c5284){console[_0x5967c5(0x158)](_0x5c5284);}}),router[a0_0x465e5a(0x19d)](a0_0x465e5a(0x152),auth,async(_0x1340a7,_0x31c6aa)=>{var _0x182719=a0_0x465e5a;if(_0x1340a7[_0x182719(0x18c)][_0x182719(0x15a)]=='QA')try{const _0x3f18c4=_0x1340a7[_0x182719(0x187)]['id'],_0x39cb65=await sales_return[_0x182719(0x182)]({'invoice':_0x1340a7[_0x182719(0x18c)]['invoice']}),_0x44deec=await warehouse[_0x182719(0x182)]({'name':_0x39cb65[_0x182719(0x1b6)],'room':_0x39cb65[_0x182719(0x160)]}),{invoice:_0x67382a,customer:_0x1efce5,date:_0x49292c,warehouse_name:_0x332563,product_name:_0x5a5f32,primary_code:_0x1496b0,secondary_code:_0x19404d,product_code:_0x109847,sales_quantity:_0x472b17,stocks:_0xbfc16e,return_qty:_0x10e444,note:_0x515aca,to_warehouse_name_QA:_0x44a6ec,to_Room_name_QA:_0x40ea98}=_0x1340a7[_0x182719(0x18c)];if(typeof product_name_QA==_0x182719(0x167))var _0x1351af=[_0x1340a7[_0x182719(0x18c)]['product_name_QA']],_0x520cc9=[_0x1340a7['body'][_0x182719(0x1ba)]],_0x23e80a=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x1b9)]],_0x2938b5=[_0x1340a7[_0x182719(0x18c)]['product_code_QA']],_0x3640eb=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x1a7)]],_0x1a1e6d=[_0x1340a7[_0x182719(0x18c)]['stocks_QA']],_0x193f8a=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x1c1)]];else var _0x1351af=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x172)]],_0x520cc9=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x1ba)]],_0x23e80a=[..._0x1340a7['body'][_0x182719(0x1b9)]],_0x2938b5=[..._0x1340a7['body']['product_code_QA']],_0x3640eb=[..._0x1340a7['body'][_0x182719(0x1a7)]],_0x1a1e6d=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x180)]],_0x193f8a=[..._0x1340a7['body'][_0x182719(0x1c1)]];const _0x346d81=_0x1351af[_0x182719(0x163)](_0x30ef12=>{return _0x30ef12={'product_name':_0x30ef12};});_0x520cc9[_0x182719(0x174)]((_0x679b8b,_0x5b3d66)=>{var _0x2d0133=_0x182719;_0x346d81[_0x5b3d66][_0x2d0133(0x17b)]=_0x679b8b;}),_0x23e80a[_0x182719(0x174)]((_0x403b6e,_0xe8009)=>{var _0x58be68=_0x182719;_0x346d81[_0xe8009][_0x58be68(0x188)]=_0x403b6e;}),_0x2938b5[_0x182719(0x174)]((_0x4f98c7,_0x2ecabf)=>{_0x346d81[_0x2ecabf]['product_code']=_0x4f98c7;}),_0x3640eb[_0x182719(0x174)]((_0x399236,_0x55c377)=>{var _0x1000e7=_0x182719;_0x346d81[_0x55c377][_0x1000e7(0x181)]=_0x399236;}),_0x1a1e6d['forEach']((_0x1673f1,_0x39434d)=>{var _0x13882a=_0x182719;_0x346d81[_0x39434d][_0x13882a(0x162)]=_0x1673f1;}),_0x193f8a[_0x182719(0x174)]((_0xe48e8a,_0x163366)=>{var _0x36504f=_0x182719;_0x346d81[_0x163366][_0x36504f(0x17f)]=_0xe48e8a;}),_0x39cb65[_0x182719(0x16b)][_0x182719(0x174)](_0x5ba9c2=>{var _0x170f7f=_0x182719;const _0x4aa1be=_0x44deec[_0x170f7f(0x17e)][_0x170f7f(0x163)](_0x1f06ae=>{var _0x3cf8cd=_0x170f7f;_0x1f06ae[_0x3cf8cd(0x1b4)]==_0x5ba9c2['product_name']&&(_0x1f06ae['product_stock']=parseInt(_0x1f06ae[_0x3cf8cd(0x17a)])+parseInt(_0x5ba9c2[_0x3cf8cd(0x17f)]));});}),await _0x44deec[_0x182719(0x185)](),_0x39cb65[_0x182719(0x175)]=_0x67382a,_0x39cb65[_0x182719(0x196)]=_0x1efce5,_0x39cb65['date']=_0x49292c,_0x39cb65[_0x182719(0x197)]=_0x332563,_0x39cb65[_0x182719(0x16b)]=_0x346d81,_0x39cb65[_0x182719(0x18a)]=_0x515aca,_0x39cb65[_0x182719(0x1b6)]=_0x44a6ec,_0x39cb65['ToRoom']=_0x40ea98;const _0x2a9e86=await _0x39cb65[_0x182719(0x185)](),_0xa3b7d9=await c_payment_data[_0x182719(0x182)]({'invoice':_0x1340a7[_0x182719(0x18c)]['invoice'],'reason':_0x182719(0x18b)});_0xa3b7d9[_0x182719(0x1bd)]=_0x1340a7[_0x182719(0x18c)][_0x182719(0x1bd)],_0xa3b7d9[_0x182719(0x177)]=_0x1340a7['body'][_0x182719(0x177)],await _0xa3b7d9[_0x182719(0x185)](),_0x1340a7[_0x182719(0x1c0)](_0x182719(0x191),'purchase\x20return\x20successfully'),_0x31c6aa[_0x182719(0x161)]('/sales_return_finished/view');}catch(_0x473b36){console[_0x182719(0x158)](_0x473b36),_0x31c6aa['status'](0xc8)['json']({'message':_0x473b36['message']});}else try{const _0x144678=_0x1340a7[_0x182719(0x187)]['id'];console['log'](_0x144678);const _0x573629=await sales_return[_0x182719(0x182)]({'invoice':_0x1340a7[_0x182719(0x18c)][_0x182719(0x175)]});console[_0x182719(0x158)](_0x182719(0x19a),_0x573629);const _0x554493=await warehouse['findOne']({'name':_0x573629['ToWarehouse'],'room':_0x573629[_0x182719(0x160)]});console['log'](_0x182719(0x1a2),_0x554493);const {invoice:_0x4a72d3,customer:_0x564d7d,date:_0x2874c9,warehouse_name:_0x48785e,product_name:_0x4d0776,primary_code:_0x42df83,secondary_code:_0x4a2521,product_code:_0x12eff4,sales_quantity:_0x5c0efe,stocks:_0x243962,return_qty:_0x59845f,note:_0x22fe50,to_warehouse_name:_0x3dd89b,to_Room_name:_0x56d5d2}=_0x1340a7[_0x182719(0x18c)];console[_0x182719(0x158)](_0x1340a7[_0x182719(0x18c)]);if(typeof _0x4d0776=='string')var _0x1351af=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x1b4)]],_0x520cc9=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x17b)]],_0x23e80a=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x188)]],_0x2938b5=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x17d)]],_0x3640eb=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x166)]],_0x1a1e6d=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x1af)]],_0x193f8a=[_0x1340a7[_0x182719(0x18c)]['return_qty']],_0x3fbf8c=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x1a3)]],_0x3f42ce=[_0x1340a7[_0x182719(0x18c)]['bin']],_0x3cd29d=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x154)]],_0xaafbd=[_0x1340a7[_0x182719(0x18c)][_0x182719(0x192)]];else var _0x1351af=[..._0x1340a7[_0x182719(0x18c)]['product_name']],_0x520cc9=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x17b)]],_0x23e80a=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x188)]],_0x2938b5=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x17d)]],_0x3640eb=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x166)]],_0x1a1e6d=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x1af)]],_0x193f8a=[..._0x1340a7['body'][_0x182719(0x17f)]],_0x3fbf8c=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x1a3)]],_0x3f42ce=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x186)]],_0x3cd29d=[..._0x1340a7[_0x182719(0x18c)][_0x182719(0x154)]],_0xaafbd=[..._0x1340a7['body'][_0x182719(0x192)]];const _0xed555d=_0x1351af[_0x182719(0x163)](_0x25e7a5=>{return _0x25e7a5={'product_name':_0x25e7a5};});_0x520cc9[_0x182719(0x174)]((_0x259e02,_0x1f8076)=>{_0xed555d[_0x1f8076]['primary_code']=_0x259e02;}),_0x23e80a[_0x182719(0x174)]((_0x27eede,_0x1160f9)=>{var _0x192cfe=_0x182719;_0xed555d[_0x1160f9][_0x192cfe(0x188)]=_0x27eede;}),_0x2938b5['forEach']((_0xf28d65,_0xdf483c)=>{var _0x1de912=_0x182719;_0xed555d[_0xdf483c][_0x1de912(0x17d)]=_0xf28d65;}),_0x3640eb['forEach']((_0x59ba9d,_0x42f4e3)=>{var _0x3e9fe7=_0x182719;_0xed555d[_0x42f4e3][_0x3e9fe7(0x181)]=_0x59ba9d;}),_0x1a1e6d[_0x182719(0x174)]((_0x25d5e6,_0x315e2f)=>{var _0x67c1e=_0x182719;_0xed555d[_0x315e2f][_0x67c1e(0x162)]=_0x25d5e6;}),_0x193f8a['forEach']((_0x587508,_0x103f00)=>{var _0x52b87b=_0x182719;_0xed555d[_0x103f00][_0x52b87b(0x17f)]=_0x587508;}),_0x3fbf8c[_0x182719(0x174)]((_0x42fe6c,_0x4a4cf2)=>{_0xed555d[_0x4a4cf2]['bay']=_0x42fe6c;}),_0x3f42ce['forEach']((_0x4eec6b,_0x49da18)=>{_0xed555d[_0x49da18]['bin']=_0x4eec6b;}),_0x3cd29d['forEach']((_0x4b39eb,_0x1a73ad)=>{var _0x5e618f=_0x182719;_0xed555d[_0x1a73ad][_0x5e618f(0x1aa)]=_0x4b39eb;}),_0xaafbd[_0x182719(0x174)]((_0x5dab77,_0x5aed41)=>{_0xed555d[_0x5aed41]['floorlevel']=_0x5dab77;});var _0x1e1406=0x0;_0xed555d[_0x182719(0x174)](_0x3da26d=>{var _0x4df770=_0x182719;console[_0x4df770(0x158)](_0x4df770(0x1ac),_0x3da26d),(parseInt(_0x3da26d[_0x4df770(0x181)])<parseInt(_0x3da26d[_0x4df770(0x17f)])||parseInt(_0x3da26d[_0x4df770(0x162)])<parseInt(_0x3da26d['return_qty'])&&parseInt(_0x3da26d[_0x4df770(0x181)])>parseInt(_0x3da26d[_0x4df770(0x17f)])||parseInt(_0x3da26d['return_qty'])==0x0)&&_0x1e1406++;});if(_0x1e1406!=0x0)return _0x1340a7[_0x182719(0x1c0)](_0x182719(0x1a1),_0x182719(0x1b7)),_0x31c6aa[_0x182719(0x161)](_0x182719(0x14e));_0x573629['return_sale'][_0x182719(0x174)](_0x1fa1af=>{var _0x500170=_0x182719;const _0x1ca08c=_0x554493['product_details'][_0x500170(0x163)](_0x226b74=>{var _0x3c565a=_0x500170;_0x226b74[_0x3c565a(0x1b4)]==_0x1fa1af[_0x3c565a(0x1b4)]&&_0x226b74[_0x3c565a(0x192)]==_0x1fa1af['floorlevel']&&_0x226b74['type']==_0x1fa1af[_0x3c565a(0x1aa)]&&_0x226b74[_0x3c565a(0x186)]==_0x1fa1af['bin']&&_0x226b74[_0x3c565a(0x1a3)]==_0x1fa1af['bay']&&(_0x226b74[_0x3c565a(0x17a)]=parseInt(_0x226b74['product_stock'])+parseInt(_0x1fa1af['return_qty']));});}),console['log'](_0x182719(0x1a2),_0x554493),await _0x554493[_0x182719(0x185)](),_0x573629[_0x182719(0x175)]=_0x4a72d3,_0x573629[_0x182719(0x196)]=_0x564d7d,_0x573629[_0x182719(0x177)]=_0x2874c9,_0x573629[_0x182719(0x197)]=_0x48785e,_0x573629[_0x182719(0x16a)]=_0xed555d,_0x573629['note']=_0x22fe50,_0x573629[_0x182719(0x1b6)]=_0x3dd89b,_0x573629[_0x182719(0x160)]=_0x56d5d2;const _0x503a38=await _0x573629['save']();console[_0x182719(0x158)](_0x182719(0x15f),_0x503a38);const _0x40e14d=await c_payment_data[_0x182719(0x182)]({'invoice':_0x1340a7[_0x182719(0x18c)]['invoice'],'reason':_0x182719(0x18b)});_0x40e14d[_0x182719(0x1bd)]=_0x1340a7['body'][_0x182719(0x1bd)],_0x40e14d[_0x182719(0x177)]=_0x1340a7[_0x182719(0x18c)][_0x182719(0x177)],await _0x40e14d[_0x182719(0x185)](),_0x1340a7[_0x182719(0x1c0)]('success',_0x182719(0x1a5)),_0x31c6aa[_0x182719(0x161)](_0x182719(0x1be));}catch(_0x33a59a){console[_0x182719(0x158)](_0x33a59a),_0x31c6aa['status'](0xc8)[_0x182719(0x169)]({'message':_0x33a59a[_0x182719(0x1a4)]});}}),router[a0_0x465e5a(0x19d)]('/give_payment/:id',auth,async(_0x5cdffd,_0xf39117)=>{var _0x47f9ae=a0_0x465e5a;try{const _0x2db967=_0x5cdffd[_0x47f9ae(0x187)]['id'],{invoice:_0x2db204,customer:_0x14f23b,payable_to_customer:_0x3bc25f,paid_amount:_0x57d1ca}=_0x5cdffd[_0x47f9ae(0x18c)],_0x278ff4=await sales_return[_0x47f9ae(0x150)](_0x2db967);console[_0x47f9ae(0x158)]('data',_0x278ff4),console[_0x47f9ae(0x158)](_0x3bc25f),console[_0x47f9ae(0x158)](_0x57d1ca);var _0x19b6b1=_0x3bc25f-_0x57d1ca;console['log'](_0x47f9ae(0x1a6),_0x19b6b1),_0x278ff4['paid_amount']=parseFloat(_0x57d1ca)+parseFloat(_0x278ff4['paid_amount']),_0x278ff4[_0x47f9ae(0x14f)]=_0x19b6b1,console[_0x47f9ae(0x158)](_0x278ff4);const _0x13a491=await _0x278ff4['save']();console['log'](0x1b207);const _0x3c9c7d=await c_payment_data[_0x47f9ae(0x182)]({'invoice':_0x5cdffd[_0x47f9ae(0x18c)][_0x47f9ae(0x175)],'reason':_0x47f9ae(0x18b)});console[_0x47f9ae(0x158)](_0x47f9ae(0x170),_0x3c9c7d),_0x3c9c7d[_0x47f9ae(0x198)]=_0x19b6b1,await _0x3c9c7d[_0x47f9ae(0x185)]();let _0x32dcf4=new Date(),_0x5bed9a=('0'+_0x32dcf4['getDate']())['slice'](-0x2),_0x50a2df=('0'+(_0x32dcf4[_0x47f9ae(0x189)]()+0x1))[_0x47f9ae(0x1bc)](-0x2),_0xcd62c7=_0x32dcf4[_0x47f9ae(0x1b0)](),_0x4df891=_0xcd62c7+'-'+_0x50a2df+'-'+_0x5bed9a;const _0x1571a1=new customer_payment({'invoice':_0x2db204,'date':_0xcd62c7+'-'+_0x50a2df+'-'+_0x5bed9a,'customer':_0x14f23b,'reason':_0x47f9ae(0x18e),'amount':_0x57d1ca}),_0x54ae4e=await _0x1571a1[_0x47f9ae(0x185)]();_0x5cdffd[_0x47f9ae(0x1c0)](_0x47f9ae(0x191),_0x47f9ae(0x199)),_0xf39117[_0x47f9ae(0x161)]('/sales_return/view');}catch(_0x582670){console['log'](_0x582670);}}),router[a0_0x465e5a(0x18f)](a0_0x465e5a(0x171),auth,async(_0x199097,_0xc7486e)=>{var _0x11c39f=a0_0x465e5a;try{const {username:_0x545bd4,email:_0x13304d,role:_0x467ca9}=_0x199097[_0x11c39f(0x155)],_0x1c20d5=_0x199097[_0x11c39f(0x155)],_0x347c41=await profile[_0x11c39f(0x182)]({'email':_0x1c20d5[_0x11c39f(0x1b8)]}),_0x4b890b=await master_shop['find']();console['log']('master',_0x4b890b);const _0x2ce7d3=_0x199097[_0x11c39f(0x187)]['id'],_0x25ecbe=await sales_return[_0x11c39f(0x150)](_0x2ce7d3);console[_0x11c39f(0x158)](_0x25ecbe);const _0x367b9d=await customer['findOne']({'name':_0x25ecbe[_0x11c39f(0x196)]});console[_0x11c39f(0x158)](_0x367b9d);if(_0x4b890b[0x0][_0x11c39f(0x15d)]==_0x11c39f(0x16c)){var _0xb9889d=users[_0x11c39f(0x1b2)];console[_0x11c39f(0x158)](_0xb9889d);}else{if(_0x4b890b[0x0][_0x11c39f(0x15d)]==_0x11c39f(0x1a0))var _0xb9889d=users[_0x11c39f(0x1a0)];else{if(_0x4b890b[0x0]['language']==_0x11c39f(0x159))var _0xb9889d=users['German'];else{if(_0x4b890b[0x0][_0x11c39f(0x15d)]=='Spanish')var _0xb9889d=users[_0x11c39f(0x19b)];else{if(_0x4b890b[0x0][_0x11c39f(0x15d)]==_0x11c39f(0x1a9))var _0xb9889d=users['French'];else{if(_0x4b890b[0x0][_0x11c39f(0x15d)]=='Portuguese\x20(BR)')var _0xb9889d=users['Portuguese'];else{if(_0x4b890b[0x0][_0x11c39f(0x15d)]=='Chinese')var _0xb9889d=users[_0x11c39f(0x1b3)];else{if(_0x4b890b[0x0][_0x11c39f(0x15d)]=='Arabic\x20(ae)')var _0xb9889d=users[_0x11c39f(0x157)];}}}}}}}_0xc7486e[_0x11c39f(0x1bf)](_0x11c39f(0x19f),{'success':_0x199097[_0x11c39f(0x1c0)](_0x11c39f(0x191)),'errors':_0x199097[_0x11c39f(0x1c0)]('errors'),'role':_0x1c20d5,'profile':_0x347c41,'master_shop':_0x4b890b,'customers':_0x367b9d,'sales':_0x25ecbe,'language':_0xb9889d});}catch(_0x3ec5ad){console['log'](_0x3ec5ad);}}),module[a0_0x465e5a(0x16e)]=router;