var a0_0x3f2f9f=a0_0x4b0b;function a0_0x54cd(){var _0x50cbe6=['Spanish','paid_amount','stock','ToWarehouse','errors','new\x20new_data','/invoice/:id','return_sale_QA','old_warehouse_data','invoice','string','secondary_code_QA','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','Portuguese','French','c_payment','map','sales_quantity','$product_details.primary_code','redirect','post','language','email','2063085MyPuOJ','product_stock','aggregate','$product_details.type','primary_code','1GUyYcK','sales_return_finished','primary_code_QA','ToRoom','486402LsJBhF','express','slice','3822712ZjCDMk','English','date','product_code_QA','customer','amount','customers','status','note','user','getMonth','master','10620657HsAJEH','findById','sales_return_invoice','params','back','product_name','German','../models/all_models','$product_details.storage','log','Hindi','Returned\x20Payment\x20For\x20Sale\x20Return','../public/language/languages.json','18fWRPwQ','$customer_docs','findOne','$product_details.bin','$product_details.secondary_code','exports','success','Sale\x20Return','1096294XFbtLw','English\x20(US)','Arabic\x20(ae)','floorlevel','body','getFullYear','secondary_code','Router','message','return_qty_QA','find','26943cDuDHJ','stocks_QA','product_name_QA','forEach','suppliers','sales_quantity_QA','$product_details.floorlevel','purchase\x20return\x20successfully','Arabic','stocks','$product_details._id','2104NtBGuK','return_sale','$product_details','/sales_return/view','Chinese','Enabled','$product_details.product_stock','for_categorize','Portuguese\x20(BR)','save','due_amount','foreach\x20newproduct','sale_qty','warehouse_name','flash','subtract','/view/:id','QA\x20Warehouse','type','render','$name','46657700xVOOEg','/give_payment/:id','return_qty','getDate','bay','bin','get','$product_details.product_code','product_code','payment\x20successfull','name'];a0_0x54cd=function(){return _0x50cbe6;};return a0_0x54cd();}(function(_0x3a62b5,_0xc6ee35){var _0x456fa3=a0_0x4b0b,_0x38d20c=_0x3a62b5();while(!![]){try{var _0x1bf9bd=-parseInt(_0x456fa3(0x117))/0x1*(-parseInt(_0x456fa3(0x13f))/0x2)+-parseInt(_0x456fa3(0x11b))/0x3+-parseInt(_0x456fa3(0x11e))/0x4+parseInt(_0x456fa3(0x112))/0x5*(-parseInt(_0x456fa3(0x137))/0x6)+-parseInt(_0x456fa3(0x14a))/0x7*(parseInt(_0x456fa3(0x155))/0x8)+-parseInt(_0x456fa3(0x12a))/0x9+parseInt(_0x456fa3(0x16a))/0xa;if(_0x1bf9bd===_0xc6ee35)break;else _0x38d20c['push'](_0x38d20c['shift']());}catch(_0x680a3d){_0x38d20c['push'](_0x38d20c['shift']());}}}(a0_0x54cd,0xa2926));const express=require(a0_0x3f2f9f(0x11c)),app=express(),router=express[a0_0x3f2f9f(0x146)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x3f2f9f(0x131)),auth=require('../middleware/auth'),users=require(a0_0x3f2f9f(0x136));function a0_0x4b0b(_0x2ff6b6,_0x33b8d1){var _0x54cd69=a0_0x54cd();return a0_0x4b0b=function(_0x4b0b69,_0x30e8af){_0x4b0b69=_0x4b0b69-0xfc;var _0x5e13a7=_0x54cd69[_0x4b0b69];return _0x5e13a7;},a0_0x4b0b(_0x2ff6b6,_0x33b8d1);}router[a0_0x3f2f9f(0x170)]('/view',auth,async(_0x324da6,_0x34a180)=>{var _0x4d314d=a0_0x3f2f9f;try{const {username:_0x4ed69d,email:_0x42798c,role:_0xfa521c}=_0x324da6[_0x4d314d(0x127)],_0x42e3a6=_0x324da6[_0x4d314d(0x127)],_0x2fe340=await profile[_0x4d314d(0x139)]({'email':_0x42e3a6[_0x4d314d(0x111)]}),_0x373240=await master_shop[_0x4d314d(0x149)](),_0x34a830=await sales_return_finished[_0x4d314d(0x114)]([{'$lookup':{'from':_0x4d314d(0x124),'localField':_0x4d314d(0x122),'foreignField':_0x4d314d(0x174),'as':'customer_docs'}},{'$unwind':_0x4d314d(0x138)}]);if(_0x373240[0x0][_0x4d314d(0x110)]==_0x4d314d(0x140)){var _0xacf7a1=users[_0x4d314d(0x11f)];console['log'](_0xacf7a1);}else{if(_0x373240[0x0][_0x4d314d(0x110)]==_0x4d314d(0x134))var _0xacf7a1=users[_0x4d314d(0x134)];else{if(_0x373240[0x0][_0x4d314d(0x110)]=='German')var _0xacf7a1=users[_0x4d314d(0x130)];else{if(_0x373240[0x0][_0x4d314d(0x110)]=='Spanish')var _0xacf7a1=users[_0x4d314d(0x175)];else{if(_0x373240[0x0]['language']==_0x4d314d(0x109))var _0xacf7a1=users['French'];else{if(_0x373240[0x0][_0x4d314d(0x110)]==_0x4d314d(0x15d))var _0xacf7a1=users['Portuguese'];else{if(_0x373240[0x0][_0x4d314d(0x110)]==_0x4d314d(0x159))var _0xacf7a1=users['Chinese'];else{if(_0x373240[0x0]['language']=='Arabic\x20(ae)')var _0xacf7a1=users[_0x4d314d(0x152)];}}}}}}}_0x34a180[_0x4d314d(0x168)](_0x4d314d(0x118),{'success':_0x324da6[_0x4d314d(0x163)]('success'),'errors':_0x324da6[_0x4d314d(0x163)](_0x4d314d(0xff)),'role':_0x42e3a6,'profile':_0x2fe340,'master_shop':_0x373240,'user':_0x34a830,'language':_0xacf7a1});}catch(_0x2286b9){console[_0x4d314d(0x133)](_0x2286b9);}}),router[a0_0x3f2f9f(0x170)](a0_0x3f2f9f(0x165),auth,async(_0x3227f7,_0x473a75)=>{var _0x573130=a0_0x3f2f9f;try{const {username:_0x1d6950,email:_0x69efb4,role:_0x2321dc}=_0x3227f7[_0x573130(0x127)],_0x4c5dfd=_0x3227f7[_0x573130(0x127)],_0x15f8d8=await profile[_0x573130(0x139)]({'email':_0x4c5dfd[_0x573130(0x111)]}),_0x2ba7cc=await master_shop['find']();console[_0x573130(0x133)](_0x573130(0x129),_0x2ba7cc);const _0x1daa53=_0x3227f7[_0x573130(0x12d)]['id'];console[_0x573130(0x133)](_0x1daa53);var _0x2f3c04=['Return\x20Rooms'];const _0x197258=await sales_return_finished['findById'](_0x1daa53),_0x433240=await warehouse[_0x573130(0x114)]([{'$match':{'name':_0x197258[_0x573130(0xfe)],'room':_0x197258[_0x573130(0x11a)]}},{'$unwind':_0x573130(0x157)},{'$group':{'_id':_0x573130(0x154),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x573130(0x15b)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x573130(0x13a)},'type':{'$first':_0x573130(0x115)},'floorlevel':{'$first':_0x573130(0x150)},'primary_code':{'$first':_0x573130(0x10d)},'secondary_code':{'$first':_0x573130(0x13b)},'product_code':{'$first':_0x573130(0x171)},'storage':{'$first':_0x573130(0x132)},'rack':{'$first':'$product_details.rack'}}}]);console[_0x573130(0x133)](_0x433240);const _0x4493dd=await warehouse[_0x573130(0x114)]([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':'$name','name':{'$first':_0x573130(0x169)}}},{'$sort':{'name':0x1}}]),_0x35c1e8=await warehouse[_0x573130(0x114)]([{'$match':{'status':_0x573130(0x15a),'name':_0x573130(0x166)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x3e1488=await product['find']({});if(_0x2ba7cc[0x0][_0x573130(0x110)]==_0x573130(0x140)){var _0x2c91fa=users['English'];console[_0x573130(0x133)](_0x2c91fa);}else{if(_0x2ba7cc[0x0]['language']==_0x573130(0x134))var _0x2c91fa=users[_0x573130(0x134)];else{if(_0x2ba7cc[0x0][_0x573130(0x110)]=='German')var _0x2c91fa=users['German'];else{if(_0x2ba7cc[0x0]['language']==_0x573130(0x175))var _0x2c91fa=users[_0x573130(0x175)];else{if(_0x2ba7cc[0x0][_0x573130(0x110)]==_0x573130(0x109))var _0x2c91fa=users[_0x573130(0x109)];else{if(_0x2ba7cc[0x0][_0x573130(0x110)]=='Portuguese\x20(BR)')var _0x2c91fa=users[_0x573130(0x108)];else{if(_0x2ba7cc[0x0][_0x573130(0x110)]==_0x573130(0x159))var _0x2c91fa=users[_0x573130(0x159)];else{if(_0x2ba7cc[0x0][_0x573130(0x110)]==_0x573130(0x141))var _0x2c91fa=users['Arabic'];}}}}}}}_0x473a75[_0x573130(0x168)]('return_sale_edit_finished',{'success':_0x3227f7[_0x573130(0x163)]('success'),'errors':_0x3227f7[_0x573130(0x163)]('errors'),'role':_0x4c5dfd,'profile':_0x15f8d8,'master_shop':_0x2ba7cc,'user':_0x197258,'stock':_0x433240,'unit':_0x3e1488,'language':_0x2c91fa,'warehouses':_0x4493dd,'rooms':_0x2f3c04,'warehouse_QA':_0x35c1e8});}catch(_0x17f23f){console[_0x573130(0x133)](_0x17f23f);}}),router[a0_0x3f2f9f(0x10f)](a0_0x3f2f9f(0x165),auth,async(_0x52566d,_0x24c125)=>{var _0x3a9abe=a0_0x3f2f9f;if(_0x52566d['body'][_0x3a9abe(0x15c)]=='QA')try{const _0x3a6382=_0x52566d[_0x3a9abe(0x12d)]['id'],_0x51b03a=await sales_return['findOne']({'invoice':_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x104)]}),_0x4f76a7=await warehouse[_0x3a9abe(0x139)]({'name':_0x51b03a[_0x3a9abe(0xfe)],'room':_0x51b03a[_0x3a9abe(0x11a)]}),{invoice:_0xddc4b,customer:_0xa43c20,date:_0x57478b,warehouse_name:_0x3d30eb,product_name:_0x492ac2,primary_code:_0x39a1ea,secondary_code:_0x311af1,product_code:_0x5b2eb5,sales_quantity:_0x29f757,stocks:_0xa2cc07,return_qty:_0x10eb21,note:_0x4145df,to_warehouse_name_QA:_0x1e1b09,to_Room_name_QA:_0x3435b0}=_0x52566d['body'];if(typeof product_name_QA==_0x3a9abe(0x105))var _0x383b02=[_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x14c)]],_0x5607a5=[_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x119)]],_0x4a42c6=[_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x106)]],_0x1cb301=[_0x52566d[_0x3a9abe(0x143)]['product_code_QA']],_0x402898=[_0x52566d['body'][_0x3a9abe(0x14f)]],_0x3ea8bf=[_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x14b)]],_0x5cd659=[_0x52566d['body'][_0x3a9abe(0x148)]];else var _0x383b02=[..._0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x14c)]],_0x5607a5=[..._0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x119)]],_0x4a42c6=[..._0x52566d['body'][_0x3a9abe(0x106)]],_0x1cb301=[..._0x52566d['body'][_0x3a9abe(0x121)]],_0x402898=[..._0x52566d['body'][_0x3a9abe(0x14f)]],_0x3ea8bf=[..._0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x14b)]],_0x5cd659=[..._0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x148)]];const _0x49a578=_0x383b02[_0x3a9abe(0x10b)](_0x558a10=>{return _0x558a10={'product_name':_0x558a10};});_0x5607a5[_0x3a9abe(0x14d)]((_0x5c885a,_0x422d3b)=>{_0x49a578[_0x422d3b]['primary_code']=_0x5c885a;}),_0x4a42c6[_0x3a9abe(0x14d)]((_0x42b03b,_0x303f23)=>{var _0x127395=_0x3a9abe;_0x49a578[_0x303f23][_0x127395(0x145)]=_0x42b03b;}),_0x1cb301[_0x3a9abe(0x14d)]((_0x56113a,_0xa4284c)=>{var _0x51ac84=_0x3a9abe;_0x49a578[_0xa4284c][_0x51ac84(0x172)]=_0x56113a;}),_0x402898[_0x3a9abe(0x14d)]((_0x59b476,_0x1e0b81)=>{var _0x339be6=_0x3a9abe;_0x49a578[_0x1e0b81][_0x339be6(0x161)]=_0x59b476;}),_0x3ea8bf['forEach']((_0x288dd6,_0x30b4a7)=>{var _0x56d365=_0x3a9abe;_0x49a578[_0x30b4a7][_0x56d365(0xfd)]=_0x288dd6;}),_0x5cd659[_0x3a9abe(0x14d)]((_0x9ec46c,_0x3f02fd)=>{_0x49a578[_0x3f02fd]['return_qty']=_0x9ec46c;}),_0x51b03a['return_sale_QA'][_0x3a9abe(0x14d)](_0x5aa781=>{var _0x42fdc6=_0x3a9abe;const _0xeb6420=_0x4f76a7['product_details'][_0x42fdc6(0x10b)](_0x3eada7=>{var _0x1a08ad=_0x42fdc6;_0x3eada7['product_name']==_0x5aa781['product_name']&&(_0x3eada7[_0x1a08ad(0x113)]=parseInt(_0x3eada7[_0x1a08ad(0x113)])+parseInt(_0x5aa781[_0x1a08ad(0x16c)]));});}),await _0x4f76a7[_0x3a9abe(0x15e)](),_0x51b03a[_0x3a9abe(0x104)]=_0xddc4b,_0x51b03a[_0x3a9abe(0x122)]=_0xa43c20,_0x51b03a[_0x3a9abe(0x120)]=_0x57478b,_0x51b03a[_0x3a9abe(0x162)]=_0x3d30eb,_0x51b03a[_0x3a9abe(0x102)]=_0x49a578,_0x51b03a[_0x3a9abe(0x126)]=_0x4145df,_0x51b03a[_0x3a9abe(0xfe)]=_0x1e1b09,_0x51b03a[_0x3a9abe(0x11a)]=_0x3435b0;const _0x5efe8c=await _0x51b03a[_0x3a9abe(0x15e)](),_0x18e7de=await c_payment_data['findOne']({'invoice':_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x104)],'reason':'Sale\x20Return'});_0x18e7de['suppliers']=_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x14e)],_0x18e7de['date']=_0x52566d['body'][_0x3a9abe(0x120)],await _0x18e7de['save'](),_0x52566d['flash'](_0x3a9abe(0x13d),_0x3a9abe(0x151)),_0x24c125[_0x3a9abe(0x10e)]('/sales_return_finished/view');}catch(_0x4a936b){console[_0x3a9abe(0x133)](_0x4a936b),_0x24c125[_0x3a9abe(0x125)](0xc8)['json']({'message':_0x4a936b[_0x3a9abe(0x147)]});}else try{const _0x5ee31c=_0x52566d['params']['id'];console[_0x3a9abe(0x133)](_0x5ee31c);const _0x55957c=await sales_return[_0x3a9abe(0x139)]({'invoice':_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x104)]});console[_0x3a9abe(0x133)]('old_data',_0x55957c);const _0x2f06e7=await warehouse['findOne']({'name':_0x55957c[_0x3a9abe(0xfe)],'room':_0x55957c['ToRoom']});console[_0x3a9abe(0x133)]('old_warehouse_data',_0x2f06e7);const {invoice:_0x1fd48f,customer:_0x41e01f,date:_0x3d4595,warehouse_name:_0x2600d8,product_name:_0x3acd63,primary_code:_0x399223,secondary_code:_0x5ea15c,product_code:_0x57d7c8,sales_quantity:_0x5511db,stocks:_0x24a7d8,return_qty:_0x54c005,note:_0x3d3510,to_warehouse_name:_0x41b00c,to_Room_name:_0x3fc04a}=_0x52566d['body'];console[_0x3a9abe(0x133)](_0x52566d[_0x3a9abe(0x143)]);if(typeof _0x3acd63==_0x3a9abe(0x105))var _0x383b02=[_0x52566d[_0x3a9abe(0x143)]['product_name']],_0x5607a5=[_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x116)]],_0x4a42c6=[_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x145)]],_0x1cb301=[_0x52566d['body']['product_code']],_0x402898=[_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x10c)]],_0x3ea8bf=[_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x153)]],_0x5cd659=[_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x16c)]],_0x398cef=[_0x52566d['body'][_0x3a9abe(0x16e)]],_0x5e9a62=[_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x16f)]],_0x13d948=[_0x52566d[_0x3a9abe(0x143)]['types']],_0x4669ff=[_0x52566d['body']['floorlevel']];else var _0x383b02=[..._0x52566d[_0x3a9abe(0x143)]['product_name']],_0x5607a5=[..._0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x116)]],_0x4a42c6=[..._0x52566d['body']['secondary_code']],_0x1cb301=[..._0x52566d[_0x3a9abe(0x143)]['product_code']],_0x402898=[..._0x52566d[_0x3a9abe(0x143)]['sales_quantity']],_0x3ea8bf=[..._0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x153)]],_0x5cd659=[..._0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x16c)]],_0x398cef=[..._0x52566d['body']['bay']],_0x5e9a62=[..._0x52566d[_0x3a9abe(0x143)]['bin']],_0x13d948=[..._0x52566d['body']['types']],_0x4669ff=[..._0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x142)]];const _0x5896e0=_0x383b02[_0x3a9abe(0x10b)](_0x9a7243=>{return _0x9a7243={'product_name':_0x9a7243};});_0x5607a5['forEach']((_0xb3a847,_0xe5efb7)=>{var _0x42ef92=_0x3a9abe;_0x5896e0[_0xe5efb7][_0x42ef92(0x116)]=_0xb3a847;}),_0x4a42c6[_0x3a9abe(0x14d)]((_0x4f52f2,_0x294dbc)=>{_0x5896e0[_0x294dbc]['secondary_code']=_0x4f52f2;}),_0x1cb301[_0x3a9abe(0x14d)]((_0x201803,_0x5e6d02)=>{var _0x2b175c=_0x3a9abe;_0x5896e0[_0x5e6d02][_0x2b175c(0x172)]=_0x201803;}),_0x402898[_0x3a9abe(0x14d)]((_0x124679,_0x16fab9)=>{var _0x5e688f=_0x3a9abe;_0x5896e0[_0x16fab9][_0x5e688f(0x161)]=_0x124679;}),_0x3ea8bf['forEach']((_0x1caf60,_0x17e6f4)=>{_0x5896e0[_0x17e6f4]['stock']=_0x1caf60;}),_0x5cd659[_0x3a9abe(0x14d)]((_0x2507e3,_0x15af60)=>{var _0x166986=_0x3a9abe;_0x5896e0[_0x15af60][_0x166986(0x16c)]=_0x2507e3;}),_0x398cef['forEach']((_0x49c58e,_0x289027)=>{_0x5896e0[_0x289027]['bay']=_0x49c58e;}),_0x5e9a62[_0x3a9abe(0x14d)]((_0x580262,_0x33346f)=>{_0x5896e0[_0x33346f]['bin']=_0x580262;}),_0x13d948[_0x3a9abe(0x14d)]((_0x142ee9,_0x5ddb59)=>{var _0x555288=_0x3a9abe;_0x5896e0[_0x5ddb59][_0x555288(0x167)]=_0x142ee9;}),_0x4669ff[_0x3a9abe(0x14d)]((_0x1764c1,_0x3aadc9)=>{var _0x1f7983=_0x3a9abe;_0x5896e0[_0x3aadc9][_0x1f7983(0x142)]=_0x1764c1;});var _0xa83505=0x0;_0x5896e0['forEach'](_0x49cd68=>{var _0x59d485=_0x3a9abe;console['log'](_0x59d485(0x160),_0x49cd68),(parseInt(_0x49cd68[_0x59d485(0x161)])<parseInt(_0x49cd68[_0x59d485(0x16c)])||parseInt(_0x49cd68[_0x59d485(0xfd)])<parseInt(_0x49cd68[_0x59d485(0x16c)])&&parseInt(_0x49cd68['sale_qty'])>parseInt(_0x49cd68[_0x59d485(0x16c)])||parseInt(_0x49cd68[_0x59d485(0x16c)])==0x0)&&_0xa83505++;});if(_0xa83505!=0x0)return _0x52566d['flash']('errors',_0x3a9abe(0x107)),_0x24c125[_0x3a9abe(0x10e)](_0x3a9abe(0x12e));_0x55957c[_0x3a9abe(0x156)][_0x3a9abe(0x14d)](_0x354c2d=>{var _0x176e11=_0x3a9abe;const _0x3f418a=_0x2f06e7['product_details'][_0x176e11(0x10b)](_0x2f4490=>{var _0x417c97=_0x176e11;_0x2f4490['product_name']==_0x354c2d[_0x417c97(0x12f)]&&_0x2f4490[_0x417c97(0x142)]==_0x354c2d['floorlevel']&&_0x2f4490[_0x417c97(0x167)]==_0x354c2d[_0x417c97(0x167)]&&_0x2f4490['bin']==_0x354c2d['bin']&&_0x2f4490[_0x417c97(0x16e)]==_0x354c2d[_0x417c97(0x16e)]&&(_0x2f4490['product_stock']=parseInt(_0x2f4490['product_stock'])+parseInt(_0x354c2d[_0x417c97(0x16c)]));});}),console[_0x3a9abe(0x133)](_0x3a9abe(0x103),_0x2f06e7),await _0x2f06e7[_0x3a9abe(0x15e)](),_0x55957c['invoice']=_0x1fd48f,_0x55957c[_0x3a9abe(0x122)]=_0x41e01f,_0x55957c[_0x3a9abe(0x120)]=_0x3d4595,_0x55957c['warehouse_name']=_0x2600d8,_0x55957c[_0x3a9abe(0x156)]=_0x5896e0,_0x55957c[_0x3a9abe(0x126)]=_0x3d3510,_0x55957c[_0x3a9abe(0xfe)]=_0x41b00c,_0x55957c['ToRoom']=_0x3fc04a;const _0x4186ef=await _0x55957c[_0x3a9abe(0x15e)]();console[_0x3a9abe(0x133)](_0x3a9abe(0x100),_0x4186ef);const _0x508ee4=await c_payment_data['findOne']({'invoice':_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x104)],'reason':'Sale\x20Return'});_0x508ee4['suppliers']=_0x52566d[_0x3a9abe(0x143)][_0x3a9abe(0x14e)],_0x508ee4[_0x3a9abe(0x120)]=_0x52566d['body'][_0x3a9abe(0x120)],await _0x508ee4['save'](),_0x52566d[_0x3a9abe(0x163)]('success',_0x3a9abe(0x151)),_0x24c125['redirect'](_0x3a9abe(0x158));}catch(_0x564025){console[_0x3a9abe(0x133)](_0x564025),_0x24c125[_0x3a9abe(0x125)](0xc8)['json']({'message':_0x564025[_0x3a9abe(0x147)]});}}),router[a0_0x3f2f9f(0x10f)](a0_0x3f2f9f(0x16b),auth,async(_0x37b27a,_0x1ddb64)=>{var _0x52810f=a0_0x3f2f9f;try{const _0x314f22=_0x37b27a['params']['id'],{invoice:_0x2c25bc,customer:_0x33c1e8,payable_to_customer:_0x8c4f3f,paid_amount:_0x1be1b3}=_0x37b27a[_0x52810f(0x143)],_0x14298e=await sales_return['findById'](_0x314f22);console['log']('data',_0x14298e),console['log'](_0x8c4f3f),console[_0x52810f(0x133)](_0x1be1b3);var _0x187a43=_0x8c4f3f-_0x1be1b3;console[_0x52810f(0x133)](_0x52810f(0x164),_0x187a43),_0x14298e['paid_amount']=parseFloat(_0x1be1b3)+parseFloat(_0x14298e[_0x52810f(0xfc)]),_0x14298e[_0x52810f(0x15f)]=_0x187a43,console['log'](_0x14298e);const _0x42e357=await _0x14298e[_0x52810f(0x15e)]();console[_0x52810f(0x133)](0x1b207);const _0x96cb4c=await c_payment_data[_0x52810f(0x139)]({'invoice':_0x37b27a[_0x52810f(0x143)][_0x52810f(0x104)],'reason':_0x52810f(0x13e)});console[_0x52810f(0x133)](_0x52810f(0x10a),_0x96cb4c),_0x96cb4c[_0x52810f(0x123)]=_0x187a43,await _0x96cb4c[_0x52810f(0x15e)]();let _0x3eb81b=new Date(),_0x5bae74=('0'+_0x3eb81b[_0x52810f(0x16d)]())[_0x52810f(0x11d)](-0x2),_0x194b87=('0'+(_0x3eb81b[_0x52810f(0x128)]()+0x1))[_0x52810f(0x11d)](-0x2),_0x706626=_0x3eb81b[_0x52810f(0x144)](),_0x1e41e4=_0x706626+'-'+_0x194b87+'-'+_0x5bae74;const _0x1bbc4b=new customer_payment({'invoice':_0x2c25bc,'date':_0x706626+'-'+_0x194b87+'-'+_0x5bae74,'customer':_0x33c1e8,'reason':_0x52810f(0x135),'amount':_0x1be1b3}),_0x22773e=await _0x1bbc4b[_0x52810f(0x15e)]();_0x37b27a['flash']('success',_0x52810f(0x173)),_0x1ddb64[_0x52810f(0x10e)](_0x52810f(0x158));}catch(_0x1ca305){console['log'](_0x1ca305);}}),router[a0_0x3f2f9f(0x170)](a0_0x3f2f9f(0x101),auth,async(_0xcfb079,_0x216273)=>{var _0x1f17e9=a0_0x3f2f9f;try{const {username:_0x24dc23,email:_0x311d9c,role:_0x31e1c9}=_0xcfb079[_0x1f17e9(0x127)],_0x4c36fb=_0xcfb079[_0x1f17e9(0x127)],_0x44751d=await profile[_0x1f17e9(0x139)]({'email':_0x4c36fb[_0x1f17e9(0x111)]}),_0x3a155a=await master_shop[_0x1f17e9(0x149)]();console[_0x1f17e9(0x133)](_0x1f17e9(0x129),_0x3a155a);const _0x53f495=_0xcfb079['params']['id'],_0x391e08=await sales_return[_0x1f17e9(0x12b)](_0x53f495);console[_0x1f17e9(0x133)](_0x391e08);const _0x59584e=await customer[_0x1f17e9(0x139)]({'name':_0x391e08[_0x1f17e9(0x122)]});console[_0x1f17e9(0x133)](_0x59584e);if(_0x3a155a[0x0][_0x1f17e9(0x110)]==_0x1f17e9(0x140)){var _0x39f1f6=users[_0x1f17e9(0x11f)];console[_0x1f17e9(0x133)](_0x39f1f6);}else{if(_0x3a155a[0x0][_0x1f17e9(0x110)]==_0x1f17e9(0x134))var _0x39f1f6=users[_0x1f17e9(0x134)];else{if(_0x3a155a[0x0]['language']==_0x1f17e9(0x130))var _0x39f1f6=users['German'];else{if(_0x3a155a[0x0][_0x1f17e9(0x110)]==_0x1f17e9(0x175))var _0x39f1f6=users[_0x1f17e9(0x175)];else{if(_0x3a155a[0x0][_0x1f17e9(0x110)]==_0x1f17e9(0x109))var _0x39f1f6=users[_0x1f17e9(0x109)];else{if(_0x3a155a[0x0]['language']==_0x1f17e9(0x15d))var _0x39f1f6=users[_0x1f17e9(0x108)];else{if(_0x3a155a[0x0]['language']=='Chinese')var _0x39f1f6=users[_0x1f17e9(0x159)];else{if(_0x3a155a[0x0][_0x1f17e9(0x110)]==_0x1f17e9(0x141))var _0x39f1f6=users['Arabic'];}}}}}}}_0x216273['render'](_0x1f17e9(0x12c),{'success':_0xcfb079[_0x1f17e9(0x163)](_0x1f17e9(0x13d)),'errors':_0xcfb079[_0x1f17e9(0x163)]('errors'),'role':_0x4c36fb,'profile':_0x44751d,'master_shop':_0x3a155a,'customers':_0x59584e,'sales':_0x391e08,'language':_0x39f1f6});}catch(_0x51bf95){console['log'](_0x51bf95);}}),module[a0_0x3f2f9f(0x13c)]=router;