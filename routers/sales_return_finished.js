function a0_0xc3cb(_0x4026f2,_0xb5b274){var _0x33a8b0=a0_0x33a8();return a0_0xc3cb=function(_0xc3cb90,_0x5a2f02){_0xc3cb90=_0xc3cb90-0xd2;var _0x505986=_0x33a8b0[_0xc3cb90];return _0x505986;},a0_0xc3cb(_0x4026f2,_0xb5b274);}var a0_0x420ae6=a0_0xc3cb;function a0_0x33a8(){var _0x410b16=['232rPhAxx','3015516CbQKtS','c_payment','/view','email','string','note','product_code','post','secondary_code','master','slice','Finished\x20Goods','suppliers','find','primary_code','English\x20(US)','1739510THObny','/give_payment/:id','$product_details._id','customer','map','getMonth','15jBZnhN','new\x20new_data','Portuguese','$name','render','log','old_data','648TnvQrF','subtract','language','return_sale','types','$product_details.product_stock','bay','return_sale_QA','flash','860556xOsRIy','aggregate','Arabic\x20(ae)','foreach\x20newproduct','due_amount','findById','383050Qveuld','sales_return_finished','stock','secondary_code_QA','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','params','errors','redirect','German','return_qty','sales_quantity','sale_qty','body','paid_amount','Hindi','old_warehouse_data','Portuguese\x20(BR)','stocks_QA','/view/:id','French','message','Chinese','warehouse_name','for_categorize','ToWarehouse','user','$product_details.rack','$product_details.storage','success','$customer_docs','$product_details.floorlevel','product_name','Sale\x20Return','product_details','/sales_return/view','product_stock','Spanish','Enabled','back','save','name','purchase\x20return\x20successfully','1079984kjNMtC','payment\x20successfull','customers','bin','amount','$product_details.bin','date','data','invoice','product_code_QA','Arabic','/invoice/:id','product_name_QA','../public/language/languages.json','findOne','stocks','768000CppMti','$product_details','151767dKewyX','$product_details.product_code','return_sale_edit_finished','floorlevel','json','sales_quantity_QA','forEach','Return\x20Rooms','status','ToRoom','$product_details.bay','Router','English','type'];a0_0x33a8=function(){return _0x410b16;};return a0_0x33a8();}(function(_0x1e9267,_0x300d67){var _0x35e9d0=a0_0xc3cb,_0x33ed93=_0x1e9267();while(!![]){try{var _0x34355e=-parseInt(_0x35e9d0(0xe6))/0x1+-parseInt(_0x35e9d0(0x117))/0x2+parseInt(_0x35e9d0(0x107))/0x3+-parseInt(_0x35e9d0(0x12d))/0x4*(parseInt(_0x35e9d0(0x11d))/0x5)+parseInt(_0x35e9d0(0xf6))/0x6+-parseInt(_0x35e9d0(0xf8))/0x7*(parseInt(_0x35e9d0(0x106))/0x8)+parseInt(_0x35e9d0(0x124))/0x9*(parseInt(_0x35e9d0(0x133))/0xa);if(_0x34355e===_0x300d67)break;else _0x33ed93['push'](_0x33ed93['shift']());}catch(_0x4b6a18){_0x33ed93['push'](_0x33ed93['shift']());}}}(a0_0x33a8,0xa2e5b));const express=require('express'),app=express(),router=express[a0_0x420ae6(0x103)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x420ae6(0xf3));router['get'](a0_0x420ae6(0x109),auth,async(_0x418449,_0x4c0453)=>{var _0x8881ef=a0_0x420ae6;try{const {username:_0x467437,email:_0x1e9e1f,role:_0x29ea0b}=_0x418449[_0x8881ef(0xd5)],_0x464b5e=_0x418449[_0x8881ef(0xd5)],_0xbad293=await profile[_0x8881ef(0xf4)]({'email':_0x464b5e[_0x8881ef(0x10a)]}),_0x4a69c0=await master_shop[_0x8881ef(0x114)](),_0x5dce6f=await sales_return_finished[_0x8881ef(0x12e)]([{'$lookup':{'from':_0x8881ef(0xe8),'localField':'customer','foreignField':_0x8881ef(0xe4),'as':'customer_docs'}},{'$unwind':_0x8881ef(0xd9)}]);if(_0x4a69c0[0x0][_0x8881ef(0x126)]==_0x8881ef(0x116)){var _0x273fd8=users[_0x8881ef(0x104)];console[_0x8881ef(0x122)](_0x273fd8);}else{if(_0x4a69c0[0x0][_0x8881ef(0x126)]==_0x8881ef(0x141))var _0x273fd8=users[_0x8881ef(0x141)];else{if(_0x4a69c0[0x0][_0x8881ef(0x126)]==_0x8881ef(0x13b))var _0x273fd8=users[_0x8881ef(0x13b)];else{if(_0x4a69c0[0x0][_0x8881ef(0x126)]=='Spanish')var _0x273fd8=users['Spanish'];else{if(_0x4a69c0[0x0][_0x8881ef(0x126)]=='French')var _0x273fd8=users[_0x8881ef(0x146)];else{if(_0x4a69c0[0x0][_0x8881ef(0x126)]==_0x8881ef(0x143))var _0x273fd8=users[_0x8881ef(0x11f)];else{if(_0x4a69c0[0x0]['language']==_0x8881ef(0x148))var _0x273fd8=users[_0x8881ef(0x148)];else{if(_0x4a69c0[0x0][_0x8881ef(0x126)]==_0x8881ef(0x12f))var _0x273fd8=users[_0x8881ef(0xf0)];}}}}}}}_0x4c0453['render'](_0x8881ef(0x134),{'success':_0x418449[_0x8881ef(0x12c)](_0x8881ef(0xd8)),'errors':_0x418449[_0x8881ef(0x12c)](_0x8881ef(0x139)),'role':_0x464b5e,'profile':_0xbad293,'master_shop':_0x4a69c0,'user':_0x5dce6f,'language':_0x273fd8});}catch(_0x1bbfbc){console[_0x8881ef(0x122)](_0x1bbfbc);}}),router['get'](a0_0x420ae6(0x145),auth,async(_0x1cc2d6,_0x3362f8)=>{var _0x206390=a0_0x420ae6;try{const {username:_0x3f0bb9,email:_0x3dcd4c,role:_0x4de92b}=_0x1cc2d6[_0x206390(0xd5)],_0x1c347a=_0x1cc2d6[_0x206390(0xd5)],_0x16195f=await profile[_0x206390(0xf4)]({'email':_0x1c347a[_0x206390(0x10a)]}),_0x2195f1=await master_shop[_0x206390(0x114)]();console['log']('master',_0x2195f1);const _0x2aaf42=_0x1cc2d6[_0x206390(0x138)]['id'];console['log'](_0x2aaf42);var _0x50e110=[_0x206390(0xff)];const _0x140388=await sales_return_finished[_0x206390(0x132)](_0x2aaf42),_0x418c2d=await warehouse[_0x206390(0x12e)]([{'$match':{'name':_0x140388[_0x206390(0xd4)],'room':_0x140388[_0x206390(0x101)]}},{'$unwind':_0x206390(0xf7)},{'$group':{'_id':_0x206390(0x119),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x206390(0x129)},'bay':{'$first':_0x206390(0x102)},'bin':{'$first':_0x206390(0xeb)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x206390(0xda)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x206390(0xf9)},'storage':{'$first':_0x206390(0xd7)},'rack':{'$first':_0x206390(0xd6)}}}]);console['log'](_0x418c2d);const _0x291293=await warehouse[_0x206390(0x12e)]([{'$match':{'status':'Enabled','warehouse_category':_0x206390(0x112)}},{'$group':{'_id':'$name','name':{'$first':_0x206390(0x120)}}},{'$sort':{'name':0x1}}]),_0x48bec6=await warehouse[_0x206390(0x12e)]([{'$match':{'status':_0x206390(0xe1),'name':'QA\x20Warehouse'}},{'$group':{'_id':'$name','name':{'$first':_0x206390(0x120)}}},{'$sort':{'name':0x1}}]),_0x35a662=await product['find']({});if(_0x2195f1[0x0][_0x206390(0x126)]==_0x206390(0x116)){var _0x2e00d2=users[_0x206390(0x104)];console[_0x206390(0x122)](_0x2e00d2);}else{if(_0x2195f1[0x0][_0x206390(0x126)]==_0x206390(0x141))var _0x2e00d2=users[_0x206390(0x141)];else{if(_0x2195f1[0x0][_0x206390(0x126)]==_0x206390(0x13b))var _0x2e00d2=users[_0x206390(0x13b)];else{if(_0x2195f1[0x0][_0x206390(0x126)]==_0x206390(0xe0))var _0x2e00d2=users['Spanish'];else{if(_0x2195f1[0x0]['language']==_0x206390(0x146))var _0x2e00d2=users[_0x206390(0x146)];else{if(_0x2195f1[0x0][_0x206390(0x126)]=='Portuguese\x20(BR)')var _0x2e00d2=users[_0x206390(0x11f)];else{if(_0x2195f1[0x0][_0x206390(0x126)]==_0x206390(0x148))var _0x2e00d2=users[_0x206390(0x148)];else{if(_0x2195f1[0x0][_0x206390(0x126)]==_0x206390(0x12f))var _0x2e00d2=users[_0x206390(0xf0)];}}}}}}}_0x3362f8[_0x206390(0x121)](_0x206390(0xfa),{'success':_0x1cc2d6['flash']('success'),'errors':_0x1cc2d6[_0x206390(0x12c)](_0x206390(0x139)),'role':_0x1c347a,'profile':_0x16195f,'master_shop':_0x2195f1,'user':_0x140388,'stock':_0x418c2d,'unit':_0x35a662,'language':_0x2e00d2,'warehouses':_0x291293,'rooms':_0x50e110,'warehouse_QA':_0x48bec6});}catch(_0x440db3){console[_0x206390(0x122)](_0x440db3);}}),router[a0_0x420ae6(0x10e)]('/view/:id',auth,async(_0x531520,_0x14b47f)=>{var _0x10d9e6=a0_0x420ae6;if(_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xd3)]=='QA')try{const _0x4bb75b=_0x531520['params']['id'],_0x451324=await sales_return[_0x10d9e6(0xf4)]({'invoice':_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xee)]}),_0x372974=await warehouse['findOne']({'name':_0x451324['ToWarehouse'],'room':_0x451324[_0x10d9e6(0x101)]}),{invoice:_0x4328fe,customer:_0x363066,date:_0x53a896,warehouse_name:_0x4d06a7,product_name:_0x45101d,primary_code:_0x16c788,secondary_code:_0x1c8e55,product_code:_0x266b3e,sales_quantity:_0x5e977a,stocks:_0x17abb6,return_qty:_0x4f96c6,note:_0x41150f,to_warehouse_name_QA:_0x5daf26,to_Room_name_QA:_0x2f4284}=_0x531520[_0x10d9e6(0x13f)];if(typeof product_name_QA=='string')var _0x311b78=[_0x531520['body']['product_name_QA']],_0x433d55=[_0x531520['body']['primary_code_QA']],_0x14bab0=[_0x531520['body']['secondary_code_QA']],_0x3566e0=[_0x531520[_0x10d9e6(0x13f)]['product_code_QA']],_0x2a0aa8=[_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xfd)]],_0x3c7f2d=[_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x144)]],_0x26b7b5=[_0x531520[_0x10d9e6(0x13f)]['return_qty_QA']];else var _0x311b78=[..._0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xf2)]],_0x433d55=[..._0x531520['body']['primary_code_QA']],_0x14bab0=[..._0x531520['body'][_0x10d9e6(0x136)]],_0x3566e0=[..._0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xef)]],_0x2a0aa8=[..._0x531520[_0x10d9e6(0x13f)]['sales_quantity_QA']],_0x3c7f2d=[..._0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x144)]],_0x26b7b5=[..._0x531520['body']['return_qty_QA']];const _0x377a7c=_0x311b78[_0x10d9e6(0x11b)](_0x4e5320=>{return _0x4e5320={'product_name':_0x4e5320};});_0x433d55[_0x10d9e6(0xfe)]((_0x126ad4,_0x4d5fa9)=>{var _0x58a282=_0x10d9e6;_0x377a7c[_0x4d5fa9][_0x58a282(0x115)]=_0x126ad4;}),_0x14bab0[_0x10d9e6(0xfe)]((_0xb8e96e,_0x1d3fa9)=>{var _0x5c6164=_0x10d9e6;_0x377a7c[_0x1d3fa9][_0x5c6164(0x10f)]=_0xb8e96e;}),_0x3566e0[_0x10d9e6(0xfe)]((_0xaa719d,_0x514f1c)=>{_0x377a7c[_0x514f1c]['product_code']=_0xaa719d;}),_0x2a0aa8[_0x10d9e6(0xfe)]((_0x372b36,_0x20bf3e)=>{var _0x132d16=_0x10d9e6;_0x377a7c[_0x20bf3e][_0x132d16(0x13e)]=_0x372b36;}),_0x3c7f2d[_0x10d9e6(0xfe)]((_0x53b8b7,_0x32acbe)=>{_0x377a7c[_0x32acbe]['stock']=_0x53b8b7;}),_0x26b7b5[_0x10d9e6(0xfe)]((_0x51e418,_0x3be42f)=>{_0x377a7c[_0x3be42f]['return_qty']=_0x51e418;}),_0x451324[_0x10d9e6(0x12b)]['forEach'](_0x23ee4a=>{var _0x6df706=_0x10d9e6;const _0x1b86aa=_0x372974[_0x6df706(0xdd)][_0x6df706(0x11b)](_0x101b91=>{var _0x58d44a=_0x6df706;_0x101b91[_0x58d44a(0xdb)]==_0x23ee4a[_0x58d44a(0xdb)]&&(_0x101b91[_0x58d44a(0xdf)]=parseInt(_0x101b91[_0x58d44a(0xdf)])+parseInt(_0x23ee4a['return_qty']));});}),await _0x372974[_0x10d9e6(0xe3)](),_0x451324[_0x10d9e6(0xee)]=_0x4328fe,_0x451324[_0x10d9e6(0x11a)]=_0x363066,_0x451324[_0x10d9e6(0xec)]=_0x53a896,_0x451324[_0x10d9e6(0xd2)]=_0x4d06a7,_0x451324[_0x10d9e6(0x12b)]=_0x377a7c,_0x451324[_0x10d9e6(0x10c)]=_0x41150f,_0x451324[_0x10d9e6(0xd4)]=_0x5daf26,_0x451324['ToRoom']=_0x2f4284;const _0x1c68b6=await _0x451324['save'](),_0x4f1756=await c_payment_data[_0x10d9e6(0xf4)]({'invoice':_0x531520['body'][_0x10d9e6(0xee)],'reason':_0x10d9e6(0xdc)});_0x4f1756[_0x10d9e6(0x113)]=_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x113)],_0x4f1756[_0x10d9e6(0xec)]=_0x531520['body'][_0x10d9e6(0xec)],await _0x4f1756[_0x10d9e6(0xe3)](),_0x531520['flash'](_0x10d9e6(0xd8),'purchase\x20return\x20successfully'),_0x14b47f['redirect']('/sales_return_finished/view');}catch(_0x596fc1){console['log'](_0x596fc1),_0x14b47f[_0x10d9e6(0x100)](0xc8)[_0x10d9e6(0xfc)]({'message':_0x596fc1[_0x10d9e6(0x147)]});}else try{const _0x81f3cc=_0x531520[_0x10d9e6(0x138)]['id'];console['log'](_0x81f3cc);const _0x1a90de=await sales_return[_0x10d9e6(0xf4)]({'invoice':_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xee)]});console[_0x10d9e6(0x122)](_0x10d9e6(0x123),_0x1a90de);const _0x353d62=await warehouse['findOne']({'name':_0x1a90de[_0x10d9e6(0xd4)],'room':_0x1a90de[_0x10d9e6(0x101)]});console['log'](_0x10d9e6(0x142),_0x353d62);const {invoice:_0x683bb7,customer:_0x3b8996,date:_0x435772,warehouse_name:_0x1095e9,product_name:_0x2fb9d2,primary_code:_0x4d2014,secondary_code:_0x1031da,product_code:_0x45e674,sales_quantity:_0x1b693d,stocks:_0x57e3c0,return_qty:_0x501a40,note:_0x286b54,to_warehouse_name:_0x559292,to_Room_name:_0x514499}=_0x531520[_0x10d9e6(0x13f)];console[_0x10d9e6(0x122)](_0x531520['body']);if(typeof _0x2fb9d2==_0x10d9e6(0x10b))var _0x311b78=[_0x531520[_0x10d9e6(0x13f)]['product_name']],_0x433d55=[_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x115)]],_0x14bab0=[_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x10f)]],_0x3566e0=[_0x531520[_0x10d9e6(0x13f)]['product_code']],_0x2a0aa8=[_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x13d)]],_0x3c7f2d=[_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xf5)]],_0x26b7b5=[_0x531520['body'][_0x10d9e6(0x13c)]],_0x831695=[_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x12a)]],_0xe6273f=[_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xe9)]],_0x2d5e34=[_0x531520['body'][_0x10d9e6(0x128)]],_0x481a08=[_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xfb)]];else var _0x311b78=[..._0x531520['body']['product_name']],_0x433d55=[..._0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x115)]],_0x14bab0=[..._0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x10f)]],_0x3566e0=[..._0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x10d)]],_0x2a0aa8=[..._0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x13d)]],_0x3c7f2d=[..._0x531520['body']['stocks']],_0x26b7b5=[..._0x531520[_0x10d9e6(0x13f)]['return_qty']],_0x831695=[..._0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x12a)]],_0xe6273f=[..._0x531520[_0x10d9e6(0x13f)]['bin']],_0x2d5e34=[..._0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0x128)]],_0x481a08=[..._0x531520['body'][_0x10d9e6(0xfb)]];const _0x451610=_0x311b78[_0x10d9e6(0x11b)](_0x4e4813=>{return _0x4e4813={'product_name':_0x4e4813};});_0x433d55[_0x10d9e6(0xfe)]((_0x2f1bd0,_0x3b4c65)=>{_0x451610[_0x3b4c65]['primary_code']=_0x2f1bd0;}),_0x14bab0[_0x10d9e6(0xfe)]((_0x12f611,_0xff3230)=>{_0x451610[_0xff3230]['secondary_code']=_0x12f611;}),_0x3566e0[_0x10d9e6(0xfe)]((_0x34331c,_0x37126c)=>{var _0xa936ff=_0x10d9e6;_0x451610[_0x37126c][_0xa936ff(0x10d)]=_0x34331c;}),_0x2a0aa8[_0x10d9e6(0xfe)]((_0x291b99,_0x2f8fa5)=>{_0x451610[_0x2f8fa5]['sale_qty']=_0x291b99;}),_0x3c7f2d[_0x10d9e6(0xfe)]((_0x3f4b4e,_0x3a7f65)=>{var _0x3f46eb=_0x10d9e6;_0x451610[_0x3a7f65][_0x3f46eb(0x135)]=_0x3f4b4e;}),_0x26b7b5[_0x10d9e6(0xfe)]((_0x4d4f07,_0x132e42)=>{var _0x2ac209=_0x10d9e6;_0x451610[_0x132e42][_0x2ac209(0x13c)]=_0x4d4f07;}),_0x831695['forEach']((_0x123bcb,_0x1d3aae)=>{var _0x28965a=_0x10d9e6;_0x451610[_0x1d3aae][_0x28965a(0x12a)]=_0x123bcb;}),_0xe6273f['forEach']((_0x217859,_0x565334)=>{_0x451610[_0x565334]['bin']=_0x217859;}),_0x2d5e34[_0x10d9e6(0xfe)]((_0x4a2daf,_0x2ba070)=>{var _0x125657=_0x10d9e6;_0x451610[_0x2ba070][_0x125657(0x105)]=_0x4a2daf;}),_0x481a08['forEach']((_0x5f2828,_0x1caac2)=>{_0x451610[_0x1caac2]['floorlevel']=_0x5f2828;});var _0x211190=0x0;_0x451610[_0x10d9e6(0xfe)](_0x3662cb=>{var _0x34a494=_0x10d9e6;console['log'](_0x34a494(0x130),_0x3662cb),(parseInt(_0x3662cb[_0x34a494(0x13e)])<parseInt(_0x3662cb['return_qty'])||parseInt(_0x3662cb[_0x34a494(0x135)])<parseInt(_0x3662cb[_0x34a494(0x13c)])&&parseInt(_0x3662cb[_0x34a494(0x13e)])>parseInt(_0x3662cb[_0x34a494(0x13c)])||parseInt(_0x3662cb[_0x34a494(0x13c)])==0x0)&&_0x211190++;});if(_0x211190!=0x0)return _0x531520[_0x10d9e6(0x12c)](_0x10d9e6(0x139),_0x10d9e6(0x137)),_0x14b47f[_0x10d9e6(0x13a)](_0x10d9e6(0xe2));_0x1a90de[_0x10d9e6(0x127)][_0x10d9e6(0xfe)](_0x20a225=>{var _0x214aa1=_0x10d9e6;const _0x258864=_0x353d62[_0x214aa1(0xdd)][_0x214aa1(0x11b)](_0x11ee68=>{var _0x388be1=_0x214aa1;_0x11ee68['product_name']==_0x20a225['product_name']&&_0x11ee68[_0x388be1(0xfb)]==_0x20a225[_0x388be1(0xfb)]&&_0x11ee68[_0x388be1(0x105)]==_0x20a225[_0x388be1(0x105)]&&_0x11ee68[_0x388be1(0xe9)]==_0x20a225['bin']&&_0x11ee68[_0x388be1(0x12a)]==_0x20a225[_0x388be1(0x12a)]&&(_0x11ee68['product_stock']=parseInt(_0x11ee68[_0x388be1(0xdf)])+parseInt(_0x20a225[_0x388be1(0x13c)]));});}),console[_0x10d9e6(0x122)](_0x10d9e6(0x142),_0x353d62),await _0x353d62['save'](),_0x1a90de['invoice']=_0x683bb7,_0x1a90de[_0x10d9e6(0x11a)]=_0x3b8996,_0x1a90de[_0x10d9e6(0xec)]=_0x435772,_0x1a90de['warehouse_name']=_0x1095e9,_0x1a90de['return_sale']=_0x451610,_0x1a90de[_0x10d9e6(0x10c)]=_0x286b54,_0x1a90de[_0x10d9e6(0xd4)]=_0x559292,_0x1a90de['ToRoom']=_0x514499;const _0x19d03f=await _0x1a90de['save']();console[_0x10d9e6(0x122)](_0x10d9e6(0x11e),_0x19d03f);const _0xc1c23e=await c_payment_data[_0x10d9e6(0xf4)]({'invoice':_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xee)],'reason':_0x10d9e6(0xdc)});_0xc1c23e[_0x10d9e6(0x113)]=_0x531520['body'][_0x10d9e6(0x113)],_0xc1c23e[_0x10d9e6(0xec)]=_0x531520[_0x10d9e6(0x13f)][_0x10d9e6(0xec)],await _0xc1c23e['save'](),_0x531520[_0x10d9e6(0x12c)](_0x10d9e6(0xd8),_0x10d9e6(0xe5)),_0x14b47f['redirect'](_0x10d9e6(0xde));}catch(_0x1d5d99){console[_0x10d9e6(0x122)](_0x1d5d99),_0x14b47f[_0x10d9e6(0x100)](0xc8)[_0x10d9e6(0xfc)]({'message':_0x1d5d99[_0x10d9e6(0x147)]});}}),router[a0_0x420ae6(0x10e)](a0_0x420ae6(0x118),auth,async(_0x3bb00d,_0x528fac)=>{var _0x134e85=a0_0x420ae6;try{const _0x5d6d43=_0x3bb00d[_0x134e85(0x138)]['id'],{invoice:_0x4f8843,customer:_0x3e80a6,payable_to_customer:_0x46017c,paid_amount:_0x2718fa}=_0x3bb00d['body'],_0x4c7f30=await sales_return[_0x134e85(0x132)](_0x5d6d43);console[_0x134e85(0x122)](_0x134e85(0xed),_0x4c7f30),console[_0x134e85(0x122)](_0x46017c),console[_0x134e85(0x122)](_0x2718fa);var _0x508e0f=_0x46017c-_0x2718fa;console[_0x134e85(0x122)](_0x134e85(0x125),_0x508e0f),_0x4c7f30[_0x134e85(0x140)]=parseFloat(_0x2718fa)+parseFloat(_0x4c7f30[_0x134e85(0x140)]),_0x4c7f30[_0x134e85(0x131)]=_0x508e0f,console[_0x134e85(0x122)](_0x4c7f30);const _0x3a6bf4=await _0x4c7f30[_0x134e85(0xe3)]();console[_0x134e85(0x122)](0x1b207);const _0x1a05ec=await c_payment_data['findOne']({'invoice':_0x3bb00d[_0x134e85(0x13f)][_0x134e85(0xee)],'reason':_0x134e85(0xdc)});console[_0x134e85(0x122)](_0x134e85(0x108),_0x1a05ec),_0x1a05ec[_0x134e85(0xea)]=_0x508e0f,await _0x1a05ec[_0x134e85(0xe3)]();let _0x18dc9b=new Date(),_0x168369=('0'+_0x18dc9b['getDate']())['slice'](-0x2),_0x2f2bf4=('0'+(_0x18dc9b[_0x134e85(0x11c)]()+0x1))[_0x134e85(0x111)](-0x2),_0x547617=_0x18dc9b['getFullYear'](),_0xc9190f=_0x547617+'-'+_0x2f2bf4+'-'+_0x168369;const _0x10eedf=new customer_payment({'invoice':_0x4f8843,'date':_0x547617+'-'+_0x2f2bf4+'-'+_0x168369,'customer':_0x3e80a6,'reason':'Returned\x20Payment\x20For\x20Sale\x20Return','amount':_0x2718fa}),_0x4e75f3=await _0x10eedf['save']();_0x3bb00d[_0x134e85(0x12c)](_0x134e85(0xd8),_0x134e85(0xe7)),_0x528fac['redirect'](_0x134e85(0xde));}catch(_0x32d7ee){console['log'](_0x32d7ee);}}),router['get'](a0_0x420ae6(0xf1),auth,async(_0x1be6e3,_0x37c1fd)=>{var _0x4f795f=a0_0x420ae6;try{const {username:_0x4fb206,email:_0x22ad98,role:_0x3dce09}=_0x1be6e3[_0x4f795f(0xd5)],_0x1ff974=_0x1be6e3[_0x4f795f(0xd5)],_0x25eeb2=await profile[_0x4f795f(0xf4)]({'email':_0x1ff974[_0x4f795f(0x10a)]}),_0x494c8a=await master_shop[_0x4f795f(0x114)]();console[_0x4f795f(0x122)](_0x4f795f(0x110),_0x494c8a);const _0x24b8eb=_0x1be6e3[_0x4f795f(0x138)]['id'],_0x1083c5=await sales_return[_0x4f795f(0x132)](_0x24b8eb);console['log'](_0x1083c5);const _0x222e65=await customer[_0x4f795f(0xf4)]({'name':_0x1083c5[_0x4f795f(0x11a)]});console[_0x4f795f(0x122)](_0x222e65);if(_0x494c8a[0x0]['language']==_0x4f795f(0x116)){var _0xfcb778=users[_0x4f795f(0x104)];console['log'](_0xfcb778);}else{if(_0x494c8a[0x0][_0x4f795f(0x126)]==_0x4f795f(0x141))var _0xfcb778=users[_0x4f795f(0x141)];else{if(_0x494c8a[0x0]['language']==_0x4f795f(0x13b))var _0xfcb778=users[_0x4f795f(0x13b)];else{if(_0x494c8a[0x0][_0x4f795f(0x126)]=='Spanish')var _0xfcb778=users[_0x4f795f(0xe0)];else{if(_0x494c8a[0x0][_0x4f795f(0x126)]==_0x4f795f(0x146))var _0xfcb778=users[_0x4f795f(0x146)];else{if(_0x494c8a[0x0][_0x4f795f(0x126)]==_0x4f795f(0x143))var _0xfcb778=users[_0x4f795f(0x11f)];else{if(_0x494c8a[0x0][_0x4f795f(0x126)]==_0x4f795f(0x148))var _0xfcb778=users['Chinese'];else{if(_0x494c8a[0x0][_0x4f795f(0x126)]==_0x4f795f(0x12f))var _0xfcb778=users['Arabic'];}}}}}}}_0x37c1fd[_0x4f795f(0x121)]('sales_return_invoice',{'success':_0x1be6e3[_0x4f795f(0x12c)](_0x4f795f(0xd8)),'errors':_0x1be6e3['flash'](_0x4f795f(0x139)),'role':_0x1ff974,'profile':_0x25eeb2,'master_shop':_0x494c8a,'customers':_0x222e65,'sales':_0x1083c5,'language':_0xfcb778});}catch(_0x2ec959){console[_0x4f795f(0x122)](_0x2ec959);}}),module['exports']=router;