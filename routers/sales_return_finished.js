var a0_0x2ad0e8=a0_0x3e2d;(function(_0x24cf34,_0x27ce53){var _0xc7563d=a0_0x3e2d,_0x50b08a=_0x24cf34();while(!![]){try{var _0xb16591=-parseInt(_0xc7563d(0xb4))/0x1+parseInt(_0xc7563d(0xc7))/0x2+-parseInt(_0xc7563d(0xae))/0x3+parseInt(_0xc7563d(0xb1))/0x4+parseInt(_0xc7563d(0xca))/0x5+-parseInt(_0xc7563d(0x76))/0x6+-parseInt(_0xc7563d(0x8c))/0x7;if(_0xb16591===_0x27ce53)break;else _0x50b08a['push'](_0x50b08a['shift']());}catch(_0xca77b){_0x50b08a['push'](_0x50b08a['shift']());}}}(a0_0x418a,0x80c92));function a0_0x3e2d(_0xabb70,_0x43d373){var _0x418ad5=a0_0x418a();return a0_0x3e2d=function(_0x3e2d92,_0x4d005e){_0x3e2d92=_0x3e2d92-0x6f;var _0xc08443=_0x418ad5[_0x3e2d92];return _0xc08443;},a0_0x3e2d(_0xabb70,_0x43d373);}function a0_0x418a(){var _0x1e5a3d=['product_details','get','save','product_stock','French','findById','email','status','product_code','stock','customer','stocks','/view','../models/all_models','sales_return_invoice','bin','293976pQaQGe','Portuguese','language','floorlevel','map','$product_details.rack','product_code_QA','Arabic','$product_details.bay','../middleware/auth','types','stocks_QA','secondary_code_QA','sales_quantity','/invoice/:id','find','product_name_QA','string','$product_details.bin','type','old_warehouse_data','back','5473048xuJfsE','note','return_qty','getMonth','Portuguese\x20(BR)','data','suppliers','payment\x20successfull','render','$product_details.primary_code','primary_code','$customer_docs','bay','post','findOne','Finished\x20Goods','Return\x20Rooms','secondary_code','errors','$product_details.type','ToRoom','subtract','/sales_return_finished/view','forEach','Hindi','foreach\x20newproduct','due_amount','getDate','English\x20(US)','old_data','$product_details.product_stock','$product_details.floorlevel','return_sale_edit_finished','body','471408LLQXzi','primary_code_QA','Enabled','3188036Esldrm','return_qty_QA','Spanish','371467ySRXhF','Router','ToWarehouse','return_sale','/give_payment/:id','sales_quantity_QA','flash','message','Sale\x20Return','success','/view/:id','redirect','json','sales_return_finished','../public/language/languages.json','params','product_name','customers','sale_qty','414890epPQFV','getFullYear','warehouse_name','4412575KtobrH','invoice','user','/sales_return/view','c_payment','Chinese','log','$name','English','Arabic\x20(ae)','master','purchase\x20return\x20successfully','German','date','express','aggregate'];a0_0x418a=function(){return _0x1e5a3d;};return a0_0x418a();}const express=require(a0_0x2ad0e8(0xd8)),app=express(),router=express[a0_0x2ad0e8(0xb5)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x2ad0e8(0x73)),auth=require(a0_0x2ad0e8(0x7f)),users=require(a0_0x2ad0e8(0xc2));router[a0_0x2ad0e8(0xdb)](a0_0x2ad0e8(0x72),auth,async(_0x364d8c,_0x4211b0)=>{var _0x4de934=a0_0x2ad0e8;try{const {username:_0x4ec788,email:_0x172362,role:_0x245d86}=_0x364d8c[_0x4de934(0xcc)],_0x455c14=_0x364d8c[_0x4de934(0xcc)],_0x52f231=await profile[_0x4de934(0x9a)]({'email':_0x455c14[_0x4de934(0xe0)]}),_0x32512f=await master_shop[_0x4de934(0x85)](),_0x28a180=await sales_return_finished[_0x4de934(0xd9)]([{'$lookup':{'from':_0x4de934(0xc5),'localField':_0x4de934(0x70),'foreignField':'name','as':'customer_docs'}},{'$unwind':_0x4de934(0x97)}]);if(_0x32512f[0x0][_0x4de934(0x78)]==_0x4de934(0xa8)){var _0x57ab16=users['English'];console[_0x4de934(0xd0)](_0x57ab16);}else{if(_0x32512f[0x0][_0x4de934(0x78)]==_0x4de934(0xa4))var _0x57ab16=users['Hindi'];else{if(_0x32512f[0x0][_0x4de934(0x78)]==_0x4de934(0xd6))var _0x57ab16=users[_0x4de934(0xd6)];else{if(_0x32512f[0x0]['language']==_0x4de934(0xb3))var _0x57ab16=users['Spanish'];else{if(_0x32512f[0x0][_0x4de934(0x78)]==_0x4de934(0xde))var _0x57ab16=users['French'];else{if(_0x32512f[0x0][_0x4de934(0x78)]==_0x4de934(0x90))var _0x57ab16=users['Portuguese'];else{if(_0x32512f[0x0]['language']=='Chinese')var _0x57ab16=users[_0x4de934(0xcf)];else{if(_0x32512f[0x0]['language']=='Arabic\x20(ae)')var _0x57ab16=users[_0x4de934(0x7d)];}}}}}}}_0x4211b0[_0x4de934(0x94)](_0x4de934(0xc1),{'success':_0x364d8c[_0x4de934(0xba)](_0x4de934(0xbd)),'errors':_0x364d8c[_0x4de934(0xba)]('errors'),'role':_0x455c14,'profile':_0x52f231,'master_shop':_0x32512f,'user':_0x28a180,'language':_0x57ab16});}catch(_0x5ace5a){console[_0x4de934(0xd0)](_0x5ace5a);}}),router['get']('/view/:id',auth,async(_0x5c00f7,_0x285b61)=>{var _0x3bce50=a0_0x2ad0e8;try{const {username:_0x2ea994,email:_0x1b14f8,role:_0x57d620}=_0x5c00f7[_0x3bce50(0xcc)],_0x289fc6=_0x5c00f7[_0x3bce50(0xcc)],_0x303036=await profile[_0x3bce50(0x9a)]({'email':_0x289fc6[_0x3bce50(0xe0)]}),_0x167860=await master_shop[_0x3bce50(0x85)]();console['log'](_0x3bce50(0xd4),_0x167860);const _0x402cfe=_0x5c00f7[_0x3bce50(0xc3)]['id'];console[_0x3bce50(0xd0)](_0x402cfe);var _0x1a91e9=[_0x3bce50(0x9c)];const _0x341479=await sales_return_finished['findById'](_0x402cfe),_0x3349f2=await warehouse[_0x3bce50(0xd9)]([{'$match':{'name':_0x341479[_0x3bce50(0xb6)],'room':_0x341479[_0x3bce50(0xa0)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3bce50(0xaa)},'bay':{'$first':_0x3bce50(0x7e)},'bin':{'$first':_0x3bce50(0x88)},'type':{'$first':_0x3bce50(0x9f)},'floorlevel':{'$first':_0x3bce50(0xab)},'primary_code':{'$first':_0x3bce50(0x95)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3bce50(0x7b)}}}]);console[_0x3bce50(0xd0)](_0x3349f2);const _0x3f338c=await warehouse['aggregate']([{'$match':{'status':_0x3bce50(0xb0),'warehouse_category':_0x3bce50(0x9b)}},{'$group':{'_id':_0x3bce50(0xd1),'name':{'$first':_0x3bce50(0xd1)}}},{'$sort':{'name':0x1}}]),_0x4af6df=await warehouse[_0x3bce50(0xd9)]([{'$match':{'status':_0x3bce50(0xb0),'name':'QA\x20Warehouse'}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x59730e=await product['find']({});if(_0x167860[0x0][_0x3bce50(0x78)]==_0x3bce50(0xa8)){var _0x55d903=users[_0x3bce50(0xd2)];console[_0x3bce50(0xd0)](_0x55d903);}else{if(_0x167860[0x0][_0x3bce50(0x78)]==_0x3bce50(0xa4))var _0x55d903=users['Hindi'];else{if(_0x167860[0x0][_0x3bce50(0x78)]==_0x3bce50(0xd6))var _0x55d903=users[_0x3bce50(0xd6)];else{if(_0x167860[0x0][_0x3bce50(0x78)]==_0x3bce50(0xb3))var _0x55d903=users[_0x3bce50(0xb3)];else{if(_0x167860[0x0][_0x3bce50(0x78)]==_0x3bce50(0xde))var _0x55d903=users[_0x3bce50(0xde)];else{if(_0x167860[0x0][_0x3bce50(0x78)]==_0x3bce50(0x90))var _0x55d903=users['Portuguese'];else{if(_0x167860[0x0][_0x3bce50(0x78)]=='Chinese')var _0x55d903=users[_0x3bce50(0xcf)];else{if(_0x167860[0x0][_0x3bce50(0x78)]==_0x3bce50(0xd3))var _0x55d903=users[_0x3bce50(0x7d)];}}}}}}}_0x285b61[_0x3bce50(0x94)](_0x3bce50(0xac),{'success':_0x5c00f7[_0x3bce50(0xba)](_0x3bce50(0xbd)),'errors':_0x5c00f7[_0x3bce50(0xba)]('errors'),'role':_0x289fc6,'profile':_0x303036,'master_shop':_0x167860,'user':_0x341479,'stock':_0x3349f2,'unit':_0x59730e,'language':_0x55d903,'warehouses':_0x3f338c,'rooms':_0x1a91e9,'warehouse_QA':_0x4af6df});}catch(_0x5d11ec){console[_0x3bce50(0xd0)](_0x5d11ec);}}),router[a0_0x2ad0e8(0x99)](a0_0x2ad0e8(0xbe),auth,async(_0x31c415,_0x4986c1)=>{var _0x266815=a0_0x2ad0e8;if(_0x31c415[_0x266815(0xad)]['for_categorize']=='QA')try{const _0x179ae6=_0x31c415[_0x266815(0xc3)]['id'],_0x24c62c=await sales_return['findOne']({'invoice':_0x31c415[_0x266815(0xad)][_0x266815(0xcb)]}),_0x10e671=await warehouse[_0x266815(0x9a)]({'name':_0x24c62c[_0x266815(0xb6)],'room':_0x24c62c[_0x266815(0xa0)]}),{invoice:_0x345bec,customer:_0x3da483,date:_0x52e871,warehouse_name:_0x1921a9,product_name:_0x1cda89,primary_code:_0x137a5d,secondary_code:_0x2a0bc7,product_code:_0x20a87b,sales_quantity:_0x1c9e6e,stocks:_0x2e4b2f,return_qty:_0x2244e5,note:_0x1a4f15,to_warehouse_name_QA:_0x41fce1,to_Room_name_QA:_0x1f85b0}=_0x31c415[_0x266815(0xad)];if(typeof product_name_QA==_0x266815(0x87))var _0x28ef6f=[_0x31c415[_0x266815(0xad)][_0x266815(0x86)]],_0x27e96b=[_0x31c415[_0x266815(0xad)][_0x266815(0xaf)]],_0x152fc6=[_0x31c415['body'][_0x266815(0x82)]],_0x464aef=[_0x31c415[_0x266815(0xad)][_0x266815(0x7c)]],_0x2fef28=[_0x31c415[_0x266815(0xad)]['sales_quantity_QA']],_0x2ece94=[_0x31c415[_0x266815(0xad)][_0x266815(0x81)]],_0x739b2a=[_0x31c415[_0x266815(0xad)]['return_qty_QA']];else var _0x28ef6f=[..._0x31c415[_0x266815(0xad)][_0x266815(0x86)]],_0x27e96b=[..._0x31c415[_0x266815(0xad)][_0x266815(0xaf)]],_0x152fc6=[..._0x31c415[_0x266815(0xad)][_0x266815(0x82)]],_0x464aef=[..._0x31c415[_0x266815(0xad)][_0x266815(0x7c)]],_0x2fef28=[..._0x31c415[_0x266815(0xad)][_0x266815(0xb9)]],_0x2ece94=[..._0x31c415['body']['stocks_QA']],_0x739b2a=[..._0x31c415[_0x266815(0xad)][_0x266815(0xb2)]];const _0x3c412a=_0x28ef6f[_0x266815(0x7a)](_0x29b388=>{return _0x29b388={'product_name':_0x29b388};});_0x27e96b[_0x266815(0xa3)]((_0x4ae131,_0x4b2e38)=>{var _0x1a7c87=_0x266815;_0x3c412a[_0x4b2e38][_0x1a7c87(0x96)]=_0x4ae131;}),_0x152fc6[_0x266815(0xa3)]((_0x2f5293,_0x165213)=>{var _0x50a412=_0x266815;_0x3c412a[_0x165213][_0x50a412(0x9d)]=_0x2f5293;}),_0x464aef['forEach']((_0x547179,_0x2b3c44)=>{var _0x25f1bd=_0x266815;_0x3c412a[_0x2b3c44][_0x25f1bd(0xe2)]=_0x547179;}),_0x2fef28[_0x266815(0xa3)]((_0x3b68fc,_0x111197)=>{var _0x1d0f0b=_0x266815;_0x3c412a[_0x111197][_0x1d0f0b(0xc6)]=_0x3b68fc;}),_0x2ece94['forEach']((_0x185bef,_0x43cef8)=>{_0x3c412a[_0x43cef8]['stock']=_0x185bef;}),_0x739b2a['forEach']((_0x3f6b49,_0x92d186)=>{var _0x5dbb7b=_0x266815;_0x3c412a[_0x92d186][_0x5dbb7b(0x8e)]=_0x3f6b49;}),_0x24c62c['return_sale_QA'][_0x266815(0xa3)](_0x21b654=>{const _0x276c35=_0x10e671['product_details']['map'](_0x144358=>{var _0xe7d277=a0_0x3e2d;_0x144358[_0xe7d277(0xc4)]==_0x21b654[_0xe7d277(0xc4)]&&(_0x144358[_0xe7d277(0xdd)]=parseInt(_0x144358[_0xe7d277(0xdd)])+parseInt(_0x21b654[_0xe7d277(0x8e)]));});}),await _0x10e671[_0x266815(0xdc)](),_0x24c62c[_0x266815(0xcb)]=_0x345bec,_0x24c62c[_0x266815(0x70)]=_0x3da483,_0x24c62c['date']=_0x52e871,_0x24c62c['warehouse_name']=_0x1921a9,_0x24c62c['return_sale_QA']=_0x3c412a,_0x24c62c[_0x266815(0x8d)]=_0x1a4f15,_0x24c62c[_0x266815(0xb6)]=_0x41fce1,_0x24c62c['ToRoom']=_0x1f85b0;const _0x3b3b43=await _0x24c62c[_0x266815(0xdc)](),_0x21e32c=await c_payment_data[_0x266815(0x9a)]({'invoice':_0x31c415[_0x266815(0xad)][_0x266815(0xcb)],'reason':_0x266815(0xbc)});_0x21e32c[_0x266815(0x92)]=_0x31c415[_0x266815(0xad)]['suppliers'],_0x21e32c[_0x266815(0xd7)]=_0x31c415[_0x266815(0xad)][_0x266815(0xd7)],await _0x21e32c[_0x266815(0xdc)](),_0x31c415['flash']('success','purchase\x20return\x20successfully'),_0x4986c1[_0x266815(0xbf)](_0x266815(0xa2));}catch(_0xf9788){console[_0x266815(0xd0)](_0xf9788),_0x4986c1[_0x266815(0xe1)](0xc8)[_0x266815(0xc0)]({'message':_0xf9788[_0x266815(0xbb)]});}else try{const _0xa13a8=_0x31c415[_0x266815(0xc3)]['id'];console['log'](_0xa13a8);const _0xaf553=await sales_return['findOne']({'invoice':_0x31c415['body'][_0x266815(0xcb)]});console['log'](_0x266815(0xa9),_0xaf553);const _0x216e37=await warehouse[_0x266815(0x9a)]({'name':_0xaf553[_0x266815(0xb6)],'room':_0xaf553[_0x266815(0xa0)]});console['log']('old_warehouse_data',_0x216e37);const {invoice:_0x43fe1,customer:_0x36b30c,date:_0x5871bc,warehouse_name:_0x4098d3,product_name:_0x5e608a,primary_code:_0x16f0e9,secondary_code:_0x328885,product_code:_0x220290,sales_quantity:_0x1d02e1,stocks:_0x4ca794,return_qty:_0x78040a,note:_0x51cb45,to_warehouse_name:_0x923506,to_Room_name:_0x12afd8}=_0x31c415['body'];console[_0x266815(0xd0)](_0x31c415[_0x266815(0xad)]);if(typeof _0x5e608a=='string')var _0x28ef6f=[_0x31c415[_0x266815(0xad)][_0x266815(0xc4)]],_0x27e96b=[_0x31c415[_0x266815(0xad)][_0x266815(0x96)]],_0x152fc6=[_0x31c415[_0x266815(0xad)][_0x266815(0x9d)]],_0x464aef=[_0x31c415['body'][_0x266815(0xe2)]],_0x2fef28=[_0x31c415[_0x266815(0xad)][_0x266815(0x83)]],_0x2ece94=[_0x31c415[_0x266815(0xad)]['stocks']],_0x739b2a=[_0x31c415[_0x266815(0xad)][_0x266815(0x8e)]],_0xe98f34=[_0x31c415[_0x266815(0xad)][_0x266815(0x98)]],_0x549747=[_0x31c415[_0x266815(0xad)][_0x266815(0x75)]],_0x34f86c=[_0x31c415[_0x266815(0xad)][_0x266815(0x80)]],_0x57621f=[_0x31c415[_0x266815(0xad)][_0x266815(0x79)]];else var _0x28ef6f=[..._0x31c415[_0x266815(0xad)][_0x266815(0xc4)]],_0x27e96b=[..._0x31c415[_0x266815(0xad)]['primary_code']],_0x152fc6=[..._0x31c415[_0x266815(0xad)][_0x266815(0x9d)]],_0x464aef=[..._0x31c415['body'][_0x266815(0xe2)]],_0x2fef28=[..._0x31c415[_0x266815(0xad)][_0x266815(0x83)]],_0x2ece94=[..._0x31c415['body'][_0x266815(0x71)]],_0x739b2a=[..._0x31c415['body'][_0x266815(0x8e)]],_0xe98f34=[..._0x31c415[_0x266815(0xad)][_0x266815(0x98)]],_0x549747=[..._0x31c415[_0x266815(0xad)]['bin']],_0x34f86c=[..._0x31c415['body'][_0x266815(0x80)]],_0x57621f=[..._0x31c415[_0x266815(0xad)]['floorlevel']];const _0x2eccf7=_0x28ef6f[_0x266815(0x7a)](_0x11c1fb=>{return _0x11c1fb={'product_name':_0x11c1fb};});_0x27e96b[_0x266815(0xa3)]((_0x5c058e,_0x37d789)=>{var _0x47194b=_0x266815;_0x2eccf7[_0x37d789][_0x47194b(0x96)]=_0x5c058e;}),_0x152fc6[_0x266815(0xa3)]((_0x23c64a,_0x5aec4e)=>{var _0x41bf63=_0x266815;_0x2eccf7[_0x5aec4e][_0x41bf63(0x9d)]=_0x23c64a;}),_0x464aef[_0x266815(0xa3)]((_0x20f912,_0x2ec401)=>{var _0x41d2e6=_0x266815;_0x2eccf7[_0x2ec401][_0x41d2e6(0xe2)]=_0x20f912;}),_0x2fef28[_0x266815(0xa3)]((_0x1a7084,_0x151c5c)=>{var _0x594f72=_0x266815;_0x2eccf7[_0x151c5c][_0x594f72(0xc6)]=_0x1a7084;}),_0x2ece94['forEach']((_0x2f1aa8,_0x130536)=>{var _0x1e21a3=_0x266815;_0x2eccf7[_0x130536][_0x1e21a3(0x6f)]=_0x2f1aa8;}),_0x739b2a['forEach']((_0x24a043,_0x2c4751)=>{_0x2eccf7[_0x2c4751]['return_qty']=_0x24a043;}),_0xe98f34[_0x266815(0xa3)]((_0x500e57,_0x84399e)=>{_0x2eccf7[_0x84399e]['bay']=_0x500e57;}),_0x549747[_0x266815(0xa3)]((_0x5e4bd5,_0x3f022e)=>{var _0x2a19d6=_0x266815;_0x2eccf7[_0x3f022e][_0x2a19d6(0x75)]=_0x5e4bd5;}),_0x34f86c[_0x266815(0xa3)]((_0x3e9ea3,_0x2b8b48)=>{var _0x1a0a36=_0x266815;_0x2eccf7[_0x2b8b48][_0x1a0a36(0x89)]=_0x3e9ea3;}),_0x57621f[_0x266815(0xa3)]((_0x784814,_0x2a4f54)=>{var _0xe56da7=_0x266815;_0x2eccf7[_0x2a4f54][_0xe56da7(0x79)]=_0x784814;});var _0xe0c89b=0x0;_0x2eccf7[_0x266815(0xa3)](_0x1f2e7c=>{var _0x26c34b=_0x266815;console[_0x26c34b(0xd0)](_0x26c34b(0xa5),_0x1f2e7c),(parseInt(_0x1f2e7c[_0x26c34b(0xc6)])<parseInt(_0x1f2e7c[_0x26c34b(0x8e)])||parseInt(_0x1f2e7c['stock'])<parseInt(_0x1f2e7c['return_qty'])&&parseInt(_0x1f2e7c[_0x26c34b(0xc6)])>parseInt(_0x1f2e7c[_0x26c34b(0x8e)])||parseInt(_0x1f2e7c[_0x26c34b(0x8e)])==0x0)&&_0xe0c89b++;});if(_0xe0c89b!=0x0)return _0x31c415['flash']('errors','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x4986c1[_0x266815(0xbf)](_0x266815(0x8b));_0xaf553[_0x266815(0xb7)]['forEach'](_0x230d7e=>{var _0x22d789=_0x266815;const _0x14cbed=_0x216e37[_0x22d789(0xda)][_0x22d789(0x7a)](_0x166db2=>{var _0x3eed7c=_0x22d789;_0x166db2[_0x3eed7c(0xc4)]==_0x230d7e[_0x3eed7c(0xc4)]&&_0x166db2[_0x3eed7c(0x79)]==_0x230d7e['floorlevel']&&_0x166db2['type']==_0x230d7e['type']&&_0x166db2[_0x3eed7c(0x75)]==_0x230d7e[_0x3eed7c(0x75)]&&_0x166db2[_0x3eed7c(0x98)]==_0x230d7e[_0x3eed7c(0x98)]&&(_0x166db2[_0x3eed7c(0xdd)]=parseInt(_0x166db2[_0x3eed7c(0xdd)])+parseInt(_0x230d7e[_0x3eed7c(0x8e)]));});}),console['log'](_0x266815(0x8a),_0x216e37),await _0x216e37['save'](),_0xaf553[_0x266815(0xcb)]=_0x43fe1,_0xaf553[_0x266815(0x70)]=_0x36b30c,_0xaf553[_0x266815(0xd7)]=_0x5871bc,_0xaf553[_0x266815(0xc9)]=_0x4098d3,_0xaf553['return_sale']=_0x2eccf7,_0xaf553[_0x266815(0x8d)]=_0x51cb45,_0xaf553['ToWarehouse']=_0x923506,_0xaf553[_0x266815(0xa0)]=_0x12afd8;const _0x44aa1e=await _0xaf553[_0x266815(0xdc)]();console[_0x266815(0xd0)]('new\x20new_data',_0x44aa1e);const _0x448d4d=await c_payment_data[_0x266815(0x9a)]({'invoice':_0x31c415[_0x266815(0xad)][_0x266815(0xcb)],'reason':_0x266815(0xbc)});_0x448d4d['suppliers']=_0x31c415[_0x266815(0xad)][_0x266815(0x92)],_0x448d4d[_0x266815(0xd7)]=_0x31c415[_0x266815(0xad)][_0x266815(0xd7)],await _0x448d4d[_0x266815(0xdc)](),_0x31c415[_0x266815(0xba)](_0x266815(0xbd),_0x266815(0xd5)),_0x4986c1['redirect'](_0x266815(0xcd));}catch(_0x1b2c0b){console['log'](_0x1b2c0b),_0x4986c1[_0x266815(0xe1)](0xc8)[_0x266815(0xc0)]({'message':_0x1b2c0b[_0x266815(0xbb)]});}}),router[a0_0x2ad0e8(0x99)](a0_0x2ad0e8(0xb8),auth,async(_0x147af1,_0x57907e)=>{var _0x1edaa1=a0_0x2ad0e8;try{const _0x3fc004=_0x147af1[_0x1edaa1(0xc3)]['id'],{invoice:_0x4344d1,customer:_0x22135d,payable_to_customer:_0x4a4e00,paid_amount:_0x1fad96}=_0x147af1[_0x1edaa1(0xad)],_0x1d9bc8=await sales_return[_0x1edaa1(0xdf)](_0x3fc004);console[_0x1edaa1(0xd0)](_0x1edaa1(0x91),_0x1d9bc8),console['log'](_0x4a4e00),console[_0x1edaa1(0xd0)](_0x1fad96);var _0x5c45f6=_0x4a4e00-_0x1fad96;console['log'](_0x1edaa1(0xa1),_0x5c45f6),_0x1d9bc8['paid_amount']=parseFloat(_0x1fad96)+parseFloat(_0x1d9bc8['paid_amount']),_0x1d9bc8[_0x1edaa1(0xa6)]=_0x5c45f6,console[_0x1edaa1(0xd0)](_0x1d9bc8);const _0x45fcde=await _0x1d9bc8[_0x1edaa1(0xdc)]();console[_0x1edaa1(0xd0)](0x1b207);const _0x72e923=await c_payment_data[_0x1edaa1(0x9a)]({'invoice':_0x147af1[_0x1edaa1(0xad)][_0x1edaa1(0xcb)],'reason':_0x1edaa1(0xbc)});console[_0x1edaa1(0xd0)](_0x1edaa1(0xce),_0x72e923),_0x72e923['amount']=_0x5c45f6,await _0x72e923[_0x1edaa1(0xdc)]();let _0x44584f=new Date(),_0x59903b=('0'+_0x44584f[_0x1edaa1(0xa7)]())['slice'](-0x2),_0x52bcfd=('0'+(_0x44584f[_0x1edaa1(0x8f)]()+0x1))['slice'](-0x2),_0x200641=_0x44584f[_0x1edaa1(0xc8)](),_0x8211d3=_0x200641+'-'+_0x52bcfd+'-'+_0x59903b;const _0x568e9f=new customer_payment({'invoice':_0x4344d1,'date':_0x200641+'-'+_0x52bcfd+'-'+_0x59903b,'customer':_0x22135d,'reason':'Returned\x20Payment\x20For\x20Sale\x20Return','amount':_0x1fad96}),_0x3cf48d=await _0x568e9f[_0x1edaa1(0xdc)]();_0x147af1[_0x1edaa1(0xba)]('success',_0x1edaa1(0x93)),_0x57907e[_0x1edaa1(0xbf)](_0x1edaa1(0xcd));}catch(_0x1979e7){console[_0x1edaa1(0xd0)](_0x1979e7);}}),router['get'](a0_0x2ad0e8(0x84),auth,async(_0x26b8f5,_0x5a428c)=>{var _0x36532d=a0_0x2ad0e8;try{const {username:_0x36165c,email:_0x26e0f5,role:_0x55b370}=_0x26b8f5['user'],_0x5ddf3f=_0x26b8f5[_0x36532d(0xcc)],_0x4b528e=await profile[_0x36532d(0x9a)]({'email':_0x5ddf3f[_0x36532d(0xe0)]}),_0x4e0fc6=await master_shop['find']();console[_0x36532d(0xd0)](_0x36532d(0xd4),_0x4e0fc6);const _0xf1cdcc=_0x26b8f5['params']['id'],_0x4b0ad0=await sales_return[_0x36532d(0xdf)](_0xf1cdcc);console['log'](_0x4b0ad0);const _0x3b6495=await customer[_0x36532d(0x9a)]({'name':_0x4b0ad0[_0x36532d(0x70)]});console[_0x36532d(0xd0)](_0x3b6495);if(_0x4e0fc6[0x0][_0x36532d(0x78)]==_0x36532d(0xa8)){var _0x4921f1=users[_0x36532d(0xd2)];console[_0x36532d(0xd0)](_0x4921f1);}else{if(_0x4e0fc6[0x0][_0x36532d(0x78)]==_0x36532d(0xa4))var _0x4921f1=users[_0x36532d(0xa4)];else{if(_0x4e0fc6[0x0][_0x36532d(0x78)]==_0x36532d(0xd6))var _0x4921f1=users[_0x36532d(0xd6)];else{if(_0x4e0fc6[0x0][_0x36532d(0x78)]==_0x36532d(0xb3))var _0x4921f1=users[_0x36532d(0xb3)];else{if(_0x4e0fc6[0x0][_0x36532d(0x78)]==_0x36532d(0xde))var _0x4921f1=users[_0x36532d(0xde)];else{if(_0x4e0fc6[0x0][_0x36532d(0x78)]==_0x36532d(0x90))var _0x4921f1=users[_0x36532d(0x77)];else{if(_0x4e0fc6[0x0][_0x36532d(0x78)]==_0x36532d(0xcf))var _0x4921f1=users['Chinese'];else{if(_0x4e0fc6[0x0][_0x36532d(0x78)]==_0x36532d(0xd3))var _0x4921f1=users[_0x36532d(0x7d)];}}}}}}}_0x5a428c[_0x36532d(0x94)](_0x36532d(0x74),{'success':_0x26b8f5[_0x36532d(0xba)](_0x36532d(0xbd)),'errors':_0x26b8f5[_0x36532d(0xba)](_0x36532d(0x9e)),'role':_0x5ddf3f,'profile':_0x4b528e,'master_shop':_0x4e0fc6,'customers':_0x3b6495,'sales':_0x4b0ad0,'language':_0x4921f1});}catch(_0x299220){console['log'](_0x299220);}}),module['exports']=router;