function a0_0x53ae(_0x5f1cbc,_0x37cf00){var _0x176c12=a0_0x176c();return a0_0x53ae=function(_0x53aed9,_0x1094fa){_0x53aed9=_0x53aed9-0x180;var _0x484726=_0x176c12[_0x53aed9];return _0x484726;},a0_0x53ae(_0x5f1cbc,_0x37cf00);}var a0_0x4bb042=a0_0x53ae;(function(_0x125891,_0x388acf){var _0x5c1908=a0_0x53ae,_0x10f0f4=_0x125891();while(!![]){try{var _0x59dd24=parseInt(_0x5c1908(0x1bc))/0x1*(-parseInt(_0x5c1908(0x19b))/0x2)+-parseInt(_0x5c1908(0x198))/0x3*(parseInt(_0x5c1908(0x1be))/0x4)+-parseInt(_0x5c1908(0x1e2))/0x5*(-parseInt(_0x5c1908(0x1df))/0x6)+-parseInt(_0x5c1908(0x1e4))/0x7+-parseInt(_0x5c1908(0x18f))/0x8+-parseInt(_0x5c1908(0x1b6))/0x9*(parseInt(_0x5c1908(0x1e0))/0xa)+parseInt(_0x5c1908(0x18d))/0xb;if(_0x59dd24===_0x388acf)break;else _0x10f0f4['push'](_0x10f0f4['shift']());}catch(_0x235fa5){_0x10f0f4['push'](_0x10f0f4['shift']());}}}(a0_0x176c,0x63dff));const express=require(a0_0x4bb042(0x1f4)),app=express(),router=express[a0_0x4bb042(0x1bf)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x4bb042(0x186)),auth=require('../middleware/auth'),users=require(a0_0x4bb042(0x18e));router[a0_0x4bb042(0x197)]('/view',auth,async(_0x1af2d2,_0x4e453c)=>{var _0x4028df=a0_0x4bb042;try{const {username:_0x2c4ceb,email:_0x2bd1d9,role:_0x52259e}=_0x1af2d2[_0x4028df(0x190)],_0x48d216=_0x1af2d2[_0x4028df(0x190)],_0x35bfa8=await profile[_0x4028df(0x1ea)]({'email':_0x48d216['email']}),_0x4fb0ec=await master_shop[_0x4028df(0x185)](),_0x52f25a=await sales_return_finished['aggregate']([{'$lookup':{'from':_0x4028df(0x1c0),'localField':_0x4028df(0x184),'foreignField':_0x4028df(0x180),'as':'customer_docs'}},{'$unwind':_0x4028df(0x1cd)}]);if(_0x4fb0ec[0x0]['language']==_0x4028df(0x189)){var _0x5f0a10=users['English'];console['log'](_0x5f0a10);}else{if(_0x4fb0ec[0x0][_0x4028df(0x1a5)]==_0x4028df(0x1b7))var _0x5f0a10=users['Hindi'];else{if(_0x4fb0ec[0x0][_0x4028df(0x1a5)]==_0x4028df(0x1af))var _0x5f0a10=users['German'];else{if(_0x4fb0ec[0x0][_0x4028df(0x1a5)]==_0x4028df(0x1b2))var _0x5f0a10=users[_0x4028df(0x1b2)];else{if(_0x4fb0ec[0x0][_0x4028df(0x1a5)]=='French')var _0x5f0a10=users[_0x4028df(0x1a6)];else{if(_0x4fb0ec[0x0][_0x4028df(0x1a5)]==_0x4028df(0x1a4))var _0x5f0a10=users[_0x4028df(0x1b3)];else{if(_0x4fb0ec[0x0]['language']==_0x4028df(0x18a))var _0x5f0a10=users[_0x4028df(0x18a)];else{if(_0x4fb0ec[0x0][_0x4028df(0x1a5)]=='Arabic\x20(ae)')var _0x5f0a10=users[_0x4028df(0x195)];}}}}}}}_0x4e453c[_0x4028df(0x1ca)](_0x4028df(0x1b8),{'success':_0x1af2d2['flash']('success'),'errors':_0x1af2d2['flash'](_0x4028df(0x1d0)),'role':_0x48d216,'profile':_0x35bfa8,'master_shop':_0x4fb0ec,'user':_0x52f25a,'language':_0x5f0a10});}catch(_0x2a90c8){console[_0x4028df(0x1c5)](_0x2a90c8);}}),router[a0_0x4bb042(0x197)]('/view/:id',auth,async(_0x304ed0,_0x28c4c2)=>{var _0x12a4fc=a0_0x4bb042;try{const {username:_0x18d533,email:_0x4e64b,role:_0x38611e}=_0x304ed0['user'],_0x9f3857=_0x304ed0[_0x12a4fc(0x190)],_0x313948=await profile['findOne']({'email':_0x9f3857['email']}),_0x250dc2=await master_shop[_0x12a4fc(0x185)]();console[_0x12a4fc(0x1c5)](_0x12a4fc(0x1e7),_0x250dc2);const _0x444cbb=_0x304ed0[_0x12a4fc(0x1a8)]['id'];console[_0x12a4fc(0x1c5)](_0x444cbb);var _0x3c4ec9=[_0x12a4fc(0x1c6)];const _0x5ba655=await sales_return_finished[_0x12a4fc(0x1b4)](_0x444cbb),_0x4d732c=await warehouse[_0x12a4fc(0x1e3)]([{'$match':{'name':_0x5ba655['ToWarehouse'],'room':_0x5ba655[_0x12a4fc(0x1ed)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x12a4fc(0x1d4)},'product_stock':{'$first':_0x12a4fc(0x1bd)},'bay':{'$first':_0x12a4fc(0x188)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x12a4fc(0x1fa)},'floorlevel':{'$first':_0x12a4fc(0x1c1)},'primary_code':{'$first':_0x12a4fc(0x1b9)},'secondary_code':{'$first':_0x12a4fc(0x1ec)},'product_code':{'$first':_0x12a4fc(0x1bb)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x12a4fc(0x1de)}}}]);console['log'](_0x4d732c);const _0x38f66a=await warehouse[_0x12a4fc(0x1e3)]([{'$match':{'status':'Enabled','warehouse_category':_0x12a4fc(0x19c)}},{'$group':{'_id':_0x12a4fc(0x1f8),'name':{'$first':_0x12a4fc(0x1f8)}}},{'$sort':{'name':0x1}}]),_0x4cbd34=await warehouse[_0x12a4fc(0x1e3)]([{'$match':{'status':_0x12a4fc(0x1d9),'name':'QA\x20Warehouse'}},{'$group':{'_id':'$name','name':{'$first':_0x12a4fc(0x1f8)}}},{'$sort':{'name':0x1}}]),_0x256d4d=await product[_0x12a4fc(0x185)]({});if(_0x250dc2[0x0][_0x12a4fc(0x1a5)]==_0x12a4fc(0x189)){var _0x3e3051=users[_0x12a4fc(0x1cc)];console[_0x12a4fc(0x1c5)](_0x3e3051);}else{if(_0x250dc2[0x0][_0x12a4fc(0x1a5)]==_0x12a4fc(0x1b7))var _0x3e3051=users[_0x12a4fc(0x1b7)];else{if(_0x250dc2[0x0]['language']==_0x12a4fc(0x1af))var _0x3e3051=users[_0x12a4fc(0x1af)];else{if(_0x250dc2[0x0][_0x12a4fc(0x1a5)]==_0x12a4fc(0x1b2))var _0x3e3051=users[_0x12a4fc(0x1b2)];else{if(_0x250dc2[0x0]['language']==_0x12a4fc(0x1a6))var _0x3e3051=users[_0x12a4fc(0x1a6)];else{if(_0x250dc2[0x0]['language']==_0x12a4fc(0x1a4))var _0x3e3051=users['Portuguese'];else{if(_0x250dc2[0x0]['language']=='Chinese')var _0x3e3051=users[_0x12a4fc(0x18a)];else{if(_0x250dc2[0x0][_0x12a4fc(0x1a5)]==_0x12a4fc(0x1d5))var _0x3e3051=users['Arabic'];}}}}}}}_0x28c4c2[_0x12a4fc(0x1ca)](_0x12a4fc(0x193),{'success':_0x304ed0[_0x12a4fc(0x1f7)](_0x12a4fc(0x1dc)),'errors':_0x304ed0['flash'](_0x12a4fc(0x1d0)),'role':_0x9f3857,'profile':_0x313948,'master_shop':_0x250dc2,'user':_0x5ba655,'stock':_0x4d732c,'unit':_0x256d4d,'language':_0x3e3051,'warehouses':_0x38f66a,'rooms':_0x3c4ec9,'warehouse_QA':_0x4cbd34});}catch(_0x150d37){console['log'](_0x150d37);}}),router[a0_0x4bb042(0x1e1)](a0_0x4bb042(0x181),auth,async(_0x5e1170,_0x1aa782)=>{var _0xe760a6=a0_0x4bb042;if(_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x191)]=='QA')try{const _0x99cb22=_0x5e1170[_0xe760a6(0x1a8)]['id'],_0x4cac63=await sales_return[_0xe760a6(0x1ea)]({'invoice':_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1ce)]}),_0x58543f=await warehouse[_0xe760a6(0x1ea)]({'name':_0x4cac63[_0xe760a6(0x1ad)],'room':_0x4cac63[_0xe760a6(0x1ed)]}),{invoice:_0x5f51b6,customer:_0x3b454a,date:_0xdcd802,warehouse_name:_0x2b671c,product_name:_0x1977a8,primary_code:_0x3089cd,secondary_code:_0x36f577,product_code:_0x24bc5c,sales_quantity:_0x4bbe29,stocks:_0xcb6ab5,return_qty:_0x4b0020,note:_0x4e1b71,to_warehouse_name_QA:_0x4f3b91,to_Room_name_QA:_0x1de4b8}=_0x5e1170[_0xe760a6(0x1b1)];if(typeof product_name_QA==_0xe760a6(0x1a7))var _0x2c0e7a=[_0x5e1170['body'][_0xe760a6(0x1dd)]],_0x14bf54=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1d3)]],_0x761df=[_0x5e1170['body']['secondary_code_QA']],_0x195d61=[_0x5e1170['body'][_0xe760a6(0x1f5)]],_0x423d2b=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1e8)]],_0x58f379=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1f1)]],_0x17961c=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1d1)]];else var _0x2c0e7a=[..._0x5e1170['body'][_0xe760a6(0x1dd)]],_0x14bf54=[..._0x5e1170['body'][_0xe760a6(0x1d3)]],_0x761df=[..._0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1c3)]],_0x195d61=[..._0x5e1170[_0xe760a6(0x1b1)]['product_code_QA']],_0x423d2b=[..._0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1e8)]],_0x58f379=[..._0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1f1)]],_0x17961c=[..._0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1d1)]];const _0x342f0d=_0x2c0e7a[_0xe760a6(0x194)](_0x49b544=>{return _0x49b544={'product_name':_0x49b544};});_0x14bf54[_0xe760a6(0x1a0)]((_0x5787b3,_0x49893f)=>{var _0x1d1f6d=_0xe760a6;_0x342f0d[_0x49893f][_0x1d1f6d(0x18c)]=_0x5787b3;}),_0x761df[_0xe760a6(0x1a0)]((_0xb4c823,_0x1971b1)=>{_0x342f0d[_0x1971b1]['secondary_code']=_0xb4c823;}),_0x195d61[_0xe760a6(0x1a0)]((_0x25ab62,_0x4777a1)=>{var _0x442a6a=_0xe760a6;_0x342f0d[_0x4777a1][_0x442a6a(0x1c8)]=_0x25ab62;}),_0x423d2b[_0xe760a6(0x1a0)]((_0xc8da42,_0x34e069)=>{var _0x22a9eb=_0xe760a6;_0x342f0d[_0x34e069][_0x22a9eb(0x1ac)]=_0xc8da42;}),_0x58f379[_0xe760a6(0x1a0)]((_0x324ece,_0x3236b6)=>{var _0x1673a8=_0xe760a6;_0x342f0d[_0x3236b6][_0x1673a8(0x1d6)]=_0x324ece;}),_0x17961c[_0xe760a6(0x1a0)]((_0x3a0fbd,_0x2671e7)=>{_0x342f0d[_0x2671e7]['return_qty']=_0x3a0fbd;}),_0x4cac63[_0xe760a6(0x1ee)][_0xe760a6(0x1a0)](_0x1a50cf=>{var _0x303ae4=_0xe760a6;const _0x19e388=_0x58543f[_0x303ae4(0x19f)]['map'](_0x13a586=>{var _0x4935ac=_0x303ae4;_0x13a586['product_name']==_0x1a50cf[_0x4935ac(0x192)]&&(_0x13a586[_0x4935ac(0x1f3)]=parseInt(_0x13a586[_0x4935ac(0x1f3)])+parseInt(_0x1a50cf[_0x4935ac(0x1e9)]));});}),await _0x58543f[_0xe760a6(0x1d2)](),_0x4cac63[_0xe760a6(0x1ce)]=_0x5f51b6,_0x4cac63[_0xe760a6(0x184)]=_0x3b454a,_0x4cac63[_0xe760a6(0x19a)]=_0xdcd802,_0x4cac63['warehouse_name']=_0x2b671c,_0x4cac63[_0xe760a6(0x1ee)]=_0x342f0d,_0x4cac63[_0xe760a6(0x196)]=_0x4e1b71,_0x4cac63['ToWarehouse']=_0x4f3b91,_0x4cac63[_0xe760a6(0x1ed)]=_0x1de4b8;const _0x1143d9=await _0x4cac63[_0xe760a6(0x1d2)](),_0x30edc2=await c_payment_data[_0xe760a6(0x1ea)]({'invoice':_0x5e1170['body'][_0xe760a6(0x1ce)],'reason':_0xe760a6(0x1d7)});_0x30edc2['suppliers']=_0x5e1170[_0xe760a6(0x1b1)]['suppliers'],_0x30edc2['date']=_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x19a)],await _0x30edc2[_0xe760a6(0x1d2)](),_0x5e1170[_0xe760a6(0x1f7)](_0xe760a6(0x1dc),_0xe760a6(0x1a1)),_0x1aa782[_0xe760a6(0x1c9)]('/sales_return_finished/view');}catch(_0x31c0eb){console[_0xe760a6(0x1c5)](_0x31c0eb),_0x1aa782[_0xe760a6(0x1cb)](0xc8)[_0xe760a6(0x19d)]({'message':_0x31c0eb[_0xe760a6(0x1ab)]});}else try{const _0x44b5b4=_0x5e1170[_0xe760a6(0x1a8)]['id'];console[_0xe760a6(0x1c5)](_0x44b5b4);const _0x481e5f=await sales_return[_0xe760a6(0x1ea)]({'invoice':_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1ce)]});console[_0xe760a6(0x1c5)](_0xe760a6(0x1a3),_0x481e5f);const _0x2da0fc=await warehouse[_0xe760a6(0x1ea)]({'name':_0x481e5f['ToWarehouse'],'room':_0x481e5f[_0xe760a6(0x1ed)]});console['log']('old_warehouse_data',_0x2da0fc);const {invoice:_0x1153e5,customer:_0x232a5f,date:_0x37095f,warehouse_name:_0x304689,product_name:_0x468cd0,primary_code:_0x206240,secondary_code:_0x3bc25b,product_code:_0x39a915,sales_quantity:_0x40b95e,stocks:_0xf36440,return_qty:_0xa62377,note:_0x4c8c77,to_warehouse_name:_0x589014,to_Room_name:_0x585b63}=_0x5e1170[_0xe760a6(0x1b1)];console['log'](_0x5e1170[_0xe760a6(0x1b1)]);if(typeof _0x468cd0==_0xe760a6(0x1a7))var _0x2c0e7a=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x192)]],_0x14bf54=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x18c)]],_0x761df=[_0x5e1170['body'][_0xe760a6(0x18b)]],_0x195d61=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1c8)]],_0x423d2b=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x183)]],_0x58f379=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1f9)]],_0x17961c=[_0x5e1170[_0xe760a6(0x1b1)]['return_qty']],_0x47768d=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1cf)]],_0x2b049f=[_0x5e1170[_0xe760a6(0x1b1)]['bin']],_0x4df81b=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1aa)]],_0x2bae15=[_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1b0)]];else var _0x2c0e7a=[..._0x5e1170['body']['product_name']],_0x14bf54=[..._0x5e1170[_0xe760a6(0x1b1)]['primary_code']],_0x761df=[..._0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x18b)]],_0x195d61=[..._0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1c8)]],_0x423d2b=[..._0x5e1170[_0xe760a6(0x1b1)]['sales_quantity']],_0x58f379=[..._0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1f9)]],_0x17961c=[..._0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1e9)]],_0x47768d=[..._0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1cf)]],_0x2b049f=[..._0x5e1170['body'][_0xe760a6(0x1b5)]],_0x4df81b=[..._0x5e1170['body'][_0xe760a6(0x1aa)]],_0x2bae15=[..._0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x1b0)]];const _0x313adf=_0x2c0e7a[_0xe760a6(0x194)](_0x5796ef=>{return _0x5796ef={'product_name':_0x5796ef};});_0x14bf54[_0xe760a6(0x1a0)]((_0x170640,_0x22be3b)=>{var _0x1a3b94=_0xe760a6;_0x313adf[_0x22be3b][_0x1a3b94(0x18c)]=_0x170640;}),_0x761df[_0xe760a6(0x1a0)]((_0x41e9e8,_0x2f5026)=>{var _0x5a5ae5=_0xe760a6;_0x313adf[_0x2f5026][_0x5a5ae5(0x18b)]=_0x41e9e8;}),_0x195d61[_0xe760a6(0x1a0)]((_0xa2c1bb,_0x1ad6a8)=>{var _0x5986f5=_0xe760a6;_0x313adf[_0x1ad6a8][_0x5986f5(0x1c8)]=_0xa2c1bb;}),_0x423d2b['forEach']((_0x3ecc15,_0x138725)=>{_0x313adf[_0x138725]['sale_qty']=_0x3ecc15;}),_0x58f379[_0xe760a6(0x1a0)]((_0x29015f,_0x30f662)=>{var _0x305e8d=_0xe760a6;_0x313adf[_0x30f662][_0x305e8d(0x1d6)]=_0x29015f;}),_0x17961c[_0xe760a6(0x1a0)]((_0x2cc733,_0x2ba88f)=>{_0x313adf[_0x2ba88f]['return_qty']=_0x2cc733;}),_0x47768d[_0xe760a6(0x1a0)]((_0x5175f4,_0x12c2e1)=>{var _0x206e0f=_0xe760a6;_0x313adf[_0x12c2e1][_0x206e0f(0x1cf)]=_0x5175f4;}),_0x2b049f[_0xe760a6(0x1a0)]((_0x4fd626,_0x404e98)=>{_0x313adf[_0x404e98]['bin']=_0x4fd626;}),_0x4df81b[_0xe760a6(0x1a0)]((_0x3aa646,_0x349041)=>{var _0x5e515d=_0xe760a6;_0x313adf[_0x349041][_0x5e515d(0x1fb)]=_0x3aa646;}),_0x2bae15[_0xe760a6(0x1a0)]((_0x95c42,_0x3c663e)=>{var _0x2e1a55=_0xe760a6;_0x313adf[_0x3c663e][_0x2e1a55(0x1b0)]=_0x95c42;});var _0x29f8dd=0x0;_0x313adf[_0xe760a6(0x1a0)](_0x2fb437=>{var _0x2b0175=_0xe760a6;console['log']('foreach\x20newproduct',_0x2fb437),(parseInt(_0x2fb437[_0x2b0175(0x1ac)])<parseInt(_0x2fb437['return_qty'])||parseInt(_0x2fb437['stock'])<parseInt(_0x2fb437['return_qty'])&&parseInt(_0x2fb437[_0x2b0175(0x1ac)])>parseInt(_0x2fb437['return_qty'])||parseInt(_0x2fb437[_0x2b0175(0x1e9)])==0x0)&&_0x29f8dd++;});if(_0x29f8dd!=0x0)return _0x5e1170['flash']('errors',_0xe760a6(0x19e)),_0x1aa782[_0xe760a6(0x1c9)](_0xe760a6(0x1ae));_0x481e5f[_0xe760a6(0x1c4)][_0xe760a6(0x1a0)](_0x5e3aa6=>{var _0x44e9e4=_0xe760a6;const _0x13d89b=_0x2da0fc[_0x44e9e4(0x19f)]['map'](_0x15fbee=>{var _0x495654=_0x44e9e4;_0x15fbee[_0x495654(0x192)]==_0x5e3aa6['product_name']&&_0x15fbee[_0x495654(0x1b0)]==_0x5e3aa6[_0x495654(0x1b0)]&&_0x15fbee[_0x495654(0x1fb)]==_0x5e3aa6[_0x495654(0x1fb)]&&_0x15fbee[_0x495654(0x1b5)]==_0x5e3aa6[_0x495654(0x1b5)]&&_0x15fbee[_0x495654(0x1cf)]==_0x5e3aa6['bay']&&(_0x15fbee['product_stock']=parseInt(_0x15fbee[_0x495654(0x1f3)])+parseInt(_0x5e3aa6[_0x495654(0x1e9)]));});}),console[_0xe760a6(0x1c5)]('old_warehouse_data',_0x2da0fc),await _0x2da0fc['save'](),_0x481e5f[_0xe760a6(0x1ce)]=_0x1153e5,_0x481e5f[_0xe760a6(0x184)]=_0x232a5f,_0x481e5f[_0xe760a6(0x19a)]=_0x37095f,_0x481e5f[_0xe760a6(0x1db)]=_0x304689,_0x481e5f['return_sale']=_0x313adf,_0x481e5f['note']=_0x4c8c77,_0x481e5f[_0xe760a6(0x1ad)]=_0x589014,_0x481e5f[_0xe760a6(0x1ed)]=_0x585b63;const _0x536bb8=await _0x481e5f[_0xe760a6(0x1d2)]();console[_0xe760a6(0x1c5)](_0xe760a6(0x1c7),_0x536bb8);const _0x4ea82e=await c_payment_data['findOne']({'invoice':_0x5e1170['body'][_0xe760a6(0x1ce)],'reason':'Sale\x20Return'});_0x4ea82e['suppliers']=_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x182)],_0x4ea82e[_0xe760a6(0x19a)]=_0x5e1170[_0xe760a6(0x1b1)][_0xe760a6(0x19a)],await _0x4ea82e[_0xe760a6(0x1d2)](),_0x5e1170[_0xe760a6(0x1f7)](_0xe760a6(0x1dc),_0xe760a6(0x1a1)),_0x1aa782[_0xe760a6(0x1c9)](_0xe760a6(0x1d8));}catch(_0x19593c){console[_0xe760a6(0x1c5)](_0x19593c),_0x1aa782['status'](0xc8)['json']({'message':_0x19593c[_0xe760a6(0x1ab)]});}}),router[a0_0x4bb042(0x1e1)](a0_0x4bb042(0x1f2),auth,async(_0x1ff346,_0x512d06)=>{var _0x2656ac=a0_0x4bb042;try{const _0x23e679=_0x1ff346[_0x2656ac(0x1a8)]['id'],{invoice:_0x1137fd,customer:_0x321fa3,payable_to_customer:_0x336835,paid_amount:_0x434d4f}=_0x1ff346[_0x2656ac(0x1b1)],_0x1a8ef5=await sales_return['findById'](_0x23e679);console[_0x2656ac(0x1c5)](_0x2656ac(0x187),_0x1a8ef5),console[_0x2656ac(0x1c5)](_0x336835),console['log'](_0x434d4f);var _0x5133eb=_0x336835-_0x434d4f;console[_0x2656ac(0x1c5)](_0x2656ac(0x199),_0x5133eb),_0x1a8ef5[_0x2656ac(0x1f6)]=parseFloat(_0x434d4f)+parseFloat(_0x1a8ef5[_0x2656ac(0x1f6)]),_0x1a8ef5[_0x2656ac(0x1c2)]=_0x5133eb,console['log'](_0x1a8ef5);const _0x356d9b=await _0x1a8ef5[_0x2656ac(0x1d2)]();console[_0x2656ac(0x1c5)](0x1b207);const _0x270632=await c_payment_data['findOne']({'invoice':_0x1ff346['body'][_0x2656ac(0x1ce)],'reason':_0x2656ac(0x1d7)});console[_0x2656ac(0x1c5)](_0x2656ac(0x1e5),_0x270632),_0x270632['amount']=_0x5133eb,await _0x270632[_0x2656ac(0x1d2)]();let _0x3c9421=new Date(),_0x1de02b=('0'+_0x3c9421[_0x2656ac(0x1da)]())['slice'](-0x2),_0x5e5bf6=('0'+(_0x3c9421[_0x2656ac(0x1eb)]()+0x1))[_0x2656ac(0x1ba)](-0x2),_0x353c4a=_0x3c9421[_0x2656ac(0x1f0)](),_0xaa2908=_0x353c4a+'-'+_0x5e5bf6+'-'+_0x1de02b;const _0x40edff=new customer_payment({'invoice':_0x1137fd,'date':_0x353c4a+'-'+_0x5e5bf6+'-'+_0x1de02b,'customer':_0x321fa3,'reason':_0x2656ac(0x1a9),'amount':_0x434d4f}),_0x20a9f5=await _0x40edff[_0x2656ac(0x1d2)]();_0x1ff346[_0x2656ac(0x1f7)]('success',_0x2656ac(0x1e6)),_0x512d06[_0x2656ac(0x1c9)](_0x2656ac(0x1d8));}catch(_0x577320){console[_0x2656ac(0x1c5)](_0x577320);}}),router[a0_0x4bb042(0x197)]('/invoice/:id',auth,async(_0x1ccd7f,_0x403cb5)=>{var _0x30095d=a0_0x4bb042;try{const {username:_0x4bd752,email:_0x443aab,role:_0x34fb29}=_0x1ccd7f[_0x30095d(0x190)],_0x4defc7=_0x1ccd7f[_0x30095d(0x190)],_0x17920d=await profile[_0x30095d(0x1ea)]({'email':_0x4defc7[_0x30095d(0x1ef)]}),_0x2f1387=await master_shop[_0x30095d(0x185)]();console[_0x30095d(0x1c5)]('master',_0x2f1387);const _0x420a43=_0x1ccd7f[_0x30095d(0x1a8)]['id'],_0x52ac84=await sales_return['findById'](_0x420a43);console[_0x30095d(0x1c5)](_0x52ac84);const _0x7a1f9a=await customer['findOne']({'name':_0x52ac84[_0x30095d(0x184)]});console[_0x30095d(0x1c5)](_0x7a1f9a);if(_0x2f1387[0x0]['language']==_0x30095d(0x189)){var _0x38a842=users[_0x30095d(0x1cc)];console[_0x30095d(0x1c5)](_0x38a842);}else{if(_0x2f1387[0x0]['language']=='Hindi')var _0x38a842=users['Hindi'];else{if(_0x2f1387[0x0][_0x30095d(0x1a5)]==_0x30095d(0x1af))var _0x38a842=users[_0x30095d(0x1af)];else{if(_0x2f1387[0x0][_0x30095d(0x1a5)]==_0x30095d(0x1b2))var _0x38a842=users[_0x30095d(0x1b2)];else{if(_0x2f1387[0x0][_0x30095d(0x1a5)]==_0x30095d(0x1a6))var _0x38a842=users[_0x30095d(0x1a6)];else{if(_0x2f1387[0x0][_0x30095d(0x1a5)]==_0x30095d(0x1a4))var _0x38a842=users[_0x30095d(0x1b3)];else{if(_0x2f1387[0x0][_0x30095d(0x1a5)]=='Chinese')var _0x38a842=users[_0x30095d(0x18a)];else{if(_0x2f1387[0x0][_0x30095d(0x1a5)]==_0x30095d(0x1d5))var _0x38a842=users[_0x30095d(0x195)];}}}}}}}_0x403cb5[_0x30095d(0x1ca)]('sales_return_invoice',{'success':_0x1ccd7f[_0x30095d(0x1f7)]('success'),'errors':_0x1ccd7f[_0x30095d(0x1f7)](_0x30095d(0x1d0)),'role':_0x4defc7,'profile':_0x17920d,'master_shop':_0x2f1387,'customers':_0x7a1f9a,'sales':_0x52ac84,'language':_0x38a842});}catch(_0x56eec6){console['log'](_0x56eec6);}}),module[a0_0x4bb042(0x1a2)]=router;function a0_0x176c(){var _0x173848=['Finished\x20Goods','json','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','product_details','forEach','purchase\x20return\x20successfully','exports','old_data','Portuguese\x20(BR)','language','French','string','params','Returned\x20Payment\x20For\x20Sale\x20Return','types','message','sale_qty','ToWarehouse','back','German','floorlevel','body','Spanish','Portuguese','findById','bin','18vtrwnz','Hindi','sales_return_finished','$product_details.primary_code','slice','$product_details.product_code','173NdIqqO','$product_details.product_stock','1118308DNlAnV','Router','customers','$product_details.floorlevel','due_amount','secondary_code_QA','return_sale','log','Return\x20Rooms','new\x20new_data','product_code','redirect','render','status','English','$customer_docs','invoice','bay','errors','return_qty_QA','save','primary_code_QA','$product_details.product_name','Arabic\x20(ae)','stock','Sale\x20Return','/sales_return/view','Enabled','getDate','warehouse_name','success','product_name_QA','$product_details.rack','12dUIWyz','3272180BKtBEj','post','1860410wCRIGS','aggregate','2506854Ufvnzk','c_payment','payment\x20successfull','master','sales_quantity_QA','return_qty','findOne','getMonth','$product_details.secondary_code','ToRoom','return_sale_QA','email','getFullYear','stocks_QA','/give_payment/:id','product_stock','express','product_code_QA','paid_amount','flash','$name','stocks','$product_details.type','type','name','/view/:id','suppliers','sales_quantity','customer','find','../models/all_models','data','$product_details.bay','English\x20(US)','Chinese','secondary_code','primary_code','19117736ODRBAi','../public/language/languages.json','1875216twWHev','user','for_categorize','product_name','return_sale_edit_finished','map','Arabic','note','get','6nzCkWn','subtract','date','3086RoHCUD'];a0_0x176c=function(){return _0x173848;};return a0_0x176c();}