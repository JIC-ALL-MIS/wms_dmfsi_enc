var a0_0x44f1f3=a0_0x3729;(function(_0x100d4b,_0x3037ba){var _0x333f79=a0_0x3729,_0x2e768b=_0x100d4b();while(!![]){try{var _0x5a1047=-parseInt(_0x333f79(0xdd))/0x1+parseInt(_0x333f79(0x137))/0x2*(parseInt(_0x333f79(0xe8))/0x3)+parseInt(_0x333f79(0x121))/0x4*(parseInt(_0x333f79(0xdc))/0x5)+parseInt(_0x333f79(0x11f))/0x6*(parseInt(_0x333f79(0xe5))/0x7)+parseInt(_0x333f79(0x132))/0x8+parseInt(_0x333f79(0x136))/0x9+-parseInt(_0x333f79(0x13f))/0xa;if(_0x5a1047===_0x3037ba)break;else _0x2e768b['push'](_0x2e768b['shift']());}catch(_0x37255f){_0x2e768b['push'](_0x2e768b['shift']());}}}(a0_0x23ba,0xcb137));function a0_0x3729(_0x596aeb,_0x2fad79){var _0x23ba15=a0_0x23ba();return a0_0x3729=function(_0x3729ed,_0x5dbbda){_0x3729ed=_0x3729ed-0xd8;var _0x271325=_0x23ba15[_0x3729ed];return _0x271325;},a0_0x3729(_0x596aeb,_0x2fad79);}function a0_0x23ba(){var _0x12a466=['primary_code','product_name','date','old_warehouse_data','language','success','product_stock','master','Portuguese\x20(BR)','secondary_code_QA','Return\x20Rooms','ToRoom','floorlevel','French','209665bMZXff','360642eKtXeS','sales_quantity_QA','customer','getMonth','$product_details.secondary_code','for_categorize','German','primary_code_QA','62650kOhaEz','$product_details.floorlevel','/give_payment/:id','93nXrFMN','warehouse_name','sales_quantity','$name','sale_qty','Finished\x20Goods','Portuguese','string','map','Hindi','stocks','paid_amount','post','customer_docs','subtract','forEach','bin','ToWarehouse','return_sale_QA','find','return_sale','../middleware/auth','user','$product_details.product_name','/sales_return/view','Spanish','name','render','type','/view','$product_details.primary_code','$product_details._id','product_details','return_qty','stocks_QA','Arabic\x20(ae)','bay','return_qty_QA','data','product_code_QA','aggregate','status','English','stock','product_code','Arabic','Returned\x20Payment\x20For\x20Sale\x20Return','invoice','redirect','payment\x20successfull','errors','get','back','body','log','66AgjqzT','slice','68KyYPJV','../models/all_models','$product_details.rack','getDate','types','return_sale_edit_finished','/sales_return_finished/view','params','$product_details.product_stock','$product_details','findById','suppliers','product_name_QA','findOne','purchase\x20return\x20successfully','old_data','flash','3309904goDEbh','exports','English\x20(US)','$product_details.storage','10649268POtIMY','28446tWxDnq','due_amount','Sale\x20Return','/view/:id','message','Chinese','secondary_code','$customer_docs','16567730JEaoTe','Enabled','QA\x20Warehouse','save'];a0_0x23ba=function(){return _0x12a466;};return a0_0x23ba();}const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x44f1f3(0x122)),auth=require(a0_0x44f1f3(0xfd)),users=require('../public/language/languages.json');router['get'](a0_0x44f1f3(0x105),auth,async(_0x19a712,_0x41bcc0)=>{var _0x2ee01b=a0_0x44f1f3;try{const {username:_0xa8c2dd,email:_0x2704ca,role:_0x5926e2}=_0x19a712['user'],_0x422b22=_0x19a712['user'],_0x34db81=await profile[_0x2ee01b(0x12e)]({'email':_0x422b22['email']}),_0x59ae3a=await master_shop[_0x2ee01b(0xfb)](),_0x34d166=await sales_return_finished[_0x2ee01b(0x110)]([{'$lookup':{'from':'customers','localField':_0x2ee01b(0xdf),'foreignField':_0x2ee01b(0x102),'as':_0x2ee01b(0xf5)}},{'$unwind':_0x2ee01b(0x13e)}]);if(_0x59ae3a[0x0]['language']==_0x2ee01b(0x134)){var _0x2e32c9=users[_0x2ee01b(0x112)];console['log'](_0x2e32c9);}else{if(_0x59ae3a[0x0]['language']==_0x2ee01b(0xf1))var _0x2e32c9=users[_0x2ee01b(0xf1)];else{if(_0x59ae3a[0x0][_0x2ee01b(0x147)]==_0x2ee01b(0xe3))var _0x2e32c9=users[_0x2ee01b(0xe3)];else{if(_0x59ae3a[0x0][_0x2ee01b(0x147)]==_0x2ee01b(0x101))var _0x2e32c9=users[_0x2ee01b(0x101)];else{if(_0x59ae3a[0x0]['language']==_0x2ee01b(0xdb))var _0x2e32c9=users[_0x2ee01b(0xdb)];else{if(_0x59ae3a[0x0]['language']==_0x2ee01b(0x14b))var _0x2e32c9=users[_0x2ee01b(0xee)];else{if(_0x59ae3a[0x0][_0x2ee01b(0x147)]==_0x2ee01b(0x13c))var _0x2e32c9=users[_0x2ee01b(0x13c)];else{if(_0x59ae3a[0x0][_0x2ee01b(0x147)]=='Arabic\x20(ae)')var _0x2e32c9=users['Arabic'];}}}}}}}_0x41bcc0['render']('sales_return_finished',{'success':_0x19a712[_0x2ee01b(0x131)](_0x2ee01b(0x148)),'errors':_0x19a712['flash'](_0x2ee01b(0x11a)),'role':_0x422b22,'profile':_0x34db81,'master_shop':_0x59ae3a,'user':_0x34d166,'language':_0x2e32c9});}catch(_0x4bf3a1){console['log'](_0x4bf3a1);}}),router['get']('/view/:id',auth,async(_0x442357,_0x575ef8)=>{var _0x355a52=a0_0x44f1f3;try{const {username:_0x4456b3,email:_0x14ef79,role:_0x43bec8}=_0x442357[_0x355a52(0xfe)],_0x17f9f6=_0x442357['user'],_0x46123d=await profile[_0x355a52(0x12e)]({'email':_0x17f9f6['email']}),_0x5b807a=await master_shop['find']();console[_0x355a52(0x11e)](_0x355a52(0x14a),_0x5b807a);const _0x52454e=_0x442357[_0x355a52(0x128)]['id'];console[_0x355a52(0x11e)](_0x52454e);var _0x152e67=[_0x355a52(0xd8)];const _0x5110ab=await sales_return_finished[_0x355a52(0x12b)](_0x52454e),_0x6adfa9=await warehouse[_0x355a52(0x110)]([{'$match':{'name':_0x5110ab[_0x355a52(0xf9)],'room':_0x5110ab[_0x355a52(0xd9)]}},{'$unwind':_0x355a52(0x12a)},{'$group':{'_id':_0x355a52(0x107),'name':{'$first':_0x355a52(0xff)},'product_stock':{'$first':_0x355a52(0x129)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x355a52(0xe6)},'primary_code':{'$first':_0x355a52(0x106)},'secondary_code':{'$first':_0x355a52(0xe1)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x355a52(0x135)},'rack':{'$first':_0x355a52(0x123)}}}]);console[_0x355a52(0x11e)](_0x6adfa9);const _0x441e32=await warehouse[_0x355a52(0x110)]([{'$match':{'status':_0x355a52(0x140),'warehouse_category':_0x355a52(0xed)}},{'$group':{'_id':_0x355a52(0xeb),'name':{'$first':_0x355a52(0xeb)}}},{'$sort':{'name':0x1}}]),_0x1d33d4=await warehouse[_0x355a52(0x110)]([{'$match':{'status':_0x355a52(0x140),'name':_0x355a52(0x141)}},{'$group':{'_id':_0x355a52(0xeb),'name':{'$first':_0x355a52(0xeb)}}},{'$sort':{'name':0x1}}]),_0x42655d=await product[_0x355a52(0xfb)]({});if(_0x5b807a[0x0][_0x355a52(0x147)]==_0x355a52(0x134)){var _0x17664f=users['English'];console['log'](_0x17664f);}else{if(_0x5b807a[0x0][_0x355a52(0x147)]=='Hindi')var _0x17664f=users[_0x355a52(0xf1)];else{if(_0x5b807a[0x0][_0x355a52(0x147)]==_0x355a52(0xe3))var _0x17664f=users[_0x355a52(0xe3)];else{if(_0x5b807a[0x0][_0x355a52(0x147)]==_0x355a52(0x101))var _0x17664f=users[_0x355a52(0x101)];else{if(_0x5b807a[0x0][_0x355a52(0x147)]==_0x355a52(0xdb))var _0x17664f=users[_0x355a52(0xdb)];else{if(_0x5b807a[0x0]['language']=='Portuguese\x20(BR)')var _0x17664f=users[_0x355a52(0xee)];else{if(_0x5b807a[0x0][_0x355a52(0x147)]=='Chinese')var _0x17664f=users['Chinese'];else{if(_0x5b807a[0x0][_0x355a52(0x147)]==_0x355a52(0x10b))var _0x17664f=users[_0x355a52(0x115)];}}}}}}}_0x575ef8[_0x355a52(0x103)](_0x355a52(0x126),{'success':_0x442357[_0x355a52(0x131)](_0x355a52(0x148)),'errors':_0x442357[_0x355a52(0x131)]('errors'),'role':_0x17f9f6,'profile':_0x46123d,'master_shop':_0x5b807a,'user':_0x5110ab,'stock':_0x6adfa9,'unit':_0x42655d,'language':_0x17664f,'warehouses':_0x441e32,'rooms':_0x152e67,'warehouse_QA':_0x1d33d4});}catch(_0x1b40c0){console[_0x355a52(0x11e)](_0x1b40c0);}}),router[a0_0x44f1f3(0xf4)](a0_0x44f1f3(0x13a),auth,async(_0x539ec2,_0x1d8d23)=>{var _0x5f0068=a0_0x44f1f3;if(_0x539ec2['body'][_0x5f0068(0xe2)]=='QA')try{const _0x30fcd4=_0x539ec2[_0x5f0068(0x128)]['id'],_0x246764=await sales_return[_0x5f0068(0x12e)]({'invoice':_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x117)]}),_0x3074bf=await warehouse[_0x5f0068(0x12e)]({'name':_0x246764[_0x5f0068(0xf9)],'room':_0x246764[_0x5f0068(0xd9)]}),{invoice:_0xe2124c,customer:_0x579997,date:_0x40e4be,warehouse_name:_0x10f1a9,product_name:_0x3579c7,primary_code:_0x1602d9,secondary_code:_0x31f906,product_code:_0x2e28b2,sales_quantity:_0x41018b,stocks:_0x417003,return_qty:_0x421a3a,note:_0x589dc2,to_warehouse_name_QA:_0x486f5f,to_Room_name_QA:_0x2e1d4c}=_0x539ec2[_0x5f0068(0x11d)];if(typeof product_name_QA==_0x5f0068(0xef))var _0x5b0cd4=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x12d)]],_0x4d77f8=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0xe4)]],_0x183356=[_0x539ec2['body'][_0x5f0068(0x14c)]],_0x3d4418=[_0x539ec2['body'][_0x5f0068(0x10f)]],_0x4a6346=[_0x539ec2[_0x5f0068(0x11d)]['sales_quantity_QA']],_0x5c1227=[_0x539ec2['body'][_0x5f0068(0x10a)]],_0x262d7c=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x10d)]];else var _0x5b0cd4=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x12d)]],_0x4d77f8=[..._0x539ec2['body'][_0x5f0068(0xe4)]],_0x183356=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x14c)]],_0x3d4418=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x10f)]],_0x4a6346=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0xde)]],_0x5c1227=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x10a)]],_0x262d7c=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x10d)]];const _0x19fe26=_0x5b0cd4[_0x5f0068(0xf0)](_0x4211d7=>{return _0x4211d7={'product_name':_0x4211d7};});_0x4d77f8[_0x5f0068(0xf7)]((_0x1c4b7b,_0x5d18ee)=>{var _0x214479=_0x5f0068;_0x19fe26[_0x5d18ee][_0x214479(0x143)]=_0x1c4b7b;}),_0x183356[_0x5f0068(0xf7)]((_0x1bf869,_0x219ccf)=>{_0x19fe26[_0x219ccf]['secondary_code']=_0x1bf869;}),_0x3d4418[_0x5f0068(0xf7)]((_0x46e432,_0x10b9fa)=>{var _0x6a71c5=_0x5f0068;_0x19fe26[_0x10b9fa][_0x6a71c5(0x114)]=_0x46e432;}),_0x4a6346[_0x5f0068(0xf7)]((_0x510cf3,_0xc8bcfe)=>{var _0x467381=_0x5f0068;_0x19fe26[_0xc8bcfe][_0x467381(0xec)]=_0x510cf3;}),_0x5c1227['forEach']((_0x566b8f,_0x5dc4ee)=>{_0x19fe26[_0x5dc4ee]['stock']=_0x566b8f;}),_0x262d7c[_0x5f0068(0xf7)]((_0xef8ec0,_0x3420da)=>{var _0x388d9a=_0x5f0068;_0x19fe26[_0x3420da][_0x388d9a(0x109)]=_0xef8ec0;}),_0x246764[_0x5f0068(0xfa)][_0x5f0068(0xf7)](_0x5446e2=>{var _0x3cf3e8=_0x5f0068;const _0x4a6254=_0x3074bf[_0x3cf3e8(0x108)][_0x3cf3e8(0xf0)](_0x32b117=>{var _0x125e11=_0x3cf3e8;_0x32b117[_0x125e11(0x144)]==_0x5446e2['product_name']&&(_0x32b117['product_stock']=parseInt(_0x32b117['product_stock'])+parseInt(_0x5446e2['return_qty']));});}),await _0x3074bf[_0x5f0068(0x142)](),_0x246764[_0x5f0068(0x117)]=_0xe2124c,_0x246764['customer']=_0x579997,_0x246764[_0x5f0068(0x145)]=_0x40e4be,_0x246764[_0x5f0068(0xe9)]=_0x10f1a9,_0x246764[_0x5f0068(0xfa)]=_0x19fe26,_0x246764['note']=_0x589dc2,_0x246764[_0x5f0068(0xf9)]=_0x486f5f,_0x246764[_0x5f0068(0xd9)]=_0x2e1d4c;const _0x30249d=await _0x246764['save'](),_0x3062c3=await c_payment_data[_0x5f0068(0x12e)]({'invoice':_0x539ec2[_0x5f0068(0x11d)]['invoice'],'reason':'Sale\x20Return'});_0x3062c3['suppliers']=_0x539ec2[_0x5f0068(0x11d)]['suppliers'],_0x3062c3['date']=_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x145)],await _0x3062c3[_0x5f0068(0x142)](),_0x539ec2[_0x5f0068(0x131)]('success',_0x5f0068(0x12f)),_0x1d8d23[_0x5f0068(0x118)](_0x5f0068(0x127));}catch(_0xa21ca){console['log'](_0xa21ca),_0x1d8d23['status'](0xc8)['json']({'message':_0xa21ca[_0x5f0068(0x13b)]});}else try{const _0x36cb5e=_0x539ec2[_0x5f0068(0x128)]['id'];console['log'](_0x36cb5e);const _0x2c9a4a=await sales_return['findOne']({'invoice':_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x117)]});console[_0x5f0068(0x11e)](_0x5f0068(0x130),_0x2c9a4a);const _0x16b9cf=await warehouse['findOne']({'name':_0x2c9a4a[_0x5f0068(0xf9)],'room':_0x2c9a4a[_0x5f0068(0xd9)]});console[_0x5f0068(0x11e)](_0x5f0068(0x146),_0x16b9cf);const {invoice:_0x222ffd,customer:_0x501d87,date:_0x53899c,warehouse_name:_0x41b172,product_name:_0x2d61d6,primary_code:_0x39b312,secondary_code:_0x2f71ba,product_code:_0x525dcc,sales_quantity:_0x1ae261,stocks:_0x471c74,return_qty:_0x221ad7,note:_0x5f0826,to_warehouse_name:_0x419e3e,to_Room_name:_0x5c0a16}=_0x539ec2[_0x5f0068(0x11d)];console[_0x5f0068(0x11e)](_0x539ec2['body']);if(typeof _0x2d61d6==_0x5f0068(0xef))var _0x5b0cd4=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x144)]],_0x4d77f8=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x143)]],_0x183356=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x13d)]],_0x3d4418=[_0x539ec2['body']['product_code']],_0x4a6346=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0xea)]],_0x5c1227=[_0x539ec2[_0x5f0068(0x11d)]['stocks']],_0x262d7c=[_0x539ec2['body'][_0x5f0068(0x109)]],_0x5965c5=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x10c)]],_0xe32159=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0xf8)]],_0x3f37f3=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x125)]],_0x59edf9=[_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0xda)]];else var _0x5b0cd4=[..._0x539ec2[_0x5f0068(0x11d)]['product_name']],_0x4d77f8=[..._0x539ec2[_0x5f0068(0x11d)]['primary_code']],_0x183356=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x13d)]],_0x3d4418=[..._0x539ec2[_0x5f0068(0x11d)]['product_code']],_0x4a6346=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0xea)]],_0x5c1227=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0xf2)]],_0x262d7c=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x109)]],_0x5965c5=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x10c)]],_0xe32159=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0xf8)]],_0x3f37f3=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x125)]],_0x59edf9=[..._0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0xda)]];const _0x4baa71=_0x5b0cd4[_0x5f0068(0xf0)](_0x1798d2=>{return _0x1798d2={'product_name':_0x1798d2};});_0x4d77f8[_0x5f0068(0xf7)]((_0x4986bf,_0x3def9b)=>{var _0x6c5088=_0x5f0068;_0x4baa71[_0x3def9b][_0x6c5088(0x143)]=_0x4986bf;}),_0x183356[_0x5f0068(0xf7)]((_0x461611,_0x5cf0c0)=>{var _0x18d7a8=_0x5f0068;_0x4baa71[_0x5cf0c0][_0x18d7a8(0x13d)]=_0x461611;}),_0x3d4418['forEach']((_0x590a31,_0x436e39)=>{_0x4baa71[_0x436e39]['product_code']=_0x590a31;}),_0x4a6346['forEach']((_0x3a2902,_0x18bd3b)=>{_0x4baa71[_0x18bd3b]['sale_qty']=_0x3a2902;}),_0x5c1227[_0x5f0068(0xf7)]((_0x2aeb3f,_0xf4156a)=>{var _0xfc7157=_0x5f0068;_0x4baa71[_0xf4156a][_0xfc7157(0x113)]=_0x2aeb3f;}),_0x262d7c['forEach']((_0x3b9836,_0x33c8e2)=>{_0x4baa71[_0x33c8e2]['return_qty']=_0x3b9836;}),_0x5965c5['forEach']((_0x1d121f,_0x1a2794)=>{_0x4baa71[_0x1a2794]['bay']=_0x1d121f;}),_0xe32159[_0x5f0068(0xf7)]((_0x1260fe,_0x1b5677)=>{var _0xfad78f=_0x5f0068;_0x4baa71[_0x1b5677][_0xfad78f(0xf8)]=_0x1260fe;}),_0x3f37f3[_0x5f0068(0xf7)]((_0x27ca5a,_0x646bc8)=>{var _0x339cff=_0x5f0068;_0x4baa71[_0x646bc8][_0x339cff(0x104)]=_0x27ca5a;}),_0x59edf9[_0x5f0068(0xf7)]((_0xfe2f04,_0x50f562)=>{_0x4baa71[_0x50f562]['floorlevel']=_0xfe2f04;});var _0x1acd67=0x0;_0x4baa71['forEach'](_0x2f1115=>{var _0x5b1a01=_0x5f0068;console[_0x5b1a01(0x11e)]('foreach\x20newproduct',_0x2f1115),(parseInt(_0x2f1115[_0x5b1a01(0xec)])<parseInt(_0x2f1115[_0x5b1a01(0x109)])||parseInt(_0x2f1115[_0x5b1a01(0x113)])<parseInt(_0x2f1115['return_qty'])&&parseInt(_0x2f1115[_0x5b1a01(0xec)])>parseInt(_0x2f1115[_0x5b1a01(0x109)])||parseInt(_0x2f1115[_0x5b1a01(0x109)])==0x0)&&_0x1acd67++;});if(_0x1acd67!=0x0)return _0x539ec2[_0x5f0068(0x131)](_0x5f0068(0x11a),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x1d8d23[_0x5f0068(0x118)](_0x5f0068(0x11c));_0x2c9a4a[_0x5f0068(0xfc)][_0x5f0068(0xf7)](_0x4768c1=>{var _0x5f48e6=_0x5f0068;const _0x273135=_0x16b9cf[_0x5f48e6(0x108)][_0x5f48e6(0xf0)](_0xfd1eb2=>{var _0x47fab3=_0x5f48e6;_0xfd1eb2[_0x47fab3(0x144)]==_0x4768c1[_0x47fab3(0x144)]&&_0xfd1eb2[_0x47fab3(0xda)]==_0x4768c1[_0x47fab3(0xda)]&&_0xfd1eb2[_0x47fab3(0x104)]==_0x4768c1[_0x47fab3(0x104)]&&_0xfd1eb2[_0x47fab3(0xf8)]==_0x4768c1['bin']&&_0xfd1eb2[_0x47fab3(0x10c)]==_0x4768c1[_0x47fab3(0x10c)]&&(_0xfd1eb2[_0x47fab3(0x149)]=parseInt(_0xfd1eb2['product_stock'])+parseInt(_0x4768c1['return_qty']));});}),console[_0x5f0068(0x11e)]('old_warehouse_data',_0x16b9cf),await _0x16b9cf[_0x5f0068(0x142)](),_0x2c9a4a[_0x5f0068(0x117)]=_0x222ffd,_0x2c9a4a[_0x5f0068(0xdf)]=_0x501d87,_0x2c9a4a[_0x5f0068(0x145)]=_0x53899c,_0x2c9a4a[_0x5f0068(0xe9)]=_0x41b172,_0x2c9a4a[_0x5f0068(0xfc)]=_0x4baa71,_0x2c9a4a['note']=_0x5f0826,_0x2c9a4a[_0x5f0068(0xf9)]=_0x419e3e,_0x2c9a4a[_0x5f0068(0xd9)]=_0x5c0a16;const _0x5c6d8f=await _0x2c9a4a[_0x5f0068(0x142)]();console['log']('new\x20new_data',_0x5c6d8f);const _0xd2c1af=await c_payment_data[_0x5f0068(0x12e)]({'invoice':_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x117)],'reason':'Sale\x20Return'});_0xd2c1af[_0x5f0068(0x12c)]=_0x539ec2[_0x5f0068(0x11d)][_0x5f0068(0x12c)],_0xd2c1af['date']=_0x539ec2[_0x5f0068(0x11d)]['date'],await _0xd2c1af['save'](),_0x539ec2['flash']('success',_0x5f0068(0x12f)),_0x1d8d23[_0x5f0068(0x118)](_0x5f0068(0x100));}catch(_0x24a25b){console[_0x5f0068(0x11e)](_0x24a25b),_0x1d8d23[_0x5f0068(0x111)](0xc8)['json']({'message':_0x24a25b['message']});}}),router[a0_0x44f1f3(0xf4)](a0_0x44f1f3(0xe7),auth,async(_0x2796c2,_0x4f9c7e)=>{var _0x178b88=a0_0x44f1f3;try{const _0xb82263=_0x2796c2['params']['id'],{invoice:_0x51fbfe,customer:_0x27391a,payable_to_customer:_0xd47c49,paid_amount:_0x503018}=_0x2796c2['body'],_0x58c8f4=await sales_return['findById'](_0xb82263);console['log'](_0x178b88(0x10e),_0x58c8f4),console[_0x178b88(0x11e)](_0xd47c49),console[_0x178b88(0x11e)](_0x503018);var _0x352c32=_0xd47c49-_0x503018;console[_0x178b88(0x11e)](_0x178b88(0xf6),_0x352c32),_0x58c8f4['paid_amount']=parseFloat(_0x503018)+parseFloat(_0x58c8f4[_0x178b88(0xf3)]),_0x58c8f4[_0x178b88(0x138)]=_0x352c32,console[_0x178b88(0x11e)](_0x58c8f4);const _0x3ecefa=await _0x58c8f4[_0x178b88(0x142)]();console['log'](0x1b207);const _0x48f00e=await c_payment_data[_0x178b88(0x12e)]({'invoice':_0x2796c2['body'][_0x178b88(0x117)],'reason':_0x178b88(0x139)});console[_0x178b88(0x11e)]('c_payment',_0x48f00e),_0x48f00e['amount']=_0x352c32,await _0x48f00e[_0x178b88(0x142)]();let _0x1f2fc6=new Date(),_0x16ebba=('0'+_0x1f2fc6[_0x178b88(0x124)]())['slice'](-0x2),_0x1408e0=('0'+(_0x1f2fc6[_0x178b88(0xe0)]()+0x1))[_0x178b88(0x120)](-0x2),_0x213a37=_0x1f2fc6['getFullYear'](),_0x3cc377=_0x213a37+'-'+_0x1408e0+'-'+_0x16ebba;const _0x4d248e=new customer_payment({'invoice':_0x51fbfe,'date':_0x213a37+'-'+_0x1408e0+'-'+_0x16ebba,'customer':_0x27391a,'reason':_0x178b88(0x116),'amount':_0x503018}),_0xc9090e=await _0x4d248e['save']();_0x2796c2[_0x178b88(0x131)](_0x178b88(0x148),_0x178b88(0x119)),_0x4f9c7e[_0x178b88(0x118)]('/sales_return/view');}catch(_0x58a451){console[_0x178b88(0x11e)](_0x58a451);}}),router[a0_0x44f1f3(0x11b)]('/invoice/:id',auth,async(_0x13d871,_0x11c689)=>{var _0x3f6e06=a0_0x44f1f3;try{const {username:_0x2afa69,email:_0x2a3cc8,role:_0xb14890}=_0x13d871['user'],_0x2da9e3=_0x13d871[_0x3f6e06(0xfe)],_0x32c418=await profile['findOne']({'email':_0x2da9e3['email']}),_0x1c4233=await master_shop[_0x3f6e06(0xfb)]();console['log']('master',_0x1c4233);const _0x306871=_0x13d871[_0x3f6e06(0x128)]['id'],_0x12ac4d=await sales_return[_0x3f6e06(0x12b)](_0x306871);console[_0x3f6e06(0x11e)](_0x12ac4d);const _0x319fc9=await customer['findOne']({'name':_0x12ac4d[_0x3f6e06(0xdf)]});console[_0x3f6e06(0x11e)](_0x319fc9);if(_0x1c4233[0x0][_0x3f6e06(0x147)]==_0x3f6e06(0x134)){var _0x420e2e=users[_0x3f6e06(0x112)];console[_0x3f6e06(0x11e)](_0x420e2e);}else{if(_0x1c4233[0x0][_0x3f6e06(0x147)]==_0x3f6e06(0xf1))var _0x420e2e=users[_0x3f6e06(0xf1)];else{if(_0x1c4233[0x0][_0x3f6e06(0x147)]==_0x3f6e06(0xe3))var _0x420e2e=users[_0x3f6e06(0xe3)];else{if(_0x1c4233[0x0][_0x3f6e06(0x147)]==_0x3f6e06(0x101))var _0x420e2e=users[_0x3f6e06(0x101)];else{if(_0x1c4233[0x0][_0x3f6e06(0x147)]==_0x3f6e06(0xdb))var _0x420e2e=users[_0x3f6e06(0xdb)];else{if(_0x1c4233[0x0]['language']==_0x3f6e06(0x14b))var _0x420e2e=users[_0x3f6e06(0xee)];else{if(_0x1c4233[0x0][_0x3f6e06(0x147)]==_0x3f6e06(0x13c))var _0x420e2e=users[_0x3f6e06(0x13c)];else{if(_0x1c4233[0x0]['language']==_0x3f6e06(0x10b))var _0x420e2e=users[_0x3f6e06(0x115)];}}}}}}}_0x11c689['render']('sales_return_invoice',{'success':_0x13d871[_0x3f6e06(0x131)](_0x3f6e06(0x148)),'errors':_0x13d871['flash'](_0x3f6e06(0x11a)),'role':_0x2da9e3,'profile':_0x32c418,'master_shop':_0x1c4233,'customers':_0x319fc9,'sales':_0x12ac4d,'language':_0x420e2e});}catch(_0x4e79f5){console[_0x3f6e06(0x11e)](_0x4e79f5);}}),module[a0_0x44f1f3(0x133)]=router;