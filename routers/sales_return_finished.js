function a0_0x1fc8(){var _0x30a624=['aggregate','$product_details','params','return_qty_QA','foreach\x20newproduct','primary_code','getFullYear','6603928wGfXNW','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','84585HEexMR','$product_details.rack','new\x20new_data','errors','2QdOwYa','status','findOne','../models/all_models','3117247ZzXKSs','Portuguese','stock','types','7356PStgTe','859251npurzG','render','customers','for_categorize','body','30NblYDO','redirect','Portuguese\x20(BR)','note','sales_quantity_QA','Sale\x20Return','stocks','Return\x20Rooms','c_payment','find','/sales_return/view','purchase\x20return\x20successfully','return_sale','forEach','French','Returned\x20Payment\x20For\x20Sale\x20Return','json','$product_details.storage','exports','$name','product_stock','sales_return_finished','product_code_QA','save','return_sale_QA','$product_details.bay','English','get','6DPySpH','getDate','../middleware/auth','map','flash','Hindi','master','type','success','Chinese','English\x20(US)','Arabic\x20(ae)','due_amount','product_code','ToRoom','floorlevel','user','payment\x20successfull','slice','date','message','primary_code_QA','product_name','bin','secondary_code','8217homzRV','$product_details.product_stock','sale_qty','customer','838825xoGBww','bay','product_details','German','sales_quantity','getMonth','stocks_QA','email','$product_details.secondary_code','16omJdXn','suppliers','return_qty','subtract','Spanish','log','language','/give_payment/:id','amount','post','old_warehouse_data','ToWarehouse','1809063dUtSnF','Enabled','$product_details.floorlevel','$product_details.bin','$product_details.primary_code','/view/:id','old_data','QA\x20Warehouse','string','paid_amount','Router','$product_details._id','findById','../public/language/languages.json','Arabic','invoice','sales_return_invoice'];a0_0x1fc8=function(){return _0x30a624;};return a0_0x1fc8();}var a0_0x33af92=a0_0x46d8;(function(_0x4b0459,_0x50ee20){var _0x1704ae=a0_0x46d8,_0x45cdbf=_0x4b0459();while(!![]){try{var _0x3e0b23=-parseInt(_0x1704ae(0x138))/0x1*(-parseInt(_0x1704ae(0x1a9))/0x2)+-parseInt(_0x1704ae(0x1a5))/0x3*(-parseInt(_0x1704ae(0x17f))/0x4)+parseInt(_0x1704ae(0x176))/0x5*(parseInt(_0x1704ae(0x159))/0x6)+parseInt(_0x1704ae(0x1ad))/0x7+-parseInt(_0x1704ae(0x1a3))/0x8+parseInt(_0x1704ae(0x18b))/0x9*(-parseInt(_0x1704ae(0x13d))/0xa)+parseInt(_0x1704ae(0x172))/0xb*(parseInt(_0x1704ae(0x137))/0xc);if(_0x3e0b23===_0x50ee20)break;else _0x45cdbf['push'](_0x45cdbf['shift']());}catch(_0x4a076c){_0x45cdbf['push'](_0x45cdbf['shift']());}}}(a0_0x1fc8,0x96074));function a0_0x46d8(_0x118a88,_0xc625a4){var _0x1fc8ef=a0_0x1fc8();return a0_0x46d8=function(_0x46d8c1,_0x49d3e4){_0x46d8c1=_0x46d8c1-0x137;var _0x56ab4d=_0x1fc8ef[_0x46d8c1];return _0x56ab4d;},a0_0x46d8(_0x118a88,_0xc625a4);}const express=require('express'),app=express(),router=express[a0_0x33af92(0x195)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x33af92(0x1ac)),auth=require(a0_0x33af92(0x15b)),users=require(a0_0x33af92(0x198));router['get']('/view',auth,async(_0x46c70e,_0x3dd1ac)=>{var _0xe9e3dd=a0_0x33af92;try{const {username:_0x2e783a,email:_0x3a364d,role:_0x304c65}=_0x46c70e['user'],_0x161afa=_0x46c70e[_0xe9e3dd(0x169)],_0xcdd1b9=await profile['findOne']({'email':_0x161afa[_0xe9e3dd(0x17d)]}),_0x21489b=await master_shop[_0xe9e3dd(0x146)](),_0x16a942=await sales_return_finished[_0xe9e3dd(0x19c)]([{'$lookup':{'from':_0xe9e3dd(0x13a),'localField':_0xe9e3dd(0x175),'foreignField':'name','as':'customer_docs'}},{'$unwind':'$customer_docs'}]);if(_0x21489b[0x0][_0xe9e3dd(0x185)]==_0xe9e3dd(0x163)){var _0x2394b0=users[_0xe9e3dd(0x157)];console[_0xe9e3dd(0x184)](_0x2394b0);}else{if(_0x21489b[0x0]['language']=='Hindi')var _0x2394b0=users[_0xe9e3dd(0x15e)];else{if(_0x21489b[0x0]['language']==_0xe9e3dd(0x179))var _0x2394b0=users[_0xe9e3dd(0x179)];else{if(_0x21489b[0x0]['language']==_0xe9e3dd(0x183))var _0x2394b0=users[_0xe9e3dd(0x183)];else{if(_0x21489b[0x0][_0xe9e3dd(0x185)]=='French')var _0x2394b0=users[_0xe9e3dd(0x14b)];else{if(_0x21489b[0x0][_0xe9e3dd(0x185)]==_0xe9e3dd(0x13f))var _0x2394b0=users[_0xe9e3dd(0x1ae)];else{if(_0x21489b[0x0][_0xe9e3dd(0x185)]=='Chinese')var _0x2394b0=users[_0xe9e3dd(0x162)];else{if(_0x21489b[0x0][_0xe9e3dd(0x185)]==_0xe9e3dd(0x164))var _0x2394b0=users[_0xe9e3dd(0x199)];}}}}}}}_0x3dd1ac[_0xe9e3dd(0x139)](_0xe9e3dd(0x152),{'success':_0x46c70e[_0xe9e3dd(0x15d)](_0xe9e3dd(0x161)),'errors':_0x46c70e[_0xe9e3dd(0x15d)](_0xe9e3dd(0x1a8)),'role':_0x161afa,'profile':_0xcdd1b9,'master_shop':_0x21489b,'user':_0x16a942,'language':_0x2394b0});}catch(_0x2b0ab9){console[_0xe9e3dd(0x184)](_0x2b0ab9);}}),router[a0_0x33af92(0x158)](a0_0x33af92(0x190),auth,async(_0xed87c6,_0x520938)=>{var _0x236b47=a0_0x33af92;try{const {username:_0x9b5580,email:_0x5300af,role:_0x5bedb1}=_0xed87c6['user'],_0x13f344=_0xed87c6[_0x236b47(0x169)],_0x31bb98=await profile[_0x236b47(0x1ab)]({'email':_0x13f344[_0x236b47(0x17d)]}),_0x4641a9=await master_shop[_0x236b47(0x146)]();console[_0x236b47(0x184)](_0x236b47(0x15f),_0x4641a9);const _0x4a8d4d=_0xed87c6[_0x236b47(0x19e)]['id'];console[_0x236b47(0x184)](_0x4a8d4d);var _0x1c1c83=[_0x236b47(0x144)];const _0x2b7c98=await sales_return_finished['findById'](_0x4a8d4d),_0x409be6=await warehouse[_0x236b47(0x19c)]([{'$match':{'name':_0x2b7c98['ToWarehouse'],'room':_0x2b7c98[_0x236b47(0x167)]}},{'$unwind':_0x236b47(0x19d)},{'$group':{'_id':_0x236b47(0x196),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x236b47(0x173)},'bay':{'$first':_0x236b47(0x156)},'bin':{'$first':_0x236b47(0x18e)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x236b47(0x18d)},'primary_code':{'$first':_0x236b47(0x18f)},'secondary_code':{'$first':_0x236b47(0x17e)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x236b47(0x14e)},'rack':{'$first':_0x236b47(0x1a6)}}}]);console[_0x236b47(0x184)](_0x409be6);const _0x4c3df2=await warehouse[_0x236b47(0x19c)]([{'$match':{'status':_0x236b47(0x18c),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x236b47(0x150),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x31e202=await warehouse[_0x236b47(0x19c)]([{'$match':{'status':'Enabled','name':_0x236b47(0x192)}},{'$group':{'_id':_0x236b47(0x150),'name':{'$first':_0x236b47(0x150)}}},{'$sort':{'name':0x1}}]),_0x2f9ff9=await product['find']({});if(_0x4641a9[0x0][_0x236b47(0x185)]==_0x236b47(0x163)){var _0x5d1645=users[_0x236b47(0x157)];console[_0x236b47(0x184)](_0x5d1645);}else{if(_0x4641a9[0x0]['language']==_0x236b47(0x15e))var _0x5d1645=users[_0x236b47(0x15e)];else{if(_0x4641a9[0x0][_0x236b47(0x185)]=='German')var _0x5d1645=users['German'];else{if(_0x4641a9[0x0]['language']==_0x236b47(0x183))var _0x5d1645=users[_0x236b47(0x183)];else{if(_0x4641a9[0x0][_0x236b47(0x185)]=='French')var _0x5d1645=users[_0x236b47(0x14b)];else{if(_0x4641a9[0x0][_0x236b47(0x185)]=='Portuguese\x20(BR)')var _0x5d1645=users[_0x236b47(0x1ae)];else{if(_0x4641a9[0x0][_0x236b47(0x185)]==_0x236b47(0x162))var _0x5d1645=users[_0x236b47(0x162)];else{if(_0x4641a9[0x0][_0x236b47(0x185)]==_0x236b47(0x164))var _0x5d1645=users[_0x236b47(0x199)];}}}}}}}_0x520938[_0x236b47(0x139)]('return_sale_edit_finished',{'success':_0xed87c6[_0x236b47(0x15d)]('success'),'errors':_0xed87c6[_0x236b47(0x15d)](_0x236b47(0x1a8)),'role':_0x13f344,'profile':_0x31bb98,'master_shop':_0x4641a9,'user':_0x2b7c98,'stock':_0x409be6,'unit':_0x2f9ff9,'language':_0x5d1645,'warehouses':_0x4c3df2,'rooms':_0x1c1c83,'warehouse_QA':_0x31e202});}catch(_0x1509cf){console['log'](_0x1509cf);}}),router['post'](a0_0x33af92(0x190),auth,async(_0x53c17b,_0x3ba6b2)=>{var _0x3eef9d=a0_0x33af92;if(_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x13b)]=='QA')try{const _0x4f2506=_0x53c17b[_0x3eef9d(0x19e)]['id'],_0x3d0e14=await sales_return[_0x3eef9d(0x1ab)]({'invoice':_0x53c17b[_0x3eef9d(0x13c)]['invoice']}),_0x4eefe2=await warehouse[_0x3eef9d(0x1ab)]({'name':_0x3d0e14['ToWarehouse'],'room':_0x3d0e14['ToRoom']}),{invoice:_0x9e738d,customer:_0x379892,date:_0x2ab22f,warehouse_name:_0x554f3c,product_name:_0xcdba68,primary_code:_0x4e1add,secondary_code:_0x39d6e0,product_code:_0x1a62e5,sales_quantity:_0x4e5dc4,stocks:_0x5b4ef3,return_qty:_0x428b40,note:_0x252fdc,to_warehouse_name_QA:_0x4ce9ca,to_Room_name_QA:_0x3dec9d}=_0x53c17b['body'];if(typeof product_name_QA=='string')var _0x20aec7=[_0x53c17b[_0x3eef9d(0x13c)]['product_name_QA']],_0x5ba282=[_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x16e)]],_0xcc3b14=[_0x53c17b[_0x3eef9d(0x13c)]['secondary_code_QA']],_0x3d3c38=[_0x53c17b['body'][_0x3eef9d(0x153)]],_0x2d7248=[_0x53c17b['body'][_0x3eef9d(0x141)]],_0x1fe235=[_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x17c)]],_0x2446ff=[_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x19f)]];else var _0x20aec7=[..._0x53c17b[_0x3eef9d(0x13c)]['product_name_QA']],_0x5ba282=[..._0x53c17b[_0x3eef9d(0x13c)]['primary_code_QA']],_0xcc3b14=[..._0x53c17b['body']['secondary_code_QA']],_0x3d3c38=[..._0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x153)]],_0x2d7248=[..._0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x141)]],_0x1fe235=[..._0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x17c)]],_0x2446ff=[..._0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x19f)]];const _0x281e7c=_0x20aec7[_0x3eef9d(0x15c)](_0x15a656=>{return _0x15a656={'product_name':_0x15a656};});_0x5ba282[_0x3eef9d(0x14a)]((_0x6e3ce8,_0x441e21)=>{_0x281e7c[_0x441e21]['primary_code']=_0x6e3ce8;}),_0xcc3b14[_0x3eef9d(0x14a)]((_0x2ceb8a,_0x5502c6)=>{var _0x2da4dc=_0x3eef9d;_0x281e7c[_0x5502c6][_0x2da4dc(0x171)]=_0x2ceb8a;}),_0x3d3c38[_0x3eef9d(0x14a)]((_0x41bfaa,_0x53ef12)=>{var _0x315c64=_0x3eef9d;_0x281e7c[_0x53ef12][_0x315c64(0x166)]=_0x41bfaa;}),_0x2d7248[_0x3eef9d(0x14a)]((_0x4fad3d,_0x239bd1)=>{var _0x5994e7=_0x3eef9d;_0x281e7c[_0x239bd1][_0x5994e7(0x174)]=_0x4fad3d;}),_0x1fe235[_0x3eef9d(0x14a)]((_0x348813,_0xb2ef12)=>{var _0x410390=_0x3eef9d;_0x281e7c[_0xb2ef12][_0x410390(0x1af)]=_0x348813;}),_0x2446ff['forEach']((_0x75e1eb,_0xf62eb1)=>{_0x281e7c[_0xf62eb1]['return_qty']=_0x75e1eb;}),_0x3d0e14['return_sale_QA']['forEach'](_0x2c2e4a=>{var _0x19b861=_0x3eef9d;const _0x2e2f2f=_0x4eefe2[_0x19b861(0x178)][_0x19b861(0x15c)](_0x367d6f=>{var _0x1acf16=_0x19b861;_0x367d6f[_0x1acf16(0x16f)]==_0x2c2e4a[_0x1acf16(0x16f)]&&(_0x367d6f['product_stock']=parseInt(_0x367d6f[_0x1acf16(0x151)])+parseInt(_0x2c2e4a['return_qty']));});}),await _0x4eefe2['save'](),_0x3d0e14[_0x3eef9d(0x19a)]=_0x9e738d,_0x3d0e14[_0x3eef9d(0x175)]=_0x379892,_0x3d0e14[_0x3eef9d(0x16c)]=_0x2ab22f,_0x3d0e14['warehouse_name']=_0x554f3c,_0x3d0e14[_0x3eef9d(0x155)]=_0x281e7c,_0x3d0e14[_0x3eef9d(0x140)]=_0x252fdc,_0x3d0e14['ToWarehouse']=_0x4ce9ca,_0x3d0e14[_0x3eef9d(0x167)]=_0x3dec9d;const _0x41f67d=await _0x3d0e14[_0x3eef9d(0x154)](),_0x48a9c4=await c_payment_data[_0x3eef9d(0x1ab)]({'invoice':_0x53c17b[_0x3eef9d(0x13c)]['invoice'],'reason':_0x3eef9d(0x142)});_0x48a9c4[_0x3eef9d(0x180)]=_0x53c17b['body'][_0x3eef9d(0x180)],_0x48a9c4[_0x3eef9d(0x16c)]=_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x16c)],await _0x48a9c4['save'](),_0x53c17b[_0x3eef9d(0x15d)](_0x3eef9d(0x161),_0x3eef9d(0x148)),_0x3ba6b2['redirect']('/sales_return_finished/view');}catch(_0x1d5639){console[_0x3eef9d(0x184)](_0x1d5639),_0x3ba6b2[_0x3eef9d(0x1aa)](0xc8)[_0x3eef9d(0x14d)]({'message':_0x1d5639[_0x3eef9d(0x16d)]});}else try{const _0x25dfba=_0x53c17b[_0x3eef9d(0x19e)]['id'];console[_0x3eef9d(0x184)](_0x25dfba);const _0x151b8f=await sales_return[_0x3eef9d(0x1ab)]({'invoice':_0x53c17b[_0x3eef9d(0x13c)]['invoice']});console['log'](_0x3eef9d(0x191),_0x151b8f);const _0x35a454=await warehouse[_0x3eef9d(0x1ab)]({'name':_0x151b8f[_0x3eef9d(0x18a)],'room':_0x151b8f[_0x3eef9d(0x167)]});console['log']('old_warehouse_data',_0x35a454);const {invoice:_0x1ceda8,customer:_0x39b7e3,date:_0x744310,warehouse_name:_0x139c6f,product_name:_0x4001d4,primary_code:_0x119ea0,secondary_code:_0x319006,product_code:_0x306a23,sales_quantity:_0x3c4d9a,stocks:_0x3e1d99,return_qty:_0x56b030,note:_0x1bdadc,to_warehouse_name:_0x5d7fae,to_Room_name:_0x4c136b}=_0x53c17b['body'];console[_0x3eef9d(0x184)](_0x53c17b[_0x3eef9d(0x13c)]);if(typeof _0x4001d4==_0x3eef9d(0x193))var _0x20aec7=[_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x16f)]],_0x5ba282=[_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x1a1)]],_0xcc3b14=[_0x53c17b['body'][_0x3eef9d(0x171)]],_0x3d3c38=[_0x53c17b['body'][_0x3eef9d(0x166)]],_0x2d7248=[_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x17a)]],_0x1fe235=[_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x143)]],_0x2446ff=[_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x181)]],_0x243795=[_0x53c17b['body'][_0x3eef9d(0x177)]],_0x557732=[_0x53c17b['body'][_0x3eef9d(0x170)]],_0x18d936=[_0x53c17b['body'][_0x3eef9d(0x1b0)]],_0x3e3cda=[_0x53c17b['body'][_0x3eef9d(0x168)]];else var _0x20aec7=[..._0x53c17b[_0x3eef9d(0x13c)]['product_name']],_0x5ba282=[..._0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x1a1)]],_0xcc3b14=[..._0x53c17b['body'][_0x3eef9d(0x171)]],_0x3d3c38=[..._0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x166)]],_0x2d7248=[..._0x53c17b[_0x3eef9d(0x13c)]['sales_quantity']],_0x1fe235=[..._0x53c17b[_0x3eef9d(0x13c)]['stocks']],_0x2446ff=[..._0x53c17b[_0x3eef9d(0x13c)]['return_qty']],_0x243795=[..._0x53c17b['body'][_0x3eef9d(0x177)]],_0x557732=[..._0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x170)]],_0x18d936=[..._0x53c17b[_0x3eef9d(0x13c)]['types']],_0x3e3cda=[..._0x53c17b['body'][_0x3eef9d(0x168)]];const _0x47c4e7=_0x20aec7[_0x3eef9d(0x15c)](_0x1b6fd1=>{return _0x1b6fd1={'product_name':_0x1b6fd1};});_0x5ba282['forEach']((_0x21db5d,_0x5ed58f)=>{_0x47c4e7[_0x5ed58f]['primary_code']=_0x21db5d;}),_0xcc3b14[_0x3eef9d(0x14a)]((_0x18a423,_0x495154)=>{var _0x1d1470=_0x3eef9d;_0x47c4e7[_0x495154][_0x1d1470(0x171)]=_0x18a423;}),_0x3d3c38[_0x3eef9d(0x14a)]((_0x499083,_0x593f86)=>{var _0x56a3aa=_0x3eef9d;_0x47c4e7[_0x593f86][_0x56a3aa(0x166)]=_0x499083;}),_0x2d7248[_0x3eef9d(0x14a)]((_0x77cf08,_0x4804c8)=>{_0x47c4e7[_0x4804c8]['sale_qty']=_0x77cf08;}),_0x1fe235[_0x3eef9d(0x14a)]((_0x51c15a,_0x1b7ac1)=>{var _0x1c3b34=_0x3eef9d;_0x47c4e7[_0x1b7ac1][_0x1c3b34(0x1af)]=_0x51c15a;}),_0x2446ff[_0x3eef9d(0x14a)]((_0x332df3,_0xce7c9f)=>{var _0x28a5be=_0x3eef9d;_0x47c4e7[_0xce7c9f][_0x28a5be(0x181)]=_0x332df3;}),_0x243795[_0x3eef9d(0x14a)]((_0x2f0519,_0x2d74b8)=>{_0x47c4e7[_0x2d74b8]['bay']=_0x2f0519;}),_0x557732[_0x3eef9d(0x14a)]((_0x2c3f49,_0x9c2038)=>{var _0x40151a=_0x3eef9d;_0x47c4e7[_0x9c2038][_0x40151a(0x170)]=_0x2c3f49;}),_0x18d936[_0x3eef9d(0x14a)]((_0x27d425,_0x54ca28)=>{var _0x4f09f4=_0x3eef9d;_0x47c4e7[_0x54ca28][_0x4f09f4(0x160)]=_0x27d425;}),_0x3e3cda['forEach']((_0x5009a0,_0x5d460c)=>{var _0x5e67c3=_0x3eef9d;_0x47c4e7[_0x5d460c][_0x5e67c3(0x168)]=_0x5009a0;});var _0x390c7b=0x0;_0x47c4e7['forEach'](_0x38edcc=>{var _0x5bfe67=_0x3eef9d;console[_0x5bfe67(0x184)](_0x5bfe67(0x1a0),_0x38edcc),(parseInt(_0x38edcc[_0x5bfe67(0x174)])<parseInt(_0x38edcc[_0x5bfe67(0x181)])||parseInt(_0x38edcc['stock'])<parseInt(_0x38edcc[_0x5bfe67(0x181)])&&parseInt(_0x38edcc[_0x5bfe67(0x174)])>parseInt(_0x38edcc['return_qty'])||parseInt(_0x38edcc['return_qty'])==0x0)&&_0x390c7b++;});if(_0x390c7b!=0x0)return _0x53c17b[_0x3eef9d(0x15d)](_0x3eef9d(0x1a8),_0x3eef9d(0x1a4)),_0x3ba6b2[_0x3eef9d(0x13e)]('back');_0x151b8f[_0x3eef9d(0x149)][_0x3eef9d(0x14a)](_0x4975dd=>{var _0x2e0030=_0x3eef9d;const _0x7052b0=_0x35a454[_0x2e0030(0x178)][_0x2e0030(0x15c)](_0x11b059=>{var _0x5d696a=_0x2e0030;_0x11b059[_0x5d696a(0x16f)]==_0x4975dd[_0x5d696a(0x16f)]&&_0x11b059[_0x5d696a(0x168)]==_0x4975dd['floorlevel']&&_0x11b059[_0x5d696a(0x160)]==_0x4975dd['type']&&_0x11b059[_0x5d696a(0x170)]==_0x4975dd[_0x5d696a(0x170)]&&_0x11b059['bay']==_0x4975dd['bay']&&(_0x11b059[_0x5d696a(0x151)]=parseInt(_0x11b059[_0x5d696a(0x151)])+parseInt(_0x4975dd[_0x5d696a(0x181)]));});}),console[_0x3eef9d(0x184)](_0x3eef9d(0x189),_0x35a454),await _0x35a454[_0x3eef9d(0x154)](),_0x151b8f['invoice']=_0x1ceda8,_0x151b8f[_0x3eef9d(0x175)]=_0x39b7e3,_0x151b8f['date']=_0x744310,_0x151b8f['warehouse_name']=_0x139c6f,_0x151b8f[_0x3eef9d(0x149)]=_0x47c4e7,_0x151b8f[_0x3eef9d(0x140)]=_0x1bdadc,_0x151b8f[_0x3eef9d(0x18a)]=_0x5d7fae,_0x151b8f['ToRoom']=_0x4c136b;const _0xe15f34=await _0x151b8f[_0x3eef9d(0x154)]();console['log'](_0x3eef9d(0x1a7),_0xe15f34);const _0x5f5cd8=await c_payment_data[_0x3eef9d(0x1ab)]({'invoice':_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x19a)],'reason':_0x3eef9d(0x142)});_0x5f5cd8[_0x3eef9d(0x180)]=_0x53c17b[_0x3eef9d(0x13c)][_0x3eef9d(0x180)],_0x5f5cd8[_0x3eef9d(0x16c)]=_0x53c17b['body']['date'],await _0x5f5cd8['save'](),_0x53c17b[_0x3eef9d(0x15d)](_0x3eef9d(0x161),_0x3eef9d(0x148)),_0x3ba6b2[_0x3eef9d(0x13e)](_0x3eef9d(0x147));}catch(_0x334e72){console[_0x3eef9d(0x184)](_0x334e72),_0x3ba6b2['status'](0xc8)[_0x3eef9d(0x14d)]({'message':_0x334e72[_0x3eef9d(0x16d)]});}}),router[a0_0x33af92(0x188)](a0_0x33af92(0x186),auth,async(_0x4ccd6b,_0x4e3e6c)=>{var _0xcf53c3=a0_0x33af92;try{const _0xa1c362=_0x4ccd6b['params']['id'],{invoice:_0xc3c71d,customer:_0x16dbc4,payable_to_customer:_0x1ef50d,paid_amount:_0x18a7f8}=_0x4ccd6b[_0xcf53c3(0x13c)],_0x563e12=await sales_return[_0xcf53c3(0x197)](_0xa1c362);console[_0xcf53c3(0x184)]('data',_0x563e12),console[_0xcf53c3(0x184)](_0x1ef50d),console[_0xcf53c3(0x184)](_0x18a7f8);var _0x4f3630=_0x1ef50d-_0x18a7f8;console[_0xcf53c3(0x184)](_0xcf53c3(0x182),_0x4f3630),_0x563e12[_0xcf53c3(0x194)]=parseFloat(_0x18a7f8)+parseFloat(_0x563e12[_0xcf53c3(0x194)]),_0x563e12[_0xcf53c3(0x165)]=_0x4f3630,console[_0xcf53c3(0x184)](_0x563e12);const _0x131aac=await _0x563e12[_0xcf53c3(0x154)]();console[_0xcf53c3(0x184)](0x1b207);const _0x2b5f1e=await c_payment_data[_0xcf53c3(0x1ab)]({'invoice':_0x4ccd6b[_0xcf53c3(0x13c)][_0xcf53c3(0x19a)],'reason':_0xcf53c3(0x142)});console[_0xcf53c3(0x184)](_0xcf53c3(0x145),_0x2b5f1e),_0x2b5f1e[_0xcf53c3(0x187)]=_0x4f3630,await _0x2b5f1e['save']();let _0x25be15=new Date(),_0xc0d846=('0'+_0x25be15[_0xcf53c3(0x15a)]())['slice'](-0x2),_0x409b20=('0'+(_0x25be15[_0xcf53c3(0x17b)]()+0x1))[_0xcf53c3(0x16b)](-0x2),_0x1284a2=_0x25be15[_0xcf53c3(0x1a2)](),_0x223535=_0x1284a2+'-'+_0x409b20+'-'+_0xc0d846;const _0x327da4=new customer_payment({'invoice':_0xc3c71d,'date':_0x1284a2+'-'+_0x409b20+'-'+_0xc0d846,'customer':_0x16dbc4,'reason':_0xcf53c3(0x14c),'amount':_0x18a7f8}),_0xdbff4d=await _0x327da4[_0xcf53c3(0x154)]();_0x4ccd6b[_0xcf53c3(0x15d)](_0xcf53c3(0x161),_0xcf53c3(0x16a)),_0x4e3e6c[_0xcf53c3(0x13e)](_0xcf53c3(0x147));}catch(_0x539c4d){console[_0xcf53c3(0x184)](_0x539c4d);}}),router[a0_0x33af92(0x158)]('/invoice/:id',auth,async(_0x4185be,_0x5f3f6f)=>{var _0x5104e9=a0_0x33af92;try{const {username:_0x739c96,email:_0x1d317f,role:_0x13fc0f}=_0x4185be['user'],_0x4ea257=_0x4185be[_0x5104e9(0x169)],_0x20d6d0=await profile[_0x5104e9(0x1ab)]({'email':_0x4ea257[_0x5104e9(0x17d)]}),_0x24c81e=await master_shop[_0x5104e9(0x146)]();console[_0x5104e9(0x184)](_0x5104e9(0x15f),_0x24c81e);const _0x130861=_0x4185be['params']['id'],_0x5674a4=await sales_return[_0x5104e9(0x197)](_0x130861);console[_0x5104e9(0x184)](_0x5674a4);const _0x2ed601=await customer[_0x5104e9(0x1ab)]({'name':_0x5674a4[_0x5104e9(0x175)]});console[_0x5104e9(0x184)](_0x2ed601);if(_0x24c81e[0x0][_0x5104e9(0x185)]==_0x5104e9(0x163)){var _0x27edc5=users[_0x5104e9(0x157)];console[_0x5104e9(0x184)](_0x27edc5);}else{if(_0x24c81e[0x0][_0x5104e9(0x185)]==_0x5104e9(0x15e))var _0x27edc5=users['Hindi'];else{if(_0x24c81e[0x0][_0x5104e9(0x185)]=='German')var _0x27edc5=users['German'];else{if(_0x24c81e[0x0][_0x5104e9(0x185)]=='Spanish')var _0x27edc5=users[_0x5104e9(0x183)];else{if(_0x24c81e[0x0]['language']==_0x5104e9(0x14b))var _0x27edc5=users[_0x5104e9(0x14b)];else{if(_0x24c81e[0x0][_0x5104e9(0x185)]==_0x5104e9(0x13f))var _0x27edc5=users[_0x5104e9(0x1ae)];else{if(_0x24c81e[0x0]['language']==_0x5104e9(0x162))var _0x27edc5=users[_0x5104e9(0x162)];else{if(_0x24c81e[0x0]['language']==_0x5104e9(0x164))var _0x27edc5=users['Arabic'];}}}}}}}_0x5f3f6f[_0x5104e9(0x139)](_0x5104e9(0x19b),{'success':_0x4185be['flash'](_0x5104e9(0x161)),'errors':_0x4185be[_0x5104e9(0x15d)](_0x5104e9(0x1a8)),'role':_0x4ea257,'profile':_0x20d6d0,'master_shop':_0x24c81e,'customers':_0x2ed601,'sales':_0x5674a4,'language':_0x27edc5});}catch(_0x2e24e4){console[_0x5104e9(0x184)](_0x2e24e4);}}),module[a0_0x33af92(0x14f)]=router;