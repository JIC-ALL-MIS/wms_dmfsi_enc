var a0_0x1c71ba=a0_0x1dc3;function a0_0x4a4b(){var _0x2ce96f=['22BwrVOo','exports','../models/all_models','6UPKcBu','return_qty_QA','getFullYear','types','amount','json','Sale\x20Return','stocks_QA','Portuguese','/sales_return_finished/view','Chinese','$product_details.type','slice','render','$product_details.rack','success','email','$name','body','stock','Arabic\x20(ae)','$product_details.product_code','2652538JmRYLn','$customer_docs','product_code_QA','errors','Spanish','string','purchase\x20return\x20successfully','status','English\x20(US)','data','12435852qeOAGG','sales_return_invoice','Portuguese\x20(BR)','getMonth','$product_details.primary_code','Router','due_amount','product_name_QA','floorlevel','33028JlDRSz','flash','suppliers','aggregate','express','42220GwQSZe','type','/view','log','secondary_code','Finished\x20Goods','findById','redirect','product_code','old_warehouse_data','find','bay','back','forEach','subtract','bin','user','date','260VFVVLc','post','params','$product_details.bay','foreach\x20newproduct','Hindi','/view/:id','sale_qty','map','product_name','save','../middleware/auth','Arabic','$product_details.product_name','/give_payment/:id','master','language','20483oxEBsA','customer','c_payment','product_details','for_categorize','Enabled','get','warehouse_name','getDate','1133nejwHj','return_sale','sales_quantity_QA','findOne','product_stock','primary_code','customer_docs','German','ToWarehouse','customers','message','invoice','ToRoom','QA\x20Warehouse','$product_details.floorlevel','176272sYbjUl','sales_quantity','../public/language/languages.json','return_sale_QA','517002cLsbOG','126EyjldC','stocks','English','/sales_return/view','French','return_qty','secondary_code_QA'];a0_0x4a4b=function(){return _0x2ce96f;};return a0_0x4a4b();}(function(_0xc3dbe5,_0xf9d3c1){var _0x5d187d=a0_0x1dc3,_0x38f737=_0xc3dbe5();while(!![]){try{var _0x3e7d84=-parseInt(_0x5d187d(0x22d))/0x1*(-parseInt(_0x5d187d(0x251))/0x2)+parseInt(_0x5d187d(0x249))/0x3+-parseInt(_0x5d187d(0x205))/0x4*(-parseInt(_0x5d187d(0x21c))/0x5)+parseInt(_0x5d187d(0x254))/0x6*(parseInt(_0x5d187d(0x1f2))/0x7)+parseInt(_0x5d187d(0x245))/0x8*(-parseInt(_0x5d187d(0x24a))/0x9)+parseInt(_0x5d187d(0x20a))/0xa*(parseInt(_0x5d187d(0x236))/0xb)+-parseInt(_0x5d187d(0x1fc))/0xc;if(_0x3e7d84===_0xf9d3c1)break;else _0x38f737['push'](_0x38f737['shift']());}catch(_0x85b20f){_0x38f737['push'](_0x38f737['shift']());}}}(a0_0x4a4b,0x4844e));const express=require(a0_0x1c71ba(0x209)),app=express(),router=express[a0_0x1c71ba(0x201)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x1c71ba(0x253)),auth=require(a0_0x1c71ba(0x227)),users=require(a0_0x1c71ba(0x247));function a0_0x1dc3(_0x532649,_0x3c482c){var _0x4a4b12=a0_0x4a4b();return a0_0x1dc3=function(_0x1dc349,_0x112a11){_0x1dc349=_0x1dc349-0x1df;var _0x1ca8d4=_0x4a4b12[_0x1dc349];return _0x1ca8d4;},a0_0x1dc3(_0x532649,_0x3c482c);}router[a0_0x1c71ba(0x233)](a0_0x1c71ba(0x20c),auth,async(_0x46b3d7,_0x401200)=>{var _0x5a7b83=a0_0x1c71ba;try{const {username:_0x439f2c,email:_0x10679d,role:_0x378e06}=_0x46b3d7[_0x5a7b83(0x21a)],_0x129ad0=_0x46b3d7[_0x5a7b83(0x21a)],_0xfae7ec=await profile[_0x5a7b83(0x239)]({'email':_0x129ad0[_0x5a7b83(0x1ec)]}),_0x542177=await master_shop[_0x5a7b83(0x214)](),_0x59970c=await sales_return_finished[_0x5a7b83(0x208)]([{'$lookup':{'from':_0x5a7b83(0x23f),'localField':'customer','foreignField':'name','as':_0x5a7b83(0x23c)}},{'$unwind':_0x5a7b83(0x1f3)}]);if(_0x542177[0x0][_0x5a7b83(0x22c)]==_0x5a7b83(0x1fa)){var _0x4b0d81=users[_0x5a7b83(0x24c)];console[_0x5a7b83(0x20d)](_0x4b0d81);}else{if(_0x542177[0x0][_0x5a7b83(0x22c)]=='Hindi')var _0x4b0d81=users[_0x5a7b83(0x221)];else{if(_0x542177[0x0][_0x5a7b83(0x22c)]=='German')var _0x4b0d81=users['German'];else{if(_0x542177[0x0][_0x5a7b83(0x22c)]==_0x5a7b83(0x1f6))var _0x4b0d81=users[_0x5a7b83(0x1f6)];else{if(_0x542177[0x0][_0x5a7b83(0x22c)]=='French')var _0x4b0d81=users['French'];else{if(_0x542177[0x0][_0x5a7b83(0x22c)]==_0x5a7b83(0x1fe))var _0x4b0d81=users['Portuguese'];else{if(_0x542177[0x0][_0x5a7b83(0x22c)]==_0x5a7b83(0x1e6))var _0x4b0d81=users[_0x5a7b83(0x1e6)];else{if(_0x542177[0x0][_0x5a7b83(0x22c)]=='Arabic\x20(ae)')var _0x4b0d81=users['Arabic'];}}}}}}}_0x401200[_0x5a7b83(0x1e9)]('sales_return_finished',{'success':_0x46b3d7['flash'](_0x5a7b83(0x1eb)),'errors':_0x46b3d7['flash'](_0x5a7b83(0x1f5)),'role':_0x129ad0,'profile':_0xfae7ec,'master_shop':_0x542177,'user':_0x59970c,'language':_0x4b0d81});}catch(_0x10d1bb){console[_0x5a7b83(0x20d)](_0x10d1bb);}}),router['get'](a0_0x1c71ba(0x222),auth,async(_0x298424,_0x1c39c9)=>{var _0x336340=a0_0x1c71ba;try{const {username:_0x11086c,email:_0x1ae867,role:_0x5b785f}=_0x298424['user'],_0x279eb1=_0x298424[_0x336340(0x21a)],_0xa37f6=await profile['findOne']({'email':_0x279eb1[_0x336340(0x1ec)]}),_0x4d8a4a=await master_shop[_0x336340(0x214)]();console[_0x336340(0x20d)](_0x336340(0x22b),_0x4d8a4a);const _0x3ea912=_0x298424['params']['id'];console['log'](_0x3ea912);var _0x401c7c=['Return\x20Rooms'];const _0x50bb94=await sales_return_finished['findById'](_0x3ea912),_0xa6a7fd=await warehouse[_0x336340(0x208)]([{'$match':{'name':_0x50bb94[_0x336340(0x23e)],'room':_0x50bb94[_0x336340(0x242)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x336340(0x229)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x336340(0x21f)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x336340(0x1e7)},'floorlevel':{'$first':_0x336340(0x244)},'primary_code':{'$first':_0x336340(0x200)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x336340(0x1f1)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x336340(0x1ea)}}}]);console[_0x336340(0x20d)](_0xa6a7fd);const _0x3976bf=await warehouse[_0x336340(0x208)]([{'$match':{'status':_0x336340(0x232),'warehouse_category':_0x336340(0x20f)}},{'$group':{'_id':_0x336340(0x1ed),'name':{'$first':_0x336340(0x1ed)}}},{'$sort':{'name':0x1}}]),_0x2973d0=await warehouse[_0x336340(0x208)]([{'$match':{'status':_0x336340(0x232),'name':_0x336340(0x243)}},{'$group':{'_id':_0x336340(0x1ed),'name':{'$first':_0x336340(0x1ed)}}},{'$sort':{'name':0x1}}]),_0x4ccd32=await product[_0x336340(0x214)]({});if(_0x4d8a4a[0x0]['language']=='English\x20(US)'){var _0x4aa0c8=users['English'];console[_0x336340(0x20d)](_0x4aa0c8);}else{if(_0x4d8a4a[0x0][_0x336340(0x22c)]==_0x336340(0x221))var _0x4aa0c8=users[_0x336340(0x221)];else{if(_0x4d8a4a[0x0]['language']==_0x336340(0x23d))var _0x4aa0c8=users[_0x336340(0x23d)];else{if(_0x4d8a4a[0x0][_0x336340(0x22c)]=='Spanish')var _0x4aa0c8=users[_0x336340(0x1f6)];else{if(_0x4d8a4a[0x0][_0x336340(0x22c)]==_0x336340(0x24e))var _0x4aa0c8=users[_0x336340(0x24e)];else{if(_0x4d8a4a[0x0][_0x336340(0x22c)]==_0x336340(0x1fe))var _0x4aa0c8=users[_0x336340(0x1e4)];else{if(_0x4d8a4a[0x0]['language']==_0x336340(0x1e6))var _0x4aa0c8=users[_0x336340(0x1e6)];else{if(_0x4d8a4a[0x0]['language']=='Arabic\x20(ae)')var _0x4aa0c8=users[_0x336340(0x228)];}}}}}}}_0x1c39c9[_0x336340(0x1e9)]('return_sale_edit_finished',{'success':_0x298424[_0x336340(0x206)](_0x336340(0x1eb)),'errors':_0x298424['flash'](_0x336340(0x1f5)),'role':_0x279eb1,'profile':_0xa37f6,'master_shop':_0x4d8a4a,'user':_0x50bb94,'stock':_0xa6a7fd,'unit':_0x4ccd32,'language':_0x4aa0c8,'warehouses':_0x3976bf,'rooms':_0x401c7c,'warehouse_QA':_0x2973d0});}catch(_0xbfc3a8){console[_0x336340(0x20d)](_0xbfc3a8);}}),router[a0_0x1c71ba(0x21d)](a0_0x1c71ba(0x222),auth,async(_0xb4ed0a,_0x3126a4)=>{var _0x321a5a=a0_0x1c71ba;if(_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x231)]=='QA')try{const _0x3d69f3=_0xb4ed0a[_0x321a5a(0x21e)]['id'],_0x5ead00=await sales_return['findOne']({'invoice':_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x241)]}),_0x4ed9fb=await warehouse[_0x321a5a(0x239)]({'name':_0x5ead00[_0x321a5a(0x23e)],'room':_0x5ead00[_0x321a5a(0x242)]}),{invoice:_0x1f0033,customer:_0x2204af,date:_0x4ae190,warehouse_name:_0x4d61cc,product_name:_0x2b8677,primary_code:_0x4fe4cb,secondary_code:_0x333dc9,product_code:_0x2b698d,sales_quantity:_0x3bf744,stocks:_0x7baa24,return_qty:_0x4e8c4a,note:_0x4605a2,to_warehouse_name_QA:_0x3f2d86,to_Room_name_QA:_0x104156}=_0xb4ed0a[_0x321a5a(0x1ee)];if(typeof product_name_QA==_0x321a5a(0x1f7))var _0x531dc2=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x203)]],_0xecc4b6=[_0xb4ed0a[_0x321a5a(0x1ee)]['primary_code_QA']],_0xb22068=[_0xb4ed0a['body'][_0x321a5a(0x250)]],_0x112566=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x1f4)]],_0x45d0e0=[_0xb4ed0a['body']['sales_quantity_QA']],_0x27f82f=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x1e3)]],_0x4a925c=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x255)]];else var _0x531dc2=[..._0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x203)]],_0xecc4b6=[..._0xb4ed0a[_0x321a5a(0x1ee)]['primary_code_QA']],_0xb22068=[..._0xb4ed0a[_0x321a5a(0x1ee)]['secondary_code_QA']],_0x112566=[..._0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x1f4)]],_0x45d0e0=[..._0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x238)]],_0x27f82f=[..._0xb4ed0a['body']['stocks_QA']],_0x4a925c=[..._0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x255)]];const _0x43cd64=_0x531dc2['map'](_0x1e712b=>{return _0x1e712b={'product_name':_0x1e712b};});_0xecc4b6[_0x321a5a(0x217)]((_0x5a8a22,_0x505df6)=>{_0x43cd64[_0x505df6]['primary_code']=_0x5a8a22;}),_0xb22068[_0x321a5a(0x217)]((_0x10f76c,_0x249bb0)=>{var _0x2b1379=_0x321a5a;_0x43cd64[_0x249bb0][_0x2b1379(0x20e)]=_0x10f76c;}),_0x112566[_0x321a5a(0x217)]((_0x27cd4d,_0xfe9a9e)=>{_0x43cd64[_0xfe9a9e]['product_code']=_0x27cd4d;}),_0x45d0e0[_0x321a5a(0x217)]((_0x1978f5,_0x2b1fa6)=>{var _0x58b612=_0x321a5a;_0x43cd64[_0x2b1fa6][_0x58b612(0x223)]=_0x1978f5;}),_0x27f82f['forEach']((_0x29f3cd,_0x4b8ad4)=>{var _0x21ae8e=_0x321a5a;_0x43cd64[_0x4b8ad4][_0x21ae8e(0x1ef)]=_0x29f3cd;}),_0x4a925c[_0x321a5a(0x217)]((_0x1485ad,_0xfb6b78)=>{var _0x37096d=_0x321a5a;_0x43cd64[_0xfb6b78][_0x37096d(0x24f)]=_0x1485ad;}),_0x5ead00[_0x321a5a(0x248)][_0x321a5a(0x217)](_0x26cb58=>{var _0x3757ca=_0x321a5a;const _0x39f41a=_0x4ed9fb[_0x3757ca(0x230)][_0x3757ca(0x224)](_0x3fec04=>{var _0x4306f1=_0x3757ca;_0x3fec04[_0x4306f1(0x225)]==_0x26cb58[_0x4306f1(0x225)]&&(_0x3fec04[_0x4306f1(0x23a)]=parseInt(_0x3fec04[_0x4306f1(0x23a)])+parseInt(_0x26cb58[_0x4306f1(0x24f)]));});}),await _0x4ed9fb['save'](),_0x5ead00[_0x321a5a(0x241)]=_0x1f0033,_0x5ead00[_0x321a5a(0x22e)]=_0x2204af,_0x5ead00[_0x321a5a(0x21b)]=_0x4ae190,_0x5ead00[_0x321a5a(0x234)]=_0x4d61cc,_0x5ead00['return_sale_QA']=_0x43cd64,_0x5ead00['note']=_0x4605a2,_0x5ead00[_0x321a5a(0x23e)]=_0x3f2d86,_0x5ead00['ToRoom']=_0x104156;const _0x26779b=await _0x5ead00['save'](),_0x5d85de=await c_payment_data[_0x321a5a(0x239)]({'invoice':_0xb4ed0a[_0x321a5a(0x1ee)]['invoice'],'reason':_0x321a5a(0x1e2)});_0x5d85de[_0x321a5a(0x207)]=_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x207)],_0x5d85de['date']=_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x21b)],await _0x5d85de[_0x321a5a(0x226)](),_0xb4ed0a[_0x321a5a(0x206)]('success',_0x321a5a(0x1f8)),_0x3126a4['redirect'](_0x321a5a(0x1e5));}catch(_0x3b5c89){console[_0x321a5a(0x20d)](_0x3b5c89),_0x3126a4[_0x321a5a(0x1f9)](0xc8)[_0x321a5a(0x1e1)]({'message':_0x3b5c89[_0x321a5a(0x240)]});}else try{const _0x1eca69=_0xb4ed0a[_0x321a5a(0x21e)]['id'];console['log'](_0x1eca69);const _0x157d43=await sales_return[_0x321a5a(0x239)]({'invoice':_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x241)]});console['log']('old_data',_0x157d43);const _0x147e41=await warehouse[_0x321a5a(0x239)]({'name':_0x157d43[_0x321a5a(0x23e)],'room':_0x157d43[_0x321a5a(0x242)]});console[_0x321a5a(0x20d)](_0x321a5a(0x213),_0x147e41);const {invoice:_0x2b8e2e,customer:_0x414391,date:_0x5bfbcd,warehouse_name:_0x18d4d5,product_name:_0x5ec986,primary_code:_0x4e939e,secondary_code:_0x4be0e4,product_code:_0x309e62,sales_quantity:_0x2e36aa,stocks:_0x1b8343,return_qty:_0x36fc07,note:_0x51f5df,to_warehouse_name:_0x3d88c9,to_Room_name:_0x2d7b9f}=_0xb4ed0a[_0x321a5a(0x1ee)];console[_0x321a5a(0x20d)](_0xb4ed0a[_0x321a5a(0x1ee)]);if(typeof _0x5ec986==_0x321a5a(0x1f7))var _0x531dc2=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x225)]],_0xecc4b6=[_0xb4ed0a['body'][_0x321a5a(0x23b)]],_0xb22068=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x20e)]],_0x112566=[_0xb4ed0a[_0x321a5a(0x1ee)]['product_code']],_0x45d0e0=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x246)]],_0x27f82f=[_0xb4ed0a['body'][_0x321a5a(0x24b)]],_0x4a925c=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x24f)]],_0x37f42f=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x215)]],_0x4ef595=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x219)]],_0x67c1a0=[_0xb4ed0a['body'][_0x321a5a(0x1df)]],_0x51aad0=[_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x204)]];else var _0x531dc2=[..._0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x225)]],_0xecc4b6=[..._0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x23b)]],_0xb22068=[..._0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x20e)]],_0x112566=[..._0xb4ed0a['body'][_0x321a5a(0x212)]],_0x45d0e0=[..._0xb4ed0a['body']['sales_quantity']],_0x27f82f=[..._0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x24b)]],_0x4a925c=[..._0xb4ed0a[_0x321a5a(0x1ee)]['return_qty']],_0x37f42f=[..._0xb4ed0a[_0x321a5a(0x1ee)]['bay']],_0x4ef595=[..._0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x219)]],_0x67c1a0=[..._0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x1df)]],_0x51aad0=[..._0xb4ed0a[_0x321a5a(0x1ee)]['floorlevel']];const _0x59252b=_0x531dc2['map'](_0x48d882=>{return _0x48d882={'product_name':_0x48d882};});_0xecc4b6[_0x321a5a(0x217)]((_0xc4a0c9,_0x447d5a)=>{var _0x4a0628=_0x321a5a;_0x59252b[_0x447d5a][_0x4a0628(0x23b)]=_0xc4a0c9;}),_0xb22068['forEach']((_0x55056f,_0x1148b6)=>{var _0x30da88=_0x321a5a;_0x59252b[_0x1148b6][_0x30da88(0x20e)]=_0x55056f;}),_0x112566[_0x321a5a(0x217)]((_0x10ddef,_0x546cdd)=>{var _0xec2a11=_0x321a5a;_0x59252b[_0x546cdd][_0xec2a11(0x212)]=_0x10ddef;}),_0x45d0e0['forEach']((_0x56681e,_0x2e3e6b)=>{var _0x14e749=_0x321a5a;_0x59252b[_0x2e3e6b][_0x14e749(0x223)]=_0x56681e;}),_0x27f82f[_0x321a5a(0x217)]((_0x5e7d2a,_0x59e942)=>{var _0x8b8245=_0x321a5a;_0x59252b[_0x59e942][_0x8b8245(0x1ef)]=_0x5e7d2a;}),_0x4a925c[_0x321a5a(0x217)]((_0x2e51e8,_0x2fb631)=>{_0x59252b[_0x2fb631]['return_qty']=_0x2e51e8;}),_0x37f42f[_0x321a5a(0x217)]((_0x7b630c,_0xb715b9)=>{_0x59252b[_0xb715b9]['bay']=_0x7b630c;}),_0x4ef595[_0x321a5a(0x217)]((_0x219d22,_0x5b6438)=>{var _0x4578b6=_0x321a5a;_0x59252b[_0x5b6438][_0x4578b6(0x219)]=_0x219d22;}),_0x67c1a0['forEach']((_0xabb7bb,_0x259c00)=>{var _0x2da59c=_0x321a5a;_0x59252b[_0x259c00][_0x2da59c(0x20b)]=_0xabb7bb;}),_0x51aad0[_0x321a5a(0x217)]((_0x49a39d,_0x2d6daa)=>{var _0x35bcc1=_0x321a5a;_0x59252b[_0x2d6daa][_0x35bcc1(0x204)]=_0x49a39d;});var _0x83c40=0x0;_0x59252b[_0x321a5a(0x217)](_0x2b572e=>{var _0xd7ba1e=_0x321a5a;console[_0xd7ba1e(0x20d)](_0xd7ba1e(0x220),_0x2b572e),(parseInt(_0x2b572e['sale_qty'])<parseInt(_0x2b572e[_0xd7ba1e(0x24f)])||parseInt(_0x2b572e[_0xd7ba1e(0x1ef)])<parseInt(_0x2b572e[_0xd7ba1e(0x24f)])&&parseInt(_0x2b572e[_0xd7ba1e(0x223)])>parseInt(_0x2b572e[_0xd7ba1e(0x24f)])||parseInt(_0x2b572e['return_qty'])==0x0)&&_0x83c40++;});if(_0x83c40!=0x0)return _0xb4ed0a[_0x321a5a(0x206)]('errors','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x3126a4[_0x321a5a(0x211)](_0x321a5a(0x216));_0x157d43[_0x321a5a(0x237)][_0x321a5a(0x217)](_0x1ea186=>{var _0x129768=_0x321a5a;const _0x3114a3=_0x147e41['product_details'][_0x129768(0x224)](_0x107d61=>{var _0xaf03c2=_0x129768;_0x107d61[_0xaf03c2(0x225)]==_0x1ea186[_0xaf03c2(0x225)]&&_0x107d61[_0xaf03c2(0x204)]==_0x1ea186['floorlevel']&&_0x107d61[_0xaf03c2(0x20b)]==_0x1ea186[_0xaf03c2(0x20b)]&&_0x107d61[_0xaf03c2(0x219)]==_0x1ea186[_0xaf03c2(0x219)]&&_0x107d61[_0xaf03c2(0x215)]==_0x1ea186[_0xaf03c2(0x215)]&&(_0x107d61[_0xaf03c2(0x23a)]=parseInt(_0x107d61['product_stock'])+parseInt(_0x1ea186[_0xaf03c2(0x24f)]));});}),console[_0x321a5a(0x20d)](_0x321a5a(0x213),_0x147e41),await _0x147e41[_0x321a5a(0x226)](),_0x157d43[_0x321a5a(0x241)]=_0x2b8e2e,_0x157d43[_0x321a5a(0x22e)]=_0x414391,_0x157d43['date']=_0x5bfbcd,_0x157d43[_0x321a5a(0x234)]=_0x18d4d5,_0x157d43[_0x321a5a(0x237)]=_0x59252b,_0x157d43['note']=_0x51f5df,_0x157d43[_0x321a5a(0x23e)]=_0x3d88c9,_0x157d43[_0x321a5a(0x242)]=_0x2d7b9f;const _0xc73a5d=await _0x157d43[_0x321a5a(0x226)]();console['log']('new\x20new_data',_0xc73a5d);const _0x8c6d4b=await c_payment_data[_0x321a5a(0x239)]({'invoice':_0xb4ed0a[_0x321a5a(0x1ee)]['invoice'],'reason':_0x321a5a(0x1e2)});_0x8c6d4b[_0x321a5a(0x207)]=_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x207)],_0x8c6d4b[_0x321a5a(0x21b)]=_0xb4ed0a[_0x321a5a(0x1ee)][_0x321a5a(0x21b)],await _0x8c6d4b['save'](),_0xb4ed0a[_0x321a5a(0x206)](_0x321a5a(0x1eb),_0x321a5a(0x1f8)),_0x3126a4['redirect'](_0x321a5a(0x24d));}catch(_0x2a289d){console[_0x321a5a(0x20d)](_0x2a289d),_0x3126a4[_0x321a5a(0x1f9)](0xc8)[_0x321a5a(0x1e1)]({'message':_0x2a289d['message']});}}),router[a0_0x1c71ba(0x21d)](a0_0x1c71ba(0x22a),auth,async(_0x4ca0d9,_0x3e18ae)=>{var _0x1340da=a0_0x1c71ba;try{const _0x258e5d=_0x4ca0d9[_0x1340da(0x21e)]['id'],{invoice:_0x5abc75,customer:_0x4e3686,payable_to_customer:_0x237b7e,paid_amount:_0x4cb47d}=_0x4ca0d9['body'],_0x44dc9f=await sales_return['findById'](_0x258e5d);console['log'](_0x1340da(0x1fb),_0x44dc9f),console[_0x1340da(0x20d)](_0x237b7e),console[_0x1340da(0x20d)](_0x4cb47d);var _0x4889f2=_0x237b7e-_0x4cb47d;console[_0x1340da(0x20d)](_0x1340da(0x218),_0x4889f2),_0x44dc9f['paid_amount']=parseFloat(_0x4cb47d)+parseFloat(_0x44dc9f['paid_amount']),_0x44dc9f[_0x1340da(0x202)]=_0x4889f2,console[_0x1340da(0x20d)](_0x44dc9f);const _0x59b469=await _0x44dc9f[_0x1340da(0x226)]();console[_0x1340da(0x20d)](0x1b207);const _0x14c14c=await c_payment_data['findOne']({'invoice':_0x4ca0d9[_0x1340da(0x1ee)]['invoice'],'reason':_0x1340da(0x1e2)});console['log'](_0x1340da(0x22f),_0x14c14c),_0x14c14c[_0x1340da(0x1e0)]=_0x4889f2,await _0x14c14c[_0x1340da(0x226)]();let _0x3cd4ba=new Date(),_0x494f49=('0'+_0x3cd4ba[_0x1340da(0x235)]())[_0x1340da(0x1e8)](-0x2),_0x59489d=('0'+(_0x3cd4ba[_0x1340da(0x1ff)]()+0x1))[_0x1340da(0x1e8)](-0x2),_0x180ed3=_0x3cd4ba[_0x1340da(0x256)](),_0xf4aa7e=_0x180ed3+'-'+_0x59489d+'-'+_0x494f49;const _0x25af08=new customer_payment({'invoice':_0x5abc75,'date':_0x180ed3+'-'+_0x59489d+'-'+_0x494f49,'customer':_0x4e3686,'reason':'Returned\x20Payment\x20For\x20Sale\x20Return','amount':_0x4cb47d}),_0x24b41e=await _0x25af08['save']();_0x4ca0d9[_0x1340da(0x206)](_0x1340da(0x1eb),'payment\x20successfull'),_0x3e18ae[_0x1340da(0x211)]('/sales_return/view');}catch(_0x5c8abe){console['log'](_0x5c8abe);}}),router[a0_0x1c71ba(0x233)]('/invoice/:id',auth,async(_0x245d72,_0x1636ec)=>{var _0x383799=a0_0x1c71ba;try{const {username:_0x48de08,email:_0xd47657,role:_0x14cd98}=_0x245d72[_0x383799(0x21a)],_0x573291=_0x245d72[_0x383799(0x21a)],_0x150e9a=await profile[_0x383799(0x239)]({'email':_0x573291[_0x383799(0x1ec)]}),_0x160ae0=await master_shop[_0x383799(0x214)]();console[_0x383799(0x20d)](_0x383799(0x22b),_0x160ae0);const _0x38239c=_0x245d72[_0x383799(0x21e)]['id'],_0x1d40f7=await sales_return[_0x383799(0x210)](_0x38239c);console[_0x383799(0x20d)](_0x1d40f7);const _0x14d631=await customer[_0x383799(0x239)]({'name':_0x1d40f7['customer']});console[_0x383799(0x20d)](_0x14d631);if(_0x160ae0[0x0]['language']==_0x383799(0x1fa)){var _0x1cc105=users[_0x383799(0x24c)];console['log'](_0x1cc105);}else{if(_0x160ae0[0x0]['language']==_0x383799(0x221))var _0x1cc105=users[_0x383799(0x221)];else{if(_0x160ae0[0x0][_0x383799(0x22c)]==_0x383799(0x23d))var _0x1cc105=users[_0x383799(0x23d)];else{if(_0x160ae0[0x0]['language']==_0x383799(0x1f6))var _0x1cc105=users[_0x383799(0x1f6)];else{if(_0x160ae0[0x0][_0x383799(0x22c)]==_0x383799(0x24e))var _0x1cc105=users['French'];else{if(_0x160ae0[0x0][_0x383799(0x22c)]==_0x383799(0x1fe))var _0x1cc105=users[_0x383799(0x1e4)];else{if(_0x160ae0[0x0]['language']==_0x383799(0x1e6))var _0x1cc105=users[_0x383799(0x1e6)];else{if(_0x160ae0[0x0]['language']==_0x383799(0x1f0))var _0x1cc105=users[_0x383799(0x228)];}}}}}}}_0x1636ec['render'](_0x383799(0x1fd),{'success':_0x245d72['flash'](_0x383799(0x1eb)),'errors':_0x245d72[_0x383799(0x206)](_0x383799(0x1f5)),'role':_0x573291,'profile':_0x150e9a,'master_shop':_0x160ae0,'customers':_0x14d631,'sales':_0x1d40f7,'language':_0x1cc105});}catch(_0x4f36ed){console['log'](_0x4f36ed);}}),module[a0_0x1c71ba(0x252)]=router;