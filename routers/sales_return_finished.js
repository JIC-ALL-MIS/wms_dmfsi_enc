var a0_0x32c786=a0_0x17a6;(function(_0x3c10cc,_0x32445b){var _0x2482e1=a0_0x17a6,_0x2ee2d1=_0x3c10cc();while(!![]){try{var _0x573369=parseInt(_0x2482e1(0xf7))/0x1+-parseInt(_0x2482e1(0xdc))/0x2+parseInt(_0x2482e1(0x11c))/0x3+-parseInt(_0x2482e1(0xd9))/0x4*(-parseInt(_0x2482e1(0xea))/0x5)+-parseInt(_0x2482e1(0x129))/0x6*(parseInt(_0x2482e1(0xf0))/0x7)+-parseInt(_0x2482e1(0x138))/0x8+parseInt(_0x2482e1(0x10b))/0x9;if(_0x573369===_0x32445b)break;else _0x2ee2d1['push'](_0x2ee2d1['shift']());}catch(_0xd61ceb){_0x2ee2d1['push'](_0x2ee2d1['shift']());}}}(a0_0x1ed2,0x26a8e));const express=require(a0_0x32c786(0xc7)),app=express(),router=express[a0_0x32c786(0x140)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require(a0_0x32c786(0xd0)),users=require(a0_0x32c786(0x10a));function a0_0x17a6(_0x9bec4b,_0x155faf){var _0x1ed25f=a0_0x1ed2();return a0_0x17a6=function(_0x17a6be,_0x227fe2){_0x17a6be=_0x17a6be-0xc3;var _0xee6a83=_0x1ed25f[_0x17a6be];return _0xee6a83;},a0_0x17a6(_0x9bec4b,_0x155faf);}router[a0_0x32c786(0x100)](a0_0x32c786(0x13d),auth,async(_0x562a4a,_0x38d4a9)=>{var _0x48891b=a0_0x32c786;try{const {username:_0x477034,email:_0x70e053,role:_0x3f3eb4}=_0x562a4a[_0x48891b(0x109)],_0x28acb0=_0x562a4a[_0x48891b(0x109)],_0x5b925a=await profile['findOne']({'email':_0x28acb0[_0x48891b(0xef)]}),_0xe1e143=await master_shop[_0x48891b(0x116)](),_0x27a870=await sales_return_finished[_0x48891b(0x131)]([{'$lookup':{'from':_0x48891b(0xe6),'localField':_0x48891b(0xf4),'foreignField':'name','as':_0x48891b(0xf1)}},{'$unwind':_0x48891b(0x118)}]);if(_0xe1e143[0x0]['language']=='English\x20(US)'){var _0x471119=users['English'];console[_0x48891b(0xfb)](_0x471119);}else{if(_0xe1e143[0x0][_0x48891b(0xd7)]==_0x48891b(0xcd))var _0x471119=users[_0x48891b(0xcd)];else{if(_0xe1e143[0x0][_0x48891b(0xd7)]==_0x48891b(0x12f))var _0x471119=users[_0x48891b(0x12f)];else{if(_0xe1e143[0x0][_0x48891b(0xd7)]==_0x48891b(0xfa))var _0x471119=users[_0x48891b(0xfa)];else{if(_0xe1e143[0x0]['language']==_0x48891b(0x12a))var _0x471119=users[_0x48891b(0x12a)];else{if(_0xe1e143[0x0][_0x48891b(0xd7)]==_0x48891b(0x119))var _0x471119=users[_0x48891b(0xee)];else{if(_0xe1e143[0x0]['language']==_0x48891b(0x12c))var _0x471119=users[_0x48891b(0x12c)];else{if(_0xe1e143[0x0][_0x48891b(0xd7)]==_0x48891b(0xe8))var _0x471119=users[_0x48891b(0xda)];}}}}}}}_0x38d4a9[_0x48891b(0x10f)](_0x48891b(0xe2),{'success':_0x562a4a[_0x48891b(0xfd)](_0x48891b(0xe0)),'errors':_0x562a4a[_0x48891b(0xfd)](_0x48891b(0xd2)),'role':_0x28acb0,'profile':_0x5b925a,'master_shop':_0xe1e143,'user':_0x27a870,'language':_0x471119});}catch(_0x287759){console[_0x48891b(0xfb)](_0x287759);}}),router[a0_0x32c786(0x100)](a0_0x32c786(0x124),auth,async(_0x35761c,_0x21d3ed)=>{var _0x3d8a23=a0_0x32c786;try{const {username:_0x40df22,email:_0x1a3658,role:_0x4c5881}=_0x35761c[_0x3d8a23(0x109)],_0x30327d=_0x35761c['user'],_0x23be7c=await profile[_0x3d8a23(0x127)]({'email':_0x30327d['email']}),_0x230635=await master_shop['find']();console['log'](_0x3d8a23(0xe9),_0x230635);const _0x1d17d5=_0x35761c[_0x3d8a23(0x139)]['id'];console['log'](_0x1d17d5);var _0x59ed4a=[_0x3d8a23(0xec)];const _0x5344b8=await sales_return_finished['findById'](_0x1d17d5),_0x5cccfc=await warehouse[_0x3d8a23(0x131)]([{'$match':{'name':_0x5344b8[_0x3d8a23(0x10c)],'room':_0x5344b8[_0x3d8a23(0xd8)]}},{'$unwind':_0x3d8a23(0xdd)},{'$group':{'_id':_0x3d8a23(0xc8),'name':{'$first':_0x3d8a23(0xcf)},'product_stock':{'$first':_0x3d8a23(0xd3)},'bay':{'$first':_0x3d8a23(0x132)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3d8a23(0xe5)},'floorlevel':{'$first':_0x3d8a23(0x101)},'primary_code':{'$first':_0x3d8a23(0x13a)},'secondary_code':{'$first':_0x3d8a23(0x112)},'product_code':{'$first':_0x3d8a23(0x114)},'storage':{'$first':_0x3d8a23(0xfc)},'rack':{'$first':_0x3d8a23(0xc9)}}}]);console[_0x3d8a23(0xfb)](_0x5cccfc);const _0x5d9378=await warehouse[_0x3d8a23(0x131)]([{'$match':{'status':_0x3d8a23(0x117),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':'$name','name':{'$first':_0x3d8a23(0x123)}}},{'$sort':{'name':0x1}}]),_0x3b85d7=await warehouse[_0x3d8a23(0x131)]([{'$match':{'status':_0x3d8a23(0x117),'name':_0x3d8a23(0xd1)}},{'$group':{'_id':_0x3d8a23(0x123),'name':{'$first':_0x3d8a23(0x123)}}},{'$sort':{'name':0x1}}]),_0x577c42=await product['find']({});if(_0x230635[0x0][_0x3d8a23(0xd7)]==_0x3d8a23(0xc3)){var _0x3dcb9f=users[_0x3d8a23(0x135)];console[_0x3d8a23(0xfb)](_0x3dcb9f);}else{if(_0x230635[0x0][_0x3d8a23(0xd7)]==_0x3d8a23(0xcd))var _0x3dcb9f=users[_0x3d8a23(0xcd)];else{if(_0x230635[0x0][_0x3d8a23(0xd7)]=='German')var _0x3dcb9f=users[_0x3d8a23(0x12f)];else{if(_0x230635[0x0][_0x3d8a23(0xd7)]=='Spanish')var _0x3dcb9f=users['Spanish'];else{if(_0x230635[0x0][_0x3d8a23(0xd7)]==_0x3d8a23(0x12a))var _0x3dcb9f=users[_0x3d8a23(0x12a)];else{if(_0x230635[0x0][_0x3d8a23(0xd7)]==_0x3d8a23(0x119))var _0x3dcb9f=users['Portuguese'];else{if(_0x230635[0x0][_0x3d8a23(0xd7)]=='Chinese')var _0x3dcb9f=users[_0x3d8a23(0x12c)];else{if(_0x230635[0x0][_0x3d8a23(0xd7)]=='Arabic\x20(ae)')var _0x3dcb9f=users['Arabic'];}}}}}}}_0x21d3ed['render']('return_sale_edit_finished',{'success':_0x35761c[_0x3d8a23(0xfd)](_0x3d8a23(0xe0)),'errors':_0x35761c[_0x3d8a23(0xfd)](_0x3d8a23(0xd2)),'role':_0x30327d,'profile':_0x23be7c,'master_shop':_0x230635,'user':_0x5344b8,'stock':_0x5cccfc,'unit':_0x577c42,'language':_0x3dcb9f,'warehouses':_0x5d9378,'rooms':_0x59ed4a,'warehouse_QA':_0x3b85d7});}catch(_0xfbfcad){console[_0x3d8a23(0xfb)](_0xfbfcad);}}),router['post'](a0_0x32c786(0x124),auth,async(_0x51ed9f,_0x4d40bf)=>{var _0x24a043=a0_0x32c786;if(_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xd5)]=='QA')try{const _0x27b494=_0x51ed9f[_0x24a043(0x139)]['id'],_0x13501f=await sales_return[_0x24a043(0x127)]({'invoice':_0x51ed9f['body'][_0x24a043(0xe3)]}),_0x2977c0=await warehouse[_0x24a043(0x127)]({'name':_0x13501f[_0x24a043(0x10c)],'room':_0x13501f[_0x24a043(0xd8)]}),{invoice:_0x3619ed,customer:_0x2db812,date:_0x34c5b5,warehouse_name:_0x4f452c,product_name:_0x177ef5,primary_code:_0x4fca21,secondary_code:_0x29f224,product_code:_0x37e193,sales_quantity:_0x4f22e5,stocks:_0x2bba2a,return_qty:_0x2547d8,note:_0x579b04,to_warehouse_name_QA:_0x26d9bb,to_Room_name_QA:_0x371caf}=_0x51ed9f[_0x24a043(0x12b)];if(typeof product_name_QA=='string')var _0x47fdad=[_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0x125)]],_0x1d4093=[_0x51ed9f['body'][_0x24a043(0xf3)]],_0x4603c6=[_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0x11b)]],_0x3e3f94=[_0x51ed9f['body'][_0x24a043(0x106)]],_0xeba03e=[_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xca)]],_0x529d6a=[_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0x107)]],_0x262cfc=[_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xdf)]];else var _0x47fdad=[..._0x51ed9f['body']['product_name_QA']],_0x1d4093=[..._0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xf3)]],_0x4603c6=[..._0x51ed9f['body'][_0x24a043(0x11b)]],_0x3e3f94=[..._0x51ed9f[_0x24a043(0x12b)][_0x24a043(0x106)]],_0xeba03e=[..._0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xca)]],_0x529d6a=[..._0x51ed9f['body']['stocks_QA']],_0x262cfc=[..._0x51ed9f[_0x24a043(0x12b)]['return_qty_QA']];const _0x9c8449=_0x47fdad['map'](_0x3ef2a1=>{return _0x3ef2a1={'product_name':_0x3ef2a1};});_0x1d4093[_0x24a043(0x13b)]((_0x7147ae,_0x424492)=>{var _0x3cb8a0=_0x24a043;_0x9c8449[_0x424492][_0x3cb8a0(0xce)]=_0x7147ae;}),_0x4603c6['forEach']((_0x1c1da6,_0x582a63)=>{var _0x226f4c=_0x24a043;_0x9c8449[_0x582a63][_0x226f4c(0xdb)]=_0x1c1da6;}),_0x3e3f94['forEach']((_0x2f3039,_0x907692)=>{var _0x59d7e6=_0x24a043;_0x9c8449[_0x907692][_0x59d7e6(0x136)]=_0x2f3039;}),_0xeba03e[_0x24a043(0x13b)]((_0x460b2a,_0x451f11)=>{var _0x2f674f=_0x24a043;_0x9c8449[_0x451f11][_0x2f674f(0x10e)]=_0x460b2a;}),_0x529d6a['forEach']((_0xbd84c6,_0xdaee47)=>{var _0x55d0ab=_0x24a043;_0x9c8449[_0xdaee47][_0x55d0ab(0xf8)]=_0xbd84c6;}),_0x262cfc[_0x24a043(0x13b)]((_0x1d3717,_0x354e2c)=>{var _0x442d97=_0x24a043;_0x9c8449[_0x354e2c][_0x442d97(0x126)]=_0x1d3717;}),_0x13501f[_0x24a043(0xf6)][_0x24a043(0x13b)](_0x3b821d=>{const _0x71bd52=_0x2977c0['product_details']['map'](_0x4864e5=>{var _0x1f7cab=a0_0x17a6;_0x4864e5[_0x1f7cab(0x10d)]==_0x3b821d['product_name']&&(_0x4864e5[_0x1f7cab(0x11f)]=parseInt(_0x4864e5['product_stock'])+parseInt(_0x3b821d[_0x1f7cab(0x126)]));});}),await _0x2977c0['save'](),_0x13501f['invoice']=_0x3619ed,_0x13501f['customer']=_0x2db812,_0x13501f[_0x24a043(0xf5)]=_0x34c5b5,_0x13501f[_0x24a043(0x13e)]=_0x4f452c,_0x13501f['return_sale_QA']=_0x9c8449,_0x13501f[_0x24a043(0xe1)]=_0x579b04,_0x13501f[_0x24a043(0x10c)]=_0x26d9bb,_0x13501f['ToRoom']=_0x371caf;const _0x24cf8d=await _0x13501f['save'](),_0x3a5e8c=await c_payment_data[_0x24a043(0x127)]({'invoice':_0x51ed9f[_0x24a043(0x12b)]['invoice'],'reason':_0x24a043(0x11e)});_0x3a5e8c[_0x24a043(0x133)]=_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0x133)],_0x3a5e8c[_0x24a043(0xf5)]=_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xf5)],await _0x3a5e8c['save'](),_0x51ed9f[_0x24a043(0xfd)]('success',_0x24a043(0x134)),_0x4d40bf[_0x24a043(0x111)](_0x24a043(0x12e));}catch(_0x354ad5){console[_0x24a043(0xfb)](_0x354ad5),_0x4d40bf[_0x24a043(0xe7)](0xc8)[_0x24a043(0x110)]({'message':_0x354ad5[_0x24a043(0x121)]});}else try{const _0x5bce5e=_0x51ed9f[_0x24a043(0x139)]['id'];console[_0x24a043(0xfb)](_0x5bce5e);const _0x2d9b8e=await sales_return[_0x24a043(0x127)]({'invoice':_0x51ed9f['body'][_0x24a043(0xe3)]});console[_0x24a043(0xfb)]('old_data',_0x2d9b8e);const _0x23dfbe=await warehouse['findOne']({'name':_0x2d9b8e[_0x24a043(0x10c)],'room':_0x2d9b8e[_0x24a043(0xd8)]});console['log'](_0x24a043(0xc5),_0x23dfbe);const {invoice:_0x584af8,customer:_0x3f037b,date:_0x17d864,warehouse_name:_0x3b21f9,product_name:_0x50d498,primary_code:_0x2e9d2c,secondary_code:_0x34d9d2,product_code:_0x2ad73b,sales_quantity:_0x4c18f8,stocks:_0x11512c,return_qty:_0xd40b0f,note:_0x2c07af,to_warehouse_name:_0x538998,to_Room_name:_0x3e89e1}=_0x51ed9f['body'];console['log'](_0x51ed9f['body']);if(typeof _0x50d498==_0x24a043(0x103))var _0x47fdad=[_0x51ed9f['body'][_0x24a043(0x10d)]],_0x1d4093=[_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xce)]],_0x4603c6=[_0x51ed9f['body'][_0x24a043(0xdb)]],_0x3e3f94=[_0x51ed9f[_0x24a043(0x12b)]['product_code']],_0xeba03e=[_0x51ed9f[_0x24a043(0x12b)]['sales_quantity']],_0x529d6a=[_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xd4)]],_0x262cfc=[_0x51ed9f['body'][_0x24a043(0x126)]],_0x5ad88f=[_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0x115)]],_0x172d63=[_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xde)]],_0x2a2c67=[_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xc6)]],_0x208d16=[_0x51ed9f[_0x24a043(0x12b)]['floorlevel']];else var _0x47fdad=[..._0x51ed9f['body']['product_name']],_0x1d4093=[..._0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xce)]],_0x4603c6=[..._0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xdb)]],_0x3e3f94=[..._0x51ed9f[_0x24a043(0x12b)][_0x24a043(0x136)]],_0xeba03e=[..._0x51ed9f[_0x24a043(0x12b)][_0x24a043(0x137)]],_0x529d6a=[..._0x51ed9f['body'][_0x24a043(0xd4)]],_0x262cfc=[..._0x51ed9f['body'][_0x24a043(0x126)]],_0x5ad88f=[..._0x51ed9f[_0x24a043(0x12b)][_0x24a043(0x115)]],_0x172d63=[..._0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xde)]],_0x2a2c67=[..._0x51ed9f[_0x24a043(0x12b)]['types']],_0x208d16=[..._0x51ed9f['body'][_0x24a043(0xff)]];const _0x2901fd=_0x47fdad[_0x24a043(0x13c)](_0xf32519=>{return _0xf32519={'product_name':_0xf32519};});_0x1d4093[_0x24a043(0x13b)]((_0x737f75,_0x175b4e)=>{var _0x4c3338=_0x24a043;_0x2901fd[_0x175b4e][_0x4c3338(0xce)]=_0x737f75;}),_0x4603c6[_0x24a043(0x13b)]((_0x33c9ef,_0x3ef008)=>{_0x2901fd[_0x3ef008]['secondary_code']=_0x33c9ef;}),_0x3e3f94[_0x24a043(0x13b)]((_0x1a0318,_0xbe995e)=>{var _0x424295=_0x24a043;_0x2901fd[_0xbe995e][_0x424295(0x136)]=_0x1a0318;}),_0xeba03e[_0x24a043(0x13b)]((_0x38a6be,_0x1431ee)=>{_0x2901fd[_0x1431ee]['sale_qty']=_0x38a6be;}),_0x529d6a['forEach']((_0x340604,_0x585ba8)=>{_0x2901fd[_0x585ba8]['stock']=_0x340604;}),_0x262cfc['forEach']((_0x1ba9c9,_0x2af131)=>{var _0x489bc9=_0x24a043;_0x2901fd[_0x2af131][_0x489bc9(0x126)]=_0x1ba9c9;}),_0x5ad88f[_0x24a043(0x13b)]((_0x3465c4,_0x1b0f7c)=>{_0x2901fd[_0x1b0f7c]['bay']=_0x3465c4;}),_0x172d63[_0x24a043(0x13b)]((_0x524c7a,_0x305590)=>{var _0x387fa3=_0x24a043;_0x2901fd[_0x305590][_0x387fa3(0xde)]=_0x524c7a;}),_0x2a2c67[_0x24a043(0x13b)]((_0x12fb6f,_0x58c545)=>{_0x2901fd[_0x58c545]['type']=_0x12fb6f;}),_0x208d16[_0x24a043(0x13b)]((_0x3c3a95,_0x1670c8)=>{var _0x20debe=_0x24a043;_0x2901fd[_0x1670c8][_0x20debe(0xff)]=_0x3c3a95;});var _0x110baf=0x0;_0x2901fd[_0x24a043(0x13b)](_0x4ad88a=>{var _0x332e69=_0x24a043;console['log'](_0x332e69(0x13f),_0x4ad88a),(parseInt(_0x4ad88a[_0x332e69(0x10e)])<parseInt(_0x4ad88a[_0x332e69(0x126)])||parseInt(_0x4ad88a[_0x332e69(0xf8)])<parseInt(_0x4ad88a[_0x332e69(0x126)])&&parseInt(_0x4ad88a['sale_qty'])>parseInt(_0x4ad88a['return_qty'])||parseInt(_0x4ad88a[_0x332e69(0x126)])==0x0)&&_0x110baf++;});if(_0x110baf!=0x0)return _0x51ed9f['flash'](_0x24a043(0xd2),_0x24a043(0x120)),_0x4d40bf[_0x24a043(0x111)](_0x24a043(0xed));_0x2d9b8e[_0x24a043(0xcc)][_0x24a043(0x13b)](_0x34927d=>{var _0xeb7387=_0x24a043;const _0x5212ec=_0x23dfbe[_0xeb7387(0x11a)][_0xeb7387(0x13c)](_0xaf94d4=>{var _0x55ff8f=_0xeb7387;_0xaf94d4['product_name']==_0x34927d[_0x55ff8f(0x10d)]&&_0xaf94d4[_0x55ff8f(0xff)]==_0x34927d['floorlevel']&&_0xaf94d4[_0x55ff8f(0x11d)]==_0x34927d[_0x55ff8f(0x11d)]&&_0xaf94d4['bin']==_0x34927d[_0x55ff8f(0xde)]&&_0xaf94d4[_0x55ff8f(0x115)]==_0x34927d['bay']&&(_0xaf94d4['product_stock']=parseInt(_0xaf94d4[_0x55ff8f(0x11f)])+parseInt(_0x34927d[_0x55ff8f(0x126)]));});}),console[_0x24a043(0xfb)](_0x24a043(0xc5),_0x23dfbe),await _0x23dfbe[_0x24a043(0x128)](),_0x2d9b8e[_0x24a043(0xe3)]=_0x584af8,_0x2d9b8e[_0x24a043(0xf4)]=_0x3f037b,_0x2d9b8e['date']=_0x17d864,_0x2d9b8e[_0x24a043(0x13e)]=_0x3b21f9,_0x2d9b8e[_0x24a043(0xcc)]=_0x2901fd,_0x2d9b8e['note']=_0x2c07af,_0x2d9b8e[_0x24a043(0x10c)]=_0x538998,_0x2d9b8e['ToRoom']=_0x3e89e1;const _0x44fcf4=await _0x2d9b8e[_0x24a043(0x128)]();console['log']('new\x20new_data',_0x44fcf4);const _0x4b5d64=await c_payment_data[_0x24a043(0x127)]({'invoice':_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xe3)],'reason':_0x24a043(0x11e)});_0x4b5d64[_0x24a043(0x133)]=_0x51ed9f[_0x24a043(0x12b)]['suppliers'],_0x4b5d64['date']=_0x51ed9f[_0x24a043(0x12b)][_0x24a043(0xf5)],await _0x4b5d64[_0x24a043(0x128)](),_0x51ed9f[_0x24a043(0xfd)](_0x24a043(0xe0),_0x24a043(0x134)),_0x4d40bf[_0x24a043(0x111)](_0x24a043(0x130));}catch(_0x5696a5){console['log'](_0x5696a5),_0x4d40bf[_0x24a043(0xe7)](0xc8)[_0x24a043(0x110)]({'message':_0x5696a5[_0x24a043(0x121)]});}}),router[a0_0x32c786(0xe4)](a0_0x32c786(0xeb),auth,async(_0x3cd79f,_0x56ebb5)=>{var _0x4b4d78=a0_0x32c786;try{const _0x29740b=_0x3cd79f[_0x4b4d78(0x139)]['id'],{invoice:_0x3a793e,customer:_0x51880b,payable_to_customer:_0xbccf2a,paid_amount:_0x12d51d}=_0x3cd79f[_0x4b4d78(0x12b)],_0x45311e=await sales_return[_0x4b4d78(0x122)](_0x29740b);console[_0x4b4d78(0xfb)]('data',_0x45311e),console[_0x4b4d78(0xfb)](_0xbccf2a),console[_0x4b4d78(0xfb)](_0x12d51d);var _0xd43a94=_0xbccf2a-_0x12d51d;console[_0x4b4d78(0xfb)](_0x4b4d78(0xc4),_0xd43a94),_0x45311e[_0x4b4d78(0xf2)]=parseFloat(_0x12d51d)+parseFloat(_0x45311e[_0x4b4d78(0xf2)]),_0x45311e[_0x4b4d78(0xf9)]=_0xd43a94,console[_0x4b4d78(0xfb)](_0x45311e);const _0x3e66b5=await _0x45311e[_0x4b4d78(0x128)]();console[_0x4b4d78(0xfb)](0x1b207);const _0x4a2401=await c_payment_data[_0x4b4d78(0x127)]({'invoice':_0x3cd79f[_0x4b4d78(0x12b)]['invoice'],'reason':_0x4b4d78(0x11e)});console[_0x4b4d78(0xfb)]('c_payment',_0x4a2401),_0x4a2401[_0x4b4d78(0x108)]=_0xd43a94,await _0x4a2401[_0x4b4d78(0x128)]();let _0xde6b01=new Date(),_0x44886b=('0'+_0xde6b01[_0x4b4d78(0x113)]())[_0x4b4d78(0x12d)](-0x2),_0x1d7292=('0'+(_0xde6b01[_0x4b4d78(0x104)]()+0x1))[_0x4b4d78(0x12d)](-0x2),_0x5efaa5=_0xde6b01[_0x4b4d78(0xcb)](),_0x47e972=_0x5efaa5+'-'+_0x1d7292+'-'+_0x44886b;const _0x468a02=new customer_payment({'invoice':_0x3a793e,'date':_0x5efaa5+'-'+_0x1d7292+'-'+_0x44886b,'customer':_0x51880b,'reason':_0x4b4d78(0x105),'amount':_0x12d51d}),_0x12f8f9=await _0x468a02['save']();_0x3cd79f[_0x4b4d78(0xfd)](_0x4b4d78(0xe0),_0x4b4d78(0xfe)),_0x56ebb5[_0x4b4d78(0x111)]('/sales_return/view');}catch(_0x53453c){console['log'](_0x53453c);}}),router[a0_0x32c786(0x100)](a0_0x32c786(0x102),auth,async(_0x31828a,_0xec380b)=>{var _0x3a17e1=a0_0x32c786;try{const {username:_0x1e6b8d,email:_0xe1cbde,role:_0x5c9203}=_0x31828a[_0x3a17e1(0x109)],_0x253cdb=_0x31828a[_0x3a17e1(0x109)],_0x2ae9d0=await profile[_0x3a17e1(0x127)]({'email':_0x253cdb['email']}),_0x56177d=await master_shop[_0x3a17e1(0x116)]();console[_0x3a17e1(0xfb)]('master',_0x56177d);const _0x53ca3a=_0x31828a[_0x3a17e1(0x139)]['id'],_0x565023=await sales_return[_0x3a17e1(0x122)](_0x53ca3a);console['log'](_0x565023);const _0x373dbc=await customer['findOne']({'name':_0x565023[_0x3a17e1(0xf4)]});console[_0x3a17e1(0xfb)](_0x373dbc);if(_0x56177d[0x0][_0x3a17e1(0xd7)]==_0x3a17e1(0xc3)){var _0x4c0a36=users[_0x3a17e1(0x135)];console[_0x3a17e1(0xfb)](_0x4c0a36);}else{if(_0x56177d[0x0][_0x3a17e1(0xd7)]==_0x3a17e1(0xcd))var _0x4c0a36=users[_0x3a17e1(0xcd)];else{if(_0x56177d[0x0][_0x3a17e1(0xd7)]==_0x3a17e1(0x12f))var _0x4c0a36=users[_0x3a17e1(0x12f)];else{if(_0x56177d[0x0][_0x3a17e1(0xd7)]==_0x3a17e1(0xfa))var _0x4c0a36=users[_0x3a17e1(0xfa)];else{if(_0x56177d[0x0][_0x3a17e1(0xd7)]==_0x3a17e1(0x12a))var _0x4c0a36=users[_0x3a17e1(0x12a)];else{if(_0x56177d[0x0][_0x3a17e1(0xd7)]=='Portuguese\x20(BR)')var _0x4c0a36=users[_0x3a17e1(0xee)];else{if(_0x56177d[0x0]['language']==_0x3a17e1(0x12c))var _0x4c0a36=users[_0x3a17e1(0x12c)];else{if(_0x56177d[0x0][_0x3a17e1(0xd7)]==_0x3a17e1(0xe8))var _0x4c0a36=users['Arabic'];}}}}}}}_0xec380b[_0x3a17e1(0x10f)](_0x3a17e1(0xd6),{'success':_0x31828a['flash'](_0x3a17e1(0xe0)),'errors':_0x31828a['flash']('errors'),'role':_0x253cdb,'profile':_0x2ae9d0,'master_shop':_0x56177d,'customers':_0x373dbc,'sales':_0x565023,'language':_0x4c0a36});}catch(_0x4fa66b){console['log'](_0x4fa66b);}}),module['exports']=router;function a0_0x1ed2(){var _0x1dfaa3=['sales_return_finished','invoice','post','$product_details.type','customers','status','Arabic\x20(ae)','master','463635DBFFkx','/give_payment/:id','Return\x20Rooms','back','Portuguese','email','7hvVWPU','customer_docs','paid_amount','primary_code_QA','customer','date','return_sale_QA','136146TVNMzY','stock','due_amount','Spanish','log','$product_details.storage','flash','payment\x20successfull','floorlevel','get','$product_details.floorlevel','/invoice/:id','string','getMonth','Returned\x20Payment\x20For\x20Sale\x20Return','product_code_QA','stocks_QA','amount','user','../public/language/languages.json','886275XXWECj','ToWarehouse','product_name','sale_qty','render','json','redirect','$product_details.secondary_code','getDate','$product_details.product_code','bay','find','Enabled','$customer_docs','Portuguese\x20(BR)','product_details','secondary_code_QA','472851VIZNej','type','Sale\x20Return','product_stock','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','message','findById','$name','/view/:id','product_name_QA','return_qty','findOne','save','231834dHrygq','French','body','Chinese','slice','/sales_return_finished/view','German','/sales_return/view','aggregate','$product_details.bay','suppliers','purchase\x20return\x20successfully','English','product_code','sales_quantity','834920PMyhDy','params','$product_details.primary_code','forEach','map','/view','warehouse_name','foreach\x20newproduct','Router','English\x20(US)','subtract','old_warehouse_data','types','express','$product_details._id','$product_details.rack','sales_quantity_QA','getFullYear','return_sale','Hindi','primary_code','$product_details.product_name','../middleware/auth','QA\x20Warehouse','errors','$product_details.product_stock','stocks','for_categorize','sales_return_invoice','language','ToRoom','8KmRNYe','Arabic','secondary_code','552676qMnIMu','$product_details','bin','return_qty_QA','success','note'];a0_0x1ed2=function(){return _0x1dfaa3;};return a0_0x1ed2();}