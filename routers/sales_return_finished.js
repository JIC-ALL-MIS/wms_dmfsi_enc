var a0_0x4ed876=a0_0x568e;function a0_0x568e(_0x3fe2ed,_0x2d792d){var _0x5b3e7e=a0_0x5b3e();return a0_0x568e=function(_0x568ea8,_0xbcad6e){_0x568ea8=_0x568ea8-0x1d1;var _0x45395c=_0x5b3e7e[_0x568ea8];return _0x45395c;},a0_0x568e(_0x3fe2ed,_0x2d792d);}(function(_0x33b87c,_0x354c57){var _0x228831=a0_0x568e,_0x5bc7f7=_0x33b87c();while(!![]){try{var _0x18d2e8=parseInt(_0x228831(0x247))/0x1+parseInt(_0x228831(0x1f7))/0x2+parseInt(_0x228831(0x1f1))/0x3*(parseInt(_0x228831(0x21f))/0x4)+parseInt(_0x228831(0x1fe))/0x5+-parseInt(_0x228831(0x206))/0x6+-parseInt(_0x228831(0x1f5))/0x7*(-parseInt(_0x228831(0x223))/0x8)+-parseInt(_0x228831(0x243))/0x9;if(_0x18d2e8===_0x354c57)break;else _0x5bc7f7['push'](_0x5bc7f7['shift']());}catch(_0x225e47){_0x5bc7f7['push'](_0x5bc7f7['shift']());}}}(a0_0x5b3e,0xa60b5));function a0_0x5b3e(){var _0x3a422f=['Arabic\x20(ae)','getMonth','slice','product_stock','findById','floorlevel','English\x20(US)','invoice','stocks_QA','params','aggregate','render','email','string','Chinese','save','Arabic','Portuguese','old_data','master','flash','subtract','log','bin','due_amount','ToRoom','customer_docs','payment\x20successfull','/give_payment/:id','$product_details.product_name','QA\x20Warehouse','366TPzAOo','json','product_code_QA','secondary_code','49GLBdUe','English','2315650WYXhpp','return_qty_QA','new\x20new_data','/view/:id','suppliers','old_warehouse_data','$product_details.product_code','318435lqoFQQ','language','customers','note','body','$product_details.primary_code','primary_code_QA','/sales_return/view','4547292IKdioK','Returned\x20Payment\x20For\x20Sale\x20Return','sales_quantity','getFullYear','errors','sales_return_finished','$product_details.bin','stocks','product_name','warehouse_name','forEach','ToWarehouse','sales_quantity_QA','sale_qty','express','data','get','Spanish','user','foreach\x20newproduct','stock','Enabled','Sale\x20Return','$product_details.storage','c_payment','43156fqFmfr','message','success','find','1201048PcHHfK','$product_details.secondary_code','sales_return_invoice','amount','French','product_details','product_code','map','back','return_qty','types','Hindi','$name','getDate','redirect','$product_details.type','$product_details.bay','date','/invoice/:id','exports','type','Portuguese\x20(BR)','for_categorize','secondary_code_QA','customer','post','return_sale_QA','German','$product_details.product_stock','bay','status','findOne','20848590PrSCOj','name','paid_amount','product_name_QA','165822hegOPr','/view','$product_details._id','../middleware/auth','primary_code'];a0_0x5b3e=function(){return _0x3a422f;};return a0_0x5b3e();}const express=require(a0_0x4ed876(0x214)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require(a0_0x4ed876(0x24a)),users=require('../public/language/languages.json');router[a0_0x4ed876(0x216)](a0_0x4ed876(0x248),auth,async(_0x2f2387,_0x501ffd)=>{var _0x3ba773=a0_0x4ed876;try{const {username:_0x2768d9,email:_0x1e14e5,role:_0x244b6a}=_0x2f2387[_0x3ba773(0x218)],_0x47526c=_0x2f2387[_0x3ba773(0x218)],_0x17f1de=await profile[_0x3ba773(0x242)]({'email':_0x47526c[_0x3ba773(0x1de)]}),_0x28ab5e=await master_shop[_0x3ba773(0x222)](),_0x43ff35=await sales_return_finished[_0x3ba773(0x1dc)]([{'$lookup':{'from':_0x3ba773(0x200),'localField':_0x3ba773(0x23b),'foreignField':_0x3ba773(0x244),'as':_0x3ba773(0x1ec)}},{'$unwind':'$customer_docs'}]);if(_0x28ab5e[0x0][_0x3ba773(0x1ff)]==_0x3ba773(0x1d8)){var _0x24d78b=users[_0x3ba773(0x1f6)];console[_0x3ba773(0x1e8)](_0x24d78b);}else{if(_0x28ab5e[0x0][_0x3ba773(0x1ff)]==_0x3ba773(0x22e))var _0x24d78b=users[_0x3ba773(0x22e)];else{if(_0x28ab5e[0x0][_0x3ba773(0x1ff)]==_0x3ba773(0x23e))var _0x24d78b=users[_0x3ba773(0x23e)];else{if(_0x28ab5e[0x0][_0x3ba773(0x1ff)]==_0x3ba773(0x217))var _0x24d78b=users[_0x3ba773(0x217)];else{if(_0x28ab5e[0x0][_0x3ba773(0x1ff)]==_0x3ba773(0x227))var _0x24d78b=users[_0x3ba773(0x227)];else{if(_0x28ab5e[0x0][_0x3ba773(0x1ff)]==_0x3ba773(0x238))var _0x24d78b=users[_0x3ba773(0x1e3)];else{if(_0x28ab5e[0x0][_0x3ba773(0x1ff)]==_0x3ba773(0x1e0))var _0x24d78b=users['Chinese'];else{if(_0x28ab5e[0x0][_0x3ba773(0x1ff)]=='Arabic\x20(ae)')var _0x24d78b=users['Arabic'];}}}}}}}_0x501ffd[_0x3ba773(0x1dd)](_0x3ba773(0x20b),{'success':_0x2f2387[_0x3ba773(0x1e6)](_0x3ba773(0x221)),'errors':_0x2f2387[_0x3ba773(0x1e6)](_0x3ba773(0x20a)),'role':_0x47526c,'profile':_0x17f1de,'master_shop':_0x28ab5e,'user':_0x43ff35,'language':_0x24d78b});}catch(_0x42edea){console[_0x3ba773(0x1e8)](_0x42edea);}}),router['get'](a0_0x4ed876(0x1fa),auth,async(_0x2fd212,_0x2db1af)=>{var _0x2b0125=a0_0x4ed876;try{const {username:_0x425524,email:_0x39b39b,role:_0x35a84e}=_0x2fd212[_0x2b0125(0x218)],_0x47202f=_0x2fd212['user'],_0x979805=await profile[_0x2b0125(0x242)]({'email':_0x47202f[_0x2b0125(0x1de)]}),_0x13844d=await master_shop[_0x2b0125(0x222)]();console[_0x2b0125(0x1e8)](_0x2b0125(0x1e5),_0x13844d);const _0x2154e0=_0x2fd212[_0x2b0125(0x1db)]['id'];console[_0x2b0125(0x1e8)](_0x2154e0);var _0x2ea307=['Return\x20Rooms'];const _0x10e426=await sales_return_finished[_0x2b0125(0x1d6)](_0x2154e0),_0x1604a8=await warehouse['aggregate']([{'$match':{'name':_0x10e426['ToWarehouse'],'room':_0x10e426[_0x2b0125(0x1eb)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2b0125(0x249),'name':{'$first':_0x2b0125(0x1ef)},'product_stock':{'$first':_0x2b0125(0x23f)},'bay':{'$first':_0x2b0125(0x233)},'bin':{'$first':_0x2b0125(0x20c)},'type':{'$first':_0x2b0125(0x232)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2b0125(0x203)},'secondary_code':{'$first':_0x2b0125(0x224)},'product_code':{'$first':_0x2b0125(0x1fd)},'storage':{'$first':_0x2b0125(0x21d)},'rack':{'$first':'$product_details.rack'}}}]);console['log'](_0x1604a8);const _0x327585=await warehouse[_0x2b0125(0x1dc)]([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':'$name','name':{'$first':_0x2b0125(0x22f)}}},{'$sort':{'name':0x1}}]),_0x42807e=await warehouse[_0x2b0125(0x1dc)]([{'$match':{'status':_0x2b0125(0x21b),'name':_0x2b0125(0x1f0)}},{'$group':{'_id':_0x2b0125(0x22f),'name':{'$first':_0x2b0125(0x22f)}}},{'$sort':{'name':0x1}}]),_0x42139a=await product[_0x2b0125(0x222)]({});if(_0x13844d[0x0]['language']==_0x2b0125(0x1d8)){var _0xd4a21a=users[_0x2b0125(0x1f6)];console[_0x2b0125(0x1e8)](_0xd4a21a);}else{if(_0x13844d[0x0][_0x2b0125(0x1ff)]==_0x2b0125(0x22e))var _0xd4a21a=users[_0x2b0125(0x22e)];else{if(_0x13844d[0x0][_0x2b0125(0x1ff)]==_0x2b0125(0x23e))var _0xd4a21a=users[_0x2b0125(0x23e)];else{if(_0x13844d[0x0][_0x2b0125(0x1ff)]==_0x2b0125(0x217))var _0xd4a21a=users[_0x2b0125(0x217)];else{if(_0x13844d[0x0][_0x2b0125(0x1ff)]==_0x2b0125(0x227))var _0xd4a21a=users['French'];else{if(_0x13844d[0x0]['language']=='Portuguese\x20(BR)')var _0xd4a21a=users[_0x2b0125(0x1e3)];else{if(_0x13844d[0x0][_0x2b0125(0x1ff)]=='Chinese')var _0xd4a21a=users[_0x2b0125(0x1e0)];else{if(_0x13844d[0x0]['language']==_0x2b0125(0x1d2))var _0xd4a21a=users[_0x2b0125(0x1e2)];}}}}}}}_0x2db1af[_0x2b0125(0x1dd)]('return_sale_edit_finished',{'success':_0x2fd212['flash']('success'),'errors':_0x2fd212[_0x2b0125(0x1e6)](_0x2b0125(0x20a)),'role':_0x47202f,'profile':_0x979805,'master_shop':_0x13844d,'user':_0x10e426,'stock':_0x1604a8,'unit':_0x42139a,'language':_0xd4a21a,'warehouses':_0x327585,'rooms':_0x2ea307,'warehouse_QA':_0x42807e});}catch(_0x3e2f49){console[_0x2b0125(0x1e8)](_0x3e2f49);}}),router[a0_0x4ed876(0x23c)](a0_0x4ed876(0x1fa),auth,async(_0xd64c43,_0x3b30d4)=>{var _0x436ef7=a0_0x4ed876;if(_0xd64c43['body'][_0x436ef7(0x239)]=='QA')try{const _0x23eb1b=_0xd64c43[_0x436ef7(0x1db)]['id'],_0x3e66d8=await sales_return[_0x436ef7(0x242)]({'invoice':_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1d9)]}),_0x136609=await warehouse[_0x436ef7(0x242)]({'name':_0x3e66d8[_0x436ef7(0x211)],'room':_0x3e66d8['ToRoom']}),{invoice:_0x48f446,customer:_0x2c6043,date:_0x5ffe1a,warehouse_name:_0x3cdb54,product_name:_0x2d6ae0,primary_code:_0x5cba8b,secondary_code:_0x508dbe,product_code:_0x1da707,sales_quantity:_0x596552,stocks:_0x5f2968,return_qty:_0x1daf29,note:_0x1f553f,to_warehouse_name_QA:_0x314358,to_Room_name_QA:_0x406c58}=_0xd64c43['body'];if(typeof product_name_QA==_0x436ef7(0x1df))var _0x3cb5b9=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x246)]],_0x2992d9=[_0xd64c43[_0x436ef7(0x202)]['primary_code_QA']],_0x28b152=[_0xd64c43[_0x436ef7(0x202)]['secondary_code_QA']],_0x33aa7a=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1f3)]],_0x4aa6dc=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x212)]],_0x23cac6=[_0xd64c43['body'][_0x436ef7(0x1da)]],_0x17894b=[_0xd64c43[_0x436ef7(0x202)]['return_qty_QA']];else var _0x3cb5b9=[..._0xd64c43[_0x436ef7(0x202)]['product_name_QA']],_0x2992d9=[..._0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x204)]],_0x28b152=[..._0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x23a)]],_0x33aa7a=[..._0xd64c43[_0x436ef7(0x202)]['product_code_QA']],_0x4aa6dc=[..._0xd64c43[_0x436ef7(0x202)]['sales_quantity_QA']],_0x23cac6=[..._0xd64c43[_0x436ef7(0x202)]['stocks_QA']],_0x17894b=[..._0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1f8)]];const _0x151de1=_0x3cb5b9[_0x436ef7(0x22a)](_0x2eddb5=>{return _0x2eddb5={'product_name':_0x2eddb5};});_0x2992d9[_0x436ef7(0x210)]((_0x5b3f0c,_0x1a3ea6)=>{var _0x3d88df=_0x436ef7;_0x151de1[_0x1a3ea6][_0x3d88df(0x1d1)]=_0x5b3f0c;}),_0x28b152['forEach']((_0x182bce,_0x41e708)=>{_0x151de1[_0x41e708]['secondary_code']=_0x182bce;}),_0x33aa7a['forEach']((_0x352299,_0x166728)=>{var _0x335a64=_0x436ef7;_0x151de1[_0x166728][_0x335a64(0x229)]=_0x352299;}),_0x4aa6dc[_0x436ef7(0x210)]((_0x1044b9,_0x1f0657)=>{var _0x33569a=_0x436ef7;_0x151de1[_0x1f0657][_0x33569a(0x213)]=_0x1044b9;}),_0x23cac6[_0x436ef7(0x210)]((_0x263a60,_0x7e14ac)=>{_0x151de1[_0x7e14ac]['stock']=_0x263a60;}),_0x17894b[_0x436ef7(0x210)]((_0x3609df,_0x581e2a)=>{var _0x5cfde4=_0x436ef7;_0x151de1[_0x581e2a][_0x5cfde4(0x22c)]=_0x3609df;}),_0x3e66d8['return_sale_QA'][_0x436ef7(0x210)](_0x1d3c7a=>{var _0x5ea202=_0x436ef7;const _0x546b6b=_0x136609[_0x5ea202(0x228)][_0x5ea202(0x22a)](_0x1faab5=>{var _0x171958=_0x5ea202;_0x1faab5['product_name']==_0x1d3c7a[_0x171958(0x20e)]&&(_0x1faab5['product_stock']=parseInt(_0x1faab5[_0x171958(0x1d5)])+parseInt(_0x1d3c7a['return_qty']));});}),await _0x136609[_0x436ef7(0x1e1)](),_0x3e66d8[_0x436ef7(0x1d9)]=_0x48f446,_0x3e66d8['customer']=_0x2c6043,_0x3e66d8[_0x436ef7(0x234)]=_0x5ffe1a,_0x3e66d8[_0x436ef7(0x20f)]=_0x3cdb54,_0x3e66d8[_0x436ef7(0x23d)]=_0x151de1,_0x3e66d8[_0x436ef7(0x201)]=_0x1f553f,_0x3e66d8[_0x436ef7(0x211)]=_0x314358,_0x3e66d8[_0x436ef7(0x1eb)]=_0x406c58;const _0xcc7a57=await _0x3e66d8[_0x436ef7(0x1e1)](),_0x51540d=await c_payment_data[_0x436ef7(0x242)]({'invoice':_0xd64c43[_0x436ef7(0x202)]['invoice'],'reason':'Sale\x20Return'});_0x51540d[_0x436ef7(0x1fb)]=_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1fb)],_0x51540d[_0x436ef7(0x234)]=_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x234)],await _0x51540d[_0x436ef7(0x1e1)](),_0xd64c43[_0x436ef7(0x1e6)]('success','purchase\x20return\x20successfully'),_0x3b30d4['redirect']('/sales_return_finished/view');}catch(_0x5586a9){console[_0x436ef7(0x1e8)](_0x5586a9),_0x3b30d4[_0x436ef7(0x241)](0xc8)[_0x436ef7(0x1f2)]({'message':_0x5586a9['message']});}else try{const _0x2a8203=_0xd64c43[_0x436ef7(0x1db)]['id'];console[_0x436ef7(0x1e8)](_0x2a8203);const _0x2cb711=await sales_return['findOne']({'invoice':_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1d9)]});console[_0x436ef7(0x1e8)](_0x436ef7(0x1e4),_0x2cb711);const _0x1e017a=await warehouse['findOne']({'name':_0x2cb711[_0x436ef7(0x211)],'room':_0x2cb711[_0x436ef7(0x1eb)]});console[_0x436ef7(0x1e8)](_0x436ef7(0x1fc),_0x1e017a);const {invoice:_0xaf363a,customer:_0x2816ae,date:_0x55cf44,warehouse_name:_0x263b50,product_name:_0x2a863f,primary_code:_0x316e69,secondary_code:_0x51ecbc,product_code:_0x511f1a,sales_quantity:_0x1021cf,stocks:_0x144e61,return_qty:_0x5384c7,note:_0x15d23d,to_warehouse_name:_0x17ad6a,to_Room_name:_0x56a041}=_0xd64c43[_0x436ef7(0x202)];console['log'](_0xd64c43[_0x436ef7(0x202)]);if(typeof _0x2a863f==_0x436ef7(0x1df))var _0x3cb5b9=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x20e)]],_0x2992d9=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1d1)]],_0x28b152=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1f4)]],_0x33aa7a=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x229)]],_0x4aa6dc=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x208)]],_0x23cac6=[_0xd64c43[_0x436ef7(0x202)]['stocks']],_0x17894b=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x22c)]],_0x5df718=[_0xd64c43['body'][_0x436ef7(0x240)]],_0x413d35=[_0xd64c43[_0x436ef7(0x202)]['bin']],_0x5adbaf=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x22d)]],_0x12d10f=[_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1d7)]];else var _0x3cb5b9=[..._0xd64c43[_0x436ef7(0x202)]['product_name']],_0x2992d9=[..._0xd64c43[_0x436ef7(0x202)]['primary_code']],_0x28b152=[..._0xd64c43[_0x436ef7(0x202)]['secondary_code']],_0x33aa7a=[..._0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x229)]],_0x4aa6dc=[..._0xd64c43['body']['sales_quantity']],_0x23cac6=[..._0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x20d)]],_0x17894b=[..._0xd64c43[_0x436ef7(0x202)]['return_qty']],_0x5df718=[..._0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x240)]],_0x413d35=[..._0xd64c43['body']['bin']],_0x5adbaf=[..._0xd64c43[_0x436ef7(0x202)]['types']],_0x12d10f=[..._0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1d7)]];const _0x62c247=_0x3cb5b9[_0x436ef7(0x22a)](_0x417dbd=>{return _0x417dbd={'product_name':_0x417dbd};});_0x2992d9['forEach']((_0x1c74d9,_0x19c37f)=>{var _0x154a89=_0x436ef7;_0x62c247[_0x19c37f][_0x154a89(0x1d1)]=_0x1c74d9;}),_0x28b152['forEach']((_0x3e8d8d,_0x1b5a30)=>{var _0x49ab71=_0x436ef7;_0x62c247[_0x1b5a30][_0x49ab71(0x1f4)]=_0x3e8d8d;}),_0x33aa7a[_0x436ef7(0x210)]((_0x40350f,_0x327963)=>{_0x62c247[_0x327963]['product_code']=_0x40350f;}),_0x4aa6dc[_0x436ef7(0x210)]((_0x304d64,_0xc8a18b)=>{var _0x47ea16=_0x436ef7;_0x62c247[_0xc8a18b][_0x47ea16(0x213)]=_0x304d64;}),_0x23cac6[_0x436ef7(0x210)]((_0x2cb129,_0x13eb25)=>{var _0x17099e=_0x436ef7;_0x62c247[_0x13eb25][_0x17099e(0x21a)]=_0x2cb129;}),_0x17894b[_0x436ef7(0x210)]((_0x40db49,_0x172c34)=>{_0x62c247[_0x172c34]['return_qty']=_0x40db49;}),_0x5df718[_0x436ef7(0x210)]((_0x111a54,_0x5f0931)=>{var _0x337e15=_0x436ef7;_0x62c247[_0x5f0931][_0x337e15(0x240)]=_0x111a54;}),_0x413d35['forEach']((_0x5cfba5,_0x3b847a)=>{_0x62c247[_0x3b847a]['bin']=_0x5cfba5;}),_0x5adbaf[_0x436ef7(0x210)]((_0x44f925,_0x3c9098)=>{var _0x5968bf=_0x436ef7;_0x62c247[_0x3c9098][_0x5968bf(0x237)]=_0x44f925;}),_0x12d10f['forEach']((_0xcdf49f,_0x55eb22)=>{var _0x4080bd=_0x436ef7;_0x62c247[_0x55eb22][_0x4080bd(0x1d7)]=_0xcdf49f;});var _0x3abbf6=0x0;_0x62c247[_0x436ef7(0x210)](_0x2fd7ab=>{var _0x1e8fb0=_0x436ef7;console[_0x1e8fb0(0x1e8)](_0x1e8fb0(0x219),_0x2fd7ab),(parseInt(_0x2fd7ab[_0x1e8fb0(0x213)])<parseInt(_0x2fd7ab[_0x1e8fb0(0x22c)])||parseInt(_0x2fd7ab[_0x1e8fb0(0x21a)])<parseInt(_0x2fd7ab[_0x1e8fb0(0x22c)])&&parseInt(_0x2fd7ab[_0x1e8fb0(0x213)])>parseInt(_0x2fd7ab['return_qty'])||parseInt(_0x2fd7ab['return_qty'])==0x0)&&_0x3abbf6++;});if(_0x3abbf6!=0x0)return _0xd64c43[_0x436ef7(0x1e6)](_0x436ef7(0x20a),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x3b30d4[_0x436ef7(0x231)](_0x436ef7(0x22b));_0x2cb711['return_sale'][_0x436ef7(0x210)](_0x56fba6=>{const _0x41fd16=_0x1e017a['product_details']['map'](_0x5dfd55=>{var _0x3e24d5=a0_0x568e;_0x5dfd55[_0x3e24d5(0x20e)]==_0x56fba6[_0x3e24d5(0x20e)]&&_0x5dfd55['floorlevel']==_0x56fba6[_0x3e24d5(0x1d7)]&&_0x5dfd55['type']==_0x56fba6[_0x3e24d5(0x237)]&&_0x5dfd55[_0x3e24d5(0x1e9)]==_0x56fba6[_0x3e24d5(0x1e9)]&&_0x5dfd55[_0x3e24d5(0x240)]==_0x56fba6[_0x3e24d5(0x240)]&&(_0x5dfd55['product_stock']=parseInt(_0x5dfd55[_0x3e24d5(0x1d5)])+parseInt(_0x56fba6[_0x3e24d5(0x22c)]));});}),console[_0x436ef7(0x1e8)](_0x436ef7(0x1fc),_0x1e017a),await _0x1e017a['save'](),_0x2cb711[_0x436ef7(0x1d9)]=_0xaf363a,_0x2cb711['customer']=_0x2816ae,_0x2cb711[_0x436ef7(0x234)]=_0x55cf44,_0x2cb711[_0x436ef7(0x20f)]=_0x263b50,_0x2cb711['return_sale']=_0x62c247,_0x2cb711['note']=_0x15d23d,_0x2cb711[_0x436ef7(0x211)]=_0x17ad6a,_0x2cb711['ToRoom']=_0x56a041;const _0x4865ef=await _0x2cb711[_0x436ef7(0x1e1)]();console[_0x436ef7(0x1e8)](_0x436ef7(0x1f9),_0x4865ef);const _0x121102=await c_payment_data['findOne']({'invoice':_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1d9)],'reason':_0x436ef7(0x21c)});_0x121102['suppliers']=_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x1fb)],_0x121102[_0x436ef7(0x234)]=_0xd64c43[_0x436ef7(0x202)][_0x436ef7(0x234)],await _0x121102[_0x436ef7(0x1e1)](),_0xd64c43[_0x436ef7(0x1e6)](_0x436ef7(0x221),'purchase\x20return\x20successfully'),_0x3b30d4[_0x436ef7(0x231)](_0x436ef7(0x205));}catch(_0x1d5e88){console['log'](_0x1d5e88),_0x3b30d4[_0x436ef7(0x241)](0xc8)[_0x436ef7(0x1f2)]({'message':_0x1d5e88[_0x436ef7(0x220)]});}}),router['post'](a0_0x4ed876(0x1ee),auth,async(_0x3d911e,_0x481aac)=>{var _0x28c155=a0_0x4ed876;try{const _0x48218a=_0x3d911e['params']['id'],{invoice:_0x5bb48c,customer:_0x582c21,payable_to_customer:_0x5b4575,paid_amount:_0x401e61}=_0x3d911e[_0x28c155(0x202)],_0x54361a=await sales_return[_0x28c155(0x1d6)](_0x48218a);console[_0x28c155(0x1e8)](_0x28c155(0x215),_0x54361a),console['log'](_0x5b4575),console[_0x28c155(0x1e8)](_0x401e61);var _0x429854=_0x5b4575-_0x401e61;console['log'](_0x28c155(0x1e7),_0x429854),_0x54361a[_0x28c155(0x245)]=parseFloat(_0x401e61)+parseFloat(_0x54361a[_0x28c155(0x245)]),_0x54361a[_0x28c155(0x1ea)]=_0x429854,console[_0x28c155(0x1e8)](_0x54361a);const _0x1c1013=await _0x54361a[_0x28c155(0x1e1)]();console['log'](0x1b207);const _0x327537=await c_payment_data[_0x28c155(0x242)]({'invoice':_0x3d911e[_0x28c155(0x202)][_0x28c155(0x1d9)],'reason':'Sale\x20Return'});console[_0x28c155(0x1e8)](_0x28c155(0x21e),_0x327537),_0x327537[_0x28c155(0x226)]=_0x429854,await _0x327537[_0x28c155(0x1e1)]();let _0x2a9081=new Date(),_0x33ab47=('0'+_0x2a9081[_0x28c155(0x230)]())[_0x28c155(0x1d4)](-0x2),_0x201a6c=('0'+(_0x2a9081[_0x28c155(0x1d3)]()+0x1))[_0x28c155(0x1d4)](-0x2),_0x6ba32d=_0x2a9081[_0x28c155(0x209)](),_0x264267=_0x6ba32d+'-'+_0x201a6c+'-'+_0x33ab47;const _0x4d7899=new customer_payment({'invoice':_0x5bb48c,'date':_0x6ba32d+'-'+_0x201a6c+'-'+_0x33ab47,'customer':_0x582c21,'reason':_0x28c155(0x207),'amount':_0x401e61}),_0x13944f=await _0x4d7899[_0x28c155(0x1e1)]();_0x3d911e[_0x28c155(0x1e6)](_0x28c155(0x221),_0x28c155(0x1ed)),_0x481aac[_0x28c155(0x231)](_0x28c155(0x205));}catch(_0x44f6ad){console[_0x28c155(0x1e8)](_0x44f6ad);}}),router[a0_0x4ed876(0x216)](a0_0x4ed876(0x235),auth,async(_0x4f3d24,_0x10b058)=>{var _0x648cb1=a0_0x4ed876;try{const {username:_0x2f5125,email:_0x592f76,role:_0x4d94f4}=_0x4f3d24[_0x648cb1(0x218)],_0x1bf0d0=_0x4f3d24[_0x648cb1(0x218)],_0x1a11f6=await profile[_0x648cb1(0x242)]({'email':_0x1bf0d0['email']}),_0x43d25d=await master_shop[_0x648cb1(0x222)]();console[_0x648cb1(0x1e8)]('master',_0x43d25d);const _0x581b35=_0x4f3d24['params']['id'],_0x48e036=await sales_return[_0x648cb1(0x1d6)](_0x581b35);console[_0x648cb1(0x1e8)](_0x48e036);const _0x407f07=await customer[_0x648cb1(0x242)]({'name':_0x48e036[_0x648cb1(0x23b)]});console[_0x648cb1(0x1e8)](_0x407f07);if(_0x43d25d[0x0][_0x648cb1(0x1ff)]==_0x648cb1(0x1d8)){var _0x16382=users[_0x648cb1(0x1f6)];console[_0x648cb1(0x1e8)](_0x16382);}else{if(_0x43d25d[0x0][_0x648cb1(0x1ff)]==_0x648cb1(0x22e))var _0x16382=users['Hindi'];else{if(_0x43d25d[0x0][_0x648cb1(0x1ff)]==_0x648cb1(0x23e))var _0x16382=users[_0x648cb1(0x23e)];else{if(_0x43d25d[0x0][_0x648cb1(0x1ff)]=='Spanish')var _0x16382=users[_0x648cb1(0x217)];else{if(_0x43d25d[0x0]['language']==_0x648cb1(0x227))var _0x16382=users['French'];else{if(_0x43d25d[0x0]['language']==_0x648cb1(0x238))var _0x16382=users['Portuguese'];else{if(_0x43d25d[0x0][_0x648cb1(0x1ff)]=='Chinese')var _0x16382=users['Chinese'];else{if(_0x43d25d[0x0][_0x648cb1(0x1ff)]==_0x648cb1(0x1d2))var _0x16382=users[_0x648cb1(0x1e2)];}}}}}}}_0x10b058[_0x648cb1(0x1dd)](_0x648cb1(0x225),{'success':_0x4f3d24[_0x648cb1(0x1e6)](_0x648cb1(0x221)),'errors':_0x4f3d24['flash'](_0x648cb1(0x20a)),'role':_0x1bf0d0,'profile':_0x1a11f6,'master_shop':_0x43d25d,'customers':_0x407f07,'sales':_0x48e036,'language':_0x16382});}catch(_0xea0a78){console[_0x648cb1(0x1e8)](_0xea0a78);}}),module[a0_0x4ed876(0x236)]=router;