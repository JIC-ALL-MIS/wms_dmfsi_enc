var a0_0x226199=a0_0x3941;(function(_0x4504a1,_0x31e25a){var _0x15b8cf=a0_0x3941,_0x32fa64=_0x4504a1();while(!![]){try{var _0x54f985=-parseInt(_0x15b8cf(0x12e))/0x1*(-parseInt(_0x15b8cf(0x159))/0x2)+parseInt(_0x15b8cf(0x13c))/0x3+parseInt(_0x15b8cf(0x127))/0x4*(parseInt(_0x15b8cf(0x15f))/0x5)+-parseInt(_0x15b8cf(0x161))/0x6+-parseInt(_0x15b8cf(0x174))/0x7*(-parseInt(_0x15b8cf(0x164))/0x8)+-parseInt(_0x15b8cf(0x11a))/0x9*(parseInt(_0x15b8cf(0x10f))/0xa)+parseInt(_0x15b8cf(0x17d))/0xb*(-parseInt(_0x15b8cf(0x146))/0xc);if(_0x54f985===_0x31e25a)break;else _0x32fa64['push'](_0x32fa64['shift']());}catch(_0x8e4812){_0x32fa64['push'](_0x32fa64['shift']());}}}(a0_0x3353,0xe6c5b));const express=require(a0_0x226199(0x147)),app=express(),router=express[a0_0x226199(0x145)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require(a0_0x226199(0x154)),users=require('../public/language/languages.json');function a0_0x3941(_0x484d87,_0x5a963b){var _0x33536a=a0_0x3353();return a0_0x3941=function(_0x3941d9,_0x582a4e){_0x3941d9=_0x3941d9-0x10c;var _0x185261=_0x33536a[_0x3941d9];return _0x185261;},a0_0x3941(_0x484d87,_0x5a963b);}function a0_0x3353(){var _0x16c57c=['for_categorize','product_name_QA','purchase\x20return\x20successfully','product_name','stock','Chinese','date','floorlevel','$product_details','payment\x20successfull','4826079jzBMMI','ToWarehouse','get','secondary_code','sales_quantity_QA','bin','suppliers','getMonth','/sales_return_finished/view','product_code_QA','primary_code_QA','$product_details.floorlevel','return_sale_edit_finished','5080040xDAUFL','findOne','return_sale','$product_details.product_code','status','back','Sale\x20Return','872435VCeMKg','email','types','$name','forEach','bay','stocks','$product_details.bin','secondary_code_QA','product_code','sales_return_invoice','aggregate','json','due_amount','3712701SzvUkV','Arabic','success','$product_details.storage','subtract','/sales_return/view','$product_details._id','c_payment','map','Router','686220DOCcTc','express','params','render','slice','findById','log','sale_qty','English','Hindi','string','foreach\x20newproduct','flash','German','../middleware/auth','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','language','product_details','post','2YpzUxm','Arabic\x20(ae)','user','Returned\x20Payment\x20For\x20Sale\x20Return','type','Portuguese\x20(BR)','5hVbGuM','customer','5433666zGiIvY','warehouse_name','errors','388176LvEBwR','ToRoom','master','exports','paid_amount','English\x20(US)','/view/:id','return_sale_QA','Spanish','note','old_warehouse_data','/invoice/:id','$product_details.product_stock','French','product_stock','find','63hSCvyr','return_qty_QA','$customer_docs','Portuguese','name','sales_quantity','save','getDate','invoice','275mEHbqp','$product_details.rack','body','Enabled','return_qty','primary_code','redirect','message','getFullYear','10pGEIle'];a0_0x3353=function(){return _0x16c57c;};return a0_0x3353();}router[a0_0x226199(0x11c)]('/view',auth,async(_0x1c428a,_0x1a9e5c)=>{var _0x5a6d6f=a0_0x226199;try{const {username:_0x133174,email:_0x428200,role:_0x1b067b}=_0x1c428a[_0x5a6d6f(0x15b)],_0x3210c1=_0x1c428a['user'],_0xd1105d=await profile[_0x5a6d6f(0x128)]({'email':_0x3210c1[_0x5a6d6f(0x12f)]}),_0x25fbea=await master_shop['find'](),_0x271063=await sales_return_finished[_0x5a6d6f(0x139)]([{'$lookup':{'from':'customers','localField':_0x5a6d6f(0x160),'foreignField':_0x5a6d6f(0x178),'as':'customer_docs'}},{'$unwind':_0x5a6d6f(0x176)}]);if(_0x25fbea[0x0][_0x5a6d6f(0x156)]==_0x5a6d6f(0x169)){var _0x151957=users['English'];console[_0x5a6d6f(0x14c)](_0x151957);}else{if(_0x25fbea[0x0]['language']==_0x5a6d6f(0x14f))var _0x151957=users['Hindi'];else{if(_0x25fbea[0x0][_0x5a6d6f(0x156)]==_0x5a6d6f(0x153))var _0x151957=users['German'];else{if(_0x25fbea[0x0][_0x5a6d6f(0x156)]=='Spanish')var _0x151957=users[_0x5a6d6f(0x16c)];else{if(_0x25fbea[0x0][_0x5a6d6f(0x156)]==_0x5a6d6f(0x171))var _0x151957=users[_0x5a6d6f(0x171)];else{if(_0x25fbea[0x0]['language']==_0x5a6d6f(0x15e))var _0x151957=users[_0x5a6d6f(0x177)];else{if(_0x25fbea[0x0][_0x5a6d6f(0x156)]==_0x5a6d6f(0x115))var _0x151957=users['Chinese'];else{if(_0x25fbea[0x0][_0x5a6d6f(0x156)]=='Arabic\x20(ae)')var _0x151957=users['Arabic'];}}}}}}}_0x1a9e5c[_0x5a6d6f(0x149)]('sales_return_finished',{'success':_0x1c428a[_0x5a6d6f(0x152)](_0x5a6d6f(0x13e)),'errors':_0x1c428a[_0x5a6d6f(0x152)](_0x5a6d6f(0x163)),'role':_0x3210c1,'profile':_0xd1105d,'master_shop':_0x25fbea,'user':_0x271063,'language':_0x151957});}catch(_0xea9447){console['log'](_0xea9447);}}),router[a0_0x226199(0x11c)](a0_0x226199(0x16a),auth,async(_0x1b09c1,_0x3b3df7)=>{var _0x3ee6c7=a0_0x226199;try{const {username:_0x49739f,email:_0x400801,role:_0x2a33e5}=_0x1b09c1[_0x3ee6c7(0x15b)],_0x35d8c1=_0x1b09c1[_0x3ee6c7(0x15b)],_0x1e6cd6=await profile[_0x3ee6c7(0x128)]({'email':_0x35d8c1[_0x3ee6c7(0x12f)]}),_0x1478db=await master_shop[_0x3ee6c7(0x173)]();console[_0x3ee6c7(0x14c)](_0x3ee6c7(0x166),_0x1478db);const _0x1bbb00=_0x1b09c1[_0x3ee6c7(0x148)]['id'];console[_0x3ee6c7(0x14c)](_0x1bbb00);var _0x700550=['Return\x20Rooms'];const _0x12147f=await sales_return_finished[_0x3ee6c7(0x14b)](_0x1bbb00),_0x3ed2de=await warehouse[_0x3ee6c7(0x139)]([{'$match':{'name':_0x12147f[_0x3ee6c7(0x11b)],'room':_0x12147f['ToRoom']}},{'$unwind':_0x3ee6c7(0x118)},{'$group':{'_id':_0x3ee6c7(0x142),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3ee6c7(0x170)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x3ee6c7(0x135)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3ee6c7(0x125)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3ee6c7(0x12a)},'storage':{'$first':_0x3ee6c7(0x13f)},'rack':{'$first':_0x3ee6c7(0x17e)}}}]);console['log'](_0x3ed2de);const _0x350736=await warehouse[_0x3ee6c7(0x139)]([{'$match':{'status':_0x3ee6c7(0x180),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x3ee6c7(0x131),'name':{'$first':_0x3ee6c7(0x131)}}},{'$sort':{'name':0x1}}]),_0x2a61b9=await warehouse[_0x3ee6c7(0x139)]([{'$match':{'status':'Enabled','name':'QA\x20Warehouse'}},{'$group':{'_id':'$name','name':{'$first':_0x3ee6c7(0x131)}}},{'$sort':{'name':0x1}}]),_0x3e444f=await product['find']({});if(_0x1478db[0x0][_0x3ee6c7(0x156)]==_0x3ee6c7(0x169)){var _0x2b2d0f=users['English'];console['log'](_0x2b2d0f);}else{if(_0x1478db[0x0][_0x3ee6c7(0x156)]==_0x3ee6c7(0x14f))var _0x2b2d0f=users[_0x3ee6c7(0x14f)];else{if(_0x1478db[0x0][_0x3ee6c7(0x156)]==_0x3ee6c7(0x153))var _0x2b2d0f=users[_0x3ee6c7(0x153)];else{if(_0x1478db[0x0][_0x3ee6c7(0x156)]==_0x3ee6c7(0x16c))var _0x2b2d0f=users[_0x3ee6c7(0x16c)];else{if(_0x1478db[0x0]['language']=='French')var _0x2b2d0f=users['French'];else{if(_0x1478db[0x0]['language']==_0x3ee6c7(0x15e))var _0x2b2d0f=users['Portuguese'];else{if(_0x1478db[0x0][_0x3ee6c7(0x156)]==_0x3ee6c7(0x115))var _0x2b2d0f=users[_0x3ee6c7(0x115)];else{if(_0x1478db[0x0][_0x3ee6c7(0x156)]==_0x3ee6c7(0x15a))var _0x2b2d0f=users['Arabic'];}}}}}}}_0x3b3df7[_0x3ee6c7(0x149)](_0x3ee6c7(0x126),{'success':_0x1b09c1['flash'](_0x3ee6c7(0x13e)),'errors':_0x1b09c1[_0x3ee6c7(0x152)]('errors'),'role':_0x35d8c1,'profile':_0x1e6cd6,'master_shop':_0x1478db,'user':_0x12147f,'stock':_0x3ed2de,'unit':_0x3e444f,'language':_0x2b2d0f,'warehouses':_0x350736,'rooms':_0x700550,'warehouse_QA':_0x2a61b9});}catch(_0x104cea){console[_0x3ee6c7(0x14c)](_0x104cea);}}),router['post'](a0_0x226199(0x16a),auth,async(_0x21fab5,_0xe42c6c)=>{var _0x1ab04d=a0_0x226199;if(_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x110)]=='QA')try{const _0xf15246=_0x21fab5[_0x1ab04d(0x148)]['id'],_0x14fe15=await sales_return[_0x1ab04d(0x128)]({'invoice':_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x17c)]}),_0x6bc019=await warehouse[_0x1ab04d(0x128)]({'name':_0x14fe15['ToWarehouse'],'room':_0x14fe15[_0x1ab04d(0x165)]}),{invoice:_0x59de1e,customer:_0x273ded,date:_0x2815af,warehouse_name:_0x5876a1,product_name:_0x40f652,primary_code:_0x29419d,secondary_code:_0x37b6ae,product_code:_0x2ba1f0,sales_quantity:_0x555b0c,stocks:_0x5852b1,return_qty:_0x34b6e0,note:_0x541889,to_warehouse_name_QA:_0x41fd17,to_Room_name_QA:_0x126cba}=_0x21fab5[_0x1ab04d(0x17f)];if(typeof product_name_QA==_0x1ab04d(0x150))var _0x1515eb=[_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x111)]],_0xee579a=[_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x124)]],_0x4d868a=[_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x136)]],_0x50d640=[_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x123)]],_0x27d670=[_0x21fab5['body']['sales_quantity_QA']],_0x50fcb6=[_0x21fab5[_0x1ab04d(0x17f)]['stocks_QA']],_0x146c60=[_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x175)]];else var _0x1515eb=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x111)]],_0xee579a=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x124)]],_0x4d868a=[..._0x21fab5['body'][_0x1ab04d(0x136)]],_0x50d640=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x123)]],_0x27d670=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x11e)]],_0x50fcb6=[..._0x21fab5[_0x1ab04d(0x17f)]['stocks_QA']],_0x146c60=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x175)]];const _0x270b6f=_0x1515eb['map'](_0x412d5a=>{return _0x412d5a={'product_name':_0x412d5a};});_0xee579a[_0x1ab04d(0x132)]((_0x55c14c,_0x199061)=>{_0x270b6f[_0x199061]['primary_code']=_0x55c14c;}),_0x4d868a['forEach']((_0x4b97b6,_0x39a39b)=>{var _0x3a913e=_0x1ab04d;_0x270b6f[_0x39a39b][_0x3a913e(0x11d)]=_0x4b97b6;}),_0x50d640[_0x1ab04d(0x132)]((_0x41f98c,_0x585556)=>{var _0x1c9c6b=_0x1ab04d;_0x270b6f[_0x585556][_0x1c9c6b(0x137)]=_0x41f98c;}),_0x27d670[_0x1ab04d(0x132)]((_0x32de14,_0x3ab305)=>{var _0x2069b0=_0x1ab04d;_0x270b6f[_0x3ab305][_0x2069b0(0x14d)]=_0x32de14;}),_0x50fcb6[_0x1ab04d(0x132)]((_0x4b5a41,_0x20a14a)=>{_0x270b6f[_0x20a14a]['stock']=_0x4b5a41;}),_0x146c60[_0x1ab04d(0x132)]((_0x4814aa,_0x2b8138)=>{_0x270b6f[_0x2b8138]['return_qty']=_0x4814aa;}),_0x14fe15[_0x1ab04d(0x16b)][_0x1ab04d(0x132)](_0x4b97bd=>{var _0x401a41=_0x1ab04d;const _0x3eb034=_0x6bc019[_0x401a41(0x157)]['map'](_0x3ceaec=>{var _0x2229d8=_0x401a41;_0x3ceaec[_0x2229d8(0x113)]==_0x4b97bd[_0x2229d8(0x113)]&&(_0x3ceaec[_0x2229d8(0x172)]=parseInt(_0x3ceaec[_0x2229d8(0x172)])+parseInt(_0x4b97bd[_0x2229d8(0x181)]));});}),await _0x6bc019[_0x1ab04d(0x17a)](),_0x14fe15[_0x1ab04d(0x17c)]=_0x59de1e,_0x14fe15[_0x1ab04d(0x160)]=_0x273ded,_0x14fe15['date']=_0x2815af,_0x14fe15[_0x1ab04d(0x162)]=_0x5876a1,_0x14fe15[_0x1ab04d(0x16b)]=_0x270b6f,_0x14fe15['note']=_0x541889,_0x14fe15[_0x1ab04d(0x11b)]=_0x41fd17,_0x14fe15['ToRoom']=_0x126cba;const _0x5af1b2=await _0x14fe15['save'](),_0x2837aa=await c_payment_data[_0x1ab04d(0x128)]({'invoice':_0x21fab5[_0x1ab04d(0x17f)]['invoice'],'reason':_0x1ab04d(0x12d)});_0x2837aa['suppliers']=_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x120)],_0x2837aa[_0x1ab04d(0x116)]=_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x116)],await _0x2837aa[_0x1ab04d(0x17a)](),_0x21fab5[_0x1ab04d(0x152)](_0x1ab04d(0x13e),_0x1ab04d(0x112)),_0xe42c6c[_0x1ab04d(0x10c)](_0x1ab04d(0x122));}catch(_0x1dd5e3){console[_0x1ab04d(0x14c)](_0x1dd5e3),_0xe42c6c['status'](0xc8)[_0x1ab04d(0x13a)]({'message':_0x1dd5e3[_0x1ab04d(0x10d)]});}else try{const _0xf4d1a2=_0x21fab5[_0x1ab04d(0x148)]['id'];console[_0x1ab04d(0x14c)](_0xf4d1a2);const _0x2e3fb7=await sales_return[_0x1ab04d(0x128)]({'invoice':_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x17c)]});console[_0x1ab04d(0x14c)]('old_data',_0x2e3fb7);const _0x14899b=await warehouse[_0x1ab04d(0x128)]({'name':_0x2e3fb7['ToWarehouse'],'room':_0x2e3fb7[_0x1ab04d(0x165)]});console[_0x1ab04d(0x14c)]('old_warehouse_data',_0x14899b);const {invoice:_0x4b64c8,customer:_0x409e16,date:_0x9cf0ac,warehouse_name:_0xca7fe1,product_name:_0x3317a8,primary_code:_0x1d1b4c,secondary_code:_0x1838df,product_code:_0x2cebf3,sales_quantity:_0x4556ec,stocks:_0x440e2a,return_qty:_0x3ccc49,note:_0x1d36ee,to_warehouse_name:_0x107390,to_Room_name:_0x1fe13e}=_0x21fab5[_0x1ab04d(0x17f)];console[_0x1ab04d(0x14c)](_0x21fab5[_0x1ab04d(0x17f)]);if(typeof _0x3317a8=='string')var _0x1515eb=[_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x113)]],_0xee579a=[_0x21fab5['body']['primary_code']],_0x4d868a=[_0x21fab5['body'][_0x1ab04d(0x11d)]],_0x50d640=[_0x21fab5[_0x1ab04d(0x17f)]['product_code']],_0x27d670=[_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x179)]],_0x50fcb6=[_0x21fab5['body']['stocks']],_0x146c60=[_0x21fab5['body'][_0x1ab04d(0x181)]],_0x58c2b3=[_0x21fab5['body']['bay']],_0x378952=[_0x21fab5[_0x1ab04d(0x17f)]['bin']],_0x550bea=[_0x21fab5[_0x1ab04d(0x17f)]['types']],_0x59f188=[_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x117)]];else var _0x1515eb=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x113)]],_0xee579a=[..._0x21fab5[_0x1ab04d(0x17f)]['primary_code']],_0x4d868a=[..._0x21fab5['body'][_0x1ab04d(0x11d)]],_0x50d640=[..._0x21fab5['body']['product_code']],_0x27d670=[..._0x21fab5['body']['sales_quantity']],_0x50fcb6=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x134)]],_0x146c60=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x181)]],_0x58c2b3=[..._0x21fab5[_0x1ab04d(0x17f)]['bay']],_0x378952=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x11f)]],_0x550bea=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x130)]],_0x59f188=[..._0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x117)]];const _0x313629=_0x1515eb[_0x1ab04d(0x144)](_0x32ad58=>{return _0x32ad58={'product_name':_0x32ad58};});_0xee579a[_0x1ab04d(0x132)]((_0x5515a0,_0x379c4c)=>{var _0x56a6e9=_0x1ab04d;_0x313629[_0x379c4c][_0x56a6e9(0x182)]=_0x5515a0;}),_0x4d868a['forEach']((_0x2dc4f1,_0x240fee)=>{var _0x24cfa0=_0x1ab04d;_0x313629[_0x240fee][_0x24cfa0(0x11d)]=_0x2dc4f1;}),_0x50d640[_0x1ab04d(0x132)]((_0x19d26f,_0x52a883)=>{_0x313629[_0x52a883]['product_code']=_0x19d26f;}),_0x27d670['forEach']((_0x3efe18,_0x3458fb)=>{_0x313629[_0x3458fb]['sale_qty']=_0x3efe18;}),_0x50fcb6[_0x1ab04d(0x132)]((_0x2ea463,_0x3f9e73)=>{_0x313629[_0x3f9e73]['stock']=_0x2ea463;}),_0x146c60[_0x1ab04d(0x132)]((_0x430d40,_0x266ed6)=>{var _0xb7b483=_0x1ab04d;_0x313629[_0x266ed6][_0xb7b483(0x181)]=_0x430d40;}),_0x58c2b3['forEach']((_0x4740e6,_0x51d5ae)=>{var _0x176663=_0x1ab04d;_0x313629[_0x51d5ae][_0x176663(0x133)]=_0x4740e6;}),_0x378952[_0x1ab04d(0x132)]((_0x3901d0,_0x5bd788)=>{var _0xcc6e09=_0x1ab04d;_0x313629[_0x5bd788][_0xcc6e09(0x11f)]=_0x3901d0;}),_0x550bea[_0x1ab04d(0x132)]((_0x46260c,_0x4d23d8)=>{var _0x2574e9=_0x1ab04d;_0x313629[_0x4d23d8][_0x2574e9(0x15d)]=_0x46260c;}),_0x59f188[_0x1ab04d(0x132)]((_0x5c63fe,_0x35de77)=>{var _0x4b830e=_0x1ab04d;_0x313629[_0x35de77][_0x4b830e(0x117)]=_0x5c63fe;});var _0x45177e=0x0;_0x313629[_0x1ab04d(0x132)](_0x541ee9=>{var _0x51a0fd=_0x1ab04d;console[_0x51a0fd(0x14c)](_0x51a0fd(0x151),_0x541ee9),(parseInt(_0x541ee9['sale_qty'])<parseInt(_0x541ee9[_0x51a0fd(0x181)])||parseInt(_0x541ee9[_0x51a0fd(0x114)])<parseInt(_0x541ee9[_0x51a0fd(0x181)])&&parseInt(_0x541ee9[_0x51a0fd(0x14d)])>parseInt(_0x541ee9[_0x51a0fd(0x181)])||parseInt(_0x541ee9['return_qty'])==0x0)&&_0x45177e++;});if(_0x45177e!=0x0)return _0x21fab5[_0x1ab04d(0x152)](_0x1ab04d(0x163),_0x1ab04d(0x155)),_0xe42c6c['redirect'](_0x1ab04d(0x12c));_0x2e3fb7['return_sale']['forEach'](_0x45d10a=>{var _0x2a8841=_0x1ab04d;const _0x4697f8=_0x14899b[_0x2a8841(0x157)][_0x2a8841(0x144)](_0x2aec5b=>{var _0x430eaf=_0x2a8841;_0x2aec5b['product_name']==_0x45d10a['product_name']&&_0x2aec5b[_0x430eaf(0x117)]==_0x45d10a[_0x430eaf(0x117)]&&_0x2aec5b[_0x430eaf(0x15d)]==_0x45d10a['type']&&_0x2aec5b[_0x430eaf(0x11f)]==_0x45d10a[_0x430eaf(0x11f)]&&_0x2aec5b[_0x430eaf(0x133)]==_0x45d10a[_0x430eaf(0x133)]&&(_0x2aec5b[_0x430eaf(0x172)]=parseInt(_0x2aec5b[_0x430eaf(0x172)])+parseInt(_0x45d10a[_0x430eaf(0x181)]));});}),console[_0x1ab04d(0x14c)](_0x1ab04d(0x16e),_0x14899b),await _0x14899b[_0x1ab04d(0x17a)](),_0x2e3fb7[_0x1ab04d(0x17c)]=_0x4b64c8,_0x2e3fb7[_0x1ab04d(0x160)]=_0x409e16,_0x2e3fb7[_0x1ab04d(0x116)]=_0x9cf0ac,_0x2e3fb7[_0x1ab04d(0x162)]=_0xca7fe1,_0x2e3fb7[_0x1ab04d(0x129)]=_0x313629,_0x2e3fb7[_0x1ab04d(0x16d)]=_0x1d36ee,_0x2e3fb7[_0x1ab04d(0x11b)]=_0x107390,_0x2e3fb7['ToRoom']=_0x1fe13e;const _0x6d57db=await _0x2e3fb7['save']();console[_0x1ab04d(0x14c)]('new\x20new_data',_0x6d57db);const _0x1b32b1=await c_payment_data[_0x1ab04d(0x128)]({'invoice':_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x17c)],'reason':_0x1ab04d(0x12d)});_0x1b32b1[_0x1ab04d(0x120)]=_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x120)],_0x1b32b1[_0x1ab04d(0x116)]=_0x21fab5[_0x1ab04d(0x17f)][_0x1ab04d(0x116)],await _0x1b32b1[_0x1ab04d(0x17a)](),_0x21fab5[_0x1ab04d(0x152)](_0x1ab04d(0x13e),'purchase\x20return\x20successfully'),_0xe42c6c[_0x1ab04d(0x10c)](_0x1ab04d(0x141));}catch(_0x53c8a6){console[_0x1ab04d(0x14c)](_0x53c8a6),_0xe42c6c[_0x1ab04d(0x12b)](0xc8)['json']({'message':_0x53c8a6[_0x1ab04d(0x10d)]});}}),router[a0_0x226199(0x158)]('/give_payment/:id',auth,async(_0x4cab81,_0x96e44a)=>{var _0x27cf14=a0_0x226199;try{const _0x3e9d0c=_0x4cab81[_0x27cf14(0x148)]['id'],{invoice:_0x584f8d,customer:_0x516ec2,payable_to_customer:_0x66eda2,paid_amount:_0x1fed7f}=_0x4cab81[_0x27cf14(0x17f)],_0x2908eb=await sales_return[_0x27cf14(0x14b)](_0x3e9d0c);console[_0x27cf14(0x14c)]('data',_0x2908eb),console['log'](_0x66eda2),console['log'](_0x1fed7f);var _0x2631a8=_0x66eda2-_0x1fed7f;console[_0x27cf14(0x14c)](_0x27cf14(0x140),_0x2631a8),_0x2908eb[_0x27cf14(0x168)]=parseFloat(_0x1fed7f)+parseFloat(_0x2908eb['paid_amount']),_0x2908eb[_0x27cf14(0x13b)]=_0x2631a8,console[_0x27cf14(0x14c)](_0x2908eb);const _0x500733=await _0x2908eb[_0x27cf14(0x17a)]();console[_0x27cf14(0x14c)](0x1b207);const _0x4290f6=await c_payment_data[_0x27cf14(0x128)]({'invoice':_0x4cab81[_0x27cf14(0x17f)][_0x27cf14(0x17c)],'reason':'Sale\x20Return'});console[_0x27cf14(0x14c)](_0x27cf14(0x143),_0x4290f6),_0x4290f6['amount']=_0x2631a8,await _0x4290f6[_0x27cf14(0x17a)]();let _0x3b6dc8=new Date(),_0xe14a9d=('0'+_0x3b6dc8[_0x27cf14(0x17b)]())[_0x27cf14(0x14a)](-0x2),_0x2437af=('0'+(_0x3b6dc8[_0x27cf14(0x121)]()+0x1))[_0x27cf14(0x14a)](-0x2),_0x4e2dcd=_0x3b6dc8[_0x27cf14(0x10e)](),_0x2241bb=_0x4e2dcd+'-'+_0x2437af+'-'+_0xe14a9d;const _0x5545e3=new customer_payment({'invoice':_0x584f8d,'date':_0x4e2dcd+'-'+_0x2437af+'-'+_0xe14a9d,'customer':_0x516ec2,'reason':_0x27cf14(0x15c),'amount':_0x1fed7f}),_0x24ea13=await _0x5545e3[_0x27cf14(0x17a)]();_0x4cab81[_0x27cf14(0x152)](_0x27cf14(0x13e),_0x27cf14(0x119)),_0x96e44a[_0x27cf14(0x10c)](_0x27cf14(0x141));}catch(_0xf1cfe4){console['log'](_0xf1cfe4);}}),router[a0_0x226199(0x11c)](a0_0x226199(0x16f),auth,async(_0x4fa46c,_0x414a27)=>{var _0x2fdbe6=a0_0x226199;try{const {username:_0x42ce6a,email:_0x49c3ff,role:_0x21f8fe}=_0x4fa46c['user'],_0x7bfc60=_0x4fa46c[_0x2fdbe6(0x15b)],_0x5557a8=await profile[_0x2fdbe6(0x128)]({'email':_0x7bfc60['email']}),_0x276051=await master_shop[_0x2fdbe6(0x173)]();console[_0x2fdbe6(0x14c)]('master',_0x276051);const _0x152def=_0x4fa46c[_0x2fdbe6(0x148)]['id'],_0x26ebc9=await sales_return[_0x2fdbe6(0x14b)](_0x152def);console[_0x2fdbe6(0x14c)](_0x26ebc9);const _0x39b454=await customer[_0x2fdbe6(0x128)]({'name':_0x26ebc9[_0x2fdbe6(0x160)]});console['log'](_0x39b454);if(_0x276051[0x0][_0x2fdbe6(0x156)]==_0x2fdbe6(0x169)){var _0x448a21=users[_0x2fdbe6(0x14e)];console[_0x2fdbe6(0x14c)](_0x448a21);}else{if(_0x276051[0x0]['language']==_0x2fdbe6(0x14f))var _0x448a21=users[_0x2fdbe6(0x14f)];else{if(_0x276051[0x0][_0x2fdbe6(0x156)]=='German')var _0x448a21=users[_0x2fdbe6(0x153)];else{if(_0x276051[0x0]['language']=='Spanish')var _0x448a21=users[_0x2fdbe6(0x16c)];else{if(_0x276051[0x0]['language']==_0x2fdbe6(0x171))var _0x448a21=users['French'];else{if(_0x276051[0x0]['language']==_0x2fdbe6(0x15e))var _0x448a21=users[_0x2fdbe6(0x177)];else{if(_0x276051[0x0][_0x2fdbe6(0x156)]==_0x2fdbe6(0x115))var _0x448a21=users[_0x2fdbe6(0x115)];else{if(_0x276051[0x0]['language']=='Arabic\x20(ae)')var _0x448a21=users[_0x2fdbe6(0x13d)];}}}}}}}_0x414a27['render'](_0x2fdbe6(0x138),{'success':_0x4fa46c[_0x2fdbe6(0x152)](_0x2fdbe6(0x13e)),'errors':_0x4fa46c[_0x2fdbe6(0x152)](_0x2fdbe6(0x163)),'role':_0x7bfc60,'profile':_0x5557a8,'master_shop':_0x276051,'customers':_0x39b454,'sales':_0x26ebc9,'language':_0x448a21});}catch(_0x3c0dbf){console['log'](_0x3c0dbf);}}),module[a0_0x226199(0x167)]=router;