var a0_0x48b264=a0_0xfebd;(function(_0x3647e9,_0x48cd90){var _0x4051bf=a0_0xfebd,_0xb0ee31=_0x3647e9();while(!![]){try{var _0x95293c=parseInt(_0x4051bf(0x15c))/0x1*(parseInt(_0x4051bf(0x135))/0x2)+parseInt(_0x4051bf(0x134))/0x3+parseInt(_0x4051bf(0x159))/0x4+parseInt(_0x4051bf(0x110))/0x5*(parseInt(_0x4051bf(0x11e))/0x6)+-parseInt(_0x4051bf(0x14d))/0x7+parseInt(_0x4051bf(0x15e))/0x8*(parseInt(_0x4051bf(0x133))/0x9)+-parseInt(_0x4051bf(0xfe))/0xa;if(_0x95293c===_0x48cd90)break;else _0xb0ee31['push'](_0xb0ee31['shift']());}catch(_0x439fe5){_0xb0ee31['push'](_0xb0ee31['shift']());}}}(a0_0x38c3,0x793f4));const express=require(a0_0x48b264(0x124)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x48b264(0x149)),auth=require(a0_0x48b264(0x120)),users=require(a0_0x48b264(0x114));function a0_0xfebd(_0x39e16f,_0x18b89d){var _0x38c36b=a0_0x38c3();return a0_0xfebd=function(_0xfebd4f,_0x3d68c8){_0xfebd4f=_0xfebd4f-0xf7;var _0x3efb53=_0x38c36b[_0xfebd4f];return _0x3efb53;},a0_0xfebd(_0x39e16f,_0x18b89d);}function a0_0x38c3(){var _0x34fed1=['$product_details.type','payment\x20successfull','paid_amount','product_code_QA','Portuguese\x20(BR)','21095230THBPvh','floorlevel','getMonth','stocks','bay','French','get','old_warehouse_data','/sales_return_finished/view','user','return_sale_edit_finished','render','sales_return_invoice','aggregate','English\x20(US)','types','Hindi','Arabic\x20(ae)','4636695rHITvu','message','status','purchase\x20return\x20successfully','../public/language/languages.json','save','invoice','return_sale','QA\x20Warehouse','string','$product_details.floorlevel','c_payment','$product_details.primary_code','ToWarehouse','6vUMJxx','English','../middleware/auth','date','Return\x20Rooms','customer_docs','express','return_sale_QA','subtract','params','old_data','ToRoom','/view/:id','Spanish','body','/sales_return/view','Chinese','flash','German','secondary_code_QA','primary_code','54LMdzUl','1712364GTZYjl','13742IxFWGE','getDate','for_categorize','Portuguese','$name','slice','find','back','amount','primary_code_QA','findById','$product_details','customer','$customer_docs','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','sales_quantity','master','stock','sales_quantity_QA','type','../models/all_models','$product_details.storage','product_stock','/view','2497635coJLeG','map','log','$product_details.rack','email','post','sale_qty','Arabic','$product_details.secondary_code','note','Finished\x20Goods','$product_details._id','165620oVXnpZ','sales_return_finished','$product_details.product_stock','74NxJrWJ','secondary_code','1219960kRZKvF','product_name_QA','return_qty','data','warehouse_name','bin','stocks_QA','product_details','product_code','findOne','language','forEach','return_qty_QA','errors','Sale\x20Return','Enabled','suppliers','product_name','redirect','success','json'];a0_0x38c3=function(){return _0x34fed1;};return a0_0x38c3();}router[a0_0x48b264(0x104)](a0_0x48b264(0x14c),auth,async(_0x5a7196,_0x694c52)=>{var _0x6783d1=a0_0x48b264;try{const {username:_0x1627f7,email:_0x367c84,role:_0x25a60d}=_0x5a7196[_0x6783d1(0x107)],_0x30b764=_0x5a7196['user'],_0xd984b1=await profile[_0x6783d1(0x167)]({'email':_0x30b764[_0x6783d1(0x151)]}),_0x193ff7=await master_shop[_0x6783d1(0x13b)](),_0x213930=await sales_return_finished['aggregate']([{'$lookup':{'from':'customers','localField':_0x6783d1(0x141),'foreignField':'name','as':_0x6783d1(0x123)}},{'$unwind':_0x6783d1(0x142)}]);if(_0x193ff7[0x0][_0x6783d1(0x168)]==_0x6783d1(0x10c)){var _0x52a807=users[_0x6783d1(0x11f)];console[_0x6783d1(0x14f)](_0x52a807);}else{if(_0x193ff7[0x0]['language']==_0x6783d1(0x10e))var _0x52a807=users[_0x6783d1(0x10e)];else{if(_0x193ff7[0x0][_0x6783d1(0x168)]==_0x6783d1(0x130))var _0x52a807=users['German'];else{if(_0x193ff7[0x0][_0x6783d1(0x168)]==_0x6783d1(0x12b))var _0x52a807=users[_0x6783d1(0x12b)];else{if(_0x193ff7[0x0][_0x6783d1(0x168)]==_0x6783d1(0x103))var _0x52a807=users[_0x6783d1(0x103)];else{if(_0x193ff7[0x0][_0x6783d1(0x168)]==_0x6783d1(0xfd))var _0x52a807=users[_0x6783d1(0x138)];else{if(_0x193ff7[0x0][_0x6783d1(0x168)]=='Chinese')var _0x52a807=users[_0x6783d1(0x12e)];else{if(_0x193ff7[0x0][_0x6783d1(0x168)]==_0x6783d1(0x10f))var _0x52a807=users['Arabic'];}}}}}}}_0x694c52[_0x6783d1(0x109)](_0x6783d1(0x15a),{'success':_0x5a7196[_0x6783d1(0x12f)](_0x6783d1(0xf7)),'errors':_0x5a7196[_0x6783d1(0x12f)](_0x6783d1(0x16b)),'role':_0x30b764,'profile':_0xd984b1,'master_shop':_0x193ff7,'user':_0x213930,'language':_0x52a807});}catch(_0x3d0fe0){console['log'](_0x3d0fe0);}}),router[a0_0x48b264(0x104)](a0_0x48b264(0x12a),auth,async(_0x131eb6,_0x199ab5)=>{var _0x70cb9e=a0_0x48b264;try{const {username:_0x546efa,email:_0x4281c2,role:_0x278d54}=_0x131eb6[_0x70cb9e(0x107)],_0x247e7b=_0x131eb6[_0x70cb9e(0x107)],_0x4b9bf9=await profile[_0x70cb9e(0x167)]({'email':_0x247e7b['email']}),_0x54c6ec=await master_shop[_0x70cb9e(0x13b)]();console[_0x70cb9e(0x14f)]('master',_0x54c6ec);const _0x17498a=_0x131eb6[_0x70cb9e(0x127)]['id'];console[_0x70cb9e(0x14f)](_0x17498a);var _0x2279fa=[_0x70cb9e(0x122)];const _0x497c30=await sales_return_finished[_0x70cb9e(0x13f)](_0x17498a),_0x36ffcd=await warehouse[_0x70cb9e(0x10b)]([{'$match':{'name':_0x497c30[_0x70cb9e(0x11d)],'room':_0x497c30[_0x70cb9e(0x129)]}},{'$unwind':_0x70cb9e(0x140)},{'$group':{'_id':_0x70cb9e(0x158),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x70cb9e(0x15b)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x70cb9e(0xf9)},'floorlevel':{'$first':_0x70cb9e(0x11a)},'primary_code':{'$first':_0x70cb9e(0x11c)},'secondary_code':{'$first':_0x70cb9e(0x155)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x70cb9e(0x14a)},'rack':{'$first':_0x70cb9e(0x150)}}}]);console[_0x70cb9e(0x14f)](_0x36ffcd);const _0x5b1544=await warehouse[_0x70cb9e(0x10b)]([{'$match':{'status':_0x70cb9e(0x16d),'warehouse_category':_0x70cb9e(0x157)}},{'$group':{'_id':'$name','name':{'$first':_0x70cb9e(0x139)}}},{'$sort':{'name':0x1}}]),_0x4a340c=await warehouse[_0x70cb9e(0x10b)]([{'$match':{'status':'Enabled','name':_0x70cb9e(0x118)}},{'$group':{'_id':_0x70cb9e(0x139),'name':{'$first':_0x70cb9e(0x139)}}},{'$sort':{'name':0x1}}]),_0x4b2024=await product[_0x70cb9e(0x13b)]({});if(_0x54c6ec[0x0]['language']==_0x70cb9e(0x10c)){var _0x3b9747=users[_0x70cb9e(0x11f)];console[_0x70cb9e(0x14f)](_0x3b9747);}else{if(_0x54c6ec[0x0][_0x70cb9e(0x168)]==_0x70cb9e(0x10e))var _0x3b9747=users[_0x70cb9e(0x10e)];else{if(_0x54c6ec[0x0][_0x70cb9e(0x168)]==_0x70cb9e(0x130))var _0x3b9747=users[_0x70cb9e(0x130)];else{if(_0x54c6ec[0x0][_0x70cb9e(0x168)]=='Spanish')var _0x3b9747=users[_0x70cb9e(0x12b)];else{if(_0x54c6ec[0x0][_0x70cb9e(0x168)]==_0x70cb9e(0x103))var _0x3b9747=users[_0x70cb9e(0x103)];else{if(_0x54c6ec[0x0][_0x70cb9e(0x168)]==_0x70cb9e(0xfd))var _0x3b9747=users[_0x70cb9e(0x138)];else{if(_0x54c6ec[0x0][_0x70cb9e(0x168)]==_0x70cb9e(0x12e))var _0x3b9747=users['Chinese'];else{if(_0x54c6ec[0x0][_0x70cb9e(0x168)]=='Arabic\x20(ae)')var _0x3b9747=users[_0x70cb9e(0x154)];}}}}}}}_0x199ab5[_0x70cb9e(0x109)](_0x70cb9e(0x108),{'success':_0x131eb6[_0x70cb9e(0x12f)](_0x70cb9e(0xf7)),'errors':_0x131eb6['flash'](_0x70cb9e(0x16b)),'role':_0x247e7b,'profile':_0x4b9bf9,'master_shop':_0x54c6ec,'user':_0x497c30,'stock':_0x36ffcd,'unit':_0x4b2024,'language':_0x3b9747,'warehouses':_0x5b1544,'rooms':_0x2279fa,'warehouse_QA':_0x4a340c});}catch(_0x509ef7){console['log'](_0x509ef7);}}),router[a0_0x48b264(0x152)]('/view/:id',auth,async(_0x4c15ce,_0x25fd4e)=>{var _0x5f0325=a0_0x48b264;if(_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x137)]=='QA')try{const _0x5a372b=_0x4c15ce[_0x5f0325(0x127)]['id'],_0x137a19=await sales_return[_0x5f0325(0x167)]({'invoice':_0x4c15ce['body']['invoice']}),_0x37bbca=await warehouse['findOne']({'name':_0x137a19[_0x5f0325(0x11d)],'room':_0x137a19[_0x5f0325(0x129)]}),{invoice:_0x3c3b05,customer:_0x2089c1,date:_0x214ae8,warehouse_name:_0x4f8908,product_name:_0x2f76fa,primary_code:_0x461c24,secondary_code:_0x47b4dc,product_code:_0x51d524,sales_quantity:_0x57a6d3,stocks:_0x3ea971,return_qty:_0x2ed848,note:_0x3af64a,to_warehouse_name_QA:_0x475d5c,to_Room_name_QA:_0x1c3a67}=_0x4c15ce[_0x5f0325(0x12c)];if(typeof product_name_QA=='string')var _0x849fe3=[_0x4c15ce['body']['product_name_QA']],_0x3a2ad1=[_0x4c15ce[_0x5f0325(0x12c)]['primary_code_QA']],_0x1d5ff8=[_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x131)]],_0x1e845e=[_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0xfc)]],_0x5c3fd3=[_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x147)]],_0x3c3196=[_0x4c15ce['body']['stocks_QA']],_0x1b8874=[_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x16a)]];else var _0x849fe3=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x15f)]],_0x3a2ad1=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x13e)]],_0x1d5ff8=[..._0x4c15ce[_0x5f0325(0x12c)]['secondary_code_QA']],_0x1e845e=[..._0x4c15ce['body'][_0x5f0325(0xfc)]],_0x5c3fd3=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x147)]],_0x3c3196=[..._0x4c15ce['body'][_0x5f0325(0x164)]],_0x1b8874=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x16a)]];const _0xd74dc4=_0x849fe3[_0x5f0325(0x14e)](_0x3bf29c=>{return _0x3bf29c={'product_name':_0x3bf29c};});_0x3a2ad1[_0x5f0325(0x169)]((_0x2b84b3,_0x2b3a89)=>{var _0x2c9efd=_0x5f0325;_0xd74dc4[_0x2b3a89][_0x2c9efd(0x132)]=_0x2b84b3;}),_0x1d5ff8[_0x5f0325(0x169)]((_0x4f0766,_0x3f8f4d)=>{_0xd74dc4[_0x3f8f4d]['secondary_code']=_0x4f0766;}),_0x1e845e[_0x5f0325(0x169)]((_0x1da740,_0x28164e)=>{_0xd74dc4[_0x28164e]['product_code']=_0x1da740;}),_0x5c3fd3[_0x5f0325(0x169)]((_0x48ca58,_0xd9a0e9)=>{var _0x10c5ae=_0x5f0325;_0xd74dc4[_0xd9a0e9][_0x10c5ae(0x153)]=_0x48ca58;}),_0x3c3196['forEach']((_0x1edf06,_0x1dca23)=>{_0xd74dc4[_0x1dca23]['stock']=_0x1edf06;}),_0x1b8874['forEach']((_0x157307,_0x24c671)=>{var _0xe6499b=_0x5f0325;_0xd74dc4[_0x24c671][_0xe6499b(0x160)]=_0x157307;}),_0x137a19[_0x5f0325(0x125)][_0x5f0325(0x169)](_0x4fa74b=>{var _0x207952=_0x5f0325;const _0x4de50e=_0x37bbca[_0x207952(0x165)]['map'](_0x408c51=>{var _0x295002=_0x207952;_0x408c51[_0x295002(0x16f)]==_0x4fa74b[_0x295002(0x16f)]&&(_0x408c51['product_stock']=parseInt(_0x408c51[_0x295002(0x14b)])+parseInt(_0x4fa74b[_0x295002(0x160)]));});}),await _0x37bbca[_0x5f0325(0x115)](),_0x137a19[_0x5f0325(0x116)]=_0x3c3b05,_0x137a19['customer']=_0x2089c1,_0x137a19[_0x5f0325(0x121)]=_0x214ae8,_0x137a19[_0x5f0325(0x162)]=_0x4f8908,_0x137a19[_0x5f0325(0x125)]=_0xd74dc4,_0x137a19[_0x5f0325(0x156)]=_0x3af64a,_0x137a19[_0x5f0325(0x11d)]=_0x475d5c,_0x137a19[_0x5f0325(0x129)]=_0x1c3a67;const _0x489767=await _0x137a19[_0x5f0325(0x115)](),_0x18d44a=await c_payment_data[_0x5f0325(0x167)]({'invoice':_0x4c15ce['body'][_0x5f0325(0x116)],'reason':'Sale\x20Return'});_0x18d44a[_0x5f0325(0x16e)]=_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x16e)],_0x18d44a[_0x5f0325(0x121)]=_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x121)],await _0x18d44a[_0x5f0325(0x115)](),_0x4c15ce['flash']('success',_0x5f0325(0x113)),_0x25fd4e[_0x5f0325(0x170)](_0x5f0325(0x106));}catch(_0x55ecca){console[_0x5f0325(0x14f)](_0x55ecca),_0x25fd4e[_0x5f0325(0x112)](0xc8)[_0x5f0325(0xf8)]({'message':_0x55ecca[_0x5f0325(0x111)]});}else try{const _0x28a104=_0x4c15ce['params']['id'];console[_0x5f0325(0x14f)](_0x28a104);const _0x1b64d5=await sales_return[_0x5f0325(0x167)]({'invoice':_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x116)]});console[_0x5f0325(0x14f)](_0x5f0325(0x128),_0x1b64d5);const _0x256eb9=await warehouse[_0x5f0325(0x167)]({'name':_0x1b64d5[_0x5f0325(0x11d)],'room':_0x1b64d5[_0x5f0325(0x129)]});console[_0x5f0325(0x14f)]('old_warehouse_data',_0x256eb9);const {invoice:_0x17fd70,customer:_0xd6bb80,date:_0x29fc26,warehouse_name:_0x2e3917,product_name:_0x3057fa,primary_code:_0x446e64,secondary_code:_0x152e70,product_code:_0x17f6df,sales_quantity:_0x9dd8f8,stocks:_0x7fe52f,return_qty:_0x2e4ac5,note:_0x34eb81,to_warehouse_name:_0x39792a,to_Room_name:_0x223125}=_0x4c15ce[_0x5f0325(0x12c)];console[_0x5f0325(0x14f)](_0x4c15ce[_0x5f0325(0x12c)]);if(typeof _0x3057fa==_0x5f0325(0x119))var _0x849fe3=[_0x4c15ce[_0x5f0325(0x12c)]['product_name']],_0x3a2ad1=[_0x4c15ce[_0x5f0325(0x12c)]['primary_code']],_0x1d5ff8=[_0x4c15ce[_0x5f0325(0x12c)]['secondary_code']],_0x1e845e=[_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x166)]],_0x5c3fd3=[_0x4c15ce['body']['sales_quantity']],_0x3c3196=[_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x101)]],_0x1b8874=[_0x4c15ce['body'][_0x5f0325(0x160)]],_0x3ef205=[_0x4c15ce['body'][_0x5f0325(0x102)]],_0x78ef28=[_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x163)]],_0x3a6a89=[_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x10d)]],_0x8f5a54=[_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0xff)]];else var _0x849fe3=[..._0x4c15ce['body']['product_name']],_0x3a2ad1=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x132)]],_0x1d5ff8=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x15d)]],_0x1e845e=[..._0x4c15ce['body']['product_code']],_0x5c3fd3=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x144)]],_0x3c3196=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x101)]],_0x1b8874=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x160)]],_0x3ef205=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x102)]],_0x78ef28=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x163)]],_0x3a6a89=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x10d)]],_0x8f5a54=[..._0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0xff)]];const _0x45e4d1=_0x849fe3[_0x5f0325(0x14e)](_0x4030c2=>{return _0x4030c2={'product_name':_0x4030c2};});_0x3a2ad1[_0x5f0325(0x169)]((_0x896b61,_0x4b4509)=>{var _0x18fb21=_0x5f0325;_0x45e4d1[_0x4b4509][_0x18fb21(0x132)]=_0x896b61;}),_0x1d5ff8[_0x5f0325(0x169)]((_0x426677,_0x2b847f)=>{_0x45e4d1[_0x2b847f]['secondary_code']=_0x426677;}),_0x1e845e['forEach']((_0x5742be,_0x428e17)=>{var _0x4ff4ae=_0x5f0325;_0x45e4d1[_0x428e17][_0x4ff4ae(0x166)]=_0x5742be;}),_0x5c3fd3[_0x5f0325(0x169)]((_0x19305f,_0x6739e)=>{var _0x2c4766=_0x5f0325;_0x45e4d1[_0x6739e][_0x2c4766(0x153)]=_0x19305f;}),_0x3c3196[_0x5f0325(0x169)]((_0x2b62f2,_0x5da9c5)=>{var _0x2473e4=_0x5f0325;_0x45e4d1[_0x5da9c5][_0x2473e4(0x146)]=_0x2b62f2;}),_0x1b8874['forEach']((_0x48d312,_0x2f441e)=>{var _0x20b54a=_0x5f0325;_0x45e4d1[_0x2f441e][_0x20b54a(0x160)]=_0x48d312;}),_0x3ef205[_0x5f0325(0x169)]((_0x58b5aa,_0x472288)=>{var _0x53f092=_0x5f0325;_0x45e4d1[_0x472288][_0x53f092(0x102)]=_0x58b5aa;}),_0x78ef28[_0x5f0325(0x169)]((_0x140c9d,_0x20a942)=>{var _0x867c2a=_0x5f0325;_0x45e4d1[_0x20a942][_0x867c2a(0x163)]=_0x140c9d;}),_0x3a6a89[_0x5f0325(0x169)]((_0x2b1789,_0x40f738)=>{var _0x5bd7a9=_0x5f0325;_0x45e4d1[_0x40f738][_0x5bd7a9(0x148)]=_0x2b1789;}),_0x8f5a54[_0x5f0325(0x169)]((_0x386f93,_0x1d71e4)=>{var _0x1c0937=_0x5f0325;_0x45e4d1[_0x1d71e4][_0x1c0937(0xff)]=_0x386f93;});var _0xeef664=0x0;_0x45e4d1[_0x5f0325(0x169)](_0x4f16fe=>{var _0x33f186=_0x5f0325;console[_0x33f186(0x14f)]('foreach\x20newproduct',_0x4f16fe),(parseInt(_0x4f16fe[_0x33f186(0x153)])<parseInt(_0x4f16fe['return_qty'])||parseInt(_0x4f16fe['stock'])<parseInt(_0x4f16fe[_0x33f186(0x160)])&&parseInt(_0x4f16fe[_0x33f186(0x153)])>parseInt(_0x4f16fe[_0x33f186(0x160)])||parseInt(_0x4f16fe[_0x33f186(0x160)])==0x0)&&_0xeef664++;});if(_0xeef664!=0x0)return _0x4c15ce[_0x5f0325(0x12f)](_0x5f0325(0x16b),_0x5f0325(0x143)),_0x25fd4e['redirect'](_0x5f0325(0x13c));_0x1b64d5[_0x5f0325(0x117)][_0x5f0325(0x169)](_0x3adce2=>{var _0x3d64fb=_0x5f0325;const _0x2271a2=_0x256eb9[_0x3d64fb(0x165)][_0x3d64fb(0x14e)](_0x34256b=>{var _0x1cbc47=_0x3d64fb;_0x34256b[_0x1cbc47(0x16f)]==_0x3adce2[_0x1cbc47(0x16f)]&&_0x34256b[_0x1cbc47(0xff)]==_0x3adce2[_0x1cbc47(0xff)]&&_0x34256b[_0x1cbc47(0x148)]==_0x3adce2[_0x1cbc47(0x148)]&&_0x34256b[_0x1cbc47(0x163)]==_0x3adce2['bin']&&_0x34256b[_0x1cbc47(0x102)]==_0x3adce2[_0x1cbc47(0x102)]&&(_0x34256b[_0x1cbc47(0x14b)]=parseInt(_0x34256b[_0x1cbc47(0x14b)])+parseInt(_0x3adce2[_0x1cbc47(0x160)]));});}),console[_0x5f0325(0x14f)](_0x5f0325(0x105),_0x256eb9),await _0x256eb9[_0x5f0325(0x115)](),_0x1b64d5['invoice']=_0x17fd70,_0x1b64d5[_0x5f0325(0x141)]=_0xd6bb80,_0x1b64d5[_0x5f0325(0x121)]=_0x29fc26,_0x1b64d5[_0x5f0325(0x162)]=_0x2e3917,_0x1b64d5[_0x5f0325(0x117)]=_0x45e4d1,_0x1b64d5[_0x5f0325(0x156)]=_0x34eb81,_0x1b64d5[_0x5f0325(0x11d)]=_0x39792a,_0x1b64d5[_0x5f0325(0x129)]=_0x223125;const _0x17cdd3=await _0x1b64d5['save']();console[_0x5f0325(0x14f)]('new\x20new_data',_0x17cdd3);const _0x4cfb1b=await c_payment_data[_0x5f0325(0x167)]({'invoice':_0x4c15ce[_0x5f0325(0x12c)][_0x5f0325(0x116)],'reason':_0x5f0325(0x16c)});_0x4cfb1b[_0x5f0325(0x16e)]=_0x4c15ce[_0x5f0325(0x12c)]['suppliers'],_0x4cfb1b[_0x5f0325(0x121)]=_0x4c15ce['body']['date'],await _0x4cfb1b[_0x5f0325(0x115)](),_0x4c15ce['flash']('success',_0x5f0325(0x113)),_0x25fd4e['redirect'](_0x5f0325(0x12d));}catch(_0x1c3861){console[_0x5f0325(0x14f)](_0x1c3861),_0x25fd4e[_0x5f0325(0x112)](0xc8)[_0x5f0325(0xf8)]({'message':_0x1c3861[_0x5f0325(0x111)]});}}),router[a0_0x48b264(0x152)]('/give_payment/:id',auth,async(_0x5dbc36,_0x51bbbf)=>{var _0x59e303=a0_0x48b264;try{const _0x34545b=_0x5dbc36[_0x59e303(0x127)]['id'],{invoice:_0x3c2576,customer:_0x91391f,payable_to_customer:_0x297c93,paid_amount:_0x53903b}=_0x5dbc36[_0x59e303(0x12c)],_0x2864ec=await sales_return[_0x59e303(0x13f)](_0x34545b);console[_0x59e303(0x14f)](_0x59e303(0x161),_0x2864ec),console[_0x59e303(0x14f)](_0x297c93),console[_0x59e303(0x14f)](_0x53903b);var _0x1e9385=_0x297c93-_0x53903b;console[_0x59e303(0x14f)](_0x59e303(0x126),_0x1e9385),_0x2864ec[_0x59e303(0xfb)]=parseFloat(_0x53903b)+parseFloat(_0x2864ec[_0x59e303(0xfb)]),_0x2864ec['due_amount']=_0x1e9385,console[_0x59e303(0x14f)](_0x2864ec);const _0x59eec6=await _0x2864ec[_0x59e303(0x115)]();console[_0x59e303(0x14f)](0x1b207);const _0x262fb2=await c_payment_data[_0x59e303(0x167)]({'invoice':_0x5dbc36[_0x59e303(0x12c)][_0x59e303(0x116)],'reason':'Sale\x20Return'});console[_0x59e303(0x14f)](_0x59e303(0x11b),_0x262fb2),_0x262fb2[_0x59e303(0x13d)]=_0x1e9385,await _0x262fb2['save']();let _0x2fbc1d=new Date(),_0x99d952=('0'+_0x2fbc1d[_0x59e303(0x136)]())[_0x59e303(0x13a)](-0x2),_0x6cc7ec=('0'+(_0x2fbc1d[_0x59e303(0x100)]()+0x1))[_0x59e303(0x13a)](-0x2),_0x5b0c6e=_0x2fbc1d['getFullYear'](),_0x5dee03=_0x5b0c6e+'-'+_0x6cc7ec+'-'+_0x99d952;const _0x5e4c1a=new customer_payment({'invoice':_0x3c2576,'date':_0x5b0c6e+'-'+_0x6cc7ec+'-'+_0x99d952,'customer':_0x91391f,'reason':'Returned\x20Payment\x20For\x20Sale\x20Return','amount':_0x53903b}),_0x461665=await _0x5e4c1a['save']();_0x5dbc36[_0x59e303(0x12f)](_0x59e303(0xf7),_0x59e303(0xfa)),_0x51bbbf['redirect']('/sales_return/view');}catch(_0x4b3102){console[_0x59e303(0x14f)](_0x4b3102);}}),router[a0_0x48b264(0x104)]('/invoice/:id',auth,async(_0x49d5b8,_0x365f52)=>{var _0x7495ac=a0_0x48b264;try{const {username:_0x368a7f,email:_0x506952,role:_0x170f40}=_0x49d5b8['user'],_0x7e803a=_0x49d5b8['user'],_0x1d45a4=await profile[_0x7495ac(0x167)]({'email':_0x7e803a['email']}),_0x13f656=await master_shop['find']();console[_0x7495ac(0x14f)](_0x7495ac(0x145),_0x13f656);const _0x52ecca=_0x49d5b8[_0x7495ac(0x127)]['id'],_0x262c32=await sales_return[_0x7495ac(0x13f)](_0x52ecca);console[_0x7495ac(0x14f)](_0x262c32);const _0x61e9e1=await customer['findOne']({'name':_0x262c32[_0x7495ac(0x141)]});console[_0x7495ac(0x14f)](_0x61e9e1);if(_0x13f656[0x0][_0x7495ac(0x168)]=='English\x20(US)'){var _0x1bf50c=users[_0x7495ac(0x11f)];console[_0x7495ac(0x14f)](_0x1bf50c);}else{if(_0x13f656[0x0][_0x7495ac(0x168)]==_0x7495ac(0x10e))var _0x1bf50c=users[_0x7495ac(0x10e)];else{if(_0x13f656[0x0]['language']==_0x7495ac(0x130))var _0x1bf50c=users[_0x7495ac(0x130)];else{if(_0x13f656[0x0][_0x7495ac(0x168)]==_0x7495ac(0x12b))var _0x1bf50c=users[_0x7495ac(0x12b)];else{if(_0x13f656[0x0][_0x7495ac(0x168)]==_0x7495ac(0x103))var _0x1bf50c=users[_0x7495ac(0x103)];else{if(_0x13f656[0x0][_0x7495ac(0x168)]==_0x7495ac(0xfd))var _0x1bf50c=users[_0x7495ac(0x138)];else{if(_0x13f656[0x0][_0x7495ac(0x168)]==_0x7495ac(0x12e))var _0x1bf50c=users[_0x7495ac(0x12e)];else{if(_0x13f656[0x0][_0x7495ac(0x168)]==_0x7495ac(0x10f))var _0x1bf50c=users[_0x7495ac(0x154)];}}}}}}}_0x365f52[_0x7495ac(0x109)](_0x7495ac(0x10a),{'success':_0x49d5b8[_0x7495ac(0x12f)](_0x7495ac(0xf7)),'errors':_0x49d5b8[_0x7495ac(0x12f)](_0x7495ac(0x16b)),'role':_0x7e803a,'profile':_0x1d45a4,'master_shop':_0x13f656,'customers':_0x61e9e1,'sales':_0x262c32,'language':_0x1bf50c});}catch(_0x154bc5){console['log'](_0x154bc5);}}),module['exports']=router;