var a0_0x3a5936=a0_0x2fca;(function(_0x58e2d6,_0x271d8d){var _0x41e844=a0_0x2fca,_0x3674d4=_0x58e2d6();while(!![]){try{var _0x52fd25=-parseInt(_0x41e844(0x22e))/0x1+parseInt(_0x41e844(0x219))/0x2*(parseInt(_0x41e844(0x23e))/0x3)+parseInt(_0x41e844(0x1e0))/0x4+-parseInt(_0x41e844(0x230))/0x5+parseInt(_0x41e844(0x214))/0x6+parseInt(_0x41e844(0x204))/0x7*(parseInt(_0x41e844(0x1d2))/0x8)+parseInt(_0x41e844(0x21b))/0x9;if(_0x52fd25===_0x271d8d)break;else _0x3674d4['push'](_0x3674d4['shift']());}catch(_0x227915){_0x3674d4['push'](_0x3674d4['shift']());}}}(a0_0x5c52,0x99a15));const express=require(a0_0x3a5936(0x21c)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require(a0_0x3a5936(0x235)),users=require('../public/language/languages.json');function a0_0x2fca(_0x5b04a4,_0x459bcd){var _0x5c5208=a0_0x5c52();return a0_0x2fca=function(_0x2fca35,_0x220f60){_0x2fca35=_0x2fca35-0x1c7;var _0x3081b6=_0x5c5208[_0x2fca35];return _0x3081b6;},a0_0x2fca(_0x5b04a4,_0x459bcd);}router[a0_0x3a5936(0x211)]('/view',auth,async(_0x55e2f7,_0x3bff9a)=>{var _0x2f298a=a0_0x3a5936;try{const {username:_0x41dd7e,email:_0x397196,role:_0x53551c}=_0x55e2f7[_0x2f298a(0x1fe)],_0xc9ab49=_0x55e2f7[_0x2f298a(0x1fe)],_0x69f3e0=await profile[_0x2f298a(0x1d7)]({'email':_0xc9ab49[_0x2f298a(0x1fa)]}),_0x180da2=await master_shop[_0x2f298a(0x1cd)](),_0x13cdea=await sales_return_finished['aggregate']([{'$lookup':{'from':_0x2f298a(0x22f),'localField':_0x2f298a(0x1db),'foreignField':_0x2f298a(0x20f),'as':_0x2f298a(0x1d8)}},{'$unwind':'$customer_docs'}]);if(_0x180da2[0x0][_0x2f298a(0x236)]==_0x2f298a(0x1cc)){var _0x43afa9=users[_0x2f298a(0x1f6)];console[_0x2f298a(0x1e4)](_0x43afa9);}else{if(_0x180da2[0x0][_0x2f298a(0x236)]==_0x2f298a(0x1cf))var _0x43afa9=users['Hindi'];else{if(_0x180da2[0x0]['language']==_0x2f298a(0x234))var _0x43afa9=users[_0x2f298a(0x234)];else{if(_0x180da2[0x0][_0x2f298a(0x236)]==_0x2f298a(0x1ef))var _0x43afa9=users[_0x2f298a(0x1ef)];else{if(_0x180da2[0x0][_0x2f298a(0x236)]=='French')var _0x43afa9=users[_0x2f298a(0x223)];else{if(_0x180da2[0x0][_0x2f298a(0x236)]=='Portuguese\x20(BR)')var _0x43afa9=users[_0x2f298a(0x233)];else{if(_0x180da2[0x0]['language']=='Chinese')var _0x43afa9=users[_0x2f298a(0x1d6)];else{if(_0x180da2[0x0][_0x2f298a(0x236)]=='Arabic\x20(ae)')var _0x43afa9=users[_0x2f298a(0x1df)];}}}}}}}_0x3bff9a['render'](_0x2f298a(0x1e5),{'success':_0x55e2f7[_0x2f298a(0x227)](_0x2f298a(0x207)),'errors':_0x55e2f7[_0x2f298a(0x227)]('errors'),'role':_0xc9ab49,'profile':_0x69f3e0,'master_shop':_0x180da2,'user':_0x13cdea,'language':_0x43afa9});}catch(_0x28a27e){console['log'](_0x28a27e);}}),router[a0_0x3a5936(0x211)](a0_0x3a5936(0x1d9),auth,async(_0x3f3cb3,_0x4a9a5e)=>{var _0x4f4946=a0_0x3a5936;try{const {username:_0x13030a,email:_0x1e71bd,role:_0x54c9cd}=_0x3f3cb3['user'],_0xe2ad8b=_0x3f3cb3[_0x4f4946(0x1fe)],_0x58ab53=await profile[_0x4f4946(0x1d7)]({'email':_0xe2ad8b[_0x4f4946(0x1fa)]}),_0x46188b=await master_shop[_0x4f4946(0x1cd)]();console[_0x4f4946(0x1e4)](_0x4f4946(0x212),_0x46188b);const _0x4e2b6b=_0x3f3cb3[_0x4f4946(0x1f1)]['id'];console[_0x4f4946(0x1e4)](_0x4e2b6b);var _0x1187a9=[_0x4f4946(0x1ec)];const _0x2ecf38=await sales_return_finished[_0x4f4946(0x239)](_0x4e2b6b),_0xa52efa=await warehouse[_0x4f4946(0x220)]([{'$match':{'name':_0x2ecf38[_0x4f4946(0x1cb)],'room':_0x2ecf38[_0x4f4946(0x23a)]}},{'$unwind':_0x4f4946(0x1f0)},{'$group':{'_id':_0x4f4946(0x1fb),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4f4946(0x1de)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x4f4946(0x1c7)},'type':{'$first':_0x4f4946(0x229)},'floorlevel':{'$first':_0x4f4946(0x20b)},'primary_code':{'$first':_0x4f4946(0x1d4)},'secondary_code':{'$first':_0x4f4946(0x203)},'product_code':{'$first':_0x4f4946(0x1e9)},'storage':{'$first':_0x4f4946(0x217)},'rack':{'$first':_0x4f4946(0x22a)}}}]);console[_0x4f4946(0x1e4)](_0xa52efa);const _0x4e9d32=await warehouse[_0x4f4946(0x220)]([{'$match':{'status':_0x4f4946(0x1f4),'warehouse_category':_0x4f4946(0x23b)}},{'$group':{'_id':_0x4f4946(0x238),'name':{'$first':_0x4f4946(0x238)}}},{'$sort':{'name':0x1}}]),_0x4ff62c=await warehouse[_0x4f4946(0x220)]([{'$match':{'status':'Enabled','name':'QA\x20Warehouse'}},{'$group':{'_id':_0x4f4946(0x238),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x4090ec=await product['find']({});if(_0x46188b[0x0][_0x4f4946(0x236)]==_0x4f4946(0x1cc)){var _0x1acab7=users['English'];console[_0x4f4946(0x1e4)](_0x1acab7);}else{if(_0x46188b[0x0][_0x4f4946(0x236)]==_0x4f4946(0x1cf))var _0x1acab7=users[_0x4f4946(0x1cf)];else{if(_0x46188b[0x0][_0x4f4946(0x236)]=='German')var _0x1acab7=users['German'];else{if(_0x46188b[0x0][_0x4f4946(0x236)]=='Spanish')var _0x1acab7=users[_0x4f4946(0x1ef)];else{if(_0x46188b[0x0][_0x4f4946(0x236)]=='French')var _0x1acab7=users[_0x4f4946(0x223)];else{if(_0x46188b[0x0][_0x4f4946(0x236)]==_0x4f4946(0x1ee))var _0x1acab7=users[_0x4f4946(0x233)];else{if(_0x46188b[0x0][_0x4f4946(0x236)]=='Chinese')var _0x1acab7=users[_0x4f4946(0x1d6)];else{if(_0x46188b[0x0][_0x4f4946(0x236)]==_0x4f4946(0x216))var _0x1acab7=users['Arabic'];}}}}}}}_0x4a9a5e[_0x4f4946(0x1f8)](_0x4f4946(0x1ca),{'success':_0x3f3cb3[_0x4f4946(0x227)]('success'),'errors':_0x3f3cb3[_0x4f4946(0x227)](_0x4f4946(0x1d5)),'role':_0xe2ad8b,'profile':_0x58ab53,'master_shop':_0x46188b,'user':_0x2ecf38,'stock':_0xa52efa,'unit':_0x4090ec,'language':_0x1acab7,'warehouses':_0x4e9d32,'rooms':_0x1187a9,'warehouse_QA':_0x4ff62c});}catch(_0x3929ad){console['log'](_0x3929ad);}}),router[a0_0x3a5936(0x221)](a0_0x3a5936(0x1d9),auth,async(_0x28e401,_0xcafa04)=>{var _0x570ba1=a0_0x3a5936;if(_0x28e401[_0x570ba1(0x208)]['for_categorize']=='QA')try{const _0x4f50a7=_0x28e401[_0x570ba1(0x1f1)]['id'],_0x102f61=await sales_return['findOne']({'invoice':_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x20e)]}),_0x14df8b=await warehouse['findOne']({'name':_0x102f61[_0x570ba1(0x1cb)],'room':_0x102f61['ToRoom']}),{invoice:_0x49a16a,customer:_0x242168,date:_0x371da2,warehouse_name:_0x38fca3,product_name:_0x278809,primary_code:_0x3cde31,secondary_code:_0x4f4687,product_code:_0x3f6609,sales_quantity:_0x1c91e0,stocks:_0x5e8101,return_qty:_0x5ab47c,note:_0x3fb6cc,to_warehouse_name_QA:_0x5a935c,to_Room_name_QA:_0x32448a}=_0x28e401[_0x570ba1(0x208)];if(typeof product_name_QA=='string')var _0x1b1148=[_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x225)]],_0x219317=[_0x28e401['body'][_0x570ba1(0x1ce)]],_0x4e78fc=[_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x224)]],_0x53420f=[_0x28e401['body'][_0x570ba1(0x213)]],_0x40879c=[_0x28e401[_0x570ba1(0x208)]['sales_quantity_QA']],_0x293ad6=[_0x28e401[_0x570ba1(0x208)]['stocks_QA']],_0x2295e1=[_0x28e401['body'][_0x570ba1(0x1c9)]];else var _0x1b1148=[..._0x28e401[_0x570ba1(0x208)][_0x570ba1(0x225)]],_0x219317=[..._0x28e401['body'][_0x570ba1(0x1ce)]],_0x4e78fc=[..._0x28e401['body'][_0x570ba1(0x224)]],_0x53420f=[..._0x28e401['body'][_0x570ba1(0x213)]],_0x40879c=[..._0x28e401[_0x570ba1(0x208)][_0x570ba1(0x1f5)]],_0x293ad6=[..._0x28e401[_0x570ba1(0x208)]['stocks_QA']],_0x2295e1=[..._0x28e401[_0x570ba1(0x208)]['return_qty_QA']];const _0x3c6012=_0x1b1148[_0x570ba1(0x21e)](_0x116ab7=>{return _0x116ab7={'product_name':_0x116ab7};});_0x219317[_0x570ba1(0x226)]((_0x213ed5,_0x53e3c5)=>{var _0x1d16a0=_0x570ba1;_0x3c6012[_0x53e3c5][_0x1d16a0(0x1d0)]=_0x213ed5;}),_0x4e78fc[_0x570ba1(0x226)]((_0x6739c0,_0x592cd0)=>{var _0x3cf468=_0x570ba1;_0x3c6012[_0x592cd0][_0x3cf468(0x1e2)]=_0x6739c0;}),_0x53420f[_0x570ba1(0x226)]((_0x313e76,_0x1d077d)=>{var _0x4cdeee=_0x570ba1;_0x3c6012[_0x1d077d][_0x4cdeee(0x237)]=_0x313e76;}),_0x40879c['forEach']((_0x254c7a,_0x540ad2)=>{var _0x29a1ca=_0x570ba1;_0x3c6012[_0x540ad2][_0x29a1ca(0x1f2)]=_0x254c7a;}),_0x293ad6[_0x570ba1(0x226)]((_0x10a58b,_0x4f6583)=>{var _0xbff0ad=_0x570ba1;_0x3c6012[_0x4f6583][_0xbff0ad(0x202)]=_0x10a58b;}),_0x2295e1['forEach']((_0x429840,_0x2d0e74)=>{var _0x50eb08=_0x570ba1;_0x3c6012[_0x2d0e74][_0x50eb08(0x210)]=_0x429840;}),_0x102f61[_0x570ba1(0x1e7)][_0x570ba1(0x226)](_0xaa51ec=>{const _0x418294=_0x14df8b['product_details']['map'](_0x5e55b9=>{var _0x33c590=a0_0x2fca;_0x5e55b9[_0x33c590(0x206)]==_0xaa51ec['product_name']&&(_0x5e55b9[_0x33c590(0x1e6)]=parseInt(_0x5e55b9[_0x33c590(0x1e6)])+parseInt(_0xaa51ec[_0x33c590(0x210)]));});}),await _0x14df8b['save'](),_0x102f61[_0x570ba1(0x20e)]=_0x49a16a,_0x102f61[_0x570ba1(0x1db)]=_0x242168,_0x102f61[_0x570ba1(0x22d)]=_0x371da2,_0x102f61[_0x570ba1(0x231)]=_0x38fca3,_0x102f61['return_sale_QA']=_0x3c6012,_0x102f61[_0x570ba1(0x215)]=_0x3fb6cc,_0x102f61[_0x570ba1(0x1cb)]=_0x5a935c,_0x102f61['ToRoom']=_0x32448a;const _0x15b51a=await _0x102f61[_0x570ba1(0x23c)](),_0x252f4b=await c_payment_data[_0x570ba1(0x1d7)]({'invoice':_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x20e)],'reason':_0x570ba1(0x1d1)});_0x252f4b[_0x570ba1(0x20c)]=_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x20c)],_0x252f4b[_0x570ba1(0x22d)]=_0x28e401[_0x570ba1(0x208)]['date'],await _0x252f4b['save'](),_0x28e401[_0x570ba1(0x227)]('success',_0x570ba1(0x23d)),_0xcafa04[_0x570ba1(0x1dd)](_0x570ba1(0x232));}catch(_0x3b550c){console[_0x570ba1(0x1e4)](_0x3b550c),_0xcafa04[_0x570ba1(0x228)](0xc8)[_0x570ba1(0x205)]({'message':_0x3b550c[_0x570ba1(0x22c)]});}else try{const _0x38e387=_0x28e401[_0x570ba1(0x1f1)]['id'];console[_0x570ba1(0x1e4)](_0x38e387);const _0x4e84d2=await sales_return[_0x570ba1(0x1d7)]({'invoice':_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x20e)]});console[_0x570ba1(0x1e4)](_0x570ba1(0x22b),_0x4e84d2);const _0x1f90a5=await warehouse[_0x570ba1(0x1d7)]({'name':_0x4e84d2['ToWarehouse'],'room':_0x4e84d2['ToRoom']});console[_0x570ba1(0x1e4)](_0x570ba1(0x200),_0x1f90a5);const {invoice:_0x4b26ca,customer:_0x2ba7db,date:_0x51e7d5,warehouse_name:_0x2c04ca,product_name:_0x12e235,primary_code:_0x573e59,secondary_code:_0xf93fee,product_code:_0x1d3404,sales_quantity:_0x2f2480,stocks:_0x1bb97,return_qty:_0x3f47fe,note:_0x505f48,to_warehouse_name:_0x314834,to_Room_name:_0x12887f}=_0x28e401['body'];console[_0x570ba1(0x1e4)](_0x28e401[_0x570ba1(0x208)]);if(typeof _0x12e235==_0x570ba1(0x1ea))var _0x1b1148=[_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x206)]],_0x219317=[_0x28e401['body'][_0x570ba1(0x1d0)]],_0x4e78fc=[_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x1e2)]],_0x53420f=[_0x28e401[_0x570ba1(0x208)]['product_code']],_0x40879c=[_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x1c8)]],_0x293ad6=[_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x21d)]],_0x2295e1=[_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x210)]],_0x4869ee=[_0x28e401['body']['bay']],_0x152137=[_0x28e401['body'][_0x570ba1(0x20a)]],_0x6c7086=[_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x1fc)]],_0x46f586=[_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x1da)]];else var _0x1b1148=[..._0x28e401[_0x570ba1(0x208)][_0x570ba1(0x206)]],_0x219317=[..._0x28e401[_0x570ba1(0x208)]['primary_code']],_0x4e78fc=[..._0x28e401[_0x570ba1(0x208)][_0x570ba1(0x1e2)]],_0x53420f=[..._0x28e401['body'][_0x570ba1(0x237)]],_0x40879c=[..._0x28e401[_0x570ba1(0x208)][_0x570ba1(0x1c8)]],_0x293ad6=[..._0x28e401[_0x570ba1(0x208)][_0x570ba1(0x21d)]],_0x2295e1=[..._0x28e401[_0x570ba1(0x208)]['return_qty']],_0x4869ee=[..._0x28e401[_0x570ba1(0x208)][_0x570ba1(0x1e8)]],_0x152137=[..._0x28e401[_0x570ba1(0x208)][_0x570ba1(0x20a)]],_0x6c7086=[..._0x28e401[_0x570ba1(0x208)][_0x570ba1(0x1fc)]],_0x46f586=[..._0x28e401['body'][_0x570ba1(0x1da)]];const _0x5a7729=_0x1b1148[_0x570ba1(0x21e)](_0x163e34=>{return _0x163e34={'product_name':_0x163e34};});_0x219317[_0x570ba1(0x226)]((_0x45a845,_0x455f06)=>{var _0x96fda=_0x570ba1;_0x5a7729[_0x455f06][_0x96fda(0x1d0)]=_0x45a845;}),_0x4e78fc['forEach']((_0x4a2143,_0xabccb)=>{_0x5a7729[_0xabccb]['secondary_code']=_0x4a2143;}),_0x53420f['forEach']((_0x15871d,_0x330256)=>{_0x5a7729[_0x330256]['product_code']=_0x15871d;}),_0x40879c[_0x570ba1(0x226)]((_0x23e912,_0x1843e5)=>{var _0x1aaac1=_0x570ba1;_0x5a7729[_0x1843e5][_0x1aaac1(0x1f2)]=_0x23e912;}),_0x293ad6[_0x570ba1(0x226)]((_0x2871dd,_0x376c3d)=>{var _0x70a2e5=_0x570ba1;_0x5a7729[_0x376c3d][_0x70a2e5(0x202)]=_0x2871dd;}),_0x2295e1[_0x570ba1(0x226)]((_0x5e47f7,_0x28592e)=>{_0x5a7729[_0x28592e]['return_qty']=_0x5e47f7;}),_0x4869ee[_0x570ba1(0x226)]((_0x3ba390,_0x199edf)=>{_0x5a7729[_0x199edf]['bay']=_0x3ba390;}),_0x152137['forEach']((_0x5818a3,_0x47aaa7)=>{var _0x269935=_0x570ba1;_0x5a7729[_0x47aaa7][_0x269935(0x20a)]=_0x5818a3;}),_0x6c7086['forEach']((_0x274f27,_0x107bc3)=>{var _0x4b485f=_0x570ba1;_0x5a7729[_0x107bc3][_0x4b485f(0x1e3)]=_0x274f27;}),_0x46f586[_0x570ba1(0x226)]((_0x2a20e6,_0x51e623)=>{var _0x2b493a=_0x570ba1;_0x5a7729[_0x51e623][_0x2b493a(0x1da)]=_0x2a20e6;});var _0x9717dd=0x0;_0x5a7729[_0x570ba1(0x226)](_0x323fd8=>{var _0x154f04=_0x570ba1;console[_0x154f04(0x1e4)](_0x154f04(0x1f9),_0x323fd8),(parseInt(_0x323fd8[_0x154f04(0x1f2)])<parseInt(_0x323fd8['return_qty'])||parseInt(_0x323fd8[_0x154f04(0x202)])<parseInt(_0x323fd8['return_qty'])&&parseInt(_0x323fd8[_0x154f04(0x1f2)])>parseInt(_0x323fd8[_0x154f04(0x210)])||parseInt(_0x323fd8[_0x154f04(0x210)])==0x0)&&_0x9717dd++;});if(_0x9717dd!=0x0)return _0x28e401['flash'](_0x570ba1(0x1d5),_0x570ba1(0x1f3)),_0xcafa04[_0x570ba1(0x1dd)](_0x570ba1(0x1fd));_0x4e84d2['return_sale'][_0x570ba1(0x226)](_0x2f84d2=>{var _0x24281c=_0x570ba1;const _0x46a9aa=_0x1f90a5['product_details'][_0x24281c(0x21e)](_0xd5ec8b=>{var _0x39508f=_0x24281c;_0xd5ec8b[_0x39508f(0x206)]==_0x2f84d2['product_name']&&_0xd5ec8b[_0x39508f(0x1da)]==_0x2f84d2[_0x39508f(0x1da)]&&_0xd5ec8b['type']==_0x2f84d2['type']&&_0xd5ec8b[_0x39508f(0x20a)]==_0x2f84d2[_0x39508f(0x20a)]&&_0xd5ec8b[_0x39508f(0x1e8)]==_0x2f84d2[_0x39508f(0x1e8)]&&(_0xd5ec8b[_0x39508f(0x1e6)]=parseInt(_0xd5ec8b[_0x39508f(0x1e6)])+parseInt(_0x2f84d2['return_qty']));});}),console[_0x570ba1(0x1e4)](_0x570ba1(0x200),_0x1f90a5),await _0x1f90a5[_0x570ba1(0x23c)](),_0x4e84d2['invoice']=_0x4b26ca,_0x4e84d2[_0x570ba1(0x1db)]=_0x2ba7db,_0x4e84d2[_0x570ba1(0x22d)]=_0x51e7d5,_0x4e84d2[_0x570ba1(0x231)]=_0x2c04ca,_0x4e84d2[_0x570ba1(0x1e1)]=_0x5a7729,_0x4e84d2[_0x570ba1(0x215)]=_0x505f48,_0x4e84d2[_0x570ba1(0x1cb)]=_0x314834,_0x4e84d2['ToRoom']=_0x12887f;const _0xc4a0ff=await _0x4e84d2['save']();console[_0x570ba1(0x1e4)](_0x570ba1(0x1ed),_0xc4a0ff);const _0x302e0f=await c_payment_data[_0x570ba1(0x1d7)]({'invoice':_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x20e)],'reason':_0x570ba1(0x1d1)});_0x302e0f[_0x570ba1(0x20c)]=_0x28e401['body'][_0x570ba1(0x20c)],_0x302e0f['date']=_0x28e401[_0x570ba1(0x208)][_0x570ba1(0x22d)],await _0x302e0f['save'](),_0x28e401[_0x570ba1(0x227)]('success',_0x570ba1(0x23d)),_0xcafa04[_0x570ba1(0x1dd)]('/sales_return/view');}catch(_0xca00b9){console[_0x570ba1(0x1e4)](_0xca00b9),_0xcafa04['status'](0xc8)[_0x570ba1(0x205)]({'message':_0xca00b9[_0x570ba1(0x22c)]});}}),router[a0_0x3a5936(0x221)]('/give_payment/:id',auth,async(_0xca1992,_0x32d126)=>{var _0x3f1e5d=a0_0x3a5936;try{const _0x2e99b6=_0xca1992[_0x3f1e5d(0x1f1)]['id'],{invoice:_0xd0e60f,customer:_0x464629,payable_to_customer:_0x2239af,paid_amount:_0x549bb}=_0xca1992['body'],_0x517595=await sales_return[_0x3f1e5d(0x239)](_0x2e99b6);console['log'](_0x3f1e5d(0x1dc),_0x517595),console[_0x3f1e5d(0x1e4)](_0x2239af),console['log'](_0x549bb);var _0x208393=_0x2239af-_0x549bb;console[_0x3f1e5d(0x1e4)](_0x3f1e5d(0x21a),_0x208393),_0x517595[_0x3f1e5d(0x222)]=parseFloat(_0x549bb)+parseFloat(_0x517595[_0x3f1e5d(0x222)]),_0x517595['due_amount']=_0x208393,console[_0x3f1e5d(0x1e4)](_0x517595);const _0x16ef24=await _0x517595[_0x3f1e5d(0x23c)]();console[_0x3f1e5d(0x1e4)](0x1b207);const _0x2590f9=await c_payment_data[_0x3f1e5d(0x1d7)]({'invoice':_0xca1992[_0x3f1e5d(0x208)]['invoice'],'reason':_0x3f1e5d(0x1d1)});console[_0x3f1e5d(0x1e4)]('c_payment',_0x2590f9),_0x2590f9[_0x3f1e5d(0x1ff)]=_0x208393,await _0x2590f9[_0x3f1e5d(0x23c)]();let _0x10edaa=new Date(),_0x3dd8ea=('0'+_0x10edaa[_0x3f1e5d(0x209)]())[_0x3f1e5d(0x1d3)](-0x2),_0x2a0347=('0'+(_0x10edaa[_0x3f1e5d(0x218)]()+0x1))[_0x3f1e5d(0x1d3)](-0x2),_0x13bc4d=_0x10edaa[_0x3f1e5d(0x20d)](),_0x32449e=_0x13bc4d+'-'+_0x2a0347+'-'+_0x3dd8ea;const _0x4edfeb=new customer_payment({'invoice':_0xd0e60f,'date':_0x13bc4d+'-'+_0x2a0347+'-'+_0x3dd8ea,'customer':_0x464629,'reason':_0x3f1e5d(0x1f7),'amount':_0x549bb}),_0x5ce731=await _0x4edfeb[_0x3f1e5d(0x23c)]();_0xca1992[_0x3f1e5d(0x227)](_0x3f1e5d(0x207),_0x3f1e5d(0x1eb)),_0x32d126['redirect']('/sales_return/view');}catch(_0x28ed99){console[_0x3f1e5d(0x1e4)](_0x28ed99);}}),router[a0_0x3a5936(0x211)](a0_0x3a5936(0x21f),auth,async(_0x2b8645,_0x1bc4a1)=>{var _0x229d4d=a0_0x3a5936;try{const {username:_0x3f8dcd,email:_0x3246cf,role:_0x5586f9}=_0x2b8645[_0x229d4d(0x1fe)],_0x4b3363=_0x2b8645['user'],_0x1299ff=await profile[_0x229d4d(0x1d7)]({'email':_0x4b3363[_0x229d4d(0x1fa)]}),_0x3a9596=await master_shop['find']();console['log'](_0x229d4d(0x212),_0x3a9596);const _0x274b72=_0x2b8645[_0x229d4d(0x1f1)]['id'],_0x3a090e=await sales_return[_0x229d4d(0x239)](_0x274b72);console['log'](_0x3a090e);const _0x4fef93=await customer['findOne']({'name':_0x3a090e[_0x229d4d(0x1db)]});console['log'](_0x4fef93);if(_0x3a9596[0x0][_0x229d4d(0x236)]==_0x229d4d(0x1cc)){var _0x5a6b53=users[_0x229d4d(0x1f6)];console[_0x229d4d(0x1e4)](_0x5a6b53);}else{if(_0x3a9596[0x0][_0x229d4d(0x236)]==_0x229d4d(0x1cf))var _0x5a6b53=users[_0x229d4d(0x1cf)];else{if(_0x3a9596[0x0][_0x229d4d(0x236)]==_0x229d4d(0x234))var _0x5a6b53=users[_0x229d4d(0x234)];else{if(_0x3a9596[0x0][_0x229d4d(0x236)]==_0x229d4d(0x1ef))var _0x5a6b53=users[_0x229d4d(0x1ef)];else{if(_0x3a9596[0x0][_0x229d4d(0x236)]==_0x229d4d(0x223))var _0x5a6b53=users[_0x229d4d(0x223)];else{if(_0x3a9596[0x0][_0x229d4d(0x236)]=='Portuguese\x20(BR)')var _0x5a6b53=users[_0x229d4d(0x233)];else{if(_0x3a9596[0x0]['language']==_0x229d4d(0x1d6))var _0x5a6b53=users['Chinese'];else{if(_0x3a9596[0x0][_0x229d4d(0x236)]==_0x229d4d(0x216))var _0x5a6b53=users[_0x229d4d(0x1df)];}}}}}}}_0x1bc4a1[_0x229d4d(0x1f8)]('sales_return_invoice',{'success':_0x2b8645['flash'](_0x229d4d(0x207)),'errors':_0x2b8645[_0x229d4d(0x227)](_0x229d4d(0x1d5)),'role':_0x4b3363,'profile':_0x1299ff,'master_shop':_0x3a9596,'customers':_0x4fef93,'sales':_0x3a090e,'language':_0x5a6b53});}catch(_0x22d106){console[_0x229d4d(0x1e4)](_0x22d106);}}),module[a0_0x3a5936(0x201)]=router;function a0_0x5c52(){var _0x5789a3=['old_warehouse_data','exports','stock','$product_details.secondary_code','27797kihLTr','json','product_name','success','body','getDate','bin','$product_details.floorlevel','suppliers','getFullYear','invoice','name','return_qty','get','master','product_code_QA','3748296dJTUqt','note','Arabic\x20(ae)','$product_details.storage','getMonth','5990NOYWVh','subtract','2321928HitBYb','express','stocks','map','/invoice/:id','aggregate','post','paid_amount','French','secondary_code_QA','product_name_QA','forEach','flash','status','$product_details.type','$product_details.rack','old_data','message','date','307566EzWuyF','customers','3885450UEdDrx','warehouse_name','/sales_return_finished/view','Portuguese','German','../middleware/auth','language','product_code','$name','findById','ToRoom','Finished\x20Goods','save','purchase\x20return\x20successfully','471hcrpUJ','$product_details.bin','sales_quantity','return_qty_QA','return_sale_edit_finished','ToWarehouse','English\x20(US)','find','primary_code_QA','Hindi','primary_code','Sale\x20Return','232NUOAva','slice','$product_details.primary_code','errors','Chinese','findOne','customer_docs','/view/:id','floorlevel','customer','data','redirect','$product_details.product_stock','Arabic','983372HXQabs','return_sale','secondary_code','type','log','sales_return_finished','product_stock','return_sale_QA','bay','$product_details.product_code','string','payment\x20successfull','Return\x20Rooms','new\x20new_data','Portuguese\x20(BR)','Spanish','$product_details','params','sale_qty','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','Enabled','sales_quantity_QA','English','Returned\x20Payment\x20For\x20Sale\x20Return','render','foreach\x20newproduct','email','$product_details._id','types','back','user','amount'];a0_0x5c52=function(){return _0x5789a3;};return a0_0x5c52();}