function a0_0x5381(){const _0x2a0816=['invoice','warehouses','$product.id_transaction_from','5769iOlZJm','$invoice','$product_details.invoice','$sale_product._id','status','/negative','message','errors','$warehouse_name','warehouse_data','$product.room_names','all','5514761cYqwMJ','$product','$name','Router','$sale_product.invoice','$product_details.product_stock','get','$sale_product','push','14800005047429','flash','$product.id_transaction_id','log','data_sales','$product_details.product_name','../../models/all_models','success','3952416dhszGh','5602660BVgCce','$product.invoice','3000130yaYtsz','data_adjustment','$sale_product.product_name','$product_details','$product._id','_id','data_transfer','map','$product.product_name','$product.product_code','length','/join','$room','express','$product_details._id','json','56JAXIGZ','1302047mMvhDB','INCF-52068316','$product.new_adjust_qty','table\x20page','aggregate','1672412uJKqDC','render','valueOf','/checking','$product.to_quantity','$sale_product.room_name','modifiedCount','exports'];a0_0x5381=function(){return _0x2a0816;};return a0_0x5381();}function a0_0x31ee(_0x5637ea,_0x28dae2){const _0x5381f1=a0_0x5381();return a0_0x31ee=function(_0x31eeaa,_0x17ae96){_0x31eeaa=_0x31eeaa-0x178;let _0x227968=_0x5381f1[_0x31eeaa];return _0x227968;},a0_0x31ee(_0x5637ea,_0x28dae2);}const a0_0xec059b=a0_0x31ee;(function(_0x186694,_0x5a7de4){const _0x578fd5=a0_0x31ee,_0x538f3c=_0x186694();while(!![]){try{const _0x271b05=-parseInt(_0x578fd5(0x1ab))/0x1+-parseInt(_0x578fd5(0x1b0))/0x2+-parseInt(_0x578fd5(0x17a))/0x3+-parseInt(_0x578fd5(0x198))/0x4+-parseInt(_0x578fd5(0x19a))/0x5+-parseInt(_0x578fd5(0x197))/0x6+-parseInt(_0x578fd5(0x186))/0x7*(-parseInt(_0x578fd5(0x1aa))/0x8);if(_0x271b05===_0x5a7de4)break;else _0x538f3c['push'](_0x538f3c['shift']());}catch(_0x407b7a){_0x538f3c['push'](_0x538f3c['shift']());}}}(a0_0x5381,0xae996));const express=require(a0_0xec059b(0x1a7)),app=express(),router=express[a0_0xec059b(0x189)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0xec059b(0x195));router[a0_0xec059b(0x18c)](a0_0xec059b(0x17f),async(_0x5820d8,_0x23e5bf)=>{const _0x20137c=a0_0xec059b;try{const _0x40b382=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x23e5bf[_0x20137c(0x1a9)]({'status':_0x40b382[_0x20137c(0x1b6)]+'\x20documents\x20updated'});}catch(_0x49b975){console[_0x20137c(0x192)](_0x20137c(0x1ae),_0x49b975),_0x23e5bf[_0x20137c(0x17e)](0xc8)[_0x20137c(0x1a9)]({'message':_0x49b975[_0x20137c(0x180)]});}}),router[a0_0xec059b(0x18c)](a0_0xec059b(0x1b3),async(_0x56698a,_0x4e8e09)=>{const _0x1a5474=a0_0xec059b;try{const _0x878ed0=await warehouse[_0x1a5474(0x1af)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':_0x1a5474(0x1ac),'product_details.primary_code':_0x1a5474(0x18f)}},{'$group':{'_id':{'name':_0x1a5474(0x188),'room':_0x1a5474(0x1a6)},'products':{'$push':_0x1a5474(0x19d)}}}]);_0x4e8e09['json'](_0x878ed0);}catch(_0x1c02a9){console[_0x1a5474(0x192)](_0x1a5474(0x1ae),_0x1c02a9),_0x4e8e09[_0x1a5474(0x17e)](0xc8)['json']({'message':_0x1c02a9[_0x1a5474(0x180)]});}}),router['get']('/warehouse_monitor',async(_0x3e6036,_0x2f4a60)=>{const _0x35fff5=a0_0xec059b;_0x2f4a60[_0x35fff5(0x1b1)]('monitor',{'success':_0x3e6036['flash'](_0x35fff5(0x196)),'errors':_0x3e6036[_0x35fff5(0x190)](_0x35fff5(0x181))});}),router[a0_0xec059b(0x18c)](a0_0xec059b(0x1a5),async(_0x4716cc,_0x38b235)=>{const _0x40592a=a0_0xec059b;var _0x5d7d41=await purchases[_0x40592a(0x1af)]([{'$lookup':{'from':_0x40592a(0x178),'let':{'invoice':_0x40592a(0x17b)},'pipeline':[{'$unwind':_0x40592a(0x19d)},{'$match':{'$expr':{'$eq':['$$invoice','$product_details.invoice']}}},{'$project':{'_id':_0x40592a(0x1a8),'product_name':_0x40592a(0x194),'product_code':'$product_details.product_code','quantity_available':_0x40592a(0x18b),'warehouse_name':_0x40592a(0x188),'warehouse_room':_0x40592a(0x1a6),'invoice':_0x40592a(0x17c)}}],'as':_0x40592a(0x183)}}]);_0x5d7d41[_0x40592a(0x193)]={},await Promise[_0x40592a(0x185)](_0x5d7d41[_0x40592a(0x1a1)](async _0x4a4ce6=>{const _0x4f4230=_0x40592a;_0x5d7d41[_0x4f4230(0x193)][_0x4a4ce6[_0x4f4230(0x1b8)]]=[],await Promise[_0x4f4230(0x185)](_0x4a4ce6['warehouse_data'][_0x4f4230(0x1a1)](async _0x3d9a62=>{const _0x157e88=_0x4f4230,_0x2fcc8e=await sales['aggregate']([{'$unwind':_0x157e88(0x18d)},{'$match':{'sale_product.id_transaction_from':_0x3d9a62[_0x157e88(0x19f)][_0x157e88(0x1b2)](),'sale_product.invoice':_0x3d9a62[_0x157e88(0x1b8)]}},{'$project':{'_id':_0x157e88(0x17d),'product_name':_0x157e88(0x19c),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x157e88(0x182),'warehouse_room':_0x157e88(0x1b5),'product_invoice':_0x157e88(0x18a),'invoice':_0x157e88(0x17b),'id_transaction_from':'$sale_product.id_transaction_from'}}]);_0x2fcc8e[_0x157e88(0x1a4)]>0x0&&_0x5d7d41[_0x157e88(0x193)][_0x4a4ce6[_0x157e88(0x1b8)]][_0x157e88(0x18e)](..._0x2fcc8e);}));})),_0x5d7d41['data_sales']=_0x5d7d41[_0x40592a(0x193)],_0x5d7d41[_0x40592a(0x19b)]={},await Promise['all'](_0x5d7d41[_0x40592a(0x1a1)](async _0x58e625=>{const _0x280aa3=_0x40592a;_0x5d7d41[_0x280aa3(0x19b)][_0x58e625[_0x280aa3(0x1b8)]]=[],await Promise['all'](_0x58e625['warehouse_data'][_0x280aa3(0x1a1)](async _0x58a3b4=>{const _0xe1abff=_0x280aa3,_0x55e90a=await adjustment[_0xe1abff(0x1af)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x58a3b4[_0xe1abff(0x19f)][_0xe1abff(0x1b2)](),'product.invoice':_0x58a3b4['invoice']}},{'$project':{'_id':'$product._id','product_name':_0xe1abff(0x1a2),'product_code':_0xe1abff(0x1a3),'quantity_available':_0xe1abff(0x1ad),'warehouse_name':_0xe1abff(0x182),'warehouse_room':_0xe1abff(0x184),'product_invoice':_0xe1abff(0x199),'invoice':_0xe1abff(0x17b),'id_transaction_from':_0xe1abff(0x179)}}]);_0x55e90a['length']>0x0&&_0x5d7d41[_0xe1abff(0x19b)][_0x58e625[_0xe1abff(0x1b8)]][_0xe1abff(0x18e)](..._0x55e90a);}));})),_0x5d7d41[_0x40592a(0x1a0)]={},await Promise[_0x40592a(0x185)](_0x5d7d41[_0x40592a(0x1a1)](async _0x8d2c06=>{const _0x5f2e86=_0x40592a;_0x5d7d41[_0x5f2e86(0x1a0)][_0x8d2c06[_0x5f2e86(0x1b8)]]=[],await Promise[_0x5f2e86(0x185)](_0x8d2c06[_0x5f2e86(0x183)][_0x5f2e86(0x1a1)](async _0x396bb2=>{const _0x33ba0e=_0x5f2e86,_0x3a0ad3=await transfers[_0x33ba0e(0x1af)]([{'$unwind':_0x33ba0e(0x187)},{'$match':{'product.id_transaction_id':_0x396bb2['_id']['valueOf'](),'product.To_invoice':_0x396bb2[_0x33ba0e(0x1b8)]}},{'$project':{'_id':_0x33ba0e(0x19e),'product_name':_0x33ba0e(0x1a2),'product_code':_0x33ba0e(0x1a3),'quantity_available':_0x33ba0e(0x1b4),'warehouse_name':'$to_warehouse','warehouse_room':_0x33ba0e(0x184),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_id':_0x33ba0e(0x191)}}]);console[_0x33ba0e(0x192)](_0x3a0ad3),_0x3a0ad3[_0x33ba0e(0x1a4)]>0x0&&_0x5d7d41[_0x33ba0e(0x1a0)][_0x8d2c06[_0x33ba0e(0x1b8)]]['push'](..._0x3a0ad3);}));})),_0x38b235[_0x40592a(0x1a9)]({'purchases_warehouse':_0x5d7d41,'data_sales':_0x5d7d41[_0x40592a(0x193)],'data_adjustment':_0x5d7d41[_0x40592a(0x19b)],'data_transfer':_0x5d7d41[_0x40592a(0x1a0)]});}),module[a0_0xec059b(0x1b7)]=router;