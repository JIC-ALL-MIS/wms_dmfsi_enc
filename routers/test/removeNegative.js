function a0_0xf82f(_0x43619b,_0x1296db){const _0x543569=a0_0x5435();return a0_0xf82f=function(_0xf82f47,_0x14c53e){_0xf82f47=_0xf82f47-0xa0;let _0x6d86b8=_0x543569[_0xf82f47];return _0x6d86b8;},a0_0xf82f(_0x43619b,_0x1296db);}const a0_0x62b615=a0_0xf82f;(function(_0x1fa267,_0x68baa){const _0x30838a=a0_0xf82f,_0x27a0f4=_0x1fa267();while(!![]){try{const _0xd36e4f=-parseInt(_0x30838a(0xc3))/0x1*(-parseInt(_0x30838a(0xbe))/0x2)+-parseInt(_0x30838a(0xb2))/0x3+-parseInt(_0x30838a(0xd4))/0x4*(parseInt(_0x30838a(0xa7))/0x5)+-parseInt(_0x30838a(0xb8))/0x6*(parseInt(_0x30838a(0xb0))/0x7)+-parseInt(_0x30838a(0xc8))/0x8+parseInt(_0x30838a(0xad))/0x9*(-parseInt(_0x30838a(0xdd))/0xa)+parseInt(_0x30838a(0xa4))/0xb;if(_0xd36e4f===_0x68baa)break;else _0x27a0f4['push'](_0x27a0f4['shift']());}catch(_0x4171c9){_0x27a0f4['push'](_0x27a0f4['shift']());}}}(a0_0x5435,0x5c05f));function a0_0x5435(){const _0x2ba81b=['$product_details._id','data_adjustment','$product.product_code','/negative','status','$product.to_room_name','12DMZGGe','$sale_product.product_name','/join','$sale_product','INCF-52068316','$product_details.invoice','$product','_id','push','36230zpWMxP','$product.product_name','14800005047429','warehouses','render','$sale_product.quantity','monitor','$name','flash','/warehouse_monitor','$$invoice','27090503pVndgK','$product._id','$sale_product._id','707535ZIhVnP','all','data_sales','exports','warehouse_data','log','1818HJXtat','length','$warehouse_name','1873228bbAAXs','/checking','573660NFZTJo','data_transfer','$sale_product.invoice','$product.invoice','$to_warehouse','\x20documents\x20updated','12ebkgwU','invoice','$room','$product.id_transaction_id','aggregate','valueOf','20122FCQCfa','map','$product.to_quantity','$product_details','message','53XXFalf','$invoice','updateMany','table\x20page','json','5890272VbDrOo','get','$product.id_transaction_from','$product_details.product_name','success','$product.room_names'];a0_0x5435=function(){return _0x2ba81b;};return a0_0x5435();}const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require('../../models/all_models');router[a0_0x62b615(0xc9)](a0_0x62b615(0xd1),async(_0x29ee13,_0x475f07)=>{const _0x532364=a0_0x62b615;try{const _0x2d71b7=await warehouse[_0x532364(0xc5)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x475f07[_0x532364(0xc7)]({'status':_0x2d71b7['modifiedCount']+_0x532364(0xb7)});}catch(_0x21c47c){console[_0x532364(0xac)](_0x532364(0xc6),_0x21c47c),_0x475f07[_0x532364(0xd2)](0xc8)['json']({'message':_0x21c47c[_0x532364(0xc2)]});}}),router[a0_0x62b615(0xc9)](a0_0x62b615(0xb1),async(_0x3129aa,_0x4be1ad)=>{const _0x270a21=a0_0x62b615;try{const _0x247018=await warehouse[_0x270a21(0xbc)]([{'$unwind':_0x270a21(0xc1)},{'$match':{'product_details.invoice':_0x270a21(0xd8),'product_details.primary_code':_0x270a21(0xdf)}},{'$group':{'_id':{'name':_0x270a21(0xa0),'room':_0x270a21(0xba)},'products':{'$push':_0x270a21(0xc1)}}}]);_0x4be1ad[_0x270a21(0xc7)](_0x247018);}catch(_0x2ec2e6){console['log']('table\x20page',_0x2ec2e6),_0x4be1ad[_0x270a21(0xd2)](0xc8)[_0x270a21(0xc7)]({'message':_0x2ec2e6[_0x270a21(0xc2)]});}}),router[a0_0x62b615(0xc9)](a0_0x62b615(0xa2),async(_0x5180ab,_0x1697ca)=>{const _0x54a0ac=a0_0x62b615;_0x1697ca[_0x54a0ac(0xe1)](_0x54a0ac(0xe3),{'success':_0x5180ab[_0x54a0ac(0xa1)](_0x54a0ac(0xcc)),'errors':_0x5180ab[_0x54a0ac(0xa1)]('errors')});}),router[a0_0x62b615(0xc9)](a0_0x62b615(0xd6),async(_0x34b281,_0xaeeb81)=>{const _0x1d2b4e=a0_0x62b615;var _0x28f1d4=await purchases['aggregate']([{'$lookup':{'from':_0x1d2b4e(0xe0),'let':{'invoice':_0x1d2b4e(0xc4)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x1d2b4e(0xa3),_0x1d2b4e(0xd9)]}}},{'$project':{'_id':_0x1d2b4e(0xce),'product_name':_0x1d2b4e(0xcb),'product_code':'$product_details.product_code','quantity_available':'$product_details.product_stock','warehouse_name':_0x1d2b4e(0xa0),'warehouse_room':_0x1d2b4e(0xba),'invoice':_0x1d2b4e(0xd9)}}],'as':_0x1d2b4e(0xab)}}]);_0x28f1d4['data_sales']={},await Promise[_0x1d2b4e(0xa8)](_0x28f1d4[_0x1d2b4e(0xbf)](async _0x1c101b=>{const _0x56f653=_0x1d2b4e;_0x28f1d4['data_sales'][_0x1c101b[_0x56f653(0xb9)]]=[],await Promise['all'](_0x1c101b[_0x56f653(0xab)][_0x56f653(0xbf)](async _0xf1370a=>{const _0x4182e6=_0x56f653,_0x38f79d=await sales[_0x4182e6(0xbc)]([{'$unwind':_0x4182e6(0xd7)},{'$match':{'sale_product.id_transaction_from':_0xf1370a[_0x4182e6(0xdb)][_0x4182e6(0xbd)](),'sale_product.invoice':_0xf1370a[_0x4182e6(0xb9)]}},{'$project':{'_id':_0x4182e6(0xa6),'product_name':_0x4182e6(0xd5),'product_code':'$sale_product.product_code','quantity_available':_0x4182e6(0xe2),'warehouse_name':_0x4182e6(0xaf),'warehouse_room':'$sale_product.room_name','product_invoice':_0x4182e6(0xb4),'invoice':_0x4182e6(0xc4),'id_transaction_from':'$sale_product.id_transaction_from'}}]);_0x38f79d[_0x4182e6(0xae)]>0x0&&_0x28f1d4[_0x4182e6(0xa9)][_0x1c101b[_0x4182e6(0xb9)]][_0x4182e6(0xdc)](..._0x38f79d);}));})),_0x28f1d4['data_sales']=_0x28f1d4['data_sales'],_0x28f1d4['data_adjustment']={},await Promise[_0x1d2b4e(0xa8)](_0x28f1d4[_0x1d2b4e(0xbf)](async _0x50875e=>{const _0x909342=_0x1d2b4e;_0x28f1d4['data_adjustment'][_0x50875e[_0x909342(0xb9)]]=[],await Promise[_0x909342(0xa8)](_0x50875e[_0x909342(0xab)][_0x909342(0xbf)](async _0x204484=>{const _0x5cd518=_0x909342,_0x3f9d38=await adjustment['aggregate']([{'$unwind':_0x5cd518(0xda)},{'$match':{'product.id_transaction_from':_0x204484[_0x5cd518(0xdb)][_0x5cd518(0xbd)](),'product.invoice':_0x204484[_0x5cd518(0xb9)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x5cd518(0xcd),'product_invoice':_0x5cd518(0xb5),'invoice':_0x5cd518(0xc4),'id_transaction_from':_0x5cd518(0xca)}}]);_0x3f9d38['length']>0x0&&_0x28f1d4['data_adjustment'][_0x50875e[_0x5cd518(0xb9)]]['push'](..._0x3f9d38);}));})),_0x28f1d4['data_transfer']={},await Promise[_0x1d2b4e(0xa8)](_0x28f1d4['map'](async _0x2f5f96=>{const _0x2e72ff=_0x1d2b4e;_0x28f1d4[_0x2e72ff(0xb3)][_0x2f5f96[_0x2e72ff(0xb9)]]=[],await Promise[_0x2e72ff(0xa8)](_0x2f5f96[_0x2e72ff(0xab)][_0x2e72ff(0xbf)](async _0x12f298=>{const _0x1547b2=_0x2e72ff,_0x221480=await transfers['aggregate']([{'$unwind':_0x1547b2(0xda)},{'$match':{'product.id_transaction_id':_0x12f298[_0x1547b2(0xdb)]['valueOf'](),'product.To_invoice':_0x12f298[_0x1547b2(0xb9)]}},{'$project':{'_id':_0x1547b2(0xa5),'product_name':_0x1547b2(0xde),'product_code':_0x1547b2(0xd0),'quantity_available':_0x1547b2(0xc0),'warehouse_name':_0x1547b2(0xb6),'warehouse_room':_0x1547b2(0xcd),'product_invoice':_0x1547b2(0xd3),'invoice':_0x1547b2(0xc4),'id_transaction_id':_0x1547b2(0xbb)}}]);console['log'](_0x221480),_0x221480[_0x1547b2(0xae)]>0x0&&_0x28f1d4[_0x1547b2(0xb3)][_0x2f5f96[_0x1547b2(0xb9)]][_0x1547b2(0xdc)](..._0x221480);}));})),_0xaeeb81[_0x1d2b4e(0xc7)]({'purchases_warehouse':_0x28f1d4,'data_sales':_0x28f1d4['data_sales'],'data_adjustment':_0x28f1d4[_0x1d2b4e(0xcf)],'data_transfer':_0x28f1d4[_0x1d2b4e(0xb3)]});}),module[a0_0x62b615(0xaa)]=router;