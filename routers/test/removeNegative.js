const a0_0x408edd=a0_0x9864;(function(_0x518d9f,_0x36034e){const _0x2012b3=a0_0x9864,_0x22eab0=_0x518d9f();while(!![]){try{const _0x340a7e=parseInt(_0x2012b3(0x116))/0x1*(-parseInt(_0x2012b3(0x100))/0x2)+-parseInt(_0x2012b3(0x138))/0x3+-parseInt(_0x2012b3(0x11c))/0x4+parseInt(_0x2012b3(0x104))/0x5*(parseInt(_0x2012b3(0x13a))/0x6)+parseInt(_0x2012b3(0x114))/0x7+-parseInt(_0x2012b3(0x127))/0x8*(-parseInt(_0x2012b3(0x11e))/0x9)+parseInt(_0x2012b3(0x10c))/0xa;if(_0x340a7e===_0x36034e)break;else _0x22eab0['push'](_0x22eab0['shift']());}catch(_0x21d722){_0x22eab0['push'](_0x22eab0['shift']());}}}(a0_0x47bc,0xa63f3));const express=require(a0_0x408edd(0x12b)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x408edd(0x129));function a0_0x47bc(){const _0x26cd21=['$to_warehouse','$product.new_adjust_qty','$sale_product.id_transaction_from','$sale_product.invoice','get','8129850nNfXFd','$product_details.invoice','warehouse_data','invoice','$sale_product','$sale_product.quantity','valueOf','$sale_product._id','2834027sMDHbA','$product.product_code','957UytfBz','$warehouse_name','$product._id','modifiedCount','data_transfer','$product.to_room_name','3593056PsSqgM','$product.id_transaction_id','9MUsRjQ','_id','push','data_sales','$product.product_name','data_adjustment','table\x20page','$product.invoice','length','8159576lLKTmZ','exports','../../models/all_models','$sale_product.product_code','express','message','render','$sale_product.room_name','status','flash','$name','log','$product_details','map','warehouses','aggregate','/warehouse_monitor','331710LpqGkm','$$invoice','6tSmBZk','json','/negative','1382wekyRA','$invoice','success','all','566375GBxkcF','$product.room_names','$product'];a0_0x47bc=function(){return _0x26cd21;};return a0_0x47bc();}function a0_0x9864(_0x535aaf,_0x2a5a8c){const _0x47bc9c=a0_0x47bc();return a0_0x9864=function(_0x9864e5,_0x426ee2){_0x9864e5=_0x9864e5-0xfe;let _0x13c173=_0x47bc9c[_0x9864e5];return _0x13c173;},a0_0x9864(_0x535aaf,_0x2a5a8c);}router['get'](a0_0x408edd(0xff),async(_0x36d0c3,_0x3d29ac)=>{const _0x46bfb0=a0_0x408edd;try{const _0x6e18e4=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x3d29ac[_0x46bfb0(0xfe)]({'status':_0x6e18e4[_0x46bfb0(0x119)]+'\x20documents\x20updated'});}catch(_0x3c326b){console[_0x46bfb0(0x132)]('table\x20page',_0x3c326b),_0x3d29ac[_0x46bfb0(0x12f)](0xc8)[_0x46bfb0(0xfe)]({'message':_0x3c326b[_0x46bfb0(0x12c)]});}}),router['get']('/checking',async(_0x5b7277,_0x2f78c0)=>{const _0x123e02=a0_0x408edd;try{const _0x3ec942=await warehouse[_0x123e02(0x136)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':'INCF-52068316','product_details.primary_code':'14800005047429'}},{'$group':{'_id':{'name':_0x123e02(0x131),'room':'$room'},'products':{'$push':_0x123e02(0x133)}}}]);_0x2f78c0['json'](_0x3ec942);}catch(_0x574871){console[_0x123e02(0x132)](_0x123e02(0x124),_0x574871),_0x2f78c0['status'](0xc8)[_0x123e02(0xfe)]({'message':_0x574871[_0x123e02(0x12c)]});}}),router[a0_0x408edd(0x10b)](a0_0x408edd(0x137),async(_0x3a1a23,_0x34a0de)=>{const _0x9ecdbc=a0_0x408edd;_0x34a0de[_0x9ecdbc(0x12d)]('monitor',{'success':_0x3a1a23[_0x9ecdbc(0x130)](_0x9ecdbc(0x102)),'errors':_0x3a1a23['flash']('errors')});}),router[a0_0x408edd(0x10b)]('/join',async(_0x1d52a4,_0x20874e)=>{const _0x3dd274=a0_0x408edd;var _0x1f141b=await purchases[_0x3dd274(0x136)]([{'$lookup':{'from':_0x3dd274(0x135),'let':{'invoice':_0x3dd274(0x101)},'pipeline':[{'$unwind':_0x3dd274(0x133)},{'$match':{'$expr':{'$eq':[_0x3dd274(0x139),_0x3dd274(0x10d)]}}},{'$project':{'_id':'$product_details._id','product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':'$product_details.product_stock','warehouse_name':_0x3dd274(0x131),'warehouse_room':'$room','invoice':'$product_details.invoice'}}],'as':'warehouse_data'}}]);_0x1f141b[_0x3dd274(0x121)]={},await Promise[_0x3dd274(0x103)](_0x1f141b['map'](async _0x398bc3=>{const _0x2e2a4b=_0x3dd274;_0x1f141b[_0x2e2a4b(0x121)][_0x398bc3[_0x2e2a4b(0x10f)]]=[],await Promise['all'](_0x398bc3['warehouse_data'][_0x2e2a4b(0x134)](async _0x43bcb4=>{const _0x2942b8=_0x2e2a4b,_0x5e7c74=await sales[_0x2942b8(0x136)]([{'$unwind':_0x2942b8(0x110)},{'$match':{'sale_product.id_transaction_from':_0x43bcb4[_0x2942b8(0x11f)][_0x2942b8(0x112)](),'sale_product.invoice':_0x43bcb4[_0x2942b8(0x10f)]}},{'$project':{'_id':_0x2942b8(0x113),'product_name':'$sale_product.product_name','product_code':_0x2942b8(0x12a),'quantity_available':_0x2942b8(0x111),'warehouse_name':_0x2942b8(0x117),'warehouse_room':_0x2942b8(0x12e),'product_invoice':_0x2942b8(0x10a),'invoice':_0x2942b8(0x101),'id_transaction_from':_0x2942b8(0x109)}}]);_0x5e7c74[_0x2942b8(0x126)]>0x0&&_0x1f141b[_0x2942b8(0x121)][_0x398bc3[_0x2942b8(0x10f)]][_0x2942b8(0x120)](..._0x5e7c74);}));})),_0x1f141b[_0x3dd274(0x121)]=_0x1f141b['data_sales'],_0x1f141b[_0x3dd274(0x123)]={},await Promise[_0x3dd274(0x103)](_0x1f141b['map'](async _0x81b464=>{const _0x4f63f7=_0x3dd274;_0x1f141b[_0x4f63f7(0x123)][_0x81b464['invoice']]=[],await Promise[_0x4f63f7(0x103)](_0x81b464[_0x4f63f7(0x10e)][_0x4f63f7(0x134)](async _0x560d94=>{const _0x3f0c68=_0x4f63f7,_0x57d2bf=await adjustment['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x560d94[_0x3f0c68(0x11f)][_0x3f0c68(0x112)](),'product.invoice':_0x560d94['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x3f0c68(0x122),'product_code':'$product.product_code','quantity_available':_0x3f0c68(0x108),'warehouse_name':_0x3f0c68(0x117),'warehouse_room':_0x3f0c68(0x105),'product_invoice':_0x3f0c68(0x125),'invoice':_0x3f0c68(0x101),'id_transaction_from':'$product.id_transaction_from'}}]);_0x57d2bf[_0x3f0c68(0x126)]>0x0&&_0x1f141b[_0x3f0c68(0x123)][_0x81b464[_0x3f0c68(0x10f)]][_0x3f0c68(0x120)](..._0x57d2bf);}));})),_0x1f141b[_0x3dd274(0x11a)]={},await Promise[_0x3dd274(0x103)](_0x1f141b[_0x3dd274(0x134)](async _0x56db3c=>{const _0x4a4e9c=_0x3dd274;_0x1f141b['data_transfer'][_0x56db3c['invoice']]=[],await Promise[_0x4a4e9c(0x103)](_0x56db3c[_0x4a4e9c(0x10e)][_0x4a4e9c(0x134)](async _0x5569d0=>{const _0x4b6d75=_0x4a4e9c,_0x522d52=await transfers[_0x4b6d75(0x136)]([{'$unwind':_0x4b6d75(0x106)},{'$match':{'product.id_transaction_id':_0x5569d0[_0x4b6d75(0x11f)][_0x4b6d75(0x112)](),'product.To_invoice':_0x5569d0['invoice']}},{'$project':{'_id':_0x4b6d75(0x118),'product_name':'$product.product_name','product_code':_0x4b6d75(0x115),'quantity_available':'$product.to_quantity','warehouse_name':_0x4b6d75(0x107),'warehouse_room':'$product.room_names','product_invoice':_0x4b6d75(0x11b),'invoice':_0x4b6d75(0x101),'id_transaction_id':_0x4b6d75(0x11d)}}]);console[_0x4b6d75(0x132)](_0x522d52),_0x522d52[_0x4b6d75(0x126)]>0x0&&_0x1f141b['data_transfer'][_0x56db3c[_0x4b6d75(0x10f)]]['push'](..._0x522d52);}));})),_0x20874e[_0x3dd274(0xfe)]({'purchases_warehouse':_0x1f141b,'data_sales':_0x1f141b[_0x3dd274(0x121)],'data_adjustment':_0x1f141b[_0x3dd274(0x123)],'data_transfer':_0x1f141b['data_transfer']});}),module[a0_0x408edd(0x128)]=router;