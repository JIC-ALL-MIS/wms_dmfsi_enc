const a0_0x5267a1=a0_0x4fe6;(function(_0x24efb2,_0x145102){const _0x271d83=a0_0x4fe6,_0x40c739=_0x24efb2();while(!![]){try{const _0x18f7ec=-parseInt(_0x271d83(0x102))/0x1*(-parseInt(_0x271d83(0x11a))/0x2)+parseInt(_0x271d83(0x113))/0x3+-parseInt(_0x271d83(0x10b))/0x4+parseInt(_0x271d83(0x112))/0x5*(parseInt(_0x271d83(0x109))/0x6)+parseInt(_0x271d83(0xf7))/0x7*(parseInt(_0x271d83(0x114))/0x8)+parseInt(_0x271d83(0x117))/0x9*(parseInt(_0x271d83(0x130))/0xa)+parseInt(_0x271d83(0x128))/0xb*(-parseInt(_0x271d83(0x122))/0xc);if(_0x18f7ec===_0x145102)break;else _0x40c739['push'](_0x40c739['shift']());}catch(_0x20ccb3){_0x40c739['push'](_0x40c739['shift']());}}}(a0_0x6925,0x7ee4b));function a0_0x4fe6(_0x26437a,_0x23efdb){const _0x69252=a0_0x6925();return a0_0x4fe6=function(_0x4fe6da,_0x1d03f5){_0x4fe6da=_0x4fe6da-0xef;let _0x4b698e=_0x69252[_0x4fe6da];return _0x4b698e;},a0_0x4fe6(_0x26437a,_0x23efdb);}const express=require(a0_0x5267a1(0xf9)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x5267a1(0x107));router[a0_0x5267a1(0x10d)]('/negative',async(_0x5922b2,_0x263d88)=>{const _0x51e72c=a0_0x5267a1;try{const _0x571b2a=await warehouse[_0x51e72c(0xef)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x263d88['json']({'status':_0x571b2a[_0x51e72c(0x12d)]+'\x20documents\x20updated'});}catch(_0x2acd26){console[_0x51e72c(0x12e)](_0x51e72c(0x105),_0x2acd26),_0x263d88[_0x51e72c(0xf5)](0xc8)['json']({'message':_0x2acd26[_0x51e72c(0x11c)]});}}),router['get'](a0_0x5267a1(0xf6),async(_0x2d83a4,_0x34a8de)=>{const _0x1eaebf=a0_0x5267a1;try{const _0x58801b=await warehouse[_0x1eaebf(0x120)]([{'$unwind':_0x1eaebf(0xf1)},{'$match':{'product_details.invoice':_0x1eaebf(0x110),'product_details.primary_code':_0x1eaebf(0x11b)}},{'$group':{'_id':{'name':'$name','room':_0x1eaebf(0x127)},'products':{'$push':_0x1eaebf(0xf1)}}}]);_0x34a8de['json'](_0x58801b);}catch(_0x2ef0d2){console[_0x1eaebf(0x12e)]('table\x20page',_0x2ef0d2),_0x34a8de[_0x1eaebf(0xf5)](0xc8)[_0x1eaebf(0x11e)]({'message':_0x2ef0d2[_0x1eaebf(0x11c)]});}}),router[a0_0x5267a1(0x10d)](a0_0x5267a1(0x121),async(_0x1ebd1a,_0x4d4c80)=>{const _0x2114a8=a0_0x5267a1;_0x4d4c80[_0x2114a8(0x115)]('monitor',{'success':_0x1ebd1a['flash']('success'),'errors':_0x1ebd1a[_0x2114a8(0x104)](_0x2114a8(0xfa))});}),router[a0_0x5267a1(0x10d)](a0_0x5267a1(0xff),async(_0x5de2ce,_0x34eee3)=>{const _0x11d796=a0_0x5267a1;var _0x3a2200=await purchases[_0x11d796(0x120)]([{'$lookup':{'from':'warehouses','let':{'invoice':_0x11d796(0x125)},'pipeline':[{'$unwind':_0x11d796(0xf1)},{'$match':{'$expr':{'$eq':['$$invoice',_0x11d796(0x10f)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x11d796(0x100),'product_code':_0x11d796(0x131),'quantity_available':_0x11d796(0xf3),'warehouse_name':_0x11d796(0x108),'warehouse_room':_0x11d796(0x127),'invoice':_0x11d796(0x10f)}}],'as':_0x11d796(0x10c)}}]);_0x3a2200[_0x11d796(0xfb)]={},await Promise[_0x11d796(0x12f)](_0x3a2200[_0x11d796(0x118)](async _0x10baa7=>{const _0x503ed8=_0x11d796;_0x3a2200['data_sales'][_0x10baa7[_0x503ed8(0xfe)]]=[],await Promise[_0x503ed8(0x12f)](_0x10baa7[_0x503ed8(0x10c)][_0x503ed8(0x118)](async _0x36ec49=>{const _0x5110b7=_0x503ed8,_0x2d50ba=await sales['aggregate']([{'$unwind':_0x5110b7(0x119)},{'$match':{'sale_product.id_transaction_from':_0x36ec49[_0x5110b7(0x129)][_0x5110b7(0xfc)](),'sale_product.invoice':_0x36ec49['invoice']}},{'$project':{'_id':'$sale_product._id','product_name':_0x5110b7(0x10a),'product_code':_0x5110b7(0x123),'quantity_available':_0x5110b7(0x106),'warehouse_name':_0x5110b7(0x12a),'warehouse_room':'$sale_product.room_name','product_invoice':_0x5110b7(0x124),'invoice':_0x5110b7(0x125),'id_transaction_from':_0x5110b7(0x126)}}]);_0x2d50ba[_0x5110b7(0x116)]>0x0&&_0x3a2200[_0x5110b7(0xfb)][_0x10baa7[_0x5110b7(0xfe)]][_0x5110b7(0x11d)](..._0x2d50ba);}));})),_0x3a2200[_0x11d796(0xfb)]=_0x3a2200[_0x11d796(0xfb)],_0x3a2200['data_adjustment']={},await Promise['all'](_0x3a2200[_0x11d796(0x118)](async _0x156688=>{const _0x3d7e30=_0x11d796;_0x3a2200[_0x3d7e30(0x11f)][_0x156688['invoice']]=[],await Promise['all'](_0x156688[_0x3d7e30(0x10c)][_0x3d7e30(0x118)](async _0x5dd9e5=>{const _0x18d2ec=_0x3d7e30,_0x1db044=await adjustment[_0x18d2ec(0x120)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x5dd9e5[_0x18d2ec(0x129)][_0x18d2ec(0xfc)](),'product.invoice':_0x5dd9e5[_0x18d2ec(0xfe)]}},{'$project':{'_id':_0x18d2ec(0x111),'product_name':'$product.product_name','product_code':_0x18d2ec(0x12c),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x18d2ec(0x12a),'warehouse_room':_0x18d2ec(0x12b),'product_invoice':'$product.invoice','invoice':_0x18d2ec(0x125),'id_transaction_from':'$product.id_transaction_from'}}]);_0x1db044[_0x18d2ec(0x116)]>0x0&&_0x3a2200[_0x18d2ec(0x11f)][_0x156688[_0x18d2ec(0xfe)]][_0x18d2ec(0x11d)](..._0x1db044);}));})),_0x3a2200[_0x11d796(0xf2)]={},await Promise[_0x11d796(0x12f)](_0x3a2200[_0x11d796(0x118)](async _0x4e1a90=>{const _0x51389f=_0x11d796;_0x3a2200[_0x51389f(0xf2)][_0x4e1a90[_0x51389f(0xfe)]]=[],await Promise['all'](_0x4e1a90[_0x51389f(0x10c)][_0x51389f(0x118)](async _0x2d86c0=>{const _0x6b8c15=_0x51389f,_0x57d100=await transfers[_0x6b8c15(0x120)]([{'$unwind':_0x6b8c15(0x103)},{'$match':{'product.id_transaction_id':_0x2d86c0['_id'][_0x6b8c15(0xfc)](),'product.To_invoice':_0x2d86c0[_0x6b8c15(0xfe)]}},{'$project':{'_id':_0x6b8c15(0x111),'product_name':_0x6b8c15(0xf4),'product_code':_0x6b8c15(0x12c),'quantity_available':_0x6b8c15(0x10e),'warehouse_name':_0x6b8c15(0x101),'warehouse_room':'$product.room_names','product_invoice':_0x6b8c15(0xf8),'invoice':_0x6b8c15(0x125),'id_transaction_id':_0x6b8c15(0xf0)}}]);console['log'](_0x57d100),_0x57d100['length']>0x0&&_0x3a2200[_0x6b8c15(0xf2)][_0x4e1a90['invoice']][_0x6b8c15(0x11d)](..._0x57d100);}));})),_0x34eee3[_0x11d796(0x11e)]({'purchases_warehouse':_0x3a2200,'data_sales':_0x3a2200[_0x11d796(0xfb)],'data_adjustment':_0x3a2200[_0x11d796(0x11f)],'data_transfer':_0x3a2200[_0x11d796(0xf2)]});}),module[a0_0x5267a1(0xfd)]=router;function a0_0x6925(){const _0x4b0ebf=['$product.product_name','status','/checking','476DEyDFx','$product.to_room_name','express','errors','data_sales','valueOf','exports','invoice','/join','$product_details.product_name','$to_warehouse','2967HADDpX','$product','flash','table\x20page','$sale_product.quantity','../../models/all_models','$name','105738CluvSD','$sale_product.product_name','203516fcwTbS','warehouse_data','get','$product.to_quantity','$product_details.invoice','INCF-52068316','$product._id','145MijbjP','2530257TDAZSO','1160jTfVFB','render','length','423pfJzgD','map','$sale_product','290uBcYFq','14800005047429','message','push','json','data_adjustment','aggregate','/warehouse_monitor','444HdPhMw','$sale_product.product_code','$sale_product.invoice','$invoice','$sale_product.id_transaction_from','$room','666930gDeDaX','_id','$warehouse_name','$product.room_names','$product.product_code','modifiedCount','log','all','216890DYUqrX','$product_details.product_code','updateMany','$product.id_transaction_id','$product_details','data_transfer','$product_details.product_stock'];a0_0x6925=function(){return _0x4b0ebf;};return a0_0x6925();}