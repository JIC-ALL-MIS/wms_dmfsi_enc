const a0_0x4e0ace=a0_0x2b8e;(function(_0x392fc5,_0x551a20){const _0x2e01a5=a0_0x2b8e,_0x15365b=_0x392fc5();while(!![]){try{const _0x158893=-parseInt(_0x2e01a5(0x170))/0x1*(parseInt(_0x2e01a5(0x171))/0x2)+parseInt(_0x2e01a5(0x162))/0x3*(parseInt(_0x2e01a5(0x17d))/0x4)+parseInt(_0x2e01a5(0x186))/0x5*(parseInt(_0x2e01a5(0x196))/0x6)+parseInt(_0x2e01a5(0x161))/0x7*(-parseInt(_0x2e01a5(0x191))/0x8)+-parseInt(_0x2e01a5(0x175))/0x9+parseInt(_0x2e01a5(0x177))/0xa*(-parseInt(_0x2e01a5(0x198))/0xb)+parseInt(_0x2e01a5(0x166))/0xc;if(_0x158893===_0x551a20)break;else _0x15365b['push'](_0x15365b['shift']());}catch(_0x27db20){_0x15365b['push'](_0x15365b['shift']());}}}(a0_0x499d,0x651db));const express=require(a0_0x4e0ace(0x19b)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x4e0ace(0x1a1));function a0_0x2b8e(_0x32fa6b,_0x588e2d){const _0x499d9a=a0_0x499d();return a0_0x2b8e=function(_0x2b8ee8,_0x25ba04){_0x2b8ee8=_0x2b8ee8-0x15e;let _0x22d541=_0x499d9a[_0x2b8ee8];return _0x22d541;},a0_0x2b8e(_0x32fa6b,_0x588e2d);}function a0_0x499d(){const _0x2ad4be=['265221lOYEVl','/join','map','json','12640008SWwlCP','$product_details.product_stock','invoice','$product.to_quantity','$name','$product','monitor','$sale_product.id_transaction_from','$product_details','get','59vqcpEL','796aNtNOM','table\x20page','$product_details.product_code','updateMany','4235481ljGKdc','aggregate','580490VUxliu','length','$sale_product.quantity','flash','$room','$to_warehouse','24mQiJSh','$sale_product.product_name','$invoice','INCF-52068316','$product.product_name','$product_details.invoice','$product_details.product_name','$product.id_transaction_from','$$invoice','1725aGfyBI','$product._id','$warehouse_name','valueOf','/negative','$product.new_adjust_qty','push','exports','$product_details._id','warehouse_data','all','32ptrvcA','warehouses','data_adjustment','render','log','3096ZbsZgV','14800005047429','66ltFhCa','message','success','express','$product.to_room_name','_id','data_sales','status','$product.product_code','../../models/all_models','data_transfer','/checking','$product.room_names','884170ytSQmE'];a0_0x499d=function(){return _0x2ad4be;};return a0_0x499d();}router[a0_0x4e0ace(0x16f)](a0_0x4e0ace(0x18a),async(_0x7c849f,_0x3290a4)=>{const _0x129d46=a0_0x4e0ace;try{const _0x45ae04=await warehouse[_0x129d46(0x174)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x3290a4['json']({'status':_0x45ae04['modifiedCount']+'\x20documents\x20updated'});}catch(_0x9017fd){console[_0x129d46(0x195)](_0x129d46(0x172),_0x9017fd),_0x3290a4['status'](0xc8)[_0x129d46(0x165)]({'message':_0x9017fd[_0x129d46(0x199)]});}}),router[a0_0x4e0ace(0x16f)](a0_0x4e0ace(0x15f),async(_0x3e4b51,_0x591055)=>{const _0x32ca16=a0_0x4e0ace;try{const _0x5a24e4=await warehouse[_0x32ca16(0x176)]([{'$unwind':_0x32ca16(0x16e)},{'$match':{'product_details.invoice':_0x32ca16(0x180),'product_details.primary_code':_0x32ca16(0x197)}},{'$group':{'_id':{'name':_0x32ca16(0x16a),'room':'$room'},'products':{'$push':_0x32ca16(0x16e)}}}]);_0x591055['json'](_0x5a24e4);}catch(_0x12e26){console['log'](_0x32ca16(0x172),_0x12e26),_0x591055[_0x32ca16(0x19f)](0xc8)[_0x32ca16(0x165)]({'message':_0x12e26[_0x32ca16(0x199)]});}}),router[a0_0x4e0ace(0x16f)]('/warehouse_monitor',async(_0x96b92a,_0x2df2f4)=>{const _0x2a7ba0=a0_0x4e0ace;_0x2df2f4[_0x2a7ba0(0x194)](_0x2a7ba0(0x16c),{'success':_0x96b92a['flash'](_0x2a7ba0(0x19a)),'errors':_0x96b92a[_0x2a7ba0(0x17a)]('errors')});}),router['get'](a0_0x4e0ace(0x163),async(_0x279231,_0xff2227)=>{const _0x2e1b68=a0_0x4e0ace;var _0x4091f2=await purchases[_0x2e1b68(0x176)]([{'$lookup':{'from':_0x2e1b68(0x192),'let':{'invoice':_0x2e1b68(0x17f)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x2e1b68(0x185),_0x2e1b68(0x182)]}}},{'$project':{'_id':_0x2e1b68(0x18e),'product_name':_0x2e1b68(0x183),'product_code':_0x2e1b68(0x173),'quantity_available':_0x2e1b68(0x167),'warehouse_name':_0x2e1b68(0x16a),'warehouse_room':_0x2e1b68(0x17b),'invoice':'$product_details.invoice'}}],'as':_0x2e1b68(0x18f)}}]);_0x4091f2[_0x2e1b68(0x19e)]={},await Promise[_0x2e1b68(0x190)](_0x4091f2[_0x2e1b68(0x164)](async _0x2bd6e5=>{const _0x52af5d=_0x2e1b68;_0x4091f2[_0x52af5d(0x19e)][_0x2bd6e5[_0x52af5d(0x168)]]=[],await Promise[_0x52af5d(0x190)](_0x2bd6e5['warehouse_data'][_0x52af5d(0x164)](async _0x5536e0=>{const _0x2332ed=_0x52af5d,_0x3cf1c0=await sales[_0x2332ed(0x176)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x5536e0[_0x2332ed(0x19d)][_0x2332ed(0x189)](),'sale_product.invoice':_0x5536e0[_0x2332ed(0x168)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x2332ed(0x17e),'product_code':'$sale_product.product_code','quantity_available':_0x2332ed(0x179),'warehouse_name':'$warehouse_name','warehouse_room':'$sale_product.room_name','product_invoice':'$sale_product.invoice','invoice':_0x2332ed(0x17f),'id_transaction_from':_0x2332ed(0x16d)}}]);_0x3cf1c0[_0x2332ed(0x178)]>0x0&&_0x4091f2[_0x2332ed(0x19e)][_0x2bd6e5[_0x2332ed(0x168)]]['push'](..._0x3cf1c0);}));})),_0x4091f2[_0x2e1b68(0x19e)]=_0x4091f2[_0x2e1b68(0x19e)],_0x4091f2[_0x2e1b68(0x193)]={},await Promise[_0x2e1b68(0x190)](_0x4091f2[_0x2e1b68(0x164)](async _0x2e0a39=>{const _0x3b996d=_0x2e1b68;_0x4091f2[_0x3b996d(0x193)][_0x2e0a39[_0x3b996d(0x168)]]=[],await Promise[_0x3b996d(0x190)](_0x2e0a39['warehouse_data'][_0x3b996d(0x164)](async _0x22628e=>{const _0x446b30=_0x3b996d,_0x3aee6b=await adjustment[_0x446b30(0x176)]([{'$unwind':_0x446b30(0x16b)},{'$match':{'product.id_transaction_from':_0x22628e[_0x446b30(0x19d)][_0x446b30(0x189)](),'product.invoice':_0x22628e[_0x446b30(0x168)]}},{'$project':{'_id':_0x446b30(0x187),'product_name':_0x446b30(0x181),'product_code':_0x446b30(0x1a0),'quantity_available':_0x446b30(0x18b),'warehouse_name':_0x446b30(0x188),'warehouse_room':'$product.room_names','product_invoice':'$product.invoice','invoice':_0x446b30(0x17f),'id_transaction_from':_0x446b30(0x184)}}]);_0x3aee6b[_0x446b30(0x178)]>0x0&&_0x4091f2[_0x446b30(0x193)][_0x2e0a39['invoice']]['push'](..._0x3aee6b);}));})),_0x4091f2[_0x2e1b68(0x15e)]={},await Promise[_0x2e1b68(0x190)](_0x4091f2[_0x2e1b68(0x164)](async _0x117bd1=>{const _0x5a6072=_0x2e1b68;_0x4091f2[_0x5a6072(0x15e)][_0x117bd1[_0x5a6072(0x168)]]=[],await Promise['all'](_0x117bd1['warehouse_data'][_0x5a6072(0x164)](async _0x2b01ff=>{const _0x9125d4=_0x5a6072,_0x205c5e=await transfers[_0x9125d4(0x176)]([{'$unwind':_0x9125d4(0x16b)},{'$match':{'product.id_transaction_id':_0x2b01ff[_0x9125d4(0x19d)][_0x9125d4(0x189)](),'product.To_invoice':_0x2b01ff[_0x9125d4(0x168)]}},{'$project':{'_id':_0x9125d4(0x187),'product_name':_0x9125d4(0x181),'product_code':_0x9125d4(0x1a0),'quantity_available':_0x9125d4(0x169),'warehouse_name':_0x9125d4(0x17c),'warehouse_room':_0x9125d4(0x160),'product_invoice':_0x9125d4(0x19c),'invoice':_0x9125d4(0x17f),'id_transaction_id':'$product.id_transaction_id'}}]);console['log'](_0x205c5e),_0x205c5e['length']>0x0&&_0x4091f2[_0x9125d4(0x15e)][_0x117bd1[_0x9125d4(0x168)]][_0x9125d4(0x18c)](..._0x205c5e);}));})),_0xff2227[_0x2e1b68(0x165)]({'purchases_warehouse':_0x4091f2,'data_sales':_0x4091f2[_0x2e1b68(0x19e)],'data_adjustment':_0x4091f2[_0x2e1b68(0x193)],'data_transfer':_0x4091f2[_0x2e1b68(0x15e)]});}),module[a0_0x4e0ace(0x18d)]=router;