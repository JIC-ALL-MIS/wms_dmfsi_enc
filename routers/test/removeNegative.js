const a0_0x53bbad=a0_0x5c86;function a0_0x3055(){const _0x2081e5=['142839hdQgqG','updateMany','$sale_product._id','flash','$$invoice','monitor','data_transfer','data_sales','$product_details','3319239xGsTBv','1GPyGci','aggregate','1011206zSRRBw','$product_details.invoice','_id','2008465NyrEZX','success','data_adjustment','$to_warehouse','json','warehouse_data','$product.invoice','14800005047429','$name','$product.id_transaction_from','$sale_product.id_transaction_from','express','$product_details.product_name','$product.product_name','45850eTDaQv','$room','Router','$product.to_room_name','456agOpDr','$product.product_code','map','/checking','$product.room_names','get','modifiedCount','warehouses','../../models/all_models','30dpxwJo','all','$product.new_adjust_qty','$product._id','8UVjOMu','5405960jQMVum','valueOf','$sale_product.product_code','$product_details.product_code','$product.id_transaction_id','$sale_product.quantity','$invoice','table\x20page','length','message','$product','$warehouse_name','render','invoice','log','/negative','905982QGZFEg','push'];a0_0x3055=function(){return _0x2081e5;};return a0_0x3055();}(function(_0x2bc5cd,_0x5b0be5){const _0x1928fc=a0_0x5c86,_0x38ee9c=_0x2bc5cd();while(!![]){try{const _0xca2f5=-parseInt(_0x1928fc(0x1c1))/0x1*(parseInt(_0x1928fc(0x1c3))/0x2)+parseInt(_0x1928fc(0x1b5))/0x3+-parseInt(_0x1928fc(0x1a4))/0x4*(-parseInt(_0x1928fc(0x1c6))/0x5)+-parseInt(_0x1928fc(0x1a0))/0x6*(-parseInt(_0x1928fc(0x193))/0x7)+-parseInt(_0x1928fc(0x197))/0x8*(parseInt(_0x1928fc(0x1b7))/0x9)+parseInt(_0x1928fc(0x1a5))/0xa+parseInt(_0x1928fc(0x1c0))/0xb;if(_0xca2f5===_0x5b0be5)break;else _0x38ee9c['push'](_0x38ee9c['shift']());}catch(_0x3400e3){_0x38ee9c['push'](_0x38ee9c['shift']());}}}(a0_0x3055,0x8b371));const express=require(a0_0x53bbad(0x190)),app=express(),router=express[a0_0x53bbad(0x195)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x53bbad(0x19f));function a0_0x5c86(_0x235946,_0x5f286){const _0x305527=a0_0x3055();return a0_0x5c86=function(_0x5c867a,_0x24906f){_0x5c867a=_0x5c867a-0x18f;let _0x57f428=_0x305527[_0x5c867a];return _0x57f428;},a0_0x5c86(_0x235946,_0x5f286);}router['get'](a0_0x53bbad(0x1b4),async(_0x31e1a0,_0x491ddd)=>{const _0xfc7e6f=a0_0x53bbad;try{const _0x157b07=await warehouse[_0xfc7e6f(0x1b8)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x491ddd['json']({'status':_0x157b07[_0xfc7e6f(0x19d)]+'\x20documents\x20updated'});}catch(_0x494e78){console[_0xfc7e6f(0x1b3)](_0xfc7e6f(0x1ac),_0x494e78),_0x491ddd['status'](0xc8)['json']({'message':_0x494e78['message']});}}),router[a0_0x53bbad(0x19c)](a0_0x53bbad(0x19a),async(_0x2512e4,_0x1371e3)=>{const _0x146bc5=a0_0x53bbad;try{const _0x3a6ab8=await warehouse[_0x146bc5(0x1c2)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':'INCF-52068316','product_details.primary_code':_0x146bc5(0x1cd)}},{'$group':{'_id':{'name':_0x146bc5(0x1ce),'room':_0x146bc5(0x194)},'products':{'$push':_0x146bc5(0x1bf)}}}]);_0x1371e3[_0x146bc5(0x1ca)](_0x3a6ab8);}catch(_0x507ef1){console[_0x146bc5(0x1b3)](_0x146bc5(0x1ac),_0x507ef1),_0x1371e3['status'](0xc8)[_0x146bc5(0x1ca)]({'message':_0x507ef1[_0x146bc5(0x1ae)]});}}),router[a0_0x53bbad(0x19c)]('/warehouse_monitor',async(_0x371777,_0x4274ab)=>{const _0x4872c5=a0_0x53bbad;_0x4274ab[_0x4872c5(0x1b1)](_0x4872c5(0x1bc),{'success':_0x371777[_0x4872c5(0x1ba)](_0x4872c5(0x1c7)),'errors':_0x371777[_0x4872c5(0x1ba)]('errors')});}),router[a0_0x53bbad(0x19c)]('/join',async(_0x26defa,_0x4478c3)=>{const _0x19b583=a0_0x53bbad;var _0x4b05af=await purchases[_0x19b583(0x1c2)]([{'$lookup':{'from':_0x19b583(0x19e),'let':{'invoice':_0x19b583(0x1ab)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x19b583(0x1bb),_0x19b583(0x1c4)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x19b583(0x191),'product_code':_0x19b583(0x1a8),'quantity_available':'$product_details.product_stock','warehouse_name':_0x19b583(0x1ce),'warehouse_room':_0x19b583(0x194),'invoice':'$product_details.invoice'}}],'as':_0x19b583(0x1cb)}}]);_0x4b05af[_0x19b583(0x1be)]={},await Promise[_0x19b583(0x1a1)](_0x4b05af[_0x19b583(0x199)](async _0x3720f9=>{const _0x59f63f=_0x19b583;_0x4b05af[_0x59f63f(0x1be)][_0x3720f9[_0x59f63f(0x1b2)]]=[],await Promise[_0x59f63f(0x1a1)](_0x3720f9[_0x59f63f(0x1cb)][_0x59f63f(0x199)](async _0x10e877=>{const _0x55e19d=_0x59f63f,_0x23bce7=await sales['aggregate']([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x10e877[_0x55e19d(0x1c5)][_0x55e19d(0x1a6)](),'sale_product.invoice':_0x10e877[_0x55e19d(0x1b2)]}},{'$project':{'_id':_0x55e19d(0x1b9),'product_name':'$sale_product.product_name','product_code':_0x55e19d(0x1a7),'quantity_available':_0x55e19d(0x1aa),'warehouse_name':'$warehouse_name','warehouse_room':'$sale_product.room_name','product_invoice':'$sale_product.invoice','invoice':_0x55e19d(0x1ab),'id_transaction_from':_0x55e19d(0x18f)}}]);_0x23bce7[_0x55e19d(0x1ad)]>0x0&&_0x4b05af['data_sales'][_0x3720f9[_0x55e19d(0x1b2)]][_0x55e19d(0x1b6)](..._0x23bce7);}));})),_0x4b05af[_0x19b583(0x1be)]=_0x4b05af[_0x19b583(0x1be)],_0x4b05af[_0x19b583(0x1c8)]={},await Promise['all'](_0x4b05af[_0x19b583(0x199)](async _0x339755=>{const _0x28b660=_0x19b583;_0x4b05af[_0x28b660(0x1c8)][_0x339755['invoice']]=[],await Promise[_0x28b660(0x1a1)](_0x339755[_0x28b660(0x1cb)][_0x28b660(0x199)](async _0x15643f=>{const _0x107015=_0x28b660,_0x5ef3da=await adjustment['aggregate']([{'$unwind':_0x107015(0x1af)},{'$match':{'product.id_transaction_from':_0x15643f['_id'][_0x107015(0x1a6)](),'product.invoice':_0x15643f[_0x107015(0x1b2)]}},{'$project':{'_id':_0x107015(0x1a3),'product_name':'$product.product_name','product_code':_0x107015(0x198),'quantity_available':_0x107015(0x1a2),'warehouse_name':_0x107015(0x1b0),'warehouse_room':_0x107015(0x19b),'product_invoice':_0x107015(0x1cc),'invoice':_0x107015(0x1ab),'id_transaction_from':_0x107015(0x1cf)}}]);_0x5ef3da[_0x107015(0x1ad)]>0x0&&_0x4b05af['data_adjustment'][_0x339755['invoice']]['push'](..._0x5ef3da);}));})),_0x4b05af[_0x19b583(0x1bd)]={},await Promise['all'](_0x4b05af['map'](async _0x1b9be4=>{const _0xd4cde1=_0x19b583;_0x4b05af['data_transfer'][_0x1b9be4[_0xd4cde1(0x1b2)]]=[],await Promise['all'](_0x1b9be4[_0xd4cde1(0x1cb)][_0xd4cde1(0x199)](async _0x116f53=>{const _0x2caf88=_0xd4cde1,_0x541254=await transfers[_0x2caf88(0x1c2)]([{'$unwind':_0x2caf88(0x1af)},{'$match':{'product.id_transaction_id':_0x116f53['_id'][_0x2caf88(0x1a6)](),'product.To_invoice':_0x116f53[_0x2caf88(0x1b2)]}},{'$project':{'_id':_0x2caf88(0x1a3),'product_name':_0x2caf88(0x192),'product_code':_0x2caf88(0x198),'quantity_available':'$product.to_quantity','warehouse_name':_0x2caf88(0x1c9),'warehouse_room':'$product.room_names','product_invoice':_0x2caf88(0x196),'invoice':_0x2caf88(0x1ab),'id_transaction_id':_0x2caf88(0x1a9)}}]);console[_0x2caf88(0x1b3)](_0x541254),_0x541254[_0x2caf88(0x1ad)]>0x0&&_0x4b05af[_0x2caf88(0x1bd)][_0x1b9be4['invoice']][_0x2caf88(0x1b6)](..._0x541254);}));})),_0x4478c3[_0x19b583(0x1ca)]({'purchases_warehouse':_0x4b05af,'data_sales':_0x4b05af[_0x19b583(0x1be)],'data_adjustment':_0x4b05af[_0x19b583(0x1c8)],'data_transfer':_0x4b05af[_0x19b583(0x1bd)]});}),module['exports']=router;