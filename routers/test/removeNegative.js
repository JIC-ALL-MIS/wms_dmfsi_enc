const a0_0x44a590=a0_0x1e08;function a0_0x1e08(_0x4ce212,_0x50c07b){const _0x3f0a87=a0_0x3f0a();return a0_0x1e08=function(_0x1e08dd,_0x302480){_0x1e08dd=_0x1e08dd-0x15f;let _0x7c0dc6=_0x3f0a87[_0x1e08dd];return _0x7c0dc6;},a0_0x1e08(_0x4ce212,_0x50c07b);}(function(_0x274ea8,_0x2f9c2a){const _0x1e73fe=a0_0x1e08,_0x4e13f2=_0x274ea8();while(!![]){try{const _0x5a56df=-parseInt(_0x1e73fe(0x18e))/0x1+-parseInt(_0x1e73fe(0x18a))/0x2*(-parseInt(_0x1e73fe(0x178))/0x3)+parseInt(_0x1e73fe(0x17d))/0x4+parseInt(_0x1e73fe(0x164))/0x5*(-parseInt(_0x1e73fe(0x199))/0x6)+parseInt(_0x1e73fe(0x180))/0x7*(-parseInt(_0x1e73fe(0x191))/0x8)+-parseInt(_0x1e73fe(0x19b))/0x9*(-parseInt(_0x1e73fe(0x161))/0xa)+-parseInt(_0x1e73fe(0x192))/0xb;if(_0x5a56df===_0x2f9c2a)break;else _0x4e13f2['push'](_0x4e13f2['shift']());}catch(_0x1084ab){_0x4e13f2['push'](_0x4e13f2['shift']());}}}(a0_0x3f0a,0xbc050));const express=require(a0_0x44a590(0x177)),app=express(),router=express[a0_0x44a590(0x187)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x44a590(0x19e));router['get'](a0_0x44a590(0x1a2),async(_0x305a5a,_0x55f2c0)=>{const _0x414e7f=a0_0x44a590;try{const _0x50ce62=await warehouse[_0x414e7f(0x17b)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x55f2c0[_0x414e7f(0x17c)]({'status':_0x50ce62['modifiedCount']+_0x414e7f(0x19f)});}catch(_0x1fb4f9){console[_0x414e7f(0x194)](_0x414e7f(0x19c),_0x1fb4f9),_0x55f2c0[_0x414e7f(0x162)](0xc8)[_0x414e7f(0x17c)]({'message':_0x1fb4f9[_0x414e7f(0x167)]});}}),router[a0_0x44a590(0x16e)](a0_0x44a590(0x18d),async(_0x467801,_0x16813b)=>{const _0x1d8b70=a0_0x44a590;try{const _0xe083f5=await warehouse['aggregate']([{'$unwind':_0x1d8b70(0x15f)},{'$match':{'product_details.invoice':'INCF-52068316','product_details.primary_code':_0x1d8b70(0x16b)}},{'$group':{'_id':{'name':_0x1d8b70(0x17a),'room':_0x1d8b70(0x181)},'products':{'$push':_0x1d8b70(0x15f)}}}]);_0x16813b['json'](_0xe083f5);}catch(_0x87faa1){console[_0x1d8b70(0x194)](_0x1d8b70(0x19c),_0x87faa1),_0x16813b['status'](0xc8)[_0x1d8b70(0x17c)]({'message':_0x87faa1[_0x1d8b70(0x167)]});}}),router['get'](a0_0x44a590(0x182),async(_0x14cf45,_0x3288ef)=>{const _0x5bc31a=a0_0x44a590;_0x3288ef[_0x5bc31a(0x189)](_0x5bc31a(0x171),{'success':_0x14cf45[_0x5bc31a(0x18c)]('success'),'errors':_0x14cf45[_0x5bc31a(0x18c)]('errors')});}),router[a0_0x44a590(0x16e)](a0_0x44a590(0x179),async(_0x31c8b3,_0x2a2a70)=>{const _0x2cd66a=a0_0x44a590;var _0x240da7=await purchases[_0x2cd66a(0x196)]([{'$lookup':{'from':'warehouses','let':{'invoice':_0x2cd66a(0x175)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x2cd66a(0x173),_0x2cd66a(0x170)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x2cd66a(0x18b),'product_code':_0x2cd66a(0x195),'quantity_available':_0x2cd66a(0x193),'warehouse_name':'$name','warehouse_room':_0x2cd66a(0x181),'invoice':'$product_details.invoice'}}],'as':'warehouse_data'}}]);_0x240da7[_0x2cd66a(0x188)]={},await Promise[_0x2cd66a(0x166)](_0x240da7[_0x2cd66a(0x184)](async _0x598016=>{const _0x136281=_0x2cd66a;_0x240da7[_0x136281(0x188)][_0x598016[_0x136281(0x172)]]=[],await Promise[_0x136281(0x166)](_0x598016[_0x136281(0x16c)][_0x136281(0x184)](async _0x520530=>{const _0x322352=_0x136281,_0x577f3e=await sales[_0x322352(0x196)]([{'$unwind':_0x322352(0x16f)},{'$match':{'sale_product.id_transaction_from':_0x520530[_0x322352(0x19a)][_0x322352(0x165)](),'sale_product.invoice':_0x520530[_0x322352(0x172)]}},{'$project':{'_id':_0x322352(0x174),'product_name':_0x322352(0x18f),'product_code':_0x322352(0x19d),'quantity_available':'$sale_product.quantity','warehouse_name':_0x322352(0x197),'warehouse_room':_0x322352(0x190),'product_invoice':'$sale_product.invoice','invoice':_0x322352(0x175),'id_transaction_from':_0x322352(0x169)}}]);_0x577f3e[_0x322352(0x185)]>0x0&&_0x240da7[_0x322352(0x188)][_0x598016['invoice']][_0x322352(0x16a)](..._0x577f3e);}));})),_0x240da7[_0x2cd66a(0x188)]=_0x240da7['data_sales'],_0x240da7[_0x2cd66a(0x16d)]={},await Promise[_0x2cd66a(0x166)](_0x240da7[_0x2cd66a(0x184)](async _0x1f136a=>{const _0xf65751=_0x2cd66a;_0x240da7[_0xf65751(0x16d)][_0x1f136a['invoice']]=[],await Promise[_0xf65751(0x166)](_0x1f136a['warehouse_data'][_0xf65751(0x184)](async _0xd54080=>{const _0x3733b6=_0xf65751,_0x438cd9=await adjustment['aggregate']([{'$unwind':_0x3733b6(0x186)},{'$match':{'product.id_transaction_from':_0xd54080[_0x3733b6(0x19a)]['valueOf'](),'product.invoice':_0xd54080[_0x3733b6(0x172)]}},{'$project':{'_id':_0x3733b6(0x183),'product_name':'$product.product_name','product_code':_0x3733b6(0x17e),'quantity_available':_0x3733b6(0x198),'warehouse_name':_0x3733b6(0x197),'warehouse_room':_0x3733b6(0x17f),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':'$product.id_transaction_from'}}]);_0x438cd9[_0x3733b6(0x185)]>0x0&&_0x240da7[_0x3733b6(0x16d)][_0x1f136a[_0x3733b6(0x172)]][_0x3733b6(0x16a)](..._0x438cd9);}));})),_0x240da7['data_transfer']={},await Promise[_0x2cd66a(0x166)](_0x240da7['map'](async _0x28cce1=>{const _0x342453=_0x2cd66a;_0x240da7[_0x342453(0x160)][_0x28cce1['invoice']]=[],await Promise[_0x342453(0x166)](_0x28cce1[_0x342453(0x16c)]['map'](async _0x3e932d=>{const _0x2051ab=_0x342453,_0x227cc4=await transfers['aggregate']([{'$unwind':_0x2051ab(0x186)},{'$match':{'product.id_transaction_id':_0x3e932d[_0x2051ab(0x19a)]['valueOf'](),'product.To_invoice':_0x3e932d[_0x2051ab(0x172)]}},{'$project':{'_id':_0x2051ab(0x183),'product_name':_0x2051ab(0x1a1),'product_code':_0x2051ab(0x17e),'quantity_available':_0x2051ab(0x163),'warehouse_name':_0x2051ab(0x168),'warehouse_room':_0x2051ab(0x17f),'product_invoice':_0x2051ab(0x176),'invoice':_0x2051ab(0x175),'id_transaction_id':'$product.id_transaction_id'}}]);console[_0x2051ab(0x194)](_0x227cc4),_0x227cc4[_0x2051ab(0x185)]>0x0&&_0x240da7[_0x2051ab(0x160)][_0x28cce1[_0x2051ab(0x172)]][_0x2051ab(0x16a)](..._0x227cc4);}));})),_0x2a2a70[_0x2cd66a(0x17c)]({'purchases_warehouse':_0x240da7,'data_sales':_0x240da7[_0x2cd66a(0x188)],'data_adjustment':_0x240da7[_0x2cd66a(0x16d)],'data_transfer':_0x240da7[_0x2cd66a(0x160)]});}),module[a0_0x44a590(0x1a0)]=router;function a0_0x3f0a(){const _0x258711=['$product.product_name','/negative','$product_details','data_transfer','7112090iXvqhf','status','$product.to_quantity','789070yfLmCU','valueOf','all','message','$to_warehouse','$sale_product.id_transaction_from','push','14800005047429','warehouse_data','data_adjustment','get','$sale_product','$product_details.invoice','monitor','invoice','$$invoice','$sale_product._id','$invoice','$product.to_room_name','express','3350199jsYDuo','/join','$name','updateMany','json','5795920yRFdhz','$product.product_code','$product.room_names','371fXwDbk','$room','/warehouse_monitor','$product._id','map','length','$product','Router','data_sales','render','2jvdsII','$product_details.product_name','flash','/checking','265342pvKLTe','$sale_product.product_name','$sale_product.room_name','231688yInqgs','6035755xdbTUK','$product_details.product_stock','log','$product_details.product_code','aggregate','$warehouse_name','$product.new_adjust_qty','6uXcyFS','_id','9AXTops','table\x20page','$sale_product.product_code','../../models/all_models','\x20documents\x20updated','exports'];a0_0x3f0a=function(){return _0x258711;};return a0_0x3f0a();}