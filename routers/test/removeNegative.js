const a0_0x1b2b9d=a0_0x2e04;function a0_0x2e04(_0x5364de,_0x4843ce){const _0xb3205f=a0_0xb320();return a0_0x2e04=function(_0x2e043d,_0x191fc8){_0x2e043d=_0x2e043d-0x1ad;let _0x53e5bc=_0xb3205f[_0x2e043d];return _0x53e5bc;},a0_0x2e04(_0x5364de,_0x4843ce);}function a0_0xb320(){const _0x5b44dd=['/warehouse_monitor','$invoice','json','$product.id_transaction_from','$product.id_transaction_id','3491095yJsJkI','$sale_product.product_name','$sale_product.id_transaction_from','get','errors','$$invoice','10onVvlp','158293cnZsIa','push','map','1492043XkiZrb','warehouses','1058601IwtiEY','$product_details','$product.product_name','$sale_product.quantity','aggregate','Router','data_transfer','$product_details.product_code','$room','908343VlItGe','status','$product.new_adjust_qty','flash','$sale_product.product_code','all','exports','express','/join','/checking','log','$product_details._id','$to_warehouse','valueOf','$warehouse_name','warehouse_data','data_sales','invoice','$sale_product.room_name','$sale_product.invoice','../../models/all_models','data_adjustment','message','594392ygxuqF','$product._id','success','monitor','$sale_product._id','_id','$product.room_names','3946740UaIoOM','$product_details.product_name','$product_details.invoice','$product.product_code','168IHoIAn','$product','table\x20page','14800005047429','length'];a0_0xb320=function(){return _0x5b44dd;};return a0_0xb320();}(function(_0x2bc0e5,_0x3a4184){const _0x35ff8d=a0_0x2e04,_0x3c1cd8=_0x2bc0e5();while(!![]){try{const _0x4d2602=parseInt(_0x35ff8d(0x1eb))/0x1*(parseInt(_0x35ff8d(0x1ea))/0x2)+parseInt(_0x35ff8d(0x1af))/0x3+-parseInt(_0x35ff8d(0x1cf))/0x4+parseInt(_0x35ff8d(0x1e4))/0x5+parseInt(_0x35ff8d(0x1d6))/0x6+parseInt(_0x35ff8d(0x1ad))/0x7+parseInt(_0x35ff8d(0x1da))/0x8*(-parseInt(_0x35ff8d(0x1b8))/0x9);if(_0x4d2602===_0x3a4184)break;else _0x3c1cd8['push'](_0x3c1cd8['shift']());}catch(_0x263e69){_0x3c1cd8['push'](_0x3c1cd8['shift']());}}}(a0_0xb320,0x6cbf1));const express=require(a0_0x1b2b9d(0x1bf)),app=express(),router=express[a0_0x1b2b9d(0x1b4)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x1b2b9d(0x1cc));router['get']('/negative',async(_0x49717f,_0x2588b6)=>{const _0x20ade9=a0_0x1b2b9d;try{const _0x198c46=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x2588b6[_0x20ade9(0x1e1)]({'status':_0x198c46['modifiedCount']+'\x20documents\x20updated'});}catch(_0x21bbb6){console[_0x20ade9(0x1c2)](_0x20ade9(0x1dc),_0x21bbb6),_0x2588b6['status'](0xc8)[_0x20ade9(0x1e1)]({'message':_0x21bbb6[_0x20ade9(0x1ce)]});}}),router['get'](a0_0x1b2b9d(0x1c1),async(_0x20df46,_0x27b9db)=>{const _0x15a2da=a0_0x1b2b9d;try{const _0x5e383f=await warehouse['aggregate']([{'$unwind':_0x15a2da(0x1b0)},{'$match':{'product_details.invoice':'INCF-52068316','product_details.primary_code':_0x15a2da(0x1dd)}},{'$group':{'_id':{'name':'$name','room':_0x15a2da(0x1b7)},'products':{'$push':_0x15a2da(0x1b0)}}}]);_0x27b9db[_0x15a2da(0x1e1)](_0x5e383f);}catch(_0x4529f8){console['log'](_0x15a2da(0x1dc),_0x4529f8),_0x27b9db[_0x15a2da(0x1b9)](0xc8)[_0x15a2da(0x1e1)]({'message':_0x4529f8[_0x15a2da(0x1ce)]});}}),router[a0_0x1b2b9d(0x1e7)](a0_0x1b2b9d(0x1df),async(_0x3a5c93,_0x5955c5)=>{const _0x4a211c=a0_0x1b2b9d;_0x5955c5['render'](_0x4a211c(0x1d2),{'success':_0x3a5c93[_0x4a211c(0x1bb)](_0x4a211c(0x1d1)),'errors':_0x3a5c93[_0x4a211c(0x1bb)](_0x4a211c(0x1e8))});}),router[a0_0x1b2b9d(0x1e7)](a0_0x1b2b9d(0x1c0),async(_0x2718da,_0x181a96)=>{const _0x18606e=a0_0x1b2b9d;var _0x21e551=await purchases[_0x18606e(0x1b3)]([{'$lookup':{'from':_0x18606e(0x1ae),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x18606e(0x1b0)},{'$match':{'$expr':{'$eq':[_0x18606e(0x1e9),'$product_details.invoice']}}},{'$project':{'_id':_0x18606e(0x1c3),'product_name':_0x18606e(0x1d7),'product_code':_0x18606e(0x1b6),'quantity_available':'$product_details.product_stock','warehouse_name':'$name','warehouse_room':_0x18606e(0x1b7),'invoice':_0x18606e(0x1d8)}}],'as':_0x18606e(0x1c7)}}]);_0x21e551[_0x18606e(0x1c8)]={},await Promise[_0x18606e(0x1bd)](_0x21e551[_0x18606e(0x1ed)](async _0x21425f=>{const _0x54a505=_0x18606e;_0x21e551[_0x54a505(0x1c8)][_0x21425f[_0x54a505(0x1c9)]]=[],await Promise[_0x54a505(0x1bd)](_0x21425f['warehouse_data'][_0x54a505(0x1ed)](async _0x3fb529=>{const _0x5073e1=_0x54a505,_0x3806ee=await sales[_0x5073e1(0x1b3)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x3fb529['_id'][_0x5073e1(0x1c5)](),'sale_product.invoice':_0x3fb529[_0x5073e1(0x1c9)]}},{'$project':{'_id':_0x5073e1(0x1d3),'product_name':_0x5073e1(0x1e5),'product_code':_0x5073e1(0x1bc),'quantity_available':_0x5073e1(0x1b2),'warehouse_name':_0x5073e1(0x1c6),'warehouse_room':_0x5073e1(0x1ca),'product_invoice':_0x5073e1(0x1cb),'invoice':'$invoice','id_transaction_from':_0x5073e1(0x1e6)}}]);_0x3806ee[_0x5073e1(0x1de)]>0x0&&_0x21e551[_0x5073e1(0x1c8)][_0x21425f[_0x5073e1(0x1c9)]][_0x5073e1(0x1ec)](..._0x3806ee);}));})),_0x21e551[_0x18606e(0x1c8)]=_0x21e551[_0x18606e(0x1c8)],_0x21e551['data_adjustment']={},await Promise['all'](_0x21e551[_0x18606e(0x1ed)](async _0x148797=>{const _0x37ba78=_0x18606e;_0x21e551['data_adjustment'][_0x148797[_0x37ba78(0x1c9)]]=[],await Promise[_0x37ba78(0x1bd)](_0x148797[_0x37ba78(0x1c7)]['map'](async _0x2d62dd=>{const _0x81188a=_0x37ba78,_0x593699=await adjustment['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x2d62dd[_0x81188a(0x1d4)][_0x81188a(0x1c5)](),'product.invoice':_0x2d62dd[_0x81188a(0x1c9)]}},{'$project':{'_id':_0x81188a(0x1d0),'product_name':'$product.product_name','product_code':_0x81188a(0x1d9),'quantity_available':_0x81188a(0x1ba),'warehouse_name':'$warehouse_name','warehouse_room':_0x81188a(0x1d5),'product_invoice':'$product.invoice','invoice':_0x81188a(0x1e0),'id_transaction_from':_0x81188a(0x1e2)}}]);_0x593699[_0x81188a(0x1de)]>0x0&&_0x21e551[_0x81188a(0x1cd)][_0x148797[_0x81188a(0x1c9)]][_0x81188a(0x1ec)](..._0x593699);}));})),_0x21e551['data_transfer']={},await Promise[_0x18606e(0x1bd)](_0x21e551[_0x18606e(0x1ed)](async _0x563a78=>{const _0x460cbf=_0x18606e;_0x21e551[_0x460cbf(0x1b5)][_0x563a78[_0x460cbf(0x1c9)]]=[],await Promise[_0x460cbf(0x1bd)](_0x563a78[_0x460cbf(0x1c7)][_0x460cbf(0x1ed)](async _0x594471=>{const _0x227b40=_0x460cbf,_0x4772e6=await transfers[_0x227b40(0x1b3)]([{'$unwind':_0x227b40(0x1db)},{'$match':{'product.id_transaction_id':_0x594471[_0x227b40(0x1d4)]['valueOf'](),'product.To_invoice':_0x594471[_0x227b40(0x1c9)]}},{'$project':{'_id':'$product._id','product_name':_0x227b40(0x1b1),'product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x227b40(0x1c4),'warehouse_room':_0x227b40(0x1d5),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_id':_0x227b40(0x1e3)}}]);console[_0x227b40(0x1c2)](_0x4772e6),_0x4772e6[_0x227b40(0x1de)]>0x0&&_0x21e551[_0x227b40(0x1b5)][_0x563a78[_0x227b40(0x1c9)]][_0x227b40(0x1ec)](..._0x4772e6);}));})),_0x181a96['json']({'purchases_warehouse':_0x21e551,'data_sales':_0x21e551[_0x18606e(0x1c8)],'data_adjustment':_0x21e551[_0x18606e(0x1cd)],'data_transfer':_0x21e551['data_transfer']});}),module[a0_0x1b2b9d(0x1be)]=router;