const a0_0x90cb2e=a0_0x25ba;(function(_0x21a848,_0x827339){const _0x4b1a4e=a0_0x25ba,_0x136f20=_0x21a848();while(!![]){try{const _0x16442a=parseInt(_0x4b1a4e(0x1dc))/0x1*(-parseInt(_0x4b1a4e(0x1f7))/0x2)+parseInt(_0x4b1a4e(0x1d5))/0x3+-parseInt(_0x4b1a4e(0x1c6))/0x4+parseInt(_0x4b1a4e(0x1c5))/0x5*(-parseInt(_0x4b1a4e(0x1ec))/0x6)+-parseInt(_0x4b1a4e(0x1ea))/0x7*(-parseInt(_0x4b1a4e(0x1f6))/0x8)+parseInt(_0x4b1a4e(0x1f4))/0x9*(parseInt(_0x4b1a4e(0x202))/0xa)+parseInt(_0x4b1a4e(0x1e5))/0xb;if(_0x16442a===_0x827339)break;else _0x136f20['push'](_0x136f20['shift']());}catch(_0x14c8e7){_0x136f20['push'](_0x136f20['shift']());}}}(a0_0xa83e,0xc846e));function a0_0x25ba(_0x2a4cbf,_0x6c95f3){const _0xa83efa=a0_0xa83e();return a0_0x25ba=function(_0x25bac4,_0x169a68){_0x25bac4=_0x25bac4-0x1c5;let _0x2b0cde=_0xa83efa[_0x25bac4];return _0x2b0cde;},a0_0x25ba(_0x2a4cbf,_0x6c95f3);}function a0_0xa83e(){const _0x3858d8=['$product.to_quantity','$product.product_code','$product','render','express','$product.id_transaction_id','monitor','exports','$invoice','$product_details._id','$product_details.product_name','3350079HaMChT','json','updateMany','$product.new_adjust_qty','$sale_product.product_name','$product.product_name','../../models/all_models','696522BiaAdL','message','map','flash','$room','$product_details.product_stock','$sale_product','get','aggregate','20092600UsGLPY','$product._id','modifiedCount','$product.to_room_name','$product_details.invoice','9695KUUTLn','$product.invoice','330NcaQfs','14800005047429','$sale_product.id_transaction_from','Router','success','warehouse_data','$product_details','$sale_product.invoice','36594VZdLst','push','4176RlEpsi','2YaZBCA','log','status','$warehouse_name','all','INCF-52068316','table\x20page','$product.room_names','/negative','data_transfer','_id','1380mzGXZI','/join','valueOf','$name','length','$product_details.product_code','invoice','148925aoHOwB','4289360Bbsotr','data_adjustment','data_sales','warehouses'];a0_0xa83e=function(){return _0x3858d8;};return a0_0xa83e();}const express=require(a0_0x90cb2e(0x1ce)),app=express(),router=express[a0_0x90cb2e(0x1ef)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x90cb2e(0x1db));router[a0_0x90cb2e(0x1e3)](a0_0x90cb2e(0x1ff),async(_0x2afcba,_0xccab1a)=>{const _0x24e831=a0_0x90cb2e;try{const _0xa47e43=await warehouse[_0x24e831(0x1d7)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0xccab1a[_0x24e831(0x1d6)]({'status':_0xa47e43[_0x24e831(0x1e7)]+'\x20documents\x20updated'});}catch(_0x24be50){console[_0x24e831(0x1f8)]('table\x20page',_0x24be50),_0xccab1a[_0x24e831(0x1f9)](0xc8)[_0x24e831(0x1d6)]({'message':_0x24be50[_0x24e831(0x1dd)]});}}),router[a0_0x90cb2e(0x1e3)]('/checking',async(_0x5ebbfc,_0x42131b)=>{const _0xc0f679=a0_0x90cb2e;try{const _0x39f2d5=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':_0xc0f679(0x1fc),'product_details.primary_code':_0xc0f679(0x1ed)}},{'$group':{'_id':{'name':_0xc0f679(0x205),'room':_0xc0f679(0x1e0)},'products':{'$push':_0xc0f679(0x1f2)}}}]);_0x42131b[_0xc0f679(0x1d6)](_0x39f2d5);}catch(_0x132c73){console[_0xc0f679(0x1f8)](_0xc0f679(0x1fd),_0x132c73),_0x42131b[_0xc0f679(0x1f9)](0xc8)[_0xc0f679(0x1d6)]({'message':_0x132c73['message']});}}),router[a0_0x90cb2e(0x1e3)]('/warehouse_monitor',async(_0x3dc9cf,_0x5906a9)=>{const _0x3b3748=a0_0x90cb2e;_0x5906a9[_0x3b3748(0x1cd)](_0x3b3748(0x1d0),{'success':_0x3dc9cf[_0x3b3748(0x1df)](_0x3b3748(0x1f0)),'errors':_0x3dc9cf[_0x3b3748(0x1df)]('errors')});}),router['get'](a0_0x90cb2e(0x203),async(_0x2e6967,_0x306344)=>{const _0x496a78=a0_0x90cb2e;var _0x1fc555=await purchases[_0x496a78(0x1e4)]([{'$lookup':{'from':_0x496a78(0x1c9),'let':{'invoice':_0x496a78(0x1d2)},'pipeline':[{'$unwind':_0x496a78(0x1f2)},{'$match':{'$expr':{'$eq':['$$invoice',_0x496a78(0x1e9)]}}},{'$project':{'_id':_0x496a78(0x1d3),'product_name':_0x496a78(0x1d4),'product_code':_0x496a78(0x207),'quantity_available':_0x496a78(0x1e1),'warehouse_name':_0x496a78(0x205),'warehouse_room':_0x496a78(0x1e0),'invoice':_0x496a78(0x1e9)}}],'as':_0x496a78(0x1f1)}}]);_0x1fc555[_0x496a78(0x1c8)]={},await Promise['all'](_0x1fc555[_0x496a78(0x1de)](async _0x548ad4=>{const _0x1dab97=_0x496a78;_0x1fc555['data_sales'][_0x548ad4[_0x1dab97(0x208)]]=[],await Promise['all'](_0x548ad4['warehouse_data'][_0x1dab97(0x1de)](async _0x31f604=>{const _0x374488=_0x1dab97,_0x23a90a=await sales[_0x374488(0x1e4)]([{'$unwind':_0x374488(0x1e2)},{'$match':{'sale_product.id_transaction_from':_0x31f604[_0x374488(0x201)][_0x374488(0x204)](),'sale_product.invoice':_0x31f604[_0x374488(0x208)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x374488(0x1d9),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x374488(0x1fa),'warehouse_room':'$sale_product.room_name','product_invoice':_0x374488(0x1f3),'invoice':'$invoice','id_transaction_from':_0x374488(0x1ee)}}]);_0x23a90a[_0x374488(0x206)]>0x0&&_0x1fc555[_0x374488(0x1c8)][_0x548ad4[_0x374488(0x208)]][_0x374488(0x1f5)](..._0x23a90a);}));})),_0x1fc555['data_sales']=_0x1fc555[_0x496a78(0x1c8)],_0x1fc555[_0x496a78(0x1c7)]={},await Promise['all'](_0x1fc555['map'](async _0x3bd3d5=>{const _0x449050=_0x496a78;_0x1fc555[_0x449050(0x1c7)][_0x3bd3d5[_0x449050(0x208)]]=[],await Promise[_0x449050(0x1fb)](_0x3bd3d5[_0x449050(0x1f1)][_0x449050(0x1de)](async _0x3b4eb5=>{const _0x1857b2=_0x449050,_0x3d32ad=await adjustment[_0x1857b2(0x1e4)]([{'$unwind':_0x1857b2(0x1cc)},{'$match':{'product.id_transaction_from':_0x3b4eb5[_0x1857b2(0x201)][_0x1857b2(0x204)](),'product.invoice':_0x3b4eb5[_0x1857b2(0x208)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x1857b2(0x1cb),'quantity_available':_0x1857b2(0x1d8),'warehouse_name':_0x1857b2(0x1fa),'warehouse_room':_0x1857b2(0x1fe),'product_invoice':_0x1857b2(0x1eb),'invoice':_0x1857b2(0x1d2),'id_transaction_from':'$product.id_transaction_from'}}]);_0x3d32ad[_0x1857b2(0x206)]>0x0&&_0x1fc555['data_adjustment'][_0x3bd3d5[_0x1857b2(0x208)]][_0x1857b2(0x1f5)](..._0x3d32ad);}));})),_0x1fc555[_0x496a78(0x200)]={},await Promise[_0x496a78(0x1fb)](_0x1fc555[_0x496a78(0x1de)](async _0x4a2a85=>{const _0x2fdc25=_0x496a78;_0x1fc555[_0x2fdc25(0x200)][_0x4a2a85[_0x2fdc25(0x208)]]=[],await Promise[_0x2fdc25(0x1fb)](_0x4a2a85[_0x2fdc25(0x1f1)]['map'](async _0x3431fb=>{const _0x34a21c=_0x2fdc25,_0x5dcbb1=await transfers[_0x34a21c(0x1e4)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x3431fb[_0x34a21c(0x201)][_0x34a21c(0x204)](),'product.To_invoice':_0x3431fb[_0x34a21c(0x208)]}},{'$project':{'_id':_0x34a21c(0x1e6),'product_name':_0x34a21c(0x1da),'product_code':_0x34a21c(0x1cb),'quantity_available':_0x34a21c(0x1ca),'warehouse_name':'$to_warehouse','warehouse_room':_0x34a21c(0x1fe),'product_invoice':_0x34a21c(0x1e8),'invoice':_0x34a21c(0x1d2),'id_transaction_id':_0x34a21c(0x1cf)}}]);console[_0x34a21c(0x1f8)](_0x5dcbb1),_0x5dcbb1[_0x34a21c(0x206)]>0x0&&_0x1fc555[_0x34a21c(0x200)][_0x4a2a85[_0x34a21c(0x208)]][_0x34a21c(0x1f5)](..._0x5dcbb1);}));})),_0x306344[_0x496a78(0x1d6)]({'purchases_warehouse':_0x1fc555,'data_sales':_0x1fc555[_0x496a78(0x1c8)],'data_adjustment':_0x1fc555['data_adjustment'],'data_transfer':_0x1fc555[_0x496a78(0x200)]});}),module[a0_0x90cb2e(0x1d1)]=router;