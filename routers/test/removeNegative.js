const a0_0x512421=a0_0x27cc;(function(_0x19679f,_0x2d1a9b){const _0x1990a9=a0_0x27cc,_0x2fcb69=_0x19679f();while(!![]){try{const _0x4f4fb0=-parseInt(_0x1990a9(0x113))/0x1*(-parseInt(_0x1990a9(0x100))/0x2)+parseInt(_0x1990a9(0x102))/0x3+parseInt(_0x1990a9(0x10f))/0x4*(-parseInt(_0x1990a9(0x107))/0x5)+-parseInt(_0x1990a9(0x12b))/0x6*(-parseInt(_0x1990a9(0x120))/0x7)+parseInt(_0x1990a9(0x130))/0x8+parseInt(_0x1990a9(0x122))/0x9+-parseInt(_0x1990a9(0x10d))/0xa;if(_0x4f4fb0===_0x2d1a9b)break;else _0x2fcb69['push'](_0x2fcb69['shift']());}catch(_0x15e5c5){_0x2fcb69['push'](_0x2fcb69['shift']());}}}(a0_0x403d,0x45686));const express=require(a0_0x512421(0x111)),app=express(),router=express[a0_0x512421(0x104)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x512421(0x10a));function a0_0x403d(){const _0x5d9b54=['all','6YmKQpT','invoice','$product.product_code','flash','$invoice','69368PEgqew','$sale_product.product_code','exports','$sale_product.product_name','json','$product.room_names','$product_details._id','aggregate','warehouses','$product','message','monitor','$product_details','$product.to_quantity','$warehouse_name','push','_id','$product_details.product_code','74996QgLUdo','$name','1126131rKebvH','$$invoice','Router','valueOf','data_transfer','84115Wqjgyj','status','table\x20page','../../models/all_models','warehouse_data','\x20documents\x20updated','3425930TKNGCR','$product.new_adjust_qty','128wlSlmQ','length','express','$product.product_name','7Rgniyv','data_adjustment','/checking','$sale_product._id','data_sales','$sale_product.id_transaction_from','$product.id_transaction_id','$room','$sale_product','14800005047429','$product._id','$product_details.product_name','$sale_product.room_name','1436078VVaFKF','/join','2821815YgPjqj','$sale_product.invoice','$product_details.invoice','map','get','/negative','$product.invoice','log'];a0_0x403d=function(){return _0x5d9b54;};return a0_0x403d();}function a0_0x27cc(_0x2f94fd,_0x2fb1f8){const _0x403de2=a0_0x403d();return a0_0x27cc=function(_0x27cca2,_0x4fac2d){_0x27cca2=_0x27cca2-0xf1;let _0xd91113=_0x403de2[_0x27cca2];return _0xd91113;},a0_0x27cc(_0x2f94fd,_0x2fb1f8);}router[a0_0x512421(0x126)](a0_0x512421(0x127),async(_0x2fc9ed,_0x5101e8)=>{const _0x579c33=a0_0x512421;try{const _0x33527c=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x5101e8[_0x579c33(0xf2)]({'status':_0x33527c['modifiedCount']+_0x579c33(0x10c)});}catch(_0x54e9f2){console[_0x579c33(0x129)]('table\x20page',_0x54e9f2),_0x5101e8[_0x579c33(0x108)](0xc8)[_0x579c33(0xf2)]({'message':_0x54e9f2['message']});}}),router[a0_0x512421(0x126)](a0_0x512421(0x115),async(_0x351d35,_0x3b43d2)=>{const _0x589751=a0_0x512421;try{const _0x531a5e=await warehouse[_0x589751(0xf5)]([{'$unwind':_0x589751(0xfa)},{'$match':{'product_details.invoice':'INCF-52068316','product_details.primary_code':_0x589751(0x11c)}},{'$group':{'_id':{'name':_0x589751(0x101),'room':_0x589751(0x11a)},'products':{'$push':_0x589751(0xfa)}}}]);_0x3b43d2[_0x589751(0xf2)](_0x531a5e);}catch(_0x49d694){console[_0x589751(0x129)](_0x589751(0x109),_0x49d694),_0x3b43d2['status'](0xc8)[_0x589751(0xf2)]({'message':_0x49d694[_0x589751(0xf8)]});}}),router[a0_0x512421(0x126)]('/warehouse_monitor',async(_0x1c085a,_0x3c23d3)=>{const _0x45cd55=a0_0x512421;_0x3c23d3['render'](_0x45cd55(0xf9),{'success':_0x1c085a[_0x45cd55(0x12e)]('success'),'errors':_0x1c085a[_0x45cd55(0x12e)]('errors')});}),router[a0_0x512421(0x126)](a0_0x512421(0x121),async(_0x599b8,_0x1b87bf)=>{const _0x192b99=a0_0x512421;var _0x276bab=await purchases[_0x192b99(0xf5)]([{'$lookup':{'from':_0x192b99(0xf6),'let':{'invoice':_0x192b99(0x12f)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x192b99(0x103),_0x192b99(0x124)]}}},{'$project':{'_id':_0x192b99(0xf4),'product_name':_0x192b99(0x11e),'product_code':_0x192b99(0xff),'quantity_available':'$product_details.product_stock','warehouse_name':_0x192b99(0x101),'warehouse_room':_0x192b99(0x11a),'invoice':_0x192b99(0x124)}}],'as':'warehouse_data'}}]);_0x276bab[_0x192b99(0x117)]={},await Promise['all'](_0x276bab['map'](async _0x3aa3d1=>{const _0x349c43=_0x192b99;_0x276bab[_0x349c43(0x117)][_0x3aa3d1[_0x349c43(0x12c)]]=[],await Promise[_0x349c43(0x12a)](_0x3aa3d1[_0x349c43(0x10b)][_0x349c43(0x125)](async _0x42d32c=>{const _0x4062f4=_0x349c43,_0x69597f=await sales['aggregate']([{'$unwind':_0x4062f4(0x11b)},{'$match':{'sale_product.id_transaction_from':_0x42d32c['_id']['valueOf'](),'sale_product.invoice':_0x42d32c['invoice']}},{'$project':{'_id':_0x4062f4(0x116),'product_name':_0x4062f4(0xf1),'product_code':_0x4062f4(0x131),'quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x4062f4(0x11f),'product_invoice':_0x4062f4(0x123),'invoice':_0x4062f4(0x12f),'id_transaction_from':_0x4062f4(0x118)}}]);_0x69597f[_0x4062f4(0x110)]>0x0&&_0x276bab['data_sales'][_0x3aa3d1[_0x4062f4(0x12c)]][_0x4062f4(0xfd)](..._0x69597f);}));})),_0x276bab[_0x192b99(0x117)]=_0x276bab[_0x192b99(0x117)],_0x276bab[_0x192b99(0x114)]={},await Promise['all'](_0x276bab[_0x192b99(0x125)](async _0x32e057=>{const _0x76c41c=_0x192b99;_0x276bab[_0x76c41c(0x114)][_0x32e057[_0x76c41c(0x12c)]]=[],await Promise[_0x76c41c(0x12a)](_0x32e057[_0x76c41c(0x10b)][_0x76c41c(0x125)](async _0x2af9f9=>{const _0x170941=_0x76c41c,_0x1a6ba1=await adjustment[_0x170941(0xf5)]([{'$unwind':_0x170941(0xf7)},{'$match':{'product.id_transaction_from':_0x2af9f9[_0x170941(0xfe)][_0x170941(0x105)](),'product.invoice':_0x2af9f9[_0x170941(0x12c)]}},{'$project':{'_id':_0x170941(0x11d),'product_name':_0x170941(0x112),'product_code':_0x170941(0x12d),'quantity_available':_0x170941(0x10e),'warehouse_name':_0x170941(0xfc),'warehouse_room':_0x170941(0xf3),'product_invoice':_0x170941(0x128),'invoice':_0x170941(0x12f),'id_transaction_from':'$product.id_transaction_from'}}]);_0x1a6ba1[_0x170941(0x110)]>0x0&&_0x276bab[_0x170941(0x114)][_0x32e057[_0x170941(0x12c)]][_0x170941(0xfd)](..._0x1a6ba1);}));})),_0x276bab[_0x192b99(0x106)]={},await Promise[_0x192b99(0x12a)](_0x276bab[_0x192b99(0x125)](async _0x84e3a9=>{const _0x330e88=_0x192b99;_0x276bab[_0x330e88(0x106)][_0x84e3a9[_0x330e88(0x12c)]]=[],await Promise[_0x330e88(0x12a)](_0x84e3a9[_0x330e88(0x10b)][_0x330e88(0x125)](async _0x2b72e9=>{const _0x1e9c26=_0x330e88,_0x5d004b=await transfers['aggregate']([{'$unwind':_0x1e9c26(0xf7)},{'$match':{'product.id_transaction_id':_0x2b72e9[_0x1e9c26(0xfe)]['valueOf'](),'product.To_invoice':_0x2b72e9[_0x1e9c26(0x12c)]}},{'$project':{'_id':_0x1e9c26(0x11d),'product_name':'$product.product_name','product_code':_0x1e9c26(0x12d),'quantity_available':_0x1e9c26(0xfb),'warehouse_name':'$to_warehouse','warehouse_room':_0x1e9c26(0xf3),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_id':_0x1e9c26(0x119)}}]);console['log'](_0x5d004b),_0x5d004b[_0x1e9c26(0x110)]>0x0&&_0x276bab[_0x1e9c26(0x106)][_0x84e3a9['invoice']][_0x1e9c26(0xfd)](..._0x5d004b);}));})),_0x1b87bf[_0x192b99(0xf2)]({'purchases_warehouse':_0x276bab,'data_sales':_0x276bab[_0x192b99(0x117)],'data_adjustment':_0x276bab[_0x192b99(0x114)],'data_transfer':_0x276bab[_0x192b99(0x106)]});}),module[a0_0x512421(0x132)]=router;