const a0_0x3d883f=a0_0x59aa;function a0_0x59aa(_0x1d4f95,_0x40a47d){const _0xe7eda6=a0_0xe7ed();return a0_0x59aa=function(_0x59aa1e,_0x4a98a5){_0x59aa1e=_0x59aa1e-0xd2;let _0x3ae85c=_0xe7eda6[_0x59aa1e];return _0x3ae85c;},a0_0x59aa(_0x1d4f95,_0x40a47d);}(function(_0x276e60,_0x44deb4){const _0x37217d=a0_0x59aa,_0x26f709=_0x276e60();while(!![]){try{const _0x2c4721=parseInt(_0x37217d(0xdb))/0x1+-parseInt(_0x37217d(0xf4))/0x2+parseInt(_0x37217d(0x10a))/0x3*(parseInt(_0x37217d(0x10f))/0x4)+-parseInt(_0x37217d(0xd8))/0x5*(-parseInt(_0x37217d(0xe5))/0x6)+parseInt(_0x37217d(0xea))/0x7*(parseInt(_0x37217d(0xd4))/0x8)+-parseInt(_0x37217d(0xeb))/0x9+-parseInt(_0x37217d(0xd3))/0xa;if(_0x2c4721===_0x44deb4)break;else _0x26f709['push'](_0x26f709['shift']());}catch(_0x4d5850){_0x26f709['push'](_0x26f709['shift']());}}}(a0_0xe7ed,0x89de7));const express=require('express'),app=express(),router=express[a0_0x3d883f(0xe9)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x3d883f(0x10e));router[a0_0x3d883f(0xfb)](a0_0x3d883f(0x113),async(_0x2e29ce,_0x341e2a)=>{const _0x416621=a0_0x3d883f;try{const _0x68bd6=await warehouse[_0x416621(0x108)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x341e2a[_0x416621(0x105)]({'status':_0x68bd6[_0x416621(0x101)]+_0x416621(0xd6)});}catch(_0x5b5dda){console[_0x416621(0x107)]('table\x20page',_0x5b5dda),_0x341e2a[_0x416621(0xee)](0xc8)[_0x416621(0x105)]({'message':_0x5b5dda[_0x416621(0x10c)]});}}),router['get'](a0_0x3d883f(0xf6),async(_0x3622a4,_0x3d6737)=>{const _0x186e20=a0_0x3d883f;try{const _0x400a61=await warehouse[_0x186e20(0xe4)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':_0x186e20(0xe3),'product_details.primary_code':'14800005047429'}},{'$group':{'_id':{'name':_0x186e20(0xfc),'room':'$room'},'products':{'$push':_0x186e20(0xe6)}}}]);_0x3d6737[_0x186e20(0x105)](_0x400a61);}catch(_0x305823){console[_0x186e20(0x107)]('table\x20page',_0x305823),_0x3d6737[_0x186e20(0xee)](0xc8)[_0x186e20(0x105)]({'message':_0x305823[_0x186e20(0x10c)]});}}),router['get'](a0_0x3d883f(0xf8),async(_0x216c47,_0x9fe3e3)=>{const _0x3ccd20=a0_0x3d883f;_0x9fe3e3['render'](_0x3ccd20(0x10b),{'success':_0x216c47[_0x3ccd20(0xf9)]('success'),'errors':_0x216c47['flash'](_0x3ccd20(0xe1))});}),router[a0_0x3d883f(0xfb)](a0_0x3d883f(0xe7),async(_0x3d1c25,_0x1a95d9)=>{const _0xcd1d6e=a0_0x3d883f;var _0x2e8247=await purchases[_0xcd1d6e(0xe4)]([{'$lookup':{'from':'warehouses','let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0xcd1d6e(0xe6)},{'$match':{'$expr':{'$eq':[_0xcd1d6e(0xd7),'$product_details.invoice']}}},{'$project':{'_id':_0xcd1d6e(0xfe),'product_name':_0xcd1d6e(0x104),'product_code':'$product_details.product_code','quantity_available':_0xcd1d6e(0x109),'warehouse_name':_0xcd1d6e(0xfc),'warehouse_room':_0xcd1d6e(0xfd),'invoice':_0xcd1d6e(0xec)}}],'as':_0xcd1d6e(0xda)}}]);_0x2e8247[_0xcd1d6e(0x110)]={},await Promise[_0xcd1d6e(0x10d)](_0x2e8247[_0xcd1d6e(0xd5)](async _0x5c06d8=>{const _0x54d203=_0xcd1d6e;_0x2e8247[_0x54d203(0x110)][_0x5c06d8[_0x54d203(0xf1)]]=[],await Promise[_0x54d203(0x10d)](_0x5c06d8[_0x54d203(0xda)][_0x54d203(0xd5)](async _0x389ad6=>{const _0x4795f6=_0x54d203,_0x4e1559=await sales[_0x4795f6(0xe4)]([{'$unwind':_0x4795f6(0xf5)},{'$match':{'sale_product.id_transaction_from':_0x389ad6[_0x4795f6(0x112)][_0x4795f6(0xdd)](),'sale_product.invoice':_0x389ad6['invoice']}},{'$project':{'_id':_0x4795f6(0x100),'product_name':_0x4795f6(0x102),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x4795f6(0xef),'warehouse_room':_0x4795f6(0x106),'product_invoice':_0x4795f6(0xe8),'invoice':_0x4795f6(0xf3),'id_transaction_from':_0x4795f6(0xdf)}}]);_0x4e1559[_0x4795f6(0x111)]>0x0&&_0x2e8247['data_sales'][_0x5c06d8[_0x4795f6(0xf1)]][_0x4795f6(0xf7)](..._0x4e1559);}));})),_0x2e8247[_0xcd1d6e(0x110)]=_0x2e8247[_0xcd1d6e(0x110)],_0x2e8247[_0xcd1d6e(0xd2)]={},await Promise[_0xcd1d6e(0x10d)](_0x2e8247[_0xcd1d6e(0xd5)](async _0x3f32ab=>{const _0x1e1eb8=_0xcd1d6e;_0x2e8247[_0x1e1eb8(0xd2)][_0x3f32ab[_0x1e1eb8(0xf1)]]=[],await Promise['all'](_0x3f32ab[_0x1e1eb8(0xda)][_0x1e1eb8(0xd5)](async _0x38b8b9=>{const _0x425a38=_0x1e1eb8,_0x547b02=await adjustment[_0x425a38(0xe4)]([{'$unwind':_0x425a38(0xfa)},{'$match':{'product.id_transaction_from':_0x38b8b9[_0x425a38(0x112)]['valueOf'](),'product.invoice':_0x38b8b9[_0x425a38(0xf1)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x425a38(0xf0),'quantity_available':_0x425a38(0xff),'warehouse_name':'$warehouse_name','warehouse_room':'$product.room_names','product_invoice':_0x425a38(0xe0),'invoice':_0x425a38(0xf3),'id_transaction_from':_0x425a38(0xd9)}}]);_0x547b02[_0x425a38(0x111)]>0x0&&_0x2e8247[_0x425a38(0xd2)][_0x3f32ab[_0x425a38(0xf1)]][_0x425a38(0xf7)](..._0x547b02);}));})),_0x2e8247[_0xcd1d6e(0xf2)]={},await Promise[_0xcd1d6e(0x10d)](_0x2e8247['map'](async _0x4b2d96=>{const _0x52bc68=_0xcd1d6e;_0x2e8247[_0x52bc68(0xf2)][_0x4b2d96[_0x52bc68(0xf1)]]=[],await Promise['all'](_0x4b2d96['warehouse_data']['map'](async _0x404a4d=>{const _0x30d935=_0x52bc68,_0x5c8e60=await transfers[_0x30d935(0xe4)]([{'$unwind':_0x30d935(0xfa)},{'$match':{'product.id_transaction_id':_0x404a4d[_0x30d935(0x112)][_0x30d935(0xdd)](),'product.To_invoice':_0x404a4d[_0x30d935(0xf1)]}},{'$project':{'_id':_0x30d935(0xde),'product_name':'$product.product_name','product_code':_0x30d935(0xf0),'quantity_available':_0x30d935(0x103),'warehouse_name':'$to_warehouse','warehouse_room':_0x30d935(0xdc),'product_invoice':_0x30d935(0xe2),'invoice':_0x30d935(0xf3),'id_transaction_id':'$product.id_transaction_id'}}]);console['log'](_0x5c8e60),_0x5c8e60['length']>0x0&&_0x2e8247[_0x30d935(0xf2)][_0x4b2d96[_0x30d935(0xf1)]][_0x30d935(0xf7)](..._0x5c8e60);}));})),_0x1a95d9[_0xcd1d6e(0x105)]({'purchases_warehouse':_0x2e8247,'data_sales':_0x2e8247['data_sales'],'data_adjustment':_0x2e8247[_0xcd1d6e(0xd2)],'data_transfer':_0x2e8247[_0xcd1d6e(0xf2)]});}),module[a0_0x3d883f(0xed)]=router;function a0_0xe7ed(){const _0x51f166=['$$invoice','1845vTlZDx','$product.id_transaction_from','warehouse_data','1122485wajFlK','$product.room_names','valueOf','$product._id','$sale_product.id_transaction_from','$product.invoice','errors','$product.to_room_name','INCF-52068316','aggregate','17406zSapYM','$product_details','/join','$sale_product.invoice','Router','223363LOIVNQ','5682474TMxKqK','$product_details.invoice','exports','status','$warehouse_name','$product.product_code','invoice','data_transfer','$invoice','2037706dsLOGF','$sale_product','/checking','push','/warehouse_monitor','flash','$product','get','$name','$room','$product_details._id','$product.new_adjust_qty','$sale_product._id','modifiedCount','$sale_product.product_name','$product.to_quantity','$product_details.product_name','json','$sale_product.room_name','log','updateMany','$product_details.product_stock','111462BBGKHF','monitor','message','all','../../models/all_models','120dyYqQc','data_sales','length','_id','/negative','data_adjustment','20179850LRboxe','232LRuSQN','map','\x20documents\x20updated'];a0_0xe7ed=function(){return _0x51f166;};return a0_0xe7ed();}