const a0_0x2e6d69=a0_0x3c74;(function(_0x1ff812,_0x18efa1){const _0x2048b5=a0_0x3c74,_0x3fefb4=_0x1ff812();while(!![]){try{const _0x49afcd=parseInt(_0x2048b5(0xf2))/0x1+-parseInt(_0x2048b5(0xd3))/0x2+-parseInt(_0x2048b5(0xda))/0x3+-parseInt(_0x2048b5(0xf8))/0x4+parseInt(_0x2048b5(0xe6))/0x5*(parseInt(_0x2048b5(0xfa))/0x6)+parseInt(_0x2048b5(0xf1))/0x7+-parseInt(_0x2048b5(0xc7))/0x8;if(_0x49afcd===_0x18efa1)break;else _0x3fefb4['push'](_0x3fefb4['shift']());}catch(_0x374a66){_0x3fefb4['push'](_0x3fefb4['shift']());}}}(a0_0xebeb,0x833f0));function a0_0x3c74(_0x56e650,_0x23932d){const _0xebebff=a0_0xebeb();return a0_0x3c74=function(_0x3c7479,_0x18f74a){_0x3c7479=_0x3c7479-0xc6;let _0x48e53c=_0xebebff[_0x3c7479];return _0x48e53c;},a0_0x3c74(_0x56e650,_0x23932d);}const express=require(a0_0x2e6d69(0xc9)),app=express(),router=express[a0_0x2e6d69(0xe9)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x2e6d69(0xdb));router[a0_0x2e6d69(0xe3)](a0_0x2e6d69(0xd0),async(_0x1530ca,_0x16e26b)=>{const _0x1988ee=a0_0x2e6d69;try{const _0x38bb3f=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x16e26b[_0x1988ee(0x108)]({'status':_0x38bb3f[_0x1988ee(0xe1)]+_0x1988ee(0x107)});}catch(_0x4b3b93){console[_0x1988ee(0xd4)](_0x1988ee(0xca),_0x4b3b93),_0x16e26b[_0x1988ee(0xec)](0xc8)['json']({'message':_0x4b3b93[_0x1988ee(0xcd)]});}}),router['get'](a0_0x2e6d69(0xf3),async(_0x538c22,_0x5b095f)=>{const _0x1c0971=a0_0x2e6d69;try{const _0x47a932=await warehouse[_0x1c0971(0xe2)]([{'$unwind':_0x1c0971(0xce)},{'$match':{'product_details.invoice':_0x1c0971(0xeb),'product_details.primary_code':_0x1c0971(0xc8)}},{'$group':{'_id':{'name':_0x1c0971(0xef),'room':'$room'},'products':{'$push':_0x1c0971(0xce)}}}]);_0x5b095f['json'](_0x47a932);}catch(_0x9c0eeb){console[_0x1c0971(0xd4)](_0x1c0971(0xca),_0x9c0eeb),_0x5b095f[_0x1c0971(0xec)](0xc8)[_0x1c0971(0x108)]({'message':_0x9c0eeb[_0x1c0971(0xcd)]});}}),router[a0_0x2e6d69(0xe3)](a0_0x2e6d69(0xf4),async(_0x37ca47,_0x4ad3be)=>{const _0x414156=a0_0x2e6d69;_0x4ad3be[_0x414156(0xdf)](_0x414156(0xe5),{'success':_0x37ca47['flash'](_0x414156(0xcf)),'errors':_0x37ca47[_0x414156(0xf0)](_0x414156(0xc6))});}),router[a0_0x2e6d69(0xe3)](a0_0x2e6d69(0x101),async(_0x4bcffd,_0x34ce00)=>{const _0x86f8e0=a0_0x2e6d69;var _0x38eb3d=await purchases['aggregate']([{'$lookup':{'from':'warehouses','let':{'invoice':_0x86f8e0(0xf7)},'pipeline':[{'$unwind':_0x86f8e0(0xce)},{'$match':{'$expr':{'$eq':[_0x86f8e0(0xd5),_0x86f8e0(0xd6)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x86f8e0(0xfb),'product_code':_0x86f8e0(0x109),'quantity_available':'$product_details.product_stock','warehouse_name':_0x86f8e0(0xef),'warehouse_room':_0x86f8e0(0x100),'invoice':_0x86f8e0(0xd6)}}],'as':_0x86f8e0(0x104)}}]);_0x38eb3d[_0x86f8e0(0x105)]={},await Promise['all'](_0x38eb3d[_0x86f8e0(0xd1)](async _0x594e60=>{const _0x4ec970=_0x86f8e0;_0x38eb3d['data_sales'][_0x594e60[_0x4ec970(0xff)]]=[],await Promise[_0x4ec970(0xee)](_0x594e60['warehouse_data'][_0x4ec970(0xd1)](async _0x898959=>{const _0x2056a5=_0x4ec970,_0x1423a2=await sales[_0x2056a5(0xe2)]([{'$unwind':_0x2056a5(0xdc)},{'$match':{'sale_product.id_transaction_from':_0x898959['_id'][_0x2056a5(0x106)](),'sale_product.invoice':_0x898959['invoice']}},{'$project':{'_id':_0x2056a5(0xfc),'product_name':_0x2056a5(0xfe),'product_code':_0x2056a5(0x103),'quantity_available':_0x2056a5(0xd7),'warehouse_name':_0x2056a5(0xea),'warehouse_room':'$sale_product.room_name','product_invoice':'$sale_product.invoice','invoice':_0x2056a5(0xf7),'id_transaction_from':_0x2056a5(0x102)}}]);_0x1423a2[_0x2056a5(0xcc)]>0x0&&_0x38eb3d['data_sales'][_0x594e60[_0x2056a5(0xff)]][_0x2056a5(0xdd)](..._0x1423a2);}));})),_0x38eb3d[_0x86f8e0(0x105)]=_0x38eb3d[_0x86f8e0(0x105)],_0x38eb3d[_0x86f8e0(0xe8)]={},await Promise['all'](_0x38eb3d['map'](async _0x4356a9=>{const _0x4e1524=_0x86f8e0;_0x38eb3d['data_adjustment'][_0x4356a9[_0x4e1524(0xff)]]=[],await Promise['all'](_0x4356a9[_0x4e1524(0x104)]['map'](async _0x8db9cb=>{const _0x5e0659=_0x4e1524,_0x23760f=await adjustment[_0x5e0659(0xe2)]([{'$unwind':_0x5e0659(0xd2)},{'$match':{'product.id_transaction_from':_0x8db9cb[_0x5e0659(0xfd)][_0x5e0659(0x106)](),'product.invoice':_0x8db9cb[_0x5e0659(0xff)]}},{'$project':{'_id':_0x5e0659(0xf9),'product_name':'$product.product_name','product_code':_0x5e0659(0xe4),'quantity_available':_0x5e0659(0xe0),'warehouse_name':'$warehouse_name','warehouse_room':_0x5e0659(0xde),'product_invoice':_0x5e0659(0xed),'invoice':_0x5e0659(0xf7),'id_transaction_from':'$product.id_transaction_from'}}]);_0x23760f[_0x5e0659(0xcc)]>0x0&&_0x38eb3d['data_adjustment'][_0x4356a9[_0x5e0659(0xff)]]['push'](..._0x23760f);}));})),_0x38eb3d['data_transfer']={},await Promise[_0x86f8e0(0xee)](_0x38eb3d[_0x86f8e0(0xd1)](async _0x1fa761=>{const _0x213a7a=_0x86f8e0;_0x38eb3d[_0x213a7a(0xf6)][_0x1fa761[_0x213a7a(0xff)]]=[],await Promise[_0x213a7a(0xee)](_0x1fa761[_0x213a7a(0x104)]['map'](async _0x421227=>{const _0x36b89c=_0x213a7a,_0x1516d3=await transfers[_0x36b89c(0xe2)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x421227['_id']['valueOf'](),'product.To_invoice':_0x421227[_0x36b89c(0xff)]}},{'$project':{'_id':_0x36b89c(0xf9),'product_name':_0x36b89c(0xd8),'product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x36b89c(0xd9),'warehouse_room':_0x36b89c(0xde),'product_invoice':_0x36b89c(0xcb),'invoice':'$invoice','id_transaction_id':_0x36b89c(0xe7)}}]);console['log'](_0x1516d3),_0x1516d3[_0x36b89c(0xcc)]>0x0&&_0x38eb3d[_0x36b89c(0xf6)][_0x1fa761[_0x36b89c(0xff)]][_0x36b89c(0xdd)](..._0x1516d3);}));})),_0x34ce00[_0x86f8e0(0x108)]({'purchases_warehouse':_0x38eb3d,'data_sales':_0x38eb3d[_0x86f8e0(0x105)],'data_adjustment':_0x38eb3d[_0x86f8e0(0xe8)],'data_transfer':_0x38eb3d['data_transfer']});}),module[a0_0x2e6d69(0xf5)]=router;function a0_0xebeb(){const _0x1e3daf=['$sale_product.id_transaction_from','$sale_product.product_code','warehouse_data','data_sales','valueOf','\x20documents\x20updated','json','$product_details.product_code','errors','3921472CqJWZW','14800005047429','express','table\x20page','$product.to_room_name','length','message','$product_details','success','/negative','map','$product','1264002fMqFIv','log','$$invoice','$product_details.invoice','$sale_product.quantity','$product.product_name','$to_warehouse','735303clkqHQ','../../models/all_models','$sale_product','push','$product.room_names','render','$product.new_adjust_qty','modifiedCount','aggregate','get','$product.product_code','monitor','36830sSwnGX','$product.id_transaction_id','data_adjustment','Router','$warehouse_name','INCF-52068316','status','$product.invoice','all','$name','flash','842954tuGnkm','942818FBsgiL','/checking','/warehouse_monitor','exports','data_transfer','$invoice','876296yGZQBD','$product._id','864wfdAmV','$product_details.product_name','$sale_product._id','_id','$sale_product.product_name','invoice','$room','/join'];a0_0xebeb=function(){return _0x1e3daf;};return a0_0xebeb();}