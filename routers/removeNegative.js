function a0_0x15fd(){const _0x2325a4=['all','$product_details._id','data_adjustment','INCF-52068316','get','render','$product_details.product_name','data_transfer','table\x20page','633785dGVohH','$product.product_name','flash','1136376dDXtPM','aggregate','$product_details.invoice','9240080pYSITH','$sale_product._id','monitor','$product.to_room_name','$product.to_quantity','$sale_product.room_name','4mOtBDU','$product_details','push','1405lRRfvy','invoice','$warehouse_name','15306rvIRiw','data_sales','$product.invoice','_id','errors','/negative','message','$product.room_names','$sale_product.quantity','json','$sale_product.invoice','$to_warehouse','170198wGkRMu','Router','2767803mfLLbT','$sale_product.product_name','modifiedCount','length','$invoice','valueOf','14800005047429','$product.new_adjust_qty','status','/join','$room','$product.id_transaction_id','$name','../../models/all_models','861984pClAFn','$product_details.product_stock','\x20documents\x20updated','map','$sale_product.product_code','/checking','log','warehouses','warehouse_data','$product','exports','$sale_product.id_transaction_from'];a0_0x15fd=function(){return _0x2325a4;};return a0_0x15fd();}function a0_0x14bc(_0x2a132c,_0x194517){const _0x15fd01=a0_0x15fd();return a0_0x14bc=function(_0x14bc6d,_0x3f5d12){_0x14bc6d=_0x14bc6d-0x125;let _0x253b28=_0x15fd01[_0x14bc6d];return _0x253b28;},a0_0x14bc(_0x2a132c,_0x194517);}const a0_0x3dd433=a0_0x14bc;(function(_0x172b3c,_0x55fe0f){const _0x278dc1=a0_0x14bc,_0xe540e9=_0x172b3c();while(!![]){try{const _0x1f27a5=-parseInt(_0x278dc1(0x148))/0x1+parseInt(_0x278dc1(0x133))/0x2+parseInt(_0x278dc1(0x125))/0x3*(-parseInt(_0x278dc1(0x154))/0x4)+-parseInt(_0x278dc1(0x157))/0x5*(-parseInt(_0x278dc1(0x15a))/0x6)+-parseInt(_0x278dc1(0x166))/0x7+parseInt(_0x278dc1(0x14e))/0x8+parseInt(_0x278dc1(0x14b))/0x9;if(_0x1f27a5===_0x55fe0f)break;else _0xe540e9['push'](_0xe540e9['shift']());}catch(_0x5746de){_0xe540e9['push'](_0xe540e9['shift']());}}}(a0_0x15fd,0xcf20d));const express=require('express'),app=express(),router=express[a0_0x3dd433(0x167)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x3dd433(0x132));router[a0_0x3dd433(0x143)](a0_0x3dd433(0x15f),async(_0x59ef54,_0xf3cdae)=>{const _0x22e1d7=a0_0x3dd433;try{const _0x1e2cc2=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0xf3cdae[_0x22e1d7(0x163)]({'status':_0x1e2cc2[_0x22e1d7(0x127)]+_0x22e1d7(0x135)});}catch(_0x169ce0){console['log'](_0x22e1d7(0x147),_0x169ce0),_0xf3cdae['status'](0xc8)[_0x22e1d7(0x163)]({'message':_0x169ce0['message']});}}),router[a0_0x3dd433(0x143)](a0_0x3dd433(0x138),async(_0x26f445,_0x2d8d1b)=>{const _0x120a15=a0_0x3dd433;try{const _0x329d55=await warehouse[_0x120a15(0x14c)]([{'$unwind':_0x120a15(0x155)},{'$match':{'product_details.invoice':_0x120a15(0x142),'product_details.primary_code':_0x120a15(0x12b)}},{'$group':{'_id':{'name':_0x120a15(0x131),'room':_0x120a15(0x12f)},'products':{'$push':_0x120a15(0x155)}}}]);_0x2d8d1b[_0x120a15(0x163)](_0x329d55);}catch(_0x1214f7){console['log'](_0x120a15(0x147),_0x1214f7),_0x2d8d1b[_0x120a15(0x12d)](0xc8)[_0x120a15(0x163)]({'message':_0x1214f7[_0x120a15(0x160)]});}}),router[a0_0x3dd433(0x143)]('/warehouse_monitor',async(_0x190360,_0x2e5a13)=>{const _0x5653ec=a0_0x3dd433;_0x2e5a13[_0x5653ec(0x144)](_0x5653ec(0x150),{'success':_0x190360[_0x5653ec(0x14a)]('success'),'errors':_0x190360[_0x5653ec(0x14a)](_0x5653ec(0x15e))});}),router[a0_0x3dd433(0x143)](a0_0x3dd433(0x12e),async(_0x39e1ed,_0x47fc99)=>{const _0x54cc44=a0_0x3dd433;var _0x5d7fe3=await purchases['aggregate']([{'$lookup':{'from':_0x54cc44(0x13a),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x54cc44(0x155)},{'$match':{'$expr':{'$eq':['$$invoice',_0x54cc44(0x14d)]}}},{'$project':{'_id':_0x54cc44(0x140),'product_name':_0x54cc44(0x145),'product_code':'$product_details.product_code','quantity_available':_0x54cc44(0x134),'warehouse_name':_0x54cc44(0x131),'warehouse_room':'$room','invoice':'$product_details.invoice'}}],'as':'warehouse_data'}}]);_0x5d7fe3[_0x54cc44(0x15b)]={},await Promise[_0x54cc44(0x13f)](_0x5d7fe3[_0x54cc44(0x136)](async _0x12b280=>{const _0x52bdb7=_0x54cc44;_0x5d7fe3[_0x52bdb7(0x15b)][_0x12b280[_0x52bdb7(0x158)]]=[],await Promise[_0x52bdb7(0x13f)](_0x12b280['warehouse_data'][_0x52bdb7(0x136)](async _0x1d1e37=>{const _0x55c201=_0x52bdb7,_0x4d9f17=await sales[_0x55c201(0x14c)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x1d1e37[_0x55c201(0x15d)][_0x55c201(0x12a)](),'sale_product.invoice':_0x1d1e37[_0x55c201(0x158)]}},{'$project':{'_id':_0x55c201(0x14f),'product_name':_0x55c201(0x126),'product_code':_0x55c201(0x137),'quantity_available':_0x55c201(0x162),'warehouse_name':_0x55c201(0x159),'warehouse_room':_0x55c201(0x153),'product_invoice':_0x55c201(0x164),'invoice':_0x55c201(0x129),'id_transaction_from':_0x55c201(0x13e)}}]);_0x4d9f17['length']>0x0&&_0x5d7fe3[_0x55c201(0x15b)][_0x12b280['invoice']][_0x55c201(0x156)](..._0x4d9f17);}));})),_0x5d7fe3[_0x54cc44(0x15b)]=_0x5d7fe3[_0x54cc44(0x15b)],_0x5d7fe3[_0x54cc44(0x141)]={},await Promise[_0x54cc44(0x13f)](_0x5d7fe3[_0x54cc44(0x136)](async _0xf885f2=>{const _0x246174=_0x54cc44;_0x5d7fe3[_0x246174(0x141)][_0xf885f2[_0x246174(0x158)]]=[],await Promise[_0x246174(0x13f)](_0xf885f2['warehouse_data']['map'](async _0x579118=>{const _0x458f55=_0x246174,_0x33ff0c=await adjustment[_0x458f55(0x14c)]([{'$unwind':_0x458f55(0x13c)},{'$match':{'product.id_transaction_from':_0x579118[_0x458f55(0x15d)][_0x458f55(0x12a)](),'product.invoice':_0x579118[_0x458f55(0x158)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':_0x458f55(0x12c),'warehouse_name':_0x458f55(0x159),'warehouse_room':'$product.room_names','product_invoice':_0x458f55(0x15c),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_from'}}]);_0x33ff0c[_0x458f55(0x128)]>0x0&&_0x5d7fe3[_0x458f55(0x141)][_0xf885f2[_0x458f55(0x158)]]['push'](..._0x33ff0c);}));})),_0x5d7fe3[_0x54cc44(0x146)]={},await Promise[_0x54cc44(0x13f)](_0x5d7fe3[_0x54cc44(0x136)](async _0x347349=>{const _0x904b9a=_0x54cc44;_0x5d7fe3['data_transfer'][_0x347349['invoice']]=[],await Promise[_0x904b9a(0x13f)](_0x347349[_0x904b9a(0x13b)][_0x904b9a(0x136)](async _0x2c091c=>{const _0xc486aa=_0x904b9a,_0x148769=await transfers[_0xc486aa(0x14c)]([{'$unwind':_0xc486aa(0x13c)},{'$match':{'product.id_transaction_id':_0x2c091c[_0xc486aa(0x15d)][_0xc486aa(0x12a)](),'product.To_invoice':_0x2c091c[_0xc486aa(0x158)]}},{'$project':{'_id':'$product._id','product_name':_0xc486aa(0x149),'product_code':'$product.product_code','quantity_available':_0xc486aa(0x152),'warehouse_name':_0xc486aa(0x165),'warehouse_room':_0xc486aa(0x161),'product_invoice':_0xc486aa(0x151),'invoice':_0xc486aa(0x129),'id_transaction_id':_0xc486aa(0x130)}}]);console[_0xc486aa(0x139)](_0x148769),_0x148769[_0xc486aa(0x128)]>0x0&&_0x5d7fe3[_0xc486aa(0x146)][_0x347349['invoice']]['push'](..._0x148769);}));})),_0x47fc99[_0x54cc44(0x163)]({'purchases_warehouse':_0x5d7fe3,'data_sales':_0x5d7fe3[_0x54cc44(0x15b)],'data_adjustment':_0x5d7fe3['data_adjustment'],'data_transfer':_0x5d7fe3[_0x54cc44(0x146)]});}),module[a0_0x3dd433(0x13d)]=router;