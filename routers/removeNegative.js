const a0_0x10ec7a=a0_0x4715;(function(_0x50132c,_0x188786){const _0x42cca7=a0_0x4715,_0x33772d=_0x50132c();while(!![]){try{const _0x4aba4a=-parseInt(_0x42cca7(0x10b))/0x1+parseInt(_0x42cca7(0xf7))/0x2+-parseInt(_0x42cca7(0x126))/0x3*(-parseInt(_0x42cca7(0x127))/0x4)+-parseInt(_0x42cca7(0x118))/0x5+-parseInt(_0x42cca7(0x10c))/0x6*(-parseInt(_0x42cca7(0xf3))/0x7)+-parseInt(_0x42cca7(0xe8))/0x8*(parseInt(_0x42cca7(0xff))/0x9)+-parseInt(_0x42cca7(0x11d))/0xa*(parseInt(_0x42cca7(0x103))/0xb);if(_0x4aba4a===_0x188786)break;else _0x33772d['push'](_0x33772d['shift']());}catch(_0x943308){_0x33772d['push'](_0x33772d['shift']());}}}(a0_0x1009,0xa0034));const express=require(a0_0x10ec7a(0x128)),app=express(),router=express[a0_0x10ec7a(0x12b)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require('../../models/all_models');function a0_0x4715(_0x3825ed,_0x563ae6){const _0x100990=a0_0x1009();return a0_0x4715=function(_0x47150c,_0x54a73e){_0x47150c=_0x47150c-0xe8;let _0x1b3480=_0x100990[_0x47150c];return _0x1b3480;},a0_0x4715(_0x3825ed,_0x563ae6);}router[a0_0x10ec7a(0x101)](a0_0x10ec7a(0x106),async(_0x59d8cd,_0x4191ad)=>{const _0x31aedc=a0_0x10ec7a;try{const _0x172c92=await warehouse[_0x31aedc(0x11c)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x4191ad['json']({'status':_0x172c92[_0x31aedc(0x113)]+_0x31aedc(0x109)});}catch(_0x10ff29){console['log']('table\x20page',_0x10ff29),_0x4191ad[_0x31aedc(0x129)](0xc8)[_0x31aedc(0xeb)]({'message':_0x10ff29[_0x31aedc(0x123)]});}}),router[a0_0x10ec7a(0x101)](a0_0x10ec7a(0x10a),async(_0x3d8b60,_0x3b9560)=>{const _0xb7d25d=a0_0x10ec7a;try{const _0x2b1ef7=await warehouse[_0xb7d25d(0xf8)]([{'$unwind':_0xb7d25d(0x107)},{'$match':{'product_details.invoice':_0xb7d25d(0xfa),'product_details.primary_code':_0xb7d25d(0x12a)}},{'$group':{'_id':{'name':'$name','room':'$room'},'products':{'$push':_0xb7d25d(0x107)}}}]);_0x3b9560['json'](_0x2b1ef7);}catch(_0x25df51){console[_0xb7d25d(0x116)](_0xb7d25d(0x10e),_0x25df51),_0x3b9560[_0xb7d25d(0x129)](0xc8)['json']({'message':_0x25df51[_0xb7d25d(0x123)]});}}),router['get']('/warehouse_monitor',async(_0x398945,_0x1540a2)=>{const _0x44b7a5=a0_0x10ec7a;_0x1540a2[_0x44b7a5(0x10f)]('monitor',{'success':_0x398945['flash'](_0x44b7a5(0xed)),'errors':_0x398945[_0x44b7a5(0x11a)]('errors')});}),router['get'](a0_0x10ec7a(0xf2),async(_0x568f2b,_0x5ba78c)=>{const _0x5328ac=a0_0x10ec7a;var _0x527d05=await purchases[_0x5328ac(0xf8)]([{'$lookup':{'from':'warehouses','let':{'invoice':_0x5328ac(0xf4)},'pipeline':[{'$unwind':_0x5328ac(0x107)},{'$match':{'$expr':{'$eq':['$$invoice',_0x5328ac(0xfb)]}}},{'$project':{'_id':_0x5328ac(0x122),'product_name':_0x5328ac(0x121),'product_code':_0x5328ac(0xf9),'quantity_available':_0x5328ac(0x105),'warehouse_name':'$name','warehouse_room':_0x5328ac(0x110),'invoice':_0x5328ac(0xfb)}}],'as':_0x5328ac(0x120)}}]);_0x527d05['data_sales']={},await Promise['all'](_0x527d05[_0x5328ac(0x119)](async _0x4c2387=>{const _0x12e3d4=_0x5328ac;_0x527d05[_0x12e3d4(0x102)][_0x4c2387[_0x12e3d4(0xee)]]=[],await Promise[_0x12e3d4(0xfe)](_0x4c2387[_0x12e3d4(0x120)]['map'](async _0x425c6e=>{const _0x1ceafd=_0x12e3d4,_0x26dd2c=await sales[_0x1ceafd(0xf8)]([{'$unwind':_0x1ceafd(0x10d)},{'$match':{'sale_product.id_transaction_from':_0x425c6e[_0x1ceafd(0xfc)]['valueOf'](),'sale_product.invoice':_0x425c6e[_0x1ceafd(0xee)]}},{'$project':{'_id':_0x1ceafd(0x11e),'product_name':_0x1ceafd(0x11f),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x1ceafd(0xf5),'warehouse_room':_0x1ceafd(0xef),'product_invoice':_0x1ceafd(0xe9),'invoice':_0x1ceafd(0xf4),'id_transaction_from':_0x1ceafd(0x11b)}}]);_0x26dd2c[_0x1ceafd(0x115)]>0x0&&_0x527d05[_0x1ceafd(0x102)][_0x4c2387[_0x1ceafd(0xee)]][_0x1ceafd(0xea)](..._0x26dd2c);}));})),_0x527d05[_0x5328ac(0x102)]=_0x527d05[_0x5328ac(0x102)],_0x527d05[_0x5328ac(0x111)]={},await Promise[_0x5328ac(0xfe)](_0x527d05[_0x5328ac(0x119)](async _0x3778a9=>{const _0x4168a4=_0x5328ac;_0x527d05[_0x4168a4(0x111)][_0x3778a9[_0x4168a4(0xee)]]=[],await Promise[_0x4168a4(0xfe)](_0x3778a9['warehouse_data'][_0x4168a4(0x119)](async _0x2d96eb=>{const _0x33bc59=_0x4168a4,_0x4e1a28=await adjustment[_0x33bc59(0xf8)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x2d96eb[_0x33bc59(0xfc)][_0x33bc59(0x114)](),'product.invoice':_0x2d96eb[_0x33bc59(0xee)]}},{'$project':{'_id':_0x33bc59(0xf1),'product_name':_0x33bc59(0x104),'product_code':_0x33bc59(0x100),'quantity_available':_0x33bc59(0xf0),'warehouse_name':_0x33bc59(0xf5),'warehouse_room':_0x33bc59(0x117),'product_invoice':_0x33bc59(0xec),'invoice':_0x33bc59(0xf4),'id_transaction_from':_0x33bc59(0x124)}}]);_0x4e1a28[_0x33bc59(0x115)]>0x0&&_0x527d05['data_adjustment'][_0x3778a9[_0x33bc59(0xee)]][_0x33bc59(0xea)](..._0x4e1a28);}));})),_0x527d05[_0x5328ac(0x108)]={},await Promise[_0x5328ac(0xfe)](_0x527d05[_0x5328ac(0x119)](async _0x414db3=>{const _0x296b41=_0x5328ac;_0x527d05[_0x296b41(0x108)][_0x414db3['invoice']]=[],await Promise[_0x296b41(0xfe)](_0x414db3[_0x296b41(0x120)][_0x296b41(0x119)](async _0x1b15f4=>{const _0x3fce7a=_0x296b41,_0x59de3b=await transfers[_0x3fce7a(0xf8)]([{'$unwind':_0x3fce7a(0x125)},{'$match':{'product.id_transaction_id':_0x1b15f4['_id'][_0x3fce7a(0x114)](),'product.To_invoice':_0x1b15f4['invoice']}},{'$project':{'_id':_0x3fce7a(0xf1),'product_name':_0x3fce7a(0x104),'product_code':_0x3fce7a(0x100),'quantity_available':_0x3fce7a(0xfd),'warehouse_name':'$to_warehouse','warehouse_room':_0x3fce7a(0x117),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_id':_0x3fce7a(0xf6)}}]);console[_0x3fce7a(0x116)](_0x59de3b),_0x59de3b[_0x3fce7a(0x115)]>0x0&&_0x527d05[_0x3fce7a(0x108)][_0x414db3[_0x3fce7a(0xee)]][_0x3fce7a(0xea)](..._0x59de3b);}));})),_0x5ba78c[_0x5328ac(0xeb)]({'purchases_warehouse':_0x527d05,'data_sales':_0x527d05[_0x5328ac(0x102)],'data_adjustment':_0x527d05[_0x5328ac(0x111)],'data_transfer':_0x527d05['data_transfer']});}),module[a0_0x10ec7a(0x112)]=router;function a0_0x1009(){const _0x28e334=['INCF-52068316','$product_details.invoice','_id','$product.to_quantity','all','27ySmmJC','$product.product_code','get','data_sales','187EfFszI','$product.product_name','$product_details.product_stock','/negative','$product_details','data_transfer','\x20documents\x20updated','/checking','233281ygKauQ','1356978FqIxKv','$sale_product','table\x20page','render','$room','data_adjustment','exports','modifiedCount','valueOf','length','log','$product.room_names','3556050WGQTZQ','map','flash','$sale_product.id_transaction_from','updateMany','18930LNDTWW','$sale_product._id','$sale_product.product_name','warehouse_data','$product_details.product_name','$product_details._id','message','$product.id_transaction_from','$product','33eAmWCm','450820TOVBkJ','express','status','14800005047429','Router','1859824eHRHxL','$sale_product.invoice','push','json','$product.invoice','success','invoice','$sale_product.room_name','$product.new_adjust_qty','$product._id','/join','28numiYM','$invoice','$warehouse_name','$product.id_transaction_id','370222ioFphB','aggregate','$product_details.product_code'];a0_0x1009=function(){return _0x28e334;};return a0_0x1009();}