const a0_0x5ae2c=a0_0x2744;(function(_0x26735e,_0x615546){const _0x18824d=a0_0x2744,_0x5d5437=_0x26735e();while(!![]){try{const _0x29b816=parseInt(_0x18824d(0x13f))/0x1+-parseInt(_0x18824d(0x167))/0x2+parseInt(_0x18824d(0x16b))/0x3+-parseInt(_0x18824d(0x144))/0x4*(parseInt(_0x18824d(0x146))/0x5)+-parseInt(_0x18824d(0x161))/0x6+parseInt(_0x18824d(0x169))/0x7*(-parseInt(_0x18824d(0x154))/0x8)+-parseInt(_0x18824d(0x151))/0x9*(-parseInt(_0x18824d(0x143))/0xa);if(_0x29b816===_0x615546)break;else _0x5d5437['push'](_0x5d5437['shift']());}catch(_0x3ce12d){_0x5d5437['push'](_0x5d5437['shift']());}}}(a0_0x1c60,0x2d500));function a0_0x2744(_0x35e990,_0x20396f){const _0x1c605f=a0_0x1c60();return a0_0x2744=function(_0x2744ab,_0x31febb){_0x2744ab=_0x2744ab-0x131;let _0x26df07=_0x1c605f[_0x2744ab];return _0x26df07;},a0_0x2744(_0x35e990,_0x20396f);}const express=require('express'),app=express(),router=express[a0_0x5ae2c(0x16e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require('../../models/all_models');router[a0_0x5ae2c(0x157)](a0_0x5ae2c(0x13d),async(_0x5e2a22,_0x373113)=>{const _0x2dd361=a0_0x5ae2c;try{const _0x325eed=await warehouse['updateMany']({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x373113['json']({'status':_0x325eed['modifiedCount']+'\x20documents\x20updated'});}catch(_0x1ba33d){console[_0x2dd361(0x141)]('table\x20page',_0x1ba33d),_0x373113[_0x2dd361(0x15d)](0xc8)[_0x2dd361(0x158)]({'message':_0x1ba33d[_0x2dd361(0x14b)]});}}),router[a0_0x5ae2c(0x157)](a0_0x5ae2c(0x140),async(_0x388540,_0x5e93b8)=>{const _0xd2b491=a0_0x5ae2c;try{const _0x12324f=await warehouse[_0xd2b491(0x155)]([{'$unwind':_0xd2b491(0x135)},{'$match':{'product_details.invoice':_0xd2b491(0x131),'product_details.primary_code':'14800005047429'}},{'$group':{'_id':{'name':_0xd2b491(0x15b),'room':_0xd2b491(0x14c)},'products':{'$push':_0xd2b491(0x135)}}}]);_0x5e93b8[_0xd2b491(0x158)](_0x12324f);}catch(_0x32267f){console[_0xd2b491(0x141)](_0xd2b491(0x13a),_0x32267f),_0x5e93b8[_0xd2b491(0x15d)](0xc8)[_0xd2b491(0x158)]({'message':_0x32267f['message']});}}),router[a0_0x5ae2c(0x157)]('/warehouse_monitor',async(_0x3d4180,_0x463db5)=>{const _0x252664=a0_0x5ae2c;_0x463db5[_0x252664(0x152)]('monitor',{'success':_0x3d4180[_0x252664(0x16a)](_0x252664(0x145)),'errors':_0x3d4180[_0x252664(0x16a)](_0x252664(0x14f))});}),router[a0_0x5ae2c(0x157)](a0_0x5ae2c(0x166),async(_0x445a82,_0x574382)=>{const _0x29a605=a0_0x5ae2c;var _0x479963=await purchases[_0x29a605(0x155)]([{'$lookup':{'from':_0x29a605(0x156),'let':{'invoice':_0x29a605(0x164)},'pipeline':[{'$unwind':_0x29a605(0x135)},{'$match':{'$expr':{'$eq':['$$invoice','$product_details.invoice']}}},{'$project':{'_id':_0x29a605(0x15c),'product_name':_0x29a605(0x13b),'product_code':_0x29a605(0x159),'quantity_available':_0x29a605(0x136),'warehouse_name':_0x29a605(0x15b),'warehouse_room':_0x29a605(0x14c),'invoice':_0x29a605(0x16c)}}],'as':_0x29a605(0x13e)}}]);_0x479963[_0x29a605(0x134)]={},await Promise['all'](_0x479963[_0x29a605(0x16d)](async _0x112a58=>{const _0x63aa53=_0x29a605;_0x479963['data_sales'][_0x112a58[_0x63aa53(0x165)]]=[],await Promise['all'](_0x112a58[_0x63aa53(0x13e)][_0x63aa53(0x16d)](async _0x363ea4=>{const _0x44828f=_0x63aa53,_0x4b54b3=await sales[_0x44828f(0x155)]([{'$unwind':_0x44828f(0x153)},{'$match':{'sale_product.id_transaction_from':_0x363ea4[_0x44828f(0x160)][_0x44828f(0x162)](),'sale_product.invoice':_0x363ea4[_0x44828f(0x165)]}},{'$project':{'_id':_0x44828f(0x148),'product_name':_0x44828f(0x14d),'product_code':_0x44828f(0x147),'quantity_available':_0x44828f(0x15a),'warehouse_name':'$warehouse_name','warehouse_room':_0x44828f(0x15f),'product_invoice':'$sale_product.invoice','invoice':_0x44828f(0x164),'id_transaction_from':'$sale_product.id_transaction_from'}}]);_0x4b54b3[_0x44828f(0x13c)]>0x0&&_0x479963[_0x44828f(0x134)][_0x112a58['invoice']][_0x44828f(0x132)](..._0x4b54b3);}));})),_0x479963[_0x29a605(0x134)]=_0x479963[_0x29a605(0x134)],_0x479963[_0x29a605(0x133)]={},await Promise['all'](_0x479963[_0x29a605(0x16d)](async _0x2fe475=>{const _0x3e7076=_0x29a605;_0x479963['data_adjustment'][_0x2fe475[_0x3e7076(0x165)]]=[],await Promise['all'](_0x2fe475[_0x3e7076(0x13e)][_0x3e7076(0x16d)](async _0x3d0b83=>{const _0x5410b9=_0x3e7076,_0x21fb89=await adjustment[_0x5410b9(0x155)]([{'$unwind':_0x5410b9(0x168)},{'$match':{'product.id_transaction_from':_0x3d0b83[_0x5410b9(0x160)][_0x5410b9(0x162)](),'product.invoice':_0x3d0b83['invoice']}},{'$project':{'_id':_0x5410b9(0x149),'product_name':_0x5410b9(0x142),'product_code':'$product.product_code','quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x5410b9(0x16f),'product_invoice':_0x5410b9(0x150),'invoice':_0x5410b9(0x164),'id_transaction_from':_0x5410b9(0x163)}}]);_0x21fb89['length']>0x0&&_0x479963[_0x5410b9(0x133)][_0x2fe475[_0x5410b9(0x165)]]['push'](..._0x21fb89);}));})),_0x479963['data_transfer']={},await Promise[_0x29a605(0x139)](_0x479963[_0x29a605(0x16d)](async _0x32b5de=>{const _0x292b34=_0x29a605;_0x479963[_0x292b34(0x14e)][_0x32b5de[_0x292b34(0x165)]]=[],await Promise[_0x292b34(0x139)](_0x32b5de['warehouse_data'][_0x292b34(0x16d)](async _0x1bf651=>{const _0x5d98ad=_0x292b34,_0x37c3af=await transfers[_0x5d98ad(0x155)]([{'$unwind':_0x5d98ad(0x168)},{'$match':{'product.id_transaction_id':_0x1bf651[_0x5d98ad(0x160)][_0x5d98ad(0x162)](),'product.To_invoice':_0x1bf651[_0x5d98ad(0x165)]}},{'$project':{'_id':_0x5d98ad(0x149),'product_name':_0x5d98ad(0x142),'product_code':_0x5d98ad(0x138),'quantity_available':_0x5d98ad(0x14a),'warehouse_name':_0x5d98ad(0x15e),'warehouse_room':_0x5d98ad(0x16f),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_id':'$product.id_transaction_id'}}]);console['log'](_0x37c3af),_0x37c3af['length']>0x0&&_0x479963[_0x5d98ad(0x14e)][_0x32b5de['invoice']]['push'](..._0x37c3af);}));})),_0x574382['json']({'purchases_warehouse':_0x479963,'data_sales':_0x479963[_0x29a605(0x134)],'data_adjustment':_0x479963['data_adjustment'],'data_transfer':_0x479963[_0x29a605(0x14e)]});}),module[a0_0x5ae2c(0x137)]=router;function a0_0x1c60(){const _0x53560c=['$product.room_names','INCF-52068316','push','data_adjustment','data_sales','$product_details','$product_details.product_stock','exports','$product.product_code','all','table\x20page','$product_details.product_name','length','/negative','warehouse_data','331030IECsPo','/checking','log','$product.product_name','7039470vvNMNf','4IrRdkW','success','644155PcTWej','$sale_product.product_code','$sale_product._id','$product._id','$product.to_quantity','message','$room','$sale_product.product_name','data_transfer','errors','$product.invoice','9IClIdC','render','$sale_product','8560npeBEd','aggregate','warehouses','get','json','$product_details.product_code','$sale_product.quantity','$name','$product_details._id','status','$to_warehouse','$sale_product.room_name','_id','1583808nqqiWi','valueOf','$product.id_transaction_from','$invoice','invoice','/join','616596CjJjnf','$product','1764FUiVPT','flash','364080YydxHR','$product_details.invoice','map','Router'];a0_0x1c60=function(){return _0x53560c;};return a0_0x1c60();}