const a0_0x4aae5d=a0_0x1806;(function(_0x42c498,_0x376589){const _0x5517e8=a0_0x1806,_0x48da94=_0x42c498();while(!![]){try{const _0x1d46d5=-parseInt(_0x5517e8(0xc5))/0x1*(parseInt(_0x5517e8(0xd9))/0x2)+parseInt(_0x5517e8(0xce))/0x3+-parseInt(_0x5517e8(0xeb))/0x4*(parseInt(_0x5517e8(0xd5))/0x5)+parseInt(_0x5517e8(0xb7))/0x6*(-parseInt(_0x5517e8(0xbc))/0x7)+parseInt(_0x5517e8(0xcd))/0x8+parseInt(_0x5517e8(0xe2))/0x9+parseInt(_0x5517e8(0xd8))/0xa;if(_0x1d46d5===_0x376589)break;else _0x48da94['push'](_0x48da94['shift']());}catch(_0x171346){_0x48da94['push'](_0x48da94['shift']());}}}(a0_0x61f6,0xcc3d7));const express=require('express'),app=express(),router=express[a0_0x4aae5d(0xba)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require('../../models/all_models');function a0_0x1806(_0x4905ae,_0xb2e285){const _0x61f68=a0_0x61f6();return a0_0x1806=function(_0x18067c,_0x50c050){_0x18067c=_0x18067c-0xb2;let _0x2acf7f=_0x61f68[_0x18067c];return _0x2acf7f;},a0_0x1806(_0x4905ae,_0xb2e285);}router['get'](a0_0x4aae5d(0xc4),async(_0x5d5b6f,_0x585e39)=>{const _0x136624=a0_0x4aae5d;try{const _0x332fe8=await warehouse[_0x136624(0xbf)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x585e39[_0x136624(0xe0)]({'status':_0x332fe8[_0x136624(0xd4)]+_0x136624(0xdb)});}catch(_0x98166a){console[_0x136624(0xc3)]('table\x20page',_0x98166a),_0x585e39[_0x136624(0xe8)](0xc8)['json']({'message':_0x98166a[_0x136624(0xd0)]});}}),router[a0_0x4aae5d(0xe3)](a0_0x4aae5d(0xc7),async(_0x5c5a9f,_0x5261eb)=>{const _0x574953=a0_0x4aae5d;try{const _0x56ad8f=await warehouse[_0x574953(0xb3)]([{'$unwind':_0x574953(0xf1)},{'$match':{'product_details.invoice':_0x574953(0xda),'product_details.primary_code':_0x574953(0xca)}},{'$group':{'_id':{'name':_0x574953(0xd1),'room':_0x574953(0xc1)},'products':{'$push':'$product_details'}}}]);_0x5261eb[_0x574953(0xe0)](_0x56ad8f);}catch(_0x1db17d){console[_0x574953(0xc3)](_0x574953(0xc6),_0x1db17d),_0x5261eb[_0x574953(0xe8)](0xc8)[_0x574953(0xe0)]({'message':_0x1db17d[_0x574953(0xd0)]});}}),router[a0_0x4aae5d(0xe3)](a0_0x4aae5d(0xe5),async(_0x44d6bf,_0x73654d)=>{const _0x924217=a0_0x4aae5d;_0x73654d[_0x924217(0xf8)](_0x924217(0xe6),{'success':_0x44d6bf[_0x924217(0xc9)]('success'),'errors':_0x44d6bf[_0x924217(0xc9)](_0x924217(0xe1))});}),router[a0_0x4aae5d(0xe3)](a0_0x4aae5d(0xb5),async(_0x52e225,_0xb57c96)=>{const _0x224ce4=a0_0x4aae5d;var _0x1f8a7c=await purchases[_0x224ce4(0xb3)]([{'$lookup':{'from':'warehouses','let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x224ce4(0xf1)},{'$match':{'$expr':{'$eq':['$$invoice','$product_details.invoice']}}},{'$project':{'_id':_0x224ce4(0xb8),'product_name':_0x224ce4(0xf0),'product_code':_0x224ce4(0xc0),'quantity_available':_0x224ce4(0xdd),'warehouse_name':_0x224ce4(0xd1),'warehouse_room':_0x224ce4(0xc1),'invoice':_0x224ce4(0xe4)}}],'as':_0x224ce4(0xf3)}}]);_0x1f8a7c['data_sales']={},await Promise[_0x224ce4(0xcb)](_0x1f8a7c[_0x224ce4(0xf4)](async _0x5ac55a=>{const _0x4fd498=_0x224ce4;_0x1f8a7c['data_sales'][_0x5ac55a[_0x4fd498(0xf7)]]=[],await Promise[_0x4fd498(0xcb)](_0x5ac55a[_0x4fd498(0xf3)][_0x4fd498(0xf4)](async _0x1b9889=>{const _0x2d95cc=_0x4fd498,_0xf079bc=await sales[_0x2d95cc(0xb3)]([{'$unwind':_0x2d95cc(0xd7)},{'$match':{'sale_product.id_transaction_from':_0x1b9889['_id'][_0x2d95cc(0xe7)](),'sale_product.invoice':_0x1b9889[_0x2d95cc(0xf7)]}},{'$project':{'_id':_0x2d95cc(0xf2),'product_name':_0x2d95cc(0xc2),'product_code':_0x2d95cc(0xf5),'quantity_available':_0x2d95cc(0xbe),'warehouse_name':_0x2d95cc(0xb2),'warehouse_room':_0x2d95cc(0xe9),'product_invoice':_0x2d95cc(0xd3),'invoice':'$invoice','id_transaction_from':_0x2d95cc(0xcc)}}]);_0xf079bc[_0x2d95cc(0xb9)]>0x0&&_0x1f8a7c['data_sales'][_0x5ac55a[_0x2d95cc(0xf7)]][_0x2d95cc(0xdf)](..._0xf079bc);}));})),_0x1f8a7c[_0x224ce4(0xea)]=_0x1f8a7c['data_sales'],_0x1f8a7c[_0x224ce4(0xc8)]={},await Promise[_0x224ce4(0xcb)](_0x1f8a7c[_0x224ce4(0xf4)](async _0x31a6c4=>{const _0x31132c=_0x224ce4;_0x1f8a7c[_0x31132c(0xc8)][_0x31a6c4[_0x31132c(0xf7)]]=[],await Promise[_0x31132c(0xcb)](_0x31a6c4['warehouse_data'][_0x31132c(0xf4)](async _0xd9efeb=>{const _0x12faf8=_0x31132c,_0xd85401=await adjustment[_0x12faf8(0xb3)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0xd9efeb[_0x12faf8(0xf6)][_0x12faf8(0xe7)](),'product.invoice':_0xd9efeb['invoice']}},{'$project':{'_id':_0x12faf8(0xed),'product_name':_0x12faf8(0xbb),'product_code':_0x12faf8(0xb4),'quantity_available':_0x12faf8(0xec),'warehouse_name':_0x12faf8(0xb2),'warehouse_room':'$product.room_names','product_invoice':_0x12faf8(0xd6),'invoice':_0x12faf8(0xb6),'id_transaction_from':'$product.id_transaction_from'}}]);_0xd85401['length']>0x0&&_0x1f8a7c[_0x12faf8(0xc8)][_0x31a6c4[_0x12faf8(0xf7)]][_0x12faf8(0xdf)](..._0xd85401);}));})),_0x1f8a7c[_0x224ce4(0xdc)]={},await Promise[_0x224ce4(0xcb)](_0x1f8a7c['map'](async _0x33012f=>{const _0x20f0a0=_0x224ce4;_0x1f8a7c[_0x20f0a0(0xdc)][_0x33012f['invoice']]=[],await Promise[_0x20f0a0(0xcb)](_0x33012f['warehouse_data'][_0x20f0a0(0xf4)](async _0x5a4f2a=>{const _0x51b509=_0x20f0a0,_0x2966d5=await transfers[_0x51b509(0xb3)]([{'$unwind':_0x51b509(0xde)},{'$match':{'product.id_transaction_id':_0x5a4f2a[_0x51b509(0xf6)][_0x51b509(0xe7)](),'product.To_invoice':_0x5a4f2a['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x51b509(0xbb),'product_code':'$product.product_code','quantity_available':_0x51b509(0xd2),'warehouse_name':_0x51b509(0xcf),'warehouse_room':_0x51b509(0xbd),'product_invoice':_0x51b509(0xef),'invoice':_0x51b509(0xb6),'id_transaction_id':_0x51b509(0xf9)}}]);console[_0x51b509(0xc3)](_0x2966d5),_0x2966d5[_0x51b509(0xb9)]>0x0&&_0x1f8a7c[_0x51b509(0xdc)][_0x33012f['invoice']][_0x51b509(0xdf)](..._0x2966d5);}));})),_0xb57c96[_0x224ce4(0xe0)]({'purchases_warehouse':_0x1f8a7c,'data_sales':_0x1f8a7c[_0x224ce4(0xea)],'data_adjustment':_0x1f8a7c['data_adjustment'],'data_transfer':_0x1f8a7c['data_transfer']});}),module[a0_0x4aae5d(0xee)]=router;function a0_0x61f6(){const _0x186272=['json','errors','2237868SmLhPn','get','$product_details.invoice','/warehouse_monitor','monitor','valueOf','status','$sale_product.room_name','data_sales','149832KCDyBG','$product.new_adjust_qty','$product._id','exports','$product.to_room_name','$product_details.product_name','$product_details','$sale_product._id','warehouse_data','map','$sale_product.product_code','_id','invoice','render','$product.id_transaction_id','$warehouse_name','aggregate','$product.product_code','/join','$invoice','1659618emyFHY','$product_details._id','length','Router','$product.product_name','21oGsKfB','$product.room_names','$sale_product.quantity','updateMany','$product_details.product_code','$room','$sale_product.product_name','log','/negative','1268597DEqIXh','table\x20page','/checking','data_adjustment','flash','14800005047429','all','$sale_product.id_transaction_from','4006632wJUAJL','4847433brdwqV','$to_warehouse','message','$name','$product.to_quantity','$sale_product.invoice','modifiedCount','170hGIWJa','$product.invoice','$sale_product','18432530xovZqR','2diyHeh','INCF-52068316','\x20documents\x20updated','data_transfer','$product_details.product_stock','$product','push'];a0_0x61f6=function(){return _0x186272;};return a0_0x61f6();}