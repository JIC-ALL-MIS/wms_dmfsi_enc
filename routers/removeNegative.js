const a0_0x4b272f=a0_0x29e7;function a0_0x4035(){const _0x4fffc2=['3655165eFnowy','log','push','warehouse_data','1508232HJnzOK','523710dFGKLG','Router','table\x20page','$product.product_code','$sale_product._id','errors','json','success','data_adjustment','$sale_product.room_name','\x20documents\x20updated','/negative','length','$product.product_name','$room','$product.to_room_name','$product_details.product_code','warehouses','$sale_product.id_transaction_from','get','data_transfer','data_sales','1109647YZxCSV','$sale_product.product_name','$product_details.product_name','$$invoice','render','$product.room_names','$product_details','$product','INCF-52068316','/join','$product.to_quantity','invoice','all','$product_details.product_stock','updateMany','$sale_product.quantity','$warehouse_name','$product.id_transaction_from','1773ZwQLKs','$product.id_transaction_id','14800005047429','$name','../../models/all_models','$to_warehouse','112CLbTBm','status','$product._id','express','_id','monitor','message','modifiedCount','$sale_product.product_code','aggregate','$product_details.invoice','flash','$product.invoice','15608UhqisX','1917684ldDAOP','map','12511WTkNeJ','valueOf','$invoice'];a0_0x4035=function(){return _0x4fffc2;};return a0_0x4035();}(function(_0x36230d,_0x4362c6){const _0x14cc73=a0_0x29e7,_0x4de042=_0x36230d();while(!![]){try{const _0x4b7b24=parseInt(_0x14cc73(0x1ed))/0x1*(-parseInt(_0x14cc73(0x223))/0x2)+-parseInt(_0x14cc73(0x1eb))/0x3+parseInt(_0x14cc73(0x1f4))/0x4+parseInt(_0x14cc73(0x1f0))/0x5+parseInt(_0x14cc73(0x1f5))/0x6+parseInt(_0x14cc73(0x20b))/0x7+-parseInt(_0x14cc73(0x1ea))/0x8*(-parseInt(_0x14cc73(0x21d))/0x9);if(_0x4b7b24===_0x4362c6)break;else _0x4de042['push'](_0x4de042['shift']());}catch(_0x43e102){_0x4de042['push'](_0x4de042['shift']());}}}(a0_0x4035,0x61440));function a0_0x29e7(_0x40cb1d,_0x569c69){const _0x40358e=a0_0x4035();return a0_0x29e7=function(_0x29e772,_0x5574f8){_0x29e772=_0x29e772-0x1e4;let _0x44514a=_0x40358e[_0x29e772];return _0x44514a;},a0_0x29e7(_0x40cb1d,_0x569c69);}const express=require(a0_0x4b272f(0x226)),app=express(),router=express[a0_0x4b272f(0x1f6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x4b272f(0x221));router[a0_0x4b272f(0x208)](a0_0x4b272f(0x200),async(_0x302e7d,_0x17eccf)=>{const _0x1e764e=a0_0x4b272f;try{const _0x54e944=await warehouse[_0x1e764e(0x219)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x17eccf['json']({'status':_0x54e944[_0x1e764e(0x1e4)]+_0x1e764e(0x1ff)});}catch(_0x104885){console[_0x1e764e(0x1f1)](_0x1e764e(0x1f7),_0x104885),_0x17eccf[_0x1e764e(0x224)](0xc8)['json']({'message':_0x104885['message']});}}),router['get']('/checking',async(_0x472cec,_0x9945fe)=>{const _0x43520e=a0_0x4b272f;try{const _0x3c3ba5=await warehouse['aggregate']([{'$unwind':_0x43520e(0x211)},{'$match':{'product_details.invoice':_0x43520e(0x213),'product_details.primary_code':_0x43520e(0x21f)}},{'$group':{'_id':{'name':_0x43520e(0x220),'room':_0x43520e(0x203)},'products':{'$push':_0x43520e(0x211)}}}]);_0x9945fe[_0x43520e(0x1fb)](_0x3c3ba5);}catch(_0x19ba4a){console[_0x43520e(0x1f1)](_0x43520e(0x1f7),_0x19ba4a),_0x9945fe[_0x43520e(0x224)](0xc8)[_0x43520e(0x1fb)]({'message':_0x19ba4a[_0x43520e(0x229)]});}}),router[a0_0x4b272f(0x208)]('/warehouse_monitor',async(_0x21b7bf,_0x5ba327)=>{const _0x4289a5=a0_0x4b272f;_0x5ba327[_0x4289a5(0x20f)](_0x4289a5(0x228),{'success':_0x21b7bf[_0x4289a5(0x1e8)](_0x4289a5(0x1fc)),'errors':_0x21b7bf[_0x4289a5(0x1e8)](_0x4289a5(0x1fa))});}),router[a0_0x4b272f(0x208)](a0_0x4b272f(0x214),async(_0x2a5a79,_0x55983e)=>{const _0x18a863=a0_0x4b272f;var _0x9e4e6a=await purchases[_0x18a863(0x1e6)]([{'$lookup':{'from':_0x18a863(0x206),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x18a863(0x211)},{'$match':{'$expr':{'$eq':[_0x18a863(0x20e),'$product_details.invoice']}}},{'$project':{'_id':'$product_details._id','product_name':_0x18a863(0x20d),'product_code':_0x18a863(0x205),'quantity_available':_0x18a863(0x218),'warehouse_name':_0x18a863(0x220),'warehouse_room':_0x18a863(0x203),'invoice':_0x18a863(0x1e7)}}],'as':_0x18a863(0x1f3)}}]);_0x9e4e6a[_0x18a863(0x20a)]={},await Promise[_0x18a863(0x217)](_0x9e4e6a[_0x18a863(0x1ec)](async _0x31f133=>{const _0xb84f51=_0x18a863;_0x9e4e6a['data_sales'][_0x31f133[_0xb84f51(0x216)]]=[],await Promise[_0xb84f51(0x217)](_0x31f133[_0xb84f51(0x1f3)][_0xb84f51(0x1ec)](async _0xc85ee8=>{const _0x365ab9=_0xb84f51,_0x35120b=await sales[_0x365ab9(0x1e6)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0xc85ee8[_0x365ab9(0x227)][_0x365ab9(0x1ee)](),'sale_product.invoice':_0xc85ee8[_0x365ab9(0x216)]}},{'$project':{'_id':_0x365ab9(0x1f9),'product_name':_0x365ab9(0x20c),'product_code':_0x365ab9(0x1e5),'quantity_available':_0x365ab9(0x21a),'warehouse_name':_0x365ab9(0x21b),'warehouse_room':_0x365ab9(0x1fe),'product_invoice':'$sale_product.invoice','invoice':_0x365ab9(0x1ef),'id_transaction_from':_0x365ab9(0x207)}}]);_0x35120b[_0x365ab9(0x201)]>0x0&&_0x9e4e6a[_0x365ab9(0x20a)][_0x31f133[_0x365ab9(0x216)]][_0x365ab9(0x1f2)](..._0x35120b);}));})),_0x9e4e6a[_0x18a863(0x20a)]=_0x9e4e6a[_0x18a863(0x20a)],_0x9e4e6a[_0x18a863(0x1fd)]={},await Promise[_0x18a863(0x217)](_0x9e4e6a[_0x18a863(0x1ec)](async _0x129c6f=>{const _0x18dec9=_0x18a863;_0x9e4e6a[_0x18dec9(0x1fd)][_0x129c6f[_0x18dec9(0x216)]]=[],await Promise['all'](_0x129c6f[_0x18dec9(0x1f3)]['map'](async _0x237bd0=>{const _0xd85c05=_0x18dec9,_0xcbf8cd=await adjustment[_0xd85c05(0x1e6)]([{'$unwind':_0xd85c05(0x212)},{'$match':{'product.id_transaction_from':_0x237bd0['_id']['valueOf'](),'product.invoice':_0x237bd0[_0xd85c05(0x216)]}},{'$project':{'_id':_0xd85c05(0x225),'product_name':_0xd85c05(0x202),'product_code':'$product.product_code','quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':'$product.room_names','product_invoice':_0xd85c05(0x1e9),'invoice':_0xd85c05(0x1ef),'id_transaction_from':_0xd85c05(0x21c)}}]);_0xcbf8cd[_0xd85c05(0x201)]>0x0&&_0x9e4e6a[_0xd85c05(0x1fd)][_0x129c6f[_0xd85c05(0x216)]][_0xd85c05(0x1f2)](..._0xcbf8cd);}));})),_0x9e4e6a[_0x18a863(0x209)]={},await Promise[_0x18a863(0x217)](_0x9e4e6a[_0x18a863(0x1ec)](async _0x6553e9=>{const _0x1f3d2b=_0x18a863;_0x9e4e6a[_0x1f3d2b(0x209)][_0x6553e9[_0x1f3d2b(0x216)]]=[],await Promise[_0x1f3d2b(0x217)](_0x6553e9[_0x1f3d2b(0x1f3)][_0x1f3d2b(0x1ec)](async _0xd7c5ca=>{const _0x5dd042=_0x1f3d2b,_0x41f451=await transfers[_0x5dd042(0x1e6)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0xd7c5ca[_0x5dd042(0x227)]['valueOf'](),'product.To_invoice':_0xd7c5ca[_0x5dd042(0x216)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x5dd042(0x1f8),'quantity_available':_0x5dd042(0x215),'warehouse_name':_0x5dd042(0x222),'warehouse_room':_0x5dd042(0x210),'product_invoice':_0x5dd042(0x204),'invoice':'$invoice','id_transaction_id':_0x5dd042(0x21e)}}]);console['log'](_0x41f451),_0x41f451[_0x5dd042(0x201)]>0x0&&_0x9e4e6a[_0x5dd042(0x209)][_0x6553e9[_0x5dd042(0x216)]][_0x5dd042(0x1f2)](..._0x41f451);}));})),_0x55983e['json']({'purchases_warehouse':_0x9e4e6a,'data_sales':_0x9e4e6a['data_sales'],'data_adjustment':_0x9e4e6a[_0x18a863(0x1fd)],'data_transfer':_0x9e4e6a['data_transfer']});}),module['exports']=router;