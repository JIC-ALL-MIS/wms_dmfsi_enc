const a0_0x310a7f=a0_0x5e81;function a0_0x5e81(_0x339d43,_0x3a5392){const _0xc6df0b=a0_0xc6df();return a0_0x5e81=function(_0x5e81e5,_0x24e4b9){_0x5e81e5=_0x5e81e5-0x152;let _0x51fbf7=_0xc6df0b[_0x5e81e5];return _0x51fbf7;},a0_0x5e81(_0x339d43,_0x3a5392);}function a0_0xc6df(){const _0x254005=['warehouses','$product._id','$sale_product.id_transaction_from','$product_details.product_name','2dSTYqo','$to_warehouse','../../models/all_models','message','updateMany','$product_details','$product','$name','$warehouse_name','10CMGLeV','table\x20page','$product.room_names','all','1816878joKzCN','warehouse_data','$product_details.invoice','$product.invoice','$product.product_name','_id','data_transfer','$product_details.product_code','$product.to_quantity','get','Router','$product.id_transaction_from','776413ZSBRaH','1926386HoWSzR','168970trcPNw','$sale_product._id','/checking','/warehouse_monitor','$sale_product.room_name','push','$sale_product.product_name','modifiedCount','valueOf','$sale_product.product_code','$product.id_transaction_id','$product.product_code','$product_details._id','flash','map','$invoice','975834rGNjQS','json','$product_details.product_stock','exports','invoice','success','68xjyKdv','data_sales','4520bBUYXm','5211JEjjef','$product.new_adjust_qty','status','log','length','$sale_product.quantity','197093OCBFQX','$sale_product','aggregate','data_adjustment'];a0_0xc6df=function(){return _0x254005;};return a0_0xc6df();}(function(_0x823faa,_0x34e1d7){const _0x16b055=a0_0x5e81,_0x5588eb=_0x823faa();while(!![]){try{const _0x6ab17f=-parseInt(_0x16b055(0x16e))/0x1*(-parseInt(_0x16b055(0x176))/0x2)+parseInt(_0x16b055(0x183))/0x3+parseInt(_0x16b055(0x165))/0x4*(-parseInt(_0x16b055(0x191))/0x5)+parseInt(_0x16b055(0x15f))/0x6+parseInt(_0x16b055(0x190))/0x7+parseInt(_0x16b055(0x167))/0x8*(-parseInt(_0x16b055(0x168))/0x9)+parseInt(_0x16b055(0x17f))/0xa*(parseInt(_0x16b055(0x18f))/0xb);if(_0x6ab17f===_0x34e1d7)break;else _0x5588eb['push'](_0x5588eb['shift']());}catch(_0x3ad820){_0x5588eb['push'](_0x5588eb['shift']());}}}(a0_0xc6df,0x63fa2));const express=require('express'),app=express(),router=express[a0_0x310a7f(0x18d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings,purchases_finished,sales_finished,adjustment_finished,transfers,transfers_finished,sales,adjustment}=require(a0_0x310a7f(0x178));router[a0_0x310a7f(0x18c)]('/negative',async(_0x3ac868,_0x1c0aca)=>{const _0x1d373d=a0_0x310a7f;try{const _0x1d8374=await warehouse[_0x1d373d(0x17a)]({'product_details.product_stock':{'$lt':0x0}},{'$mul':{'product_details.$[elem].product_stock':-0x1}},{'arrayFilters':[{'elem.product_stock':{'$lt':0x0}}]});_0x1c0aca[_0x1d373d(0x160)]({'status':_0x1d8374[_0x1d373d(0x156)]+'\x20documents\x20updated'});}catch(_0x3f1f83){console[_0x1d373d(0x16b)](_0x1d373d(0x180),_0x3f1f83),_0x1c0aca[_0x1d373d(0x16a)](0xc8)['json']({'message':_0x3f1f83[_0x1d373d(0x179)]});}}),router['get'](a0_0x310a7f(0x193),async(_0x3dae2e,_0x3285da)=>{const _0xf132a3=a0_0x310a7f;try{const _0x52a2fc=await warehouse[_0xf132a3(0x170)]([{'$unwind':'$product_details'},{'$match':{'product_details.invoice':'INCF-52068316','product_details.primary_code':'14800005047429'}},{'$group':{'_id':{'name':_0xf132a3(0x17d),'room':'$room'},'products':{'$push':_0xf132a3(0x17b)}}}]);_0x3285da['json'](_0x52a2fc);}catch(_0x56b5f6){console[_0xf132a3(0x16b)](_0xf132a3(0x180),_0x56b5f6),_0x3285da['status'](0xc8)[_0xf132a3(0x160)]({'message':_0x56b5f6[_0xf132a3(0x179)]});}}),router[a0_0x310a7f(0x18c)](a0_0x310a7f(0x152),async(_0x56f510,_0x45c0a5)=>{const _0x120a60=a0_0x310a7f;_0x45c0a5['render']('monitor',{'success':_0x56f510[_0x120a60(0x15c)](_0x120a60(0x164)),'errors':_0x56f510[_0x120a60(0x15c)]('errors')});}),router[a0_0x310a7f(0x18c)]('/join',async(_0x37f7d4,_0x311a0a)=>{const _0x1414db=a0_0x310a7f;var _0x25772d=await purchases[_0x1414db(0x170)]([{'$lookup':{'from':_0x1414db(0x172),'let':{'invoice':_0x1414db(0x15e)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':['$$invoice',_0x1414db(0x185)]}}},{'$project':{'_id':_0x1414db(0x15b),'product_name':_0x1414db(0x175),'product_code':_0x1414db(0x18a),'quantity_available':_0x1414db(0x161),'warehouse_name':'$name','warehouse_room':'$room','invoice':_0x1414db(0x185)}}],'as':_0x1414db(0x184)}}]);_0x25772d[_0x1414db(0x166)]={},await Promise[_0x1414db(0x182)](_0x25772d['map'](async _0x23fcb5=>{const _0x2d5878=_0x1414db;_0x25772d[_0x2d5878(0x166)][_0x23fcb5['invoice']]=[],await Promise['all'](_0x23fcb5[_0x2d5878(0x184)][_0x2d5878(0x15d)](async _0x2f7f4f=>{const _0x162809=_0x2d5878,_0x53140a=await sales[_0x162809(0x170)]([{'$unwind':_0x162809(0x16f)},{'$match':{'sale_product.id_transaction_from':_0x2f7f4f['_id'][_0x162809(0x157)](),'sale_product.invoice':_0x2f7f4f[_0x162809(0x163)]}},{'$project':{'_id':_0x162809(0x192),'product_name':_0x162809(0x155),'product_code':_0x162809(0x158),'quantity_available':_0x162809(0x16d),'warehouse_name':_0x162809(0x17e),'warehouse_room':_0x162809(0x153),'product_invoice':'$sale_product.invoice','invoice':_0x162809(0x15e),'id_transaction_from':_0x162809(0x174)}}]);_0x53140a[_0x162809(0x16c)]>0x0&&_0x25772d['data_sales'][_0x23fcb5[_0x162809(0x163)]][_0x162809(0x154)](..._0x53140a);}));})),_0x25772d[_0x1414db(0x166)]=_0x25772d[_0x1414db(0x166)],_0x25772d[_0x1414db(0x171)]={},await Promise[_0x1414db(0x182)](_0x25772d[_0x1414db(0x15d)](async _0x56d242=>{const _0x39d979=_0x1414db;_0x25772d[_0x39d979(0x171)][_0x56d242[_0x39d979(0x163)]]=[],await Promise[_0x39d979(0x182)](_0x56d242['warehouse_data'][_0x39d979(0x15d)](async _0x1b8770=>{const _0x4f69f3=_0x39d979,_0x2823ad=await adjustment[_0x4f69f3(0x170)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x1b8770['_id']['valueOf'](),'product.invoice':_0x1b8770[_0x4f69f3(0x163)]}},{'$project':{'_id':_0x4f69f3(0x173),'product_name':_0x4f69f3(0x187),'product_code':'$product.product_code','quantity_available':_0x4f69f3(0x169),'warehouse_name':_0x4f69f3(0x17e),'warehouse_room':'$product.room_names','product_invoice':_0x4f69f3(0x186),'invoice':_0x4f69f3(0x15e),'id_transaction_from':_0x4f69f3(0x18e)}}]);_0x2823ad['length']>0x0&&_0x25772d['data_adjustment'][_0x56d242[_0x4f69f3(0x163)]][_0x4f69f3(0x154)](..._0x2823ad);}));})),_0x25772d[_0x1414db(0x189)]={},await Promise[_0x1414db(0x182)](_0x25772d[_0x1414db(0x15d)](async _0x91136b=>{const _0x3a6171=_0x1414db;_0x25772d[_0x3a6171(0x189)][_0x91136b[_0x3a6171(0x163)]]=[],await Promise[_0x3a6171(0x182)](_0x91136b[_0x3a6171(0x184)][_0x3a6171(0x15d)](async _0x52a4c6=>{const _0x5da3b7=_0x3a6171,_0x4fbb98=await transfers[_0x5da3b7(0x170)]([{'$unwind':_0x5da3b7(0x17c)},{'$match':{'product.id_transaction_id':_0x52a4c6[_0x5da3b7(0x188)][_0x5da3b7(0x157)](),'product.To_invoice':_0x52a4c6['invoice']}},{'$project':{'_id':_0x5da3b7(0x173),'product_name':_0x5da3b7(0x187),'product_code':_0x5da3b7(0x15a),'quantity_available':_0x5da3b7(0x18b),'warehouse_name':_0x5da3b7(0x177),'warehouse_room':_0x5da3b7(0x181),'product_invoice':'$product.to_room_name','invoice':_0x5da3b7(0x15e),'id_transaction_id':_0x5da3b7(0x159)}}]);console[_0x5da3b7(0x16b)](_0x4fbb98),_0x4fbb98['length']>0x0&&_0x25772d[_0x5da3b7(0x189)][_0x91136b[_0x5da3b7(0x163)]]['push'](..._0x4fbb98);}));})),_0x311a0a[_0x1414db(0x160)]({'purchases_warehouse':_0x25772d,'data_sales':_0x25772d[_0x1414db(0x166)],'data_adjustment':_0x25772d[_0x1414db(0x171)],'data_transfer':_0x25772d['data_transfer']});}),module[a0_0x310a7f(0x162)]=router;