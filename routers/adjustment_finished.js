var a0_0x567c4e=a0_0x9f62;(function(_0x2a072d,_0x3d9669){var _0x176d40=a0_0x9f62,_0x2fd764=_0x2a072d();while(!![]){try{var _0x548b64=-parseInt(_0x176d40(0x1eb))/0x1*(-parseInt(_0x176d40(0x25a))/0x2)+-parseInt(_0x176d40(0x1f6))/0x3*(parseInt(_0x176d40(0x1f1))/0x4)+parseInt(_0x176d40(0x21a))/0x5*(-parseInt(_0x176d40(0x25f))/0x6)+parseInt(_0x176d40(0x20e))/0x7*(parseInt(_0x176d40(0x20a))/0x8)+-parseInt(_0x176d40(0x227))/0x9+parseInt(_0x176d40(0x294))/0xa+-parseInt(_0x176d40(0x1e5))/0xb*(parseInt(_0x176d40(0x232))/0xc);if(_0x548b64===_0x3d9669)break;else _0x2fd764['push'](_0x2fd764['shift']());}catch(_0x2ea359){_0x2fd764['push'](_0x2fd764['shift']());}}}(a0_0x3d70,0x8199a));const express=require(a0_0x567c4e(0x265)),app=express(),router=express['Router'](),auth=require(a0_0x567c4e(0x28b)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x567c4e(0x233)),users=require(a0_0x567c4e(0x268)),nodemailer=require(a0_0x567c4e(0x26f));function a0_0x9f62(_0x322335,_0x316faa){var _0x3d7087=a0_0x3d70();return a0_0x9f62=function(_0x9f6266,_0x10a6c7){_0x9f6266=_0x9f6266-0x1d1;var _0x22625b=_0x3d7087[_0x9f6266];return _0x22625b;},a0_0x9f62(_0x322335,_0x316faa);}function a0_0x3d70(){var _0x231dc2=['status','$product_details.product_code','New_Qty_Converted','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','all','errors','product','<h2>\x20','</head><body>','<h5>','<span\x20style=\x22float:\x20right;\x22>','Rooms','/view/:id','ADJF-','Portuguese','Spanish','findById','body','$name','render','date','/view/add_adjustment','</tr>','/view','warehouse_name','299057KPysqJ','Chinese','map','<table\x20style=\x22width:\x20100%\x20!important;\x22>','French','$product.room_names','1JRyQjS','user','</td>','finalize','Hindi','exports','1436StlhGw','sendMail','logo','secondary_unit','Ambient','4029JIbCyk','minus','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','length','\x20Order\x20Number\x20:\x20','master','warehouse','<strong>\x20Regards\x20</strong>','$product_details.bin','padStart','$product_details.rack','$product_details.product_name','$product_details.unit','product_stock','purchases_data','$product.product_name','</body></html>','$product_details.secondary_unit','True','role','248Wshojb','get','prod_invoice','$product_details.primary_code','145411MtxjvH','$product_details.production_date','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','Return\x20Rooms','/picking_list/PDF_adjustment/','new_adjust_qty','catch','save','batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','</h5>','3168895pCFxmH','$warehouse_name','toString','/../public','edit_adjustment_finished_view','$product_details.secondary_code','Error\x20Occurs','product_details','$product_details.expiry_date','$product_details.maxPerUnit','adjustment\x20data\x20update\x20successfully','JO_number','$product_details.floorlevel','2327769VPKHaQ','success','/CheckingWarehouse','</table>','Primary_Units','\x20</h2>','prod_cat','foreach\x20newproduct','edit_adjustment_finished','$product_details.bay','Logo.png','132ZyVTuc','../models/all_models','$product_details.maxProducts','</div>','back','$_id','params','invoice','DRY\x20GOODS','$product_details.batch_code','types','then','flash','room_names','English','New_Qty_Converted_adj','aggregate','/preview/:id','filter','Adjustment\x20Mail','staff','room','post','$product_details.product_stock','/barcode_scanner','message','<hr\x20class=\x22my-3\x22>','English\x20(US)','$product_details.storage','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.type','language','host','bay','An\x20error\x20occurred\x20while\x20saving\x20data.','</tbody>','getMonth','stock','<h5\x20style=\x22text-align:\x20left;\x22>','forEach','1078996BEpcoU','prod_code','German','password','expiry_date','6ouxGoX','redirect','Arabic','/adjustment/view','floor','FGSEmail','express','production_date','Arabic\x20(ae)','../public/language/languages.json','level','Adjustment\x20Finalize\x20Successfully','unit','getDate','Enabled','getFullYear','nodemailer','email','$product_details','adjust_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$room','Portuguese\x20(BR)','Enclosed','prod_name','maxPerUnit','<div>','Finished\x20Goods','\x20Order\x20Date\x20:\x20','/upload/','push','Secondary_units','</span>','note','<tr>','$product','$product_details._id','product_name','find','string','json','An\x20error\x20occurred.','createTransport','stockBefore','../middleware/auth','QA\x20Warehouse','split','error','$invoice','<html><head><title></title>','slice','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','10209950YRsaEi','adjustment_finished','log','findOne'];a0_0x3d70=function(){return _0x231dc2;};return a0_0x3d70();}router[a0_0x567c4e(0x20b)](a0_0x567c4e(0x1e3),auth,async(_0x58eb4a,_0x4014f0)=>{var _0x167799=a0_0x567c4e;try{const {username:_0x58ea86,email:_0x596b49,role:_0x5a4abc}=_0x58eb4a[_0x167799(0x1ec)],_0x28fa4f=_0x58eb4a['user'],_0x3f8e61=await profile['findOne']({'email':_0x28fa4f[_0x167799(0x270)]}),_0xca52df=await master_shop['find']();let _0x13b01f;if(_0x28fa4f['role']==_0x167799(0x246)){const _0x37563e=await staff[_0x167799(0x297)]({'email':_0x28fa4f['email']});_0x13b01f=await warehouse['find']({'status':_0x167799(0x26d),'name':_0x37563e['warehouse']});}else _0x13b01f=await warehouse[_0x167799(0x285)]({'status':_0x167799(0x26d)});const _0x279124=await product[_0x167799(0x285)]();let _0x2d6088;if(_0x28fa4f[_0x167799(0x209)]==_0x167799(0x246)){const _0x11f02c=await staff['findOne']({'email':_0x28fa4f[_0x167799(0x270)]});_0x2d6088=await adjustment_finished[_0x167799(0x285)]({'warehouse_name':_0x11f02c[_0x167799(0x1fc)]});}else _0x2d6088=await adjustment_finished[_0x167799(0x242)]([{'$unwind':_0x167799(0x282)},{'$group':{'_id':_0x167799(0x237),'invoice':{'$first':_0x167799(0x28f)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x167799(0x21b)},'room':{'$addToSet':_0x167799(0x1ea)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0xca52df[0x0][_0x167799(0x251)]==_0x167799(0x24d)){var _0x4ecce9=users[_0x167799(0x240)];console['log'](_0x4ecce9);}else{if(_0xca52df[0x0][_0x167799(0x251)]=='Hindi')var _0x4ecce9=users[_0x167799(0x1ef)];else{if(_0xca52df[0x0]['language']==_0x167799(0x25c))var _0x4ecce9=users[_0x167799(0x25c)];else{if(_0xca52df[0x0][_0x167799(0x251)]=='Spanish')var _0x4ecce9=users['Spanish'];else{if(_0xca52df[0x0][_0x167799(0x251)]==_0x167799(0x1e9))var _0x4ecce9=users['French'];else{if(_0xca52df[0x0][_0x167799(0x251)]==_0x167799(0x275))var _0x4ecce9=users['Portuguese'];else{if(_0xca52df[0x0][_0x167799(0x251)]==_0x167799(0x1e6))var _0x4ecce9=users['Chinese'];else{if(_0xca52df[0x0][_0x167799(0x251)]==_0x167799(0x267))var _0x4ecce9=users['Arabic'];}}}}}}}_0x4014f0[_0x167799(0x1df)](_0x167799(0x295),{'success':_0x58eb4a[_0x167799(0x23e)](_0x167799(0x228)),'errors':_0x58eb4a[_0x167799(0x23e)](_0x167799(0x1d1)),'role':_0x28fa4f,'profile':_0x3f8e61,'warehouse':_0x13b01f,'product':_0x279124,'adjustment':_0x2d6088,'master_shop':_0xca52df,'language':_0x4ecce9});}catch(_0x2e6144){console['log'](_0x2e6144);}});async function getRandom8DigitNumber(){var _0x36045a=a0_0x567c4e;const _0x39cbfe=0x989680,_0x3fbdb4=0x5f5e0ff,_0x57bba6=Math[_0x36045a(0x263)](Math['random']()*(_0x3fbdb4-_0x39cbfe+0x1))+_0x39cbfe;var _0x5b70b4;const _0x198b5f=await adjustment_finished[_0x36045a(0x297)]({'invoice':'ADJF-'+_0x57bba6});return _0x198b5f&&_0x198b5f[_0x36045a(0x1f9)]>0x0?_0x5b70b4=_0x36045a(0x1d9)+_0x57bba6:_0x5b70b4=_0x36045a(0x1d9)+_0x57bba6,_0x5b70b4;}router['get'](a0_0x567c4e(0x1e1),auth,async(_0x383886,_0x1136f4)=>{var _0x5df5c4=a0_0x567c4e;try{const {username:_0x85a941,email:_0x5a7cb9,role:_0x5bf7d7}=_0x383886[_0x5df5c4(0x1ec)],_0x85bd31=_0x383886[_0x5df5c4(0x1ec)],_0x29c495=await profile[_0x5df5c4(0x297)]({'email':_0x85bd31[_0x5df5c4(0x270)]}),_0x370bc3=await master_shop['find']();let _0x524f54;if(_0x85bd31[_0x5df5c4(0x209)]==_0x5df5c4(0x246)){const _0x330a93=await staff[_0x5df5c4(0x297)]({'email':_0x85bd31[_0x5df5c4(0x270)]});_0x524f54=await warehouse[_0x5df5c4(0x242)]([{'$match':{'status':'Enabled','name':_0x330a93[_0x5df5c4(0x1fc)],'warehouse_category':_0x5df5c4(0x27a),'name':{'$ne':_0x5df5c4(0x28c)}}},{'$group':{'_id':_0x5df5c4(0x1de),'name':{'$first':'$name'}}}]);}else _0x524f54=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods','name':{'$ne':_0x5df5c4(0x28c)}}},{'$group':{'_id':'$name','name':{'$first':_0x5df5c4(0x1de)}}}]);const _0x11e088=await product[_0x5df5c4(0x285)]({}),_0xc64411=await adjustment_finished['find']({}),_0x2e4610=_0xc64411[_0x5df5c4(0x1f9)]+0x1,_0x1170af=_0x5df5c4(0x1d9)+_0x2e4610[_0x5df5c4(0x21c)]()[_0x5df5c4(0x1ff)](0x5,'0');var _0xdf068a=[_0x5df5c4(0x1f5),_0x5df5c4(0x276),_0x5df5c4(0x211)];if(_0x370bc3[0x0][_0x5df5c4(0x251)]==_0x5df5c4(0x24d))var _0x21f7ec=users['English'];else{if(_0x370bc3[0x0][_0x5df5c4(0x251)]=='Hindi')var _0x21f7ec=users[_0x5df5c4(0x1ef)];else{if(_0x370bc3[0x0][_0x5df5c4(0x251)]==_0x5df5c4(0x25c))var _0x21f7ec=users[_0x5df5c4(0x25c)];else{if(_0x370bc3[0x0]['language']==_0x5df5c4(0x1db))var _0x21f7ec=users[_0x5df5c4(0x1db)];else{if(_0x370bc3[0x0]['language']==_0x5df5c4(0x1e9))var _0x21f7ec=users[_0x5df5c4(0x1e9)];else{if(_0x370bc3[0x0][_0x5df5c4(0x251)]=='Portuguese\x20(BR)')var _0x21f7ec=users[_0x5df5c4(0x1da)];else{if(_0x370bc3[0x0][_0x5df5c4(0x251)]==_0x5df5c4(0x1e6))var _0x21f7ec=users[_0x5df5c4(0x1e6)];else{if(_0x370bc3[0x0][_0x5df5c4(0x251)]==_0x5df5c4(0x267))var _0x21f7ec=users['Arabic'];}}}}}}}const _0x29add0=getRandom8DigitNumber();_0x29add0['then'](_0x15cdd5=>{var _0x57cfd4=_0x5df5c4;_0x1136f4[_0x57cfd4(0x1df)]('add_adjustment_finished',{'success':_0x383886[_0x57cfd4(0x23e)](_0x57cfd4(0x228)),'errors':_0x383886[_0x57cfd4(0x23e)]('errors'),'role':_0x85bd31,'profile':_0x29c495,'warehouse':_0x524f54,'product':_0x11e088,'master_shop':_0x370bc3,'language':_0x21f7ec,'rooms_data':_0xdf068a,'invoice_no':_0x15cdd5});})[_0x5df5c4(0x214)](_0x31e60a=>{var _0x51f5c6=_0x5df5c4;_0x383886[_0x51f5c6(0x23e)](_0x51f5c6(0x1d1),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x1136f4[_0x51f5c6(0x260)](_0x51f5c6(0x262));});}catch(_0x25cfd0){console[_0x5df5c4(0x296)](_0x25cfd0);}}),router['post']('/view/add_adjustment',auth,async(_0xdb743f,_0x5ed93a)=>{var _0xfd93=a0_0x567c4e;try{const {warehouse_name:_0x1a71ba,date:_0x545e12,prod_name:_0x249ef2,level:_0x15b915,isle:_0x415418,pallet:_0x6f6cae,stock:_0x1c9bf9,types:_0x291c4c,adjust_qty:_0xa0d8e6,new_adjust_qty:_0x164c7b,note:_0x2b99b5,Room_name:_0xc6b176,invoice:_0x4488a5,JO_number:_0x3836e4,expiry_date:_0x7f0bcf}=_0xdb743f[_0xfd93(0x1dd)];if(typeof _0x249ef2==_0xfd93(0x286))var _0x19f5a9=[_0xdb743f['body']['prod_name']],_0x1dcdc3=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x269)]],_0x48ce11=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x257)]],_0x32e10c=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x23c)]],_0x31ac92=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x241)]],_0x337af7=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x29a)]],_0x13ec11=[_0xdb743f[_0xfd93(0x1dd)]['Primary_Units']],_0x29be2d=[_0xdb743f['body']['Secondary_units']],_0x297d81=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x25b)]],_0x584fce=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x216)]],_0x1a92ab=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x25e)]],_0x43d466=[_0xdb743f[_0xfd93(0x1dd)]['product_date']],_0x13f36f=[_0xdb743f['body'][_0xfd93(0x22d)]],_0x5d01d1=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x1d7)]],_0x2d368c=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x278)]],_0x36a298=[_0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x20c)]];else var _0x19f5a9=[..._0xdb743f['body'][_0xfd93(0x277)]],_0x1dcdc3=[..._0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x269)]],_0x48ce11=[..._0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x257)]],_0x32e10c=[..._0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x23c)]],_0x31ac92=[..._0xdb743f['body']['New_Qty_Converted_adj']],_0x337af7=[..._0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x29a)]],_0x13ec11=[..._0xdb743f['body'][_0xfd93(0x22b)]],_0x29be2d=[..._0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x27e)]],_0x297d81=[..._0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x25b)]],_0x584fce=[..._0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x216)]],_0x1a92ab=[..._0xdb743f['body'][_0xfd93(0x25e)]],_0x43d466=[..._0xdb743f['body']['product_date']],_0x13f36f=[..._0xdb743f['body'][_0xfd93(0x22d)]],_0x5d01d1=[..._0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x1d7)]],_0x2d368c=[..._0xdb743f['body'][_0xfd93(0x278)]],_0x36a298=[..._0xdb743f[_0xfd93(0x1dd)][_0xfd93(0x20c)]];const _0x458085=_0x19f5a9[_0xfd93(0x1e7)](_0x565ebd=>{return _0x565ebd={'product_name':_0x565ebd};});_0x1dcdc3[_0xfd93(0x259)]((_0x59d92f,_0x24debb)=>{_0x458085[_0x24debb]['bay']=_0x59d92f;}),_0x48ce11[_0xfd93(0x259)]((_0x1e002b,_0x15d565)=>{var _0x1849b3=_0xfd93;_0x458085[_0x15d565][_0x1849b3(0x28a)]=_0x1e002b;}),_0x32e10c[_0xfd93(0x259)]((_0x4b6d66,_0x234921)=>{var _0x50c668=_0xfd93;_0x458085[_0x234921][_0x50c668(0x23c)]=_0x4b6d66;}),_0x31ac92['forEach']((_0x156e99,_0x1b3771)=>{var _0x12e4ad=_0xfd93;_0x458085[_0x1b3771][_0x12e4ad(0x272)]=_0x156e99;}),_0x337af7[_0xfd93(0x259)]((_0x29329e,_0x1eab63)=>{_0x458085[_0x1eab63]['new_adjust_qty']=_0x29329e;}),_0x13ec11[_0xfd93(0x259)]((_0xc849cc,_0xdeb8ff)=>{var _0x3ab5c7=_0xfd93;_0x458085[_0xdeb8ff][_0x3ab5c7(0x26b)]=_0xc849cc;}),_0x29be2d['forEach']((_0x570765,_0x1ecbb4)=>{var _0x4707f0=_0xfd93;_0x458085[_0x1ecbb4][_0x4707f0(0x1f4)]=_0x570765;}),_0x297d81[_0xfd93(0x259)]((_0x551e13,_0xbbc2e3)=>{_0x458085[_0xbbc2e3]['product_code']=_0x551e13;}),_0x584fce['forEach']((_0x37b0ee,_0x33c4d5)=>{var _0x5f4659=_0xfd93;_0x458085[_0x33c4d5][_0x5f4659(0x216)]=_0x37b0ee;}),_0x1a92ab[_0xfd93(0x259)]((_0x5a3454,_0x56462f)=>{_0x458085[_0x56462f]['expiry_date']=_0x5a3454;}),_0x43d466[_0xfd93(0x259)]((_0x3eb64f,_0x2c0e07)=>{var _0x5b3f8c=_0xfd93;_0x458085[_0x2c0e07][_0x5b3f8c(0x266)]=_0x3eb64f;}),_0x13f36f['forEach']((_0x5155e1,_0x1bd156)=>{_0x458085[_0x1bd156]['prod_cat']=_0x5155e1;}),_0x5d01d1[_0xfd93(0x259)]((_0x4d00d3,_0x3930b9)=>{_0x458085[_0x3930b9]['room_names']=_0x4d00d3;}),_0x2d368c['forEach']((_0x32169c,_0x2537cd)=>{var _0x2269f7=_0xfd93;_0x458085[_0x2537cd][_0x2269f7(0x278)]=_0x32169c;}),_0x36a298[_0xfd93(0x259)]((_0x357ee5,_0x145709)=>{var _0x120847=_0xfd93;_0x458085[_0x145709][_0x120847(0x239)]=_0x357ee5;});const _0x5a12d0=_0x458085[_0xfd93(0x244)](_0x5030dd=>_0x5030dd[_0xfd93(0x272)]!=='0'&&_0x5030dd[_0xfd93(0x272)]!=='');var _0x27e4cc=0x0;_0x5a12d0['forEach'](_0x508377=>{var _0x11bd2a=_0xfd93;console[_0x11bd2a(0x296)](_0x11bd2a(0x22e),_0x508377),parseInt(_0x508377[_0x11bd2a(0x272)])<=0x0&&_0x27e4cc++;});if(_0x27e4cc!=0x0)return _0xdb743f['flash']('errors',_0xfd93(0x210)),_0x5ed93a[_0xfd93(0x260)](_0xfd93(0x236));const _0x399f6e=new adjustment_finished({'warehouse_name':_0x1a71ba,'date':_0x545e12,'product':_0x5a12d0,'note':_0x2b99b5,'room':_0xc6b176,'invoice':_0x4488a5,'JO_number':_0x3836e4,'expiry_date':_0x7f0bcf}),_0x4191cd=await _0x399f6e[_0xfd93(0x215)]();_0xdb743f[_0xfd93(0x23e)]('success','adjustment\x20add\x20successfull'),_0x5ed93a['redirect']('/adjustment_finished/preview/'+_0x4191cd['_id']);}catch(_0x31c836){console['log'](_0x31c836),_0x5ed93a['status'](0xc8)['json']({'message':_0x31c836[_0xfd93(0x24b)]});}}),router[a0_0x567c4e(0x20b)](a0_0x567c4e(0x243),auth,async(_0x39ed07,_0x38e472)=>{var _0x3aa0f3=a0_0x567c4e;try{const {username:_0x522b68,email:_0x34b850,role:_0x63b314}=_0x39ed07[_0x3aa0f3(0x1ec)],_0x1f53e9=_0x39ed07[_0x3aa0f3(0x1ec)],_0x70539f=await profile['findOne']({'email':_0x1f53e9[_0x3aa0f3(0x270)]}),_0x1b9974=await master_shop[_0x3aa0f3(0x285)](),_0x4bb976=_0x39ed07['params']['id'],_0x1f7696=await adjustment_finished[_0x3aa0f3(0x1dc)]({'_id':_0x4bb976}),_0x35e1d8=await purchases[_0x3aa0f3(0x242)]([{'$match':{'warehouse_name':_0x1f7696['warehouse_name']}},{'$unwind':_0x3aa0f3(0x282)},{'$group':{'_id':_0x3aa0f3(0x205)}}]);console[_0x3aa0f3(0x296)](_0x3aa0f3(0x204),_0x35e1d8);const _0x3e7b34=await product[_0x3aa0f3(0x285)]({}),_0xeefdd8=await warehouse[_0x3aa0f3(0x242)]([{'$match':{'name':_0x1f7696[_0x3aa0f3(0x1e4)],'warehouse_category':_0x3aa0f3(0x27a)}},{'$unwind':_0x3aa0f3(0x271)},{'$group':{'_id':_0x3aa0f3(0x283),'name':{'$first':_0x3aa0f3(0x201)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3aa0f3(0x250)},'floorlevel':{'$first':_0x3aa0f3(0x226)},'primary_code':{'$first':_0x3aa0f3(0x20d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3aa0f3(0x299)},'storage':{'$first':_0x3aa0f3(0x24e)},'rack':{'$first':_0x3aa0f3(0x200)},'expiry_date':{'$first':_0x3aa0f3(0x222)},'production_date':{'$first':_0x3aa0f3(0x20f)},'batch_code':{'$first':_0x3aa0f3(0x23b)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':_0x3aa0f3(0x274)}}}]);if(_0x1b9974[0x0][_0x3aa0f3(0x251)]==_0x3aa0f3(0x24d)){var _0x5222c1=users['English'];console[_0x3aa0f3(0x296)](_0x5222c1);}else{if(_0x1b9974[0x0][_0x3aa0f3(0x251)]==_0x3aa0f3(0x1ef))var _0x5222c1=users[_0x3aa0f3(0x1ef)];else{if(_0x1b9974[0x0][_0x3aa0f3(0x251)]==_0x3aa0f3(0x25c))var _0x5222c1=users[_0x3aa0f3(0x25c)];else{if(_0x1b9974[0x0][_0x3aa0f3(0x251)]==_0x3aa0f3(0x1db))var _0x5222c1=users['Spanish'];else{if(_0x1b9974[0x0][_0x3aa0f3(0x251)]==_0x3aa0f3(0x1e9))var _0x5222c1=users['French'];else{if(_0x1b9974[0x0][_0x3aa0f3(0x251)]=='Portuguese\x20(BR)')var _0x5222c1=users[_0x3aa0f3(0x1da)];else{if(_0x1b9974[0x0][_0x3aa0f3(0x251)]==_0x3aa0f3(0x1e6))var _0x5222c1=users[_0x3aa0f3(0x1e6)];else{if(_0x1b9974[0x0][_0x3aa0f3(0x251)]=='Arabic\x20(ae)')var _0x5222c1=users[_0x3aa0f3(0x261)];}}}}}}}_0x38e472[_0x3aa0f3(0x1df)](_0x3aa0f3(0x21e),{'success':_0x39ed07[_0x3aa0f3(0x23e)]('success'),'errors':_0x39ed07[_0x3aa0f3(0x23e)](_0x3aa0f3(0x1d1)),'role':_0x1f53e9,'profile':_0x70539f,'adjustment':_0x1f7696,'stock':_0xeefdd8,'master_shop':_0x1b9974,'warehouse_name':_0x35e1d8,'unit':_0x3e7b34,'language':_0x5222c1});}catch(_0x133082){console[_0x3aa0f3(0x296)](_0x133082),_0x38e472[_0x3aa0f3(0x298)](0xc8)[_0x3aa0f3(0x287)]({'message':_0x133082[_0x3aa0f3(0x24b)]});}}),router[a0_0x567c4e(0x248)](a0_0x567c4e(0x243),auth,async(_0x2e382e,_0x53a36d)=>{var _0x3a7972=a0_0x567c4e;try{const {invoice:_0x4b4952,warehouse_name:_0xe6f2dd,Room_name:_0x5170e5}=_0x2e382e[_0x3a7972(0x1dd)],_0x1f4eed=_0x2e382e[_0x3a7972(0x238)]['id'],_0x37a527=await adjustment_finished[_0x3a7972(0x1dc)]({'_id':_0x1f4eed});var _0x199f14;const _0x4977d0=_0x37a527['product'][_0x3a7972(0x1e7)](async _0xe63f01=>{var _0x9d9a69=_0x3a7972;if(_0xe63f01[_0x9d9a69(0x272)]>0x0){_0x199f14=await warehouse[_0x9d9a69(0x297)]({'name':_0xe6f2dd,'room':_0xe63f01['room_names'],'warehouse_category':_0x9d9a69(0x27a)});const _0x5bfd4f=_0x199f14[_0x9d9a69(0x221)]['map'](_0x42ca57=>{var _0x6e06db=_0x9d9a69;console[_0x6e06db(0x296)](_0xe63f01[_0x6e06db(0x23c)]);if(_0xe63f01[_0x6e06db(0x23c)]=='minus')_0x42ca57[_0x6e06db(0x284)]==_0xe63f01[_0x6e06db(0x284)]&&_0x42ca57[_0x6e06db(0x253)]==_0xe63f01['bay']&&_0x42ca57['expiry_date']==_0xe63f01[_0x6e06db(0x25e)]&&_0x42ca57['production_date']==_0xe63f01[_0x6e06db(0x266)]&&_0x42ca57[_0x6e06db(0x216)]==_0xe63f01[_0x6e06db(0x216)]&&_0x42ca57['invoice']==_0xe63f01[_0x6e06db(0x239)]&&(_0x42ca57['product_stock']=_0x42ca57['product_stock']-_0xe63f01['adjust_qty']);else _0xe63f01[_0x6e06db(0x23c)]=='add'&&(_0x42ca57[_0x6e06db(0x284)]==_0xe63f01[_0x6e06db(0x284)]&&_0x42ca57[_0x6e06db(0x253)]==_0xe63f01[_0x6e06db(0x253)]&&_0x42ca57[_0x6e06db(0x25e)]==_0xe63f01['expiry_date']&&_0x42ca57['production_date']==_0xe63f01[_0x6e06db(0x266)]&&_0x42ca57[_0x6e06db(0x216)]==_0xe63f01[_0x6e06db(0x216)]&&_0x42ca57[_0x6e06db(0x239)]==_0xe63f01['invoice']&&(_0x42ca57[_0x6e06db(0x203)]=_0x42ca57[_0x6e06db(0x203)]+_0xe63f01[_0x6e06db(0x272)]));});}return _0x199f14;});Promise[_0x3a7972(0x29c)](_0x4977d0)[_0x3a7972(0x23d)](async _0x12feed=>{var _0x1a5128=_0x3a7972;try{for(const _0x2b6a17 of _0x12feed){await _0x2b6a17[_0x1a5128(0x215)]();}_0x37a527[_0x1a5128(0x1ee)]=_0x1a5128(0x208);const _0x2428b8=await _0x37a527['save'](),_0x4574ab=await master_shop[_0x1a5128(0x285)](),_0x5a59bd=await email_settings[_0x1a5128(0x297)](),_0x441e6f=await supervisor_settings['find']();var _0x9bfae0=_0x37a527[_0x1a5128(0x1d2)],_0x534552='',_0x4c87b6;for(_0x4c87b6 in _0x9bfae0){var _0x4aa8c0='FG';_0x37a527['warehouse_name']==_0x1a5128(0x23a)&&(_0x4aa8c0='DG'),_0x534552+='<tr>'+_0x1a5128(0x1f8)+_0x9bfae0[_0x4c87b6][_0x1a5128(0x284)]+_0x1a5128(0x1ed)+_0x1a5128(0x1f8)+_0x9bfae0[_0x4c87b6]['product_code']+'</td>'+_0x1a5128(0x1f8)+_0x9bfae0[_0x4c87b6]['adjust_qty']+_0x1a5128(0x1ed)+_0x1a5128(0x1f8)+_0x9bfae0[_0x4c87b6][_0x1a5128(0x26b)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9bfae0[_0x4c87b6][_0x1a5128(0x1f4)]+_0x1a5128(0x1ed)+_0x1a5128(0x1f8)+_0x37a527[_0x1a5128(0x1e4)]+_0x1a5128(0x1ed)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9bfae0[_0x4c87b6][_0x1a5128(0x23f)]+'</td>'+_0x1a5128(0x1f8)+_0x4aa8c0+_0x9bfae0[_0x4c87b6][_0x1a5128(0x253)]+_0x1a5128(0x1ed)+'</tr>';}let _0x11e348=nodemailer[_0x1a5128(0x289)]({'host':_0x5a59bd[_0x1a5128(0x252)],'port':Number(_0x5a59bd['port']),'secure':![],'auth':{'user':_0x5a59bd[_0x1a5128(0x270)],'pass':_0x5a59bd[_0x1a5128(0x25d)]}}),_0x5dbb42={'from':_0x5a59bd['email'],'to':_0x441e6f[0x0][_0x1a5128(0x264)],'subject':_0x1a5128(0x245),'attachments':[{'filename':_0x1a5128(0x231),'path':__dirname+_0x1a5128(0x21d)+_0x1a5128(0x27c)+_0x4574ab[0x0]['image'],'cid':_0x1a5128(0x1f3)}],'html':'<!DOCTYPE\x20html>'+_0x1a5128(0x290)+_0x1a5128(0x1d4)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x1a5128(0x292)+_0x1a5128(0x235)+'<div>'+_0x1a5128(0x1d3)+_0x4574ab[0x0]['site_title']+_0x1a5128(0x22c)+_0x1a5128(0x235)+'</div>'+_0x1a5128(0x24c)+_0x1a5128(0x279)+_0x1a5128(0x258)+_0x1a5128(0x1fa)+_0x37a527['invoice']+'\x20'+_0x1a5128(0x1d6)+_0x1a5128(0x27b)+_0x37a527[_0x1a5128(0x1e0)]+'\x20'+_0x1a5128(0x27f)+_0x1a5128(0x219)+_0x1a5128(0x235)+_0x1a5128(0x1e8)+_0x1a5128(0x24f)+_0x1a5128(0x281)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x1a5128(0x217)+_0x1a5128(0x273)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x1a5128(0x293)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x1a5128(0x218)+_0x1a5128(0x29b)+_0x1a5128(0x1e2)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x534552+'\x20'+_0x1a5128(0x255)+_0x1a5128(0x22a)+'<div>'+_0x1a5128(0x1fd)+_0x1a5128(0x1d5)+_0x4574ab[0x0]['site_title']+'</h5>'+'</div>'+_0x1a5128(0x235)+_0x1a5128(0x206)};_0x11e348[_0x1a5128(0x1f2)](_0x5dbb42,function(_0x2dc715,_0x21e3c2){var _0x1170e0=_0x1a5128;_0x2dc715?(console[_0x1170e0(0x296)](_0x2dc715),console['log'](_0x1170e0(0x220))):console['log']('Email\x20sent\x20successfully');}),_0x2e382e['flash'](_0x1a5128(0x228),_0x1a5128(0x26a)),_0x53a36d[_0x1a5128(0x260)](_0x1a5128(0x212)+_0x2428b8['_id']);}catch(_0xbdeded){console[_0x1a5128(0x28e)](_0xbdeded),_0x53a36d[_0x1a5128(0x298)](0x1f4)[_0x1a5128(0x287)]({'error':_0x1a5128(0x254)});}})[_0x3a7972(0x214)](_0x33d78c=>{var _0x9b2e2a=_0x3a7972;console['error'](_0x33d78c),_0x53a36d['status'](0x1f4)['json']({'error':_0x9b2e2a(0x288)});});}catch(_0x45b634){_0x53a36d['json']({'message':_0x45b634[_0x3a7972(0x24b)]});}}),router[a0_0x567c4e(0x20b)]('/view/:id',auth,async(_0x1206e0,_0x42dbdb)=>{var _0x34e4b5=a0_0x567c4e;try{const {username:_0x4cfbaf,email:_0x4a8720,role:_0x30561e}=_0x1206e0['user'],_0x4cbef7=_0x1206e0[_0x34e4b5(0x1ec)],_0x198366=await profile[_0x34e4b5(0x297)]({'email':_0x4cbef7[_0x34e4b5(0x270)]}),_0x4c13b9=await master_shop[_0x34e4b5(0x285)]();console[_0x34e4b5(0x296)](_0x34e4b5(0x1fb),_0x4c13b9);const _0x4bb0a0=_0x1206e0[_0x34e4b5(0x238)]['id'],_0x3bacb3=await adjustment_finished['findById']({'_id':_0x4bb0a0});let _0x4838eb=new Date(_0x3bacb3[_0x34e4b5(0x25e)]),_0x228535=('0'+_0x4838eb[_0x34e4b5(0x26c)]())['slice'](-0x2),_0x5234c8=('0'+(_0x4838eb[_0x34e4b5(0x256)]()+0x1))[_0x34e4b5(0x291)](-0x2),_0x44ca27=_0x4838eb[_0x34e4b5(0x26e)](),_0x4f5096=_0x44ca27+'-'+_0x5234c8+'-'+_0x228535;var _0xf09817=[_0x34e4b5(0x1f5),_0x34e4b5(0x276),_0x34e4b5(0x211)];const _0x243bb8=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3bacb3[_0x34e4b5(0x1e4)]}},{'$unwind':_0x34e4b5(0x282)},{'$group':{'_id':_0x34e4b5(0x205)}}]);console[_0x34e4b5(0x296)](_0x34e4b5(0x204),_0x243bb8);const _0x41a662=await product[_0x34e4b5(0x285)]({}),_0x4907af=await warehouse[_0x34e4b5(0x242)]([{'$match':{'name':_0x3bacb3['warehouse_name'],'room':_0x3bacb3[_0x34e4b5(0x247)]}},{'$unwind':_0x34e4b5(0x271)},{'$group':{'_id':_0x34e4b5(0x283),'name':{'$first':_0x34e4b5(0x201)},'product_stock':{'$first':_0x34e4b5(0x249)},'bay':{'$first':_0x34e4b5(0x230)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x34e4b5(0x250)},'floorlevel':{'$first':_0x34e4b5(0x226)},'primary_code':{'$first':_0x34e4b5(0x20d)},'secondary_code':{'$first':_0x34e4b5(0x21f)},'product_code':{'$first':_0x34e4b5(0x299)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x34e4b5(0x200)}}}]);if(_0x4c13b9[0x0][_0x34e4b5(0x251)]==_0x34e4b5(0x24d)){var _0x3335ab=users[_0x34e4b5(0x240)];console[_0x34e4b5(0x296)](_0x3335ab);}else{if(_0x4c13b9[0x0]['language']==_0x34e4b5(0x1ef))var _0x3335ab=users[_0x34e4b5(0x1ef)];else{if(_0x4c13b9[0x0][_0x34e4b5(0x251)]=='German')var _0x3335ab=users[_0x34e4b5(0x25c)];else{if(_0x4c13b9[0x0]['language']==_0x34e4b5(0x1db))var _0x3335ab=users[_0x34e4b5(0x1db)];else{if(_0x4c13b9[0x0][_0x34e4b5(0x251)]==_0x34e4b5(0x1e9))var _0x3335ab=users[_0x34e4b5(0x1e9)];else{if(_0x4c13b9[0x0]['language']==_0x34e4b5(0x275))var _0x3335ab=users[_0x34e4b5(0x1da)];else{if(_0x4c13b9[0x0][_0x34e4b5(0x251)]==_0x34e4b5(0x1e6))var _0x3335ab=users[_0x34e4b5(0x1e6)];else{if(_0x4c13b9[0x0]['language']=='Arabic\x20(ae)')var _0x3335ab=users[_0x34e4b5(0x261)];}}}}}}}_0x42dbdb['render'](_0x34e4b5(0x22f),{'success':_0x1206e0[_0x34e4b5(0x23e)](_0x34e4b5(0x228)),'errors':_0x1206e0['flash']('errors'),'role':_0x4cbef7,'profile':_0x198366,'adjustment':_0x3bacb3,'stock':_0x4907af,'master_shop':_0x4c13b9,'warehouse_name':_0x243bb8,'unit':_0x41a662,'language':_0x3335ab,'rooms_data':_0xf09817,'ed_fullDate':_0x4f5096});}catch(_0x3ad5dd){console[_0x34e4b5(0x296)](_0x3ad5dd),_0x42dbdb[_0x34e4b5(0x298)](0xc8)[_0x34e4b5(0x287)]({'message':_0x3ad5dd['message']});}}),router[a0_0x567c4e(0x248)](a0_0x567c4e(0x1d8),auth,async(_0x9bb9e1,_0xb7eda0)=>{var _0x523c52=a0_0x567c4e;try{const _0x54679a=_0x9bb9e1[_0x523c52(0x238)]['id'],_0x475ab7=await adjustment_finished['findById']({'_id':_0x54679a}),_0x5bb596=await warehouse['findOne']({'name':_0x475ab7[_0x523c52(0x1e4)],'room':_0x475ab7[_0x523c52(0x247)]}),{warehouse_name:_0x539796,date:_0x29ceef,prod_name:_0x1312c1,level:_0x1d7e44,isle:_0x503057,pallet:_0x57d4eb,stock:_0x9dc213,types:_0x3eddf0,adjust_qty:_0xac55bf,new_adjust_qty:_0x438018,note:_0x44d2a7,Room_name:_0x3c36a3,invoice:_0x2d81b5,JO_number:_0x30a66b}=_0x9bb9e1[_0x523c52(0x1dd)];if(typeof _0x1312c1==_0x523c52(0x286))var _0x3f3c0a=[_0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x277)]],_0x2e11b1=[_0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x269)]],_0x1d28cf=[_0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x257)]],_0x719c19=[_0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x23c)]],_0x3c02dc=[_0x9bb9e1['body'][_0x523c52(0x272)]],_0x292d1d=[_0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x213)]],_0x25092b=[_0x9bb9e1['body'][_0x523c52(0x25b)]],_0x5c7c1e=[_0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x26b)]],_0x2d8dc0=[_0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x27e)]],_0x1507ba=[_0x9bb9e1[_0x523c52(0x1dd)]['batch_code']],_0x54e052=[_0x9bb9e1[_0x523c52(0x1dd)]['expiry_date']];else var _0x3f3c0a=[..._0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x277)]],_0x2e11b1=[..._0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x269)]],_0x1d28cf=[..._0x9bb9e1['body'][_0x523c52(0x257)]],_0x719c19=[..._0x9bb9e1['body']['types']],_0x3c02dc=[..._0x9bb9e1['body'][_0x523c52(0x272)]],_0x292d1d=[..._0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x213)]],_0x25092b=[..._0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x25b)]],_0x5c7c1e=[..._0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x26b)]],_0x2d8dc0=[..._0x9bb9e1['body'][_0x523c52(0x27e)]],_0x1507ba=[..._0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x216)]],_0x54e052=[..._0x9bb9e1[_0x523c52(0x1dd)][_0x523c52(0x25e)]];const _0x4130b3=_0x3f3c0a[_0x523c52(0x1e7)](_0x4917e5=>{return _0x4917e5={'product_name':_0x4917e5};});_0x2e11b1[_0x523c52(0x259)]((_0x689e8f,_0xd864bd)=>{var _0xc8c380=_0x523c52;_0x4130b3[_0xd864bd][_0xc8c380(0x253)]=_0x689e8f;}),_0x1d28cf['forEach']((_0x26f2b9,_0x446a6a)=>{var _0x56ffe7=_0x523c52;_0x4130b3[_0x446a6a][_0x56ffe7(0x28a)]=_0x26f2b9;}),_0x719c19[_0x523c52(0x259)]((_0x197388,_0x5d9041)=>{var _0xc4f6b0=_0x523c52;_0x4130b3[_0x5d9041][_0xc4f6b0(0x23c)]=_0x197388;}),_0x3c02dc[_0x523c52(0x259)]((_0x279ae2,_0x407525)=>{var _0x3533c5=_0x523c52;_0x4130b3[_0x407525][_0x3533c5(0x272)]=_0x279ae2;}),_0x292d1d[_0x523c52(0x259)]((_0x5c9f66,_0x27e791)=>{_0x4130b3[_0x27e791]['new_adjust_qty']=_0x5c9f66;}),_0x5c7c1e['forEach']((_0x10d655,_0x58d957)=>{var _0xf020b=_0x523c52;_0x4130b3[_0x58d957][_0xf020b(0x26b)]=_0x10d655;}),_0x2d8dc0['forEach']((_0x157a03,_0x4a51c5)=>{var _0x362a4b=_0x523c52;_0x4130b3[_0x4a51c5][_0x362a4b(0x1f4)]=_0x157a03;}),_0x25092b[_0x523c52(0x259)]((_0x298af5,_0x126056)=>{_0x4130b3[_0x126056]['product_code']=_0x298af5;}),_0x1507ba[_0x523c52(0x259)]((_0x9f23f8,_0x162385)=>{_0x4130b3[_0x162385]['batch_code']=_0x9f23f8;}),_0x54e052['forEach']((_0xae771b,_0xf1c6be)=>{var _0x3bea4c=_0x523c52;_0x4130b3[_0xf1c6be][_0x3bea4c(0x25e)]=_0xae771b;});const _0x4adfa4=_0x4130b3[_0x523c52(0x244)](_0x1fb789=>_0x1fb789[_0x523c52(0x272)]!=='0'&&_0x1fb789[_0x523c52(0x272)]!=='');var _0x114658=0x0;_0x4adfa4[_0x523c52(0x259)](_0x2c0872=>{var _0x24cfcf=_0x523c52;console[_0x24cfcf(0x296)](_0x24cfcf(0x22e),_0x2c0872),parseInt(_0x2c0872[_0x24cfcf(0x272)])<=0x0&&_0x114658++;});if(_0x114658!=0x0)return _0x9bb9e1[_0x523c52(0x23e)](_0x523c52(0x1d1),_0x523c52(0x210)),_0xb7eda0[_0x523c52(0x260)](_0x523c52(0x236));_0x475ab7[_0x523c52(0x1e4)]=_0x539796,_0x475ab7[_0x523c52(0x1e0)]=_0x29ceef,_0x475ab7[_0x523c52(0x1d2)]=_0x4adfa4,_0x475ab7[_0x523c52(0x280)]=_0x44d2a7,_0x475ab7[_0x523c52(0x247)]=_0x3c36a3,_0x475ab7[_0x523c52(0x239)]=_0x2d81b5,_0x475ab7[_0x523c52(0x225)]=_0x30a66b;const _0x547c7f=await _0x475ab7[_0x523c52(0x215)](),_0x554650=await warehouse[_0x523c52(0x297)]({'name':_0x539796,'room':_0x3c36a3});_0x547c7f[_0x523c52(0x1d2)][_0x523c52(0x259)](_0x498839=>{var _0x3914bc=_0x523c52;const _0x2b5f96=_0x554650[_0x3914bc(0x221)][_0x3914bc(0x1e7)](_0x1e9eb4=>{var _0x2acfa4=_0x3914bc;_0x498839['types']==_0x2acfa4(0x1f7)?_0x1e9eb4[_0x2acfa4(0x284)]==_0x498839[_0x2acfa4(0x284)]&&_0x1e9eb4['bay']==_0x498839[_0x2acfa4(0x253)]&&(_0x1e9eb4[_0x2acfa4(0x203)]=parseInt(_0x1e9eb4['product_stock'])-parseInt(_0x498839[_0x2acfa4(0x272)])):_0x1e9eb4[_0x2acfa4(0x284)]==_0x498839[_0x2acfa4(0x284)]&&_0x1e9eb4[_0x2acfa4(0x253)]==_0x498839[_0x2acfa4(0x253)]&&(_0x1e9eb4[_0x2acfa4(0x203)]=parseInt(_0x1e9eb4[_0x2acfa4(0x203)])+parseInt(_0x498839[_0x2acfa4(0x272)]));});}),await _0x554650[_0x523c52(0x215)](),_0x9bb9e1[_0x523c52(0x23e)](_0x523c52(0x228),_0x523c52(0x224)),_0xb7eda0[_0x523c52(0x260)]('/adjustment_finished/view');}catch(_0x12eb30){console[_0x523c52(0x296)](_0x12eb30);}}),router['post'](a0_0x567c4e(0x24a),async(_0x35a3b9,_0x1ddd11)=>{var _0x2cb617=a0_0x567c4e;const {primary_code:_0x32f6f7,warehouse_data:_0x29f60d,rooms_data:_0x21f3c2,Roomslist:_0x5084f0}=_0x35a3b9[_0x2cb617(0x1dd)],_0x6352ed=_0x5084f0[_0x2cb617(0x28d)](','),_0x4fae58=[];async function _0x335d02(_0x1f37aa){var _0x543a73=_0x2cb617;const _0x5f10bd=await warehouse[_0x543a73(0x242)]([{'$match':{'name':_0x29f60d,'room':_0x1f37aa}},{'$unwind':_0x543a73(0x271)},{'$match':{'product_details.primary_code':_0x32f6f7}},{'$group':{'_id':_0x543a73(0x283),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x543a73(0x249)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x543a73(0x21f)},'product_code':{'$first':_0x543a73(0x299)},'level':{'$first':_0x543a73(0x230)},'isle':{'$first':_0x543a73(0x1fe)},'type':{'$first':_0x543a73(0x250)},'pallet':{'$first':_0x543a73(0x226)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x543a73(0x207)},'storage':{'$first':_0x543a73(0x24e)},'rack':{'$first':_0x543a73(0x200)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x543a73(0x20f)},'batch_code':{'$first':_0x543a73(0x23b)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x543a73(0x223)},'roomNamed':{'$first':_0x543a73(0x274)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x3b1fdc=await warehouse[_0x543a73(0x242)]([{'$match':{'name':_0x29f60d,'room':_0x1f37aa}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x32f6f7}},{'$group':{'_id':_0x543a73(0x283),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x543a73(0x249)},'primary_code':{'$first':_0x543a73(0x20d)},'secondary_code':{'$first':_0x543a73(0x21f)},'product_code':{'$first':_0x543a73(0x299)},'level':{'$first':_0x543a73(0x230)},'isle':{'$first':_0x543a73(0x1fe)},'type':{'$first':_0x543a73(0x250)},'pallet':{'$first':_0x543a73(0x226)},'unit':{'$first':_0x543a73(0x202)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x543a73(0x24e)},'rack':{'$first':_0x543a73(0x200)},'expiry_date':{'$first':_0x543a73(0x222)},'production_date':{'$first':_0x543a73(0x20f)},'batch_code':{'$first':_0x543a73(0x23b)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x543a73(0x223)},'roomNamed':{'$first':_0x543a73(0x274)},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x5f10bd['length']>0x0)_0x4fae58[_0x543a73(0x27d)](_0x5f10bd);else _0x3b1fdc[_0x543a73(0x1f9)]>0x0&&_0x4fae58[_0x543a73(0x27d)](_0x3b1fdc);}const _0x26d39b=_0x6352ed[_0x2cb617(0x1e7)](_0x2fc9a2=>_0x335d02(_0x2fc9a2));await Promise[_0x2cb617(0x29c)](_0x26d39b),_0x1ddd11['json'](_0x4fae58);}),router[a0_0x567c4e(0x248)](a0_0x567c4e(0x229),async(_0x26c816,_0x130bc2)=>{var _0x34325f=a0_0x567c4e;const {productCode:_0x18c6eb,bay:_0x28fd07,warehouses:_0x347ba7,room:_0x2be2ed}=_0x26c816[_0x34325f(0x1dd)];console[_0x34325f(0x296)](_0x26c816[_0x34325f(0x1dd)]);try{const _0x494e96=await warehouse[_0x34325f(0x242)]([{'$match':{'name':_0x347ba7,'room':_0x2be2ed}},{'$unwind':_0x34325f(0x271)},{'$match':{'product_details.bay':parseInt(_0x28fd07)}},{'$group':{'_id':_0x34325f(0x283),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x34325f(0x249)},'bay':{'$first':_0x34325f(0x230)},'maxProducts':{'$first':_0x34325f(0x234)}}}]);_0x130bc2[_0x34325f(0x298)](0xc8)['json'](_0x494e96);}catch(_0x3c4151){_0x130bc2[_0x34325f(0x298)](0x194)[_0x34325f(0x287)]({'message':_0x3c4151['message']});}}),module[a0_0x567c4e(0x1f0)]=router;