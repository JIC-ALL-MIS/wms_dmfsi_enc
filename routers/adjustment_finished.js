var a0_0x533a08=a0_0x4874;(function(_0x21d861,_0x56a7cd){var _0x1d78f2=a0_0x4874,_0x449d38=_0x21d861();while(!![]){try{var _0x349ecb=-parseInt(_0x1d78f2(0xab))/0x1*(parseInt(_0x1d78f2(0x11b))/0x2)+parseInt(_0x1d78f2(0xa1))/0x3*(parseInt(_0x1d78f2(0xd0))/0x4)+parseInt(_0x1d78f2(0xf4))/0x5*(-parseInt(_0x1d78f2(0x98))/0x6)+parseInt(_0x1d78f2(0xe9))/0x7+parseInt(_0x1d78f2(0x110))/0x8+parseInt(_0x1d78f2(0x91))/0x9*(-parseInt(_0x1d78f2(0x84))/0xa)+parseInt(_0x1d78f2(0x9c))/0xb*(parseInt(_0x1d78f2(0x11c))/0xc);if(_0x349ecb===_0x56a7cd)break;else _0x449d38['push'](_0x449d38['shift']());}catch(_0x2124f9){_0x449d38['push'](_0x449d38['shift']());}}}(a0_0x1e55,0xd1585));const express=require(a0_0x533a08(0xb2)),app=express(),router=express[a0_0x533a08(0x10d)](),auth=require(a0_0x533a08(0x10f)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x533a08(0x72)),users=require(a0_0x533a08(0x10b)),nodemailer=require(a0_0x533a08(0x94));router[a0_0x533a08(0xbf)](a0_0x533a08(0x9a),auth,async(_0x5eb0cd,_0x2c010d)=>{var _0xf89892=a0_0x533a08;try{const {username:_0x3eca9c,email:_0xaea4ef,role:_0x53c44f}=_0x5eb0cd[_0xf89892(0x6f)],_0x1712c1=_0x5eb0cd['user'],_0x2f0c56=await profile[_0xf89892(0x131)]({'email':_0x1712c1[_0xf89892(0xbb)]}),_0x14b52e=await master_shop['find']();let _0x295542;if(_0x1712c1['role']==_0xf89892(0xeb)){const _0x2e6af5=await staff[_0xf89892(0x131)]({'email':_0x1712c1['email']});_0x295542=await warehouse[_0xf89892(0xc7)]({'status':_0xf89892(0x117),'name':_0x2e6af5[_0xf89892(0xb1)]});}else _0x295542=await warehouse[_0xf89892(0xc7)]({'status':_0xf89892(0x117)});const _0xa56072=await product[_0xf89892(0xc7)]();let _0x2d4fbf;if(_0x1712c1[_0xf89892(0x8a)]==_0xf89892(0xeb)){const _0x8705ca=await staff[_0xf89892(0x131)]({'email':_0x1712c1[_0xf89892(0xbb)]});_0x2d4fbf=await adjustment_finished['find']({'warehouse_name':_0x8705ca[_0xf89892(0xb1)]});}else _0x2d4fbf=await adjustment_finished['aggregate']([{'$unwind':_0xf89892(0xbe)},{'$group':{'_id':_0xf89892(0x113),'invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0xf89892(0x78)},'room':{'$addToSet':_0xf89892(0x130)},'finalize':{'$first':_0xf89892(0xae)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x14b52e[0x0][_0xf89892(0x129)]==_0xf89892(0xee)){var _0x5591fe=users['English'];console[_0xf89892(0x80)](_0x5591fe);}else{if(_0x14b52e[0x0][_0xf89892(0x129)]==_0xf89892(0xd7))var _0x5591fe=users['Hindi'];else{if(_0x14b52e[0x0]['language']==_0xf89892(0x83))var _0x5591fe=users[_0xf89892(0x83)];else{if(_0x14b52e[0x0][_0xf89892(0x129)]==_0xf89892(0x7e))var _0x5591fe=users[_0xf89892(0x7e)];else{if(_0x14b52e[0x0][_0xf89892(0x129)]==_0xf89892(0x74))var _0x5591fe=users[_0xf89892(0x74)];else{if(_0x14b52e[0x0][_0xf89892(0x129)]=='Portuguese\x20(BR)')var _0x5591fe=users['Portuguese'];else{if(_0x14b52e[0x0][_0xf89892(0x129)]=='Chinese')var _0x5591fe=users[_0xf89892(0x7a)];else{if(_0x14b52e[0x0][_0xf89892(0x129)]==_0xf89892(0x86))var _0x5591fe=users[_0xf89892(0xfb)];}}}}}}}_0x2c010d['render'](_0xf89892(0x6c),{'success':_0x5eb0cd['flash']('success'),'errors':_0x5eb0cd[_0xf89892(0x8f)](_0xf89892(0xe0)),'role':_0x1712c1,'profile':_0x2f0c56,'warehouse':_0x295542,'product':_0xa56072,'adjustment':_0x2d4fbf,'master_shop':_0x14b52e,'language':_0x5591fe});}catch(_0x4c3eb9){console['log'](_0x4c3eb9);}});async function getRandom8DigitNumber(){var _0x190a26=a0_0x533a08;const _0x27499a=0x989680,_0x5409d4=0x5f5e0ff,_0x4a4712=Math[_0x190a26(0x9b)](Math['random']()*(_0x5409d4-_0x27499a+0x1))+_0x27499a;var _0x4f6023;const _0xeeb3a8=await adjustment_finished[_0x190a26(0x131)]({'invoice':'ADJF-'+_0x4a4712});return _0xeeb3a8&&_0xeeb3a8[_0x190a26(0xe8)]>0x0?_0x4f6023=_0x190a26(0xa3)+_0x4a4712:_0x4f6023=_0x190a26(0xa3)+_0x4a4712,_0x4f6023;}function a0_0x1e55(){var _0x8c9300=['Finished\x20Goods','$product_details.maxPerUnit','logo','push','<h5\x20style=\x22text-align:\x20left;\x22>','Secondary_units','$product_details.secondary_unit','../public/language/languages.json','$product_details.floorlevel','Router','note','../middleware/auth','13184576FtIioW','</h5>','Return\x20Rooms','$_id','expiry_date','product_details','bay','Enabled','</head><body>','FGSEmail','product_name','2TqTapo','1926732LimUWX','Logo.png','/view/add_adjustment','production_date','prod_code','/upload/','$product_details.primary_code','<hr\x20class=\x22my-3\x22>','/adjustment_finished/preview/','$product_details.product_name','invoice','</span>','\x20</h2>','language','<h5>','\x20Order\x20Number\x20:\x20','password','new_adjust_qty','types','$product_details.secondary_code','$product.room_names','findOne','<span\x20style=\x22float:\x20right;\x22>','room_names','/preview/:id','$product_details.maxProducts','</thead>','Ambient','Email\x20sent\x20successfully','forEach','adjustment_finished','$product_details.bay','$product_details.batch_code','user','minus','Portuguese\x20(BR)','../models/all_models','json','French','$product_details.type','catch','$product_details.product_code','$warehouse_name','New_Qty_Converted','Chinese','redirect','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Spanish','/barcode_scanner','log','map','getDate','German','2880670icROjA','createTransport','Arabic\x20(ae)','$product_details.unit','back','<!DOCTYPE\x20html>','role','/picking_list/PDF_adjustment/','product','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','host','flash','room','18VktdAX','</tr>','master','nodemailer','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product.product_name','3301176ZRYUHH','date','/view','floor','88BjJtUj','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','sendMail','getMonth','643356dwBWnr','body','ADJF-','$product_details.production_date','params','warehouse_name','</div>','$product_details.expiry_date','prod_cat','message','1647039zQmquU','unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$finalize','/adjustment/view','image','warehouse','express','maxPerUnit','$product_details._id','Enclosed','site_title','prod_invoice','slice','purchases_data','adjust_qty','email','</body></html>','$product_details.invoice','$product','get','</td>','An\x20error\x20occurred.','</tbody>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','post','success','adjustment\x20add\x20successfull','find','Adjustment\x20Mail','<html><head><title></title>','$product_details.rack','string','/view/:id','all','</table>','split','20TSWSns','Primary_Units','QA\x20Warehouse','$product_details.storage','getFullYear','then','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Hindi','English','level','$product_details.product_stock','prod_name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<div>','product_date','An\x20error\x20occurred\x20while\x20saving\x20data.','errors','/adjustment_finished/view','<tr>','Rooms','foreach\x20newproduct','stockBefore','\x20Order\x20Date\x20:\x20','product_code','length','1233554aUukMB','findById','staff','status','product_stock','English\x20(US)','$room','secondary_unit','batch_code','adjustment\x20data\x20update\x20successfully','_id','10qnisFF','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.bin','padStart','stock','aggregate','$name','Arabic','New_Qty_Converted_adj','<strong>\x20Regards\x20</strong>','render','Adjustment\x20Finalize\x20Successfully','save','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','edit_adjustment_finished_view'];a0_0x1e55=function(){return _0x8c9300;};return a0_0x1e55();}function a0_0x4874(_0x297fd3,_0x41f8cc){var _0x1e5573=a0_0x1e55();return a0_0x4874=function(_0x4874af,_0x4212db){_0x4874af=_0x4874af-0x67;var _0x373b6a=_0x1e5573[_0x4874af];return _0x373b6a;},a0_0x4874(_0x297fd3,_0x41f8cc);}router[a0_0x533a08(0xbf)](a0_0x533a08(0x11e),auth,async(_0x4f0589,_0x141fda)=>{var _0x1c49a4=a0_0x533a08;try{const {username:_0x35a58a,email:_0x56b220,role:_0x118986}=_0x4f0589[_0x1c49a4(0x6f)],_0x232f88=_0x4f0589[_0x1c49a4(0x6f)],_0x1807e4=await profile[_0x1c49a4(0x131)]({'email':_0x232f88['email']}),_0x2089c3=await master_shop['find']();let _0x340123;if(_0x232f88[_0x1c49a4(0x8a)]=='staff'){const _0x449ff5=await staff[_0x1c49a4(0x131)]({'email':_0x232f88[_0x1c49a4(0xbb)]});_0x340123=await warehouse['aggregate']([{'$match':{'status':_0x1c49a4(0x117),'name':_0x449ff5[_0x1c49a4(0xb1)],'warehouse_category':_0x1c49a4(0x104),'name':{'$ne':_0x1c49a4(0xd2)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x340123=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods','name':{'$ne':_0x1c49a4(0xd2)}}},{'$group':{'_id':_0x1c49a4(0xfa),'name':{'$first':_0x1c49a4(0xfa)}}}]);const _0x53676a=await product[_0x1c49a4(0xc7)]({}),_0x52f66b=await adjustment_finished[_0x1c49a4(0xc7)]({}),_0xa22224=_0x52f66b[_0x1c49a4(0xe8)]+0x1,_0x3d2365=_0x1c49a4(0xa3)+_0xa22224['toString']()[_0x1c49a4(0xf7)](0x5,'0');var _0x40b7db=[_0x1c49a4(0x69),'Enclosed','Return\x20Rooms'];if(_0x2089c3[0x0][_0x1c49a4(0x129)]==_0x1c49a4(0xee))var _0x28cdb5=users[_0x1c49a4(0xd8)];else{if(_0x2089c3[0x0][_0x1c49a4(0x129)]==_0x1c49a4(0xd7))var _0x28cdb5=users['Hindi'];else{if(_0x2089c3[0x0]['language']=='German')var _0x28cdb5=users[_0x1c49a4(0x83)];else{if(_0x2089c3[0x0][_0x1c49a4(0x129)]=='Spanish')var _0x28cdb5=users[_0x1c49a4(0x7e)];else{if(_0x2089c3[0x0][_0x1c49a4(0x129)]==_0x1c49a4(0x74))var _0x28cdb5=users['French'];else{if(_0x2089c3[0x0]['language']=='Portuguese\x20(BR)')var _0x28cdb5=users[_0x1c49a4(0x9d)];else{if(_0x2089c3[0x0]['language']==_0x1c49a4(0x7a))var _0x28cdb5=users[_0x1c49a4(0x7a)];else{if(_0x2089c3[0x0][_0x1c49a4(0x129)]==_0x1c49a4(0x86))var _0x28cdb5=users[_0x1c49a4(0xfb)];}}}}}}}const _0x45216f=getRandom8DigitNumber();_0x45216f['then'](_0x407eac=>{var _0x75375b=_0x1c49a4;_0x141fda[_0x75375b(0xfe)]('add_adjustment_finished',{'success':_0x4f0589[_0x75375b(0x8f)](_0x75375b(0xc5)),'errors':_0x4f0589['flash']('errors'),'role':_0x232f88,'profile':_0x1807e4,'warehouse':_0x340123,'product':_0x53676a,'master_shop':_0x2089c3,'language':_0x28cdb5,'rooms_data':_0x40b7db,'invoice_no':_0x407eac});})['catch'](_0x115550=>{var _0xbd7413=_0x1c49a4;_0x4f0589['flash'](_0xbd7413(0xe0),_0xbd7413(0xdc)),_0x141fda[_0xbd7413(0x7b)](_0xbd7413(0xaf));});}catch(_0x3c47a5){console[_0x1c49a4(0x80)](_0x3c47a5);}}),router[a0_0x533a08(0xc4)](a0_0x533a08(0x11e),auth,async(_0x592c9d,_0x27d5a8)=>{var _0x1e9c40=a0_0x533a08;try{const {warehouse_name:_0x1ae084,date:_0x1b6ade,prod_name:_0xe40968,level:_0x177cba,isle:_0x5847ae,pallet:_0x50c065,stock:_0x2d4a18,types:_0x5a7256,adjust_qty:_0x36f05c,new_adjust_qty:_0x299307,note:_0x918c6,Room_name:_0x3dcbcf,invoice:_0x3c57db,JO_number:_0x340bad,expiry_date:_0x4c22d9}=_0x592c9d[_0x1e9c40(0xa2)];if(typeof _0xe40968==_0x1e9c40(0xcb))var _0x1f2457=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xdb)]],_0x11af84=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xd9)]],_0x3060f7=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xf8)]],_0x2de6ca=[_0x592c9d[_0x1e9c40(0xa2)]['types']],_0x191739=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xfc)]],_0x36757a=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0x79)]],_0x17c531=[_0x592c9d[_0x1e9c40(0xa2)]['Primary_Units']],_0x3c075e=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0x109)]],_0x5a3018=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0x120)]],_0x52f85e=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xf1)]],_0xa6361f=[_0x592c9d['body'][_0x1e9c40(0x114)]],_0x1ab715=[_0x592c9d['body'][_0x1e9c40(0xde)]],_0x4286e2=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xa9)]],_0x4f8757=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xe3)]],_0x443cf7=[_0x592c9d[_0x1e9c40(0xa2)]['maxPerUnit']],_0x35d3c0=[_0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xb7)]];else var _0x1f2457=[..._0x592c9d[_0x1e9c40(0xa2)]['prod_name']],_0x11af84=[..._0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xd9)]],_0x3060f7=[..._0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xf8)]],_0x2de6ca=[..._0x592c9d['body']['types']],_0x191739=[..._0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xfc)]],_0x36757a=[..._0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0x79)]],_0x17c531=[..._0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xd1)]],_0x3c075e=[..._0x592c9d[_0x1e9c40(0xa2)]['Secondary_units']],_0x5a3018=[..._0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0x120)]],_0x52f85e=[..._0x592c9d[_0x1e9c40(0xa2)]['batch_code']],_0xa6361f=[..._0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0x114)]],_0x1ab715=[..._0x592c9d[_0x1e9c40(0xa2)]['product_date']],_0x4286e2=[..._0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xa9)]],_0x4f8757=[..._0x592c9d[_0x1e9c40(0xa2)][_0x1e9c40(0xe3)]],_0x443cf7=[..._0x592c9d[_0x1e9c40(0xa2)]['maxPerUnit']],_0x35d3c0=[..._0x592c9d['body'][_0x1e9c40(0xb7)]];const _0x4dfd0d=_0x1f2457[_0x1e9c40(0x81)](_0x4e9507=>{return _0x4e9507={'product_name':_0x4e9507};});_0x11af84[_0x1e9c40(0x6b)]((_0x2cb356,_0x8864d9)=>{_0x4dfd0d[_0x8864d9]['bay']=_0x2cb356;}),_0x3060f7[_0x1e9c40(0x6b)]((_0x2eafc8,_0x1c5596)=>{var _0x429e89=_0x1e9c40;_0x4dfd0d[_0x1c5596][_0x429e89(0xe5)]=_0x2eafc8;}),_0x2de6ca[_0x1e9c40(0x6b)]((_0x2642c4,_0x4558a3)=>{_0x4dfd0d[_0x4558a3]['types']=_0x2642c4;}),_0x191739[_0x1e9c40(0x6b)]((_0x3f6dd6,_0x4e2305)=>{_0x4dfd0d[_0x4e2305]['adjust_qty']=_0x3f6dd6;}),_0x36757a[_0x1e9c40(0x6b)]((_0xc632a2,_0x2e2128)=>{var _0x556b08=_0x1e9c40;_0x4dfd0d[_0x2e2128][_0x556b08(0x12d)]=_0xc632a2;}),_0x17c531[_0x1e9c40(0x6b)]((_0x4d834e,_0x5f29f6)=>{var _0x21c856=_0x1e9c40;_0x4dfd0d[_0x5f29f6][_0x21c856(0xac)]=_0x4d834e;}),_0x3c075e[_0x1e9c40(0x6b)]((_0x54ecd0,_0x27aa07)=>{var _0x216815=_0x1e9c40;_0x4dfd0d[_0x27aa07][_0x216815(0xf0)]=_0x54ecd0;}),_0x5a3018[_0x1e9c40(0x6b)]((_0x22735f,_0x3d57a4)=>{var _0x32db3b=_0x1e9c40;_0x4dfd0d[_0x3d57a4][_0x32db3b(0xe7)]=_0x22735f;}),_0x52f85e[_0x1e9c40(0x6b)]((_0x2c180f,_0x24f7cf)=>{var _0x3bd65c=_0x1e9c40;_0x4dfd0d[_0x24f7cf][_0x3bd65c(0xf1)]=_0x2c180f;}),_0xa6361f[_0x1e9c40(0x6b)]((_0x3faa66,_0x1cebed)=>{var _0x4d95cc=_0x1e9c40;_0x4dfd0d[_0x1cebed][_0x4d95cc(0x114)]=_0x3faa66;}),_0x1ab715[_0x1e9c40(0x6b)]((_0x44c323,_0x52d34c)=>{var _0x29acde=_0x1e9c40;_0x4dfd0d[_0x52d34c][_0x29acde(0x11f)]=_0x44c323;}),_0x4286e2['forEach']((_0x125d4f,_0x562431)=>{var _0x35ffa5=_0x1e9c40;_0x4dfd0d[_0x562431][_0x35ffa5(0xa9)]=_0x125d4f;}),_0x4f8757[_0x1e9c40(0x6b)]((_0x54aa05,_0x5e8d3c)=>{var _0x3e74f7=_0x1e9c40;_0x4dfd0d[_0x5e8d3c][_0x3e74f7(0x133)]=_0x54aa05;}),_0x443cf7[_0x1e9c40(0x6b)]((_0x52aeaa,_0x1df2c1)=>{var _0x288f21=_0x1e9c40;_0x4dfd0d[_0x1df2c1][_0x288f21(0xb3)]=_0x52aeaa;}),_0x35d3c0[_0x1e9c40(0x6b)]((_0x437fbb,_0x844de9)=>{var _0x3a0d31=_0x1e9c40;_0x4dfd0d[_0x844de9][_0x3a0d31(0x126)]=_0x437fbb;});const _0x4ae1e7=_0x4dfd0d['filter'](_0x3b8231=>_0x3b8231['adjust_qty']!=='0'&&_0x3b8231['adjust_qty']!=='');var _0x160967=0x0;_0x4ae1e7[_0x1e9c40(0x6b)](_0x580754=>{var _0x1776cf=_0x1e9c40;console[_0x1776cf(0x80)](_0x1776cf(0xe4),_0x580754),parseInt(_0x580754[_0x1776cf(0xba)])<=0x0&&_0x160967++;});if(_0x160967!=0x0)return _0x592c9d[_0x1e9c40(0x8f)](_0x1e9c40(0xe0),_0x1e9c40(0x96)),_0x27d5a8['redirect'](_0x1e9c40(0x88));const _0x5bcb0b=new adjustment_finished({'warehouse_name':_0x1ae084,'date':_0x1b6ade,'product':_0x4ae1e7,'note':_0x918c6,'room':_0x3dcbcf,'invoice':_0x3c57db,'JO_number':_0x340bad,'expiry_date':_0x4c22d9}),_0x5babeb=await _0x5bcb0b[_0x1e9c40(0x100)]();_0x592c9d['flash'](_0x1e9c40(0xc5),_0x1e9c40(0xc6)),_0x27d5a8[_0x1e9c40(0x7b)](_0x1e9c40(0x124)+_0x5babeb[_0x1e9c40(0xf3)]);}catch(_0x1875d3){console[_0x1e9c40(0x80)](_0x1875d3),_0x27d5a8[_0x1e9c40(0xec)](0xc8)[_0x1e9c40(0x73)]({'message':_0x1875d3[_0x1e9c40(0xaa)]});}}),router['get'](a0_0x533a08(0x134),auth,async(_0x110480,_0x57bbb6)=>{var _0x419392=a0_0x533a08;try{const {username:_0x1e10bb,email:_0x2bd512,role:_0x291b70}=_0x110480['user'],_0x1bc0d2=_0x110480[_0x419392(0x6f)],_0x3e3a8c=await profile[_0x419392(0x131)]({'email':_0x1bc0d2['email']}),_0x35ea46=await master_shop[_0x419392(0xc7)](),_0x4f7392=_0x110480[_0x419392(0xa5)]['id'],_0x4896ca=await adjustment_finished['findById']({'_id':_0x4f7392}),_0xde07e3=await purchases[_0x419392(0xf9)]([{'$match':{'warehouse_name':_0x4896ca[_0x419392(0xa6)]}},{'$unwind':_0x419392(0xbe)},{'$group':{'_id':_0x419392(0x97)}}]);console[_0x419392(0x80)](_0x419392(0xb9),_0xde07e3);const _0x234dd7=await product[_0x419392(0xc7)]({}),_0x3553c7=await warehouse[_0x419392(0xf9)]([{'$match':{'name':_0x4896ca['warehouse_name'],'warehouse_category':_0x419392(0x104)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x419392(0xb4),'name':{'$first':_0x419392(0x125)},'product_stock':{'$first':_0x419392(0xda)},'bay':{'$first':_0x419392(0x6d)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x419392(0x75)},'floorlevel':{'$first':_0x419392(0x10c)},'primary_code':{'$first':_0x419392(0x122)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x419392(0x77)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x419392(0xa8)},'production_date':{'$first':_0x419392(0xa4)},'batch_code':{'$first':_0x419392(0x6e)},'maxPerUnit':{'$first':_0x419392(0x105)},'room':{'$first':'$room'}}}]);if(_0x35ea46[0x0][_0x419392(0x129)]==_0x419392(0xee)){var _0x4e430a=users[_0x419392(0xd8)];console[_0x419392(0x80)](_0x4e430a);}else{if(_0x35ea46[0x0][_0x419392(0x129)]==_0x419392(0xd7))var _0x4e430a=users[_0x419392(0xd7)];else{if(_0x35ea46[0x0][_0x419392(0x129)]=='German')var _0x4e430a=users[_0x419392(0x83)];else{if(_0x35ea46[0x0][_0x419392(0x129)]==_0x419392(0x7e))var _0x4e430a=users['Spanish'];else{if(_0x35ea46[0x0][_0x419392(0x129)]=='French')var _0x4e430a=users['French'];else{if(_0x35ea46[0x0][_0x419392(0x129)]==_0x419392(0x71))var _0x4e430a=users[_0x419392(0x9d)];else{if(_0x35ea46[0x0]['language']==_0x419392(0x7a))var _0x4e430a=users[_0x419392(0x7a)];else{if(_0x35ea46[0x0][_0x419392(0x129)]=='Arabic\x20(ae)')var _0x4e430a=users[_0x419392(0xfb)];}}}}}}}_0x57bbb6['render'](_0x419392(0x103),{'success':_0x110480[_0x419392(0x8f)]('success'),'errors':_0x110480[_0x419392(0x8f)](_0x419392(0xe0)),'role':_0x1bc0d2,'profile':_0x3e3a8c,'adjustment':_0x4896ca,'stock':_0x3553c7,'master_shop':_0x35ea46,'warehouse_name':_0xde07e3,'unit':_0x234dd7,'language':_0x4e430a});}catch(_0x547996){console[_0x419392(0x80)](_0x547996),_0x57bbb6[_0x419392(0xec)](0xc8)[_0x419392(0x73)]({'message':_0x547996[_0x419392(0xaa)]});}}),router[a0_0x533a08(0xc4)](a0_0x533a08(0x134),auth,async(_0x44a23c,_0x32cc21)=>{var _0x34c527=a0_0x533a08;try{const {invoice:_0x3604a7,warehouse_name:_0x463b89,Room_name:_0x45cb69}=_0x44a23c[_0x34c527(0xa2)],_0x162f3e=_0x44a23c[_0x34c527(0xa5)]['id'],_0x317b6a=await adjustment_finished[_0x34c527(0xea)]({'_id':_0x162f3e});var _0x1f86f7;const _0x2eb278=_0x317b6a[_0x34c527(0x8c)][_0x34c527(0x81)](async _0x1653e4=>{var _0x15b396=_0x34c527;if(_0x1653e4[_0x15b396(0xba)]>0x0){_0x1f86f7=await warehouse[_0x15b396(0x131)]({'name':_0x463b89,'room':_0x1653e4['room_names'],'warehouse_category':_0x15b396(0x104)});const _0x5aaa2b=_0x1f86f7[_0x15b396(0x115)][_0x15b396(0x81)](_0x53f3ea=>{var _0x241cef=_0x15b396;console['log'](_0x1653e4[_0x241cef(0x12e)]);if(_0x1653e4['types']==_0x241cef(0x70))_0x53f3ea['product_name']==_0x1653e4[_0x241cef(0x11a)]&&_0x53f3ea['bay']==_0x1653e4[_0x241cef(0x116)]&&_0x53f3ea['expiry_date']==_0x1653e4[_0x241cef(0x114)]&&_0x53f3ea[_0x241cef(0x11f)]==_0x1653e4[_0x241cef(0x11f)]&&_0x53f3ea[_0x241cef(0xf1)]==_0x1653e4['batch_code']&&_0x53f3ea['invoice']==_0x1653e4['invoice']&&(_0x53f3ea[_0x241cef(0xed)]=_0x53f3ea['product_stock']-_0x1653e4['adjust_qty']);else _0x1653e4['types']=='add'&&(_0x53f3ea[_0x241cef(0x11a)]==_0x1653e4[_0x241cef(0x11a)]&&_0x53f3ea[_0x241cef(0x116)]==_0x1653e4['bay']&&_0x53f3ea[_0x241cef(0x114)]==_0x1653e4[_0x241cef(0x114)]&&_0x53f3ea[_0x241cef(0x11f)]==_0x1653e4[_0x241cef(0x11f)]&&_0x53f3ea[_0x241cef(0xf1)]==_0x1653e4[_0x241cef(0xf1)]&&_0x53f3ea[_0x241cef(0x126)]==_0x1653e4[_0x241cef(0x126)]&&(_0x53f3ea['product_stock']=_0x53f3ea[_0x241cef(0xed)]+_0x1653e4['adjust_qty']));});}return _0x1f86f7;});Promise[_0x34c527(0xcd)](_0x2eb278)[_0x34c527(0xd5)](async _0x5e6379=>{var _0x44c4bc=_0x34c527;try{for(const _0x1efbde of _0x5e6379){await _0x1efbde['save']();}_0x317b6a['finalize']='True';const _0x3ab0d=await _0x317b6a['save'](),_0x2e59b0=await master_shop[_0x44c4bc(0xc7)](),_0x58cb98=await email_settings['findOne'](),_0x1ad37c=await supervisor_settings[_0x44c4bc(0xc7)]();var _0x5aa0fd=_0x317b6a[_0x44c4bc(0x8c)],_0x472118='',_0xf6623a;for(_0xf6623a in _0x5aa0fd){var _0x1141c4='FG';_0x317b6a[_0x44c4bc(0xa6)]=='DRY\x20GOODS'&&(_0x1141c4='DG'),_0x472118+=_0x44c4bc(0xe2)+_0x44c4bc(0xf5)+_0x5aa0fd[_0xf6623a][_0x44c4bc(0x11a)]+_0x44c4bc(0xc0)+_0x44c4bc(0xf5)+_0x5aa0fd[_0xf6623a][_0x44c4bc(0xe7)]+_0x44c4bc(0xc0)+_0x44c4bc(0xf5)+_0x5aa0fd[_0xf6623a][_0x44c4bc(0xba)]+_0x44c4bc(0xc0)+_0x44c4bc(0xf5)+_0x5aa0fd[_0xf6623a]['unit']+_0x44c4bc(0xc0)+_0x44c4bc(0xf5)+_0x5aa0fd[_0xf6623a][_0x44c4bc(0xf0)]+_0x44c4bc(0xc0)+_0x44c4bc(0xf5)+_0x317b6a[_0x44c4bc(0xa6)]+_0x44c4bc(0xc0)+_0x44c4bc(0xf5)+_0x5aa0fd[_0xf6623a][_0x44c4bc(0x133)]+_0x44c4bc(0xc0)+_0x44c4bc(0xf5)+_0x1141c4+_0x5aa0fd[_0xf6623a][_0x44c4bc(0x116)]+_0x44c4bc(0xc0)+'</tr>';}let _0x1bd43e=nodemailer[_0x44c4bc(0x85)]({'host':_0x58cb98[_0x44c4bc(0x8e)],'port':Number(_0x58cb98['port']),'secure':![],'auth':{'user':_0x58cb98[_0x44c4bc(0xbb)],'pass':_0x58cb98[_0x44c4bc(0x12c)]}}),_0x488807={'from':_0x58cb98['email'],'to':_0x1ad37c[0x0][_0x44c4bc(0x119)],'subject':_0x44c4bc(0xc8),'attachments':[{'filename':_0x44c4bc(0x11d),'path':__dirname+'/../public'+_0x44c4bc(0x121)+_0x2e59b0[0x0][_0x44c4bc(0xb0)],'cid':_0x44c4bc(0x106)}],'html':_0x44c4bc(0x89)+_0x44c4bc(0xc9)+_0x44c4bc(0x118)+_0x44c4bc(0xdd)+_0x44c4bc(0xc3)+_0x44c4bc(0xdd)+_0x44c4bc(0x8d)+_0x44c4bc(0xa7)+_0x44c4bc(0xdd)+'<h2>\x20'+_0x2e59b0[0x0]['site_title']+_0x44c4bc(0x128)+_0x44c4bc(0xa7)+_0x44c4bc(0xa7)+_0x44c4bc(0x123)+'<div>'+_0x44c4bc(0x108)+_0x44c4bc(0x12b)+_0x317b6a[_0x44c4bc(0x126)]+'\x20'+_0x44c4bc(0x132)+_0x44c4bc(0xe6)+_0x317b6a[_0x44c4bc(0x99)]+'\x20'+_0x44c4bc(0x127)+_0x44c4bc(0x111)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x44c4bc(0x95)+'<tr>'+_0x44c4bc(0x102)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x44c4bc(0xd6)+_0x44c4bc(0x9e)+_0x44c4bc(0x101)+_0x44c4bc(0xad)+_0x44c4bc(0x7d)+_0x44c4bc(0x92)+_0x44c4bc(0x68)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x472118+'\x20'+_0x44c4bc(0xc2)+_0x44c4bc(0xce)+_0x44c4bc(0xdd)+_0x44c4bc(0xfd)+_0x44c4bc(0x12a)+_0x2e59b0[0x0][_0x44c4bc(0xb6)]+'</h5>'+_0x44c4bc(0xa7)+_0x44c4bc(0xa7)+_0x44c4bc(0xbc)};_0x1bd43e[_0x44c4bc(0x9f)](_0x488807,function(_0x1daa04,_0x403a76){var _0x47fe21=_0x44c4bc;_0x1daa04?(console['log'](_0x1daa04),console[_0x47fe21(0x80)]('Error\x20Occurs')):console[_0x47fe21(0x80)](_0x47fe21(0x6a));}),_0x44a23c[_0x44c4bc(0x8f)](_0x44c4bc(0xc5),_0x44c4bc(0xff)),_0x32cc21[_0x44c4bc(0x7b)](_0x44c4bc(0x8b)+_0x3ab0d['_id']);}catch(_0x5a99ae){console['error'](_0x5a99ae),_0x32cc21['status'](0x1f4)[_0x44c4bc(0x73)]({'error':_0x44c4bc(0xdf)});}})[_0x34c527(0x76)](_0x1eefbb=>{var _0x4bf30c=_0x34c527;console['error'](_0x1eefbb),_0x32cc21['status'](0x1f4)[_0x4bf30c(0x73)]({'error':_0x4bf30c(0xc1)});});}catch(_0x5b57f9){_0x32cc21['json']({'message':_0x5b57f9['message']});}}),router['get'](a0_0x533a08(0xcc),auth,async(_0x2b6750,_0x3d5f72)=>{var _0x2a8856=a0_0x533a08;try{const {username:_0xc32734,email:_0x4af7c1,role:_0x308e89}=_0x2b6750[_0x2a8856(0x6f)],_0x44fc4a=_0x2b6750[_0x2a8856(0x6f)],_0x54663d=await profile[_0x2a8856(0x131)]({'email':_0x44fc4a[_0x2a8856(0xbb)]}),_0x176206=await master_shop[_0x2a8856(0xc7)]();console[_0x2a8856(0x80)](_0x2a8856(0x93),_0x176206);const _0x4e09f6=_0x2b6750['params']['id'],_0x391cf0=await adjustment_finished[_0x2a8856(0xea)]({'_id':_0x4e09f6});let _0x44d05e=new Date(_0x391cf0[_0x2a8856(0x114)]),_0x560ae6=('0'+_0x44d05e[_0x2a8856(0x82)]())[_0x2a8856(0xb8)](-0x2),_0x42d695=('0'+(_0x44d05e[_0x2a8856(0xa0)]()+0x1))['slice'](-0x2),_0x18534b=_0x44d05e[_0x2a8856(0xd4)](),_0x300e85=_0x18534b+'-'+_0x42d695+'-'+_0x560ae6;var _0x30f329=[_0x2a8856(0x69),_0x2a8856(0xb5),_0x2a8856(0x112)];const _0x59bc3f=await purchases[_0x2a8856(0xf9)]([{'$match':{'warehouse_name':_0x391cf0[_0x2a8856(0xa6)]}},{'$unwind':_0x2a8856(0xbe)},{'$group':{'_id':'$product.product_name'}}]);console[_0x2a8856(0x80)](_0x2a8856(0xb9),_0x59bc3f);const _0x1f3be2=await product[_0x2a8856(0xc7)]({}),_0xbac664=await warehouse['aggregate']([{'$match':{'name':_0x391cf0[_0x2a8856(0xa6)],'room':_0x391cf0['room']}},{'$unwind':_0x2a8856(0x7c)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2a8856(0x125)},'product_stock':{'$first':_0x2a8856(0xda)},'bay':{'$first':_0x2a8856(0x6d)},'bin':{'$first':_0x2a8856(0xf6)},'type':{'$first':_0x2a8856(0x75)},'floorlevel':{'$first':_0x2a8856(0x10c)},'primary_code':{'$first':_0x2a8856(0x122)},'secondary_code':{'$first':_0x2a8856(0x12f)},'product_code':{'$first':_0x2a8856(0x77)},'storage':{'$first':_0x2a8856(0xd3)},'rack':{'$first':_0x2a8856(0xca)}}}]);if(_0x176206[0x0][_0x2a8856(0x129)]==_0x2a8856(0xee)){var _0x399978=users[_0x2a8856(0xd8)];console[_0x2a8856(0x80)](_0x399978);}else{if(_0x176206[0x0][_0x2a8856(0x129)]=='Hindi')var _0x399978=users[_0x2a8856(0xd7)];else{if(_0x176206[0x0][_0x2a8856(0x129)]==_0x2a8856(0x83))var _0x399978=users[_0x2a8856(0x83)];else{if(_0x176206[0x0][_0x2a8856(0x129)]==_0x2a8856(0x7e))var _0x399978=users[_0x2a8856(0x7e)];else{if(_0x176206[0x0]['language']==_0x2a8856(0x74))var _0x399978=users['French'];else{if(_0x176206[0x0][_0x2a8856(0x129)]==_0x2a8856(0x71))var _0x399978=users[_0x2a8856(0x9d)];else{if(_0x176206[0x0][_0x2a8856(0x129)]==_0x2a8856(0x7a))var _0x399978=users[_0x2a8856(0x7a)];else{if(_0x176206[0x0][_0x2a8856(0x129)]==_0x2a8856(0x86))var _0x399978=users[_0x2a8856(0xfb)];}}}}}}}_0x3d5f72[_0x2a8856(0xfe)]('edit_adjustment_finished',{'success':_0x2b6750[_0x2a8856(0x8f)](_0x2a8856(0xc5)),'errors':_0x2b6750[_0x2a8856(0x8f)](_0x2a8856(0xe0)),'role':_0x44fc4a,'profile':_0x54663d,'adjustment':_0x391cf0,'stock':_0xbac664,'master_shop':_0x176206,'warehouse_name':_0x59bc3f,'unit':_0x1f3be2,'language':_0x399978,'rooms_data':_0x30f329,'ed_fullDate':_0x300e85});}catch(_0x400c13){console[_0x2a8856(0x80)](_0x400c13),_0x3d5f72[_0x2a8856(0xec)](0xc8)['json']({'message':_0x400c13[_0x2a8856(0xaa)]});}}),router[a0_0x533a08(0xc4)]('/view/:id',auth,async(_0x262b95,_0x193dd3)=>{var _0x639cb5=a0_0x533a08;try{const _0x4a9066=_0x262b95[_0x639cb5(0xa5)]['id'],_0x3249ec=await adjustment_finished[_0x639cb5(0xea)]({'_id':_0x4a9066}),_0xba6d8d=await warehouse[_0x639cb5(0x131)]({'name':_0x3249ec[_0x639cb5(0xa6)],'room':_0x3249ec[_0x639cb5(0x90)]}),{warehouse_name:_0x11b02f,date:_0x473e6b,prod_name:_0x4eee3b,level:_0x18b48e,isle:_0x23abc3,pallet:_0x882f86,stock:_0x4b9a73,types:_0x619ef7,adjust_qty:_0x20c8f8,new_adjust_qty:_0x4429f,note:_0x1e01fe,Room_name:_0x48b474,invoice:_0x181fe4,JO_number:_0x20bf00}=_0x262b95['body'];if(typeof _0x4eee3b==_0x639cb5(0xcb))var _0x56859b=[_0x262b95[_0x639cb5(0xa2)]['prod_name']],_0x3a3e5d=[_0x262b95[_0x639cb5(0xa2)][_0x639cb5(0xd9)]],_0x28234d=[_0x262b95['body']['stock']],_0x370d6d=[_0x262b95[_0x639cb5(0xa2)][_0x639cb5(0x12e)]],_0x84f589=[_0x262b95[_0x639cb5(0xa2)][_0x639cb5(0xba)]],_0x2995b7=[_0x262b95['body'][_0x639cb5(0x12d)]],_0x3c4f28=[_0x262b95[_0x639cb5(0xa2)][_0x639cb5(0x120)]],_0x5c6010=[_0x262b95[_0x639cb5(0xa2)][_0x639cb5(0xac)]],_0x42b67b=[_0x262b95[_0x639cb5(0xa2)][_0x639cb5(0x109)]],_0x1151c9=[_0x262b95[_0x639cb5(0xa2)]['batch_code']],_0x1940cb=[_0x262b95[_0x639cb5(0xa2)][_0x639cb5(0x114)]];else var _0x56859b=[..._0x262b95[_0x639cb5(0xa2)][_0x639cb5(0xdb)]],_0x3a3e5d=[..._0x262b95[_0x639cb5(0xa2)][_0x639cb5(0xd9)]],_0x28234d=[..._0x262b95[_0x639cb5(0xa2)][_0x639cb5(0xf8)]],_0x370d6d=[..._0x262b95[_0x639cb5(0xa2)][_0x639cb5(0x12e)]],_0x84f589=[..._0x262b95[_0x639cb5(0xa2)][_0x639cb5(0xba)]],_0x2995b7=[..._0x262b95[_0x639cb5(0xa2)]['new_adjust_qty']],_0x3c4f28=[..._0x262b95['body']['prod_code']],_0x5c6010=[..._0x262b95['body'][_0x639cb5(0xac)]],_0x42b67b=[..._0x262b95[_0x639cb5(0xa2)][_0x639cb5(0x109)]],_0x1151c9=[..._0x262b95['body'][_0x639cb5(0xf1)]],_0x1940cb=[..._0x262b95[_0x639cb5(0xa2)][_0x639cb5(0x114)]];const _0x528a60=_0x56859b['map'](_0x298dcc=>{return _0x298dcc={'product_name':_0x298dcc};});_0x3a3e5d[_0x639cb5(0x6b)]((_0x34beed,_0x3537f5)=>{_0x528a60[_0x3537f5]['bay']=_0x34beed;}),_0x28234d[_0x639cb5(0x6b)]((_0x49ab4d,_0x4cdb18)=>{var _0xf0633e=_0x639cb5;_0x528a60[_0x4cdb18][_0xf0633e(0xe5)]=_0x49ab4d;}),_0x370d6d['forEach']((_0x27991d,_0x286db0)=>{var _0x2ad5f4=_0x639cb5;_0x528a60[_0x286db0][_0x2ad5f4(0x12e)]=_0x27991d;}),_0x84f589[_0x639cb5(0x6b)]((_0x4b23ce,_0x5dcbaf)=>{var _0x77cd04=_0x639cb5;_0x528a60[_0x5dcbaf][_0x77cd04(0xba)]=_0x4b23ce;}),_0x2995b7[_0x639cb5(0x6b)]((_0x378f6c,_0x5cf4d6)=>{var _0xe5c855=_0x639cb5;_0x528a60[_0x5cf4d6][_0xe5c855(0x12d)]=_0x378f6c;}),_0x5c6010['forEach']((_0x50cf96,_0x385cbb)=>{var _0x247b48=_0x639cb5;_0x528a60[_0x385cbb][_0x247b48(0xac)]=_0x50cf96;}),_0x42b67b[_0x639cb5(0x6b)]((_0x33660c,_0x5432ef)=>{var _0x179763=_0x639cb5;_0x528a60[_0x5432ef][_0x179763(0xf0)]=_0x33660c;}),_0x3c4f28[_0x639cb5(0x6b)]((_0xa8ad27,_0x332287)=>{_0x528a60[_0x332287]['product_code']=_0xa8ad27;}),_0x1151c9[_0x639cb5(0x6b)]((_0x1f1e87,_0x4eae1d)=>{var _0x22809a=_0x639cb5;_0x528a60[_0x4eae1d][_0x22809a(0xf1)]=_0x1f1e87;}),_0x1940cb[_0x639cb5(0x6b)]((_0x5f2d0a,_0x1a11d8)=>{var _0x37d0b2=_0x639cb5;_0x528a60[_0x1a11d8][_0x37d0b2(0x114)]=_0x5f2d0a;});const _0x3fcb5d=_0x528a60['filter'](_0xea1de3=>_0xea1de3[_0x639cb5(0xba)]!=='0'&&_0xea1de3[_0x639cb5(0xba)]!=='');var _0x40bdda=0x0;_0x3fcb5d[_0x639cb5(0x6b)](_0x621dbc=>{var _0x5e94bf=_0x639cb5;console[_0x5e94bf(0x80)](_0x5e94bf(0xe4),_0x621dbc),parseInt(_0x621dbc['adjust_qty'])<=0x0&&_0x40bdda++;});if(_0x40bdda!=0x0)return _0x262b95[_0x639cb5(0x8f)](_0x639cb5(0xe0),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x193dd3[_0x639cb5(0x7b)](_0x639cb5(0x88));_0x3249ec[_0x639cb5(0xa6)]=_0x11b02f,_0x3249ec['date']=_0x473e6b,_0x3249ec[_0x639cb5(0x8c)]=_0x3fcb5d,_0x3249ec[_0x639cb5(0x10e)]=_0x1e01fe,_0x3249ec['room']=_0x48b474,_0x3249ec[_0x639cb5(0x126)]=_0x181fe4,_0x3249ec['JO_number']=_0x20bf00;const _0x2dab43=await _0x3249ec[_0x639cb5(0x100)](),_0x4b1531=await warehouse[_0x639cb5(0x131)]({'name':_0x11b02f,'room':_0x48b474});_0x2dab43[_0x639cb5(0x8c)][_0x639cb5(0x6b)](_0x18f223=>{var _0x458148=_0x639cb5;const _0x3a7be5=_0x4b1531[_0x458148(0x115)][_0x458148(0x81)](_0x311365=>{var _0x32a140=_0x458148;_0x18f223[_0x32a140(0x12e)]==_0x32a140(0x70)?_0x311365[_0x32a140(0x11a)]==_0x18f223[_0x32a140(0x11a)]&&_0x311365[_0x32a140(0x116)]==_0x18f223['bay']&&(_0x311365['product_stock']=parseInt(_0x311365['product_stock'])-parseInt(_0x18f223[_0x32a140(0xba)])):_0x311365[_0x32a140(0x11a)]==_0x18f223[_0x32a140(0x11a)]&&_0x311365[_0x32a140(0x116)]==_0x18f223[_0x32a140(0x116)]&&(_0x311365[_0x32a140(0xed)]=parseInt(_0x311365[_0x32a140(0xed)])+parseInt(_0x18f223[_0x32a140(0xba)]));});}),await _0x4b1531[_0x639cb5(0x100)](),_0x262b95['flash'](_0x639cb5(0xc5),_0x639cb5(0xf2)),_0x193dd3[_0x639cb5(0x7b)](_0x639cb5(0xe1));}catch(_0x5606e9){console[_0x639cb5(0x80)](_0x5606e9);}}),router['post'](a0_0x533a08(0x7f),async(_0x2e5a14,_0x5c10ed)=>{var _0x12d8b8=a0_0x533a08;const {primary_code:_0x1f2d51,warehouse_data:_0x2ab754,rooms_data:_0x312bbd,Roomslist:_0x460e98}=_0x2e5a14[_0x12d8b8(0xa2)],_0x221bb9=_0x460e98[_0x12d8b8(0xcf)](','),_0x47f274=[];async function _0x5d825a(_0x52ac86){var _0x45e721=_0x12d8b8;const _0x37718a=await warehouse[_0x45e721(0xf9)]([{'$match':{'name':_0x2ab754,'room':_0x52ac86}},{'$unwind':_0x45e721(0x7c)},{'$match':{'product_details.primary_code':_0x1f2d51}},{'$group':{'_id':_0x45e721(0xb4),'name':{'$first':_0x45e721(0x125)},'product_stock':{'$first':_0x45e721(0xda)},'primary_code':{'$first':_0x45e721(0x122)},'secondary_code':{'$first':_0x45e721(0x12f)},'product_code':{'$first':_0x45e721(0x77)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x45e721(0xf6)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x45e721(0x10c)},'unit':{'$first':_0x45e721(0x87)},'secondary_unit':{'$first':_0x45e721(0x10a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x45e721(0xa8)},'production_date':{'$first':_0x45e721(0xa4)},'batch_code':{'$first':_0x45e721(0x6e)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x45e721(0x105)},'roomNamed':{'$first':_0x45e721(0xef)},'invoice':{'$first':_0x45e721(0xbd)}}}]),_0x1e2fca=await warehouse[_0x45e721(0xf9)]([{'$match':{'name':_0x2ab754,'room':_0x52ac86}},{'$unwind':_0x45e721(0x7c)},{'$match':{'product_details.secondary_code':_0x1f2d51}},{'$group':{'_id':_0x45e721(0xb4),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x45e721(0x12f)},'product_code':{'$first':_0x45e721(0x77)},'level':{'$first':_0x45e721(0x6d)},'isle':{'$first':_0x45e721(0xf6)},'type':{'$first':_0x45e721(0x75)},'pallet':{'$first':_0x45e721(0x10c)},'unit':{'$first':_0x45e721(0x87)},'secondary_unit':{'$first':_0x45e721(0x10a)},'storage':{'$first':_0x45e721(0xd3)},'rack':{'$first':_0x45e721(0xca)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x45e721(0xa4)},'batch_code':{'$first':_0x45e721(0x6e)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x45e721(0x105)},'roomNamed':{'$first':_0x45e721(0xef)},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x37718a[_0x45e721(0xe8)]>0x0)_0x47f274[_0x45e721(0x107)](_0x37718a);else _0x1e2fca[_0x45e721(0xe8)]>0x0&&_0x47f274['push'](_0x1e2fca);}const _0x219b6a=_0x221bb9[_0x12d8b8(0x81)](_0x4d627e=>_0x5d825a(_0x4d627e));await Promise[_0x12d8b8(0xcd)](_0x219b6a),_0x5c10ed[_0x12d8b8(0x73)](_0x47f274);}),router[a0_0x533a08(0xc4)]('/CheckingWarehouse',async(_0x3d065d,_0x4032de)=>{var _0x1d736f=a0_0x533a08;const {productCode:_0x26c67b,bay:_0x2bb234,warehouses:_0x285dce,room:_0x5db8df}=_0x3d065d[_0x1d736f(0xa2)];console[_0x1d736f(0x80)](_0x3d065d[_0x1d736f(0xa2)]);try{const _0x35caac=await warehouse[_0x1d736f(0xf9)]([{'$match':{'name':_0x285dce,'room':_0x5db8df}},{'$unwind':_0x1d736f(0x7c)},{'$match':{'product_details.bay':parseInt(_0x2bb234)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1d736f(0x125)},'product_stock':{'$first':_0x1d736f(0xda)},'bay':{'$first':_0x1d736f(0x6d)},'maxProducts':{'$first':_0x1d736f(0x67)}}}]);_0x4032de[_0x1d736f(0xec)](0xc8)['json'](_0x35caac);}catch(_0xfd6987){_0x4032de['status'](0x194)[_0x1d736f(0x73)]({'message':_0xfd6987['message']});}}),module['exports']=router;