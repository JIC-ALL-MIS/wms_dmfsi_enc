function a0_0x57a9(_0x57da45,_0x5307e6){var _0x4f5913=a0_0x4f59();return a0_0x57a9=function(_0x57a925,_0x945194){_0x57a925=_0x57a925-0x1bb;var _0x17837f=_0x4f5913[_0x57a925];return _0x17837f;},a0_0x57a9(_0x57da45,_0x5307e6);}function a0_0x4f59(){var _0xc89b62=['warehouse','965280pUjjJq','$product_details.bin','product','foreach\x20newproduct','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.maxPerUnit','catch','back','render','edit_adjustment_finished_view','staff','product_date','<h2>\x20','string','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','createTransport','Hindi','<html><head><title></title>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','status','QA\x20Warehouse','Finished\x20Goods','</h5>','../middleware/auth','push','minus','7VdqaXW','date','3387552pDVhld','English','$product_details.rack','prod_name','image','save','adjust_qty','Ambient','</tbody>','2189680zCZKcj','then','Primary_Units','filter','Adjustment\x20Finalize\x20Successfully','True','adjustment_finished','flash','Enclosed','random','new_adjust_qty','_id','logo','ADJF-','/adjustment/view','$name','errors','<strong>\x20Regards\x20</strong>','expiry_date','$product_details.product_code','findById','room','sendMail','padStart','</head><body>','level','2751903lGTqTN','<tr>','$_id','$product_details.maxProducts','product_code','note','$product_details.expiry_date','German','purchases_data','stockBefore','5494776gAsmGm','redirect','Portuguese\x20(BR)','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/CheckingWarehouse','get','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','role','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','length','message','$product_details.primary_code','$warehouse_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$invoice','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','params','</div>','An\x20error\x20occurred\x20while\x20saving\x20data.','stock','$product_details.batch_code','room_names','/view','/preview/:id','Arabic','<span\x20style=\x22float:\x20right;\x22>','../models/all_models','/upload/','805599YhHtPT','French','Rooms','prod_invoice','<!DOCTYPE\x20html>','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','product_stock','FGSEmail','$product_details.storage','Spanish','forEach','<div>','slice','language','3350JfWngW','findOne','product_name','getFullYear','Return\x20Rooms','$date','batch_code','toString','$product_details.production_date','240BcjFOF','user','\x20Order\x20Date\x20:\x20','/picking_list/PDF_adjustment/','adjustment\x20data\x20update\x20successfully','prod_cat','bay','post','$product_details._id','json','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<h5>','split','/../public','Chinese','<hr\x20class=\x22my-3\x22>','$product_details.secondary_unit','New_Qty_Converted_adj','$product_details.bay','Error\x20Occurs','exports','/adjustment_finished/view','success','../public/language/languages.json','Arabic\x20(ae)','</thead>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','all','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','site_title','getMonth','host','$product_details.unit','nodemailer','map','log','$product_details.invoice','prod_code','<h5\x20style=\x22text-align:\x20left;\x22>','warehouse_name','$room','Secondary_units','$product_details.product_stock','DRY\x20GOODS','English\x20(US)','321EZEdes','master','$product.product_name','Enabled','\x20Order\x20Number\x20:\x20','secondary_unit','password','$product_details.floorlevel','New_Qty_Converted','/view/add_adjustment','/view/:id','Router','unit','$product.room_names','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','types','\x20</h2>','$product_details','adjustment\x20add\x20successfull','</tr>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.secondary_code','body','edit_adjustment_finished','$product','</body></html>','product_details','Email\x20sent\x20successfully','$product_details.product_name','Portuguese','invoice','$product_details.type','error','production_date'];a0_0x4f59=function(){return _0xc89b62;};return a0_0x4f59();}var a0_0x1db6a7=a0_0x57a9;(function(_0x5ae887,_0x42c992){var _0x2742cc=a0_0x57a9,_0x3cd318=_0x5ae887();while(!![]){try{var _0x23667a=-parseInt(_0x2742cc(0x247))/0x1*(parseInt(_0x2742cc(0x210))/0x2)+parseInt(_0x2742cc(0x1d9))/0x3+parseInt(_0x2742cc(0x286))/0x4+parseInt(_0x2742cc(0x1bf))/0x5+parseInt(_0x2742cc(0x1e3))/0x6*(parseInt(_0x2742cc(0x284))/0x7)+parseInt(_0x2742cc(0x26a))/0x8+parseInt(_0x2742cc(0x201))/0x9*(-parseInt(_0x2742cc(0x219))/0xa);if(_0x23667a===_0x42c992)break;else _0x3cd318['push'](_0x3cd318['shift']());}catch(_0x406dd4){_0x3cd318['push'](_0x3cd318['shift']());}}}(a0_0x4f59,0x86ec2));const express=require('express'),app=express(),router=express[a0_0x1db6a7(0x252)](),auth=require(a0_0x1db6a7(0x281)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x1db6a7(0x1ff)),users=require(a0_0x1db6a7(0x230)),nodemailer=require(a0_0x1db6a7(0x23b));router[a0_0x1db6a7(0x1e9)](a0_0x1db6a7(0x1fb),auth,async(_0x4a36c7,_0x18cdd0)=>{var _0x16d666=a0_0x1db6a7;try{const {username:_0x31fcfb,email:_0x295420,role:_0x3db7ee}=_0x4a36c7[_0x16d666(0x21a)],_0x206b4e=_0x4a36c7[_0x16d666(0x21a)],_0x2547d=await profile[_0x16d666(0x211)]({'email':_0x206b4e[_0x16d666(0x1f3)]}),_0x534a6c=await master_shop[_0x16d666(0x1e6)]();let _0x3bb149;if(_0x206b4e['role']=='staff'){const _0x7e1c6a=await staff['findOne']({'email':_0x206b4e['email']});_0x3bb149=await warehouse[_0x16d666(0x1e6)]({'status':'Enabled','name':_0x7e1c6a['warehouse']});}else _0x3bb149=await warehouse[_0x16d666(0x1e6)]({'status':_0x16d666(0x24a)});const _0x2c6810=await product[_0x16d666(0x1e6)]();let _0x375359;if(_0x206b4e[_0x16d666(0x1eb)]==_0x16d666(0x274)){const _0x205d14=await staff[_0x16d666(0x211)]({'email':_0x206b4e[_0x16d666(0x1f3)]});_0x375359=await adjustment_finished[_0x16d666(0x1e6)]({'warehouse_name':_0x205d14['warehouse']});}else _0x375359=await adjustment_finished[_0x16d666(0x206)]([{'$unwind':_0x16d666(0x25f)},{'$group':{'_id':_0x16d666(0x1db),'invoice':{'$first':_0x16d666(0x1f2)},'date':{'$first':_0x16d666(0x215)},'warehouse_name':{'$first':_0x16d666(0x1f0)},'room':{'$addToSet':_0x16d666(0x254)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x534a6c[0x0][_0x16d666(0x20f)]==_0x16d666(0x246)){var _0x15f58e=users['English'];console[_0x16d666(0x23d)](_0x15f58e);}else{if(_0x534a6c[0x0]['language']==_0x16d666(0x27a))var _0x15f58e=users[_0x16d666(0x27a)];else{if(_0x534a6c[0x0][_0x16d666(0x20f)]=='German')var _0x15f58e=users[_0x16d666(0x1e0)];else{if(_0x534a6c[0x0][_0x16d666(0x20f)]==_0x16d666(0x20b))var _0x15f58e=users['Spanish'];else{if(_0x534a6c[0x0][_0x16d666(0x20f)]==_0x16d666(0x202))var _0x15f58e=users[_0x16d666(0x202)];else{if(_0x534a6c[0x0][_0x16d666(0x20f)]==_0x16d666(0x1e5))var _0x15f58e=users[_0x16d666(0x264)];else{if(_0x534a6c[0x0][_0x16d666(0x20f)]==_0x16d666(0x227))var _0x15f58e=users['Chinese'];else{if(_0x534a6c[0x0][_0x16d666(0x20f)]==_0x16d666(0x231))var _0x15f58e=users[_0x16d666(0x1fd)];}}}}}}}_0x18cdd0[_0x16d666(0x272)](_0x16d666(0x1c5),{'success':_0x4a36c7[_0x16d666(0x1c6)](_0x16d666(0x22f)),'errors':_0x4a36c7[_0x16d666(0x1c6)]('errors'),'role':_0x206b4e,'profile':_0x2547d,'warehouse':_0x3bb149,'product':_0x2c6810,'adjustment':_0x375359,'master_shop':_0x534a6c,'language':_0x15f58e});}catch(_0x2c1092){console[_0x16d666(0x23d)](_0x2c1092);}});async function getRandom8DigitNumber(){var _0x4fec7c=a0_0x1db6a7;const _0xc71467=0x989680,_0x436d3e=0x5f5e0ff,_0x1e2f56=Math['floor'](Math[_0x4fec7c(0x1c8)]()*(_0x436d3e-_0xc71467+0x1))+_0xc71467;var _0x3643db;const _0x1887fa=await adjustment_finished[_0x4fec7c(0x211)]({'invoice':_0x4fec7c(0x1cc)+_0x1e2f56});return _0x1887fa&&_0x1887fa[_0x4fec7c(0x1ed)]>0x0?_0x3643db='ADJF-'+_0x1e2f56:_0x3643db=_0x4fec7c(0x1cc)+_0x1e2f56,_0x3643db;}router[a0_0x1db6a7(0x1e9)](a0_0x1db6a7(0x250),auth,async(_0x218acf,_0x504d2d)=>{var _0x550da0=a0_0x1db6a7;try{const {username:_0x344090,email:_0x1ecde4,role:_0x55d6bc}=_0x218acf[_0x550da0(0x21a)],_0x380cdd=_0x218acf[_0x550da0(0x21a)],_0x348360=await profile[_0x550da0(0x211)]({'email':_0x380cdd[_0x550da0(0x1f3)]}),_0x3b7a61=await master_shop['find']();let _0x342bfb;if(_0x380cdd[_0x550da0(0x1eb)]==_0x550da0(0x274)){const _0x26944e=await staff['findOne']({'email':_0x380cdd[_0x550da0(0x1f3)]});_0x342bfb=await warehouse[_0x550da0(0x206)]([{'$match':{'status':'Enabled','name':_0x26944e[_0x550da0(0x269)],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x550da0(0x27e)}}},{'$group':{'_id':_0x550da0(0x1ce),'name':{'$first':_0x550da0(0x1ce)}}}]);}else _0x342bfb=await warehouse[_0x550da0(0x206)]([{'$match':{'status':_0x550da0(0x24a),'warehouse_category':_0x550da0(0x27f),'name':{'$ne':_0x550da0(0x27e)}}},{'$group':{'_id':_0x550da0(0x1ce),'name':{'$first':_0x550da0(0x1ce)}}}]);const _0x2f11ba=await product[_0x550da0(0x1e6)]({}),_0x1fb6b9=await adjustment_finished[_0x550da0(0x1e6)]({}),_0x576137=_0x1fb6b9[_0x550da0(0x1ed)]+0x1,_0x4aed8f=_0x550da0(0x1cc)+_0x576137[_0x550da0(0x217)]()[_0x550da0(0x1d6)](0x5,'0');var _0x2a23f5=[_0x550da0(0x1bd),_0x550da0(0x1c7),'Return\x20Rooms'];if(_0x3b7a61[0x0]['language']==_0x550da0(0x246))var _0xe82c73=users[_0x550da0(0x287)];else{if(_0x3b7a61[0x0][_0x550da0(0x20f)]==_0x550da0(0x27a))var _0xe82c73=users[_0x550da0(0x27a)];else{if(_0x3b7a61[0x0][_0x550da0(0x20f)]=='German')var _0xe82c73=users[_0x550da0(0x1e0)];else{if(_0x3b7a61[0x0][_0x550da0(0x20f)]==_0x550da0(0x20b))var _0xe82c73=users[_0x550da0(0x20b)];else{if(_0x3b7a61[0x0][_0x550da0(0x20f)]==_0x550da0(0x202))var _0xe82c73=users[_0x550da0(0x202)];else{if(_0x3b7a61[0x0][_0x550da0(0x20f)]==_0x550da0(0x1e5))var _0xe82c73=users[_0x550da0(0x264)];else{if(_0x3b7a61[0x0][_0x550da0(0x20f)]==_0x550da0(0x227))var _0xe82c73=users['Chinese'];else{if(_0x3b7a61[0x0]['language']==_0x550da0(0x231))var _0xe82c73=users[_0x550da0(0x1fd)];}}}}}}}const _0x1f8966=getRandom8DigitNumber();_0x1f8966[_0x550da0(0x1c0)](_0x3a21fe=>{var _0x177012=_0x550da0;_0x504d2d[_0x177012(0x272)]('add_adjustment_finished',{'success':_0x218acf[_0x177012(0x1c6)](_0x177012(0x22f)),'errors':_0x218acf['flash'](_0x177012(0x1cf)),'role':_0x380cdd,'profile':_0x348360,'warehouse':_0x342bfb,'product':_0x2f11ba,'master_shop':_0x3b7a61,'language':_0xe82c73,'rooms_data':_0x2a23f5,'invoice_no':_0x3a21fe});})[_0x550da0(0x270)](_0x4f81d3=>{var _0x223c3d=_0x550da0;_0x218acf[_0x223c3d(0x1c6)](_0x223c3d(0x1cf),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x504d2d[_0x223c3d(0x1e4)](_0x223c3d(0x1cd));});}catch(_0x3fd9b9){console[_0x550da0(0x23d)](_0x3fd9b9);}}),router[a0_0x1db6a7(0x220)](a0_0x1db6a7(0x250),auth,async(_0x179216,_0x2f3b6c)=>{var _0x48bc2c=a0_0x1db6a7;try{const {warehouse_name:_0x309e1a,date:_0xe29820,prod_name:_0x1c85b1,level:_0x4be17f,isle:_0xe28e39,pallet:_0x449fca,stock:_0xb7585d,types:_0x49497b,adjust_qty:_0x4eb54a,new_adjust_qty:_0x3fbc9d,note:_0x32b8d1,Room_name:_0x3ec6af,invoice:_0x47d528,JO_number:_0x1b72d0,expiry_date:_0x2cf6d1}=_0x179216['body'];if(typeof _0x1c85b1=='string')var _0x373d72=[_0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x289)]],_0x224073=[_0x179216['body'][_0x48bc2c(0x1d8)]],_0x223a41=[_0x179216[_0x48bc2c(0x25d)]['stock']],_0xf010bc=[_0x179216['body'][_0x48bc2c(0x256)]],_0x307b29=[_0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x22a)]],_0xa7f099=[_0x179216['body'][_0x48bc2c(0x24f)]],_0x96a0e0=[_0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x1c1)]],_0x5cdfb2=[_0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x243)]],_0x2c7e4a=[_0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x23f)]],_0x4331c9=[_0x179216['body']['batch_code']],_0x23a05b=[_0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x1d1)]],_0x4d173d=[_0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x275)]],_0x1fcc97=[_0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x21e)]],_0x20b48a=[_0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x203)]],_0x472571=[_0x179216['body']['maxPerUnit']],_0x9011ea=[_0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x204)]];else var _0x373d72=[..._0x179216['body'][_0x48bc2c(0x289)]],_0x224073=[..._0x179216['body'][_0x48bc2c(0x1d8)]],_0x223a41=[..._0x179216['body'][_0x48bc2c(0x1f8)]],_0xf010bc=[..._0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x256)]],_0x307b29=[..._0x179216['body'][_0x48bc2c(0x22a)]],_0xa7f099=[..._0x179216[_0x48bc2c(0x25d)]['New_Qty_Converted']],_0x96a0e0=[..._0x179216[_0x48bc2c(0x25d)]['Primary_Units']],_0x5cdfb2=[..._0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x243)]],_0x2c7e4a=[..._0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x23f)]],_0x4331c9=[..._0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x216)]],_0x23a05b=[..._0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x1d1)]],_0x4d173d=[..._0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x275)]],_0x1fcc97=[..._0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x21e)]],_0x20b48a=[..._0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x203)]],_0x472571=[..._0x179216[_0x48bc2c(0x25d)]['maxPerUnit']],_0x9011ea=[..._0x179216[_0x48bc2c(0x25d)][_0x48bc2c(0x204)]];const _0x3513cc=_0x373d72[_0x48bc2c(0x23c)](_0x258302=>{return _0x258302={'product_name':_0x258302};});_0x224073[_0x48bc2c(0x20c)]((_0x3e151a,_0x2e9136)=>{var _0x1aed89=_0x48bc2c;_0x3513cc[_0x2e9136][_0x1aed89(0x21f)]=_0x3e151a;}),_0x223a41[_0x48bc2c(0x20c)]((_0x3d5fa1,_0x5052ee)=>{var _0xa872a9=_0x48bc2c;_0x3513cc[_0x5052ee][_0xa872a9(0x1e2)]=_0x3d5fa1;}),_0xf010bc[_0x48bc2c(0x20c)]((_0x3c671b,_0x123283)=>{_0x3513cc[_0x123283]['types']=_0x3c671b;}),_0x307b29[_0x48bc2c(0x20c)]((_0x468f6c,_0x37528c)=>{var _0xd8dfc4=_0x48bc2c;_0x3513cc[_0x37528c][_0xd8dfc4(0x1bc)]=_0x468f6c;}),_0xa7f099['forEach']((_0x187de4,_0x215177)=>{var _0xf52c4c=_0x48bc2c;_0x3513cc[_0x215177][_0xf52c4c(0x1c9)]=_0x187de4;}),_0x96a0e0[_0x48bc2c(0x20c)]((_0x476e3d,_0x394d74)=>{_0x3513cc[_0x394d74]['unit']=_0x476e3d;}),_0x5cdfb2['forEach']((_0x1ff49d,_0xd09544)=>{_0x3513cc[_0xd09544]['secondary_unit']=_0x1ff49d;}),_0x2c7e4a[_0x48bc2c(0x20c)]((_0x4c20f6,_0xaf3a7d)=>{var _0x2ba43a=_0x48bc2c;_0x3513cc[_0xaf3a7d][_0x2ba43a(0x1dd)]=_0x4c20f6;}),_0x4331c9[_0x48bc2c(0x20c)]((_0x407993,_0x1e4e95)=>{var _0x1700ee=_0x48bc2c;_0x3513cc[_0x1e4e95][_0x1700ee(0x216)]=_0x407993;}),_0x23a05b[_0x48bc2c(0x20c)]((_0x4f5015,_0x25f822)=>{var _0x245664=_0x48bc2c;_0x3513cc[_0x25f822][_0x245664(0x1d1)]=_0x4f5015;}),_0x4d173d[_0x48bc2c(0x20c)]((_0x438bba,_0x2ec0f5)=>{var _0x2181a1=_0x48bc2c;_0x3513cc[_0x2ec0f5][_0x2181a1(0x268)]=_0x438bba;}),_0x1fcc97[_0x48bc2c(0x20c)]((_0x1763dc,_0x501329)=>{var _0x352bf8=_0x48bc2c;_0x3513cc[_0x501329][_0x352bf8(0x21e)]=_0x1763dc;}),_0x20b48a['forEach']((_0x553569,_0x2ac5ce)=>{var _0x48b78e=_0x48bc2c;_0x3513cc[_0x2ac5ce][_0x48b78e(0x1fa)]=_0x553569;}),_0x472571[_0x48bc2c(0x20c)]((_0x41615a,_0x4d94d6)=>{_0x3513cc[_0x4d94d6]['maxPerUnit']=_0x41615a;}),_0x9011ea[_0x48bc2c(0x20c)]((_0x126e11,_0x5002bf)=>{var _0x1ed55e=_0x48bc2c;_0x3513cc[_0x5002bf][_0x1ed55e(0x265)]=_0x126e11;});const _0x3ba10f=_0x3513cc['filter'](_0x13e21d=>_0x13e21d['adjust_qty']!=='0'&&_0x13e21d['adjust_qty']!=='');var _0x1aa7b0=0x0;_0x3ba10f[_0x48bc2c(0x20c)](_0x36a000=>{var _0x38a95f=_0x48bc2c;console[_0x38a95f(0x23d)](_0x38a95f(0x26d),_0x36a000),parseInt(_0x36a000[_0x38a95f(0x1bc)])<=0x0&&_0x1aa7b0++;});if(_0x1aa7b0!=0x0)return _0x179216[_0x48bc2c(0x1c6)](_0x48bc2c(0x1cf),_0x48bc2c(0x25b)),_0x2f3b6c[_0x48bc2c(0x1e4)](_0x48bc2c(0x271));const _0x352e62=new adjustment_finished({'warehouse_name':_0x309e1a,'date':_0xe29820,'product':_0x3ba10f,'note':_0x32b8d1,'room':_0x3ec6af,'invoice':_0x47d528,'JO_number':_0x1b72d0,'expiry_date':_0x2cf6d1}),_0x37eb1c=await _0x352e62[_0x48bc2c(0x1bb)]();_0x179216[_0x48bc2c(0x1c6)](_0x48bc2c(0x22f),_0x48bc2c(0x259)),_0x2f3b6c[_0x48bc2c(0x1e4)]('/adjustment_finished/preview/'+_0x37eb1c[_0x48bc2c(0x1ca)]);}catch(_0x1d49f1){console[_0x48bc2c(0x23d)](_0x1d49f1),_0x2f3b6c[_0x48bc2c(0x27d)](0xc8)[_0x48bc2c(0x222)]({'message':_0x1d49f1[_0x48bc2c(0x1ee)]});}}),router['get'](a0_0x1db6a7(0x1fc),auth,async(_0x43b0fa,_0x359717)=>{var _0x38d4a1=a0_0x1db6a7;try{const {username:_0x30d0fe,email:_0x47fb1f,role:_0x3f8921}=_0x43b0fa[_0x38d4a1(0x21a)],_0x9678cd=_0x43b0fa[_0x38d4a1(0x21a)],_0x41897d=await profile[_0x38d4a1(0x211)]({'email':_0x9678cd['email']}),_0x351977=await master_shop['find'](),_0x3b2ef8=_0x43b0fa[_0x38d4a1(0x1f5)]['id'],_0x1bfc31=await adjustment_finished[_0x38d4a1(0x1d3)]({'_id':_0x3b2ef8}),_0x410020=await purchases[_0x38d4a1(0x206)]([{'$match':{'warehouse_name':_0x1bfc31[_0x38d4a1(0x241)]}},{'$unwind':_0x38d4a1(0x25f)},{'$group':{'_id':_0x38d4a1(0x249)}}]);console[_0x38d4a1(0x23d)](_0x38d4a1(0x1e1),_0x410020);const _0x53479f=await product[_0x38d4a1(0x1e6)]({}),_0x50cf6e=await warehouse[_0x38d4a1(0x206)]([{'$match':{'name':_0x1bfc31[_0x38d4a1(0x241)],'warehouse_category':_0x38d4a1(0x27f)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x38d4a1(0x221),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x38d4a1(0x244)},'bay':{'$first':_0x38d4a1(0x22b)},'bin':{'$first':_0x38d4a1(0x26b)},'type':{'$first':_0x38d4a1(0x266)},'floorlevel':{'$first':_0x38d4a1(0x24e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x38d4a1(0x25c)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x38d4a1(0x288)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x38d4a1(0x218)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x38d4a1(0x26f)},'room':{'$first':'$room'}}}]);if(_0x351977[0x0]['language']==_0x38d4a1(0x246)){var _0x2102ed=users[_0x38d4a1(0x287)];console[_0x38d4a1(0x23d)](_0x2102ed);}else{if(_0x351977[0x0]['language']==_0x38d4a1(0x27a))var _0x2102ed=users[_0x38d4a1(0x27a)];else{if(_0x351977[0x0][_0x38d4a1(0x20f)]==_0x38d4a1(0x1e0))var _0x2102ed=users[_0x38d4a1(0x1e0)];else{if(_0x351977[0x0][_0x38d4a1(0x20f)]==_0x38d4a1(0x20b))var _0x2102ed=users[_0x38d4a1(0x20b)];else{if(_0x351977[0x0][_0x38d4a1(0x20f)]==_0x38d4a1(0x202))var _0x2102ed=users[_0x38d4a1(0x202)];else{if(_0x351977[0x0][_0x38d4a1(0x20f)]==_0x38d4a1(0x1e5))var _0x2102ed=users[_0x38d4a1(0x264)];else{if(_0x351977[0x0][_0x38d4a1(0x20f)]==_0x38d4a1(0x227))var _0x2102ed=users[_0x38d4a1(0x227)];else{if(_0x351977[0x0][_0x38d4a1(0x20f)]==_0x38d4a1(0x231))var _0x2102ed=users[_0x38d4a1(0x1fd)];}}}}}}}_0x359717['render'](_0x38d4a1(0x273),{'success':_0x43b0fa[_0x38d4a1(0x1c6)](_0x38d4a1(0x22f)),'errors':_0x43b0fa[_0x38d4a1(0x1c6)](_0x38d4a1(0x1cf)),'role':_0x9678cd,'profile':_0x41897d,'adjustment':_0x1bfc31,'stock':_0x50cf6e,'master_shop':_0x351977,'warehouse_name':_0x410020,'unit':_0x53479f,'language':_0x2102ed});}catch(_0x5fd577){console['log'](_0x5fd577),_0x359717[_0x38d4a1(0x27d)](0xc8)[_0x38d4a1(0x222)]({'message':_0x5fd577[_0x38d4a1(0x1ee)]});}}),router[a0_0x1db6a7(0x220)](a0_0x1db6a7(0x1fc),auth,async(_0x24221e,_0x2e17b5)=>{var _0xd7636d=a0_0x1db6a7;try{const {invoice:_0x2a5404,warehouse_name:_0x182cbe,Room_name:_0x26ce2a}=_0x24221e[_0xd7636d(0x25d)],_0x5dd797=_0x24221e[_0xd7636d(0x1f5)]['id'],_0xb39eb2=await adjustment_finished[_0xd7636d(0x1d3)]({'_id':_0x5dd797});var _0x203edb;const _0x4d4d42=_0xb39eb2[_0xd7636d(0x26c)][_0xd7636d(0x23c)](async _0xd6d10f=>{var _0x397e4e=_0xd7636d;if(_0xd6d10f['adjust_qty']>0x0){_0x203edb=await warehouse[_0x397e4e(0x211)]({'name':_0x182cbe,'room':_0xd6d10f[_0x397e4e(0x1fa)],'warehouse_category':_0x397e4e(0x27f)});const _0x830ac5=_0x203edb['product_details']['map'](_0x336398=>{var _0x2633fd=_0x397e4e;console['log'](_0xd6d10f['types']);if(_0xd6d10f['types']==_0x2633fd(0x283))_0x336398[_0x2633fd(0x212)]==_0xd6d10f['product_name']&&_0x336398[_0x2633fd(0x21f)]==_0xd6d10f[_0x2633fd(0x21f)]&&_0x336398[_0x2633fd(0x1d1)]==_0xd6d10f[_0x2633fd(0x1d1)]&&_0x336398[_0x2633fd(0x268)]==_0xd6d10f[_0x2633fd(0x268)]&&_0x336398[_0x2633fd(0x216)]==_0xd6d10f[_0x2633fd(0x216)]&&_0x336398['invoice']==_0xd6d10f['invoice']&&(_0x336398[_0x2633fd(0x208)]=_0x336398[_0x2633fd(0x208)]-_0xd6d10f[_0x2633fd(0x1bc)]);else _0xd6d10f['types']=='add'&&(_0x336398[_0x2633fd(0x212)]==_0xd6d10f[_0x2633fd(0x212)]&&_0x336398[_0x2633fd(0x21f)]==_0xd6d10f[_0x2633fd(0x21f)]&&_0x336398[_0x2633fd(0x1d1)]==_0xd6d10f[_0x2633fd(0x1d1)]&&_0x336398[_0x2633fd(0x268)]==_0xd6d10f['production_date']&&_0x336398[_0x2633fd(0x216)]==_0xd6d10f[_0x2633fd(0x216)]&&_0x336398[_0x2633fd(0x265)]==_0xd6d10f[_0x2633fd(0x265)]&&(_0x336398[_0x2633fd(0x208)]=_0x336398[_0x2633fd(0x208)]+_0xd6d10f[_0x2633fd(0x1bc)]));});}return _0x203edb;});Promise['all'](_0x4d4d42)[_0xd7636d(0x1c0)](async _0x316158=>{var _0x4b75b3=_0xd7636d;try{for(const _0x491932 of _0x316158){await _0x491932[_0x4b75b3(0x1bb)]();}_0xb39eb2['finalize']=_0x4b75b3(0x1c4);const _0xca8b8f=await _0xb39eb2[_0x4b75b3(0x1bb)](),_0x54a4ae=await master_shop[_0x4b75b3(0x1e6)](),_0x668cbd=await email_settings[_0x4b75b3(0x211)](),_0x3dcec7=await supervisor_settings['find']();var _0x4284d2=_0xb39eb2[_0x4b75b3(0x26c)],_0x230f00='',_0x1ef1ad;for(_0x1ef1ad in _0x4284d2){var _0x44e353='FG';_0xb39eb2[_0x4b75b3(0x241)]==_0x4b75b3(0x245)&&(_0x44e353='DG'),_0x230f00+=_0x4b75b3(0x1da)+_0x4b75b3(0x233)+_0x4284d2[_0x1ef1ad]['product_name']+_0x4b75b3(0x235)+_0x4b75b3(0x233)+_0x4284d2[_0x1ef1ad][_0x4b75b3(0x1dd)]+_0x4b75b3(0x235)+_0x4b75b3(0x233)+_0x4284d2[_0x1ef1ad][_0x4b75b3(0x1bc)]+_0x4b75b3(0x235)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4284d2[_0x1ef1ad][_0x4b75b3(0x253)]+_0x4b75b3(0x235)+_0x4b75b3(0x233)+_0x4284d2[_0x1ef1ad][_0x4b75b3(0x24c)]+_0x4b75b3(0x235)+_0x4b75b3(0x233)+_0xb39eb2[_0x4b75b3(0x241)]+_0x4b75b3(0x235)+_0x4b75b3(0x233)+_0x4284d2[_0x1ef1ad]['room_names']+_0x4b75b3(0x235)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x44e353+_0x4284d2[_0x1ef1ad][_0x4b75b3(0x21f)]+_0x4b75b3(0x235)+_0x4b75b3(0x25a);}let _0x8fa6ce=nodemailer[_0x4b75b3(0x279)]({'host':_0x668cbd[_0x4b75b3(0x239)],'port':Number(_0x668cbd['port']),'secure':![],'auth':{'user':_0x668cbd[_0x4b75b3(0x1f3)],'pass':_0x668cbd[_0x4b75b3(0x24d)]}}),_0x53f056={'from':_0x668cbd[_0x4b75b3(0x1f3)],'to':_0x3dcec7[0x0][_0x4b75b3(0x209)],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x4b75b3(0x226)+_0x4b75b3(0x200)+_0x54a4ae[0x0][_0x4b75b3(0x28a)],'cid':_0x4b75b3(0x1cb)}],'html':_0x4b75b3(0x205)+_0x4b75b3(0x27b)+_0x4b75b3(0x1d7)+_0x4b75b3(0x20d)+_0x4b75b3(0x278)+'<div>'+_0x4b75b3(0x1ea)+'</div>'+_0x4b75b3(0x20d)+_0x4b75b3(0x276)+_0x54a4ae[0x0][_0x4b75b3(0x237)]+_0x4b75b3(0x257)+_0x4b75b3(0x1f6)+'</div>'+_0x4b75b3(0x228)+_0x4b75b3(0x20d)+_0x4b75b3(0x240)+_0x4b75b3(0x24b)+_0xb39eb2[_0x4b75b3(0x265)]+'\x20'+_0x4b75b3(0x1fe)+_0x4b75b3(0x21b)+_0xb39eb2[_0x4b75b3(0x285)]+'\x20'+'</span>'+_0x4b75b3(0x280)+_0x4b75b3(0x1f6)+_0x4b75b3(0x223)+_0x4b75b3(0x26e)+_0x4b75b3(0x1da)+_0x4b75b3(0x1f1)+_0x4b75b3(0x27c)+_0x4b75b3(0x255)+_0x4b75b3(0x1e7)+_0x4b75b3(0x1f4)+_0x4b75b3(0x207)+_0x4b75b3(0x236)+_0x4b75b3(0x1ec)+_0x4b75b3(0x25a)+_0x4b75b3(0x232)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x230f00+'\x20'+_0x4b75b3(0x1be)+'</table>'+_0x4b75b3(0x20d)+_0x4b75b3(0x1d0)+_0x4b75b3(0x224)+_0x54a4ae[0x0][_0x4b75b3(0x237)]+_0x4b75b3(0x280)+_0x4b75b3(0x1f6)+_0x4b75b3(0x1f6)+_0x4b75b3(0x260)};_0x8fa6ce[_0x4b75b3(0x1d5)](_0x53f056,function(_0x24f94b,_0x56c506){var _0x5eec1b=_0x4b75b3;_0x24f94b?(console[_0x5eec1b(0x23d)](_0x24f94b),console['log'](_0x5eec1b(0x22c))):console[_0x5eec1b(0x23d)](_0x5eec1b(0x262));}),_0x24221e[_0x4b75b3(0x1c6)](_0x4b75b3(0x22f),_0x4b75b3(0x1c3)),_0x2e17b5[_0x4b75b3(0x1e4)](_0x4b75b3(0x21c)+_0xca8b8f[_0x4b75b3(0x1ca)]);}catch(_0x26c03d){console[_0x4b75b3(0x267)](_0x26c03d),_0x2e17b5[_0x4b75b3(0x27d)](0x1f4)['json']({'error':_0x4b75b3(0x1f7)});}})[_0xd7636d(0x270)](_0x12bd59=>{var _0x401cec=_0xd7636d;console[_0x401cec(0x267)](_0x12bd59),_0x2e17b5[_0x401cec(0x27d)](0x1f4)[_0x401cec(0x222)]({'error':'An\x20error\x20occurred.'});});}catch(_0x23c2eb){_0x2e17b5['json']({'message':_0x23c2eb[_0xd7636d(0x1ee)]});}}),router[a0_0x1db6a7(0x1e9)](a0_0x1db6a7(0x251),auth,async(_0x54c71e,_0x5b43b6)=>{var _0x3c9b9f=a0_0x1db6a7;try{const {username:_0x1fe49d,email:_0x1584dd,role:_0x4dffdd}=_0x54c71e[_0x3c9b9f(0x21a)],_0x2c7968=_0x54c71e[_0x3c9b9f(0x21a)],_0x1d1c64=await profile['findOne']({'email':_0x2c7968[_0x3c9b9f(0x1f3)]}),_0x4c1957=await master_shop['find']();console[_0x3c9b9f(0x23d)](_0x3c9b9f(0x248),_0x4c1957);const _0x76b172=_0x54c71e[_0x3c9b9f(0x1f5)]['id'],_0x2497df=await adjustment_finished[_0x3c9b9f(0x1d3)]({'_id':_0x76b172});let _0x1002e8=new Date(_0x2497df[_0x3c9b9f(0x1d1)]),_0x5f32df=('0'+_0x1002e8['getDate']())['slice'](-0x2),_0x282c23=('0'+(_0x1002e8[_0x3c9b9f(0x238)]()+0x1))[_0x3c9b9f(0x20e)](-0x2),_0x35f4d1=_0x1002e8[_0x3c9b9f(0x213)](),_0x4fbfdf=_0x35f4d1+'-'+_0x282c23+'-'+_0x5f32df;var _0x404e4=[_0x3c9b9f(0x1bd),_0x3c9b9f(0x1c7),_0x3c9b9f(0x214)];const _0x4f0751=await purchases['aggregate']([{'$match':{'warehouse_name':_0x2497df[_0x3c9b9f(0x241)]}},{'$unwind':'$product'},{'$group':{'_id':_0x3c9b9f(0x249)}}]);console[_0x3c9b9f(0x23d)](_0x3c9b9f(0x1e1),_0x4f0751);const _0x4e0e41=await product[_0x3c9b9f(0x1e6)]({}),_0x46203e=await warehouse['aggregate']([{'$match':{'name':_0x2497df[_0x3c9b9f(0x241)],'room':_0x2497df[_0x3c9b9f(0x1d4)]}},{'$unwind':_0x3c9b9f(0x258)},{'$group':{'_id':_0x3c9b9f(0x221),'name':{'$first':_0x3c9b9f(0x263)},'product_stock':{'$first':_0x3c9b9f(0x244)},'bay':{'$first':_0x3c9b9f(0x22b)},'bin':{'$first':_0x3c9b9f(0x26b)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3c9b9f(0x1d2)},'storage':{'$first':_0x3c9b9f(0x20a)},'rack':{'$first':_0x3c9b9f(0x288)}}}]);if(_0x4c1957[0x0][_0x3c9b9f(0x20f)]=='English\x20(US)'){var _0xa5c4b3=users[_0x3c9b9f(0x287)];console[_0x3c9b9f(0x23d)](_0xa5c4b3);}else{if(_0x4c1957[0x0][_0x3c9b9f(0x20f)]==_0x3c9b9f(0x27a))var _0xa5c4b3=users[_0x3c9b9f(0x27a)];else{if(_0x4c1957[0x0]['language']==_0x3c9b9f(0x1e0))var _0xa5c4b3=users['German'];else{if(_0x4c1957[0x0]['language']==_0x3c9b9f(0x20b))var _0xa5c4b3=users['Spanish'];else{if(_0x4c1957[0x0]['language']==_0x3c9b9f(0x202))var _0xa5c4b3=users[_0x3c9b9f(0x202)];else{if(_0x4c1957[0x0][_0x3c9b9f(0x20f)]=='Portuguese\x20(BR)')var _0xa5c4b3=users[_0x3c9b9f(0x264)];else{if(_0x4c1957[0x0][_0x3c9b9f(0x20f)]==_0x3c9b9f(0x227))var _0xa5c4b3=users[_0x3c9b9f(0x227)];else{if(_0x4c1957[0x0][_0x3c9b9f(0x20f)]=='Arabic\x20(ae)')var _0xa5c4b3=users[_0x3c9b9f(0x1fd)];}}}}}}}_0x5b43b6[_0x3c9b9f(0x272)](_0x3c9b9f(0x25e),{'success':_0x54c71e[_0x3c9b9f(0x1c6)](_0x3c9b9f(0x22f)),'errors':_0x54c71e[_0x3c9b9f(0x1c6)](_0x3c9b9f(0x1cf)),'role':_0x2c7968,'profile':_0x1d1c64,'adjustment':_0x2497df,'stock':_0x46203e,'master_shop':_0x4c1957,'warehouse_name':_0x4f0751,'unit':_0x4e0e41,'language':_0xa5c4b3,'rooms_data':_0x404e4,'ed_fullDate':_0x4fbfdf});}catch(_0x4c0653){console[_0x3c9b9f(0x23d)](_0x4c0653),_0x5b43b6['status'](0xc8)[_0x3c9b9f(0x222)]({'message':_0x4c0653[_0x3c9b9f(0x1ee)]});}}),router['post']('/view/:id',auth,async(_0x49b73a,_0x5b3cd2)=>{var _0x4a3bc8=a0_0x1db6a7;try{const _0x5ca182=_0x49b73a[_0x4a3bc8(0x1f5)]['id'],_0x23935c=await adjustment_finished['findById']({'_id':_0x5ca182}),_0x404cb8=await warehouse[_0x4a3bc8(0x211)]({'name':_0x23935c[_0x4a3bc8(0x241)],'room':_0x23935c[_0x4a3bc8(0x1d4)]}),{warehouse_name:_0x18a29d,date:_0xde7c60,prod_name:_0x166914,level:_0x1e7e6b,isle:_0x3f7e56,pallet:_0x542c9e,stock:_0x1d119c,types:_0x4d9a31,adjust_qty:_0x247ccd,new_adjust_qty:_0x495b7b,note:_0x570d66,Room_name:_0x18a9fe,invoice:_0x4441c5,JO_number:_0x33ead3}=_0x49b73a[_0x4a3bc8(0x25d)];if(typeof _0x166914==_0x4a3bc8(0x277))var _0x665b5f=[_0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x289)]],_0x122780=[_0x49b73a[_0x4a3bc8(0x25d)]['level']],_0xd480f6=[_0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x1f8)]],_0x49997b=[_0x49b73a[_0x4a3bc8(0x25d)]['types']],_0xf87db4=[_0x49b73a[_0x4a3bc8(0x25d)]['adjust_qty']],_0x5284ed=[_0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x1c9)]],_0x32c64f=[_0x49b73a['body']['prod_code']],_0x4bbf5c=[_0x49b73a['body'][_0x4a3bc8(0x253)]],_0xbac2b6=[_0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x243)]],_0xbed5be=[_0x49b73a['body']['batch_code']],_0x85102f=[_0x49b73a[_0x4a3bc8(0x25d)]['expiry_date']];else var _0x665b5f=[..._0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x289)]],_0x122780=[..._0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x1d8)]],_0xd480f6=[..._0x49b73a['body'][_0x4a3bc8(0x1f8)]],_0x49997b=[..._0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x256)]],_0xf87db4=[..._0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x1bc)]],_0x5284ed=[..._0x49b73a['body']['new_adjust_qty']],_0x32c64f=[..._0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x23f)]],_0x4bbf5c=[..._0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x253)]],_0xbac2b6=[..._0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x243)]],_0xbed5be=[..._0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x216)]],_0x85102f=[..._0x49b73a[_0x4a3bc8(0x25d)][_0x4a3bc8(0x1d1)]];const _0xabb3ff=_0x665b5f[_0x4a3bc8(0x23c)](_0x37bc0a=>{return _0x37bc0a={'product_name':_0x37bc0a};});_0x122780[_0x4a3bc8(0x20c)]((_0x5c5b15,_0x63bebd)=>{var _0x17c99a=_0x4a3bc8;_0xabb3ff[_0x63bebd][_0x17c99a(0x21f)]=_0x5c5b15;}),_0xd480f6[_0x4a3bc8(0x20c)]((_0x1697f3,_0x55805a)=>{_0xabb3ff[_0x55805a]['stockBefore']=_0x1697f3;}),_0x49997b[_0x4a3bc8(0x20c)]((_0x17fd7c,_0x553185)=>{var _0x414b98=_0x4a3bc8;_0xabb3ff[_0x553185][_0x414b98(0x256)]=_0x17fd7c;}),_0xf87db4[_0x4a3bc8(0x20c)]((_0x2fd791,_0x5e2afe)=>{var _0x26b4ea=_0x4a3bc8;_0xabb3ff[_0x5e2afe][_0x26b4ea(0x1bc)]=_0x2fd791;}),_0x5284ed[_0x4a3bc8(0x20c)]((_0x12c46e,_0x4c81d7)=>{var _0x85638e=_0x4a3bc8;_0xabb3ff[_0x4c81d7][_0x85638e(0x1c9)]=_0x12c46e;}),_0x4bbf5c[_0x4a3bc8(0x20c)]((_0x2dc134,_0x1cf274)=>{var _0x4f83a3=_0x4a3bc8;_0xabb3ff[_0x1cf274][_0x4f83a3(0x253)]=_0x2dc134;}),_0xbac2b6[_0x4a3bc8(0x20c)]((_0x3ab925,_0x45c155)=>{var _0x388b48=_0x4a3bc8;_0xabb3ff[_0x45c155][_0x388b48(0x24c)]=_0x3ab925;}),_0x32c64f['forEach']((_0x12841f,_0x1c9039)=>{var _0x10e995=_0x4a3bc8;_0xabb3ff[_0x1c9039][_0x10e995(0x1dd)]=_0x12841f;}),_0xbed5be[_0x4a3bc8(0x20c)]((_0x40cb6a,_0xd43b39)=>{var _0x1c38f5=_0x4a3bc8;_0xabb3ff[_0xd43b39][_0x1c38f5(0x216)]=_0x40cb6a;}),_0x85102f[_0x4a3bc8(0x20c)]((_0x1836fc,_0x971477)=>{var _0x23195d=_0x4a3bc8;_0xabb3ff[_0x971477][_0x23195d(0x1d1)]=_0x1836fc;});const _0x4119e0=_0xabb3ff[_0x4a3bc8(0x1c2)](_0x5a4b55=>_0x5a4b55[_0x4a3bc8(0x1bc)]!=='0'&&_0x5a4b55[_0x4a3bc8(0x1bc)]!=='');var _0x268b15=0x0;_0x4119e0[_0x4a3bc8(0x20c)](_0x25576c=>{var _0x5690ba=_0x4a3bc8;console[_0x5690ba(0x23d)](_0x5690ba(0x26d),_0x25576c),parseInt(_0x25576c[_0x5690ba(0x1bc)])<=0x0&&_0x268b15++;});if(_0x268b15!=0x0)return _0x49b73a[_0x4a3bc8(0x1c6)]('errors',_0x4a3bc8(0x25b)),_0x5b3cd2[_0x4a3bc8(0x1e4)](_0x4a3bc8(0x271));_0x23935c[_0x4a3bc8(0x241)]=_0x18a29d,_0x23935c['date']=_0xde7c60,_0x23935c[_0x4a3bc8(0x26c)]=_0x4119e0,_0x23935c[_0x4a3bc8(0x1de)]=_0x570d66,_0x23935c['room']=_0x18a9fe,_0x23935c['invoice']=_0x4441c5,_0x23935c['JO_number']=_0x33ead3;const _0x19c136=await _0x23935c[_0x4a3bc8(0x1bb)](),_0x1b4166=await warehouse[_0x4a3bc8(0x211)]({'name':_0x18a29d,'room':_0x18a9fe});_0x19c136[_0x4a3bc8(0x26c)][_0x4a3bc8(0x20c)](_0x30aee9=>{var _0xbc326c=_0x4a3bc8;const _0x92d3f2=_0x1b4166[_0xbc326c(0x261)][_0xbc326c(0x23c)](_0x39c872=>{var _0x4fcc46=_0xbc326c;_0x30aee9[_0x4fcc46(0x256)]==_0x4fcc46(0x283)?_0x39c872['product_name']==_0x30aee9[_0x4fcc46(0x212)]&&_0x39c872[_0x4fcc46(0x21f)]==_0x30aee9[_0x4fcc46(0x21f)]&&(_0x39c872[_0x4fcc46(0x208)]=parseInt(_0x39c872[_0x4fcc46(0x208)])-parseInt(_0x30aee9[_0x4fcc46(0x1bc)])):_0x39c872[_0x4fcc46(0x212)]==_0x30aee9[_0x4fcc46(0x212)]&&_0x39c872['bay']==_0x30aee9[_0x4fcc46(0x21f)]&&(_0x39c872['product_stock']=parseInt(_0x39c872[_0x4fcc46(0x208)])+parseInt(_0x30aee9['adjust_qty']));});}),await _0x1b4166[_0x4a3bc8(0x1bb)](),_0x49b73a[_0x4a3bc8(0x1c6)](_0x4a3bc8(0x22f),_0x4a3bc8(0x21d)),_0x5b3cd2[_0x4a3bc8(0x1e4)](_0x4a3bc8(0x22e));}catch(_0x43d01f){console[_0x4a3bc8(0x23d)](_0x43d01f);}}),router[a0_0x1db6a7(0x220)]('/barcode_scanner',async(_0x5e2c99,_0xbd0dde)=>{var _0x39c9e1=a0_0x1db6a7;const {primary_code:_0x3f9d63,warehouse_data:_0x3aa91d,rooms_data:_0xa77492,Roomslist:_0x3d9987}=_0x5e2c99[_0x39c9e1(0x25d)],_0x468c66=_0x3d9987[_0x39c9e1(0x225)](','),_0x58d8f5=[];async function _0x17a0ba(_0x4900cd){var _0x13dd4e=_0x39c9e1;const _0x51d40a=await warehouse[_0x13dd4e(0x206)]([{'$match':{'name':_0x3aa91d,'room':_0x4900cd}},{'$unwind':_0x13dd4e(0x258)},{'$match':{'product_details.primary_code':_0x3f9d63}},{'$group':{'_id':_0x13dd4e(0x221),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x13dd4e(0x244)},'primary_code':{'$first':_0x13dd4e(0x1ef)},'secondary_code':{'$first':_0x13dd4e(0x25c)},'product_code':{'$first':_0x13dd4e(0x1d2)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x13dd4e(0x266)},'pallet':{'$first':_0x13dd4e(0x24e)},'unit':{'$first':_0x13dd4e(0x23a)},'secondary_unit':{'$first':_0x13dd4e(0x229)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x13dd4e(0x288)},'expiry_date':{'$first':_0x13dd4e(0x1df)},'production_date':{'$first':_0x13dd4e(0x218)},'batch_code':{'$first':_0x13dd4e(0x1f9)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x13dd4e(0x26f)},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x13dd4e(0x23e)}}}]),_0x3e8a0d=await warehouse['aggregate']([{'$match':{'name':_0x3aa91d,'room':_0x4900cd}},{'$unwind':_0x13dd4e(0x258)},{'$match':{'product_details.secondary_code':_0x3f9d63}},{'$group':{'_id':_0x13dd4e(0x221),'name':{'$first':_0x13dd4e(0x263)},'product_stock':{'$first':_0x13dd4e(0x244)},'primary_code':{'$first':_0x13dd4e(0x1ef)},'secondary_code':{'$first':_0x13dd4e(0x25c)},'product_code':{'$first':_0x13dd4e(0x1d2)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x13dd4e(0x26b)},'type':{'$first':_0x13dd4e(0x266)},'pallet':{'$first':_0x13dd4e(0x24e)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x13dd4e(0x229)},'storage':{'$first':_0x13dd4e(0x20a)},'rack':{'$first':_0x13dd4e(0x288)},'expiry_date':{'$first':_0x13dd4e(0x1df)},'production_date':{'$first':_0x13dd4e(0x218)},'batch_code':{'$first':_0x13dd4e(0x1f9)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x13dd4e(0x26f)},'roomNamed':{'$first':_0x13dd4e(0x242)},'invoice':{'$first':_0x13dd4e(0x23e)}}}]);if(_0x51d40a[_0x13dd4e(0x1ed)]>0x0)_0x58d8f5['push'](_0x51d40a);else _0x3e8a0d[_0x13dd4e(0x1ed)]>0x0&&_0x58d8f5[_0x13dd4e(0x282)](_0x3e8a0d);}const _0x119925=_0x468c66[_0x39c9e1(0x23c)](_0x499bb3=>_0x17a0ba(_0x499bb3));await Promise[_0x39c9e1(0x234)](_0x119925),_0xbd0dde[_0x39c9e1(0x222)](_0x58d8f5);}),router[a0_0x1db6a7(0x220)](a0_0x1db6a7(0x1e8),async(_0x31e01f,_0x17e945)=>{var _0xa4f1f4=a0_0x1db6a7;const {productCode:_0x2c9c2c,bay:_0x3ed59c,warehouses:_0x96f00,room:_0x2966ac}=_0x31e01f[_0xa4f1f4(0x25d)];console[_0xa4f1f4(0x23d)](_0x31e01f[_0xa4f1f4(0x25d)]);try{const _0x34965=await warehouse['aggregate']([{'$match':{'name':_0x96f00,'room':_0x2966ac}},{'$unwind':_0xa4f1f4(0x258)},{'$match':{'product_details.bay':parseInt(_0x3ed59c)}},{'$group':{'_id':_0xa4f1f4(0x221),'name':{'$first':_0xa4f1f4(0x263)},'product_stock':{'$first':_0xa4f1f4(0x244)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0xa4f1f4(0x1dc)}}}]);_0x17e945[_0xa4f1f4(0x27d)](0xc8)['json'](_0x34965);}catch(_0x4f1d8e){_0x17e945['status'](0x194)['json']({'message':_0x4f1d8e['message']});}}),module[a0_0x1db6a7(0x22d)]=router;