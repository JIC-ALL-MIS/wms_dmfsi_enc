var a0_0x1bc896=a0_0x13ec;(function(_0x364e0b,_0x937fa9){var _0x191474=a0_0x13ec,_0x2dedae=_0x364e0b();while(!![]){try{var _0xc8fbb3=-parseInt(_0x191474(0x145))/0x1+parseInt(_0x191474(0x153))/0x2+-parseInt(_0x191474(0x136))/0x3+parseInt(_0x191474(0x15b))/0x4+parseInt(_0x191474(0x126))/0x5+parseInt(_0x191474(0x167))/0x6*(-parseInt(_0x191474(0x152))/0x7)+-parseInt(_0x191474(0x15d))/0x8*(-parseInt(_0x191474(0x1c3))/0x9);if(_0xc8fbb3===_0x937fa9)break;else _0x2dedae['push'](_0x2dedae['shift']());}catch(_0x232ad1){_0x2dedae['push'](_0x2dedae['shift']());}}}(a0_0x28d2,0x9ca93));const express=require(a0_0x1bc896(0x13d)),app=express(),router=express[a0_0x1bc896(0x154)](),auth=require(a0_0x1bc896(0x1bd)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x1bc896(0x17a)),users=require(a0_0x1bc896(0x187)),nodemailer=require(a0_0x1bc896(0x192));router[a0_0x1bc896(0x1c2)](a0_0x1bc896(0x1d7),auth,async(_0x4c6e2b,_0x31e096)=>{var _0xf8e2d2=a0_0x1bc896;try{const {username:_0x32190b,email:_0x1740c0,role:_0x8e831a}=_0x4c6e2b['user'],_0x48771a=_0x4c6e2b[_0xf8e2d2(0x1cc)],_0x56aa05=await profile[_0xf8e2d2(0x14f)]({'email':_0x48771a[_0xf8e2d2(0x147)]}),_0x20cf83=await master_shop[_0xf8e2d2(0x165)]();let _0x17c796;if(_0x48771a[_0xf8e2d2(0x190)]=='staff'){const _0x558e46=await staff['findOne']({'email':_0x48771a[_0xf8e2d2(0x147)]});_0x17c796=await warehouse[_0xf8e2d2(0x165)]({'status':_0xf8e2d2(0x175),'name':_0x558e46[_0xf8e2d2(0x143)]});}else _0x17c796=await warehouse[_0xf8e2d2(0x165)]({'status':_0xf8e2d2(0x175)});const _0x430cad=await product[_0xf8e2d2(0x165)]();let _0x3d3002;if(_0x48771a[_0xf8e2d2(0x190)]==_0xf8e2d2(0x15a)){const _0xb90cb3=await staff['findOne']({'email':_0x48771a[_0xf8e2d2(0x147)]});_0x3d3002=await adjustment_finished[_0xf8e2d2(0x165)]({'warehouse_name':_0xb90cb3[_0xf8e2d2(0x143)]});}else _0x3d3002=await adjustment_finished[_0xf8e2d2(0x1be)]([{'$unwind':_0xf8e2d2(0x1b1)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0xf8e2d2(0x18d)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x20cf83[0x0][_0xf8e2d2(0x127)]=='English\x20(US)'){var _0x12fdc8=users[_0xf8e2d2(0x169)];console['log'](_0x12fdc8);}else{if(_0x20cf83[0x0][_0xf8e2d2(0x127)]==_0xf8e2d2(0x1ca))var _0x12fdc8=users[_0xf8e2d2(0x1ca)];else{if(_0x20cf83[0x0][_0xf8e2d2(0x127)]==_0xf8e2d2(0x1b3))var _0x12fdc8=users[_0xf8e2d2(0x1b3)];else{if(_0x20cf83[0x0]['language']==_0xf8e2d2(0x1d8))var _0x12fdc8=users['Spanish'];else{if(_0x20cf83[0x0][_0xf8e2d2(0x127)]==_0xf8e2d2(0x13f))var _0x12fdc8=users[_0xf8e2d2(0x13f)];else{if(_0x20cf83[0x0][_0xf8e2d2(0x127)]=='Portuguese\x20(BR)')var _0x12fdc8=users['Portuguese'];else{if(_0x20cf83[0x0]['language']=='Chinese')var _0x12fdc8=users[_0xf8e2d2(0x1b0)];else{if(_0x20cf83[0x0][_0xf8e2d2(0x127)]==_0xf8e2d2(0x1b7))var _0x12fdc8=users[_0xf8e2d2(0x19d)];}}}}}}}_0x31e096[_0xf8e2d2(0x1d9)](_0xf8e2d2(0x1c6),{'success':_0x4c6e2b['flash'](_0xf8e2d2(0x148)),'errors':_0x4c6e2b[_0xf8e2d2(0x178)](_0xf8e2d2(0x161)),'role':_0x48771a,'profile':_0x56aa05,'warehouse':_0x17c796,'product':_0x430cad,'adjustment':_0x3d3002,'master_shop':_0x20cf83,'language':_0x12fdc8});}catch(_0x4a1e85){console[_0xf8e2d2(0x141)](_0x4a1e85);}});function a0_0x13ec(_0x5eaadb,_0x52c79e){var _0x28d206=a0_0x28d2();return a0_0x13ec=function(_0x13ec44,_0x4699e6){_0x13ec44=_0x13ec44-0x11f;var _0x3ddb29=_0x28d206[_0x13ec44];return _0x3ddb29;},a0_0x13ec(_0x5eaadb,_0x52c79e);}async function getRandom8DigitNumber(){var _0x401455=a0_0x1bc896;const _0x7c9158=0x989680,_0x2fab24=0x5f5e0ff,_0x5a26be=Math[_0x401455(0x184)](Math[_0x401455(0x19f)]()*(_0x2fab24-_0x7c9158+0x1))+_0x7c9158;var _0x27ae09;const _0x5765fc=await adjustment_finished[_0x401455(0x14f)]({'invoice':_0x401455(0x140)+_0x5a26be});return _0x5765fc&&_0x5765fc[_0x401455(0x1a8)]>0x0?_0x27ae09=_0x401455(0x140)+_0x5a26be:_0x27ae09='ADJF-'+_0x5a26be,_0x27ae09;}router[a0_0x1bc896(0x1c2)](a0_0x1bc896(0x121),auth,async(_0x49ddfb,_0x56dc99)=>{var _0x2eefca=a0_0x1bc896;try{const {username:_0x28899c,email:_0xea7041,role:_0x4f2bc4}=_0x49ddfb[_0x2eefca(0x1cc)],_0x4bd206=_0x49ddfb[_0x2eefca(0x1cc)],_0x467b59=await profile[_0x2eefca(0x14f)]({'email':_0x4bd206[_0x2eefca(0x147)]}),_0xf97fc3=await master_shop[_0x2eefca(0x165)]();let _0x5869af;if(_0x4bd206[_0x2eefca(0x190)]==_0x2eefca(0x15a)){const _0x2943ba=await staff[_0x2eefca(0x14f)]({'email':_0x4bd206['email']});_0x5869af=await warehouse[_0x2eefca(0x1be)]([{'$match':{'status':_0x2eefca(0x175),'name':_0x2943ba[_0x2eefca(0x143)],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x2eefca(0x123)}}},{'$group':{'_id':_0x2eefca(0x1d4),'name':{'$first':_0x2eefca(0x1d4)}}}]);}else _0x5869af=await warehouse[_0x2eefca(0x1be)]([{'$match':{'status':_0x2eefca(0x175),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x2eefca(0x123)}}},{'$group':{'_id':_0x2eefca(0x1d4),'name':{'$first':'$name'}}}]);const _0xc58ccb=await product['find']({}),_0x13d676=await adjustment_finished[_0x2eefca(0x165)]({}),_0x4b5322=_0x13d676[_0x2eefca(0x1a8)]+0x1,_0x309f74=_0x2eefca(0x140)+_0x4b5322['toString']()['padStart'](0x5,'0');var _0x2bf4ab=['Ambient',_0x2eefca(0x162),_0x2eefca(0x1b5)];if(_0xf97fc3[0x0][_0x2eefca(0x127)]==_0x2eefca(0x1ac))var _0x281b9e=users[_0x2eefca(0x169)];else{if(_0xf97fc3[0x0][_0x2eefca(0x127)]==_0x2eefca(0x1ca))var _0x281b9e=users[_0x2eefca(0x1ca)];else{if(_0xf97fc3[0x0]['language']==_0x2eefca(0x1b3))var _0x281b9e=users[_0x2eefca(0x1b3)];else{if(_0xf97fc3[0x0]['language']==_0x2eefca(0x1d8))var _0x281b9e=users[_0x2eefca(0x1d8)];else{if(_0xf97fc3[0x0][_0x2eefca(0x127)]==_0x2eefca(0x13f))var _0x281b9e=users[_0x2eefca(0x13f)];else{if(_0xf97fc3[0x0]['language']==_0x2eefca(0x172))var _0x281b9e=users[_0x2eefca(0x1c5)];else{if(_0xf97fc3[0x0]['language']==_0x2eefca(0x1b0))var _0x281b9e=users['Chinese'];else{if(_0xf97fc3[0x0][_0x2eefca(0x127)]==_0x2eefca(0x1b7))var _0x281b9e=users[_0x2eefca(0x19d)];}}}}}}}const _0x347ab2=getRandom8DigitNumber();_0x347ab2[_0x2eefca(0x12c)](_0x122dee=>{var _0x1fbac2=_0x2eefca;_0x56dc99[_0x1fbac2(0x1d9)](_0x1fbac2(0x14a),{'success':_0x49ddfb[_0x1fbac2(0x178)](_0x1fbac2(0x148)),'errors':_0x49ddfb[_0x1fbac2(0x178)](_0x1fbac2(0x161)),'role':_0x4bd206,'profile':_0x467b59,'warehouse':_0x5869af,'product':_0xc58ccb,'master_shop':_0xf97fc3,'language':_0x281b9e,'rooms_data':_0x2bf4ab,'invoice_no':_0x122dee});})[_0x2eefca(0x1a2)](_0x4c801e=>{var _0x39490f=_0x2eefca;_0x49ddfb[_0x39490f(0x178)](_0x39490f(0x161),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x56dc99[_0x39490f(0x1af)]('/adjustment/view');});}catch(_0x28a1f4){console[_0x2eefca(0x141)](_0x28a1f4);}}),router[a0_0x1bc896(0x180)](a0_0x1bc896(0x121),auth,async(_0x2341b7,_0x412398)=>{var _0x43a869=a0_0x1bc896;try{const {warehouse_name:_0x2d3057,date:_0xe33567,prod_name:_0x420c63,level:_0x581502,isle:_0x103d75,pallet:_0x1d0a53,stock:_0x1d1b87,types:_0x31665c,adjust_qty:_0x3da5db,new_adjust_qty:_0x4f1f0a,note:_0x26db18,Room_name:_0x24bdc0,invoice:_0x2a24ed,JO_number:_0x1b735,expiry_date:_0x3d2b75}=_0x2341b7[_0x43a869(0x1b2)];if(typeof _0x420c63==_0x43a869(0x19c))var _0x202e30=[_0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x14e)]],_0x98788d=[_0x2341b7['body'][_0x43a869(0x174)]],_0x5586a9=[_0x2341b7['body']['stock']],_0x30e76d=[_0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x12b)]],_0xb9f8f5=[_0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x158)]],_0x223cf0=[_0x2341b7[_0x43a869(0x1b2)]['New_Qty_Converted']],_0xaa34e7=[_0x2341b7['body'][_0x43a869(0x159)]],_0x45013a=[_0x2341b7['body'][_0x43a869(0x1d2)]],_0x36243f=[_0x2341b7[_0x43a869(0x1b2)]['prod_code']],_0x1513c5=[_0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x1a0)]],_0x2eb097=[_0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x1cd)]],_0x4910fe=[_0x2341b7[_0x43a869(0x1b2)]['product_date']],_0x3ac7f0=[_0x2341b7['body'][_0x43a869(0x16f)]],_0x13e6ac=[_0x2341b7[_0x43a869(0x1b2)]['Rooms']],_0x513606=[_0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x17c)]],_0x4c7f80=[_0x2341b7[_0x43a869(0x1b2)]['prod_invoice']];else var _0x202e30=[..._0x2341b7['body']['prod_name']],_0x98788d=[..._0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x174)]],_0x5586a9=[..._0x2341b7['body'][_0x43a869(0x18c)]],_0x30e76d=[..._0x2341b7[_0x43a869(0x1b2)]['types']],_0xb9f8f5=[..._0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x158)]],_0x223cf0=[..._0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x195)]],_0xaa34e7=[..._0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x159)]],_0x45013a=[..._0x2341b7[_0x43a869(0x1b2)]['Secondary_units']],_0x36243f=[..._0x2341b7['body'][_0x43a869(0x11f)]],_0x1513c5=[..._0x2341b7['body'][_0x43a869(0x1a0)]],_0x2eb097=[..._0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x1cd)]],_0x4910fe=[..._0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x13e)]],_0x3ac7f0=[..._0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x16f)]],_0x13e6ac=[..._0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x186)]],_0x513606=[..._0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x17c)]],_0x4c7f80=[..._0x2341b7[_0x43a869(0x1b2)][_0x43a869(0x17e)]];const _0x564d06=_0x202e30[_0x43a869(0x196)](_0x387fd4=>{return _0x387fd4={'product_name':_0x387fd4};});_0x98788d[_0x43a869(0x1ba)]((_0x18a31e,_0x403685)=>{var _0x32b350=_0x43a869;_0x564d06[_0x403685][_0x32b350(0x1c8)]=_0x18a31e;}),_0x5586a9[_0x43a869(0x1ba)]((_0x94bf68,_0x43a8e1)=>{var _0x31575e=_0x43a869;_0x564d06[_0x43a8e1][_0x31575e(0x149)]=_0x94bf68;}),_0x30e76d['forEach']((_0x2bebc,_0x7f5f35)=>{_0x564d06[_0x7f5f35]['types']=_0x2bebc;}),_0xb9f8f5[_0x43a869(0x1ba)]((_0x486393,_0x4a07dc)=>{var _0x390473=_0x43a869;_0x564d06[_0x4a07dc][_0x390473(0x1a9)]=_0x486393;}),_0x223cf0[_0x43a869(0x1ba)]((_0x1b886f,_0xe27651)=>{var _0x57be41=_0x43a869;_0x564d06[_0xe27651][_0x57be41(0x131)]=_0x1b886f;}),_0xaa34e7[_0x43a869(0x1ba)]((_0xff1838,_0x17a819)=>{_0x564d06[_0x17a819]['unit']=_0xff1838;}),_0x45013a[_0x43a869(0x1ba)]((_0x475915,_0x128974)=>{_0x564d06[_0x128974]['secondary_unit']=_0x475915;}),_0x36243f[_0x43a869(0x1ba)]((_0x39fb56,_0x41cb50)=>{var _0xd572c1=_0x43a869;_0x564d06[_0x41cb50][_0xd572c1(0x182)]=_0x39fb56;}),_0x1513c5['forEach']((_0x1019b2,_0x3fe556)=>{_0x564d06[_0x3fe556]['batch_code']=_0x1019b2;}),_0x2eb097['forEach']((_0x412589,_0xcb0bd4)=>{var _0x37d81c=_0x43a869;_0x564d06[_0xcb0bd4][_0x37d81c(0x1cd)]=_0x412589;}),_0x4910fe[_0x43a869(0x1ba)]((_0x51f3c3,_0x2b2bb5)=>{var _0x1a0270=_0x43a869;_0x564d06[_0x2b2bb5][_0x1a0270(0x198)]=_0x51f3c3;}),_0x3ac7f0[_0x43a869(0x1ba)]((_0x4fcf74,_0x1a66c7)=>{var _0x40cc0d=_0x43a869;_0x564d06[_0x1a66c7][_0x40cc0d(0x16f)]=_0x4fcf74;}),_0x13e6ac[_0x43a869(0x1ba)]((_0x47a480,_0x1df6b4)=>{var _0x1ae48b=_0x43a869;_0x564d06[_0x1df6b4][_0x1ae48b(0x1b8)]=_0x47a480;}),_0x513606[_0x43a869(0x1ba)]((_0x394660,_0x323d16)=>{var _0x472526=_0x43a869;_0x564d06[_0x323d16][_0x472526(0x17c)]=_0x394660;}),_0x4c7f80[_0x43a869(0x1ba)]((_0x442447,_0x3c81ab)=>{_0x564d06[_0x3c81ab]['invoice']=_0x442447;});const _0x4838a7=_0x564d06['filter'](_0x3b5bb6=>_0x3b5bb6['adjust_qty']!=='0'&&_0x3b5bb6['adjust_qty']!=='');var _0x3ab2cd=0x0;_0x4838a7[_0x43a869(0x1ba)](_0xade5ee=>{var _0x322613=_0x43a869;console['log'](_0x322613(0x14b),_0xade5ee),parseInt(_0xade5ee['adjust_qty'])<=0x0&&_0x3ab2cd++;});if(_0x3ab2cd!=0x0)return _0x2341b7[_0x43a869(0x178)](_0x43a869(0x161),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x412398[_0x43a869(0x1af)]('back');const _0x504f0f=new adjustment_finished({'warehouse_name':_0x2d3057,'date':_0xe33567,'product':_0x4838a7,'note':_0x26db18,'room':_0x24bdc0,'invoice':_0x2a24ed,'JO_number':_0x1b735,'expiry_date':_0x3d2b75}),_0x365bca=await _0x504f0f['save']();_0x2341b7[_0x43a869(0x178)](_0x43a869(0x148),_0x43a869(0x197)),_0x412398[_0x43a869(0x1af)](_0x43a869(0x164)+_0x365bca['_id']);}catch(_0x18a0f4){console[_0x43a869(0x141)](_0x18a0f4),_0x412398['status'](0xc8)['json']({'message':_0x18a0f4[_0x43a869(0x1cb)]});}}),router[a0_0x1bc896(0x1c2)](a0_0x1bc896(0x183),auth,async(_0x2eb2a7,_0x13d31d)=>{var _0x3ee267=a0_0x1bc896;try{const {username:_0xd9cd41,email:_0x5dddc5,role:_0x34cca9}=_0x2eb2a7['user'],_0x17069d=_0x2eb2a7[_0x3ee267(0x1cc)],_0x4786aa=await profile[_0x3ee267(0x14f)]({'email':_0x17069d[_0x3ee267(0x147)]}),_0x49d9fd=await master_shop['find'](),_0x57df4c=_0x2eb2a7[_0x3ee267(0x142)]['id'],_0x92c37b=await adjustment_finished[_0x3ee267(0x18a)]({'_id':_0x57df4c}),_0x2dac3e=await purchases[_0x3ee267(0x1be)]([{'$match':{'warehouse_name':_0x92c37b[_0x3ee267(0x125)]}},{'$unwind':'$product'},{'$group':{'_id':_0x3ee267(0x181)}}]);console[_0x3ee267(0x141)](_0x3ee267(0x1b4),_0x2dac3e);const _0x2b311a=await product[_0x3ee267(0x165)]({}),_0x3a8e7e=await warehouse['aggregate']([{'$match':{'name':_0x92c37b[_0x3ee267(0x125)],'warehouse_category':_0x3ee267(0x15f)}},{'$unwind':_0x3ee267(0x146)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3ee267(0x191)},'product_stock':{'$first':_0x3ee267(0x15e)},'bay':{'$first':_0x3ee267(0x185)},'bin':{'$first':_0x3ee267(0x138)},'type':{'$first':_0x3ee267(0x1bb)},'floorlevel':{'$first':_0x3ee267(0x173)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3ee267(0x135)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3ee267(0x163)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3ee267(0x1a4)},'production_date':{'$first':_0x3ee267(0x16c)},'batch_code':{'$first':_0x3ee267(0x132)},'maxPerUnit':{'$first':_0x3ee267(0x14c)},'room':{'$first':_0x3ee267(0x14d)}}}]);if(_0x49d9fd[0x0][_0x3ee267(0x127)]=='English\x20(US)'){var _0x489b42=users[_0x3ee267(0x169)];console[_0x3ee267(0x141)](_0x489b42);}else{if(_0x49d9fd[0x0][_0x3ee267(0x127)]=='Hindi')var _0x489b42=users['Hindi'];else{if(_0x49d9fd[0x0]['language']==_0x3ee267(0x1b3))var _0x489b42=users[_0x3ee267(0x1b3)];else{if(_0x49d9fd[0x0][_0x3ee267(0x127)]=='Spanish')var _0x489b42=users[_0x3ee267(0x1d8)];else{if(_0x49d9fd[0x0]['language']==_0x3ee267(0x13f))var _0x489b42=users[_0x3ee267(0x13f)];else{if(_0x49d9fd[0x0]['language']==_0x3ee267(0x172))var _0x489b42=users['Portuguese'];else{if(_0x49d9fd[0x0][_0x3ee267(0x127)]==_0x3ee267(0x1b0))var _0x489b42=users[_0x3ee267(0x1b0)];else{if(_0x49d9fd[0x0][_0x3ee267(0x127)]=='Arabic\x20(ae)')var _0x489b42=users['Arabic'];}}}}}}}_0x13d31d['render'](_0x3ee267(0x17f),{'success':_0x2eb2a7['flash']('success'),'errors':_0x2eb2a7['flash'](_0x3ee267(0x161)),'role':_0x17069d,'profile':_0x4786aa,'adjustment':_0x92c37b,'stock':_0x3a8e7e,'master_shop':_0x49d9fd,'warehouse_name':_0x2dac3e,'unit':_0x2b311a,'language':_0x489b42});}catch(_0x1890c4){console[_0x3ee267(0x141)](_0x1890c4),_0x13d31d[_0x3ee267(0x1b6)](0xc8)[_0x3ee267(0x1d1)]({'message':_0x1890c4[_0x3ee267(0x1cb)]});}}),router['post'](a0_0x1bc896(0x183),auth,async(_0x1599f2,_0x116372)=>{var _0x3794e5=a0_0x1bc896;try{const {invoice:_0x4c0d4e,warehouse_name:_0x102f00,Room_name:_0x22a064}=_0x1599f2[_0x3794e5(0x1b2)],_0x2ce82c=_0x1599f2[_0x3794e5(0x142)]['id'],_0x1a503b=await adjustment_finished[_0x3794e5(0x18a)]({'_id':_0x2ce82c});var _0x4d49f6;const _0x448c27=_0x1a503b[_0x3794e5(0x1ce)][_0x3794e5(0x196)](async _0x15820=>{var _0x2f3e42=_0x3794e5;if(_0x15820[_0x2f3e42(0x1a9)]>0x0){_0x4d49f6=await warehouse['findOne']({'name':_0x102f00,'room':_0x15820[_0x2f3e42(0x1b8)],'warehouse_category':_0x2f3e42(0x15f)});const _0x465396=_0x4d49f6[_0x2f3e42(0x134)][_0x2f3e42(0x196)](_0x552975=>{var _0x552c8b=_0x2f3e42;console[_0x552c8b(0x141)](_0x15820[_0x552c8b(0x12b)]);if(_0x15820[_0x552c8b(0x12b)]==_0x552c8b(0x124))_0x552975[_0x552c8b(0x155)]==_0x15820[_0x552c8b(0x155)]&&_0x552975['bay']==_0x15820['bay']&&_0x552975[_0x552c8b(0x1cd)]==_0x15820['expiry_date']&&_0x552975[_0x552c8b(0x198)]==_0x15820[_0x552c8b(0x198)]&&_0x552975['batch_code']==_0x15820['batch_code']&&_0x552975['invoice']==_0x15820[_0x552c8b(0x199)]&&(_0x552975[_0x552c8b(0x17b)]=_0x552975[_0x552c8b(0x17b)]-_0x15820[_0x552c8b(0x1a9)]);else _0x15820[_0x552c8b(0x12b)]=='add'&&(_0x552975[_0x552c8b(0x155)]==_0x15820[_0x552c8b(0x155)]&&_0x552975['bay']==_0x15820[_0x552c8b(0x1c8)]&&_0x552975[_0x552c8b(0x1cd)]==_0x15820['expiry_date']&&_0x552975[_0x552c8b(0x198)]==_0x15820[_0x552c8b(0x198)]&&_0x552975[_0x552c8b(0x1a0)]==_0x15820[_0x552c8b(0x1a0)]&&_0x552975[_0x552c8b(0x199)]==_0x15820[_0x552c8b(0x199)]&&(_0x552975['product_stock']=_0x552975[_0x552c8b(0x17b)]+_0x15820[_0x552c8b(0x1a9)]));});}return _0x4d49f6;});Promise[_0x3794e5(0x1a3)](_0x448c27)[_0x3794e5(0x12c)](async _0xc7e22c=>{var _0x1230ce=_0x3794e5;try{for(const _0x41a3fa of _0xc7e22c){await _0x41a3fa[_0x1230ce(0x18f)]();}_0x1a503b['finalize']=_0x1230ce(0x1a7);const _0x261b05=await _0x1a503b['save'](),_0xbc1263=await master_shop[_0x1230ce(0x165)](),_0x49e598=await email_settings[_0x1230ce(0x14f)](),_0x20c4ec=await supervisor_settings[_0x1230ce(0x165)]();var _0x496ac2=_0x1a503b[_0x1230ce(0x1ce)],_0x127d95='',_0x39cf72;for(_0x39cf72 in _0x496ac2){var _0xca25eb='FG';_0x1a503b[_0x1230ce(0x125)]=='DRY\x20GOODS'&&(_0xca25eb='DG'),_0x127d95+=_0x1230ce(0x1a1)+_0x1230ce(0x137)+_0x496ac2[_0x39cf72][_0x1230ce(0x155)]+_0x1230ce(0x12a)+_0x1230ce(0x137)+_0x496ac2[_0x39cf72]['product_code']+_0x1230ce(0x12a)+_0x1230ce(0x137)+_0x496ac2[_0x39cf72][_0x1230ce(0x1a9)]+'</td>'+_0x1230ce(0x137)+_0x496ac2[_0x39cf72]['unit']+_0x1230ce(0x12a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x496ac2[_0x39cf72][_0x1230ce(0x139)]+_0x1230ce(0x12a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1a503b[_0x1230ce(0x125)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x496ac2[_0x39cf72][_0x1230ce(0x1b8)]+_0x1230ce(0x12a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xca25eb+_0x496ac2[_0x39cf72][_0x1230ce(0x1c8)]+_0x1230ce(0x12a)+_0x1230ce(0x15c);}let _0x4925de=nodemailer['createTransport']({'host':_0x49e598[_0x1230ce(0x128)],'port':Number(_0x49e598['port']),'secure':![],'auth':{'user':_0x49e598['email'],'pass':_0x49e598['password']}}),_0x354452={'from':_0x49e598[_0x1230ce(0x147)],'to':_0x20c4ec[0x0]['FGSEmail'],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x1230ce(0x1db)+_0x1230ce(0x1aa)+_0xbc1263[0x0][_0x1230ce(0x1c0)],'cid':_0x1230ce(0x188)}],'html':'<!DOCTYPE\x20html>'+_0x1230ce(0x133)+'</head><body>'+_0x1230ce(0x16d)+_0x1230ce(0x122)+_0x1230ce(0x16d)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x1230ce(0x1b9)+'<div>'+'<h2>\x20'+_0xbc1263[0x0][_0x1230ce(0x160)]+_0x1230ce(0x17d)+'</div>'+_0x1230ce(0x1b9)+_0x1230ce(0x1d6)+_0x1230ce(0x16d)+_0x1230ce(0x1ad)+'\x20Order\x20Number\x20:\x20'+_0x1a503b[_0x1230ce(0x199)]+'\x20'+_0x1230ce(0x1ab)+'\x20Order\x20Date\x20:\x20'+_0x1a503b[_0x1230ce(0x144)]+'\x20'+_0x1230ce(0x156)+_0x1230ce(0x194)+_0x1230ce(0x1b9)+_0x1230ce(0x1a5)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1230ce(0x1a1)+_0x1230ce(0x16a)+_0x1230ce(0x166)+_0x1230ce(0x170)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x1230ce(0x1c4)+_0x1230ce(0x1c9)+_0x1230ce(0x150)+_0x1230ce(0x15c)+_0x1230ce(0x12d)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x127d95+'\x20'+_0x1230ce(0x193)+_0x1230ce(0x19a)+'<div>'+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0xbc1263[0x0][_0x1230ce(0x160)]+_0x1230ce(0x194)+_0x1230ce(0x1b9)+_0x1230ce(0x1b9)+_0x1230ce(0x171)};_0x4925de[_0x1230ce(0x176)](_0x354452,function(_0xdb74b4,_0x2c3e0f){var _0xcc1489=_0x1230ce;_0xdb74b4?(console[_0xcc1489(0x141)](_0xdb74b4),console['log'](_0xcc1489(0x1d3))):console['log'](_0xcc1489(0x18e));}),_0x1599f2[_0x1230ce(0x178)](_0x1230ce(0x148),_0x1230ce(0x1c7)),_0x116372[_0x1230ce(0x1af)]('/picking_list/PDF_adjustment/'+_0x261b05[_0x1230ce(0x1da)]);}catch(_0xaa2cbe){console[_0x1230ce(0x13b)](_0xaa2cbe),_0x116372[_0x1230ce(0x1b6)](0x1f4)[_0x1230ce(0x1d1)]({'error':_0x1230ce(0x1d0)});}})[_0x3794e5(0x1a2)](_0x473d36=>{var _0x4f78d3=_0x3794e5;console['error'](_0x473d36),_0x116372[_0x4f78d3(0x1b6)](0x1f4)[_0x4f78d3(0x1d1)]({'error':'An\x20error\x20occurred.'});});}catch(_0x408588){_0x116372[_0x3794e5(0x1d1)]({'message':_0x408588[_0x3794e5(0x1cb)]});}}),router[a0_0x1bc896(0x1c2)](a0_0x1bc896(0x19e),auth,async(_0x5e4171,_0x2d64ef)=>{var _0x50a528=a0_0x1bc896;try{const {username:_0x13d73d,email:_0x1f8c39,role:_0x522ba2}=_0x5e4171[_0x50a528(0x1cc)],_0x70f2e4=_0x5e4171[_0x50a528(0x1cc)],_0x4a0ae0=await profile[_0x50a528(0x14f)]({'email':_0x70f2e4[_0x50a528(0x147)]}),_0x2cd416=await master_shop['find']();console[_0x50a528(0x141)](_0x50a528(0x130),_0x2cd416);const _0x194e70=_0x5e4171[_0x50a528(0x142)]['id'],_0x322f7a=await adjustment_finished['findById']({'_id':_0x194e70});let _0x25c5c5=new Date(_0x322f7a[_0x50a528(0x1cd)]),_0x5cd08a=('0'+_0x25c5c5[_0x50a528(0x18b)]())['slice'](-0x2),_0xb7ea0f=('0'+(_0x25c5c5[_0x50a528(0x13c)]()+0x1))[_0x50a528(0x168)](-0x2),_0x371a84=_0x25c5c5[_0x50a528(0x1ae)](),_0x54d163=_0x371a84+'-'+_0xb7ea0f+'-'+_0x5cd08a;var _0x2fa10c=[_0x50a528(0x12f),_0x50a528(0x162),_0x50a528(0x1b5)];const _0x367b66=await purchases['aggregate']([{'$match':{'warehouse_name':_0x322f7a['warehouse_name']}},{'$unwind':_0x50a528(0x1b1)},{'$group':{'_id':_0x50a528(0x181)}}]);console[_0x50a528(0x141)](_0x50a528(0x1b4),_0x367b66);const _0x2f8691=await product['find']({}),_0x4e8eed=await warehouse[_0x50a528(0x1be)]([{'$match':{'name':_0x322f7a['warehouse_name'],'room':_0x322f7a['room']}},{'$unwind':_0x50a528(0x146)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x50a528(0x15e)},'bay':{'$first':_0x50a528(0x185)},'bin':{'$first':_0x50a528(0x138)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x50a528(0x173)},'primary_code':{'$first':_0x50a528(0x1bc)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x50a528(0x1a6)},'storage':{'$first':_0x50a528(0x163)},'rack':{'$first':_0x50a528(0x129)}}}]);if(_0x2cd416[0x0][_0x50a528(0x127)]==_0x50a528(0x1ac)){var _0x5342af=users[_0x50a528(0x169)];console[_0x50a528(0x141)](_0x5342af);}else{if(_0x2cd416[0x0][_0x50a528(0x127)]==_0x50a528(0x1ca))var _0x5342af=users[_0x50a528(0x1ca)];else{if(_0x2cd416[0x0][_0x50a528(0x127)]==_0x50a528(0x1b3))var _0x5342af=users[_0x50a528(0x1b3)];else{if(_0x2cd416[0x0][_0x50a528(0x127)]==_0x50a528(0x1d8))var _0x5342af=users[_0x50a528(0x1d8)];else{if(_0x2cd416[0x0][_0x50a528(0x127)]==_0x50a528(0x13f))var _0x5342af=users[_0x50a528(0x13f)];else{if(_0x2cd416[0x0]['language']==_0x50a528(0x172))var _0x5342af=users[_0x50a528(0x1c5)];else{if(_0x2cd416[0x0]['language']==_0x50a528(0x1b0))var _0x5342af=users[_0x50a528(0x1b0)];else{if(_0x2cd416[0x0]['language']==_0x50a528(0x1b7))var _0x5342af=users['Arabic'];}}}}}}}_0x2d64ef[_0x50a528(0x1d9)]('edit_adjustment_finished',{'success':_0x5e4171[_0x50a528(0x178)](_0x50a528(0x148)),'errors':_0x5e4171['flash'](_0x50a528(0x161)),'role':_0x70f2e4,'profile':_0x4a0ae0,'adjustment':_0x322f7a,'stock':_0x4e8eed,'master_shop':_0x2cd416,'warehouse_name':_0x367b66,'unit':_0x2f8691,'language':_0x5342af,'rooms_data':_0x2fa10c,'ed_fullDate':_0x54d163});}catch(_0x140a47){console[_0x50a528(0x141)](_0x140a47),_0x2d64ef[_0x50a528(0x1b6)](0xc8)[_0x50a528(0x1d1)]({'message':_0x140a47[_0x50a528(0x1cb)]});}}),router[a0_0x1bc896(0x180)]('/view/:id',auth,async(_0x58fa01,_0x1256e5)=>{var _0x4f0fbb=a0_0x1bc896;try{const _0x2574e5=_0x58fa01['params']['id'],_0x1861d2=await adjustment_finished[_0x4f0fbb(0x18a)]({'_id':_0x2574e5}),_0x348f93=await warehouse[_0x4f0fbb(0x14f)]({'name':_0x1861d2[_0x4f0fbb(0x125)],'room':_0x1861d2[_0x4f0fbb(0x19b)]}),{warehouse_name:_0x29e437,date:_0xa4d4b8,prod_name:_0x3c5def,level:_0x203349,isle:_0x24f4e9,pallet:_0x3ebb1e,stock:_0x4d1ce3,types:_0x342ffc,adjust_qty:_0x10161f,new_adjust_qty:_0x537192,note:_0x2b5bc2,Room_name:_0x1f4d33,invoice:_0x3fbb0d,JO_number:_0x297982}=_0x58fa01[_0x4f0fbb(0x1b2)];if(typeof _0x3c5def==_0x4f0fbb(0x19c))var _0x9b2891=[_0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x14e)]],_0xa790c=[_0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x174)]],_0x4af239=[_0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x18c)]],_0x4f8f73=[_0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x12b)]],_0x32ed7b=[_0x58fa01['body'][_0x4f0fbb(0x1a9)]],_0x2ce114=[_0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x131)]],_0x2c4632=[_0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x11f)]],_0x2a574b=[_0x58fa01['body']['unit']],_0x52bed9=[_0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x1d2)]],_0x3d314b=[_0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x1a0)]],_0x2ea910=[_0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x1cd)]];else var _0x9b2891=[..._0x58fa01['body'][_0x4f0fbb(0x14e)]],_0xa790c=[..._0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x174)]],_0x4af239=[..._0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x18c)]],_0x4f8f73=[..._0x58fa01[_0x4f0fbb(0x1b2)]['types']],_0x32ed7b=[..._0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x1a9)]],_0x2ce114=[..._0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x131)]],_0x2c4632=[..._0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x11f)]],_0x2a574b=[..._0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x1bf)]],_0x52bed9=[..._0x58fa01[_0x4f0fbb(0x1b2)]['Secondary_units']],_0x3d314b=[..._0x58fa01['body'][_0x4f0fbb(0x1a0)]],_0x2ea910=[..._0x58fa01[_0x4f0fbb(0x1b2)][_0x4f0fbb(0x1cd)]];const _0x181e65=_0x9b2891[_0x4f0fbb(0x196)](_0x108e56=>{return _0x108e56={'product_name':_0x108e56};});_0xa790c[_0x4f0fbb(0x1ba)]((_0x52a737,_0xc2b777)=>{var _0x4030f8=_0x4f0fbb;_0x181e65[_0xc2b777][_0x4030f8(0x1c8)]=_0x52a737;}),_0x4af239[_0x4f0fbb(0x1ba)]((_0x14932b,_0x19399b)=>{_0x181e65[_0x19399b]['stockBefore']=_0x14932b;}),_0x4f8f73['forEach']((_0x3e3080,_0x47ba1d)=>{var _0x5f27bd=_0x4f0fbb;_0x181e65[_0x47ba1d][_0x5f27bd(0x12b)]=_0x3e3080;}),_0x32ed7b[_0x4f0fbb(0x1ba)]((_0x576fc6,_0x828c4b)=>{var _0x49084c=_0x4f0fbb;_0x181e65[_0x828c4b][_0x49084c(0x1a9)]=_0x576fc6;}),_0x2ce114[_0x4f0fbb(0x1ba)]((_0x184637,_0x5d1031)=>{var _0x2c8231=_0x4f0fbb;_0x181e65[_0x5d1031][_0x2c8231(0x131)]=_0x184637;}),_0x2a574b[_0x4f0fbb(0x1ba)]((_0x518c0b,_0x23297e)=>{_0x181e65[_0x23297e]['unit']=_0x518c0b;}),_0x52bed9['forEach']((_0x670f15,_0x7c489f)=>{_0x181e65[_0x7c489f]['secondary_unit']=_0x670f15;}),_0x2c4632[_0x4f0fbb(0x1ba)]((_0x2eae0d,_0x1bfc8c)=>{var _0x41e630=_0x4f0fbb;_0x181e65[_0x1bfc8c][_0x41e630(0x182)]=_0x2eae0d;}),_0x3d314b[_0x4f0fbb(0x1ba)]((_0x22b801,_0x466685)=>{var _0x25a75d=_0x4f0fbb;_0x181e65[_0x466685][_0x25a75d(0x1a0)]=_0x22b801;}),_0x2ea910[_0x4f0fbb(0x1ba)]((_0xa838f8,_0xfd51f2)=>{var _0x75d59b=_0x4f0fbb;_0x181e65[_0xfd51f2][_0x75d59b(0x1cd)]=_0xa838f8;});const _0x57d9c2=_0x181e65[_0x4f0fbb(0x13a)](_0x391619=>_0x391619[_0x4f0fbb(0x1a9)]!=='0'&&_0x391619[_0x4f0fbb(0x1a9)]!=='');var _0x1b16b7=0x0;_0x57d9c2[_0x4f0fbb(0x1ba)](_0x3107bf=>{var _0x576bb5=_0x4f0fbb;console['log'](_0x576bb5(0x14b),_0x3107bf),parseInt(_0x3107bf[_0x576bb5(0x1a9)])<=0x0&&_0x1b16b7++;});if(_0x1b16b7!=0x0)return _0x58fa01[_0x4f0fbb(0x178)](_0x4f0fbb(0x161),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x1256e5[_0x4f0fbb(0x1af)]('back');_0x1861d2[_0x4f0fbb(0x125)]=_0x29e437,_0x1861d2[_0x4f0fbb(0x144)]=_0xa4d4b8,_0x1861d2[_0x4f0fbb(0x1ce)]=_0x57d9c2,_0x1861d2['note']=_0x2b5bc2,_0x1861d2[_0x4f0fbb(0x19b)]=_0x1f4d33,_0x1861d2['invoice']=_0x3fbb0d,_0x1861d2['JO_number']=_0x297982;const _0x2e87d0=await _0x1861d2[_0x4f0fbb(0x18f)](),_0x14018c=await warehouse['findOne']({'name':_0x29e437,'room':_0x1f4d33});_0x2e87d0['product']['forEach'](_0xc7b423=>{const _0x3f471a=_0x14018c['product_details']['map'](_0x3b45f0=>{var _0x28b325=a0_0x13ec;_0xc7b423[_0x28b325(0x12b)]==_0x28b325(0x124)?_0x3b45f0[_0x28b325(0x155)]==_0xc7b423['product_name']&&_0x3b45f0[_0x28b325(0x1c8)]==_0xc7b423[_0x28b325(0x1c8)]&&(_0x3b45f0[_0x28b325(0x17b)]=parseInt(_0x3b45f0['product_stock'])-parseInt(_0xc7b423[_0x28b325(0x1a9)])):_0x3b45f0[_0x28b325(0x155)]==_0xc7b423[_0x28b325(0x155)]&&_0x3b45f0[_0x28b325(0x1c8)]==_0xc7b423[_0x28b325(0x1c8)]&&(_0x3b45f0[_0x28b325(0x17b)]=parseInt(_0x3b45f0[_0x28b325(0x17b)])+parseInt(_0xc7b423[_0x28b325(0x1a9)]));});}),await _0x14018c[_0x4f0fbb(0x18f)](),_0x58fa01['flash'](_0x4f0fbb(0x148),_0x4f0fbb(0x179)),_0x1256e5[_0x4f0fbb(0x1af)](_0x4f0fbb(0x120));}catch(_0x48a43f){console['log'](_0x48a43f);}}),router[a0_0x1bc896(0x180)](a0_0x1bc896(0x157),async(_0x39d127,_0x35360b)=>{var _0x4c4278=a0_0x1bc896;const {primary_code:_0x87fc65,warehouse_data:_0xc23e13,rooms_data:_0x36eaf2,Roomslist:_0x3551fc}=_0x39d127[_0x4c4278(0x1b2)],_0xc54599=_0x3551fc[_0x4c4278(0x1c1)](','),_0xd7530d=[];async function _0x3a0e25(_0x267ea9){var _0x12ebed=_0x4c4278;const _0x1e12a6=await warehouse[_0x12ebed(0x1be)]([{'$match':{'name':_0xc23e13,'room':_0x267ea9}},{'$unwind':_0x12ebed(0x146)},{'$match':{'product_details.primary_code':_0x87fc65}},{'$group':{'_id':_0x12ebed(0x16e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x12ebed(0x15e)},'primary_code':{'$first':_0x12ebed(0x1bc)},'secondary_code':{'$first':_0x12ebed(0x135)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x12ebed(0x185)},'isle':{'$first':_0x12ebed(0x138)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x12ebed(0x173)},'unit':{'$first':_0x12ebed(0x1d5)},'secondary_unit':{'$first':_0x12ebed(0x1cf)},'storage':{'$first':_0x12ebed(0x163)},'rack':{'$first':_0x12ebed(0x129)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x12ebed(0x16c)},'batch_code':{'$first':_0x12ebed(0x132)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x12ebed(0x14c)},'roomNamed':{'$first':_0x12ebed(0x14d)},'invoice':{'$first':_0x12ebed(0x16b)}}}]),_0x9b68ce=await warehouse['aggregate']([{'$match':{'name':_0xc23e13,'room':_0x267ea9}},{'$unwind':_0x12ebed(0x146)},{'$match':{'product_details.secondary_code':_0x87fc65}},{'$group':{'_id':_0x12ebed(0x16e),'name':{'$first':_0x12ebed(0x191)},'product_stock':{'$first':_0x12ebed(0x15e)},'primary_code':{'$first':_0x12ebed(0x1bc)},'secondary_code':{'$first':_0x12ebed(0x135)},'product_code':{'$first':_0x12ebed(0x1a6)},'level':{'$first':_0x12ebed(0x185)},'isle':{'$first':_0x12ebed(0x138)},'type':{'$first':_0x12ebed(0x1bb)},'pallet':{'$first':_0x12ebed(0x173)},'unit':{'$first':_0x12ebed(0x1d5)},'secondary_unit':{'$first':_0x12ebed(0x1cf)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x12ebed(0x129)},'expiry_date':{'$first':_0x12ebed(0x1a4)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x12ebed(0x132)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x12ebed(0x14c)},'roomNamed':{'$first':_0x12ebed(0x14d)},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x1e12a6[_0x12ebed(0x1a8)]>0x0)_0xd7530d[_0x12ebed(0x12e)](_0x1e12a6);else _0x9b68ce[_0x12ebed(0x1a8)]>0x0&&_0xd7530d[_0x12ebed(0x12e)](_0x9b68ce);}const _0x2e7940=_0xc54599[_0x4c4278(0x196)](_0x85d61f=>_0x3a0e25(_0x85d61f));await Promise[_0x4c4278(0x1a3)](_0x2e7940),_0x35360b[_0x4c4278(0x1d1)](_0xd7530d);}),router[a0_0x1bc896(0x180)](a0_0x1bc896(0x189),async(_0x12c618,_0x4ec1e0)=>{var _0x214137=a0_0x1bc896;const {productCode:_0x2f2cff,bay:_0x4e6fd1,warehouses:_0x139809,room:_0xda6106}=_0x12c618[_0x214137(0x1b2)];console['log'](_0x12c618[_0x214137(0x1b2)]);try{const _0x14b1b8=await warehouse['aggregate']([{'$match':{'name':_0x139809,'room':_0xda6106}},{'$unwind':_0x214137(0x146)},{'$match':{'product_details.bay':parseInt(_0x4e6fd1)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x214137(0x191)},'product_stock':{'$first':_0x214137(0x15e)},'bay':{'$first':_0x214137(0x185)},'maxProducts':{'$first':_0x214137(0x151)}}}]);_0x4ec1e0[_0x214137(0x1b6)](0xc8)[_0x214137(0x1d1)](_0x14b1b8);}catch(_0x20ac97){_0x4ec1e0[_0x214137(0x1b6)](0x194)['json']({'message':_0x20ac97[_0x214137(0x1cb)]});}}),module[a0_0x1bc896(0x177)]=router;function a0_0x28d2(){var _0x2d10ad=['get','231318lGXvlC','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Portuguese','adjustment_finished','Adjustment\x20Finalize\x20Successfully','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Hindi','message','user','expiry_date','product','$product_details.secondary_unit','An\x20error\x20occurred\x20while\x20saving\x20data.','json','Secondary_units','Error\x20Occurs','$name','$product_details.unit','<hr\x20class=\x22my-3\x22>','/view','Spanish','render','_id','/../public','prod_code','/adjustment_finished/view','/view/add_adjustment','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','QA\x20Warehouse','minus','warehouse_name','4994925GTuKbp','language','host','$product_details.rack','</td>','types','then','</thead>','push','Ambient','master','new_adjust_qty','$product_details.batch_code','<html><head><title></title>','product_details','$product_details.secondary_code','2529546cfkvkB','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.bin','secondary_unit','filter','error','getMonth','express','product_date','French','ADJF-','log','params','warehouse','date','360112iMSkfW','$product_details','email','success','stockBefore','add_adjustment_finished','foreach\x20newproduct','$product_details.maxPerUnit','$room','prod_name','findOne','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.maxProducts','3570euayRx','669196IyKFpi','Router','product_name','</span>','/barcode_scanner','New_Qty_Converted_adj','Primary_Units','staff','998448djMBIY','</tr>','208zvJsDV','$product_details.product_stock','Finished\x20Goods','site_title','errors','Enclosed','$product_details.storage','/adjustment_finished/preview/','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','4782NQJADw','slice','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.invoice','$product_details.production_date','<div>','$product_details._id','prod_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','</body></html>','Portuguese\x20(BR)','$product_details.floorlevel','level','Enabled','sendMail','exports','flash','adjustment\x20data\x20update\x20successfully','../models/all_models','product_stock','maxPerUnit','\x20</h2>','prod_invoice','edit_adjustment_finished_view','post','$product.product_name','product_code','/preview/:id','floor','$product_details.bay','Rooms','../public/language/languages.json','logo','/CheckingWarehouse','findById','getDate','stock','$product.room_names','Email\x20sent\x20successfully','save','role','$product_details.product_name','nodemailer','</tbody>','</h5>','New_Qty_Converted','map','adjustment\x20add\x20successfull','production_date','invoice','</table>','room','string','Arabic','/view/:id','random','batch_code','<tr>','catch','all','$product_details.expiry_date','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.product_code','True','length','adjust_qty','/upload/','<span\x20style=\x22float:\x20right;\x22>','English\x20(US)','<h5\x20style=\x22text-align:\x20left;\x22>','getFullYear','redirect','Chinese','$product','body','German','purchases_data','Return\x20Rooms','status','Arabic\x20(ae)','room_names','</div>','forEach','$product_details.type','$product_details.primary_code','../middleware/auth','aggregate','unit','image','split'];a0_0x28d2=function(){return _0x2d10ad;};return a0_0x28d2();}