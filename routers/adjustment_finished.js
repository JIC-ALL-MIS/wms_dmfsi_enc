function a0_0x3311(_0x3e6c39,_0x4dac1e){var _0x5bfbf5=a0_0x5bfb();return a0_0x3311=function(_0x331114,_0xea87f){_0x331114=_0x331114-0x165;var _0x4d0872=_0x5bfbf5[_0x331114];return _0x4d0872;},a0_0x3311(_0x3e6c39,_0x4dac1e);}function a0_0x5bfb(){var _0x1a88e8=['Adjustment\x20Finalize\x20Successfully','findById','$product_details','$product_details.batch_code','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','log','$product_details.primary_code','map','product_details','status','stock','Arabic\x20(ae)','product_date','createTransport','</td>','1897480uUHAJs','Secondary_units','prod_name','</h5>','body','port','ADJF-','QA\x20Warehouse','foreach\x20newproduct','room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','product','$product_details.secondary_code','<span\x20style=\x22float:\x20right;\x22>','Error\x20Occurs','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','9MCOMdd','catch','1177opHdiw','secondary_unit','English','date','warehouse','$product_details.unit','express','stockBefore','random','aggregate','8aeDsdi','getDate','$product_details.type','/adjustment_finished/preview/','new_adjust_qty','$product_details.secondary_unit','$finalize','New_Qty_Converted','/barcode_scanner','string','True','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.maxPerUnit','get','flash','$product_details.storage','length','</head><body>','<div>','post','$product_details.bin','then','json','1408939SFmhYz','image','An\x20error\x20occurred.','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/picking_list/PDF_adjustment/','German','\x20Order\x20Date\x20:\x20','logo','batch_code','$product.product_name','Primary_Units','$product_details.floorlevel','Portuguese','save','prod_invoice','Enabled','<html><head><title></title>','product_code','edit_adjustment_finished_view','push','/upload/','<h2>\x20','role','edit_adjustment_finished','$invoice','minus','errors','email','Email\x20sent\x20successfully','Logo.png','<tbody\x20style=\x22text-align:\x20center;\x22>','level','18818KynSIf','</body></html>','$product_details.production_date','152508wBOpfC','filter','$room','adjust_qty','finalize','add_adjustment_finished','find','$product_details.product_name','warehouse_name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.expiry_date','Spanish','prod_code','padStart','$_id','unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','JO_number','Hindi','/view/:id','450885rDDmGi','room_names','$product_details.maxProducts','<strong>\x20Regards\x20</strong>','Arabic','$product_details._id','prod_cat','../middleware/auth','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','New_Qty_Converted_adj','$product_details.bay','types','expiry_date','</span>','adjustment\x20add\x20successfull','</div>','FGSEmail','7919370wQMcxH','message','560640lweUNr','redirect','/CheckingWarehouse','$product.room_names','$product_details.rack','floor','error','success','production_date','staff','forEach','/view/add_adjustment','_id','render','$product_details.product_stock','split','product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','password','$product','../public/language/languages.json','Finished\x20Goods','Enclosed','/adjustment/view','Chinese','language','French','$name','params','../models/all_models','24rnFiUC','nodemailer','slice','Return\x20Rooms','bay','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_name','note','host','</tbody>','findOne','An\x20error\x20occurred\x20while\x20saving\x20data.','getFullYear','English\x20(US)','/adjustment_finished/view','/preview/:id','user','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.invoice','master','back','$product_details.product_code','<h5>','DRY\x20GOODS','getMonth','all','adjustment\x20data\x20update\x20successfully','24Ylavbb','Portuguese\x20(BR)'];a0_0x5bfb=function(){return _0x1a88e8;};return a0_0x5bfb();}var a0_0x472d95=a0_0x3311;(function(_0xd2ddc3,_0x2d0879){var _0x119117=a0_0x3311,_0x3eb035=_0xd2ddc3();while(!![]){try{var _0x427fd3=-parseInt(_0x119117(0x1bd))/0x1*(parseInt(_0x119117(0x1f4))/0x2)+parseInt(_0x119117(0x20b))/0x3*(parseInt(_0x119117(0x174))/0x4)+parseInt(_0x119117(0x21f))/0x5+parseInt(_0x119117(0x18f))/0x6*(-parseInt(_0x119117(0x1d4))/0x7)+parseInt(_0x119117(0x1a0))/0x8+parseInt(_0x119117(0x1b1))/0x9*(-parseInt(_0x119117(0x21d))/0xa)+-parseInt(_0x119117(0x1b3))/0xb*(-parseInt(_0x119117(0x1f7))/0xc);if(_0x427fd3===_0x2d0879)break;else _0x3eb035['push'](_0x3eb035['shift']());}catch(_0x1abcb1){_0x3eb035['push'](_0x3eb035['shift']());}}}(a0_0x5bfb,0xe5285));const express=require(a0_0x472d95(0x1b9)),app=express(),router=express['Router'](),auth=require(a0_0x472d95(0x212)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x472d95(0x173)),users=require(a0_0x472d95(0x16a)),nodemailer=require(a0_0x472d95(0x175));router[a0_0x472d95(0x1ca)]('/view',auth,async(_0xa0b7e4,_0x3a22a4)=>{var _0x3d08d8=a0_0x472d95;try{const {username:_0x4b6194,email:_0x28c980,role:_0x1e8718}=_0xa0b7e4['user'],_0x13e2e2=_0xa0b7e4[_0x3d08d8(0x184)],_0x11776d=await profile['findOne']({'email':_0x13e2e2[_0x3d08d8(0x1ef)]}),_0xf3a2c9=await master_shop[_0x3d08d8(0x1fd)]();let _0x320e68;if(_0x13e2e2[_0x3d08d8(0x1ea)]=='staff'){const _0x4e7040=await staff[_0x3d08d8(0x17e)]({'email':_0x13e2e2[_0x3d08d8(0x1ef)]});_0x320e68=await warehouse[_0x3d08d8(0x1fd)]({'status':_0x3d08d8(0x1e3),'name':_0x4e7040[_0x3d08d8(0x1b7)]});}else _0x320e68=await warehouse['find']({'status':_0x3d08d8(0x1e3)});const _0x11f4a0=await product[_0x3d08d8(0x1fd)]();let _0xf903eb;if(_0x13e2e2[_0x3d08d8(0x1ea)]==_0x3d08d8(0x228)){const _0x35dbe5=await staff[_0x3d08d8(0x17e)]({'email':_0x13e2e2['email']});_0xf903eb=await adjustment_finished[_0x3d08d8(0x1fd)]({'warehouse_name':_0x35dbe5[_0x3d08d8(0x1b7)]});}else _0xf903eb=await adjustment_finished[_0x3d08d8(0x1bc)]([{'$unwind':_0x3d08d8(0x169)},{'$group':{'_id':_0x3d08d8(0x205),'invoice':{'$first':_0x3d08d8(0x1ec)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x3d08d8(0x222)},'finalize':{'$first':_0x3d08d8(0x1c3)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0xf3a2c9[0x0][_0x3d08d8(0x16f)]=='English\x20(US)'){var _0x12365c=users['English'];console[_0x3d08d8(0x196)](_0x12365c);}else{if(_0xf3a2c9[0x0]['language']==_0x3d08d8(0x209))var _0x12365c=users['Hindi'];else{if(_0xf3a2c9[0x0][_0x3d08d8(0x16f)]==_0x3d08d8(0x1d9))var _0x12365c=users[_0x3d08d8(0x1d9)];else{if(_0xf3a2c9[0x0]['language']==_0x3d08d8(0x202))var _0x12365c=users[_0x3d08d8(0x202)];else{if(_0xf3a2c9[0x0][_0x3d08d8(0x16f)]=='French')var _0x12365c=users[_0x3d08d8(0x170)];else{if(_0xf3a2c9[0x0][_0x3d08d8(0x16f)]==_0x3d08d8(0x190))var _0x12365c=users[_0x3d08d8(0x1e0)];else{if(_0xf3a2c9[0x0][_0x3d08d8(0x16f)]==_0x3d08d8(0x16e))var _0x12365c=users[_0x3d08d8(0x16e)];else{if(_0xf3a2c9[0x0]['language']==_0x3d08d8(0x19c))var _0x12365c=users[_0x3d08d8(0x20f)];}}}}}}}_0x3a22a4[_0x3d08d8(0x22c)]('adjustment_finished',{'success':_0xa0b7e4[_0x3d08d8(0x1cb)](_0x3d08d8(0x226)),'errors':_0xa0b7e4['flash'](_0x3d08d8(0x1ee)),'role':_0x13e2e2,'profile':_0x11776d,'warehouse':_0x320e68,'product':_0x11f4a0,'adjustment':_0xf903eb,'master_shop':_0xf3a2c9,'language':_0x12365c});}catch(_0x269a09){console[_0x3d08d8(0x196)](_0x269a09);}});async function getRandom8DigitNumber(){var _0x6a1326=a0_0x472d95;const _0x1c9a69=0x989680,_0x146ef6=0x5f5e0ff,_0x12a0ec=Math[_0x6a1326(0x224)](Math[_0x6a1326(0x1bb)]()*(_0x146ef6-_0x1c9a69+0x1))+_0x1c9a69;var _0x3f20f6;const _0x3c115a=await adjustment_finished[_0x6a1326(0x17e)]({'invoice':_0x6a1326(0x1a6)+_0x12a0ec});return _0x3c115a&&_0x3c115a[_0x6a1326(0x1cd)]>0x0?_0x3f20f6=_0x6a1326(0x1a6)+_0x12a0ec:_0x3f20f6=_0x6a1326(0x1a6)+_0x12a0ec,_0x3f20f6;}router[a0_0x472d95(0x1ca)](a0_0x472d95(0x22a),auth,async(_0x2e1b19,_0x1f8c4d)=>{var _0x425d32=a0_0x472d95;try{const {username:_0x1fcd34,email:_0xf31e7b,role:_0x270609}=_0x2e1b19[_0x425d32(0x184)],_0x4a629d=_0x2e1b19[_0x425d32(0x184)],_0x52a5f8=await profile['findOne']({'email':_0x4a629d[_0x425d32(0x1ef)]}),_0x24466c=await master_shop[_0x425d32(0x1fd)]();let _0x48999f;if(_0x4a629d[_0x425d32(0x1ea)]==_0x425d32(0x228)){const _0x783b31=await staff[_0x425d32(0x17e)]({'email':_0x4a629d[_0x425d32(0x1ef)]});_0x48999f=await warehouse[_0x425d32(0x1bc)]([{'$match':{'status':_0x425d32(0x1e3),'name':_0x783b31['warehouse'],'warehouse_category':_0x425d32(0x16b),'name':{'$ne':_0x425d32(0x1a7)}}},{'$group':{'_id':_0x425d32(0x171),'name':{'$first':_0x425d32(0x171)}}}]);}else _0x48999f=await warehouse['aggregate']([{'$match':{'status':_0x425d32(0x1e3),'warehouse_category':_0x425d32(0x16b),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x425d32(0x171),'name':{'$first':_0x425d32(0x171)}}}]);const _0x55dbc8=await product[_0x425d32(0x1fd)]({}),_0x3f90b0=await adjustment_finished['find']({}),_0x4d952e=_0x3f90b0[_0x425d32(0x1cd)]+0x1,_0xd43e46='ADJF-'+_0x4d952e['toString']()[_0x425d32(0x204)](0x5,'0');var _0x4c46ef=['Ambient','Enclosed',_0x425d32(0x177)];if(_0x24466c[0x0][_0x425d32(0x16f)]==_0x425d32(0x181))var _0x4ba21c=users[_0x425d32(0x1b5)];else{if(_0x24466c[0x0][_0x425d32(0x16f)]==_0x425d32(0x209))var _0x4ba21c=users[_0x425d32(0x209)];else{if(_0x24466c[0x0][_0x425d32(0x16f)]=='German')var _0x4ba21c=users[_0x425d32(0x1d9)];else{if(_0x24466c[0x0][_0x425d32(0x16f)]==_0x425d32(0x202))var _0x4ba21c=users[_0x425d32(0x202)];else{if(_0x24466c[0x0][_0x425d32(0x16f)]==_0x425d32(0x170))var _0x4ba21c=users[_0x425d32(0x170)];else{if(_0x24466c[0x0][_0x425d32(0x16f)]=='Portuguese\x20(BR)')var _0x4ba21c=users[_0x425d32(0x1e0)];else{if(_0x24466c[0x0][_0x425d32(0x16f)]==_0x425d32(0x16e))var _0x4ba21c=users[_0x425d32(0x16e)];else{if(_0x24466c[0x0][_0x425d32(0x16f)]==_0x425d32(0x19c))var _0x4ba21c=users[_0x425d32(0x20f)];}}}}}}}const _0x738535=getRandom8DigitNumber();_0x738535[_0x425d32(0x1d2)](_0x1b5d40=>{var _0x24c51b=_0x425d32;_0x1f8c4d[_0x24c51b(0x22c)](_0x24c51b(0x1fc),{'success':_0x2e1b19[_0x24c51b(0x1cb)](_0x24c51b(0x226)),'errors':_0x2e1b19[_0x24c51b(0x1cb)](_0x24c51b(0x1ee)),'role':_0x4a629d,'profile':_0x52a5f8,'warehouse':_0x48999f,'product':_0x55dbc8,'master_shop':_0x24466c,'language':_0x4ba21c,'rooms_data':_0x4c46ef,'invoice_no':_0x1b5d40});})[_0x425d32(0x1b2)](_0x5a6fb3=>{var _0x25fe5d=_0x425d32;_0x2e1b19[_0x25fe5d(0x1cb)](_0x25fe5d(0x1ee),_0x25fe5d(0x185)),_0x1f8c4d[_0x25fe5d(0x220)](_0x25fe5d(0x16d));});}catch(_0x3c37eb){console['log'](_0x3c37eb);}}),router['post'](a0_0x472d95(0x22a),auth,async(_0x326d15,_0x413015)=>{var _0x1b8011=a0_0x472d95;try{const {warehouse_name:_0x47a8a3,date:_0x3c2630,prod_name:_0x55ee8f,level:_0x466b4c,isle:_0x49adce,pallet:_0x57082a,stock:_0xc2de4c,types:_0x383e38,adjust_qty:_0x42bcb6,new_adjust_qty:_0x4d0f80,note:_0x1369ae,Room_name:_0x18569c,invoice:_0x3c3b5e,JO_number:_0x3c1d93,expiry_date:_0x1f5727}=_0x326d15[_0x1b8011(0x1a4)];if(typeof _0x55ee8f==_0x1b8011(0x1c6))var _0x4ce7fc=[_0x326d15[_0x1b8011(0x1a4)]['prod_name']],_0x47b6e5=[_0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x1f3)]],_0x55d171=[_0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x19b)]],_0x3cd8e6=[_0x326d15[_0x1b8011(0x1a4)]['types']],_0x54b08e=[_0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x215)]],_0x45c71c=[_0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x1c4)]],_0x3241c1=[_0x326d15[_0x1b8011(0x1a4)]['Primary_Units']],_0x362cff=[_0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x1a1)]],_0x51ba6a=[_0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x203)]],_0x13204d=[_0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x1dc)]],_0x2efb83=[_0x326d15['body'][_0x1b8011(0x218)]],_0x39496a=[_0x326d15['body'][_0x1b8011(0x19d)]],_0x4585ba=[_0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x211)]],_0x2435fe=[_0x326d15[_0x1b8011(0x1a4)]['Rooms']],_0x486744=[_0x326d15[_0x1b8011(0x1a4)]['maxPerUnit']],_0x55f363=[_0x326d15[_0x1b8011(0x1a4)]['prod_invoice']];else var _0x4ce7fc=[..._0x326d15['body']['prod_name']],_0x47b6e5=[..._0x326d15['body'][_0x1b8011(0x1f3)]],_0x55d171=[..._0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x19b)]],_0x3cd8e6=[..._0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x217)]],_0x54b08e=[..._0x326d15['body'][_0x1b8011(0x215)]],_0x45c71c=[..._0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x1c4)]],_0x3241c1=[..._0x326d15['body'][_0x1b8011(0x1de)]],_0x362cff=[..._0x326d15[_0x1b8011(0x1a4)]['Secondary_units']],_0x51ba6a=[..._0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x203)]],_0x13204d=[..._0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x1dc)]],_0x2efb83=[..._0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x218)]],_0x39496a=[..._0x326d15['body'][_0x1b8011(0x19d)]],_0x4585ba=[..._0x326d15['body'][_0x1b8011(0x211)]],_0x2435fe=[..._0x326d15[_0x1b8011(0x1a4)]['Rooms']],_0x486744=[..._0x326d15['body']['maxPerUnit']],_0x55f363=[..._0x326d15[_0x1b8011(0x1a4)][_0x1b8011(0x1e2)]];const _0x390e76=_0x4ce7fc[_0x1b8011(0x198)](_0x3e2143=>{return _0x3e2143={'product_name':_0x3e2143};});_0x47b6e5[_0x1b8011(0x229)]((_0x3f8b7f,_0xd536ab)=>{var _0xbe7815=_0x1b8011;_0x390e76[_0xd536ab][_0xbe7815(0x178)]=_0x3f8b7f;}),_0x55d171[_0x1b8011(0x229)]((_0xb77c38,_0x3bc947)=>{var _0x4ace3e=_0x1b8011;_0x390e76[_0x3bc947][_0x4ace3e(0x1ba)]=_0xb77c38;}),_0x3cd8e6[_0x1b8011(0x229)]((_0x89b0e9,_0x14887d)=>{var _0x38138a=_0x1b8011;_0x390e76[_0x14887d][_0x38138a(0x217)]=_0x89b0e9;}),_0x54b08e[_0x1b8011(0x229)]((_0x1761e1,_0x8c910c)=>{_0x390e76[_0x8c910c]['adjust_qty']=_0x1761e1;}),_0x45c71c[_0x1b8011(0x229)]((_0x146acb,_0x5f3b7f)=>{var _0x42dc77=_0x1b8011;_0x390e76[_0x5f3b7f][_0x42dc77(0x1c1)]=_0x146acb;}),_0x3241c1['forEach']((_0x41e12e,_0x11a8b2)=>{_0x390e76[_0x11a8b2]['unit']=_0x41e12e;}),_0x362cff[_0x1b8011(0x229)]((_0x517097,_0x12d14c)=>{var _0x238c15=_0x1b8011;_0x390e76[_0x12d14c][_0x238c15(0x1b4)]=_0x517097;}),_0x51ba6a[_0x1b8011(0x229)]((_0xb39278,_0xec1f92)=>{var _0x5830f7=_0x1b8011;_0x390e76[_0xec1f92][_0x5830f7(0x1e5)]=_0xb39278;}),_0x13204d[_0x1b8011(0x229)]((_0x521c8a,_0x16f1c7)=>{var _0x1403e5=_0x1b8011;_0x390e76[_0x16f1c7][_0x1403e5(0x1dc)]=_0x521c8a;}),_0x2efb83[_0x1b8011(0x229)]((_0x8797ff,_0x271a9d)=>{var _0x53096f=_0x1b8011;_0x390e76[_0x271a9d][_0x53096f(0x218)]=_0x8797ff;}),_0x39496a[_0x1b8011(0x229)]((_0x458b33,_0x55b668)=>{var _0x167ab7=_0x1b8011;_0x390e76[_0x55b668][_0x167ab7(0x227)]=_0x458b33;}),_0x4585ba[_0x1b8011(0x229)]((_0x158e36,_0x4ddc55)=>{var _0x5ecb65=_0x1b8011;_0x390e76[_0x4ddc55][_0x5ecb65(0x211)]=_0x158e36;}),_0x2435fe[_0x1b8011(0x229)]((_0x447f29,_0x3d795c)=>{var _0x8a4a7=_0x1b8011;_0x390e76[_0x3d795c][_0x8a4a7(0x20c)]=_0x447f29;}),_0x486744['forEach']((_0x29f854,_0x2c32e4)=>{_0x390e76[_0x2c32e4]['maxPerUnit']=_0x29f854;}),_0x55f363['forEach']((_0x62d30,_0x737e04)=>{_0x390e76[_0x737e04]['invoice']=_0x62d30;});const _0x1970be=_0x390e76[_0x1b8011(0x1f8)](_0x294388=>_0x294388[_0x1b8011(0x1fa)]!=='0'&&_0x294388[_0x1b8011(0x1fa)]!=='');var _0xe68370=0x0;_0x1970be['forEach'](_0x17e2cd=>{var _0x59a8bb=_0x1b8011;console[_0x59a8bb(0x196)]('foreach\x20newproduct',_0x17e2cd),parseInt(_0x17e2cd[_0x59a8bb(0x1fa)])<=0x0&&_0xe68370++;});if(_0xe68370!=0x0)return _0x326d15[_0x1b8011(0x1cb)](_0x1b8011(0x1ee),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x413015[_0x1b8011(0x220)](_0x1b8011(0x188));const _0x46cef4=new adjustment_finished({'warehouse_name':_0x47a8a3,'date':_0x3c2630,'product':_0x1970be,'note':_0x1369ae,'room':_0x18569c,'invoice':_0x3c3b5e,'JO_number':_0x3c1d93,'expiry_date':_0x1f5727}),_0x3677e9=await _0x46cef4[_0x1b8011(0x1e1)]();_0x326d15[_0x1b8011(0x1cb)]('success',_0x1b8011(0x21a)),_0x413015[_0x1b8011(0x220)](_0x1b8011(0x1c0)+_0x3677e9[_0x1b8011(0x22b)]);}catch(_0x37c11c){console[_0x1b8011(0x196)](_0x37c11c),_0x413015['status'](0xc8)[_0x1b8011(0x1d3)]({'message':_0x37c11c[_0x1b8011(0x21e)]});}}),router[a0_0x472d95(0x1ca)]('/preview/:id',auth,async(_0x229faa,_0xb70ee4)=>{var _0x18dcd4=a0_0x472d95;try{const {username:_0x3e441c,email:_0x59016f,role:_0x2f68c8}=_0x229faa[_0x18dcd4(0x184)],_0x51b0ae=_0x229faa['user'],_0x764ffa=await profile[_0x18dcd4(0x17e)]({'email':_0x51b0ae[_0x18dcd4(0x1ef)]}),_0x2349e0=await master_shop['find'](),_0x40bd16=_0x229faa['params']['id'],_0x4603c7=await adjustment_finished[_0x18dcd4(0x192)]({'_id':_0x40bd16}),_0x16370b=await purchases[_0x18dcd4(0x1bc)]([{'$match':{'warehouse_name':_0x4603c7['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':_0x18dcd4(0x1dd)}}]);console['log']('purchases_data',_0x16370b);const _0xd32bf8=await product['find']({}),_0x429bc2=await warehouse['aggregate']([{'$match':{'name':_0x4603c7['warehouse_name'],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x18dcd4(0x193)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x18dcd4(0x1d1)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x18dcd4(0x1df)},'primary_code':{'$first':_0x18dcd4(0x197)},'secondary_code':{'$first':_0x18dcd4(0x1ac)},'product_code':{'$first':_0x18dcd4(0x189)},'storage':{'$first':_0x18dcd4(0x1cc)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x18dcd4(0x1f6)},'batch_code':{'$first':_0x18dcd4(0x194)},'maxPerUnit':{'$first':_0x18dcd4(0x1c9)},'room':{'$first':'$room'}}}]);if(_0x2349e0[0x0][_0x18dcd4(0x16f)]==_0x18dcd4(0x181)){var _0x5ac85e=users['English'];console['log'](_0x5ac85e);}else{if(_0x2349e0[0x0][_0x18dcd4(0x16f)]==_0x18dcd4(0x209))var _0x5ac85e=users[_0x18dcd4(0x209)];else{if(_0x2349e0[0x0][_0x18dcd4(0x16f)]==_0x18dcd4(0x1d9))var _0x5ac85e=users[_0x18dcd4(0x1d9)];else{if(_0x2349e0[0x0][_0x18dcd4(0x16f)]=='Spanish')var _0x5ac85e=users[_0x18dcd4(0x202)];else{if(_0x2349e0[0x0][_0x18dcd4(0x16f)]==_0x18dcd4(0x170))var _0x5ac85e=users[_0x18dcd4(0x170)];else{if(_0x2349e0[0x0][_0x18dcd4(0x16f)]==_0x18dcd4(0x190))var _0x5ac85e=users[_0x18dcd4(0x1e0)];else{if(_0x2349e0[0x0][_0x18dcd4(0x16f)]==_0x18dcd4(0x16e))var _0x5ac85e=users[_0x18dcd4(0x16e)];else{if(_0x2349e0[0x0][_0x18dcd4(0x16f)]=='Arabic\x20(ae)')var _0x5ac85e=users[_0x18dcd4(0x20f)];}}}}}}}_0xb70ee4['render'](_0x18dcd4(0x1e6),{'success':_0x229faa[_0x18dcd4(0x1cb)](_0x18dcd4(0x226)),'errors':_0x229faa[_0x18dcd4(0x1cb)](_0x18dcd4(0x1ee)),'role':_0x51b0ae,'profile':_0x764ffa,'adjustment':_0x4603c7,'stock':_0x429bc2,'master_shop':_0x2349e0,'warehouse_name':_0x16370b,'unit':_0xd32bf8,'language':_0x5ac85e});}catch(_0x42601a){console[_0x18dcd4(0x196)](_0x42601a),_0xb70ee4[_0x18dcd4(0x19a)](0xc8)[_0x18dcd4(0x1d3)]({'message':_0x42601a[_0x18dcd4(0x21e)]});}}),router['post'](a0_0x472d95(0x183),auth,async(_0x26751b,_0x360433)=>{var _0x17aa6e=a0_0x472d95;try{const {invoice:_0x5c6d62,warehouse_name:_0x5bba07,Room_name:_0x2f3e21}=_0x26751b[_0x17aa6e(0x1a4)],_0x49f139=_0x26751b[_0x17aa6e(0x172)]['id'],_0x580c05=await adjustment_finished[_0x17aa6e(0x192)]({'_id':_0x49f139});var _0x2ddd38;const _0x404701=_0x580c05[_0x17aa6e(0x1ab)][_0x17aa6e(0x198)](async _0xfc2025=>{var _0x5de916=_0x17aa6e;if(_0xfc2025[_0x5de916(0x1fa)]>0x0){_0x2ddd38=await warehouse[_0x5de916(0x17e)]({'name':_0x5bba07,'room':_0xfc2025[_0x5de916(0x20c)],'warehouse_category':_0x5de916(0x16b)});const _0x323a14=_0x2ddd38[_0x5de916(0x199)][_0x5de916(0x198)](_0x5bdfb2=>{var _0x14002e=_0x5de916;console[_0x14002e(0x196)](_0xfc2025['types']);if(_0xfc2025[_0x14002e(0x217)]=='minus')_0x5bdfb2[_0x14002e(0x17a)]==_0xfc2025[_0x14002e(0x17a)]&&_0x5bdfb2[_0x14002e(0x178)]==_0xfc2025[_0x14002e(0x178)]&&_0x5bdfb2['expiry_date']==_0xfc2025['expiry_date']&&_0x5bdfb2[_0x14002e(0x227)]==_0xfc2025[_0x14002e(0x227)]&&_0x5bdfb2[_0x14002e(0x1dc)]==_0xfc2025[_0x14002e(0x1dc)]&&_0x5bdfb2['invoice']==_0xfc2025[_0x14002e(0x213)]&&(_0x5bdfb2[_0x14002e(0x166)]=_0x5bdfb2[_0x14002e(0x166)]-_0xfc2025[_0x14002e(0x1fa)]);else _0xfc2025[_0x14002e(0x217)]=='add'&&(_0x5bdfb2[_0x14002e(0x17a)]==_0xfc2025[_0x14002e(0x17a)]&&_0x5bdfb2['bay']==_0xfc2025[_0x14002e(0x178)]&&_0x5bdfb2[_0x14002e(0x218)]==_0xfc2025[_0x14002e(0x218)]&&_0x5bdfb2['production_date']==_0xfc2025[_0x14002e(0x227)]&&_0x5bdfb2[_0x14002e(0x1dc)]==_0xfc2025['batch_code']&&_0x5bdfb2['invoice']==_0xfc2025[_0x14002e(0x213)]&&(_0x5bdfb2[_0x14002e(0x166)]=_0x5bdfb2['product_stock']+_0xfc2025[_0x14002e(0x1fa)]));});}return _0x2ddd38;});Promise[_0x17aa6e(0x18d)](_0x404701)['then'](async _0x57e454=>{var _0x112697=_0x17aa6e;try{for(const _0x242829 of _0x57e454){await _0x242829['save']();}_0x580c05[_0x112697(0x1fb)]=_0x112697(0x1c7);const _0x1bb541=await _0x580c05['save'](),_0x2b8c94=await master_shop[_0x112697(0x1fd)](),_0x21ef70=await email_settings[_0x112697(0x17e)](),_0x5e7760=await supervisor_settings[_0x112697(0x1fd)]();var _0x1f2007=_0x580c05['product'],_0x3a3248='',_0x2618d9;for(_0x2618d9 in _0x1f2007){var _0x335e21='FG';_0x580c05['warehouse_name']==_0x112697(0x18b)&&(_0x335e21='DG'),_0x3a3248+='<tr>'+_0x112697(0x179)+_0x1f2007[_0x2618d9][_0x112697(0x17a)]+_0x112697(0x19f)+_0x112697(0x179)+_0x1f2007[_0x2618d9][_0x112697(0x1e5)]+_0x112697(0x19f)+_0x112697(0x179)+_0x1f2007[_0x2618d9]['adjust_qty']+'</td>'+_0x112697(0x179)+_0x1f2007[_0x2618d9]['unit']+_0x112697(0x19f)+_0x112697(0x179)+_0x1f2007[_0x2618d9][_0x112697(0x1b4)]+'</td>'+_0x112697(0x179)+_0x580c05[_0x112697(0x1ff)]+_0x112697(0x19f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1f2007[_0x2618d9][_0x112697(0x20c)]+_0x112697(0x19f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x335e21+_0x1f2007[_0x2618d9][_0x112697(0x178)]+_0x112697(0x19f)+_0x112697(0x1af);}let _0x426fb9=nodemailer[_0x112697(0x19e)]({'host':_0x21ef70[_0x112697(0x17c)],'port':Number(_0x21ef70[_0x112697(0x1a5)]),'secure':![],'auth':{'user':_0x21ef70[_0x112697(0x1ef)],'pass':_0x21ef70[_0x112697(0x168)]}}),_0x5d2401={'from':_0x21ef70[_0x112697(0x1ef)],'to':_0x5e7760[0x0][_0x112697(0x21c)],'subject':'Adjustment\x20Mail','attachments':[{'filename':_0x112697(0x1f1),'path':__dirname+'/../public'+_0x112697(0x1e8)+_0x2b8c94[0x0][_0x112697(0x1d5)],'cid':_0x112697(0x1db)}],'html':'<!DOCTYPE\x20html>'+_0x112697(0x1e4)+_0x112697(0x1ce)+_0x112697(0x1cf)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x112697(0x1cf)+_0x112697(0x195)+'</div>'+_0x112697(0x1cf)+_0x112697(0x1e9)+_0x2b8c94[0x0]['site_title']+'\x20</h2>'+_0x112697(0x21b)+_0x112697(0x21b)+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x580c05[_0x112697(0x213)]+'\x20'+_0x112697(0x1ad)+_0x112697(0x1da)+_0x580c05['date']+'\x20'+_0x112697(0x219)+_0x112697(0x1a3)+_0x112697(0x21b)+_0x112697(0x1d7)+_0x112697(0x200)+'<tr>'+_0x112697(0x1b0)+_0x112697(0x1aa)+_0x112697(0x214)+_0x112697(0x207)+_0x112697(0x1c8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x112697(0x167)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+'</tr>'+'</thead>'+_0x112697(0x1f2)+'\x20'+_0x3a3248+'\x20'+_0x112697(0x17d)+'</table>'+_0x112697(0x1cf)+_0x112697(0x20e)+_0x112697(0x18a)+_0x2b8c94[0x0]['site_title']+_0x112697(0x1a3)+_0x112697(0x21b)+_0x112697(0x21b)+_0x112697(0x1f5)};_0x426fb9['sendMail'](_0x5d2401,function(_0x3beb89,_0x367045){var _0x4379bb=_0x112697;_0x3beb89?(console[_0x4379bb(0x196)](_0x3beb89),console[_0x4379bb(0x196)](_0x4379bb(0x1ae))):console['log'](_0x4379bb(0x1f0));}),_0x26751b[_0x112697(0x1cb)](_0x112697(0x226),_0x112697(0x191)),_0x360433[_0x112697(0x220)](_0x112697(0x1d8)+_0x1bb541[_0x112697(0x22b)]);}catch(_0x5d2758){console[_0x112697(0x225)](_0x5d2758),_0x360433[_0x112697(0x19a)](0x1f4)[_0x112697(0x1d3)]({'error':_0x112697(0x17f)});}})[_0x17aa6e(0x1b2)](_0x27e8a6=>{var _0x25096f=_0x17aa6e;console['error'](_0x27e8a6),_0x360433[_0x25096f(0x19a)](0x1f4)[_0x25096f(0x1d3)]({'error':_0x25096f(0x1d6)});});}catch(_0x440805){_0x360433[_0x17aa6e(0x1d3)]({'message':_0x440805[_0x17aa6e(0x21e)]});}}),router['get'](a0_0x472d95(0x20a),auth,async(_0x4f0dc7,_0xaaee4a)=>{var _0x4957cf=a0_0x472d95;try{const {username:_0x3461d6,email:_0x262653,role:_0x401cfe}=_0x4f0dc7[_0x4957cf(0x184)],_0xd20b91=_0x4f0dc7[_0x4957cf(0x184)],_0x5c36fd=await profile['findOne']({'email':_0xd20b91[_0x4957cf(0x1ef)]}),_0x1535bd=await master_shop[_0x4957cf(0x1fd)]();console[_0x4957cf(0x196)](_0x4957cf(0x187),_0x1535bd);const _0x4a5efe=_0x4f0dc7[_0x4957cf(0x172)]['id'],_0x3bbdb7=await adjustment_finished[_0x4957cf(0x192)]({'_id':_0x4a5efe});let _0x1fba35=new Date(_0x3bbdb7[_0x4957cf(0x218)]),_0x3744a2=('0'+_0x1fba35[_0x4957cf(0x1be)]())[_0x4957cf(0x176)](-0x2),_0x4a4f4f=('0'+(_0x1fba35[_0x4957cf(0x18c)]()+0x1))[_0x4957cf(0x176)](-0x2),_0x28aa88=_0x1fba35[_0x4957cf(0x180)](),_0x1761df=_0x28aa88+'-'+_0x4a4f4f+'-'+_0x3744a2;var _0x3ee823=['Ambient',_0x4957cf(0x16c),_0x4957cf(0x177)];const _0x107bad=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3bbdb7[_0x4957cf(0x1ff)]}},{'$unwind':_0x4957cf(0x169)},{'$group':{'_id':_0x4957cf(0x1dd)}}]);console[_0x4957cf(0x196)]('purchases_data',_0x107bad);const _0x4a5423=await product[_0x4957cf(0x1fd)]({}),_0x550017=await warehouse[_0x4957cf(0x1bc)]([{'$match':{'name':_0x3bbdb7['warehouse_name'],'room':_0x3bbdb7['room']}},{'$unwind':_0x4957cf(0x193)},{'$group':{'_id':_0x4957cf(0x210),'name':{'$first':_0x4957cf(0x1fe)},'product_stock':{'$first':_0x4957cf(0x22d)},'bay':{'$first':_0x4957cf(0x216)},'bin':{'$first':_0x4957cf(0x1d1)},'type':{'$first':_0x4957cf(0x1bf)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4957cf(0x197)},'secondary_code':{'$first':_0x4957cf(0x1ac)},'product_code':{'$first':_0x4957cf(0x189)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4957cf(0x223)}}}]);if(_0x1535bd[0x0][_0x4957cf(0x16f)]==_0x4957cf(0x181)){var _0x51a861=users['English'];console['log'](_0x51a861);}else{if(_0x1535bd[0x0]['language']==_0x4957cf(0x209))var _0x51a861=users['Hindi'];else{if(_0x1535bd[0x0]['language']==_0x4957cf(0x1d9))var _0x51a861=users[_0x4957cf(0x1d9)];else{if(_0x1535bd[0x0][_0x4957cf(0x16f)]==_0x4957cf(0x202))var _0x51a861=users[_0x4957cf(0x202)];else{if(_0x1535bd[0x0][_0x4957cf(0x16f)]==_0x4957cf(0x170))var _0x51a861=users[_0x4957cf(0x170)];else{if(_0x1535bd[0x0]['language']==_0x4957cf(0x190))var _0x51a861=users[_0x4957cf(0x1e0)];else{if(_0x1535bd[0x0]['language']==_0x4957cf(0x16e))var _0x51a861=users['Chinese'];else{if(_0x1535bd[0x0][_0x4957cf(0x16f)]=='Arabic\x20(ae)')var _0x51a861=users[_0x4957cf(0x20f)];}}}}}}}_0xaaee4a[_0x4957cf(0x22c)](_0x4957cf(0x1eb),{'success':_0x4f0dc7[_0x4957cf(0x1cb)](_0x4957cf(0x226)),'errors':_0x4f0dc7[_0x4957cf(0x1cb)]('errors'),'role':_0xd20b91,'profile':_0x5c36fd,'adjustment':_0x3bbdb7,'stock':_0x550017,'master_shop':_0x1535bd,'warehouse_name':_0x107bad,'unit':_0x4a5423,'language':_0x51a861,'rooms_data':_0x3ee823,'ed_fullDate':_0x1761df});}catch(_0x330cb0){console[_0x4957cf(0x196)](_0x330cb0),_0xaaee4a[_0x4957cf(0x19a)](0xc8)[_0x4957cf(0x1d3)]({'message':_0x330cb0['message']});}}),router['post'](a0_0x472d95(0x20a),auth,async(_0x100b74,_0x35d54d)=>{var _0x1f4815=a0_0x472d95;try{const _0x110aac=_0x100b74['params']['id'],_0x576a09=await adjustment_finished[_0x1f4815(0x192)]({'_id':_0x110aac}),_0x31559d=await warehouse[_0x1f4815(0x17e)]({'name':_0x576a09['warehouse_name'],'room':_0x576a09[_0x1f4815(0x1a9)]}),{warehouse_name:_0x1b493f,date:_0x39a30b,prod_name:_0x47356e,level:_0xa3d438,isle:_0x45c451,pallet:_0xc1d907,stock:_0x530f16,types:_0x3d205a,adjust_qty:_0x215e28,new_adjust_qty:_0x42e97b,note:_0x17a4bd,Room_name:_0x99d2c3,invoice:_0x33b9ea,JO_number:_0x4abb6c}=_0x100b74[_0x1f4815(0x1a4)];if(typeof _0x47356e==_0x1f4815(0x1c6))var _0x3d4d86=[_0x100b74['body'][_0x1f4815(0x1a2)]],_0x5dcefd=[_0x100b74['body'][_0x1f4815(0x1f3)]],_0x4c0e98=[_0x100b74['body'][_0x1f4815(0x19b)]],_0x4912e4=[_0x100b74['body'][_0x1f4815(0x217)]],_0x38fec9=[_0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x1fa)]],_0x1460a6=[_0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x1c1)]],_0x203681=[_0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x203)]],_0x5b6b6c=[_0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x206)]],_0x3afccb=[_0x100b74['body']['Secondary_units']],_0x4022bf=[_0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x1dc)]],_0x33a3c5=[_0x100b74[_0x1f4815(0x1a4)]['expiry_date']];else var _0x3d4d86=[..._0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x1a2)]],_0x5dcefd=[..._0x100b74['body'][_0x1f4815(0x1f3)]],_0x4c0e98=[..._0x100b74[_0x1f4815(0x1a4)]['stock']],_0x4912e4=[..._0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x217)]],_0x38fec9=[..._0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x1fa)]],_0x1460a6=[..._0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x1c1)]],_0x203681=[..._0x100b74[_0x1f4815(0x1a4)]['prod_code']],_0x5b6b6c=[..._0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x206)]],_0x3afccb=[..._0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x1a1)]],_0x4022bf=[..._0x100b74[_0x1f4815(0x1a4)][_0x1f4815(0x1dc)]],_0x33a3c5=[..._0x100b74[_0x1f4815(0x1a4)]['expiry_date']];const _0x3c8759=_0x3d4d86[_0x1f4815(0x198)](_0x57a278=>{return _0x57a278={'product_name':_0x57a278};});_0x5dcefd[_0x1f4815(0x229)]((_0x359d14,_0x4aae90)=>{var _0x218f01=_0x1f4815;_0x3c8759[_0x4aae90][_0x218f01(0x178)]=_0x359d14;}),_0x4c0e98[_0x1f4815(0x229)]((_0x3fb0bd,_0x4fcca1)=>{_0x3c8759[_0x4fcca1]['stockBefore']=_0x3fb0bd;}),_0x4912e4['forEach']((_0x4da77e,_0x4ffba4)=>{var _0x42e739=_0x1f4815;_0x3c8759[_0x4ffba4][_0x42e739(0x217)]=_0x4da77e;}),_0x38fec9['forEach']((_0x3bfdfd,_0x202bf1)=>{var _0x149cfa=_0x1f4815;_0x3c8759[_0x202bf1][_0x149cfa(0x1fa)]=_0x3bfdfd;}),_0x1460a6[_0x1f4815(0x229)]((_0x2a2edd,_0x4e260d)=>{_0x3c8759[_0x4e260d]['new_adjust_qty']=_0x2a2edd;}),_0x5b6b6c['forEach']((_0x2893f1,_0x3cb24a)=>{var _0x3a86a4=_0x1f4815;_0x3c8759[_0x3cb24a][_0x3a86a4(0x206)]=_0x2893f1;}),_0x3afccb[_0x1f4815(0x229)]((_0x119f83,_0x13b759)=>{var _0xc2c7bb=_0x1f4815;_0x3c8759[_0x13b759][_0xc2c7bb(0x1b4)]=_0x119f83;}),_0x203681[_0x1f4815(0x229)]((_0x1351a1,_0x502dcf)=>{var _0x37c423=_0x1f4815;_0x3c8759[_0x502dcf][_0x37c423(0x1e5)]=_0x1351a1;}),_0x4022bf[_0x1f4815(0x229)]((_0x42374d,_0x21a415)=>{var _0x591063=_0x1f4815;_0x3c8759[_0x21a415][_0x591063(0x1dc)]=_0x42374d;}),_0x33a3c5[_0x1f4815(0x229)]((_0x18706d,_0x283bbe)=>{_0x3c8759[_0x283bbe]['expiry_date']=_0x18706d;});const _0x5a1f17=_0x3c8759['filter'](_0x10654e=>_0x10654e['adjust_qty']!=='0'&&_0x10654e['adjust_qty']!=='');var _0x320551=0x0;_0x5a1f17[_0x1f4815(0x229)](_0x4dd9c5=>{var _0x1d0672=_0x1f4815;console['log'](_0x1d0672(0x1a8),_0x4dd9c5),parseInt(_0x4dd9c5[_0x1d0672(0x1fa)])<=0x0&&_0x320551++;});if(_0x320551!=0x0)return _0x100b74[_0x1f4815(0x1cb)](_0x1f4815(0x1ee),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x35d54d['redirect']('back');_0x576a09['warehouse_name']=_0x1b493f,_0x576a09[_0x1f4815(0x1b6)]=_0x39a30b,_0x576a09[_0x1f4815(0x1ab)]=_0x5a1f17,_0x576a09[_0x1f4815(0x17b)]=_0x17a4bd,_0x576a09[_0x1f4815(0x1a9)]=_0x99d2c3,_0x576a09[_0x1f4815(0x213)]=_0x33b9ea,_0x576a09[_0x1f4815(0x208)]=_0x4abb6c;const _0x53ecca=await _0x576a09[_0x1f4815(0x1e1)](),_0x91c477=await warehouse[_0x1f4815(0x17e)]({'name':_0x1b493f,'room':_0x99d2c3});_0x53ecca[_0x1f4815(0x1ab)]['forEach'](_0x33a19b=>{var _0x391399=_0x1f4815;const _0x512c0a=_0x91c477[_0x391399(0x199)][_0x391399(0x198)](_0x3e9049=>{var _0x5a7b8a=_0x391399;_0x33a19b[_0x5a7b8a(0x217)]==_0x5a7b8a(0x1ed)?_0x3e9049[_0x5a7b8a(0x17a)]==_0x33a19b['product_name']&&_0x3e9049[_0x5a7b8a(0x178)]==_0x33a19b[_0x5a7b8a(0x178)]&&(_0x3e9049[_0x5a7b8a(0x166)]=parseInt(_0x3e9049[_0x5a7b8a(0x166)])-parseInt(_0x33a19b[_0x5a7b8a(0x1fa)])):_0x3e9049[_0x5a7b8a(0x17a)]==_0x33a19b[_0x5a7b8a(0x17a)]&&_0x3e9049[_0x5a7b8a(0x178)]==_0x33a19b[_0x5a7b8a(0x178)]&&(_0x3e9049[_0x5a7b8a(0x166)]=parseInt(_0x3e9049[_0x5a7b8a(0x166)])+parseInt(_0x33a19b[_0x5a7b8a(0x1fa)]));});}),await _0x91c477[_0x1f4815(0x1e1)](),_0x100b74['flash'](_0x1f4815(0x226),_0x1f4815(0x18e)),_0x35d54d[_0x1f4815(0x220)](_0x1f4815(0x182));}catch(_0x42aa6e){console[_0x1f4815(0x196)](_0x42aa6e);}}),router[a0_0x472d95(0x1d0)](a0_0x472d95(0x1c5),async(_0x3576c7,_0x1f1b97)=>{var _0x26db21=a0_0x472d95;const {primary_code:_0x308212,warehouse_data:_0x17ff96,rooms_data:_0x2c8565,Roomslist:_0x1f95d8}=_0x3576c7[_0x26db21(0x1a4)],_0x1a7a61=_0x1f95d8[_0x26db21(0x165)](','),_0x6728eb=[];async function _0x2fdbb0(_0x36509b){var _0x1fd121=_0x26db21;const _0x10137e=await warehouse[_0x1fd121(0x1bc)]([{'$match':{'name':_0x17ff96,'room':_0x36509b}},{'$unwind':_0x1fd121(0x193)},{'$match':{'product_details.primary_code':_0x308212}},{'$group':{'_id':_0x1fd121(0x210),'name':{'$first':_0x1fd121(0x1fe)},'product_stock':{'$first':_0x1fd121(0x22d)},'primary_code':{'$first':_0x1fd121(0x197)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1fd121(0x1bf)},'pallet':{'$first':_0x1fd121(0x1df)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x1fd121(0x1c2)},'storage':{'$first':_0x1fd121(0x1cc)},'rack':{'$first':_0x1fd121(0x223)},'expiry_date':{'$first':_0x1fd121(0x201)},'production_date':{'$first':_0x1fd121(0x1f6)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x1fd121(0x1c9)},'roomNamed':{'$first':_0x1fd121(0x1f9)},'invoice':{'$first':_0x1fd121(0x186)}}}]),_0x707b42=await warehouse['aggregate']([{'$match':{'name':_0x17ff96,'room':_0x36509b}},{'$unwind':_0x1fd121(0x193)},{'$match':{'product_details.secondary_code':_0x308212}},{'$group':{'_id':_0x1fd121(0x210),'name':{'$first':_0x1fd121(0x1fe)},'product_stock':{'$first':_0x1fd121(0x22d)},'primary_code':{'$first':_0x1fd121(0x197)},'secondary_code':{'$first':_0x1fd121(0x1ac)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x1fd121(0x216)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1fd121(0x1bf)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x1fd121(0x1b8)},'secondary_unit':{'$first':_0x1fd121(0x1c2)},'storage':{'$first':_0x1fd121(0x1cc)},'rack':{'$first':_0x1fd121(0x223)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1fd121(0x1f6)},'batch_code':{'$first':_0x1fd121(0x194)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x1fd121(0x1c9)},'roomNamed':{'$first':_0x1fd121(0x1f9)},'invoice':{'$first':_0x1fd121(0x186)}}}]);if(_0x10137e[_0x1fd121(0x1cd)]>0x0)_0x6728eb[_0x1fd121(0x1e7)](_0x10137e);else _0x707b42['length']>0x0&&_0x6728eb['push'](_0x707b42);}const _0x26aade=_0x1a7a61[_0x26db21(0x198)](_0x25e82f=>_0x2fdbb0(_0x25e82f));await Promise[_0x26db21(0x18d)](_0x26aade),_0x1f1b97['json'](_0x6728eb);}),router[a0_0x472d95(0x1d0)](a0_0x472d95(0x221),async(_0x4dfd8d,_0x536df4)=>{var _0x379d1f=a0_0x472d95;const {productCode:_0x5ae51b,bay:_0x1cada3,warehouses:_0x7a7ebe,room:_0xefe8fd}=_0x4dfd8d[_0x379d1f(0x1a4)];console['log'](_0x4dfd8d[_0x379d1f(0x1a4)]);try{const _0xaf25ac=await warehouse[_0x379d1f(0x1bc)]([{'$match':{'name':_0x7a7ebe,'room':_0xefe8fd}},{'$unwind':_0x379d1f(0x193)},{'$match':{'product_details.bay':parseInt(_0x1cada3)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x379d1f(0x1fe)},'product_stock':{'$first':_0x379d1f(0x22d)},'bay':{'$first':_0x379d1f(0x216)},'maxProducts':{'$first':_0x379d1f(0x20d)}}}]);_0x536df4['status'](0xc8)[_0x379d1f(0x1d3)](_0xaf25ac);}catch(_0x1c8da7){_0x536df4[_0x379d1f(0x19a)](0x194)[_0x379d1f(0x1d3)]({'message':_0x1c8da7[_0x379d1f(0x21e)]});}}),module['exports']=router;