var a0_0xc374e5=a0_0x5b9e;(function(_0x23a63b,_0x55872b){var _0x4b2a2f=a0_0x5b9e,_0x389dcd=_0x23a63b();while(!![]){try{var _0x6f9b79=parseInt(_0x4b2a2f(0x104))/0x1*(-parseInt(_0x4b2a2f(0x10f))/0x2)+parseInt(_0x4b2a2f(0x18a))/0x3+parseInt(_0x4b2a2f(0x168))/0x4+parseInt(_0x4b2a2f(0x14c))/0x5+-parseInt(_0x4b2a2f(0x145))/0x6+parseInt(_0x4b2a2f(0x126))/0x7*(parseInt(_0x4b2a2f(0x147))/0x8)+-parseInt(_0x4b2a2f(0x128))/0x9*(-parseInt(_0x4b2a2f(0x144))/0xa);if(_0x6f9b79===_0x55872b)break;else _0x389dcd['push'](_0x389dcd['shift']());}catch(_0x4f26ac){_0x389dcd['push'](_0x389dcd['shift']());}}}(a0_0xfc9c,0x9995e));const express=require(a0_0xc374e5(0xe2)),app=express(),router=express[a0_0xc374e5(0xe4)](),auth=require(a0_0xc374e5(0xef)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0xc374e5(0x155)),users=require(a0_0xc374e5(0x10a)),nodemailer=require(a0_0xc374e5(0x13f));router[a0_0xc374e5(0x1a2)](a0_0xc374e5(0x133),auth,async(_0x34c3e2,_0x5e98af)=>{var _0x3c2fcb=a0_0xc374e5;try{const {username:_0x6e1941,email:_0x14bc7b,role:_0x351b87}=_0x34c3e2['user'],_0x530bd3=_0x34c3e2[_0x3c2fcb(0xd6)],_0x1d18e5=await profile[_0x3c2fcb(0x124)]({'email':_0x530bd3[_0x3c2fcb(0x1a8)]}),_0x54497a=await master_shop[_0x3c2fcb(0x163)]();let _0x46a57f;if(_0x530bd3[_0x3c2fcb(0x11e)]==_0x3c2fcb(0x10d)){const _0x45a33d=await staff[_0x3c2fcb(0x124)]({'email':_0x530bd3[_0x3c2fcb(0x1a8)]});_0x46a57f=await warehouse['find']({'status':_0x3c2fcb(0x132),'name':_0x45a33d[_0x3c2fcb(0xee)]});}else _0x46a57f=await warehouse[_0x3c2fcb(0x163)]({'status':_0x3c2fcb(0x132)});const _0x47b00f=await product[_0x3c2fcb(0x163)]();let _0x3d5f2a;if(_0x530bd3[_0x3c2fcb(0x11e)]==_0x3c2fcb(0x10d)){const _0x48ee70=await staff[_0x3c2fcb(0x124)]({'email':_0x530bd3[_0x3c2fcb(0x1a8)]});_0x3d5f2a=await adjustment_finished[_0x3c2fcb(0x163)]({'warehouse_name':_0x48ee70['warehouse']});}else _0x3d5f2a=await adjustment_finished[_0x3c2fcb(0x1a7)]([{'$unwind':_0x3c2fcb(0x115)},{'$group':{'_id':'$_id','invoice':{'$first':_0x3c2fcb(0x17e)},'date':{'$first':_0x3c2fcb(0x156)},'warehouse_name':{'$first':_0x3c2fcb(0xdb)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x3c2fcb(0x129)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x54497a[0x0]['language']==_0x3c2fcb(0x18e)){var _0x51d8c3=users[_0x3c2fcb(0xfb)];console['log'](_0x51d8c3);}else{if(_0x54497a[0x0][_0x3c2fcb(0xea)]=='Hindi')var _0x51d8c3=users[_0x3c2fcb(0xf1)];else{if(_0x54497a[0x0][_0x3c2fcb(0xea)]=='German')var _0x51d8c3=users['German'];else{if(_0x54497a[0x0][_0x3c2fcb(0xea)]=='Spanish')var _0x51d8c3=users[_0x3c2fcb(0x172)];else{if(_0x54497a[0x0][_0x3c2fcb(0xea)]==_0x3c2fcb(0x157))var _0x51d8c3=users[_0x3c2fcb(0x157)];else{if(_0x54497a[0x0][_0x3c2fcb(0xea)]==_0x3c2fcb(0x19d))var _0x51d8c3=users[_0x3c2fcb(0x116)];else{if(_0x54497a[0x0][_0x3c2fcb(0xea)]==_0x3c2fcb(0xed))var _0x51d8c3=users['Chinese'];else{if(_0x54497a[0x0][_0x3c2fcb(0xea)]==_0x3c2fcb(0x11a))var _0x51d8c3=users['Arabic'];}}}}}}}_0x5e98af[_0x3c2fcb(0x191)](_0x3c2fcb(0x15d),{'success':_0x34c3e2[_0x3c2fcb(0x162)](_0x3c2fcb(0xfa)),'errors':_0x34c3e2[_0x3c2fcb(0x162)](_0x3c2fcb(0x142)),'role':_0x530bd3,'profile':_0x1d18e5,'warehouse':_0x46a57f,'product':_0x47b00f,'adjustment':_0x3d5f2a,'master_shop':_0x54497a,'language':_0x51d8c3});}catch(_0x2e7944){console[_0x3c2fcb(0x1a3)](_0x2e7944);}});async function getRandom8DigitNumber(){var _0x42a608=a0_0xc374e5;const _0x121733=0x989680,_0x4109d1=0x5f5e0ff,_0x58fb76=Math[_0x42a608(0x19a)](Math[_0x42a608(0xd8)]()*(_0x4109d1-_0x121733+0x1))+_0x121733;var _0x308e03;const _0x4c4837=await adjustment_finished[_0x42a608(0x124)]({'invoice':_0x42a608(0x160)+_0x58fb76});return _0x4c4837&&_0x4c4837[_0x42a608(0x137)]>0x0?_0x308e03=_0x42a608(0x160)+_0x58fb76:_0x308e03=_0x42a608(0x160)+_0x58fb76,_0x308e03;}function a0_0x5b9e(_0x3c8c89,_0x242e0b){var _0xfc9c38=a0_0xfc9c();return a0_0x5b9e=function(_0x5b9e1d,_0xaf1a2f){_0x5b9e1d=_0x5b9e1d-0xd6;var _0xd6efac=_0xfc9c38[_0x5b9e1d];return _0xd6efac;},a0_0x5b9e(_0x3c8c89,_0x242e0b);}router['get'](a0_0xc374e5(0x195),auth,async(_0x4dfbc8,_0x3698c3)=>{var _0x33cb02=a0_0xc374e5;try{const {username:_0x45ae3d,email:_0x9dac8c,role:_0x214c00}=_0x4dfbc8[_0x33cb02(0xd6)],_0x352058=_0x4dfbc8[_0x33cb02(0xd6)],_0x5bb3db=await profile['findOne']({'email':_0x352058[_0x33cb02(0x1a8)]}),_0xebeb44=await master_shop[_0x33cb02(0x163)]();let _0x1dd37f;if(_0x352058[_0x33cb02(0x11e)]==_0x33cb02(0x10d)){const _0x11944a=await staff[_0x33cb02(0x124)]({'email':_0x352058[_0x33cb02(0x1a8)]});_0x1dd37f=await warehouse[_0x33cb02(0x1a7)]([{'$match':{'status':_0x33cb02(0x132),'name':_0x11944a['warehouse'],'warehouse_category':_0x33cb02(0xdc),'name':{'$ne':_0x33cb02(0x1a0)}}},{'$group':{'_id':_0x33cb02(0x16b),'name':{'$first':_0x33cb02(0x16b)}}}]);}else _0x1dd37f=await warehouse[_0x33cb02(0x1a7)]([{'$match':{'status':_0x33cb02(0x132),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x33cb02(0x1a0)}}},{'$group':{'_id':_0x33cb02(0x16b),'name':{'$first':'$name'}}}]);const _0x5cd6fd=await product[_0x33cb02(0x163)]({}),_0x515677=await adjustment_finished[_0x33cb02(0x163)]({}),_0x2f6301=_0x515677[_0x33cb02(0x137)]+0x1,_0x1bd320=_0x33cb02(0x160)+_0x2f6301[_0x33cb02(0x13a)]()[_0x33cb02(0x19c)](0x5,'0');var _0x7c4f1=[_0x33cb02(0xf6),_0x33cb02(0xf2),'Return\x20Rooms'];if(_0xebeb44[0x0][_0x33cb02(0xea)]==_0x33cb02(0x18e))var _0x2e50be=users[_0x33cb02(0xfb)];else{if(_0xebeb44[0x0]['language']==_0x33cb02(0xf1))var _0x2e50be=users[_0x33cb02(0xf1)];else{if(_0xebeb44[0x0]['language']==_0x33cb02(0x143))var _0x2e50be=users[_0x33cb02(0x143)];else{if(_0xebeb44[0x0][_0x33cb02(0xea)]==_0x33cb02(0x172))var _0x2e50be=users[_0x33cb02(0x172)];else{if(_0xebeb44[0x0][_0x33cb02(0xea)]==_0x33cb02(0x157))var _0x2e50be=users[_0x33cb02(0x157)];else{if(_0xebeb44[0x0][_0x33cb02(0xea)]==_0x33cb02(0x19d))var _0x2e50be=users['Portuguese'];else{if(_0xebeb44[0x0][_0x33cb02(0xea)]==_0x33cb02(0xed))var _0x2e50be=users[_0x33cb02(0xed)];else{if(_0xebeb44[0x0]['language']==_0x33cb02(0x11a))var _0x2e50be=users[_0x33cb02(0x164)];}}}}}}}const _0x535da1=getRandom8DigitNumber();_0x535da1[_0x33cb02(0x175)](_0x1251b5=>{var _0xb60505=_0x33cb02;_0x3698c3[_0xb60505(0x191)]('add_adjustment_finished',{'success':_0x4dfbc8[_0xb60505(0x162)]('success'),'errors':_0x4dfbc8[_0xb60505(0x162)]('errors'),'role':_0x352058,'profile':_0x5bb3db,'warehouse':_0x1dd37f,'product':_0x5cd6fd,'master_shop':_0xebeb44,'language':_0x2e50be,'rooms_data':_0x7c4f1,'invoice_no':_0x1251b5});})['catch'](_0x2b42ab=>{var _0xd45487=_0x33cb02;_0x4dfbc8['flash'](_0xd45487(0x142),_0xd45487(0xfe)),_0x3698c3[_0xd45487(0xdd)](_0xd45487(0x127));});}catch(_0x498446){console[_0x33cb02(0x1a3)](_0x498446);}}),router['post'](a0_0xc374e5(0x195),auth,async(_0xebdffe,_0x16bc88)=>{var _0x6daf0c=a0_0xc374e5;try{const {warehouse_name:_0x1ff096,date:_0x3d5734,prod_name:_0x6e51a7,level:_0x238c61,isle:_0x3c4d15,pallet:_0x101bab,stock:_0xa690e6,types:_0x3b54a3,adjust_qty:_0x78dd57,new_adjust_qty:_0x236f62,note:_0x4a2b73,Room_name:_0x2d4d87,invoice:_0x1347b7,JO_number:_0x325eac,expiry_date:_0x352261}=_0xebdffe[_0x6daf0c(0x149)];if(typeof _0x6e51a7==_0x6daf0c(0x136))var _0x4cb496=[_0xebdffe[_0x6daf0c(0x149)]['prod_name']],_0x3a08c9=[_0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x19f)]],_0x2326f6=[_0xebdffe[_0x6daf0c(0x149)]['stock']],_0x3ca3e7=[_0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x125)]],_0x4fcd8b=[_0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x193)]],_0x22bf35=[_0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x167)]],_0x2ca6a4=[_0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x11c)]],_0x10a0f2=[_0xebdffe['body'][_0x6daf0c(0x109)]],_0x7aacd8=[_0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x101)]],_0x254c4d=[_0xebdffe[_0x6daf0c(0x149)]['batch_code']],_0x5b9585=[_0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x196)]],_0x4e1bff=[_0xebdffe[_0x6daf0c(0x149)]['product_date']],_0x5b666c=[_0xebdffe['body']['prod_cat']],_0x459e85=[_0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x199)]],_0x2e862f=[_0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x134)]],_0x30c55b=[_0xebdffe['body'][_0x6daf0c(0x114)]];else var _0x4cb496=[..._0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x108)]],_0x3a08c9=[..._0xebdffe[_0x6daf0c(0x149)]['level']],_0x2326f6=[..._0xebdffe['body'][_0x6daf0c(0x151)]],_0x3ca3e7=[..._0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x125)]],_0x4fcd8b=[..._0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x193)]],_0x22bf35=[..._0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x167)]],_0x2ca6a4=[..._0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x11c)]],_0x10a0f2=[..._0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x109)]],_0x7aacd8=[..._0xebdffe['body']['prod_code']],_0x254c4d=[..._0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0xd9)]],_0x5b9585=[..._0xebdffe['body'][_0x6daf0c(0x196)]],_0x4e1bff=[..._0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x139)]],_0x5b666c=[..._0xebdffe['body']['prod_cat']],_0x459e85=[..._0xebdffe[_0x6daf0c(0x149)][_0x6daf0c(0x199)]],_0x2e862f=[..._0xebdffe[_0x6daf0c(0x149)]['maxPerUnit']],_0x30c55b=[..._0xebdffe['body']['prod_invoice']];const _0x56147c=_0x4cb496[_0x6daf0c(0x18d)](_0x22efd1=>{return _0x22efd1={'product_name':_0x22efd1};});_0x3a08c9['forEach']((_0x29f749,_0x360bc9)=>{var _0x23159e=_0x6daf0c;_0x56147c[_0x360bc9][_0x23159e(0x120)]=_0x29f749;}),_0x2326f6[_0x6daf0c(0xe8)]((_0x45d57d,_0x4e5f32)=>{var _0x24d51b=_0x6daf0c;_0x56147c[_0x4e5f32][_0x24d51b(0xff)]=_0x45d57d;}),_0x3ca3e7[_0x6daf0c(0xe8)]((_0x30a4ff,_0x4a9817)=>{_0x56147c[_0x4a9817]['types']=_0x30a4ff;}),_0x4fcd8b[_0x6daf0c(0xe8)]((_0x4b8b82,_0x5ee485)=>{var _0x5f7d85=_0x6daf0c;_0x56147c[_0x5ee485][_0x5f7d85(0x184)]=_0x4b8b82;}),_0x22bf35[_0x6daf0c(0xe8)]((_0x1e9db2,_0x18dce3)=>{var _0x44e724=_0x6daf0c;_0x56147c[_0x18dce3][_0x44e724(0xf5)]=_0x1e9db2;}),_0x2ca6a4[_0x6daf0c(0xe8)]((_0x46e1d7,_0xe030e9)=>{var _0x13308c=_0x6daf0c;_0x56147c[_0xe030e9][_0x13308c(0x197)]=_0x46e1d7;}),_0x10a0f2['forEach']((_0x22338c,_0x300498)=>{var _0x1e769d=_0x6daf0c;_0x56147c[_0x300498][_0x1e769d(0x190)]=_0x22338c;}),_0x7aacd8[_0x6daf0c(0xe8)]((_0x51649d,_0x480e23)=>{_0x56147c[_0x480e23]['product_code']=_0x51649d;}),_0x254c4d[_0x6daf0c(0xe8)]((_0x5556a3,_0xb20759)=>{var _0x50d289=_0x6daf0c;_0x56147c[_0xb20759][_0x50d289(0xd9)]=_0x5556a3;}),_0x5b9585[_0x6daf0c(0xe8)]((_0x2f72eb,_0x38067d)=>{var _0x177c10=_0x6daf0c;_0x56147c[_0x38067d][_0x177c10(0x196)]=_0x2f72eb;}),_0x4e1bff[_0x6daf0c(0xe8)]((_0x5ae762,_0x59585f)=>{var _0x4bd66c=_0x6daf0c;_0x56147c[_0x59585f][_0x4bd66c(0x11f)]=_0x5ae762;}),_0x5b666c[_0x6daf0c(0xe8)]((_0x25b364,_0x24a0ce)=>{var _0x1d821a=_0x6daf0c;_0x56147c[_0x24a0ce][_0x1d821a(0xda)]=_0x25b364;}),_0x459e85[_0x6daf0c(0xe8)]((_0x46effc,_0x4eba8e)=>{var _0x16d16b=_0x6daf0c;_0x56147c[_0x4eba8e][_0x16d16b(0x135)]=_0x46effc;}),_0x2e862f[_0x6daf0c(0xe8)]((_0x35cc3d,_0x235000)=>{var _0x22e058=_0x6daf0c;_0x56147c[_0x235000][_0x22e058(0x134)]=_0x35cc3d;}),_0x30c55b['forEach']((_0x147920,_0x5f0d57)=>{var _0x2ff9ea=_0x6daf0c;_0x56147c[_0x5f0d57][_0x2ff9ea(0x189)]=_0x147920;});const _0x5181d2=_0x56147c['filter'](_0x45cbc2=>_0x45cbc2['adjust_qty']!=='0'&&_0x45cbc2['adjust_qty']!=='');var _0x25b1fd=0x0;_0x5181d2[_0x6daf0c(0xe8)](_0x5211b0=>{var _0x1ab97a=_0x6daf0c;console['log']('foreach\x20newproduct',_0x5211b0),parseInt(_0x5211b0[_0x1ab97a(0x184)])<=0x0&&_0x25b1fd++;});if(_0x25b1fd!=0x0)return _0xebdffe[_0x6daf0c(0x162)](_0x6daf0c(0x142),_0x6daf0c(0x19b)),_0x16bc88[_0x6daf0c(0xdd)](_0x6daf0c(0x111));const _0x39ff15=new adjustment_finished({'warehouse_name':_0x1ff096,'date':_0x3d5734,'product':_0x5181d2,'note':_0x4a2b73,'room':_0x2d4d87,'invoice':_0x1347b7,'JO_number':_0x325eac,'expiry_date':_0x352261}),_0x398d97=await _0x39ff15[_0x6daf0c(0x176)]();_0xebdffe['flash'](_0x6daf0c(0xfa),'adjustment\x20add\x20successfull'),_0x16bc88['redirect'](_0x6daf0c(0x103)+_0x398d97[_0x6daf0c(0xe5)]);}catch(_0x17e65d){console[_0x6daf0c(0x1a3)](_0x17e65d),_0x16bc88[_0x6daf0c(0x15f)](0xc8)[_0x6daf0c(0x11d)]({'message':_0x17e65d['message']});}}),router[a0_0xc374e5(0x1a2)](a0_0xc374e5(0x1a4),auth,async(_0xacd167,_0x84c4df)=>{var _0xf68627=a0_0xc374e5;try{const {username:_0x20eb3e,email:_0x1ea2d8,role:_0x26e61c}=_0xacd167[_0xf68627(0xd6)],_0x3d215a=_0xacd167[_0xf68627(0xd6)],_0xf4274d=await profile[_0xf68627(0x124)]({'email':_0x3d215a['email']}),_0x58d4da=await master_shop[_0xf68627(0x163)](),_0x564529=_0xacd167[_0xf68627(0x152)]['id'],_0x343813=await adjustment_finished[_0xf68627(0x170)]({'_id':_0x564529}),_0x19694d=await purchases[_0xf68627(0x1a7)]([{'$match':{'warehouse_name':_0x343813[_0xf68627(0x12a)]}},{'$unwind':'$product'},{'$group':{'_id':_0xf68627(0x161)}}]);console[_0xf68627(0x1a3)]('purchases_data',_0x19694d);const _0x3ce498=await product[_0xf68627(0x163)]({}),_0x5c4419=await warehouse[_0xf68627(0x1a7)]([{'$match':{'name':_0x343813['warehouse_name'],'warehouse_category':_0xf68627(0xdc)}},{'$unwind':_0xf68627(0x192)},{'$group':{'_id':_0xf68627(0xf8),'name':{'$first':_0xf68627(0x10b)},'product_stock':{'$first':_0xf68627(0x121)},'bay':{'$first':_0xf68627(0x10c)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xf68627(0x186)},'primary_code':{'$first':_0xf68627(0x14a)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0xf68627(0x179)},'rack':{'$first':_0xf68627(0x140)},'expiry_date':{'$first':_0xf68627(0x12f)},'production_date':{'$first':_0xf68627(0x13c)},'batch_code':{'$first':_0xf68627(0x12e)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':_0xf68627(0x15a)}}}]);if(_0x58d4da[0x0]['language']==_0xf68627(0x18e)){var _0x25e534=users['English'];console[_0xf68627(0x1a3)](_0x25e534);}else{if(_0x58d4da[0x0][_0xf68627(0xea)]==_0xf68627(0xf1))var _0x25e534=users[_0xf68627(0xf1)];else{if(_0x58d4da[0x0][_0xf68627(0xea)]==_0xf68627(0x143))var _0x25e534=users[_0xf68627(0x143)];else{if(_0x58d4da[0x0][_0xf68627(0xea)]==_0xf68627(0x172))var _0x25e534=users[_0xf68627(0x172)];else{if(_0x58d4da[0x0][_0xf68627(0xea)]=='French')var _0x25e534=users[_0xf68627(0x157)];else{if(_0x58d4da[0x0]['language']==_0xf68627(0x19d))var _0x25e534=users[_0xf68627(0x116)];else{if(_0x58d4da[0x0][_0xf68627(0xea)]==_0xf68627(0xed))var _0x25e534=users[_0xf68627(0xed)];else{if(_0x58d4da[0x0]['language']==_0xf68627(0x11a))var _0x25e534=users['Arabic'];}}}}}}}_0x84c4df[_0xf68627(0x191)](_0xf68627(0x178),{'success':_0xacd167[_0xf68627(0x162)](_0xf68627(0xfa)),'errors':_0xacd167[_0xf68627(0x162)](_0xf68627(0x142)),'role':_0x3d215a,'profile':_0xf4274d,'adjustment':_0x343813,'stock':_0x5c4419,'master_shop':_0x58d4da,'warehouse_name':_0x19694d,'unit':_0x3ce498,'language':_0x25e534});}catch(_0x9f9593){console[_0xf68627(0x1a3)](_0x9f9593),_0x84c4df[_0xf68627(0x15f)](0xc8)[_0xf68627(0x11d)]({'message':_0x9f9593[_0xf68627(0x1a1)]});}}),router[a0_0xc374e5(0x148)]('/preview/:id',auth,async(_0x2de67a,_0x137d7e)=>{var _0x27aa83=a0_0xc374e5;try{const {invoice:_0x325cb8,warehouse_name:_0xa7aac5,Room_name:_0x13232f}=_0x2de67a[_0x27aa83(0x149)],_0x52bf71=_0x2de67a[_0x27aa83(0x152)]['id'],_0x1ffaa7=await adjustment_finished[_0x27aa83(0x170)]({'_id':_0x52bf71});var _0x21d6dd;const _0x313512=_0x1ffaa7['product']['map'](async _0x5a3512=>{var _0x31359e=_0x27aa83;if(_0x5a3512['adjust_qty']>0x0){_0x21d6dd=await warehouse[_0x31359e(0x124)]({'name':_0xa7aac5,'room':_0x5a3512[_0x31359e(0x135)],'warehouse_category':_0x31359e(0xdc)});const _0x320157=_0x21d6dd[_0x31359e(0xf4)][_0x31359e(0x18d)](_0xc476ad=>{var _0x497bf8=_0x31359e;console['log'](_0x5a3512[_0x497bf8(0x125)]);if(_0x5a3512[_0x497bf8(0x125)]==_0x497bf8(0x1a6))_0xc476ad[_0x497bf8(0x106)]==_0x5a3512[_0x497bf8(0x106)]&&_0xc476ad[_0x497bf8(0x120)]==_0x5a3512[_0x497bf8(0x120)]&&_0xc476ad['expiry_date']==_0x5a3512[_0x497bf8(0x196)]&&_0xc476ad[_0x497bf8(0x11f)]==_0x5a3512[_0x497bf8(0x11f)]&&_0xc476ad['batch_code']==_0x5a3512[_0x497bf8(0xd9)]&&_0xc476ad[_0x497bf8(0x189)]==_0x5a3512['invoice']&&(_0xc476ad[_0x497bf8(0x171)]=_0xc476ad[_0x497bf8(0x171)]-_0x5a3512[_0x497bf8(0x184)]);else _0x5a3512['types']==_0x497bf8(0x131)&&(_0xc476ad[_0x497bf8(0x106)]==_0x5a3512['product_name']&&_0xc476ad[_0x497bf8(0x120)]==_0x5a3512['bay']&&_0xc476ad[_0x497bf8(0x196)]==_0x5a3512[_0x497bf8(0x196)]&&_0xc476ad['production_date']==_0x5a3512[_0x497bf8(0x11f)]&&_0xc476ad['batch_code']==_0x5a3512['batch_code']&&_0xc476ad[_0x497bf8(0x189)]==_0x5a3512[_0x497bf8(0x189)]&&(_0xc476ad[_0x497bf8(0x171)]=_0xc476ad[_0x497bf8(0x171)]+_0x5a3512[_0x497bf8(0x184)]));});}return _0x21d6dd;});Promise['all'](_0x313512)[_0x27aa83(0x175)](async _0x6a9c8a=>{var _0x2e0b49=_0x27aa83;try{for(const _0x270e7e of _0x6a9c8a){await _0x270e7e['save']();}_0x1ffaa7[_0x2e0b49(0x12d)]=_0x2e0b49(0x16c);const _0x3f4857=await _0x1ffaa7[_0x2e0b49(0x176)](),_0x41600e=await master_shop[_0x2e0b49(0x163)](),_0x42ab07=await email_settings[_0x2e0b49(0x124)](),_0x2909fc=await supervisor_settings[_0x2e0b49(0x163)]();var _0x688a57=_0x1ffaa7['product'],_0x503c9b='',_0xa0c76c;for(_0xa0c76c in _0x688a57){var _0x4e56b1='FG';_0x1ffaa7[_0x2e0b49(0x12a)]=='DRY\x20GOODS'&&(_0x4e56b1='DG'),_0x503c9b+=_0x2e0b49(0x169)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x688a57[_0xa0c76c][_0x2e0b49(0x106)]+_0x2e0b49(0x16f)+_0x2e0b49(0x165)+_0x688a57[_0xa0c76c][_0x2e0b49(0x138)]+_0x2e0b49(0x16f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x688a57[_0xa0c76c][_0x2e0b49(0x184)]+'</td>'+_0x2e0b49(0x165)+_0x688a57[_0xa0c76c][_0x2e0b49(0x197)]+_0x2e0b49(0x16f)+_0x2e0b49(0x165)+_0x688a57[_0xa0c76c][_0x2e0b49(0x190)]+'</td>'+_0x2e0b49(0x165)+_0x1ffaa7['warehouse_name']+_0x2e0b49(0x16f)+_0x2e0b49(0x165)+_0x688a57[_0xa0c76c]['room_names']+'</td>'+_0x2e0b49(0x165)+_0x4e56b1+_0x688a57[_0xa0c76c][_0x2e0b49(0x120)]+_0x2e0b49(0x16f)+_0x2e0b49(0x187);}let _0x3070c3=nodemailer[_0x2e0b49(0x118)]({'host':_0x42ab07[_0x2e0b49(0x14e)],'port':Number(_0x42ab07[_0x2e0b49(0x10e)]),'secure':![],'auth':{'user':_0x42ab07[_0x2e0b49(0x1a8)],'pass':_0x42ab07[_0x2e0b49(0x12c)]}}),_0x56aa44={'from':_0x42ab07[_0x2e0b49(0x1a8)],'to':_0x2909fc[0x0][_0x2e0b49(0x181)],'subject':_0x2e0b49(0x17c),'attachments':[{'filename':_0x2e0b49(0x153),'path':__dirname+_0x2e0b49(0x174)+_0x2e0b49(0x12b)+_0x41600e[0x0][_0x2e0b49(0xfd)],'cid':_0x2e0b49(0x14d)}],'html':_0x2e0b49(0xf7)+_0x2e0b49(0xe9)+_0x2e0b49(0x110)+_0x2e0b49(0xeb)+_0x2e0b49(0xf9)+_0x2e0b49(0xeb)+_0x2e0b49(0xfc)+_0x2e0b49(0x194)+'<div>'+_0x2e0b49(0xf0)+_0x41600e[0x0][_0x2e0b49(0x130)]+_0x2e0b49(0x18f)+_0x2e0b49(0x194)+_0x2e0b49(0x194)+_0x2e0b49(0x158)+_0x2e0b49(0xeb)+_0x2e0b49(0x17d)+_0x2e0b49(0x15b)+_0x1ffaa7[_0x2e0b49(0x189)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2e0b49(0x173)+_0x1ffaa7[_0x2e0b49(0x100)]+'\x20'+_0x2e0b49(0x11b)+_0x2e0b49(0x13d)+_0x2e0b49(0x194)+_0x2e0b49(0x19e)+_0x2e0b49(0xde)+'<tr>'+_0x2e0b49(0x107)+_0x2e0b49(0x117)+_0x2e0b49(0x141)+_0x2e0b49(0x177)+_0x2e0b49(0x15c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x2e0b49(0x17f)+_0x2e0b49(0xe1)+_0x2e0b49(0x187)+_0x2e0b49(0x18c)+_0x2e0b49(0xe7)+'\x20'+_0x503c9b+'\x20'+_0x2e0b49(0x198)+_0x2e0b49(0x14f)+'<div>'+_0x2e0b49(0x18b)+_0x2e0b49(0x150)+_0x41600e[0x0]['site_title']+_0x2e0b49(0x13d)+_0x2e0b49(0x194)+'</div>'+'</body></html>'};_0x3070c3[_0x2e0b49(0x119)](_0x56aa44,function(_0x13205d,_0x5df428){var _0x3763ff=_0x2e0b49;_0x13205d?(console[_0x3763ff(0x1a3)](_0x13205d),console['log']('Error\x20Occurs')):console[_0x3763ff(0x1a3)](_0x3763ff(0xdf));}),_0x2de67a['flash'](_0x2e0b49(0xfa),_0x2e0b49(0x13b)),_0x137d7e[_0x2e0b49(0xdd)](_0x2e0b49(0x13e)+_0x3f4857[_0x2e0b49(0xe5)]);}catch(_0x4c04ce){console[_0x2e0b49(0x146)](_0x4c04ce),_0x137d7e[_0x2e0b49(0x15f)](0x1f4)[_0x2e0b49(0x11d)]({'error':_0x2e0b49(0x1a9)});}})[_0x27aa83(0xf3)](_0xbb0fd5=>{var _0x251cea=_0x27aa83;console[_0x251cea(0x146)](_0xbb0fd5),_0x137d7e[_0x251cea(0x15f)](0x1f4)[_0x251cea(0x11d)]({'error':_0x251cea(0x16a)});});}catch(_0x5df7de){_0x137d7e[_0x27aa83(0x11d)]({'message':_0x5df7de[_0x27aa83(0x1a1)]});}}),router[a0_0xc374e5(0x1a2)](a0_0xc374e5(0x16e),auth,async(_0x174fa5,_0x5eff2f)=>{var _0x5f39eb=a0_0xc374e5;try{const {username:_0x2c3ed4,email:_0x51b4e1,role:_0x20c8f2}=_0x174fa5['user'],_0x2145f9=_0x174fa5[_0x5f39eb(0xd6)],_0x4a3d40=await profile[_0x5f39eb(0x124)]({'email':_0x2145f9[_0x5f39eb(0x1a8)]}),_0x25cd82=await master_shop['find']();console[_0x5f39eb(0x1a3)]('master',_0x25cd82);const _0x1fafc7=_0x174fa5['params']['id'],_0x456137=await adjustment_finished[_0x5f39eb(0x170)]({'_id':_0x1fafc7});let _0x5b937d=new Date(_0x456137['expiry_date']),_0x205c93=('0'+_0x5b937d[_0x5f39eb(0x14b)]())[_0x5f39eb(0x154)](-0x2),_0x468e10=('0'+(_0x5b937d['getMonth']()+0x1))[_0x5f39eb(0x154)](-0x2),_0x327459=_0x5b937d['getFullYear'](),_0x575ceb=_0x327459+'-'+_0x468e10+'-'+_0x205c93;var _0x3a8c87=[_0x5f39eb(0xf6),_0x5f39eb(0xf2),'Return\x20Rooms'];const _0x32d489=await purchases['aggregate']([{'$match':{'warehouse_name':_0x456137[_0x5f39eb(0x12a)]}},{'$unwind':'$product'},{'$group':{'_id':_0x5f39eb(0x161)}}]);console[_0x5f39eb(0x1a3)](_0x5f39eb(0x183),_0x32d489);const _0xea5251=await product[_0x5f39eb(0x163)]({}),_0xd5ea47=await warehouse[_0x5f39eb(0x1a7)]([{'$match':{'name':_0x456137['warehouse_name'],'room':_0x456137['room']}},{'$unwind':_0x5f39eb(0x192)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5f39eb(0x10b)},'product_stock':{'$first':_0x5f39eb(0x121)},'bay':{'$first':_0x5f39eb(0x10c)},'bin':{'$first':_0x5f39eb(0x122)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5f39eb(0x186)},'primary_code':{'$first':_0x5f39eb(0x14a)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5f39eb(0x159)},'storage':{'$first':_0x5f39eb(0x179)},'rack':{'$first':_0x5f39eb(0x140)}}}]);if(_0x25cd82[0x0][_0x5f39eb(0xea)]==_0x5f39eb(0x18e)){var _0x41c41d=users[_0x5f39eb(0xfb)];console[_0x5f39eb(0x1a3)](_0x41c41d);}else{if(_0x25cd82[0x0][_0x5f39eb(0xea)]==_0x5f39eb(0xf1))var _0x41c41d=users[_0x5f39eb(0xf1)];else{if(_0x25cd82[0x0]['language']==_0x5f39eb(0x143))var _0x41c41d=users[_0x5f39eb(0x143)];else{if(_0x25cd82[0x0][_0x5f39eb(0xea)]==_0x5f39eb(0x172))var _0x41c41d=users[_0x5f39eb(0x172)];else{if(_0x25cd82[0x0]['language']==_0x5f39eb(0x157))var _0x41c41d=users['French'];else{if(_0x25cd82[0x0][_0x5f39eb(0xea)]=='Portuguese\x20(BR)')var _0x41c41d=users['Portuguese'];else{if(_0x25cd82[0x0][_0x5f39eb(0xea)]==_0x5f39eb(0xed))var _0x41c41d=users[_0x5f39eb(0xed)];else{if(_0x25cd82[0x0]['language']==_0x5f39eb(0x11a))var _0x41c41d=users[_0x5f39eb(0x164)];}}}}}}}_0x5eff2f[_0x5f39eb(0x191)](_0x5f39eb(0x113),{'success':_0x174fa5[_0x5f39eb(0x162)](_0x5f39eb(0xfa)),'errors':_0x174fa5[_0x5f39eb(0x162)](_0x5f39eb(0x142)),'role':_0x2145f9,'profile':_0x4a3d40,'adjustment':_0x456137,'stock':_0xd5ea47,'master_shop':_0x25cd82,'warehouse_name':_0x32d489,'unit':_0xea5251,'language':_0x41c41d,'rooms_data':_0x3a8c87,'ed_fullDate':_0x575ceb});}catch(_0x4fdda5){console[_0x5f39eb(0x1a3)](_0x4fdda5),_0x5eff2f[_0x5f39eb(0x15f)](0xc8)[_0x5f39eb(0x11d)]({'message':_0x4fdda5[_0x5f39eb(0x1a1)]});}}),router[a0_0xc374e5(0x148)](a0_0xc374e5(0x16e),auth,async(_0x389eb1,_0x3a9623)=>{var _0x7843ff=a0_0xc374e5;try{const _0x4ee17f=_0x389eb1['params']['id'],_0x111fc1=await adjustment_finished[_0x7843ff(0x170)]({'_id':_0x4ee17f}),_0x242ad8=await warehouse[_0x7843ff(0x124)]({'name':_0x111fc1['warehouse_name'],'room':_0x111fc1[_0x7843ff(0x123)]}),{warehouse_name:_0x183299,date:_0x40efd6,prod_name:_0x31d57b,level:_0x319ab4,isle:_0x25c493,pallet:_0x2f6cc3,stock:_0x4cef29,types:_0x245857,adjust_qty:_0x19ee24,new_adjust_qty:_0x217720,note:_0x7fb1cb,Room_name:_0x2d1296,invoice:_0x3ddeb9,JO_number:_0x56425c}=_0x389eb1[_0x7843ff(0x149)];if(typeof _0x31d57b==_0x7843ff(0x136))var _0x379fb4=[_0x389eb1[_0x7843ff(0x149)][_0x7843ff(0x108)]],_0x587dd7=[_0x389eb1['body'][_0x7843ff(0x19f)]],_0x2920d=[_0x389eb1[_0x7843ff(0x149)][_0x7843ff(0x151)]],_0x4abf7c=[_0x389eb1[_0x7843ff(0x149)]['types']],_0x13f044=[_0x389eb1['body'][_0x7843ff(0x184)]],_0x4c3a62=[_0x389eb1[_0x7843ff(0x149)][_0x7843ff(0xf5)]],_0x8f5f12=[_0x389eb1[_0x7843ff(0x149)][_0x7843ff(0x101)]],_0x2cfdb7=[_0x389eb1['body']['unit']],_0x40dcb9=[_0x389eb1['body'][_0x7843ff(0x109)]],_0x19b0e3=[_0x389eb1[_0x7843ff(0x149)][_0x7843ff(0xd9)]],_0x169b07=[_0x389eb1[_0x7843ff(0x149)]['expiry_date']];else var _0x379fb4=[..._0x389eb1['body'][_0x7843ff(0x108)]],_0x587dd7=[..._0x389eb1[_0x7843ff(0x149)]['level']],_0x2920d=[..._0x389eb1[_0x7843ff(0x149)]['stock']],_0x4abf7c=[..._0x389eb1[_0x7843ff(0x149)][_0x7843ff(0x125)]],_0x13f044=[..._0x389eb1[_0x7843ff(0x149)][_0x7843ff(0x184)]],_0x4c3a62=[..._0x389eb1['body']['new_adjust_qty']],_0x8f5f12=[..._0x389eb1[_0x7843ff(0x149)][_0x7843ff(0x101)]],_0x2cfdb7=[..._0x389eb1[_0x7843ff(0x149)][_0x7843ff(0x197)]],_0x40dcb9=[..._0x389eb1[_0x7843ff(0x149)][_0x7843ff(0x109)]],_0x19b0e3=[..._0x389eb1[_0x7843ff(0x149)]['batch_code']],_0x169b07=[..._0x389eb1[_0x7843ff(0x149)][_0x7843ff(0x196)]];const _0x3517b5=_0x379fb4[_0x7843ff(0x18d)](_0x2e14fc=>{return _0x2e14fc={'product_name':_0x2e14fc};});_0x587dd7['forEach']((_0x3645ad,_0x1a9494)=>{var _0x259054=_0x7843ff;_0x3517b5[_0x1a9494][_0x259054(0x120)]=_0x3645ad;}),_0x2920d['forEach']((_0x12dedb,_0x13e433)=>{var _0x746686=_0x7843ff;_0x3517b5[_0x13e433][_0x746686(0xff)]=_0x12dedb;}),_0x4abf7c[_0x7843ff(0xe8)]((_0x2f6caa,_0x1f92bf)=>{var _0x2cc921=_0x7843ff;_0x3517b5[_0x1f92bf][_0x2cc921(0x125)]=_0x2f6caa;}),_0x13f044[_0x7843ff(0xe8)]((_0x116981,_0x43368a)=>{var _0x5f5d1e=_0x7843ff;_0x3517b5[_0x43368a][_0x5f5d1e(0x184)]=_0x116981;}),_0x4c3a62[_0x7843ff(0xe8)]((_0xae7580,_0x517e36)=>{var _0x5637d9=_0x7843ff;_0x3517b5[_0x517e36][_0x5637d9(0xf5)]=_0xae7580;}),_0x2cfdb7['forEach']((_0xb29315,_0xad02d5)=>{_0x3517b5[_0xad02d5]['unit']=_0xb29315;}),_0x40dcb9['forEach']((_0x2a3259,_0x57e59d)=>{var _0x9921af=_0x7843ff;_0x3517b5[_0x57e59d][_0x9921af(0x190)]=_0x2a3259;}),_0x8f5f12['forEach']((_0x59c604,_0x362886)=>{var _0x1e0263=_0x7843ff;_0x3517b5[_0x362886][_0x1e0263(0x138)]=_0x59c604;}),_0x19b0e3['forEach']((_0xa40a8f,_0x1ad0a5)=>{var _0x361acb=_0x7843ff;_0x3517b5[_0x1ad0a5][_0x361acb(0xd9)]=_0xa40a8f;}),_0x169b07[_0x7843ff(0xe8)]((_0x324533,_0xb881d)=>{var _0x553db0=_0x7843ff;_0x3517b5[_0xb881d][_0x553db0(0x196)]=_0x324533;});const _0xa1e4b9=_0x3517b5['filter'](_0x4b3617=>_0x4b3617[_0x7843ff(0x184)]!=='0'&&_0x4b3617[_0x7843ff(0x184)]!=='');var _0x3ae018=0x0;_0xa1e4b9[_0x7843ff(0xe8)](_0x3636bc=>{var _0x49a250=_0x7843ff;console[_0x49a250(0x1a3)](_0x49a250(0x15e),_0x3636bc),parseInt(_0x3636bc[_0x49a250(0x184)])<=0x0&&_0x3ae018++;});if(_0x3ae018!=0x0)return _0x389eb1[_0x7843ff(0x162)](_0x7843ff(0x142),_0x7843ff(0x19b)),_0x3a9623[_0x7843ff(0xdd)]('back');_0x111fc1['warehouse_name']=_0x183299,_0x111fc1[_0x7843ff(0x100)]=_0x40efd6,_0x111fc1[_0x7843ff(0xd7)]=_0xa1e4b9,_0x111fc1[_0x7843ff(0x185)]=_0x7fb1cb,_0x111fc1[_0x7843ff(0x123)]=_0x2d1296,_0x111fc1[_0x7843ff(0x189)]=_0x3ddeb9,_0x111fc1[_0x7843ff(0xe0)]=_0x56425c;const _0x19825b=await _0x111fc1[_0x7843ff(0x176)](),_0x105dba=await warehouse[_0x7843ff(0x124)]({'name':_0x183299,'room':_0x2d1296});_0x19825b[_0x7843ff(0xd7)]['forEach'](_0x704b91=>{var _0x2090f8=_0x7843ff;const _0x1a3f81=_0x105dba['product_details'][_0x2090f8(0x18d)](_0x40ef6b=>{var _0x4d5ac7=_0x2090f8;_0x704b91[_0x4d5ac7(0x125)]==_0x4d5ac7(0x1a6)?_0x40ef6b[_0x4d5ac7(0x106)]==_0x704b91['product_name']&&_0x40ef6b['bay']==_0x704b91[_0x4d5ac7(0x120)]&&(_0x40ef6b[_0x4d5ac7(0x171)]=parseInt(_0x40ef6b[_0x4d5ac7(0x171)])-parseInt(_0x704b91[_0x4d5ac7(0x184)])):_0x40ef6b[_0x4d5ac7(0x106)]==_0x704b91[_0x4d5ac7(0x106)]&&_0x40ef6b[_0x4d5ac7(0x120)]==_0x704b91['bay']&&(_0x40ef6b[_0x4d5ac7(0x171)]=parseInt(_0x40ef6b['product_stock'])+parseInt(_0x704b91['adjust_qty']));});}),await _0x105dba[_0x7843ff(0x176)](),_0x389eb1['flash'](_0x7843ff(0xfa),_0x7843ff(0x166)),_0x3a9623['redirect'](_0x7843ff(0xe6));}catch(_0x1cd4a6){console['log'](_0x1cd4a6);}}),router['post'](a0_0xc374e5(0x17b),async(_0x3d9898,_0x488cbc)=>{var _0x4a303d=a0_0xc374e5;const {primary_code:_0x2cc709,warehouse_data:_0x4d42a0,rooms_data:_0x41c546,Roomslist:_0x506658}=_0x3d9898[_0x4a303d(0x149)],_0x4dc9ca=_0x506658[_0x4a303d(0x182)](','),_0x33e989=[];async function _0x2f7a33(_0x234610){var _0x4db76a=_0x4a303d;const _0x36d0c7=await warehouse[_0x4db76a(0x1a7)]([{'$match':{'name':_0x4d42a0,'room':_0x234610}},{'$unwind':_0x4db76a(0x192)},{'$match':{'product_details.primary_code':_0x2cc709}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4db76a(0x10b)},'product_stock':{'$first':_0x4db76a(0x121)},'primary_code':{'$first':_0x4db76a(0x14a)},'secondary_code':{'$first':_0x4db76a(0x105)},'product_code':{'$first':_0x4db76a(0x159)},'level':{'$first':_0x4db76a(0x10c)},'isle':{'$first':_0x4db76a(0x122)},'type':{'$first':_0x4db76a(0x112)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x4db76a(0x188)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4db76a(0x12f)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4db76a(0x12e)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x4db76a(0x15a)},'invoice':{'$first':_0x4db76a(0x1a5)}}}]),_0x564c1a=await warehouse['aggregate']([{'$match':{'name':_0x4d42a0,'room':_0x234610}},{'$unwind':_0x4db76a(0x192)},{'$match':{'product_details.secondary_code':_0x2cc709}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4db76a(0x10b)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4db76a(0x105)},'product_code':{'$first':_0x4db76a(0x159)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x4db76a(0x122)},'type':{'$first':_0x4db76a(0x112)},'pallet':{'$first':_0x4db76a(0x186)},'unit':{'$first':_0x4db76a(0xec)},'secondary_unit':{'$first':_0x4db76a(0x188)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4db76a(0x140)},'expiry_date':{'$first':_0x4db76a(0x12f)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4db76a(0x12e)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x4db76a(0x17a)},'roomNamed':{'$first':_0x4db76a(0x15a)},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x36d0c7[_0x4db76a(0x137)]>0x0)_0x33e989[_0x4db76a(0xe3)](_0x36d0c7);else _0x564c1a[_0x4db76a(0x137)]>0x0&&_0x33e989[_0x4db76a(0xe3)](_0x564c1a);}const _0x5efbbc=_0x4dc9ca['map'](_0x43f7f7=>_0x2f7a33(_0x43f7f7));await Promise['all'](_0x5efbbc),_0x488cbc[_0x4a303d(0x11d)](_0x33e989);}),router[a0_0xc374e5(0x148)](a0_0xc374e5(0x16d),async(_0x27ca94,_0x5c622f)=>{var _0x15b141=a0_0xc374e5;const {productCode:_0x2b813b,bay:_0xc0fe02,warehouses:_0x55f057,room:_0x13d09e}=_0x27ca94[_0x15b141(0x149)];console[_0x15b141(0x1a3)](_0x27ca94['body']);try{const _0x2ba459=await warehouse[_0x15b141(0x1a7)]([{'$match':{'name':_0x55f057,'room':_0x13d09e}},{'$unwind':_0x15b141(0x192)},{'$match':{'product_details.bay':parseInt(_0xc0fe02)}},{'$group':{'_id':_0x15b141(0xf8),'name':{'$first':_0x15b141(0x10b)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x15b141(0x10c)},'maxProducts':{'$first':_0x15b141(0x102)}}}]);_0x5c622f[_0x15b141(0x15f)](0xc8)[_0x15b141(0x11d)](_0x2ba459);}catch(_0x3eb0e7){_0x5c622f[_0x15b141(0x15f)](0x194)[_0x15b141(0x11d)]({'message':_0x3eb0e7[_0x15b141(0x1a1)]});}}),module[a0_0xc374e5(0x180)]=router;function a0_0xfc9c(){var _0x3dfeb5=['/view','maxPerUnit','room_names','string','length','product_code','product_date','toString','Adjustment\x20Finalize\x20Successfully','$product_details.production_date','</h5>','/picking_list/PDF_adjustment/','nodemailer','$product_details.rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','errors','German','30850ExQHqD','5547618ltPfAa','error','1992040yToBEN','post','body','$product_details.primary_code','getDate','1162925pUUboh','logo','host','</table>','<h5>','stock','params','Logo.png','slice','../models/all_models','$date','French','<hr\x20class=\x22my-3\x22>','$product_details.product_code','$room','\x20Order\x20Number\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','adjustment_finished','foreach\x20newproduct','status','ADJF-','$product.product_name','flash','find','Arabic','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','adjustment\x20data\x20update\x20successfully','New_Qty_Converted','2148928EnIqGx','<tr>','An\x20error\x20occurred.','$name','True','/CheckingWarehouse','/view/:id','</td>','findById','product_stock','Spanish','\x20Order\x20Date\x20:\x20','/../public','then','save','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','edit_adjustment_finished_view','$product_details.storage','$product_details.maxPerUnit','/barcode_scanner','Adjustment\x20Mail','<h5\x20style=\x22text-align:\x20left;\x22>','$invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','exports','FGSEmail','split','purchases_data','adjust_qty','note','$product_details.floorlevel','</tr>','$product_details.secondary_unit','invoice','871920iNdwCB','<strong>\x20Regards\x20</strong>','</thead>','map','English\x20(US)','\x20</h2>','secondary_unit','render','$product_details','New_Qty_Converted_adj','</div>','/view/add_adjustment','expiry_date','unit','</tbody>','Rooms','floor','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','padStart','Portuguese\x20(BR)','<table\x20style=\x22width:\x20100%\x20!important;\x22>','level','QA\x20Warehouse','message','get','log','/preview/:id','$product_details.invoice','minus','aggregate','email','An\x20error\x20occurred\x20while\x20saving\x20data.','user','product','random','batch_code','prod_cat','$warehouse_name','Finished\x20Goods','redirect','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Email\x20sent\x20successfully','JO_number','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','express','push','Router','_id','/adjustment_finished/view','<tbody\x20style=\x22text-align:\x20center;\x22>','forEach','<html><head><title></title>','language','<div>','$product_details.unit','Chinese','warehouse','../middleware/auth','<h2>\x20','Hindi','Enclosed','catch','product_details','new_adjust_qty','Ambient','<!DOCTYPE\x20html>','$product_details._id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','success','English','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','image','There\x27s\x20a\x20error\x20in\x20this\x20transaction','stockBefore','date','prod_code','$product_details.maxProducts','/adjustment_finished/preview/','145266yMsLpr','$product_details.secondary_code','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','prod_name','Secondary_units','../public/language/languages.json','$product_details.product_name','$product_details.bay','staff','port','6yjWAQJ','</head><body>','back','$product_details.type','edit_adjustment_finished','prod_invoice','$product','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','createTransport','sendMail','Arabic\x20(ae)','</span>','Primary_Units','json','role','production_date','bay','$product_details.product_stock','$product_details.bin','room','findOne','types','21mDMhsR','/adjustment/view','531omLKQr','$finalize','warehouse_name','/upload/','password','finalize','$product_details.batch_code','$product_details.expiry_date','site_title','add','Enabled'];a0_0xfc9c=function(){return _0x3dfeb5;};return a0_0xfc9c();}