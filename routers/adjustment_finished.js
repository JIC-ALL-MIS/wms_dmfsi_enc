var a0_0x2d7dd4=a0_0x578e;(function(_0x3eeee7,_0x1fcdec){var _0x3a393d=a0_0x578e,_0xb434d9=_0x3eeee7();while(!![]){try{var _0x11b549=parseInt(_0x3a393d(0x12f))/0x1*(parseInt(_0x3a393d(0x113))/0x2)+parseInt(_0x3a393d(0x154))/0x3+-parseInt(_0x3a393d(0xb7))/0x4*(parseInt(_0x3a393d(0x13c))/0x5)+-parseInt(_0x3a393d(0x123))/0x6*(parseInt(_0x3a393d(0x144))/0x7)+parseInt(_0x3a393d(0x15a))/0x8*(-parseInt(_0x3a393d(0x162))/0x9)+-parseInt(_0x3a393d(0xc2))/0xa+parseInt(_0x3a393d(0x120))/0xb;if(_0x11b549===_0x1fcdec)break;else _0xb434d9['push'](_0xb434d9['shift']());}catch(_0xfdecb9){_0xb434d9['push'](_0xb434d9['shift']());}}}(a0_0x3d5c,0xd4b69));const express=require(a0_0x2d7dd4(0x102)),app=express(),router=express[a0_0x2d7dd4(0x111)](),auth=require(a0_0x2d7dd4(0x10c)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x2d7dd4(0x13f)),users=require(a0_0x2d7dd4(0x16e)),nodemailer=require(a0_0x2d7dd4(0x12a));function a0_0x3d5c(){var _0x13139c=['types','$finalize','Spanish','<div>','$product_details.secondary_unit','express','$name','date','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.product_code','catch','/adjustment/view','room','</thead>','../middleware/auth','JO_number','Enabled','filter','role','Router','production_date','380746WABehH','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.bin','invoice','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<h2>\x20','$product_details.storage','prod_code','<html><head><title></title>','findById','$product_details.floorlevel','_id','20859762LgyLcK','port','Adjustment\x20Mail','6nKRSVJ','edit_adjustment_finished','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','staff','An\x20error\x20occurred\x20while\x20saving\x20data.','room_names','host','nodemailer','\x20Order\x20Number\x20:\x20','</td>','new_adjust_qty','split','1ZTrumy','batch_code','bay','English\x20(US)','/barcode_scanner','save','/CheckingWarehouse','$product_details.expiry_date','createTransport','Portuguese','string','$product.room_names','product_name','64115iKlSbH','error','$product.product_name','../models/all_models','params','unit','$product_details.product_stock','$product_details._id','8176497gPrDhh','\x20Order\x20Date\x20:\x20','slice','DRY\x20GOODS','$product_details.secondary_code','floor','<tbody\x20style=\x22text-align:\x20center;\x22>','True','$product_details.product_name','German','edit_adjustment_finished_view','$product_details.primary_code','getFullYear','product_date','/../public','adjust_qty','2085927xQvigq','level','English','$product_details.unit','prod_cat','New_Qty_Converted','879240BSDgYq','note','There\x27s\x20a\x20error\x20in\x20this\x20transaction','push','<!DOCTYPE\x20html>','$invoice','Return\x20Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','9BjnfOH','then','map','Arabic\x20(ae)','$product_details.maxPerUnit','$product_details.invoice','<span\x20style=\x22float:\x20right;\x22>','<tr>','body','adjustment\x20add\x20successfull','product_code','$product_details','../public/language/languages.json','find','Email\x20sent\x20successfully','maxPerUnit','</body></html>','/view/:id','password','$product_details.batch_code','log','Ambient','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</h5>','get','\x20</h2>','$product_details.maxProducts','warehouse_name','prod_name','prod_invoice','48QyfQeC','$product_details.bay','<strong>\x20Regards\x20</strong>','language','flash','warehouse','Arabic','success','/adjustment_finished/view','Hindi','errors','4788990vssVbb','FGSEmail','render','aggregate','$product_details.rack','Primary_Units','Adjustment\x20Finalize\x20Successfully','French','json','length','post','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','An\x20error\x20occurred.','adjustment\x20data\x20update\x20successfully','stock','toString','Chinese','$_id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','expiry_date','ADJF-','<hr\x20class=\x22my-3\x22>','back','</div>','redirect','product_stock','status','user','all','secondary_unit','Portuguese\x20(BR)','Rooms','product','stockBefore','</span>','Enclosed','purchases_data','QA\x20Warehouse','findOne','email','Error\x20Occurs','</head><body>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Finished\x20Goods','foreach\x20newproduct','$room','product_details','message','</tr>','getMonth','minus','/view/add_adjustment','$product_details.production_date','New_Qty_Converted_adj','forEach','Secondary_units','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product','/preview/:id'];a0_0x3d5c=function(){return _0x13139c;};return a0_0x3d5c();}router[a0_0x2d7dd4(0x17a)]('/view',auth,async(_0x9d08ea,_0x4cb5ba)=>{var _0x2ca6e7=a0_0x2d7dd4;try{const {username:_0x47a237,email:_0x424b96,role:_0x381fee}=_0x9d08ea['user'],_0x19fb58=_0x9d08ea[_0x2ca6e7(0xdd)],_0x205bc6=await profile[_0x2ca6e7(0xe8)]({'email':_0x19fb58[_0x2ca6e7(0xe9)]}),_0x4a396c=await master_shop[_0x2ca6e7(0x16f)]();let _0x3b3bb6;if(_0x19fb58[_0x2ca6e7(0x110)]==_0x2ca6e7(0x126)){const _0x1e2175=await staff['findOne']({'email':_0x19fb58[_0x2ca6e7(0xe9)]});_0x3b3bb6=await warehouse[_0x2ca6e7(0x16f)]({'status':_0x2ca6e7(0x10e),'name':_0x1e2175[_0x2ca6e7(0xbc)]});}else _0x3b3bb6=await warehouse['find']({'status':_0x2ca6e7(0x10e)});const _0x58d121=await product[_0x2ca6e7(0x16f)]();let _0xf96cc;if(_0x19fb58[_0x2ca6e7(0x110)]==_0x2ca6e7(0x126)){const _0x83b469=await staff[_0x2ca6e7(0xe8)]({'email':_0x19fb58['email']});_0xf96cc=await adjustment_finished[_0x2ca6e7(0x16f)]({'warehouse_name':_0x83b469[_0x2ca6e7(0xbc)]});}else _0xf96cc=await adjustment_finished[_0x2ca6e7(0xc5)]([{'$unwind':_0x2ca6e7(0xfb)},{'$group':{'_id':_0x2ca6e7(0xd3),'invoice':{'$first':_0x2ca6e7(0x15f)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x2ca6e7(0x13a)},'finalize':{'$first':_0x2ca6e7(0xfe)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x4a396c[0x0][_0x2ca6e7(0xba)]==_0x2ca6e7(0x132)){var _0x12e2ea=users[_0x2ca6e7(0x156)];console[_0x2ca6e7(0x176)](_0x12e2ea);}else{if(_0x4a396c[0x0][_0x2ca6e7(0xba)]=='Hindi')var _0x12e2ea=users[_0x2ca6e7(0xc0)];else{if(_0x4a396c[0x0][_0x2ca6e7(0xba)]=='German')var _0x12e2ea=users[_0x2ca6e7(0x14d)];else{if(_0x4a396c[0x0][_0x2ca6e7(0xba)]==_0x2ca6e7(0xff))var _0x12e2ea=users[_0x2ca6e7(0xff)];else{if(_0x4a396c[0x0][_0x2ca6e7(0xba)]==_0x2ca6e7(0xc9))var _0x12e2ea=users[_0x2ca6e7(0xc9)];else{if(_0x4a396c[0x0][_0x2ca6e7(0xba)]==_0x2ca6e7(0xe0))var _0x12e2ea=users[_0x2ca6e7(0x138)];else{if(_0x4a396c[0x0][_0x2ca6e7(0xba)]==_0x2ca6e7(0xd2))var _0x12e2ea=users[_0x2ca6e7(0xd2)];else{if(_0x4a396c[0x0][_0x2ca6e7(0xba)]=='Arabic\x20(ae)')var _0x12e2ea=users['Arabic'];}}}}}}}_0x4cb5ba[_0x2ca6e7(0xc4)]('adjustment_finished',{'success':_0x9d08ea['flash']('success'),'errors':_0x9d08ea['flash'](_0x2ca6e7(0xc1)),'role':_0x19fb58,'profile':_0x205bc6,'warehouse':_0x3b3bb6,'product':_0x58d121,'adjustment':_0xf96cc,'master_shop':_0x4a396c,'language':_0x12e2ea});}catch(_0x3beab9){console[_0x2ca6e7(0x176)](_0x3beab9);}});async function getRandom8DigitNumber(){var _0x415aba=a0_0x2d7dd4;const _0x4b5ba7=0x989680,_0x367533=0x5f5e0ff,_0x114538=Math[_0x415aba(0x149)](Math['random']()*(_0x367533-_0x4b5ba7+0x1))+_0x4b5ba7;var _0x261cec;const _0x5cb086=await adjustment_finished[_0x415aba(0xe8)]({'invoice':_0x415aba(0xd6)+_0x114538});return _0x5cb086&&_0x5cb086['length']>0x0?_0x261cec='ADJF-'+_0x114538:_0x261cec=_0x415aba(0xd6)+_0x114538,_0x261cec;}function a0_0x578e(_0x2ad507,_0x34c2cc){var _0x3d5c66=a0_0x3d5c();return a0_0x578e=function(_0x578e3a,_0x112d07){_0x578e3a=_0x578e3a-0xb5;var _0x3a2fe8=_0x3d5c66[_0x578e3a];return _0x3a2fe8;},a0_0x578e(_0x2ad507,_0x34c2cc);}router['get'](a0_0x2d7dd4(0xf5),auth,async(_0x195d4a,_0xb4744c)=>{var _0x478f2f=a0_0x2d7dd4;try{const {username:_0x3bcd6b,email:_0x5ebf65,role:_0x1dd6c4}=_0x195d4a[_0x478f2f(0xdd)],_0x6b3dd=_0x195d4a[_0x478f2f(0xdd)],_0x1521cf=await profile[_0x478f2f(0xe8)]({'email':_0x6b3dd[_0x478f2f(0xe9)]}),_0x10dbc7=await master_shop[_0x478f2f(0x16f)]();let _0x56a93a;if(_0x6b3dd[_0x478f2f(0x110)]==_0x478f2f(0x126)){const _0x2402e4=await staff[_0x478f2f(0xe8)]({'email':_0x6b3dd[_0x478f2f(0xe9)]});_0x56a93a=await warehouse[_0x478f2f(0xc5)]([{'$match':{'status':_0x478f2f(0x10e),'name':_0x2402e4[_0x478f2f(0xbc)],'warehouse_category':_0x478f2f(0xed),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':_0x478f2f(0x103)}}}]);}else _0x56a93a=await warehouse['aggregate']([{'$match':{'status':_0x478f2f(0x10e),'warehouse_category':_0x478f2f(0xed),'name':{'$ne':_0x478f2f(0xe7)}}},{'$group':{'_id':_0x478f2f(0x103),'name':{'$first':_0x478f2f(0x103)}}}]);const _0x3c5e55=await product['find']({}),_0x385e10=await adjustment_finished['find']({}),_0x503beb=_0x385e10[_0x478f2f(0xcb)]+0x1,_0xb8145f=_0x478f2f(0xd6)+_0x503beb[_0x478f2f(0xd1)]()['padStart'](0x5,'0');var _0x4ab74d=[_0x478f2f(0x177),_0x478f2f(0xe5),_0x478f2f(0x160)];if(_0x10dbc7[0x0]['language']==_0x478f2f(0x132))var _0x37a646=users[_0x478f2f(0x156)];else{if(_0x10dbc7[0x0][_0x478f2f(0xba)]=='Hindi')var _0x37a646=users[_0x478f2f(0xc0)];else{if(_0x10dbc7[0x0][_0x478f2f(0xba)]=='German')var _0x37a646=users[_0x478f2f(0x14d)];else{if(_0x10dbc7[0x0][_0x478f2f(0xba)]==_0x478f2f(0xff))var _0x37a646=users[_0x478f2f(0xff)];else{if(_0x10dbc7[0x0][_0x478f2f(0xba)]=='French')var _0x37a646=users[_0x478f2f(0xc9)];else{if(_0x10dbc7[0x0][_0x478f2f(0xba)]==_0x478f2f(0xe0))var _0x37a646=users['Portuguese'];else{if(_0x10dbc7[0x0][_0x478f2f(0xba)]==_0x478f2f(0xd2))var _0x37a646=users['Chinese'];else{if(_0x10dbc7[0x0][_0x478f2f(0xba)]==_0x478f2f(0x165))var _0x37a646=users['Arabic'];}}}}}}}const _0x47049=getRandom8DigitNumber();_0x47049[_0x478f2f(0x163)](_0x4aff80=>{var _0x5bf7bc=_0x478f2f;_0xb4744c[_0x5bf7bc(0xc4)]('add_adjustment_finished',{'success':_0x195d4a[_0x5bf7bc(0xbb)](_0x5bf7bc(0xbe)),'errors':_0x195d4a[_0x5bf7bc(0xbb)](_0x5bf7bc(0xc1)),'role':_0x6b3dd,'profile':_0x1521cf,'warehouse':_0x56a93a,'product':_0x3c5e55,'master_shop':_0x10dbc7,'language':_0x37a646,'rooms_data':_0x4ab74d,'invoice_no':_0x4aff80});})['catch'](_0x4371d3=>{var _0x2585e8=_0x478f2f;_0x195d4a['flash'](_0x2585e8(0xc1),_0x2585e8(0x15c)),_0xb4744c[_0x2585e8(0xda)](_0x2585e8(0x109));});}catch(_0x4b9cf6){console[_0x478f2f(0x176)](_0x4b9cf6);}}),router[a0_0x2d7dd4(0xcc)]('/view/add_adjustment',auth,async(_0x32a227,_0x10d285)=>{var _0x93ec94=a0_0x2d7dd4;try{const {warehouse_name:_0x4c11ce,date:_0x195ec8,prod_name:_0x456009,level:_0x147c87,isle:_0x57b45a,pallet:_0x3739d8,stock:_0x209537,types:_0x28414c,adjust_qty:_0x263cb1,new_adjust_qty:_0x2c0593,note:_0x5f55bf,Room_name:_0x3e6ff1,invoice:_0x17c34d,JO_number:_0x248863,expiry_date:_0x55841}=_0x32a227[_0x93ec94(0x16a)];if(typeof _0x456009=='string')var _0x3da25d=[_0x32a227['body'][_0x93ec94(0xb5)]],_0x29867b=[_0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x155)]],_0x333ec2=[_0x32a227['body'][_0x93ec94(0xd0)]],_0x557fba=[_0x32a227['body'][_0x93ec94(0xfd)]],_0x4aaa61=[_0x32a227[_0x93ec94(0x16a)][_0x93ec94(0xf7)]],_0x4a47ab=[_0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x159)]],_0xdc1a09=[_0x32a227[_0x93ec94(0x16a)][_0x93ec94(0xc7)]],_0x49b227=[_0x32a227[_0x93ec94(0x16a)][_0x93ec94(0xf9)]],_0x577b8b=[_0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x11b)]],_0x222c40=[_0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x130)]],_0x117f84=[_0x32a227[_0x93ec94(0x16a)]['expiry_date']],_0x58461e=[_0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x151)]],_0x2bd15e=[_0x32a227[_0x93ec94(0x16a)]['prod_cat']],_0xf7487a=[_0x32a227[_0x93ec94(0x16a)]['Rooms']],_0x511c21=[_0x32a227['body'][_0x93ec94(0x171)]],_0x5c3ced=[_0x32a227[_0x93ec94(0x16a)][_0x93ec94(0xb6)]];else var _0x3da25d=[..._0x32a227['body'][_0x93ec94(0xb5)]],_0x29867b=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x155)]],_0x333ec2=[..._0x32a227[_0x93ec94(0x16a)]['stock']],_0x557fba=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0xfd)]],_0x4aaa61=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0xf7)]],_0x4a47ab=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x159)]],_0xdc1a09=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0xc7)]],_0x49b227=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0xf9)]],_0x577b8b=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x11b)]],_0x222c40=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x130)]],_0x117f84=[..._0x32a227['body'][_0x93ec94(0xd5)]],_0x58461e=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x151)]],_0x2bd15e=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0x158)]],_0xf7487a=[..._0x32a227[_0x93ec94(0x16a)][_0x93ec94(0xe1)]],_0x511c21=[..._0x32a227['body'][_0x93ec94(0x171)]],_0x5c3ced=[..._0x32a227['body'][_0x93ec94(0xb6)]];const _0x2cd7e2=_0x3da25d[_0x93ec94(0x164)](_0x41e76e=>{return _0x41e76e={'product_name':_0x41e76e};});_0x29867b[_0x93ec94(0xf8)]((_0x5335ab,_0x4aca15)=>{_0x2cd7e2[_0x4aca15]['bay']=_0x5335ab;}),_0x333ec2[_0x93ec94(0xf8)]((_0x5a0b8f,_0x2d0e4d)=>{var _0x32d98b=_0x93ec94;_0x2cd7e2[_0x2d0e4d][_0x32d98b(0xe3)]=_0x5a0b8f;}),_0x557fba[_0x93ec94(0xf8)]((_0x2114b5,_0x1c1a11)=>{var _0x3fb3bd=_0x93ec94;_0x2cd7e2[_0x1c1a11][_0x3fb3bd(0xfd)]=_0x2114b5;}),_0x4aaa61[_0x93ec94(0xf8)]((_0x440cc6,_0x204985)=>{var _0x3e609e=_0x93ec94;_0x2cd7e2[_0x204985][_0x3e609e(0x153)]=_0x440cc6;}),_0x4a47ab[_0x93ec94(0xf8)]((_0x1678ee,_0x2199f1)=>{_0x2cd7e2[_0x2199f1]['new_adjust_qty']=_0x1678ee;}),_0xdc1a09['forEach']((_0x111847,_0x3b3600)=>{var _0x31d6b7=_0x93ec94;_0x2cd7e2[_0x3b3600][_0x31d6b7(0x141)]=_0x111847;}),_0x49b227['forEach']((_0x4b8d0a,_0x8d0dad)=>{var _0x257551=_0x93ec94;_0x2cd7e2[_0x8d0dad][_0x257551(0xdf)]=_0x4b8d0a;}),_0x577b8b[_0x93ec94(0xf8)]((_0xd73090,_0x38a3ae)=>{var _0x40ef04=_0x93ec94;_0x2cd7e2[_0x38a3ae][_0x40ef04(0x16c)]=_0xd73090;}),_0x222c40[_0x93ec94(0xf8)]((_0x1dc52b,_0x2c8bbf)=>{var _0x4b14a1=_0x93ec94;_0x2cd7e2[_0x2c8bbf][_0x4b14a1(0x130)]=_0x1dc52b;}),_0x117f84[_0x93ec94(0xf8)]((_0xedceaf,_0x194b0f)=>{var _0x2bd3a9=_0x93ec94;_0x2cd7e2[_0x194b0f][_0x2bd3a9(0xd5)]=_0xedceaf;}),_0x58461e[_0x93ec94(0xf8)]((_0x184e33,_0x17f524)=>{_0x2cd7e2[_0x17f524]['production_date']=_0x184e33;}),_0x2bd15e[_0x93ec94(0xf8)]((_0x43c5d3,_0x320f12)=>{var _0x4c70a7=_0x93ec94;_0x2cd7e2[_0x320f12][_0x4c70a7(0x158)]=_0x43c5d3;}),_0xf7487a[_0x93ec94(0xf8)]((_0x1e7cf5,_0x3381d1)=>{var _0x129674=_0x93ec94;_0x2cd7e2[_0x3381d1][_0x129674(0x128)]=_0x1e7cf5;}),_0x511c21[_0x93ec94(0xf8)]((_0x5afcd4,_0x3c2a62)=>{_0x2cd7e2[_0x3c2a62]['maxPerUnit']=_0x5afcd4;}),_0x5c3ced['forEach']((_0x549b96,_0x4ceffd)=>{var _0x271b40=_0x93ec94;_0x2cd7e2[_0x4ceffd][_0x271b40(0x116)]=_0x549b96;});const _0x15fedc=_0x2cd7e2['filter'](_0x2b8e0c=>_0x2b8e0c[_0x93ec94(0x153)]!=='0'&&_0x2b8e0c[_0x93ec94(0x153)]!=='');var _0x5cb8b7=0x0;_0x15fedc[_0x93ec94(0xf8)](_0xac334e=>{var _0x501fb2=_0x93ec94;console[_0x501fb2(0x176)](_0x501fb2(0xee),_0xac334e),parseInt(_0xac334e[_0x501fb2(0x153)])<=0x0&&_0x5cb8b7++;});if(_0x5cb8b7!=0x0)return _0x32a227['flash'](_0x93ec94(0xc1),_0x93ec94(0x125)),_0x10d285[_0x93ec94(0xda)]('back');const _0x58b51a=new adjustment_finished({'warehouse_name':_0x4c11ce,'date':_0x195ec8,'product':_0x15fedc,'note':_0x5f55bf,'room':_0x3e6ff1,'invoice':_0x17c34d,'JO_number':_0x248863,'expiry_date':_0x55841}),_0x42ca06=await _0x58b51a['save']();_0x32a227['flash'](_0x93ec94(0xbe),_0x93ec94(0x16b)),_0x10d285[_0x93ec94(0xda)]('/adjustment_finished/preview/'+_0x42ca06[_0x93ec94(0x11f)]);}catch(_0x1d230f){console[_0x93ec94(0x176)](_0x1d230f),_0x10d285['status'](0xc8)['json']({'message':_0x1d230f[_0x93ec94(0xf1)]});}}),router[a0_0x2d7dd4(0x17a)](a0_0x2d7dd4(0xfc),auth,async(_0x53b2cf,_0x2898f1)=>{var _0x446229=a0_0x2d7dd4;try{const {username:_0x6ba14d,email:_0x4184c7,role:_0xe04e88}=_0x53b2cf[_0x446229(0xdd)],_0x3ecd5c=_0x53b2cf[_0x446229(0xdd)],_0x412fa3=await profile['findOne']({'email':_0x3ecd5c[_0x446229(0xe9)]}),_0x407798=await master_shop[_0x446229(0x16f)](),_0x57922=_0x53b2cf['params']['id'],_0x35b288=await adjustment_finished[_0x446229(0x11d)]({'_id':_0x57922}),_0x3e0b20=await purchases[_0x446229(0xc5)]([{'$match':{'warehouse_name':_0x35b288[_0x446229(0x17d)]}},{'$unwind':'$product'},{'$group':{'_id':_0x446229(0x13e)}}]);console['log'](_0x446229(0xe6),_0x3e0b20);const _0x26ec62=await product[_0x446229(0x16f)]({}),_0x11c166=await warehouse[_0x446229(0xc5)]([{'$match':{'name':_0x35b288[_0x446229(0x17d)],'warehouse_category':_0x446229(0xed)}},{'$unwind':_0x446229(0x16d)},{'$group':{'_id':_0x446229(0x143),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x446229(0x142)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x446229(0x115)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x446229(0x11e)},'primary_code':{'$first':_0x446229(0x14f)},'secondary_code':{'$first':_0x446229(0x148)},'product_code':{'$first':_0x446229(0x107)},'storage':{'$first':_0x446229(0x11a)},'rack':{'$first':_0x446229(0xc6)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x446229(0xf6)},'batch_code':{'$first':_0x446229(0x175)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':'$room'}}}]);if(_0x407798[0x0][_0x446229(0xba)]==_0x446229(0x132)){var _0x53a345=users['English'];console['log'](_0x53a345);}else{if(_0x407798[0x0][_0x446229(0xba)]=='Hindi')var _0x53a345=users[_0x446229(0xc0)];else{if(_0x407798[0x0][_0x446229(0xba)]==_0x446229(0x14d))var _0x53a345=users[_0x446229(0x14d)];else{if(_0x407798[0x0][_0x446229(0xba)]=='Spanish')var _0x53a345=users[_0x446229(0xff)];else{if(_0x407798[0x0][_0x446229(0xba)]==_0x446229(0xc9))var _0x53a345=users['French'];else{if(_0x407798[0x0]['language']==_0x446229(0xe0))var _0x53a345=users[_0x446229(0x138)];else{if(_0x407798[0x0]['language']==_0x446229(0xd2))var _0x53a345=users[_0x446229(0xd2)];else{if(_0x407798[0x0][_0x446229(0xba)]==_0x446229(0x165))var _0x53a345=users[_0x446229(0xbd)];}}}}}}}_0x2898f1[_0x446229(0xc4)](_0x446229(0x14e),{'success':_0x53b2cf[_0x446229(0xbb)]('success'),'errors':_0x53b2cf['flash'](_0x446229(0xc1)),'role':_0x3ecd5c,'profile':_0x412fa3,'adjustment':_0x35b288,'stock':_0x11c166,'master_shop':_0x407798,'warehouse_name':_0x3e0b20,'unit':_0x26ec62,'language':_0x53a345});}catch(_0x5bdf9b){console[_0x446229(0x176)](_0x5bdf9b),_0x2898f1[_0x446229(0xdc)](0xc8)[_0x446229(0xca)]({'message':_0x5bdf9b['message']});}}),router['post'](a0_0x2d7dd4(0xfc),auth,async(_0x4767f4,_0x4ae974)=>{var _0x4d24e4=a0_0x2d7dd4;try{const {invoice:_0x37b01b,warehouse_name:_0x47c895,Room_name:_0x53177d}=_0x4767f4['body'],_0x5861d2=_0x4767f4['params']['id'],_0x2f16d1=await adjustment_finished['findById']({'_id':_0x5861d2});var _0xb5718a;const _0xbeaef7=_0x2f16d1['product'][_0x4d24e4(0x164)](async _0x466c60=>{var _0x3d373c=_0x4d24e4;if(_0x466c60[_0x3d373c(0x153)]>0x0){_0xb5718a=await warehouse['findOne']({'name':_0x47c895,'room':_0x466c60[_0x3d373c(0x128)],'warehouse_category':'Finished\x20Goods'});const _0x225252=_0xb5718a[_0x3d373c(0xf0)]['map'](_0x1e9b31=>{var _0x20ef18=_0x3d373c;console[_0x20ef18(0x176)](_0x466c60['types']);if(_0x466c60[_0x20ef18(0xfd)]=='minus')_0x1e9b31[_0x20ef18(0x13b)]==_0x466c60['product_name']&&_0x1e9b31[_0x20ef18(0x131)]==_0x466c60[_0x20ef18(0x131)]&&_0x1e9b31[_0x20ef18(0xd5)]==_0x466c60[_0x20ef18(0xd5)]&&_0x1e9b31['production_date']==_0x466c60[_0x20ef18(0x112)]&&_0x1e9b31[_0x20ef18(0x130)]==_0x466c60[_0x20ef18(0x130)]&&_0x1e9b31['invoice']==_0x466c60[_0x20ef18(0x116)]&&(_0x1e9b31['product_stock']=_0x1e9b31[_0x20ef18(0xdb)]-_0x466c60[_0x20ef18(0x153)]);else _0x466c60[_0x20ef18(0xfd)]=='add'&&(_0x1e9b31['product_name']==_0x466c60[_0x20ef18(0x13b)]&&_0x1e9b31['bay']==_0x466c60[_0x20ef18(0x131)]&&_0x1e9b31[_0x20ef18(0xd5)]==_0x466c60[_0x20ef18(0xd5)]&&_0x1e9b31['production_date']==_0x466c60['production_date']&&_0x1e9b31[_0x20ef18(0x130)]==_0x466c60[_0x20ef18(0x130)]&&_0x1e9b31['invoice']==_0x466c60[_0x20ef18(0x116)]&&(_0x1e9b31[_0x20ef18(0xdb)]=_0x1e9b31[_0x20ef18(0xdb)]+_0x466c60[_0x20ef18(0x153)]));});}return _0xb5718a;});Promise['all'](_0xbeaef7)[_0x4d24e4(0x163)](async _0xd1b2bd=>{var _0x45d217=_0x4d24e4;try{for(const _0x4c5e4b of _0xd1b2bd){await _0x4c5e4b[_0x45d217(0x134)]();}_0x2f16d1['finalize']=_0x45d217(0x14b);const _0x1a2128=await _0x2f16d1[_0x45d217(0x134)](),_0xb76e=await master_shop[_0x45d217(0x16f)](),_0x5575ff=await email_settings['findOne'](),_0x5057a0=await supervisor_settings[_0x45d217(0x16f)]();var _0x2fdfee=_0x2f16d1[_0x45d217(0xe2)],_0x56f905='',_0x12d627;for(_0x12d627 in _0x2fdfee){var _0x45c5a1='FG';_0x2f16d1[_0x45d217(0x17d)]==_0x45d217(0x147)&&(_0x45c5a1='DG'),_0x56f905+=_0x45d217(0x169)+_0x45d217(0xcd)+_0x2fdfee[_0x12d627][_0x45d217(0x13b)]+_0x45d217(0x12c)+_0x45d217(0xcd)+_0x2fdfee[_0x12d627]['product_code']+'</td>'+_0x45d217(0xcd)+_0x2fdfee[_0x12d627]['adjust_qty']+_0x45d217(0x12c)+_0x45d217(0xcd)+_0x2fdfee[_0x12d627][_0x45d217(0x141)]+'</td>'+_0x45d217(0xcd)+_0x2fdfee[_0x12d627][_0x45d217(0xdf)]+'</td>'+_0x45d217(0xcd)+_0x2f16d1[_0x45d217(0x17d)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2fdfee[_0x12d627][_0x45d217(0x128)]+_0x45d217(0x12c)+_0x45d217(0xcd)+_0x45c5a1+_0x2fdfee[_0x12d627][_0x45d217(0x131)]+'</td>'+_0x45d217(0xf2);}let _0x21e3bd=nodemailer[_0x45d217(0x137)]({'host':_0x5575ff[_0x45d217(0x129)],'port':Number(_0x5575ff[_0x45d217(0x121)]),'secure':![],'auth':{'user':_0x5575ff['email'],'pass':_0x5575ff[_0x45d217(0x174)]}}),_0x1a6050={'from':_0x5575ff[_0x45d217(0xe9)],'to':_0x5057a0[0x0][_0x45d217(0xc3)],'subject':_0x45d217(0x122),'attachments':[{'filename':'Logo.png','path':__dirname+_0x45d217(0x152)+'/upload/'+_0xb76e[0x0]['image'],'cid':'logo'}],'html':_0x45d217(0x15e)+_0x45d217(0x11c)+_0x45d217(0xeb)+_0x45d217(0x100)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x45d217(0x100)+_0x45d217(0x105)+'</div>'+_0x45d217(0x100)+_0x45d217(0x119)+_0xb76e[0x0]['site_title']+_0x45d217(0x17b)+_0x45d217(0xd9)+_0x45d217(0xd9)+_0x45d217(0xd7)+_0x45d217(0x100)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x45d217(0x12b)+_0x2f16d1[_0x45d217(0x116)]+'\x20'+_0x45d217(0x168)+_0x45d217(0x145)+_0x2f16d1[_0x45d217(0x104)]+'\x20'+_0x45d217(0xe4)+_0x45d217(0x179)+_0x45d217(0xd9)+_0x45d217(0xd4)+_0x45d217(0x178)+_0x45d217(0x169)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x45d217(0x118)+_0x45d217(0xfa)+_0x45d217(0x114)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x45d217(0x106)+_0x45d217(0x161)+_0x45d217(0xec)+'</tr>'+_0x45d217(0x10b)+_0x45d217(0x14a)+'\x20'+_0x56f905+'\x20'+'</tbody>'+'</table>'+'<div>'+_0x45d217(0xb9)+'<h5>'+_0xb76e[0x0]['site_title']+_0x45d217(0x179)+_0x45d217(0xd9)+_0x45d217(0xd9)+_0x45d217(0x172)};_0x21e3bd['sendMail'](_0x1a6050,function(_0x23d123,_0x3ac27e){var _0x38a7a3=_0x45d217;_0x23d123?(console[_0x38a7a3(0x176)](_0x23d123),console['log'](_0x38a7a3(0xea))):console[_0x38a7a3(0x176)](_0x38a7a3(0x170));}),_0x4767f4[_0x45d217(0xbb)](_0x45d217(0xbe),_0x45d217(0xc8)),_0x4ae974['redirect']('/picking_list/PDF_adjustment/'+_0x1a2128[_0x45d217(0x11f)]);}catch(_0x10c87b){console[_0x45d217(0x13d)](_0x10c87b),_0x4ae974[_0x45d217(0xdc)](0x1f4)['json']({'error':_0x45d217(0x127)});}})[_0x4d24e4(0x108)](_0x47fbf0=>{var _0x3776b7=_0x4d24e4;console[_0x3776b7(0x13d)](_0x47fbf0),_0x4ae974[_0x3776b7(0xdc)](0x1f4)[_0x3776b7(0xca)]({'error':_0x3776b7(0xce)});});}catch(_0x201c60){_0x4ae974['json']({'message':_0x201c60[_0x4d24e4(0xf1)]});}}),router['get']('/view/:id',auth,async(_0x5cba95,_0x3dc1c3)=>{var _0x120ff7=a0_0x2d7dd4;try{const {username:_0x68db20,email:_0x69b59,role:_0x304dc8}=_0x5cba95[_0x120ff7(0xdd)],_0x92cea=_0x5cba95[_0x120ff7(0xdd)],_0x3af9f5=await profile['findOne']({'email':_0x92cea['email']}),_0x2013ca=await master_shop['find']();console[_0x120ff7(0x176)]('master',_0x2013ca);const _0x3414e8=_0x5cba95[_0x120ff7(0x140)]['id'],_0x58fe2d=await adjustment_finished[_0x120ff7(0x11d)]({'_id':_0x3414e8});let _0x3658a8=new Date(_0x58fe2d['expiry_date']),_0x11dcc7=('0'+_0x3658a8['getDate']())[_0x120ff7(0x146)](-0x2),_0x44400a=('0'+(_0x3658a8[_0x120ff7(0xf3)]()+0x1))['slice'](-0x2),_0x24d067=_0x3658a8[_0x120ff7(0x150)](),_0x551b48=_0x24d067+'-'+_0x44400a+'-'+_0x11dcc7;var _0xf52df4=[_0x120ff7(0x177),'Enclosed',_0x120ff7(0x160)];const _0x5e8b7b=await purchases[_0x120ff7(0xc5)]([{'$match':{'warehouse_name':_0x58fe2d[_0x120ff7(0x17d)]}},{'$unwind':_0x120ff7(0xfb)},{'$group':{'_id':'$product.product_name'}}]);console[_0x120ff7(0x176)](_0x120ff7(0xe6),_0x5e8b7b);const _0x22dca4=await product[_0x120ff7(0x16f)]({}),_0x306d64=await warehouse[_0x120ff7(0xc5)]([{'$match':{'name':_0x58fe2d[_0x120ff7(0x17d)],'room':_0x58fe2d[_0x120ff7(0x10a)]}},{'$unwind':_0x120ff7(0x16d)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x120ff7(0x14c)},'product_stock':{'$first':_0x120ff7(0x142)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x120ff7(0x115)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x120ff7(0x11e)},'primary_code':{'$first':_0x120ff7(0x14f)},'secondary_code':{'$first':_0x120ff7(0x148)},'product_code':{'$first':_0x120ff7(0x107)},'storage':{'$first':_0x120ff7(0x11a)},'rack':{'$first':_0x120ff7(0xc6)}}}]);if(_0x2013ca[0x0][_0x120ff7(0xba)]==_0x120ff7(0x132)){var _0x1afd5c=users[_0x120ff7(0x156)];console[_0x120ff7(0x176)](_0x1afd5c);}else{if(_0x2013ca[0x0]['language']=='Hindi')var _0x1afd5c=users[_0x120ff7(0xc0)];else{if(_0x2013ca[0x0][_0x120ff7(0xba)]==_0x120ff7(0x14d))var _0x1afd5c=users[_0x120ff7(0x14d)];else{if(_0x2013ca[0x0][_0x120ff7(0xba)]==_0x120ff7(0xff))var _0x1afd5c=users[_0x120ff7(0xff)];else{if(_0x2013ca[0x0][_0x120ff7(0xba)]==_0x120ff7(0xc9))var _0x1afd5c=users[_0x120ff7(0xc9)];else{if(_0x2013ca[0x0][_0x120ff7(0xba)]==_0x120ff7(0xe0))var _0x1afd5c=users[_0x120ff7(0x138)];else{if(_0x2013ca[0x0][_0x120ff7(0xba)]==_0x120ff7(0xd2))var _0x1afd5c=users[_0x120ff7(0xd2)];else{if(_0x2013ca[0x0][_0x120ff7(0xba)]==_0x120ff7(0x165))var _0x1afd5c=users[_0x120ff7(0xbd)];}}}}}}}_0x3dc1c3['render'](_0x120ff7(0x124),{'success':_0x5cba95['flash'](_0x120ff7(0xbe)),'errors':_0x5cba95[_0x120ff7(0xbb)](_0x120ff7(0xc1)),'role':_0x92cea,'profile':_0x3af9f5,'adjustment':_0x58fe2d,'stock':_0x306d64,'master_shop':_0x2013ca,'warehouse_name':_0x5e8b7b,'unit':_0x22dca4,'language':_0x1afd5c,'rooms_data':_0xf52df4,'ed_fullDate':_0x551b48});}catch(_0x7aae56){console[_0x120ff7(0x176)](_0x7aae56),_0x3dc1c3[_0x120ff7(0xdc)](0xc8)[_0x120ff7(0xca)]({'message':_0x7aae56[_0x120ff7(0xf1)]});}}),router[a0_0x2d7dd4(0xcc)](a0_0x2d7dd4(0x173),auth,async(_0x7da057,_0xe0a8c7)=>{var _0x4fd218=a0_0x2d7dd4;try{const _0x40b740=_0x7da057['params']['id'],_0x54f183=await adjustment_finished[_0x4fd218(0x11d)]({'_id':_0x40b740}),_0x34fd63=await warehouse['findOne']({'name':_0x54f183[_0x4fd218(0x17d)],'room':_0x54f183[_0x4fd218(0x10a)]}),{warehouse_name:_0x5b03e1,date:_0x3cc5e3,prod_name:_0x20a4b8,level:_0x224938,isle:_0x2151c7,pallet:_0x105bd2,stock:_0x4f301e,types:_0x13fc8e,adjust_qty:_0x4c10d6,new_adjust_qty:_0x3faf55,note:_0x367891,Room_name:_0x361e19,invoice:_0x5d2435,JO_number:_0x533bf3}=_0x7da057[_0x4fd218(0x16a)];if(typeof _0x20a4b8==_0x4fd218(0x139))var _0x3a4dd3=[_0x7da057['body'][_0x4fd218(0xb5)]],_0x42b460=[_0x7da057[_0x4fd218(0x16a)][_0x4fd218(0x155)]],_0x285f0a=[_0x7da057['body'][_0x4fd218(0xd0)]],_0x1ffa97=[_0x7da057[_0x4fd218(0x16a)]['types']],_0x4a63e2=[_0x7da057['body'][_0x4fd218(0x153)]],_0x491d6d=[_0x7da057[_0x4fd218(0x16a)][_0x4fd218(0x12d)]],_0x3b962d=[_0x7da057[_0x4fd218(0x16a)]['prod_code']],_0xe76631=[_0x7da057[_0x4fd218(0x16a)][_0x4fd218(0x141)]],_0x4c6e45=[_0x7da057[_0x4fd218(0x16a)][_0x4fd218(0xf9)]],_0x1b1c25=[_0x7da057[_0x4fd218(0x16a)][_0x4fd218(0x130)]],_0x3e4590=[_0x7da057[_0x4fd218(0x16a)][_0x4fd218(0xd5)]];else var _0x3a4dd3=[..._0x7da057[_0x4fd218(0x16a)][_0x4fd218(0xb5)]],_0x42b460=[..._0x7da057[_0x4fd218(0x16a)][_0x4fd218(0x155)]],_0x285f0a=[..._0x7da057['body'][_0x4fd218(0xd0)]],_0x1ffa97=[..._0x7da057[_0x4fd218(0x16a)]['types']],_0x4a63e2=[..._0x7da057['body'][_0x4fd218(0x153)]],_0x491d6d=[..._0x7da057[_0x4fd218(0x16a)][_0x4fd218(0x12d)]],_0x3b962d=[..._0x7da057['body']['prod_code']],_0xe76631=[..._0x7da057[_0x4fd218(0x16a)][_0x4fd218(0x141)]],_0x4c6e45=[..._0x7da057[_0x4fd218(0x16a)][_0x4fd218(0xf9)]],_0x1b1c25=[..._0x7da057[_0x4fd218(0x16a)][_0x4fd218(0x130)]],_0x3e4590=[..._0x7da057[_0x4fd218(0x16a)][_0x4fd218(0xd5)]];const _0x4be6bd=_0x3a4dd3[_0x4fd218(0x164)](_0x4d695b=>{return _0x4d695b={'product_name':_0x4d695b};});_0x42b460[_0x4fd218(0xf8)]((_0x405e8d,_0x2c469e)=>{var _0x1a960a=_0x4fd218;_0x4be6bd[_0x2c469e][_0x1a960a(0x131)]=_0x405e8d;}),_0x285f0a[_0x4fd218(0xf8)]((_0x5dbc74,_0x2c6130)=>{var _0x56b1ce=_0x4fd218;_0x4be6bd[_0x2c6130][_0x56b1ce(0xe3)]=_0x5dbc74;}),_0x1ffa97['forEach']((_0x3afe20,_0x1e039a)=>{var _0xf06b43=_0x4fd218;_0x4be6bd[_0x1e039a][_0xf06b43(0xfd)]=_0x3afe20;}),_0x4a63e2[_0x4fd218(0xf8)]((_0x1f2645,_0x2596a9)=>{var _0x243cbc=_0x4fd218;_0x4be6bd[_0x2596a9][_0x243cbc(0x153)]=_0x1f2645;}),_0x491d6d['forEach']((_0x4186b1,_0xd46774)=>{var _0x442f99=_0x4fd218;_0x4be6bd[_0xd46774][_0x442f99(0x12d)]=_0x4186b1;}),_0xe76631[_0x4fd218(0xf8)]((_0x19085c,_0x267736)=>{var _0x3055e5=_0x4fd218;_0x4be6bd[_0x267736][_0x3055e5(0x141)]=_0x19085c;}),_0x4c6e45[_0x4fd218(0xf8)]((_0x5a7f7c,_0x15fcd5)=>{_0x4be6bd[_0x15fcd5]['secondary_unit']=_0x5a7f7c;}),_0x3b962d['forEach']((_0x183d8e,_0x1ef222)=>{var _0x10adc3=_0x4fd218;_0x4be6bd[_0x1ef222][_0x10adc3(0x16c)]=_0x183d8e;}),_0x1b1c25['forEach']((_0x24d267,_0x5d6161)=>{_0x4be6bd[_0x5d6161]['batch_code']=_0x24d267;}),_0x3e4590[_0x4fd218(0xf8)]((_0x6e8736,_0x197fce)=>{_0x4be6bd[_0x197fce]['expiry_date']=_0x6e8736;});const _0x37d2a3=_0x4be6bd[_0x4fd218(0x10f)](_0x1bb995=>_0x1bb995[_0x4fd218(0x153)]!=='0'&&_0x1bb995['adjust_qty']!=='');var _0x5e4a36=0x0;_0x37d2a3['forEach'](_0x24c250=>{var _0x1eebaa=_0x4fd218;console[_0x1eebaa(0x176)](_0x1eebaa(0xee),_0x24c250),parseInt(_0x24c250[_0x1eebaa(0x153)])<=0x0&&_0x5e4a36++;});if(_0x5e4a36!=0x0)return _0x7da057[_0x4fd218(0xbb)](_0x4fd218(0xc1),_0x4fd218(0x125)),_0xe0a8c7[_0x4fd218(0xda)](_0x4fd218(0xd8));_0x54f183[_0x4fd218(0x17d)]=_0x5b03e1,_0x54f183[_0x4fd218(0x104)]=_0x3cc5e3,_0x54f183['product']=_0x37d2a3,_0x54f183[_0x4fd218(0x15b)]=_0x367891,_0x54f183[_0x4fd218(0x10a)]=_0x361e19,_0x54f183['invoice']=_0x5d2435,_0x54f183[_0x4fd218(0x10d)]=_0x533bf3;const _0x341d0f=await _0x54f183[_0x4fd218(0x134)](),_0x24aab2=await warehouse[_0x4fd218(0xe8)]({'name':_0x5b03e1,'room':_0x361e19});_0x341d0f['product'][_0x4fd218(0xf8)](_0x3d8d6b=>{var _0xcdfbea=_0x4fd218;const _0x56320c=_0x24aab2[_0xcdfbea(0xf0)][_0xcdfbea(0x164)](_0x5f3aa6=>{var _0x2d2013=_0xcdfbea;_0x3d8d6b[_0x2d2013(0xfd)]==_0x2d2013(0xf4)?_0x5f3aa6['product_name']==_0x3d8d6b[_0x2d2013(0x13b)]&&_0x5f3aa6['bay']==_0x3d8d6b[_0x2d2013(0x131)]&&(_0x5f3aa6[_0x2d2013(0xdb)]=parseInt(_0x5f3aa6[_0x2d2013(0xdb)])-parseInt(_0x3d8d6b['adjust_qty'])):_0x5f3aa6['product_name']==_0x3d8d6b[_0x2d2013(0x13b)]&&_0x5f3aa6[_0x2d2013(0x131)]==_0x3d8d6b[_0x2d2013(0x131)]&&(_0x5f3aa6[_0x2d2013(0xdb)]=parseInt(_0x5f3aa6[_0x2d2013(0xdb)])+parseInt(_0x3d8d6b[_0x2d2013(0x153)]));});}),await _0x24aab2[_0x4fd218(0x134)](),_0x7da057[_0x4fd218(0xbb)]('success',_0x4fd218(0xcf)),_0xe0a8c7[_0x4fd218(0xda)](_0x4fd218(0xbf));}catch(_0x9ee157){console[_0x4fd218(0x176)](_0x9ee157);}}),router[a0_0x2d7dd4(0xcc)](a0_0x2d7dd4(0x133),async(_0x5c86cd,_0x58f956)=>{var _0x272a5c=a0_0x2d7dd4;const {primary_code:_0x53c6e8,warehouse_data:_0x4bc960,rooms_data:_0x3088f0,Roomslist:_0x4b5222}=_0x5c86cd[_0x272a5c(0x16a)],_0x18fd0d=_0x4b5222[_0x272a5c(0x12e)](','),_0x22a87e=[];async function _0x297314(_0x34b7e8){var _0x5b174a=_0x272a5c;const _0x5a615b=await warehouse[_0x5b174a(0xc5)]([{'$match':{'name':_0x4bc960,'room':_0x34b7e8}},{'$unwind':_0x5b174a(0x16d)},{'$match':{'product_details.primary_code':_0x53c6e8}},{'$group':{'_id':_0x5b174a(0x143),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x5b174a(0x14f)},'secondary_code':{'$first':_0x5b174a(0x148)},'product_code':{'$first':_0x5b174a(0x107)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x5b174a(0x117)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5b174a(0x157)},'secondary_unit':{'$first':_0x5b174a(0x101)},'storage':{'$first':_0x5b174a(0x11a)},'rack':{'$first':_0x5b174a(0xc6)},'expiry_date':{'$first':_0x5b174a(0x136)},'production_date':{'$first':_0x5b174a(0xf6)},'batch_code':{'$first':_0x5b174a(0x175)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x5b174a(0x166)},'roomNamed':{'$first':_0x5b174a(0xef)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x4eebe7=await warehouse[_0x5b174a(0xc5)]([{'$match':{'name':_0x4bc960,'room':_0x34b7e8}},{'$unwind':_0x5b174a(0x16d)},{'$match':{'product_details.secondary_code':_0x53c6e8}},{'$group':{'_id':_0x5b174a(0x143),'name':{'$first':_0x5b174a(0x14c)},'product_stock':{'$first':_0x5b174a(0x142)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5b174a(0x148)},'product_code':{'$first':_0x5b174a(0x107)},'level':{'$first':_0x5b174a(0xb8)},'isle':{'$first':_0x5b174a(0x115)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x5b174a(0x11e)},'unit':{'$first':_0x5b174a(0x157)},'secondary_unit':{'$first':_0x5b174a(0x101)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5b174a(0x136)},'production_date':{'$first':_0x5b174a(0xf6)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x5b174a(0x166)},'roomNamed':{'$first':_0x5b174a(0xef)},'invoice':{'$first':_0x5b174a(0x167)}}}]);if(_0x5a615b[_0x5b174a(0xcb)]>0x0)_0x22a87e[_0x5b174a(0x15d)](_0x5a615b);else _0x4eebe7[_0x5b174a(0xcb)]>0x0&&_0x22a87e[_0x5b174a(0x15d)](_0x4eebe7);}const _0x453bd0=_0x18fd0d[_0x272a5c(0x164)](_0x32410a=>_0x297314(_0x32410a));await Promise[_0x272a5c(0xde)](_0x453bd0),_0x58f956[_0x272a5c(0xca)](_0x22a87e);}),router[a0_0x2d7dd4(0xcc)](a0_0x2d7dd4(0x135),async(_0xa4a2ad,_0xbf7fa9)=>{var _0x1a5e54=a0_0x2d7dd4;const {productCode:_0x27d381,bay:_0x57f976,warehouses:_0x41af7a,room:_0x152239}=_0xa4a2ad['body'];console[_0x1a5e54(0x176)](_0xa4a2ad[_0x1a5e54(0x16a)]);try{const _0x2f1622=await warehouse[_0x1a5e54(0xc5)]([{'$match':{'name':_0x41af7a,'room':_0x152239}},{'$unwind':_0x1a5e54(0x16d)},{'$match':{'product_details.bay':parseInt(_0x57f976)}},{'$group':{'_id':_0x1a5e54(0x143),'name':{'$first':_0x1a5e54(0x14c)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1a5e54(0xb8)},'maxProducts':{'$first':_0x1a5e54(0x17c)}}}]);_0xbf7fa9[_0x1a5e54(0xdc)](0xc8)['json'](_0x2f1622);}catch(_0x21e866){_0xbf7fa9[_0x1a5e54(0xdc)](0x194)[_0x1a5e54(0xca)]({'message':_0x21e866[_0x1a5e54(0xf1)]});}}),module['exports']=router;