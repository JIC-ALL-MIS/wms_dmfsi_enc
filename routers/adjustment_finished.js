var a0_0x21381f=a0_0x14ae;(function(_0x5019cc,_0x3d48fb){var _0x4da210=a0_0x14ae,_0x52a1cf=_0x5019cc();while(!![]){try{var _0x116069=parseInt(_0x4da210(0x126))/0x1*(parseInt(_0x4da210(0xda))/0x2)+-parseInt(_0x4da210(0xd0))/0x3*(-parseInt(_0x4da210(0x96))/0x4)+-parseInt(_0x4da210(0x10d))/0x5+parseInt(_0x4da210(0x11e))/0x6*(parseInt(_0x4da210(0xfc))/0x7)+-parseInt(_0x4da210(0xff))/0x8*(-parseInt(_0x4da210(0x8e))/0x9)+parseInt(_0x4da210(0x129))/0xa+parseInt(_0x4da210(0x104))/0xb*(-parseInt(_0x4da210(0x114))/0xc);if(_0x116069===_0x3d48fb)break;else _0x52a1cf['push'](_0x52a1cf['shift']());}catch(_0x458272){_0x52a1cf['push'](_0x52a1cf['shift']());}}}(a0_0x1a88,0xd9eb6));function a0_0x14ae(_0x228b9c,_0x534b2d){var _0x1a88c8=a0_0x1a88();return a0_0x14ae=function(_0x14aea1,_0x2326bc){_0x14aea1=_0x14aea1-0x70;var _0x4cda71=_0x1a88c8[_0x14aea1];return _0x4cda71;},a0_0x14ae(_0x228b9c,_0x534b2d);}const express=require(a0_0x21381f(0x139)),app=express(),router=express[a0_0x21381f(0x95)](),auth=require(a0_0x21381f(0x9a)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x21381f(0x105)),users=require(a0_0x21381f(0x10f)),nodemailer=require(a0_0x21381f(0x82));router[a0_0x21381f(0xac)](a0_0x21381f(0xf9),auth,async(_0x3e08ca,_0x3bcbe9)=>{var _0x540bc5=a0_0x21381f;try{const {username:_0x54404b,email:_0x21a0a3,role:_0x208da9}=_0x3e08ca['user'],_0x56595b=_0x3e08ca[_0x540bc5(0xd8)],_0x43f196=await profile[_0x540bc5(0x97)]({'email':_0x56595b[_0x540bc5(0x76)]}),_0x4bd66b=await master_shop[_0x540bc5(0x87)]();let _0x148946;if(_0x56595b[_0x540bc5(0x12f)]==_0x540bc5(0x9f)){const _0x2c3a18=await staff[_0x540bc5(0x97)]({'email':_0x56595b[_0x540bc5(0x76)]});_0x148946=await warehouse[_0x540bc5(0x87)]({'status':'Enabled','name':_0x2c3a18[_0x540bc5(0x99)]});}else _0x148946=await warehouse[_0x540bc5(0x87)]({'status':_0x540bc5(0x8a)});const _0x20523a=await product[_0x540bc5(0x87)]();let _0x3559da;if(_0x56595b[_0x540bc5(0x12f)]==_0x540bc5(0x9f)){const _0x4f7a04=await staff[_0x540bc5(0x97)]({'email':_0x56595b[_0x540bc5(0x76)]});_0x3559da=await adjustment_finished[_0x540bc5(0x87)]({'warehouse_name':_0x4f7a04[_0x540bc5(0x99)]});}else _0x3559da=await adjustment_finished[_0x540bc5(0xa2)]([{'$unwind':_0x540bc5(0x8c)},{'$group':{'_id':_0x540bc5(0xc9),'invoice':{'$first':_0x540bc5(0x13e)},'date':{'$first':_0x540bc5(0x83)},'warehouse_name':{'$first':_0x540bc5(0x127)},'room':{'$addToSet':_0x540bc5(0x7f)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x4bd66b[0x0][_0x540bc5(0xa1)]=='English\x20(US)'){var _0xb87104=users[_0x540bc5(0x120)];console['log'](_0xb87104);}else{if(_0x4bd66b[0x0][_0x540bc5(0xa1)]==_0x540bc5(0x79))var _0xb87104=users[_0x540bc5(0x79)];else{if(_0x4bd66b[0x0][_0x540bc5(0xa1)]==_0x540bc5(0x9d))var _0xb87104=users['German'];else{if(_0x4bd66b[0x0][_0x540bc5(0xa1)]==_0x540bc5(0x113))var _0xb87104=users[_0x540bc5(0x113)];else{if(_0x4bd66b[0x0]['language']==_0x540bc5(0x7e))var _0xb87104=users[_0x540bc5(0x7e)];else{if(_0x4bd66b[0x0][_0x540bc5(0xa1)]==_0x540bc5(0xab))var _0xb87104=users[_0x540bc5(0xe8)];else{if(_0x4bd66b[0x0]['language']==_0x540bc5(0xef))var _0xb87104=users[_0x540bc5(0xef)];else{if(_0x4bd66b[0x0]['language']==_0x540bc5(0x122))var _0xb87104=users[_0x540bc5(0x11b)];}}}}}}}_0x3bcbe9[_0x540bc5(0xa9)](_0x540bc5(0xc6),{'success':_0x3e08ca[_0x540bc5(0xd5)](_0x540bc5(0xde)),'errors':_0x3e08ca['flash'](_0x540bc5(0xf5)),'role':_0x56595b,'profile':_0x43f196,'warehouse':_0x148946,'product':_0x20523a,'adjustment':_0x3559da,'master_shop':_0x4bd66b,'language':_0xb87104});}catch(_0x4c0267){console[_0x540bc5(0xe7)](_0x4c0267);}});function a0_0x1a88(){var _0x9c4113=['add','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','errors','date','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/../public','/view','split','findById','28cClGNu','new_adjust_qty','$product_details.unit','511696aeCjyj','$product_details.product_code','sendMail','prod_cat','expiry_date','364991Oglxfz','../models/all_models','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','An\x20error\x20occurred\x20while\x20saving\x20data.','purchases_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.primary_code','$product_details','$product_details.product_stock','7307900AtDSVF','message','../public/language/languages.json','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','product_name','<h5\x20style=\x22text-align:\x20left;\x22>','Spanish','504iAPqwb','<hr\x20class=\x22my-3\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','secondary_unit','toString','/adjustment_finished/preview/','prod_code','Arabic','Secondary_units','<!DOCTYPE\x20html>','560088iTYGCa','\x20Order\x20Date\x20:\x20','English','types','Arabic\x20(ae)','adjustment\x20add\x20successfull','_id','/view/:id','3dkGRfK','$warehouse_name','image','4390870NiqSnx','QA\x20Warehouse','English\x20(US)','length','then','ADJF-','role','$product_details.floorlevel','There\x27s\x20a\x20error\x20in\x20this\x20transaction','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','filter','edit_adjustment_finished_view','$name','string','status','bay','express','production_date','Finished\x20Goods','<html><head><title></title>','JO_number','$invoice','minus','forEach','True','save','$product_details.bin','edit_adjustment_finished','/adjustment/view','email','$product_details.rack','note','Hindi','$product_details.expiry_date','$product_details.maxPerUnit','$product_details.invoice','all','French','$product.room_names','random','$room','nodemailer','$date','Logo.png','body','site_title','find','stockBefore','$product_details.secondary_code','Enabled','$product.product_name','$product','Enclosed','225tbBPzL','back','/upload/','warehouse_name','prod_invoice','$product_details.product_name','New_Qty_Converted','Router','72QgFzFn','findOne','level','warehouse','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/picking_list/PDF_adjustment/','German','\x20</h2>','staff','adjust_qty','language','aggregate','password','room','batch_code','catch','<div>','</tbody>','render','An\x20error\x20occurred.','Portuguese\x20(BR)','get','</span>','</div>','finalize','<strong>\x20Regards\x20</strong>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','product_stock','/preview/:id','logo','product_code','<span\x20style=\x22float:\x20right;\x22>','json','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.storage','<tr>','redirect','exports','</tr>','post','<tbody\x20style=\x22text-align:\x20center;\x22>','Adjustment\x20Mail','invoice','Primary_Units','$product_details.production_date','</body></html>','Ambient','adjustment_finished','</thead>','$product_details.batch_code','$_id','getMonth','adjustment\x20data\x20update\x20successfully','$product_details.secondary_unit','<h2>\x20','error','New_Qty_Converted_adj','111072vGVvAo','product','$product_details.type','\x20Order\x20Number\x20:\x20','master','flash','params','maxPerUnit','user','$product_details._id','446546chBVha','</head><body>','Return\x20Rooms','product_date','success','unit','</td>','map','floor','createTransport','slice','stock','foreach\x20newproduct','log','Portuguese','</h5>','/view/add_adjustment','prod_name','product_details','$product_details.bay','FGSEmail','Chinese','$product_details.maxProducts','Rooms','Email\x20sent\x20successfully'];a0_0x1a88=function(){return _0x9c4113;};return a0_0x1a88();}async function getRandom8DigitNumber(){var _0x38366f=a0_0x21381f;const _0x2a4a4d=0x989680,_0x1bb56b=0x5f5e0ff,_0x236720=Math[_0x38366f(0xe2)](Math[_0x38366f(0x80)]()*(_0x1bb56b-_0x2a4a4d+0x1))+_0x2a4a4d;var _0x1b8d3c;const _0x16da68=await adjustment_finished[_0x38366f(0x97)]({'invoice':'ADJF-'+_0x236720});return _0x16da68&&_0x16da68['length']>0x0?_0x1b8d3c=_0x38366f(0x12e)+_0x236720:_0x1b8d3c=_0x38366f(0x12e)+_0x236720,_0x1b8d3c;}router[a0_0x21381f(0xac)](a0_0x21381f(0xea),auth,async(_0x5e17e4,_0x35d718)=>{var _0x2a0828=a0_0x21381f;try{const {username:_0x3d5901,email:_0x1d0e7c,role:_0x3491ce}=_0x5e17e4[_0x2a0828(0xd8)],_0x43c6a2=_0x5e17e4[_0x2a0828(0xd8)],_0x2da030=await profile['findOne']({'email':_0x43c6a2[_0x2a0828(0x76)]}),_0x5c5970=await master_shop[_0x2a0828(0x87)]();let _0x2c45bd;if(_0x43c6a2[_0x2a0828(0x12f)]==_0x2a0828(0x9f)){const _0x7bed9a=await staff['findOne']({'email':_0x43c6a2[_0x2a0828(0x76)]});_0x2c45bd=await warehouse[_0x2a0828(0xa2)]([{'$match':{'status':_0x2a0828(0x8a),'name':_0x7bed9a['warehouse'],'warehouse_category':_0x2a0828(0x13b),'name':{'$ne':_0x2a0828(0x12a)}}},{'$group':{'_id':_0x2a0828(0x135),'name':{'$first':_0x2a0828(0x135)}}}]);}else _0x2c45bd=await warehouse[_0x2a0828(0xa2)]([{'$match':{'status':_0x2a0828(0x8a),'warehouse_category':_0x2a0828(0x13b),'name':{'$ne':_0x2a0828(0x12a)}}},{'$group':{'_id':_0x2a0828(0x135),'name':{'$first':_0x2a0828(0x135)}}}]);const _0x4fc712=await product['find']({}),_0x48b1a5=await adjustment_finished[_0x2a0828(0x87)]({}),_0x449c85=_0x48b1a5['length']+0x1,_0x1a2ec4='ADJF-'+_0x449c85[_0x2a0828(0x118)]()['padStart'](0x5,'0');var _0x312679=[_0x2a0828(0xc5),_0x2a0828(0x8d),'Return\x20Rooms'];if(_0x5c5970[0x0][_0x2a0828(0xa1)]==_0x2a0828(0x12b))var _0xa4f3d4=users[_0x2a0828(0x120)];else{if(_0x5c5970[0x0][_0x2a0828(0xa1)]==_0x2a0828(0x79))var _0xa4f3d4=users[_0x2a0828(0x79)];else{if(_0x5c5970[0x0]['language']==_0x2a0828(0x9d))var _0xa4f3d4=users[_0x2a0828(0x9d)];else{if(_0x5c5970[0x0][_0x2a0828(0xa1)]==_0x2a0828(0x113))var _0xa4f3d4=users[_0x2a0828(0x113)];else{if(_0x5c5970[0x0][_0x2a0828(0xa1)]=='French')var _0xa4f3d4=users['French'];else{if(_0x5c5970[0x0][_0x2a0828(0xa1)]==_0x2a0828(0xab))var _0xa4f3d4=users[_0x2a0828(0xe8)];else{if(_0x5c5970[0x0][_0x2a0828(0xa1)]=='Chinese')var _0xa4f3d4=users[_0x2a0828(0xef)];else{if(_0x5c5970[0x0][_0x2a0828(0xa1)]==_0x2a0828(0x122))var _0xa4f3d4=users['Arabic'];}}}}}}}const _0x3baf94=getRandom8DigitNumber();_0x3baf94[_0x2a0828(0x12d)](_0x34b1d8=>{var _0x10199a=_0x2a0828;_0x35d718[_0x10199a(0xa9)]('add_adjustment_finished',{'success':_0x5e17e4[_0x10199a(0xd5)]('success'),'errors':_0x5e17e4['flash']('errors'),'role':_0x43c6a2,'profile':_0x2da030,'warehouse':_0x2c45bd,'product':_0x4fc712,'master_shop':_0x5c5970,'language':_0xa4f3d4,'rooms_data':_0x312679,'invoice_no':_0x34b1d8});})[_0x2a0828(0xa6)](_0x18ec7d=>{var _0x450337=_0x2a0828;_0x5e17e4[_0x450337(0xd5)]('errors',_0x450337(0x131)),_0x35d718[_0x450337(0xbb)](_0x450337(0x75));});}catch(_0x1874e3){console['log'](_0x1874e3);}}),router[a0_0x21381f(0xbe)]('/view/add_adjustment',auth,async(_0x268a37,_0x33fe75)=>{var _0xbef962=a0_0x21381f;try{const {warehouse_name:_0x18c9e8,date:_0x1dfb3c,prod_name:_0x2213e7,level:_0x4e95b7,isle:_0x5ecae6,pallet:_0x2f7ba2,stock:_0xa0079f,types:_0x23a0c0,adjust_qty:_0x2c60c1,new_adjust_qty:_0x1aa186,note:_0x25d046,Room_name:_0x59fa84,invoice:_0x37c228,JO_number:_0x21a61f,expiry_date:_0x26b7aa}=_0x268a37[_0xbef962(0x85)];if(typeof _0x2213e7==_0xbef962(0x136))var _0x32453f=[_0x268a37['body'][_0xbef962(0xeb)]],_0xc5ea60=[_0x268a37['body'][_0xbef962(0x98)]],_0x193bfa=[_0x268a37[_0xbef962(0x85)]['stock']],_0x495c0b=[_0x268a37['body']['types']],_0x2f0061=[_0x268a37[_0xbef962(0x85)][_0xbef962(0xcf)]],_0x202721=[_0x268a37[_0xbef962(0x85)][_0xbef962(0x94)]],_0x10d0fe=[_0x268a37[_0xbef962(0x85)][_0xbef962(0xc2)]],_0x323d92=[_0x268a37[_0xbef962(0x85)][_0xbef962(0x11c)]],_0x215fd7=[_0x268a37[_0xbef962(0x85)][_0xbef962(0x11a)]],_0x1583d5=[_0x268a37[_0xbef962(0x85)]['batch_code']],_0x26003b=[_0x268a37[_0xbef962(0x85)][_0xbef962(0x103)]],_0x36cd01=[_0x268a37[_0xbef962(0x85)][_0xbef962(0xdd)]],_0x1958c7=[_0x268a37[_0xbef962(0x85)]['prod_cat']],_0x420998=[_0x268a37[_0xbef962(0x85)][_0xbef962(0xf1)]],_0x4d2252=[_0x268a37['body'][_0xbef962(0xd7)]],_0x4beac9=[_0x268a37[_0xbef962(0x85)][_0xbef962(0x92)]];else var _0x32453f=[..._0x268a37[_0xbef962(0x85)][_0xbef962(0xeb)]],_0xc5ea60=[..._0x268a37[_0xbef962(0x85)]['level']],_0x193bfa=[..._0x268a37[_0xbef962(0x85)]['stock']],_0x495c0b=[..._0x268a37[_0xbef962(0x85)][_0xbef962(0x121)]],_0x2f0061=[..._0x268a37[_0xbef962(0x85)][_0xbef962(0xcf)]],_0x202721=[..._0x268a37[_0xbef962(0x85)]['New_Qty_Converted']],_0x10d0fe=[..._0x268a37['body']['Primary_Units']],_0x323d92=[..._0x268a37[_0xbef962(0x85)][_0xbef962(0x11c)]],_0x215fd7=[..._0x268a37[_0xbef962(0x85)][_0xbef962(0x11a)]],_0x1583d5=[..._0x268a37['body'][_0xbef962(0xa5)]],_0x26003b=[..._0x268a37[_0xbef962(0x85)][_0xbef962(0x103)]],_0x36cd01=[..._0x268a37['body'][_0xbef962(0xdd)]],_0x1958c7=[..._0x268a37['body'][_0xbef962(0x102)]],_0x420998=[..._0x268a37['body'][_0xbef962(0xf1)]],_0x4d2252=[..._0x268a37[_0xbef962(0x85)][_0xbef962(0xd7)]],_0x4beac9=[..._0x268a37[_0xbef962(0x85)][_0xbef962(0x92)]];const _0x3adc6c=_0x32453f[_0xbef962(0xe1)](_0x6f82f4=>{return _0x6f82f4={'product_name':_0x6f82f4};});_0xc5ea60['forEach']((_0x3fd3a4,_0x347a2b)=>{var _0x1c854e=_0xbef962;_0x3adc6c[_0x347a2b][_0x1c854e(0x138)]=_0x3fd3a4;}),_0x193bfa['forEach']((_0x5d98e8,_0x3f942e)=>{var _0x4e286d=_0xbef962;_0x3adc6c[_0x3f942e][_0x4e286d(0x88)]=_0x5d98e8;}),_0x495c0b[_0xbef962(0x70)]((_0x27f9eb,_0x246740)=>{var _0x5e459f=_0xbef962;_0x3adc6c[_0x246740][_0x5e459f(0x121)]=_0x27f9eb;}),_0x2f0061[_0xbef962(0x70)]((_0x4ec443,_0x315a96)=>{_0x3adc6c[_0x315a96]['adjust_qty']=_0x4ec443;}),_0x202721['forEach']((_0x3fa913,_0x1827bf)=>{var _0x437af3=_0xbef962;_0x3adc6c[_0x1827bf][_0x437af3(0xfd)]=_0x3fa913;}),_0x10d0fe[_0xbef962(0x70)]((_0x1f20c0,_0x3aa7c3)=>{_0x3adc6c[_0x3aa7c3]['unit']=_0x1f20c0;}),_0x323d92[_0xbef962(0x70)]((_0x3c313d,_0x4939a5)=>{_0x3adc6c[_0x4939a5]['secondary_unit']=_0x3c313d;}),_0x215fd7[_0xbef962(0x70)]((_0x171dab,_0x14b857)=>{_0x3adc6c[_0x14b857]['product_code']=_0x171dab;}),_0x1583d5['forEach']((_0x1b1ef3,_0x49763b)=>{var _0x402d87=_0xbef962;_0x3adc6c[_0x49763b][_0x402d87(0xa5)]=_0x1b1ef3;}),_0x26003b[_0xbef962(0x70)]((_0x2fce53,_0x1af29e)=>{var _0x417b61=_0xbef962;_0x3adc6c[_0x1af29e][_0x417b61(0x103)]=_0x2fce53;}),_0x36cd01[_0xbef962(0x70)]((_0x4b7ae2,_0x3b3d8f)=>{_0x3adc6c[_0x3b3d8f]['production_date']=_0x4b7ae2;}),_0x1958c7[_0xbef962(0x70)]((_0x27d83c,_0x28bea3)=>{var _0x422aae=_0xbef962;_0x3adc6c[_0x28bea3][_0x422aae(0x102)]=_0x27d83c;}),_0x420998[_0xbef962(0x70)]((_0x1748f5,_0x38a760)=>{_0x3adc6c[_0x38a760]['room_names']=_0x1748f5;}),_0x4d2252['forEach']((_0x27113d,_0xd8556)=>{var _0x547015=_0xbef962;_0x3adc6c[_0xd8556][_0x547015(0xd7)]=_0x27113d;}),_0x4beac9[_0xbef962(0x70)]((_0x229481,_0x28f093)=>{var _0x48c3de=_0xbef962;_0x3adc6c[_0x28f093][_0x48c3de(0xc1)]=_0x229481;});const _0x4523ed=_0x3adc6c[_0xbef962(0x133)](_0x47828e=>_0x47828e['adjust_qty']!=='0'&&_0x47828e[_0xbef962(0xa0)]!=='');var _0x366186=0x0;_0x4523ed['forEach'](_0x20506=>{var _0x5bbfba=_0xbef962;console['log'](_0x5bbfba(0xe6),_0x20506),parseInt(_0x20506[_0x5bbfba(0xa0)])<=0x0&&_0x366186++;});if(_0x366186!=0x0)return _0x268a37['flash'](_0xbef962(0xf5),_0xbef962(0x132)),_0x33fe75[_0xbef962(0xbb)](_0xbef962(0x8f));const _0x1bc342=new adjustment_finished({'warehouse_name':_0x18c9e8,'date':_0x1dfb3c,'product':_0x4523ed,'note':_0x25d046,'room':_0x59fa84,'invoice':_0x37c228,'JO_number':_0x21a61f,'expiry_date':_0x26b7aa}),_0x54cc0=await _0x1bc342[_0xbef962(0x72)]();_0x268a37[_0xbef962(0xd5)](_0xbef962(0xde),_0xbef962(0x123)),_0x33fe75[_0xbef962(0xbb)](_0xbef962(0x119)+_0x54cc0[_0xbef962(0x124)]);}catch(_0x2cc99a){console[_0xbef962(0xe7)](_0x2cc99a),_0x33fe75[_0xbef962(0x137)](0xc8)[_0xbef962(0xb7)]({'message':_0x2cc99a['message']});}}),router[a0_0x21381f(0xac)](a0_0x21381f(0xb3),auth,async(_0x32d4ff,_0x40fd56)=>{var _0x513788=a0_0x21381f;try{const {username:_0x51c0be,email:_0x3ff0a3,role:_0x13b68a}=_0x32d4ff[_0x513788(0xd8)],_0x5d30a3=_0x32d4ff[_0x513788(0xd8)],_0x2cb088=await profile[_0x513788(0x97)]({'email':_0x5d30a3[_0x513788(0x76)]}),_0x2434e=await master_shop[_0x513788(0x87)](),_0x403fc6=_0x32d4ff[_0x513788(0xd6)]['id'],_0x37af0e=await adjustment_finished[_0x513788(0xfb)]({'_id':_0x403fc6}),_0x273dcf=await purchases[_0x513788(0xa2)]([{'$match':{'warehouse_name':_0x37af0e[_0x513788(0x91)]}},{'$unwind':_0x513788(0x8c)},{'$group':{'_id':_0x513788(0x8b)}}]);console[_0x513788(0xe7)](_0x513788(0x108),_0x273dcf);const _0x3ac6d1=await product[_0x513788(0x87)]({}),_0x2b8c13=await warehouse[_0x513788(0xa2)]([{'$match':{'name':_0x37af0e['warehouse_name'],'warehouse_category':_0x513788(0x13b)}},{'$unwind':_0x513788(0x10b)},{'$group':{'_id':_0x513788(0xd9),'name':{'$first':_0x513788(0x93)},'product_stock':{'$first':_0x513788(0x10c)},'bay':{'$first':_0x513788(0xed)},'bin':{'$first':_0x513788(0x73)},'type':{'$first':_0x513788(0xd2)},'floorlevel':{'$first':_0x513788(0x130)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x513788(0x89)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x513788(0xb9)},'rack':{'$first':_0x513788(0x77)},'expiry_date':{'$first':_0x513788(0x7a)},'production_date':{'$first':_0x513788(0xc3)},'batch_code':{'$first':_0x513788(0xc8)},'maxPerUnit':{'$first':_0x513788(0x7b)},'room':{'$first':_0x513788(0x81)}}}]);if(_0x2434e[0x0][_0x513788(0xa1)]=='English\x20(US)'){var _0x1b9c3d=users['English'];console[_0x513788(0xe7)](_0x1b9c3d);}else{if(_0x2434e[0x0][_0x513788(0xa1)]==_0x513788(0x79))var _0x1b9c3d=users[_0x513788(0x79)];else{if(_0x2434e[0x0]['language']==_0x513788(0x9d))var _0x1b9c3d=users[_0x513788(0x9d)];else{if(_0x2434e[0x0][_0x513788(0xa1)]==_0x513788(0x113))var _0x1b9c3d=users[_0x513788(0x113)];else{if(_0x2434e[0x0][_0x513788(0xa1)]==_0x513788(0x7e))var _0x1b9c3d=users[_0x513788(0x7e)];else{if(_0x2434e[0x0]['language']==_0x513788(0xab))var _0x1b9c3d=users['Portuguese'];else{if(_0x2434e[0x0][_0x513788(0xa1)]==_0x513788(0xef))var _0x1b9c3d=users[_0x513788(0xef)];else{if(_0x2434e[0x0][_0x513788(0xa1)]==_0x513788(0x122))var _0x1b9c3d=users[_0x513788(0x11b)];}}}}}}}_0x40fd56['render'](_0x513788(0x134),{'success':_0x32d4ff['flash'](_0x513788(0xde)),'errors':_0x32d4ff[_0x513788(0xd5)](_0x513788(0xf5)),'role':_0x5d30a3,'profile':_0x2cb088,'adjustment':_0x37af0e,'stock':_0x2b8c13,'master_shop':_0x2434e,'warehouse_name':_0x273dcf,'unit':_0x3ac6d1,'language':_0x1b9c3d});}catch(_0x21c648){console['log'](_0x21c648),_0x40fd56['status'](0xc8)[_0x513788(0xb7)]({'message':_0x21c648['message']});}}),router['post']('/preview/:id',auth,async(_0x4ac6fa,_0x1bc125)=>{var _0x1b2507=a0_0x21381f;try{const {invoice:_0x418a13,warehouse_name:_0x43c781,Room_name:_0x182708}=_0x4ac6fa['body'],_0xefe6e6=_0x4ac6fa[_0x1b2507(0xd6)]['id'],_0x6280cb=await adjustment_finished['findById']({'_id':_0xefe6e6});var _0x161d33;const _0x23153c=_0x6280cb[_0x1b2507(0xd1)][_0x1b2507(0xe1)](async _0x5b0a9c=>{var _0x278925=_0x1b2507;if(_0x5b0a9c[_0x278925(0xa0)]>0x0){_0x161d33=await warehouse[_0x278925(0x97)]({'name':_0x43c781,'room':_0x5b0a9c['room_names'],'warehouse_category':_0x278925(0x13b)});const _0x34b7ab=_0x161d33[_0x278925(0xec)][_0x278925(0xe1)](_0x3f2a9d=>{var _0x2bfa88=_0x278925;console['log'](_0x5b0a9c[_0x2bfa88(0x121)]);if(_0x5b0a9c[_0x2bfa88(0x121)]==_0x2bfa88(0x13f))_0x3f2a9d['product_name']==_0x5b0a9c['product_name']&&_0x3f2a9d[_0x2bfa88(0x138)]==_0x5b0a9c[_0x2bfa88(0x138)]&&_0x3f2a9d[_0x2bfa88(0x103)]==_0x5b0a9c[_0x2bfa88(0x103)]&&_0x3f2a9d['production_date']==_0x5b0a9c[_0x2bfa88(0x13a)]&&_0x3f2a9d[_0x2bfa88(0xa5)]==_0x5b0a9c[_0x2bfa88(0xa5)]&&_0x3f2a9d[_0x2bfa88(0xc1)]==_0x5b0a9c[_0x2bfa88(0xc1)]&&(_0x3f2a9d[_0x2bfa88(0xb2)]=_0x3f2a9d[_0x2bfa88(0xb2)]-_0x5b0a9c[_0x2bfa88(0xa0)]);else _0x5b0a9c[_0x2bfa88(0x121)]==_0x2bfa88(0xf3)&&(_0x3f2a9d['product_name']==_0x5b0a9c[_0x2bfa88(0x111)]&&_0x3f2a9d['bay']==_0x5b0a9c[_0x2bfa88(0x138)]&&_0x3f2a9d['expiry_date']==_0x5b0a9c[_0x2bfa88(0x103)]&&_0x3f2a9d[_0x2bfa88(0x13a)]==_0x5b0a9c[_0x2bfa88(0x13a)]&&_0x3f2a9d[_0x2bfa88(0xa5)]==_0x5b0a9c['batch_code']&&_0x3f2a9d[_0x2bfa88(0xc1)]==_0x5b0a9c[_0x2bfa88(0xc1)]&&(_0x3f2a9d[_0x2bfa88(0xb2)]=_0x3f2a9d[_0x2bfa88(0xb2)]+_0x5b0a9c['adjust_qty']));});}return _0x161d33;});Promise['all'](_0x23153c)[_0x1b2507(0x12d)](async _0x3e3d43=>{var _0xb6987=_0x1b2507;try{for(const _0x3ba33f of _0x3e3d43){await _0x3ba33f['save']();}_0x6280cb[_0xb6987(0xaf)]=_0xb6987(0x71);const _0x284002=await _0x6280cb[_0xb6987(0x72)](),_0x157d0a=await master_shop[_0xb6987(0x87)](),_0x50e675=await email_settings[_0xb6987(0x97)](),_0x2134f3=await supervisor_settings[_0xb6987(0x87)]();var _0x1dd157=_0x6280cb[_0xb6987(0xd1)],_0x54012c='',_0x1f16ef;for(_0x1f16ef in _0x1dd157){var _0x8e7e2e='FG';_0x6280cb['warehouse_name']=='DRY\x20GOODS'&&(_0x8e7e2e='DG'),_0x54012c+=_0xb6987(0xba)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1dd157[_0x1f16ef]['product_name']+_0xb6987(0xe0)+_0xb6987(0x106)+_0x1dd157[_0x1f16ef]['product_code']+_0xb6987(0xe0)+_0xb6987(0x106)+_0x1dd157[_0x1f16ef][_0xb6987(0xa0)]+_0xb6987(0xe0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1dd157[_0x1f16ef][_0xb6987(0xdf)]+_0xb6987(0xe0)+_0xb6987(0x106)+_0x1dd157[_0x1f16ef][_0xb6987(0x117)]+_0xb6987(0xe0)+_0xb6987(0x106)+_0x6280cb[_0xb6987(0x91)]+_0xb6987(0xe0)+_0xb6987(0x106)+_0x1dd157[_0x1f16ef]['room_names']+_0xb6987(0xe0)+_0xb6987(0x106)+_0x8e7e2e+_0x1dd157[_0x1f16ef]['bay']+_0xb6987(0xe0)+_0xb6987(0xbd);}let _0xc20e17=nodemailer[_0xb6987(0xe3)]({'host':_0x50e675['host'],'port':Number(_0x50e675['port']),'secure':![],'auth':{'user':_0x50e675[_0xb6987(0x76)],'pass':_0x50e675[_0xb6987(0xa3)]}}),_0x22a76e={'from':_0x50e675[_0xb6987(0x76)],'to':_0x2134f3[0x0][_0xb6987(0xee)],'subject':_0xb6987(0xc0),'attachments':[{'filename':_0xb6987(0x84),'path':__dirname+_0xb6987(0xf8)+_0xb6987(0x90)+_0x157d0a[0x0][_0xb6987(0x128)],'cid':_0xb6987(0xb4)}],'html':_0xb6987(0x11d)+_0xb6987(0x13c)+_0xb6987(0xdb)+_0xb6987(0xa7)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0xb6987(0xa7)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+'<div>'+_0xb6987(0xcd)+_0x157d0a[0x0][_0xb6987(0x86)]+_0xb6987(0x9e)+_0xb6987(0xae)+_0xb6987(0xae)+_0xb6987(0x115)+_0xb6987(0xa7)+_0xb6987(0x112)+_0xb6987(0xd3)+_0x6280cb['invoice']+'\x20'+_0xb6987(0xb6)+_0xb6987(0x11f)+_0x6280cb[_0xb6987(0xf6)]+'\x20'+_0xb6987(0xad)+_0xb6987(0xe9)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xb6987(0xf7)+_0xb6987(0xba)+_0xb6987(0x109)+_0xb6987(0xb8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0xb6987(0x110)+_0xb6987(0xf4)+_0xb6987(0x116)+_0xb6987(0x9b)+_0xb6987(0xb1)+_0xb6987(0xbd)+_0xb6987(0xc7)+_0xb6987(0xbf)+'\x20'+_0x54012c+'\x20'+_0xb6987(0xa8)+'</table>'+_0xb6987(0xa7)+_0xb6987(0xb0)+'<h5>'+_0x157d0a[0x0][_0xb6987(0x86)]+_0xb6987(0xe9)+_0xb6987(0xae)+_0xb6987(0xae)+_0xb6987(0xc4)};_0xc20e17[_0xb6987(0x101)](_0x22a76e,function(_0x758e28,_0x299cf7){var _0x2f68a5=_0xb6987;_0x758e28?(console['log'](_0x758e28),console['log']('Error\x20Occurs')):console[_0x2f68a5(0xe7)](_0x2f68a5(0xf2));}),_0x4ac6fa[_0xb6987(0xd5)]('success','Adjustment\x20Finalize\x20Successfully'),_0x1bc125['redirect'](_0xb6987(0x9c)+_0x284002['_id']);}catch(_0x657824){console[_0xb6987(0xce)](_0x657824),_0x1bc125['status'](0x1f4)[_0xb6987(0xb7)]({'error':_0xb6987(0x107)});}})[_0x1b2507(0xa6)](_0x5adc1f=>{var _0x558a48=_0x1b2507;console['error'](_0x5adc1f),_0x1bc125[_0x558a48(0x137)](0x1f4)[_0x558a48(0xb7)]({'error':_0x558a48(0xaa)});});}catch(_0xfa28e4){_0x1bc125['json']({'message':_0xfa28e4['message']});}}),router['get'](a0_0x21381f(0x125),auth,async(_0x4239c5,_0x3fe4c8)=>{var _0xbcb478=a0_0x21381f;try{const {username:_0x5069c6,email:_0x3678e2,role:_0x24388b}=_0x4239c5['user'],_0x49dd76=_0x4239c5['user'],_0xbbb18d=await profile[_0xbcb478(0x97)]({'email':_0x49dd76[_0xbcb478(0x76)]}),_0x3d9eb5=await master_shop['find']();console['log'](_0xbcb478(0xd4),_0x3d9eb5);const _0x3e9a58=_0x4239c5[_0xbcb478(0xd6)]['id'],_0x41c3cc=await adjustment_finished['findById']({'_id':_0x3e9a58});let _0x3dc346=new Date(_0x41c3cc[_0xbcb478(0x103)]),_0x19fa35=('0'+_0x3dc346['getDate']())[_0xbcb478(0xe4)](-0x2),_0x254872=('0'+(_0x3dc346[_0xbcb478(0xca)]()+0x1))[_0xbcb478(0xe4)](-0x2),_0x10c071=_0x3dc346['getFullYear'](),_0x205879=_0x10c071+'-'+_0x254872+'-'+_0x19fa35;var _0x1cd8be=[_0xbcb478(0xc5),_0xbcb478(0x8d),_0xbcb478(0xdc)];const _0x391d93=await purchases[_0xbcb478(0xa2)]([{'$match':{'warehouse_name':_0x41c3cc[_0xbcb478(0x91)]}},{'$unwind':_0xbcb478(0x8c)},{'$group':{'_id':_0xbcb478(0x8b)}}]);console[_0xbcb478(0xe7)](_0xbcb478(0x108),_0x391d93);const _0x3c6be0=await product[_0xbcb478(0x87)]({}),_0x293a6a=await warehouse[_0xbcb478(0xa2)]([{'$match':{'name':_0x41c3cc[_0xbcb478(0x91)],'room':_0x41c3cc['room']}},{'$unwind':_0xbcb478(0x10b)},{'$group':{'_id':_0xbcb478(0xd9),'name':{'$first':_0xbcb478(0x93)},'product_stock':{'$first':_0xbcb478(0x10c)},'bay':{'$first':_0xbcb478(0xed)},'bin':{'$first':_0xbcb478(0x73)},'type':{'$first':_0xbcb478(0xd2)},'floorlevel':{'$first':_0xbcb478(0x130)},'primary_code':{'$first':_0xbcb478(0x10a)},'secondary_code':{'$first':_0xbcb478(0x89)},'product_code':{'$first':_0xbcb478(0x100)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xbcb478(0x77)}}}]);if(_0x3d9eb5[0x0][_0xbcb478(0xa1)]==_0xbcb478(0x12b)){var _0x2e5cd6=users[_0xbcb478(0x120)];console[_0xbcb478(0xe7)](_0x2e5cd6);}else{if(_0x3d9eb5[0x0][_0xbcb478(0xa1)]==_0xbcb478(0x79))var _0x2e5cd6=users['Hindi'];else{if(_0x3d9eb5[0x0][_0xbcb478(0xa1)]=='German')var _0x2e5cd6=users['German'];else{if(_0x3d9eb5[0x0][_0xbcb478(0xa1)]==_0xbcb478(0x113))var _0x2e5cd6=users[_0xbcb478(0x113)];else{if(_0x3d9eb5[0x0][_0xbcb478(0xa1)]==_0xbcb478(0x7e))var _0x2e5cd6=users[_0xbcb478(0x7e)];else{if(_0x3d9eb5[0x0][_0xbcb478(0xa1)]==_0xbcb478(0xab))var _0x2e5cd6=users['Portuguese'];else{if(_0x3d9eb5[0x0]['language']==_0xbcb478(0xef))var _0x2e5cd6=users[_0xbcb478(0xef)];else{if(_0x3d9eb5[0x0][_0xbcb478(0xa1)]==_0xbcb478(0x122))var _0x2e5cd6=users['Arabic'];}}}}}}}_0x3fe4c8['render'](_0xbcb478(0x74),{'success':_0x4239c5[_0xbcb478(0xd5)](_0xbcb478(0xde)),'errors':_0x4239c5[_0xbcb478(0xd5)]('errors'),'role':_0x49dd76,'profile':_0xbbb18d,'adjustment':_0x41c3cc,'stock':_0x293a6a,'master_shop':_0x3d9eb5,'warehouse_name':_0x391d93,'unit':_0x3c6be0,'language':_0x2e5cd6,'rooms_data':_0x1cd8be,'ed_fullDate':_0x205879});}catch(_0x1f4e48){console[_0xbcb478(0xe7)](_0x1f4e48),_0x3fe4c8['status'](0xc8)[_0xbcb478(0xb7)]({'message':_0x1f4e48[_0xbcb478(0x10e)]});}}),router['post'](a0_0x21381f(0x125),auth,async(_0x27cfc6,_0x177407)=>{var _0x2acbb1=a0_0x21381f;try{const _0x149dd7=_0x27cfc6[_0x2acbb1(0xd6)]['id'],_0x48972b=await adjustment_finished[_0x2acbb1(0xfb)]({'_id':_0x149dd7}),_0x3df8e9=await warehouse[_0x2acbb1(0x97)]({'name':_0x48972b[_0x2acbb1(0x91)],'room':_0x48972b[_0x2acbb1(0xa4)]}),{warehouse_name:_0xad4791,date:_0x300ee4,prod_name:_0x503682,level:_0x3d93a4,isle:_0x429947,pallet:_0x2e8a48,stock:_0x2dd480,types:_0x539422,adjust_qty:_0x47dda9,new_adjust_qty:_0x260114,note:_0x4f8590,Room_name:_0x3c9710,invoice:_0x2217b3,JO_number:_0x34e1cf}=_0x27cfc6[_0x2acbb1(0x85)];if(typeof _0x503682==_0x2acbb1(0x136))var _0x39a32f=[_0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0xeb)]],_0x552e1a=[_0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0x98)]],_0x141939=[_0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0xe5)]],_0x82d782=[_0x27cfc6['body'][_0x2acbb1(0x121)]],_0x300e0e=[_0x27cfc6['body']['adjust_qty']],_0x4188d3=[_0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0xfd)]],_0x2d207a=[_0x27cfc6[_0x2acbb1(0x85)]['prod_code']],_0x23b170=[_0x27cfc6['body'][_0x2acbb1(0xdf)]],_0x11a286=[_0x27cfc6[_0x2acbb1(0x85)]['Secondary_units']],_0x182266=[_0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0xa5)]],_0x1b1116=[_0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0x103)]];else var _0x39a32f=[..._0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0xeb)]],_0x552e1a=[..._0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0x98)]],_0x141939=[..._0x27cfc6['body'][_0x2acbb1(0xe5)]],_0x82d782=[..._0x27cfc6['body'][_0x2acbb1(0x121)]],_0x300e0e=[..._0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0xa0)]],_0x4188d3=[..._0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0xfd)]],_0x2d207a=[..._0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0x11a)]],_0x23b170=[..._0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0xdf)]],_0x11a286=[..._0x27cfc6['body']['Secondary_units']],_0x182266=[..._0x27cfc6[_0x2acbb1(0x85)][_0x2acbb1(0xa5)]],_0x1b1116=[..._0x27cfc6['body'][_0x2acbb1(0x103)]];const _0x1f0980=_0x39a32f['map'](_0x28b5dd=>{return _0x28b5dd={'product_name':_0x28b5dd};});_0x552e1a[_0x2acbb1(0x70)]((_0x3c7401,_0x13354b)=>{var _0x45c114=_0x2acbb1;_0x1f0980[_0x13354b][_0x45c114(0x138)]=_0x3c7401;}),_0x141939[_0x2acbb1(0x70)]((_0x36e7d4,_0x296fc6)=>{var _0x301524=_0x2acbb1;_0x1f0980[_0x296fc6][_0x301524(0x88)]=_0x36e7d4;}),_0x82d782['forEach']((_0x18f3fb,_0x424ec2)=>{var _0x59c117=_0x2acbb1;_0x1f0980[_0x424ec2][_0x59c117(0x121)]=_0x18f3fb;}),_0x300e0e[_0x2acbb1(0x70)]((_0x500483,_0x2d9a27)=>{var _0x4b2822=_0x2acbb1;_0x1f0980[_0x2d9a27][_0x4b2822(0xa0)]=_0x500483;}),_0x4188d3['forEach']((_0x37f0d4,_0x30e091)=>{var _0x39fda3=_0x2acbb1;_0x1f0980[_0x30e091][_0x39fda3(0xfd)]=_0x37f0d4;}),_0x23b170[_0x2acbb1(0x70)]((_0xd44228,_0xfce23f)=>{_0x1f0980[_0xfce23f]['unit']=_0xd44228;}),_0x11a286[_0x2acbb1(0x70)]((_0x16b62d,_0x4e0c32)=>{var _0x307551=_0x2acbb1;_0x1f0980[_0x4e0c32][_0x307551(0x117)]=_0x16b62d;}),_0x2d207a[_0x2acbb1(0x70)]((_0x40d841,_0x3e3f09)=>{var _0x4242d6=_0x2acbb1;_0x1f0980[_0x3e3f09][_0x4242d6(0xb5)]=_0x40d841;}),_0x182266[_0x2acbb1(0x70)]((_0x4d333c,_0xba74bc)=>{var _0x57d7d3=_0x2acbb1;_0x1f0980[_0xba74bc][_0x57d7d3(0xa5)]=_0x4d333c;}),_0x1b1116['forEach']((_0x4a31e5,_0x743a52)=>{var _0x4fc089=_0x2acbb1;_0x1f0980[_0x743a52][_0x4fc089(0x103)]=_0x4a31e5;});const _0x5f5497=_0x1f0980['filter'](_0x58b8b3=>_0x58b8b3[_0x2acbb1(0xa0)]!=='0'&&_0x58b8b3['adjust_qty']!=='');var _0x224a83=0x0;_0x5f5497[_0x2acbb1(0x70)](_0x250d4a=>{var _0x499dbf=_0x2acbb1;console[_0x499dbf(0xe7)](_0x499dbf(0xe6),_0x250d4a),parseInt(_0x250d4a[_0x499dbf(0xa0)])<=0x0&&_0x224a83++;});if(_0x224a83!=0x0)return _0x27cfc6[_0x2acbb1(0xd5)](_0x2acbb1(0xf5),_0x2acbb1(0x132)),_0x177407['redirect'](_0x2acbb1(0x8f));_0x48972b['warehouse_name']=_0xad4791,_0x48972b[_0x2acbb1(0xf6)]=_0x300ee4,_0x48972b[_0x2acbb1(0xd1)]=_0x5f5497,_0x48972b[_0x2acbb1(0x78)]=_0x4f8590,_0x48972b[_0x2acbb1(0xa4)]=_0x3c9710,_0x48972b[_0x2acbb1(0xc1)]=_0x2217b3,_0x48972b[_0x2acbb1(0x13d)]=_0x34e1cf;const _0x145e25=await _0x48972b['save'](),_0x234cfe=await warehouse[_0x2acbb1(0x97)]({'name':_0xad4791,'room':_0x3c9710});_0x145e25[_0x2acbb1(0xd1)][_0x2acbb1(0x70)](_0x578c76=>{var _0x12d189=_0x2acbb1;const _0x2d306f=_0x234cfe[_0x12d189(0xec)][_0x12d189(0xe1)](_0x406cd6=>{var _0xa1d76=_0x12d189;_0x578c76[_0xa1d76(0x121)]==_0xa1d76(0x13f)?_0x406cd6[_0xa1d76(0x111)]==_0x578c76[_0xa1d76(0x111)]&&_0x406cd6[_0xa1d76(0x138)]==_0x578c76[_0xa1d76(0x138)]&&(_0x406cd6[_0xa1d76(0xb2)]=parseInt(_0x406cd6[_0xa1d76(0xb2)])-parseInt(_0x578c76[_0xa1d76(0xa0)])):_0x406cd6[_0xa1d76(0x111)]==_0x578c76[_0xa1d76(0x111)]&&_0x406cd6[_0xa1d76(0x138)]==_0x578c76[_0xa1d76(0x138)]&&(_0x406cd6[_0xa1d76(0xb2)]=parseInt(_0x406cd6[_0xa1d76(0xb2)])+parseInt(_0x578c76[_0xa1d76(0xa0)]));});}),await _0x234cfe['save'](),_0x27cfc6[_0x2acbb1(0xd5)]('success',_0x2acbb1(0xcb)),_0x177407[_0x2acbb1(0xbb)]('/adjustment_finished/view');}catch(_0x37d3d3){console['log'](_0x37d3d3);}}),router[a0_0x21381f(0xbe)]('/barcode_scanner',async(_0xcc2375,_0x3df344)=>{var _0x3c05d0=a0_0x21381f;const {primary_code:_0x5a88df,warehouse_data:_0x2c67ae,rooms_data:_0x1532da,Roomslist:_0x22424d}=_0xcc2375[_0x3c05d0(0x85)],_0x619db3=_0x22424d[_0x3c05d0(0xfa)](','),_0x52a4d1=[];async function _0xe883c(_0x17084a){var _0x16460b=_0x3c05d0;const _0xfce2f6=await warehouse[_0x16460b(0xa2)]([{'$match':{'name':_0x2c67ae,'room':_0x17084a}},{'$unwind':_0x16460b(0x10b)},{'$match':{'product_details.primary_code':_0x5a88df}},{'$group':{'_id':_0x16460b(0xd9),'name':{'$first':_0x16460b(0x93)},'product_stock':{'$first':_0x16460b(0x10c)},'primary_code':{'$first':_0x16460b(0x10a)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x16460b(0x100)},'level':{'$first':_0x16460b(0xed)},'isle':{'$first':_0x16460b(0x73)},'type':{'$first':_0x16460b(0xd2)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x16460b(0xfe)},'secondary_unit':{'$first':_0x16460b(0xcc)},'storage':{'$first':_0x16460b(0xb9)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x16460b(0x7a)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x16460b(0xc8)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x16460b(0x7b)},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x16460b(0x7c)}}}]),_0x325c1a=await warehouse['aggregate']([{'$match':{'name':_0x2c67ae,'room':_0x17084a}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x5a88df}},{'$group':{'_id':_0x16460b(0xd9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x16460b(0x10a)},'secondary_code':{'$first':_0x16460b(0x89)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x16460b(0xed)},'isle':{'$first':_0x16460b(0x73)},'type':{'$first':_0x16460b(0xd2)},'pallet':{'$first':_0x16460b(0x130)},'unit':{'$first':_0x16460b(0xfe)},'secondary_unit':{'$first':_0x16460b(0xcc)},'storage':{'$first':_0x16460b(0xb9)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x16460b(0x7a)},'production_date':{'$first':_0x16460b(0xc3)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x16460b(0x7b)},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x16460b(0x7c)}}}]);if(_0xfce2f6[_0x16460b(0x12c)]>0x0)_0x52a4d1['push'](_0xfce2f6);else _0x325c1a['length']>0x0&&_0x52a4d1['push'](_0x325c1a);}const _0x1aa32d=_0x619db3[_0x3c05d0(0xe1)](_0x10f318=>_0xe883c(_0x10f318));await Promise[_0x3c05d0(0x7d)](_0x1aa32d),_0x3df344[_0x3c05d0(0xb7)](_0x52a4d1);}),router[a0_0x21381f(0xbe)]('/CheckingWarehouse',async(_0x174eb6,_0x4e48b8)=>{var _0x4bc788=a0_0x21381f;const {productCode:_0x13de48,bay:_0x398f11,warehouses:_0x365707,room:_0x34719d}=_0x174eb6[_0x4bc788(0x85)];console['log'](_0x174eb6[_0x4bc788(0x85)]);try{const _0x3042cf=await warehouse['aggregate']([{'$match':{'name':_0x365707,'room':_0x34719d}},{'$unwind':_0x4bc788(0x10b)},{'$match':{'product_details.bay':parseInt(_0x398f11)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4bc788(0x93)},'product_stock':{'$first':_0x4bc788(0x10c)},'bay':{'$first':_0x4bc788(0xed)},'maxProducts':{'$first':_0x4bc788(0xf0)}}}]);_0x4e48b8[_0x4bc788(0x137)](0xc8)['json'](_0x3042cf);}catch(_0x50769a){_0x4e48b8[_0x4bc788(0x137)](0x194)[_0x4bc788(0xb7)]({'message':_0x50769a[_0x4bc788(0x10e)]});}}),module[a0_0x21381f(0xbc)]=router;