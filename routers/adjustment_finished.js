var a0_0x8819a4=a0_0x2047;(function(_0x10fafd,_0x4193ad){var _0x2d07ba=a0_0x2047,_0x5d3cdb=_0x10fafd();while(!![]){try{var _0xa02ee3=-parseInt(_0x2d07ba(0x134))/0x1*(parseInt(_0x2d07ba(0x91))/0x2)+-parseInt(_0x2d07ba(0xde))/0x3*(parseInt(_0x2d07ba(0x108))/0x4)+-parseInt(_0x2d07ba(0xd8))/0x5*(-parseInt(_0x2d07ba(0x12f))/0x6)+parseInt(_0x2d07ba(0x139))/0x7+-parseInt(_0x2d07ba(0xfe))/0x8*(parseInt(_0x2d07ba(0xcd))/0x9)+-parseInt(_0x2d07ba(0x12e))/0xa*(parseInt(_0x2d07ba(0x8c))/0xb)+parseInt(_0x2d07ba(0x92))/0xc;if(_0xa02ee3===_0x4193ad)break;else _0x5d3cdb['push'](_0x5d3cdb['shift']());}catch(_0x28bcc2){_0x5d3cdb['push'](_0x5d3cdb['shift']());}}}(a0_0x34af,0x42470));const express=require(a0_0x8819a4(0xa0)),app=express(),router=express[a0_0x8819a4(0x7a)](),auth=require(a0_0x8819a4(0x85)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require('../models/all_models'),users=require(a0_0x8819a4(0x87)),nodemailer=require(a0_0x8819a4(0x120));router[a0_0x8819a4(0x103)](a0_0x8819a4(0x70),auth,async(_0x7ec4de,_0xe26ce1)=>{var _0x523318=a0_0x8819a4;try{const {username:_0x26a53c,email:_0x3f1e99,role:_0x491ddd}=_0x7ec4de[_0x523318(0x8b)],_0x27b2d8=_0x7ec4de[_0x523318(0x8b)],_0x265721=await profile[_0x523318(0x83)]({'email':_0x27b2d8[_0x523318(0xa7)]}),_0x578f90=await master_shop[_0x523318(0x77)]();let _0x3d1512;if(_0x27b2d8[_0x523318(0x119)]==_0x523318(0xc7)){const _0x2d9087=await staff[_0x523318(0x83)]({'email':_0x27b2d8[_0x523318(0xa7)]});_0x3d1512=await warehouse['find']({'status':_0x523318(0xff),'name':_0x2d9087[_0x523318(0xa2)]});}else _0x3d1512=await warehouse[_0x523318(0x77)]({'status':_0x523318(0xff)});const _0x348da4=await product[_0x523318(0x77)]();let _0x46f22c;if(_0x27b2d8['role']==_0x523318(0xc7)){const _0x46ab3f=await staff[_0x523318(0x83)]({'email':_0x27b2d8[_0x523318(0xa7)]});_0x46f22c=await adjustment_finished[_0x523318(0x77)]({'warehouse_name':_0x46ab3f[_0x523318(0xa2)]});}else _0x46f22c=await adjustment_finished[_0x523318(0x133)]([{'$unwind':_0x523318(0x79)},{'$group':{'_id':_0x523318(0x11c),'invoice':{'$first':_0x523318(0x72)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x523318(0xeb)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x578f90[0x0][_0x523318(0xd0)]==_0x523318(0xfd)){var _0x255734=users[_0x523318(0xa6)];console[_0x523318(0x73)](_0x255734);}else{if(_0x578f90[0x0][_0x523318(0xd0)]=='Hindi')var _0x255734=users['Hindi'];else{if(_0x578f90[0x0][_0x523318(0xd0)]==_0x523318(0x94))var _0x255734=users[_0x523318(0x94)];else{if(_0x578f90[0x0]['language']==_0x523318(0xb8))var _0x255734=users['Spanish'];else{if(_0x578f90[0x0][_0x523318(0xd0)]==_0x523318(0xd6))var _0x255734=users[_0x523318(0xd6)];else{if(_0x578f90[0x0][_0x523318(0xd0)]==_0x523318(0x98))var _0x255734=users['Portuguese'];else{if(_0x578f90[0x0]['language']==_0x523318(0x138))var _0x255734=users['Chinese'];else{if(_0x578f90[0x0][_0x523318(0xd0)]==_0x523318(0xb9))var _0x255734=users[_0x523318(0xfa)];}}}}}}}_0xe26ce1['render']('adjustment_finished',{'success':_0x7ec4de['flash'](_0x523318(0xe1)),'errors':_0x7ec4de[_0x523318(0xf3)](_0x523318(0xc8)),'role':_0x27b2d8,'profile':_0x265721,'warehouse':_0x3d1512,'product':_0x348da4,'adjustment':_0x46f22c,'master_shop':_0x578f90,'language':_0x255734});}catch(_0x408716){console['log'](_0x408716);}});function a0_0x2047(_0x340098,_0x160dcf){var _0x34affe=a0_0x34af();return a0_0x2047=function(_0x20474e,_0x1a6e42){_0x20474e=_0x20474e-0x6e;var _0x4a6285=_0x34affe[_0x20474e];return _0x4a6285;},a0_0x2047(_0x340098,_0x160dcf);}async function getRandom8DigitNumber(){var _0x3b43c0=a0_0x8819a4;const _0x14ba59=0x989680,_0x47a62e=0x5f5e0ff,_0x1df506=Math[_0x3b43c0(0xda)](Math[_0x3b43c0(0x112)]()*(_0x47a62e-_0x14ba59+0x1))+_0x14ba59;var _0x3774ab;const _0x53ed26=await adjustment_finished[_0x3b43c0(0x83)]({'invoice':'ADJF-'+_0x1df506});return _0x53ed26&&_0x53ed26[_0x3b43c0(0xb5)]>0x0?_0x3774ab='ADJF-'+_0x1df506:_0x3774ab='ADJF-'+_0x1df506,_0x3774ab;}router[a0_0x8819a4(0x103)]('/view/add_adjustment',auth,async(_0x1579ec,_0x3aef54)=>{var _0x15de7b=a0_0x8819a4;try{const {username:_0x5c8cb4,email:_0x28c763,role:_0x5a91e7}=_0x1579ec[_0x15de7b(0x8b)],_0x1bf447=_0x1579ec['user'],_0x86ca4f=await profile[_0x15de7b(0x83)]({'email':_0x1bf447['email']}),_0x68e2a3=await master_shop[_0x15de7b(0x77)]();let _0x1d451a;if(_0x1bf447[_0x15de7b(0x119)]==_0x15de7b(0xc7)){const _0x2ee500=await staff[_0x15de7b(0x83)]({'email':_0x1bf447[_0x15de7b(0xa7)]});_0x1d451a=await warehouse[_0x15de7b(0x133)]([{'$match':{'status':_0x15de7b(0xff),'name':_0x2ee500['warehouse'],'warehouse_category':_0x15de7b(0x10b),'name':{'$ne':_0x15de7b(0x7d)}}},{'$group':{'_id':_0x15de7b(0x11d),'name':{'$first':_0x15de7b(0x11d)}}}]);}else _0x1d451a=await warehouse[_0x15de7b(0x133)]([{'$match':{'status':'Enabled','warehouse_category':_0x15de7b(0x10b),'name':{'$ne':_0x15de7b(0x7d)}}},{'$group':{'_id':_0x15de7b(0x11d),'name':{'$first':'$name'}}}]);const _0x38c458=await product[_0x15de7b(0x77)]({}),_0x53170d=await adjustment_finished[_0x15de7b(0x77)]({}),_0x398a75=_0x53170d[_0x15de7b(0xb5)]+0x1,_0x58a16d='ADJF-'+_0x398a75['toString']()[_0x15de7b(0x10f)](0x5,'0');var _0x368322=[_0x15de7b(0xe7),_0x15de7b(0xe3),'Return\x20Rooms'];if(_0x68e2a3[0x0]['language']==_0x15de7b(0xfd))var _0x263e17=users[_0x15de7b(0xa6)];else{if(_0x68e2a3[0x0][_0x15de7b(0xd0)]==_0x15de7b(0x7f))var _0x263e17=users[_0x15de7b(0x7f)];else{if(_0x68e2a3[0x0][_0x15de7b(0xd0)]==_0x15de7b(0x94))var _0x263e17=users[_0x15de7b(0x94)];else{if(_0x68e2a3[0x0][_0x15de7b(0xd0)]==_0x15de7b(0xb8))var _0x263e17=users[_0x15de7b(0xb8)];else{if(_0x68e2a3[0x0][_0x15de7b(0xd0)]==_0x15de7b(0xd6))var _0x263e17=users['French'];else{if(_0x68e2a3[0x0][_0x15de7b(0xd0)]==_0x15de7b(0x98))var _0x263e17=users['Portuguese'];else{if(_0x68e2a3[0x0][_0x15de7b(0xd0)]==_0x15de7b(0x138))var _0x263e17=users['Chinese'];else{if(_0x68e2a3[0x0][_0x15de7b(0xd0)]=='Arabic\x20(ae)')var _0x263e17=users['Arabic'];}}}}}}}const _0x245997=getRandom8DigitNumber();_0x245997['then'](_0x1b2a04=>{var _0x5934c6=_0x15de7b;_0x3aef54[_0x5934c6(0xba)](_0x5934c6(0xae),{'success':_0x1579ec[_0x5934c6(0xf3)](_0x5934c6(0xe1)),'errors':_0x1579ec[_0x5934c6(0xf3)]('errors'),'role':_0x1bf447,'profile':_0x86ca4f,'warehouse':_0x1d451a,'product':_0x38c458,'master_shop':_0x68e2a3,'language':_0x263e17,'rooms_data':_0x368322,'invoice_no':_0x1b2a04});})[_0x15de7b(0xc5)](_0x323d4f=>{var _0x4f8941=_0x15de7b;_0x1579ec[_0x4f8941(0xf3)](_0x4f8941(0xc8),_0x4f8941(0xcc)),_0x3aef54[_0x4f8941(0x12c)](_0x4f8941(0x9e));});}catch(_0x1e5ee0){console[_0x15de7b(0x73)](_0x1e5ee0);}}),router[a0_0x8819a4(0xa1)](a0_0x8819a4(0xd5),auth,async(_0x2b26ca,_0x3b6c63)=>{var _0x2857d9=a0_0x8819a4;try{const {warehouse_name:_0x147a6d,date:_0x104045,prod_name:_0x10daf9,level:_0xa38b2,isle:_0x1b4d36,pallet:_0x258e75,stock:_0x4fbe37,types:_0x779658,adjust_qty:_0x5b04b7,new_adjust_qty:_0x34fa24,note:_0x16c264,Room_name:_0x21303a,invoice:_0x5aa571,JO_number:_0x3235fb,expiry_date:_0x1b2689}=_0x2b26ca[_0x2857d9(0x100)];if(typeof _0x10daf9==_0x2857d9(0x10a))var _0x20b2e3=[_0x2b26ca[_0x2857d9(0x100)]['prod_name']],_0x53731f=[_0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0xb3)]],_0x2ac156=[_0x2b26ca['body'][_0x2857d9(0x6f)]],_0x278203=[_0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0xca)]],_0x57c3d5=[_0x2b26ca['body'][_0x2857d9(0x88)]],_0x5ca76f=[_0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0x130)]],_0x1a9368=[_0x2b26ca[_0x2857d9(0x100)]['Primary_Units']],_0x2202fe=[_0x2b26ca[_0x2857d9(0x100)]['Secondary_units']],_0x410e75=[_0x2b26ca[_0x2857d9(0x100)]['prod_code']],_0x18c7de=[_0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0x113)]],_0x190584=[_0x2b26ca[_0x2857d9(0x100)]['expiry_date']],_0x34509f=[_0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0x90)]],_0x2ff3cb=[_0x2b26ca['body'][_0x2857d9(0xd9)]],_0x548ec3=[_0x2b26ca[_0x2857d9(0x100)]['Rooms']],_0x2f5808=[_0x2b26ca[_0x2857d9(0x100)]['maxPerUnit']],_0x2a2596=[_0x2b26ca[_0x2857d9(0x100)]['prod_invoice']];else var _0x20b2e3=[..._0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0xef)]],_0x53731f=[..._0x2b26ca['body']['level']],_0x2ac156=[..._0x2b26ca['body'][_0x2857d9(0x6f)]],_0x278203=[..._0x2b26ca['body']['types']],_0x57c3d5=[..._0x2b26ca['body'][_0x2857d9(0x88)]],_0x5ca76f=[..._0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0x130)]],_0x1a9368=[..._0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0x126)]],_0x2202fe=[..._0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0xdf)]],_0x410e75=[..._0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0xe2)]],_0x18c7de=[..._0x2b26ca[_0x2857d9(0x100)]['batch_code']],_0x190584=[..._0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0x117)]],_0x34509f=[..._0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0x90)]],_0x2ff3cb=[..._0x2b26ca[_0x2857d9(0x100)]['prod_cat']],_0x548ec3=[..._0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0x8e)]],_0x2f5808=[..._0x2b26ca[_0x2857d9(0x100)]['maxPerUnit']],_0x2a2596=[..._0x2b26ca[_0x2857d9(0x100)][_0x2857d9(0x13a)]];const _0x1bb1b5=_0x20b2e3[_0x2857d9(0x8d)](_0x577ac1=>{return _0x577ac1={'product_name':_0x577ac1};});_0x53731f['forEach']((_0x1fc13c,_0x349920)=>{var _0x242e3d=_0x2857d9;_0x1bb1b5[_0x349920][_0x242e3d(0x118)]=_0x1fc13c;}),_0x2ac156[_0x2857d9(0x95)]((_0xc22fe3,_0x1d3239)=>{var _0x57d3f5=_0x2857d9;_0x1bb1b5[_0x1d3239][_0x57d3f5(0x71)]=_0xc22fe3;}),_0x278203['forEach']((_0x49e889,_0x640e0a)=>{var _0x3a279e=_0x2857d9;_0x1bb1b5[_0x640e0a][_0x3a279e(0xca)]=_0x49e889;}),_0x57c3d5[_0x2857d9(0x95)]((_0x3a71aa,_0x2d440f)=>{var _0x566741=_0x2857d9;_0x1bb1b5[_0x2d440f][_0x566741(0xd1)]=_0x3a71aa;}),_0x5ca76f['forEach']((_0x58e837,_0x4aac46)=>{var _0x25f37f=_0x2857d9;_0x1bb1b5[_0x4aac46][_0x25f37f(0xf1)]=_0x58e837;}),_0x1a9368[_0x2857d9(0x95)]((_0x549f86,_0x3b7d3c)=>{var _0x507818=_0x2857d9;_0x1bb1b5[_0x3b7d3c][_0x507818(0x74)]=_0x549f86;}),_0x2202fe['forEach']((_0x589090,_0x135547)=>{var _0x542c98=_0x2857d9;_0x1bb1b5[_0x135547][_0x542c98(0xa3)]=_0x589090;}),_0x410e75[_0x2857d9(0x95)]((_0x42dedc,_0x37d887)=>{_0x1bb1b5[_0x37d887]['product_code']=_0x42dedc;}),_0x18c7de['forEach']((_0x547d19,_0x119355)=>{var _0x2ce699=_0x2857d9;_0x1bb1b5[_0x119355][_0x2ce699(0x113)]=_0x547d19;}),_0x190584['forEach']((_0x2a2d5a,_0x446f81)=>{var _0x3142e9=_0x2857d9;_0x1bb1b5[_0x446f81][_0x3142e9(0x117)]=_0x2a2d5a;}),_0x34509f[_0x2857d9(0x95)]((_0xab87ba,_0x14f4f2)=>{var _0x8b55bc=_0x2857d9;_0x1bb1b5[_0x14f4f2][_0x8b55bc(0xd4)]=_0xab87ba;}),_0x2ff3cb[_0x2857d9(0x95)]((_0x44d4ed,_0x2e6919)=>{var _0x19748c=_0x2857d9;_0x1bb1b5[_0x2e6919][_0x19748c(0xd9)]=_0x44d4ed;}),_0x548ec3[_0x2857d9(0x95)]((_0x474991,_0x14692c)=>{var _0x25de1e=_0x2857d9;_0x1bb1b5[_0x14692c][_0x25de1e(0xe9)]=_0x474991;}),_0x2f5808[_0x2857d9(0x95)]((_0xc7de2f,_0x1ebf19)=>{var _0x213f73=_0x2857d9;_0x1bb1b5[_0x1ebf19][_0x213f73(0xab)]=_0xc7de2f;}),_0x2a2596[_0x2857d9(0x95)]((_0x59d423,_0x537a3d)=>{var _0x3690a1=_0x2857d9;_0x1bb1b5[_0x537a3d][_0x3690a1(0xee)]=_0x59d423;});const _0x142073=_0x1bb1b5[_0x2857d9(0xc4)](_0x5d9705=>_0x5d9705[_0x2857d9(0xd1)]!=='0'&&_0x5d9705['adjust_qty']!=='');var _0x3d8d13=0x0;_0x142073[_0x2857d9(0x95)](_0x4d3d3=>{var _0x1f8bb2=_0x2857d9;console[_0x1f8bb2(0x73)](_0x1f8bb2(0x114),_0x4d3d3),parseInt(_0x4d3d3['adjust_qty'])<=0x0&&_0x3d8d13++;});if(_0x3d8d13!=0x0)return _0x2b26ca[_0x2857d9(0xf3)](_0x2857d9(0xc8),_0x2857d9(0xb2)),_0x3b6c63[_0x2857d9(0x12c)](_0x2857d9(0xa5));const _0x5e0b90=new adjustment_finished({'warehouse_name':_0x147a6d,'date':_0x104045,'product':_0x142073,'note':_0x16c264,'room':_0x21303a,'invoice':_0x5aa571,'JO_number':_0x3235fb,'expiry_date':_0x1b2689}),_0x3487df=await _0x5e0b90[_0x2857d9(0x12b)]();_0x2b26ca[_0x2857d9(0xf3)](_0x2857d9(0xe1),_0x2857d9(0xac)),_0x3b6c63[_0x2857d9(0x12c)](_0x2857d9(0xcf)+_0x3487df[_0x2857d9(0x104)]);}catch(_0x22c626){console['log'](_0x22c626),_0x3b6c63[_0x2857d9(0x7e)](0xc8)[_0x2857d9(0xaa)]({'message':_0x22c626['message']});}}),router[a0_0x8819a4(0x103)](a0_0x8819a4(0x78),auth,async(_0x55d344,_0x4199bd)=>{var _0x5c4f54=a0_0x8819a4;try{const {username:_0x3796e5,email:_0x2149cc,role:_0x2aef15}=_0x55d344[_0x5c4f54(0x8b)],_0xfaf61=_0x55d344[_0x5c4f54(0x8b)],_0x405944=await profile[_0x5c4f54(0x83)]({'email':_0xfaf61[_0x5c4f54(0xa7)]}),_0x4a6b95=await master_shop[_0x5c4f54(0x77)](),_0x2d14b4=_0x55d344[_0x5c4f54(0x97)]['id'],_0x4d6807=await adjustment_finished[_0x5c4f54(0xf4)]({'_id':_0x2d14b4}),_0x14a8b2=await purchases[_0x5c4f54(0x133)]([{'$match':{'warehouse_name':_0x4d6807[_0x5c4f54(0x105)]}},{'$unwind':_0x5c4f54(0x79)},{'$group':{'_id':'$product.product_name'}}]);console['log'](_0x5c4f54(0x128),_0x14a8b2);const _0x2ca39b=await product[_0x5c4f54(0x77)]({}),_0x522f5=await warehouse['aggregate']([{'$match':{'name':_0x4d6807[_0x5c4f54(0x105)],'warehouse_category':_0x5c4f54(0x10b)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5c4f54(0x122),'name':{'$first':_0x5c4f54(0x121)},'product_stock':{'$first':_0x5c4f54(0x125)},'bay':{'$first':_0x5c4f54(0xad)},'bin':{'$first':_0x5c4f54(0xed)},'type':{'$first':_0x5c4f54(0x99)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x5c4f54(0xdc)},'secondary_code':{'$first':_0x5c4f54(0xbc)},'product_code':{'$first':_0x5c4f54(0xbe)},'storage':{'$first':_0x5c4f54(0xaf)},'rack':{'$first':_0x5c4f54(0xdd)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5c4f54(0x75)},'batch_code':{'$first':_0x5c4f54(0x9d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':_0x5c4f54(0xc3)}}}]);if(_0x4a6b95[0x0]['language']==_0x5c4f54(0xfd)){var _0xaf8d87=users[_0x5c4f54(0xa6)];console[_0x5c4f54(0x73)](_0xaf8d87);}else{if(_0x4a6b95[0x0][_0x5c4f54(0xd0)]==_0x5c4f54(0x7f))var _0xaf8d87=users[_0x5c4f54(0x7f)];else{if(_0x4a6b95[0x0][_0x5c4f54(0xd0)]=='German')var _0xaf8d87=users['German'];else{if(_0x4a6b95[0x0]['language']==_0x5c4f54(0xb8))var _0xaf8d87=users['Spanish'];else{if(_0x4a6b95[0x0][_0x5c4f54(0xd0)]==_0x5c4f54(0xd6))var _0xaf8d87=users[_0x5c4f54(0xd6)];else{if(_0x4a6b95[0x0]['language']==_0x5c4f54(0x98))var _0xaf8d87=users[_0x5c4f54(0xc2)];else{if(_0x4a6b95[0x0][_0x5c4f54(0xd0)]==_0x5c4f54(0x138))var _0xaf8d87=users[_0x5c4f54(0x138)];else{if(_0x4a6b95[0x0][_0x5c4f54(0xd0)]==_0x5c4f54(0xb9))var _0xaf8d87=users['Arabic'];}}}}}}}_0x4199bd[_0x5c4f54(0xba)]('edit_adjustment_finished_view',{'success':_0x55d344['flash'](_0x5c4f54(0xe1)),'errors':_0x55d344['flash'](_0x5c4f54(0xc8)),'role':_0xfaf61,'profile':_0x405944,'adjustment':_0x4d6807,'stock':_0x522f5,'master_shop':_0x4a6b95,'warehouse_name':_0x14a8b2,'unit':_0x2ca39b,'language':_0xaf8d87});}catch(_0x1a3d64){console['log'](_0x1a3d64),_0x4199bd[_0x5c4f54(0x7e)](0xc8)[_0x5c4f54(0xaa)]({'message':_0x1a3d64[_0x5c4f54(0xf7)]});}}),router[a0_0x8819a4(0xa1)](a0_0x8819a4(0x78),auth,async(_0x5441c2,_0x255c0e)=>{var _0x2a1a37=a0_0x8819a4;try{const {invoice:_0x14f6ba,warehouse_name:_0x3ccfbf,Room_name:_0xad79ca}=_0x5441c2['body'],_0x39049f=_0x5441c2[_0x2a1a37(0x97)]['id'],_0x207e42=await adjustment_finished[_0x2a1a37(0xf4)]({'_id':_0x39049f});var _0x584245;const _0x598fae=_0x207e42[_0x2a1a37(0xd7)][_0x2a1a37(0x8d)](async _0x392dc5=>{var _0x48e55f=_0x2a1a37;if(_0x392dc5[_0x48e55f(0xd1)]>0x0){_0x584245=await warehouse[_0x48e55f(0x83)]({'name':_0x3ccfbf,'room':_0x392dc5['room_names'],'warehouse_category':_0x48e55f(0x10b)});const _0x5e6e8e=_0x584245[_0x48e55f(0xea)]['map'](_0x4604fb=>{var _0x51c51a=_0x48e55f;console[_0x51c51a(0x73)](_0x392dc5['types']);if(_0x392dc5['types']==_0x51c51a(0x124))_0x4604fb[_0x51c51a(0xfb)]==_0x392dc5[_0x51c51a(0xfb)]&&_0x4604fb[_0x51c51a(0x118)]==_0x392dc5[_0x51c51a(0x118)]&&_0x4604fb[_0x51c51a(0x117)]==_0x392dc5[_0x51c51a(0x117)]&&_0x4604fb[_0x51c51a(0xd4)]==_0x392dc5[_0x51c51a(0xd4)]&&_0x4604fb[_0x51c51a(0x113)]==_0x392dc5[_0x51c51a(0x113)]&&_0x4604fb[_0x51c51a(0xee)]==_0x392dc5['invoice']&&(_0x4604fb[_0x51c51a(0x89)]=_0x4604fb[_0x51c51a(0x89)]-_0x392dc5[_0x51c51a(0xd1)]);else _0x392dc5[_0x51c51a(0xca)]==_0x51c51a(0xa8)&&(_0x4604fb[_0x51c51a(0xfb)]==_0x392dc5['product_name']&&_0x4604fb[_0x51c51a(0x118)]==_0x392dc5['bay']&&_0x4604fb[_0x51c51a(0x117)]==_0x392dc5[_0x51c51a(0x117)]&&_0x4604fb[_0x51c51a(0xd4)]==_0x392dc5[_0x51c51a(0xd4)]&&_0x4604fb[_0x51c51a(0x113)]==_0x392dc5[_0x51c51a(0x113)]&&_0x4604fb['invoice']==_0x392dc5[_0x51c51a(0xee)]&&(_0x4604fb['product_stock']=_0x4604fb[_0x51c51a(0x89)]+_0x392dc5['adjust_qty']));});}return _0x584245;});Promise[_0x2a1a37(0xb7)](_0x598fae)[_0x2a1a37(0xd3)](async _0x46b1f7=>{var _0x428fcb=_0x2a1a37;try{for(const _0x2a166f of _0x46b1f7){await _0x2a166f['save']();}_0x207e42[_0x428fcb(0x101)]=_0x428fcb(0xe4);const _0x3b733d=await _0x207e42[_0x428fcb(0x12b)](),_0x5eeba3=await master_shop[_0x428fcb(0x77)](),_0x3070aa=await email_settings[_0x428fcb(0x83)](),_0x1688db=await supervisor_settings[_0x428fcb(0x77)]();var _0x127a58=_0x207e42['product'],_0x212b18='',_0x3e47c4;for(_0x3e47c4 in _0x127a58){var _0x3d3c6c='FG';_0x207e42[_0x428fcb(0x105)]=='DRY\x20GOODS'&&(_0x3d3c6c='DG'),_0x212b18+=_0x428fcb(0xe0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x127a58[_0x3e47c4][_0x428fcb(0xfb)]+_0x428fcb(0xb0)+_0x428fcb(0x11e)+_0x127a58[_0x3e47c4][_0x428fcb(0xfc)]+_0x428fcb(0xb0)+_0x428fcb(0x11e)+_0x127a58[_0x3e47c4][_0x428fcb(0xd1)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x127a58[_0x3e47c4][_0x428fcb(0x74)]+_0x428fcb(0xb0)+_0x428fcb(0x11e)+_0x127a58[_0x3e47c4]['secondary_unit']+_0x428fcb(0xb0)+_0x428fcb(0x11e)+_0x207e42[_0x428fcb(0x105)]+_0x428fcb(0xb0)+_0x428fcb(0x11e)+_0x127a58[_0x3e47c4][_0x428fcb(0xe9)]+'</td>'+_0x428fcb(0x11e)+_0x3d3c6c+_0x127a58[_0x3e47c4][_0x428fcb(0x118)]+_0x428fcb(0xb0)+_0x428fcb(0x10d);}let _0x170e2e=nodemailer[_0x428fcb(0x93)]({'host':_0x3070aa[_0x428fcb(0x115)],'port':Number(_0x3070aa[_0x428fcb(0x8f)]),'secure':![],'auth':{'user':_0x3070aa['email'],'pass':_0x3070aa['password']}}),_0x5839e4={'from':_0x3070aa['email'],'to':_0x1688db[0x0]['FGSEmail'],'subject':_0x428fcb(0xc0),'attachments':[{'filename':_0x428fcb(0xa9),'path':__dirname+_0x428fcb(0xf8)+_0x428fcb(0xf0)+_0x5eeba3[0x0][_0x428fcb(0xa4)],'cid':_0x428fcb(0x10e)}],'html':'<!DOCTYPE\x20html>'+_0x428fcb(0xe5)+'</head><body>'+'<div>'+_0x428fcb(0x136)+'<div>'+_0x428fcb(0xcb)+_0x428fcb(0x9b)+_0x428fcb(0x6e)+_0x428fcb(0xd2)+_0x5eeba3[0x0][_0x428fcb(0x10c)]+_0x428fcb(0x106)+_0x428fcb(0x9b)+_0x428fcb(0x9b)+_0x428fcb(0x137)+_0x428fcb(0x6e)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x207e42[_0x428fcb(0xee)]+'\x20'+_0x428fcb(0x9c)+_0x428fcb(0x111)+_0x207e42[_0x428fcb(0x84)]+'\x20'+_0x428fcb(0x132)+_0x428fcb(0x127)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x428fcb(0x86)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x428fcb(0xf6)+_0x428fcb(0xf9)+_0x428fcb(0x96)+_0x428fcb(0x81)+_0x428fcb(0x11b)+_0x428fcb(0xbd)+_0x428fcb(0xce)+'</tr>'+_0x428fcb(0xc9)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x212b18+'\x20'+_0x428fcb(0xbf)+_0x428fcb(0xf2)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x428fcb(0x131)+_0x5eeba3[0x0][_0x428fcb(0x10c)]+_0x428fcb(0x127)+'</div>'+_0x428fcb(0x9b)+_0x428fcb(0x76)};_0x170e2e['sendMail'](_0x5839e4,function(_0x217c42,_0x32928e){var _0x1252ae=_0x428fcb;_0x217c42?(console['log'](_0x217c42),console[_0x1252ae(0x73)](_0x1252ae(0x11a))):console['log'](_0x1252ae(0x11f));}),_0x5441c2[_0x428fcb(0xf3)](_0x428fcb(0xe1),_0x428fcb(0x135)),_0x255c0e[_0x428fcb(0x12c)](_0x428fcb(0xe6)+_0x3b733d[_0x428fcb(0x104)]);}catch(_0x28759c){console['error'](_0x28759c),_0x255c0e[_0x428fcb(0x7e)](0x1f4)['json']({'error':_0x428fcb(0x110)});}})[_0x2a1a37(0xc5)](_0x407050=>{var _0x3feb59=_0x2a1a37;console['error'](_0x407050),_0x255c0e[_0x3feb59(0x7e)](0x1f4)[_0x3feb59(0xaa)]({'error':_0x3feb59(0x116)});});}catch(_0x4379e1){_0x255c0e[_0x2a1a37(0xaa)]({'message':_0x4379e1[_0x2a1a37(0xf7)]});}}),router[a0_0x8819a4(0x103)](a0_0x8819a4(0x102),auth,async(_0x1c6939,_0x5cb4fa)=>{var _0x3bfc40=a0_0x8819a4;try{const {username:_0x41b972,email:_0x468786,role:_0x2d6234}=_0x1c6939[_0x3bfc40(0x8b)],_0x3f7854=_0x1c6939[_0x3bfc40(0x8b)],_0x54f4d6=await profile[_0x3bfc40(0x83)]({'email':_0x3f7854[_0x3bfc40(0xa7)]}),_0x2ef444=await master_shop[_0x3bfc40(0x77)]();console[_0x3bfc40(0x73)](_0x3bfc40(0x8a),_0x2ef444);const _0x4977b4=_0x1c6939['params']['id'],_0x3a18dc=await adjustment_finished[_0x3bfc40(0xf4)]({'_id':_0x4977b4});let _0xbe8ec7=new Date(_0x3a18dc['expiry_date']),_0x4311e8=('0'+_0xbe8ec7[_0x3bfc40(0x12a)]())['slice'](-0x2),_0x284c25=('0'+(_0xbe8ec7[_0x3bfc40(0xbb)]()+0x1))[_0x3bfc40(0x129)](-0x2),_0x14d0c5=_0xbe8ec7[_0x3bfc40(0x109)](),_0x55f995=_0x14d0c5+'-'+_0x284c25+'-'+_0x4311e8;var _0x286f58=[_0x3bfc40(0xe7),_0x3bfc40(0xe3),'Return\x20Rooms'];const _0x1bc086=await purchases[_0x3bfc40(0x133)]([{'$match':{'warehouse_name':_0x3a18dc[_0x3bfc40(0x105)]}},{'$unwind':_0x3bfc40(0x79)},{'$group':{'_id':_0x3bfc40(0xb4)}}]);console[_0x3bfc40(0x73)]('purchases_data',_0x1bc086);const _0x5c7e5f=await product[_0x3bfc40(0x77)]({}),_0x4045af=await warehouse[_0x3bfc40(0x133)]([{'$match':{'name':_0x3a18dc[_0x3bfc40(0x105)],'room':_0x3a18dc[_0x3bfc40(0x7c)]}},{'$unwind':_0x3bfc40(0x82)},{'$group':{'_id':_0x3bfc40(0x122),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3bfc40(0x125)},'bay':{'$first':_0x3bfc40(0xad)},'bin':{'$first':_0x3bfc40(0xed)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3bfc40(0x123)},'primary_code':{'$first':_0x3bfc40(0xdc)},'secondary_code':{'$first':_0x3bfc40(0xbc)},'product_code':{'$first':_0x3bfc40(0xbe)},'storage':{'$first':_0x3bfc40(0xaf)},'rack':{'$first':'$product_details.rack'}}}]);if(_0x2ef444[0x0][_0x3bfc40(0xd0)]==_0x3bfc40(0xfd)){var _0x4a911a=users['English'];console[_0x3bfc40(0x73)](_0x4a911a);}else{if(_0x2ef444[0x0][_0x3bfc40(0xd0)]=='Hindi')var _0x4a911a=users[_0x3bfc40(0x7f)];else{if(_0x2ef444[0x0][_0x3bfc40(0xd0)]=='German')var _0x4a911a=users[_0x3bfc40(0x94)];else{if(_0x2ef444[0x0][_0x3bfc40(0xd0)]==_0x3bfc40(0xb8))var _0x4a911a=users['Spanish'];else{if(_0x2ef444[0x0]['language']=='French')var _0x4a911a=users[_0x3bfc40(0xd6)];else{if(_0x2ef444[0x0][_0x3bfc40(0xd0)]==_0x3bfc40(0x98))var _0x4a911a=users[_0x3bfc40(0xc2)];else{if(_0x2ef444[0x0][_0x3bfc40(0xd0)]=='Chinese')var _0x4a911a=users[_0x3bfc40(0x138)];else{if(_0x2ef444[0x0][_0x3bfc40(0xd0)]==_0x3bfc40(0xb9))var _0x4a911a=users[_0x3bfc40(0xfa)];}}}}}}}_0x5cb4fa[_0x3bfc40(0xba)](_0x3bfc40(0xb1),{'success':_0x1c6939[_0x3bfc40(0xf3)](_0x3bfc40(0xe1)),'errors':_0x1c6939[_0x3bfc40(0xf3)]('errors'),'role':_0x3f7854,'profile':_0x54f4d6,'adjustment':_0x3a18dc,'stock':_0x4045af,'master_shop':_0x2ef444,'warehouse_name':_0x1bc086,'unit':_0x5c7e5f,'language':_0x4a911a,'rooms_data':_0x286f58,'ed_fullDate':_0x55f995});}catch(_0x35e7c3){console[_0x3bfc40(0x73)](_0x35e7c3),_0x5cb4fa[_0x3bfc40(0x7e)](0xc8)[_0x3bfc40(0xaa)]({'message':_0x35e7c3['message']});}}),router[a0_0x8819a4(0xa1)](a0_0x8819a4(0x102),auth,async(_0x19edbd,_0x1fe72b)=>{var _0xac431=a0_0x8819a4;try{const _0x342826=_0x19edbd[_0xac431(0x97)]['id'],_0x4406ba=await adjustment_finished[_0xac431(0xf4)]({'_id':_0x342826}),_0x7bb707=await warehouse[_0xac431(0x83)]({'name':_0x4406ba[_0xac431(0x105)],'room':_0x4406ba['room']}),{warehouse_name:_0x2d07ea,date:_0xa6954c,prod_name:_0x1ab390,level:_0x4e995c,isle:_0x4adaab,pallet:_0x48e355,stock:_0x476b6e,types:_0x4055d1,adjust_qty:_0x558ccc,new_adjust_qty:_0x57c902,note:_0x314ce0,Room_name:_0x819ec7,invoice:_0x30b97e,JO_number:_0x2ecc64}=_0x19edbd[_0xac431(0x100)];if(typeof _0x1ab390==_0xac431(0x10a))var _0x550bfd=[_0x19edbd[_0xac431(0x100)][_0xac431(0xef)]],_0x43f0cd=[_0x19edbd[_0xac431(0x100)][_0xac431(0xb3)]],_0x2c46e0=[_0x19edbd[_0xac431(0x100)]['stock']],_0x42e9ef=[_0x19edbd[_0xac431(0x100)]['types']],_0x309493=[_0x19edbd[_0xac431(0x100)][_0xac431(0xd1)]],_0xd98ca5=[_0x19edbd[_0xac431(0x100)][_0xac431(0xf1)]],_0x429289=[_0x19edbd[_0xac431(0x100)][_0xac431(0xe2)]],_0x4d984e=[_0x19edbd[_0xac431(0x100)][_0xac431(0x74)]],_0x27cdc3=[_0x19edbd[_0xac431(0x100)][_0xac431(0xdf)]],_0x34ec54=[_0x19edbd['body'][_0xac431(0x113)]],_0x1def79=[_0x19edbd[_0xac431(0x100)][_0xac431(0x117)]];else var _0x550bfd=[..._0x19edbd['body']['prod_name']],_0x43f0cd=[..._0x19edbd[_0xac431(0x100)][_0xac431(0xb3)]],_0x2c46e0=[..._0x19edbd[_0xac431(0x100)]['stock']],_0x42e9ef=[..._0x19edbd[_0xac431(0x100)][_0xac431(0xca)]],_0x309493=[..._0x19edbd[_0xac431(0x100)][_0xac431(0xd1)]],_0xd98ca5=[..._0x19edbd[_0xac431(0x100)][_0xac431(0xf1)]],_0x429289=[..._0x19edbd[_0xac431(0x100)][_0xac431(0xe2)]],_0x4d984e=[..._0x19edbd[_0xac431(0x100)][_0xac431(0x74)]],_0x27cdc3=[..._0x19edbd[_0xac431(0x100)][_0xac431(0xdf)]],_0x34ec54=[..._0x19edbd[_0xac431(0x100)][_0xac431(0x113)]],_0x1def79=[..._0x19edbd[_0xac431(0x100)]['expiry_date']];const _0x14584e=_0x550bfd[_0xac431(0x8d)](_0x349682=>{return _0x349682={'product_name':_0x349682};});_0x43f0cd['forEach']((_0x1d8fd1,_0x10d645)=>{var _0x646a29=_0xac431;_0x14584e[_0x10d645][_0x646a29(0x118)]=_0x1d8fd1;}),_0x2c46e0[_0xac431(0x95)]((_0x22af90,_0x332673)=>{var _0x57c999=_0xac431;_0x14584e[_0x332673][_0x57c999(0x71)]=_0x22af90;}),_0x42e9ef['forEach']((_0xb6edce,_0x404327)=>{var _0x160e3d=_0xac431;_0x14584e[_0x404327][_0x160e3d(0xca)]=_0xb6edce;}),_0x309493[_0xac431(0x95)]((_0x43c063,_0x2c486d)=>{var _0x41c859=_0xac431;_0x14584e[_0x2c486d][_0x41c859(0xd1)]=_0x43c063;}),_0xd98ca5[_0xac431(0x95)]((_0x3cd69a,_0x344d43)=>{var _0x222e36=_0xac431;_0x14584e[_0x344d43][_0x222e36(0xf1)]=_0x3cd69a;}),_0x4d984e[_0xac431(0x95)]((_0x36feb2,_0x412032)=>{var _0x3a297a=_0xac431;_0x14584e[_0x412032][_0x3a297a(0x74)]=_0x36feb2;}),_0x27cdc3[_0xac431(0x95)]((_0x3d4bf9,_0x44025f)=>{var _0x1140d2=_0xac431;_0x14584e[_0x44025f][_0x1140d2(0xa3)]=_0x3d4bf9;}),_0x429289[_0xac431(0x95)]((_0x1d9a9c,_0x4cdf86)=>{var _0x5992d2=_0xac431;_0x14584e[_0x4cdf86][_0x5992d2(0xfc)]=_0x1d9a9c;}),_0x34ec54[_0xac431(0x95)]((_0x4eaf5a,_0x45625d)=>{var _0x15043e=_0xac431;_0x14584e[_0x45625d][_0x15043e(0x113)]=_0x4eaf5a;}),_0x1def79[_0xac431(0x95)]((_0x47d384,_0xfca203)=>{var _0x5b1a64=_0xac431;_0x14584e[_0xfca203][_0x5b1a64(0x117)]=_0x47d384;});const _0x4ec364=_0x14584e[_0xac431(0xc4)](_0x3dc621=>_0x3dc621[_0xac431(0xd1)]!=='0'&&_0x3dc621['adjust_qty']!=='');var _0x284b60=0x0;_0x4ec364['forEach'](_0x3e09d3=>{var _0xb5786d=_0xac431;console[_0xb5786d(0x73)](_0xb5786d(0x114),_0x3e09d3),parseInt(_0x3e09d3['adjust_qty'])<=0x0&&_0x284b60++;});if(_0x284b60!=0x0)return _0x19edbd[_0xac431(0xf3)]('errors',_0xac431(0xb2)),_0x1fe72b[_0xac431(0x12c)]('back');_0x4406ba[_0xac431(0x105)]=_0x2d07ea,_0x4406ba['date']=_0xa6954c,_0x4406ba[_0xac431(0xd7)]=_0x4ec364,_0x4406ba['note']=_0x314ce0,_0x4406ba[_0xac431(0x7c)]=_0x819ec7,_0x4406ba[_0xac431(0xee)]=_0x30b97e,_0x4406ba[_0xac431(0x80)]=_0x2ecc64;const _0x202fc5=await _0x4406ba['save'](),_0x2e0c2d=await warehouse['findOne']({'name':_0x2d07ea,'room':_0x819ec7});_0x202fc5[_0xac431(0xd7)][_0xac431(0x95)](_0x4d6725=>{var _0x1c6232=_0xac431;const _0x41f824=_0x2e0c2d[_0x1c6232(0xea)][_0x1c6232(0x8d)](_0x2fa61a=>{var _0x159c5f=_0x1c6232;_0x4d6725[_0x159c5f(0xca)]==_0x159c5f(0x124)?_0x2fa61a[_0x159c5f(0xfb)]==_0x4d6725[_0x159c5f(0xfb)]&&_0x2fa61a[_0x159c5f(0x118)]==_0x4d6725[_0x159c5f(0x118)]&&(_0x2fa61a['product_stock']=parseInt(_0x2fa61a['product_stock'])-parseInt(_0x4d6725[_0x159c5f(0xd1)])):_0x2fa61a[_0x159c5f(0xfb)]==_0x4d6725[_0x159c5f(0xfb)]&&_0x2fa61a['bay']==_0x4d6725['bay']&&(_0x2fa61a[_0x159c5f(0x89)]=parseInt(_0x2fa61a[_0x159c5f(0x89)])+parseInt(_0x4d6725['adjust_qty']));});}),await _0x2e0c2d[_0xac431(0x12b)](),_0x19edbd[_0xac431(0xf3)]('success',_0xac431(0xe8)),_0x1fe72b['redirect'](_0xac431(0x9f));}catch(_0x1fc5a1){console[_0xac431(0x73)](_0x1fc5a1);}}),router['post'](a0_0x8819a4(0x9a),async(_0x3a2f9e,_0x37f61f)=>{var _0x223eb4=a0_0x8819a4;const {primary_code:_0x5b2a7f,warehouse_data:_0x474241,rooms_data:_0x6af6ff,Roomslist:_0x22fddc}=_0x3a2f9e[_0x223eb4(0x100)],_0xbd941f=_0x22fddc[_0x223eb4(0xec)](','),_0x1a839f=[];async function _0x17931c(_0x473052){var _0x262cb3=_0x223eb4;const _0x506f44=await warehouse[_0x262cb3(0x133)]([{'$match':{'name':_0x474241,'room':_0x473052}},{'$unwind':_0x262cb3(0x82)},{'$match':{'product_details.primary_code':_0x5b2a7f}},{'$group':{'_id':_0x262cb3(0x122),'name':{'$first':_0x262cb3(0x121)},'product_stock':{'$first':_0x262cb3(0x125)},'primary_code':{'$first':_0x262cb3(0xdc)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x262cb3(0xbe)},'level':{'$first':_0x262cb3(0xad)},'isle':{'$first':_0x262cb3(0xed)},'type':{'$first':_0x262cb3(0x99)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x262cb3(0x12d)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x262cb3(0xdd)},'expiry_date':{'$first':_0x262cb3(0xc6)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x262cb3(0x9d)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x262cb3(0x7b)}}}]),_0x14c4d5=await warehouse['aggregate']([{'$match':{'name':_0x474241,'room':_0x473052}},{'$unwind':_0x262cb3(0x82)},{'$match':{'product_details.secondary_code':_0x5b2a7f}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x262cb3(0x121)},'product_stock':{'$first':_0x262cb3(0x125)},'primary_code':{'$first':_0x262cb3(0xdc)},'secondary_code':{'$first':_0x262cb3(0xbc)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x262cb3(0xed)},'type':{'$first':_0x262cb3(0x99)},'pallet':{'$first':_0x262cb3(0x123)},'unit':{'$first':_0x262cb3(0x12d)},'secondary_unit':{'$first':_0x262cb3(0xf5)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x262cb3(0xdd)},'expiry_date':{'$first':_0x262cb3(0xc6)},'production_date':{'$first':_0x262cb3(0x75)},'batch_code':{'$first':_0x262cb3(0x9d)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x262cb3(0xc1)},'roomNamed':{'$first':_0x262cb3(0xc3)},'invoice':{'$first':_0x262cb3(0x7b)}}}]);if(_0x506f44[_0x262cb3(0xb5)]>0x0)_0x1a839f[_0x262cb3(0xb6)](_0x506f44);else _0x14c4d5[_0x262cb3(0xb5)]>0x0&&_0x1a839f[_0x262cb3(0xb6)](_0x14c4d5);}const _0x9036df=_0xbd941f[_0x223eb4(0x8d)](_0xff5cf3=>_0x17931c(_0xff5cf3));await Promise[_0x223eb4(0xb7)](_0x9036df),_0x37f61f[_0x223eb4(0xaa)](_0x1a839f);}),router[a0_0x8819a4(0xa1)](a0_0x8819a4(0x107),async(_0x2d5ce8,_0x34e8bc)=>{var _0x5d4db1=a0_0x8819a4;const {productCode:_0x54b90f,bay:_0x1310b1,warehouses:_0x52c33a,room:_0x334cde}=_0x2d5ce8[_0x5d4db1(0x100)];console[_0x5d4db1(0x73)](_0x2d5ce8[_0x5d4db1(0x100)]);try{const _0xc81046=await warehouse[_0x5d4db1(0x133)]([{'$match':{'name':_0x52c33a,'room':_0x334cde}},{'$unwind':_0x5d4db1(0x82)},{'$match':{'product_details.bay':parseInt(_0x1310b1)}},{'$group':{'_id':_0x5d4db1(0x122),'name':{'$first':_0x5d4db1(0x121)},'product_stock':{'$first':_0x5d4db1(0x125)},'bay':{'$first':_0x5d4db1(0xad)},'maxProducts':{'$first':_0x5d4db1(0xdb)}}}]);_0x34e8bc[_0x5d4db1(0x7e)](0xc8)[_0x5d4db1(0xaa)](_0xc81046);}catch(_0x34659f){_0x34e8bc[_0x5d4db1(0x7e)](0x194)[_0x5d4db1(0xaa)]({'message':_0x34659f[_0x5d4db1(0xf7)]});}}),module['exports']=router;function a0_0x34af(){var _0x5b592e=['product_details','$finalize','split','$product_details.bin','invoice','prod_name','/upload/','new_adjust_qty','</table>','flash','findById','$product_details.secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','message','/../public','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Arabic','product_name','product_code','English\x20(US)','80hUiNtI','Enabled','body','finalize','/view/:id','get','_id','warehouse_name','\x20</h2>','/CheckingWarehouse','1248836LfUUqP','getFullYear','string','Finished\x20Goods','site_title','</tr>','logo','padStart','An\x20error\x20occurred\x20while\x20saving\x20data.','\x20Order\x20Date\x20:\x20','random','batch_code','foreach\x20newproduct','host','An\x20error\x20occurred.','expiry_date','bay','role','Error\x20Occurs','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$_id','$name','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Email\x20sent\x20successfully','nodemailer','$product_details.product_name','$product_details._id','$product_details.floorlevel','minus','$product_details.product_stock','Primary_Units','</h5>','purchases_data','slice','getDate','save','redirect','$product_details.unit','153080CNdlZz','24tqtZpe','New_Qty_Converted','<h5>','</span>','aggregate','13RXDRPQ','Adjustment\x20Finalize\x20Successfully','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<hr\x20class=\x22my-3\x22>','Chinese','158956TDDEIR','prod_invoice','<div>','stock','/view','stockBefore','$invoice','log','unit','$product_details.production_date','</body></html>','find','/preview/:id','$product','Router','$product_details.invoice','room','QA\x20Warehouse','status','Hindi','JO_number','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details','findOne','date','../middleware/auth','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','../public/language/languages.json','New_Qty_Converted_adj','product_stock','master','user','176VErtgK','map','Rooms','port','product_date','79774yEgavB','13546848IIZyKd','createTransport','German','forEach','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','params','Portuguese\x20(BR)','$product_details.type','/barcode_scanner','</div>','<span\x20style=\x22float:\x20right;\x22>','$product_details.batch_code','/adjustment/view','/adjustment_finished/view','express','post','warehouse','secondary_unit','image','back','English','email','add','Logo.png','json','maxPerUnit','adjustment\x20add\x20successfull','$product_details.bay','add_adjustment_finished','$product_details.storage','</td>','edit_adjustment_finished','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','level','$product.product_name','length','push','all','Spanish','Arabic\x20(ae)','render','getMonth','$product_details.secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.product_code','</tbody>','Adjustment\x20Mail','$product_details.maxPerUnit','Portuguese','$room','filter','catch','$product_details.expiry_date','staff','errors','</thead>','types','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','154692bNicxG','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','/adjustment_finished/preview/','language','adjust_qty','<h2>\x20','then','production_date','/view/add_adjustment','French','product','459260bxfYhs','prod_cat','floor','$product_details.maxProducts','$product_details.primary_code','$product_details.rack','3kcsbbb','Secondary_units','<tr>','success','prod_code','Enclosed','True','<html><head><title></title>','/picking_list/PDF_adjustment/','Ambient','adjustment\x20data\x20update\x20successfully','room_names'];a0_0x34af=function(){return _0x5b592e;};return a0_0x34af();}