var a0_0x220bfe=a0_0xb2d6;(function(_0x3cbd43,_0xedac7f){var _0x2ab5c6=a0_0xb2d6,_0x4ebdc4=_0x3cbd43();while(!![]){try{var _0x1f0577=parseInt(_0x2ab5c6(0x1e3))/0x1*(-parseInt(_0x2ab5c6(0x17b))/0x2)+parseInt(_0x2ab5c6(0x16d))/0x3+parseInt(_0x2ab5c6(0x16a))/0x4*(-parseInt(_0x2ab5c6(0x182))/0x5)+-parseInt(_0x2ab5c6(0x1ee))/0x6*(parseInt(_0x2ab5c6(0x1a4))/0x7)+-parseInt(_0x2ab5c6(0x1c3))/0x8*(parseInt(_0x2ab5c6(0x148))/0x9)+parseInt(_0x2ab5c6(0x1c1))/0xa+parseInt(_0x2ab5c6(0x1e0))/0xb;if(_0x1f0577===_0xedac7f)break;else _0x4ebdc4['push'](_0x4ebdc4['shift']());}catch(_0x2cf93d){_0x4ebdc4['push'](_0x4ebdc4['shift']());}}}(a0_0x4734,0x4ef3c));const express=require('express'),app=express(),router=express[a0_0x220bfe(0x183)](),auth=require(a0_0x220bfe(0x16b)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x220bfe(0x213)),users=require(a0_0x220bfe(0x186)),nodemailer=require('nodemailer');router[a0_0x220bfe(0x151)]('/view',auth,async(_0x5e3a5f,_0x538cdf)=>{var _0x5be64f=a0_0x220bfe;try{const {username:_0x3dec28,email:_0x2d7d85,role:_0x8fd42}=_0x5e3a5f['user'],_0x2ca4fe=_0x5e3a5f[_0x5be64f(0x1a6)],_0x38adf7=await profile[_0x5be64f(0x18d)]({'email':_0x2ca4fe[_0x5be64f(0x1f5)]}),_0x3e7eb1=await master_shop[_0x5be64f(0x1b1)]();let _0x1ac761;if(_0x2ca4fe[_0x5be64f(0x189)]==_0x5be64f(0x1d4)){const _0x50945=await staff['findOne']({'email':_0x2ca4fe[_0x5be64f(0x1f5)]});_0x1ac761=await warehouse[_0x5be64f(0x1b1)]({'status':_0x5be64f(0x211),'name':_0x50945['warehouse']});}else _0x1ac761=await warehouse[_0x5be64f(0x1b1)]({'status':_0x5be64f(0x211)});const _0x5504a8=await product[_0x5be64f(0x1b1)]();let _0x952d72;if(_0x2ca4fe[_0x5be64f(0x189)]==_0x5be64f(0x1d4)){const _0x4f0827=await staff['findOne']({'email':_0x2ca4fe[_0x5be64f(0x1f5)]});_0x952d72=await adjustment_finished[_0x5be64f(0x1b1)]({'warehouse_name':_0x4f0827[_0x5be64f(0x1d5)]});}else _0x952d72=await adjustment_finished[_0x5be64f(0x1fb)]([{'$unwind':'$product'},{'$group':{'_id':_0x5be64f(0x18b),'invoice':{'$first':'$invoice'},'date':{'$first':_0x5be64f(0x165)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x5be64f(0x19b)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x3e7eb1[0x0][_0x5be64f(0x1ad)]==_0x5be64f(0x199)){var _0x204d4b=users[_0x5be64f(0x171)];console[_0x5be64f(0x1ca)](_0x204d4b);}else{if(_0x3e7eb1[0x0][_0x5be64f(0x1ad)]==_0x5be64f(0x1b7))var _0x204d4b=users[_0x5be64f(0x1b7)];else{if(_0x3e7eb1[0x0][_0x5be64f(0x1ad)]=='German')var _0x204d4b=users[_0x5be64f(0x1a9)];else{if(_0x3e7eb1[0x0][_0x5be64f(0x1ad)]==_0x5be64f(0x154))var _0x204d4b=users[_0x5be64f(0x154)];else{if(_0x3e7eb1[0x0][_0x5be64f(0x1ad)]=='French')var _0x204d4b=users[_0x5be64f(0x198)];else{if(_0x3e7eb1[0x0][_0x5be64f(0x1ad)]=='Portuguese\x20(BR)')var _0x204d4b=users['Portuguese'];else{if(_0x3e7eb1[0x0][_0x5be64f(0x1ad)]==_0x5be64f(0x1f1))var _0x204d4b=users[_0x5be64f(0x1f1)];else{if(_0x3e7eb1[0x0][_0x5be64f(0x1ad)]==_0x5be64f(0x209))var _0x204d4b=users[_0x5be64f(0x15c)];}}}}}}}_0x538cdf[_0x5be64f(0x20e)](_0x5be64f(0x168),{'success':_0x5e3a5f[_0x5be64f(0x166)](_0x5be64f(0x1b5)),'errors':_0x5e3a5f[_0x5be64f(0x166)]('errors'),'role':_0x2ca4fe,'profile':_0x38adf7,'warehouse':_0x1ac761,'product':_0x5504a8,'adjustment':_0x952d72,'master_shop':_0x3e7eb1,'language':_0x204d4b});}catch(_0x2b417a){console[_0x5be64f(0x1ca)](_0x2b417a);}});async function getRandom8DigitNumber(){var _0x35f298=a0_0x220bfe;const _0x2b108e=0x989680,_0x58f995=0x5f5e0ff,_0x3afd77=Math['floor'](Math['random']()*(_0x58f995-_0x2b108e+0x1))+_0x2b108e;var _0x181ac3;const _0x2d64f6=await adjustment_finished[_0x35f298(0x18d)]({'invoice':_0x35f298(0x1c4)+_0x3afd77});return _0x2d64f6&&_0x2d64f6[_0x35f298(0x1bf)]>0x0?_0x181ac3=_0x35f298(0x1c4)+_0x3afd77:_0x181ac3=_0x35f298(0x1c4)+_0x3afd77,_0x181ac3;}router['get']('/view/add_adjustment',auth,async(_0x36e2fc,_0x3a56d5)=>{var _0xbfcfc2=a0_0x220bfe;try{const {username:_0x3bbda3,email:_0x34b4f1,role:_0x2f0531}=_0x36e2fc['user'],_0x3017ea=_0x36e2fc[_0xbfcfc2(0x1a6)],_0x2586c4=await profile['findOne']({'email':_0x3017ea[_0xbfcfc2(0x1f5)]}),_0x135225=await master_shop[_0xbfcfc2(0x1b1)]();let _0x13a104;if(_0x3017ea[_0xbfcfc2(0x189)]==_0xbfcfc2(0x1d4)){const _0x327ac3=await staff[_0xbfcfc2(0x18d)]({'email':_0x3017ea[_0xbfcfc2(0x1f5)]});_0x13a104=await warehouse[_0xbfcfc2(0x1fb)]([{'$match':{'status':_0xbfcfc2(0x211),'name':_0x327ac3['warehouse'],'warehouse_category':_0xbfcfc2(0x1e2),'name':{'$ne':_0xbfcfc2(0x179)}}},{'$group':{'_id':_0xbfcfc2(0x188),'name':{'$first':_0xbfcfc2(0x188)}}}]);}else _0x13a104=await warehouse[_0xbfcfc2(0x1fb)]([{'$match':{'status':'Enabled','warehouse_category':_0xbfcfc2(0x1e2),'name':{'$ne':_0xbfcfc2(0x179)}}},{'$group':{'_id':_0xbfcfc2(0x188),'name':{'$first':_0xbfcfc2(0x188)}}}]);const _0x505336=await product[_0xbfcfc2(0x1b1)]({}),_0xbfe5b6=await adjustment_finished[_0xbfcfc2(0x1b1)]({}),_0xa2df11=_0xbfe5b6[_0xbfcfc2(0x1bf)]+0x1,_0x19c09a=_0xbfcfc2(0x1c4)+_0xa2df11[_0xbfcfc2(0x178)]()[_0xbfcfc2(0x161)](0x5,'0');var _0x5778e=[_0xbfcfc2(0x1b0),_0xbfcfc2(0x203),_0xbfcfc2(0x1eb)];if(_0x135225[0x0][_0xbfcfc2(0x1ad)]==_0xbfcfc2(0x199))var _0x2bcf1a=users['English'];else{if(_0x135225[0x0][_0xbfcfc2(0x1ad)]==_0xbfcfc2(0x1b7))var _0x2bcf1a=users['Hindi'];else{if(_0x135225[0x0]['language']==_0xbfcfc2(0x1a9))var _0x2bcf1a=users[_0xbfcfc2(0x1a9)];else{if(_0x135225[0x0]['language']==_0xbfcfc2(0x154))var _0x2bcf1a=users[_0xbfcfc2(0x154)];else{if(_0x135225[0x0][_0xbfcfc2(0x1ad)]==_0xbfcfc2(0x198))var _0x2bcf1a=users[_0xbfcfc2(0x198)];else{if(_0x135225[0x0][_0xbfcfc2(0x1ad)]==_0xbfcfc2(0x20d))var _0x2bcf1a=users['Portuguese'];else{if(_0x135225[0x0][_0xbfcfc2(0x1ad)]=='Chinese')var _0x2bcf1a=users['Chinese'];else{if(_0x135225[0x0]['language']==_0xbfcfc2(0x209))var _0x2bcf1a=users[_0xbfcfc2(0x15c)];}}}}}}}const _0x4e4044=getRandom8DigitNumber();_0x4e4044[_0xbfcfc2(0x190)](_0x19537d=>{var _0x337aa7=_0xbfcfc2;_0x3a56d5[_0x337aa7(0x20e)](_0x337aa7(0x17a),{'success':_0x36e2fc[_0x337aa7(0x166)]('success'),'errors':_0x36e2fc[_0x337aa7(0x166)]('errors'),'role':_0x3017ea,'profile':_0x2586c4,'warehouse':_0x13a104,'product':_0x505336,'master_shop':_0x135225,'language':_0x2bcf1a,'rooms_data':_0x5778e,'invoice_no':_0x19537d});})['catch'](_0x5b20ef=>{var _0x279802=_0xbfcfc2;_0x36e2fc['flash'](_0x279802(0x206),_0x279802(0x1d8)),_0x3a56d5[_0x279802(0x1f7)](_0x279802(0x1aa));});}catch(_0x394791){console[_0xbfcfc2(0x1ca)](_0x394791);}}),router[a0_0x220bfe(0x1f6)](a0_0x220bfe(0x1b9),auth,async(_0x5be53f,_0x4128d9)=>{var _0x5ef922=a0_0x220bfe;try{const {warehouse_name:_0x129ea2,date:_0x2806d3,prod_name:_0x19ced1,level:_0xddf8c1,isle:_0x1f6b68,pallet:_0x2064a5,stock:_0x58593b,types:_0x590a85,adjust_qty:_0x582772,new_adjust_qty:_0x3a9985,note:_0x79dd6f,Room_name:_0x44768a,invoice:_0x107cc1,JO_number:_0xb084d4,expiry_date:_0x53925a}=_0x5be53f[_0x5ef922(0x156)];if(typeof _0x19ced1==_0x5ef922(0x17d))var _0x35c33d=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x187)]],_0x30d26b=[_0x5be53f[_0x5ef922(0x156)]['level']],_0x395725=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1be)]],_0x4522f0=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1a0)]],_0x4360d9=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1c8)]],_0x356a1a=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1ef)]],_0x15b2af=[_0x5be53f[_0x5ef922(0x156)]['Primary_Units']],_0x5e24f5=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1bc)]],_0x2feaf7=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x210)]],_0x3446cc=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x172)]],_0xb7d967=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1c9)]],_0x2b48c2=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1e7)]],_0x356a80=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x214)]],_0x2d8a0f=[_0x5be53f[_0x5ef922(0x156)]['Rooms']],_0x46120e=[_0x5be53f[_0x5ef922(0x156)]['maxPerUnit']],_0x2219b6=[_0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1e8)]];else var _0x35c33d=[..._0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x187)]],_0x30d26b=[..._0x5be53f['body'][_0x5ef922(0x1fc)]],_0x395725=[..._0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1be)]],_0x4522f0=[..._0x5be53f['body'][_0x5ef922(0x1a0)]],_0x4360d9=[..._0x5be53f['body'][_0x5ef922(0x1c8)]],_0x356a1a=[..._0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1ef)]],_0x15b2af=[..._0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1ab)]],_0x5e24f5=[..._0x5be53f['body'][_0x5ef922(0x1bc)]],_0x2feaf7=[..._0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x210)]],_0x3446cc=[..._0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x172)]],_0xb7d967=[..._0x5be53f[_0x5ef922(0x156)]['expiry_date']],_0x2b48c2=[..._0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1e7)]],_0x356a80=[..._0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x214)]],_0x2d8a0f=[..._0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1b4)]],_0x46120e=[..._0x5be53f['body']['maxPerUnit']],_0x2219b6=[..._0x5be53f[_0x5ef922(0x156)][_0x5ef922(0x1e8)]];const _0x1d2d5b=_0x35c33d[_0x5ef922(0x1b6)](_0x37b1ae=>{return _0x37b1ae={'product_name':_0x37b1ae};});_0x30d26b[_0x5ef922(0x19e)]((_0x322f1e,_0x9f9486)=>{var _0xbd5f0d=_0x5ef922;_0x1d2d5b[_0x9f9486][_0xbd5f0d(0x17c)]=_0x322f1e;}),_0x395725[_0x5ef922(0x19e)]((_0x2003c2,_0x3ba20f)=>{_0x1d2d5b[_0x3ba20f]['stockBefore']=_0x2003c2;}),_0x4522f0[_0x5ef922(0x19e)]((_0xda7ecd,_0x1a3ce4)=>{_0x1d2d5b[_0x1a3ce4]['types']=_0xda7ecd;}),_0x4360d9[_0x5ef922(0x19e)]((_0x5c4114,_0xb49e7b)=>{var _0x143bd4=_0x5ef922;_0x1d2d5b[_0xb49e7b][_0x143bd4(0x1d1)]=_0x5c4114;}),_0x356a1a['forEach']((_0x18702b,_0x14e751)=>{_0x1d2d5b[_0x14e751]['new_adjust_qty']=_0x18702b;}),_0x15b2af[_0x5ef922(0x19e)]((_0x11017a,_0x134c9a)=>{_0x1d2d5b[_0x134c9a]['unit']=_0x11017a;}),_0x5e24f5['forEach']((_0x1d2438,_0x281879)=>{_0x1d2d5b[_0x281879]['secondary_unit']=_0x1d2438;}),_0x2feaf7[_0x5ef922(0x19e)]((_0x272e22,_0x53a67e)=>{var _0xf72767=_0x5ef922;_0x1d2d5b[_0x53a67e][_0xf72767(0x1a3)]=_0x272e22;}),_0x3446cc[_0x5ef922(0x19e)]((_0x1c41f9,_0x897bf2)=>{var _0x2fa80d=_0x5ef922;_0x1d2d5b[_0x897bf2][_0x2fa80d(0x172)]=_0x1c41f9;}),_0xb7d967[_0x5ef922(0x19e)]((_0x2eae78,_0x5b0dcc)=>{var _0x991375=_0x5ef922;_0x1d2d5b[_0x5b0dcc][_0x991375(0x1c9)]=_0x2eae78;}),_0x2b48c2[_0x5ef922(0x19e)]((_0x51c19f,_0x1a3af0)=>{var _0x43c58a=_0x5ef922;_0x1d2d5b[_0x1a3af0][_0x43c58a(0x1d3)]=_0x51c19f;}),_0x356a80[_0x5ef922(0x19e)]((_0x2daaf0,_0x1826ed)=>{var _0x123720=_0x5ef922;_0x1d2d5b[_0x1826ed][_0x123720(0x214)]=_0x2daaf0;}),_0x2d8a0f['forEach']((_0x170ae0,_0x1f6fce)=>{var _0x4375a1=_0x5ef922;_0x1d2d5b[_0x1f6fce][_0x4375a1(0x195)]=_0x170ae0;}),_0x46120e['forEach']((_0x2013bc,_0x308947)=>{var _0x1ac247=_0x5ef922;_0x1d2d5b[_0x308947][_0x1ac247(0x1b8)]=_0x2013bc;}),_0x2219b6['forEach']((_0x63fdb6,_0x2c6d61)=>{_0x1d2d5b[_0x2c6d61]['invoice']=_0x63fdb6;});const _0x590f00=_0x1d2d5b['filter'](_0x1ef5c5=>_0x1ef5c5[_0x5ef922(0x1d1)]!=='0'&&_0x1ef5c5[_0x5ef922(0x1d1)]!=='');var _0x5de501=0x0;_0x590f00[_0x5ef922(0x19e)](_0x13eb18=>{var _0x19bbec=_0x5ef922;console[_0x19bbec(0x1ca)]('foreach\x20newproduct',_0x13eb18),parseInt(_0x13eb18[_0x19bbec(0x1d1)])<=0x0&&_0x5de501++;});if(_0x5de501!=0x0)return _0x5be53f[_0x5ef922(0x166)](_0x5ef922(0x206),_0x5ef922(0x1c6)),_0x4128d9[_0x5ef922(0x1f7)]('back');const _0x7728e1=new adjustment_finished({'warehouse_name':_0x129ea2,'date':_0x2806d3,'product':_0x590f00,'note':_0x79dd6f,'room':_0x44768a,'invoice':_0x107cc1,'JO_number':_0xb084d4,'expiry_date':_0x53925a}),_0x1b688e=await _0x7728e1[_0x5ef922(0x1d0)]();_0x5be53f['flash'](_0x5ef922(0x1b5),_0x5ef922(0x18e)),_0x4128d9['redirect'](_0x5ef922(0x1ea)+_0x1b688e[_0x5ef922(0x184)]);}catch(_0x29a816){console[_0x5ef922(0x1ca)](_0x29a816),_0x4128d9[_0x5ef922(0x152)](0xc8)[_0x5ef922(0x1f3)]({'message':_0x29a816['message']});}}),router[a0_0x220bfe(0x151)](a0_0x220bfe(0x1c5),auth,async(_0x14d769,_0x59a936)=>{var _0xb30f84=a0_0x220bfe;try{const {username:_0x2ccd4e,email:_0x269c71,role:_0x321528}=_0x14d769[_0xb30f84(0x1a6)],_0x2c8587=_0x14d769[_0xb30f84(0x1a6)],_0x93d49c=await profile[_0xb30f84(0x18d)]({'email':_0x2c8587[_0xb30f84(0x1f5)]}),_0x1b67b7=await master_shop['find'](),_0x65b9df=_0x14d769[_0xb30f84(0x197)]['id'],_0x262cdc=await adjustment_finished[_0xb30f84(0x208)]({'_id':_0x65b9df}),_0x1d011e=await purchases[_0xb30f84(0x1fb)]([{'$match':{'warehouse_name':_0x262cdc[_0xb30f84(0x1cc)]}},{'$unwind':_0xb30f84(0x1ce)},{'$group':{'_id':_0xb30f84(0x1ed)}}]);console[_0xb30f84(0x1ca)]('purchases_data',_0x1d011e);const _0x2c399f=await product['find']({}),_0x1e9186=await warehouse[_0xb30f84(0x1fb)]([{'$match':{'name':_0x262cdc['warehouse_name'],'warehouse_category':_0xb30f84(0x1e2)}},{'$unwind':_0xb30f84(0x1e6)},{'$group':{'_id':_0xb30f84(0x18f),'name':{'$first':_0xb30f84(0x1e5)},'product_stock':{'$first':_0xb30f84(0x1f4)},'bay':{'$first':_0xb30f84(0x173)},'bin':{'$first':_0xb30f84(0x1dd)},'type':{'$first':_0xb30f84(0x185)},'floorlevel':{'$first':_0xb30f84(0x1c2)},'primary_code':{'$first':_0xb30f84(0x19f)},'secondary_code':{'$first':_0xb30f84(0x1de)},'product_code':{'$first':_0xb30f84(0x20c)},'storage':{'$first':_0xb30f84(0x16c)},'rack':{'$first':_0xb30f84(0x15e)},'expiry_date':{'$first':_0xb30f84(0x1cb)},'production_date':{'$first':_0xb30f84(0x17f)},'batch_code':{'$first':_0xb30f84(0x212)},'maxPerUnit':{'$first':_0xb30f84(0x14c)},'room':{'$first':_0xb30f84(0x1f2)}}}]);if(_0x1b67b7[0x0][_0xb30f84(0x1ad)]==_0xb30f84(0x199)){var _0x429175=users['English'];console[_0xb30f84(0x1ca)](_0x429175);}else{if(_0x1b67b7[0x0][_0xb30f84(0x1ad)]==_0xb30f84(0x1b7))var _0x429175=users['Hindi'];else{if(_0x1b67b7[0x0][_0xb30f84(0x1ad)]==_0xb30f84(0x1a9))var _0x429175=users[_0xb30f84(0x1a9)];else{if(_0x1b67b7[0x0][_0xb30f84(0x1ad)]==_0xb30f84(0x154))var _0x429175=users[_0xb30f84(0x154)];else{if(_0x1b67b7[0x0][_0xb30f84(0x1ad)]==_0xb30f84(0x198))var _0x429175=users[_0xb30f84(0x198)];else{if(_0x1b67b7[0x0][_0xb30f84(0x1ad)]=='Portuguese\x20(BR)')var _0x429175=users['Portuguese'];else{if(_0x1b67b7[0x0][_0xb30f84(0x1ad)]==_0xb30f84(0x1f1))var _0x429175=users['Chinese'];else{if(_0x1b67b7[0x0][_0xb30f84(0x1ad)]==_0xb30f84(0x209))var _0x429175=users['Arabic'];}}}}}}}_0x59a936['render'](_0xb30f84(0x1e9),{'success':_0x14d769[_0xb30f84(0x166)](_0xb30f84(0x1b5)),'errors':_0x14d769['flash'](_0xb30f84(0x206)),'role':_0x2c8587,'profile':_0x93d49c,'adjustment':_0x262cdc,'stock':_0x1e9186,'master_shop':_0x1b67b7,'warehouse_name':_0x1d011e,'unit':_0x2c399f,'language':_0x429175});}catch(_0x1da32a){console[_0xb30f84(0x1ca)](_0x1da32a),_0x59a936[_0xb30f84(0x152)](0xc8)['json']({'message':_0x1da32a[_0xb30f84(0x196)]});}}),router['post']('/preview/:id',auth,async(_0x5dfcb9,_0x5aa1cc)=>{var _0x2006ab=a0_0x220bfe;try{const {invoice:_0x473331,warehouse_name:_0x12be87,Room_name:_0x124c52}=_0x5dfcb9[_0x2006ab(0x156)],_0x4880e0=_0x5dfcb9[_0x2006ab(0x197)]['id'],_0x449e9e=await adjustment_finished[_0x2006ab(0x208)]({'_id':_0x4880e0});var _0x402319;const _0x54bff6=_0x449e9e[_0x2006ab(0x1bd)][_0x2006ab(0x1b6)](async _0x89239a=>{var _0xa96e40=_0x2006ab;if(_0x89239a[_0xa96e40(0x1d1)]>0x0){_0x402319=await warehouse['findOne']({'name':_0x12be87,'room':_0x89239a['room_names'],'warehouse_category':_0xa96e40(0x1e2)});const _0xc7309a=_0x402319[_0xa96e40(0x1c0)]['map'](_0x345599=>{var _0x5b3de3=_0xa96e40;console[_0x5b3de3(0x1ca)](_0x89239a[_0x5b3de3(0x1a0)]);if(_0x89239a[_0x5b3de3(0x1a0)]=='minus')_0x345599['product_name']==_0x89239a[_0x5b3de3(0x1cd)]&&_0x345599['bay']==_0x89239a[_0x5b3de3(0x17c)]&&_0x345599[_0x5b3de3(0x1c9)]==_0x89239a[_0x5b3de3(0x1c9)]&&_0x345599[_0x5b3de3(0x1d3)]==_0x89239a[_0x5b3de3(0x1d3)]&&_0x345599[_0x5b3de3(0x172)]==_0x89239a[_0x5b3de3(0x172)]&&_0x345599[_0x5b3de3(0x207)]==_0x89239a[_0x5b3de3(0x207)]&&(_0x345599[_0x5b3de3(0x200)]=_0x345599[_0x5b3de3(0x200)]-_0x89239a[_0x5b3de3(0x1d1)]);else _0x89239a['types']==_0x5b3de3(0x19c)&&(_0x345599['product_name']==_0x89239a[_0x5b3de3(0x1cd)]&&_0x345599[_0x5b3de3(0x17c)]==_0x89239a[_0x5b3de3(0x17c)]&&_0x345599[_0x5b3de3(0x1c9)]==_0x89239a[_0x5b3de3(0x1c9)]&&_0x345599[_0x5b3de3(0x1d3)]==_0x89239a[_0x5b3de3(0x1d3)]&&_0x345599[_0x5b3de3(0x172)]==_0x89239a[_0x5b3de3(0x172)]&&_0x345599[_0x5b3de3(0x207)]==_0x89239a['invoice']&&(_0x345599[_0x5b3de3(0x200)]=_0x345599['product_stock']+_0x89239a[_0x5b3de3(0x1d1)]));});}return _0x402319;});Promise[_0x2006ab(0x19d)](_0x54bff6)[_0x2006ab(0x190)](async _0x4c46de=>{var _0x31d244=_0x2006ab;try{for(const _0x1f5048 of _0x4c46de){await _0x1f5048[_0x31d244(0x1d0)]();}_0x449e9e[_0x31d244(0x170)]=_0x31d244(0x20b);const _0x14c64f=await _0x449e9e[_0x31d244(0x1d0)](),_0x4441f4=await master_shop[_0x31d244(0x1b1)](),_0x2972f8=await email_settings[_0x31d244(0x18d)](),_0x1a7f50=await supervisor_settings[_0x31d244(0x1b1)]();var _0xace0dd=_0x449e9e['product'],_0x5972fd='',_0x34543d;for(_0x34543d in _0xace0dd){var _0x59166f='FG';_0x449e9e[_0x31d244(0x1cc)]==_0x31d244(0x169)&&(_0x59166f='DG'),_0x5972fd+=_0x31d244(0x194)+_0x31d244(0x1ec)+_0xace0dd[_0x34543d][_0x31d244(0x1cd)]+_0x31d244(0x191)+_0x31d244(0x1ec)+_0xace0dd[_0x34543d][_0x31d244(0x1a3)]+_0x31d244(0x191)+_0x31d244(0x1ec)+_0xace0dd[_0x34543d][_0x31d244(0x1d1)]+_0x31d244(0x191)+_0x31d244(0x1ec)+_0xace0dd[_0x34543d][_0x31d244(0x1cf)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xace0dd[_0x34543d][_0x31d244(0x1a2)]+_0x31d244(0x191)+_0x31d244(0x1ec)+_0x449e9e['warehouse_name']+_0x31d244(0x191)+_0x31d244(0x1ec)+_0xace0dd[_0x34543d][_0x31d244(0x195)]+_0x31d244(0x191)+_0x31d244(0x1ec)+_0x59166f+_0xace0dd[_0x34543d][_0x31d244(0x17c)]+'</td>'+_0x31d244(0x14d);}let _0x160d3f=nodemailer[_0x31d244(0x1a1)]({'host':_0x2972f8[_0x31d244(0x15f)],'port':Number(_0x2972f8[_0x31d244(0x19a)]),'secure':![],'auth':{'user':_0x2972f8[_0x31d244(0x1f5)],'pass':_0x2972f8[_0x31d244(0x18a)]}}),_0xc1cde9={'from':_0x2972f8['email'],'to':_0x1a7f50[0x0][_0x31d244(0x181)],'subject':'Adjustment\x20Mail','attachments':[{'filename':_0x31d244(0x14f),'path':__dirname+'/../public'+_0x31d244(0x162)+_0x4441f4[0x0][_0x31d244(0x160)],'cid':_0x31d244(0x164)}],'html':'<!DOCTYPE\x20html>'+_0x31d244(0x202)+_0x31d244(0x163)+_0x31d244(0x1dc)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+'<div>'+'<h2>\x20'+_0x4441f4[0x0][_0x31d244(0x193)]+'\x20</h2>'+_0x31d244(0x1f8)+_0x31d244(0x1f8)+_0x31d244(0x1da)+_0x31d244(0x1dc)+_0x31d244(0x20a)+_0x31d244(0x180)+_0x449e9e[_0x31d244(0x207)]+'\x20'+_0x31d244(0x1d9)+_0x31d244(0x1ae)+_0x449e9e['date']+'\x20'+_0x31d244(0x1e1)+_0x31d244(0x1df)+'</div>'+_0x31d244(0x1fe)+_0x31d244(0x1ac)+_0x31d244(0x194)+_0x31d244(0x1d6)+_0x31d244(0x153)+_0x31d244(0x149)+_0x31d244(0x14b)+_0x31d244(0x158)+_0x31d244(0x192)+_0x31d244(0x1a8)+_0x31d244(0x1ba)+_0x31d244(0x14d)+_0x31d244(0x167)+_0x31d244(0x14e)+'\x20'+_0x5972fd+'\x20'+_0x31d244(0x215)+_0x31d244(0x15b)+_0x31d244(0x1dc)+_0x31d244(0x14a)+_0x31d244(0x20f)+_0x4441f4[0x0][_0x31d244(0x193)]+'</h5>'+_0x31d244(0x1f8)+_0x31d244(0x1f8)+_0x31d244(0x1db)};_0x160d3f[_0x31d244(0x16f)](_0xc1cde9,function(_0x1a37d6,_0x5269b8){var _0x2488eb=_0x31d244;_0x1a37d6?(console[_0x2488eb(0x1ca)](_0x1a37d6),console[_0x2488eb(0x1ca)](_0x2488eb(0x1f9))):console['log']('Email\x20sent\x20successfully');}),_0x5dfcb9[_0x31d244(0x166)]('success',_0x31d244(0x177)),_0x5aa1cc['redirect']('/picking_list/PDF_adjustment/'+_0x14c64f[_0x31d244(0x184)]);}catch(_0x276351){console[_0x31d244(0x157)](_0x276351),_0x5aa1cc[_0x31d244(0x152)](0x1f4)[_0x31d244(0x1f3)]({'error':_0x31d244(0x150)});}})[_0x2006ab(0x201)](_0x2f9844=>{var _0x2766d1=_0x2006ab;console[_0x2766d1(0x157)](_0x2f9844),_0x5aa1cc['status'](0x1f4)['json']({'error':_0x2766d1(0x15a)});});}catch(_0x475675){_0x5aa1cc['json']({'message':_0x475675[_0x2006ab(0x196)]});}}),router[a0_0x220bfe(0x151)](a0_0x220bfe(0x1e4),auth,async(_0x165c95,_0x10f5e0)=>{var _0x27c727=a0_0x220bfe;try{const {username:_0x298f6f,email:_0x3ca0ac,role:_0x15a544}=_0x165c95[_0x27c727(0x1a6)],_0x30fd71=_0x165c95[_0x27c727(0x1a6)],_0x24ad71=await profile[_0x27c727(0x18d)]({'email':_0x30fd71['email']}),_0x4a3725=await master_shop[_0x27c727(0x1b1)]();console['log'](_0x27c727(0x155),_0x4a3725);const _0x149e9b=_0x165c95[_0x27c727(0x197)]['id'],_0x577f9c=await adjustment_finished[_0x27c727(0x208)]({'_id':_0x149e9b});let _0x173e73=new Date(_0x577f9c[_0x27c727(0x1c9)]),_0x4a44ec=('0'+_0x173e73[_0x27c727(0x1b3)]())[_0x27c727(0x17e)](-0x2),_0x256162=('0'+(_0x173e73[_0x27c727(0x1b2)]()+0x1))[_0x27c727(0x17e)](-0x2),_0x5939ae=_0x173e73[_0x27c727(0x1a5)](),_0x3a7fcb=_0x5939ae+'-'+_0x256162+'-'+_0x4a44ec;var _0x26c341=[_0x27c727(0x1b0),_0x27c727(0x203),_0x27c727(0x1eb)];const _0x2f6b89=await purchases['aggregate']([{'$match':{'warehouse_name':_0x577f9c[_0x27c727(0x1cc)]}},{'$unwind':_0x27c727(0x1ce)},{'$group':{'_id':_0x27c727(0x1ed)}}]);console[_0x27c727(0x1ca)](_0x27c727(0x176),_0x2f6b89);const _0x154579=await product[_0x27c727(0x1b1)]({}),_0x5a2ac3=await warehouse[_0x27c727(0x1fb)]([{'$match':{'name':_0x577f9c['warehouse_name'],'room':_0x577f9c['room']}},{'$unwind':_0x27c727(0x1e6)},{'$group':{'_id':_0x27c727(0x18f),'name':{'$first':_0x27c727(0x1e5)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x27c727(0x173)},'bin':{'$first':_0x27c727(0x1dd)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x27c727(0x19f)},'secondary_code':{'$first':_0x27c727(0x1de)},'product_code':{'$first':_0x27c727(0x20c)},'storage':{'$first':_0x27c727(0x16c)},'rack':{'$first':_0x27c727(0x15e)}}}]);if(_0x4a3725[0x0]['language']==_0x27c727(0x199)){var _0x4c62fb=users['English'];console[_0x27c727(0x1ca)](_0x4c62fb);}else{if(_0x4a3725[0x0][_0x27c727(0x1ad)]=='Hindi')var _0x4c62fb=users[_0x27c727(0x1b7)];else{if(_0x4a3725[0x0]['language']=='German')var _0x4c62fb=users[_0x27c727(0x1a9)];else{if(_0x4a3725[0x0][_0x27c727(0x1ad)]==_0x27c727(0x154))var _0x4c62fb=users[_0x27c727(0x154)];else{if(_0x4a3725[0x0][_0x27c727(0x1ad)]==_0x27c727(0x198))var _0x4c62fb=users[_0x27c727(0x198)];else{if(_0x4a3725[0x0]['language']==_0x27c727(0x20d))var _0x4c62fb=users[_0x27c727(0x16e)];else{if(_0x4a3725[0x0]['language']==_0x27c727(0x1f1))var _0x4c62fb=users[_0x27c727(0x1f1)];else{if(_0x4a3725[0x0]['language']=='Arabic\x20(ae)')var _0x4c62fb=users[_0x27c727(0x15c)];}}}}}}}_0x10f5e0[_0x27c727(0x20e)]('edit_adjustment_finished',{'success':_0x165c95['flash'](_0x27c727(0x1b5)),'errors':_0x165c95[_0x27c727(0x166)](_0x27c727(0x206)),'role':_0x30fd71,'profile':_0x24ad71,'adjustment':_0x577f9c,'stock':_0x5a2ac3,'master_shop':_0x4a3725,'warehouse_name':_0x2f6b89,'unit':_0x154579,'language':_0x4c62fb,'rooms_data':_0x26c341,'ed_fullDate':_0x3a7fcb});}catch(_0x1b77d3){console['log'](_0x1b77d3),_0x10f5e0[_0x27c727(0x152)](0xc8)['json']({'message':_0x1b77d3[_0x27c727(0x196)]});}}),router[a0_0x220bfe(0x1f6)](a0_0x220bfe(0x1e4),auth,async(_0x575e1c,_0x4b7f44)=>{var _0x4a8058=a0_0x220bfe;try{const _0x5e4c9a=_0x575e1c[_0x4a8058(0x197)]['id'],_0x1887c1=await adjustment_finished[_0x4a8058(0x208)]({'_id':_0x5e4c9a}),_0x5e46ca=await warehouse[_0x4a8058(0x18d)]({'name':_0x1887c1['warehouse_name'],'room':_0x1887c1[_0x4a8058(0x1d2)]}),{warehouse_name:_0x57f76b,date:_0x2f4306,prod_name:_0x214c14,level:_0x308bf7,isle:_0x216919,pallet:_0x55ccaf,stock:_0x14690f,types:_0x45c17c,adjust_qty:_0x5e63d0,new_adjust_qty:_0x3ffa84,note:_0xf3700b,Room_name:_0x4d1efa,invoice:_0x2f2cd0,JO_number:_0x453e8a}=_0x575e1c['body'];if(typeof _0x214c14==_0x4a8058(0x17d))var _0x71f21c=[_0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x187)]],_0x50b169=[_0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x1fc)]],_0x28caf1=[_0x575e1c['body'][_0x4a8058(0x1be)]],_0x1bea33=[_0x575e1c['body'][_0x4a8058(0x1a0)]],_0x4b1185=[_0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x1d1)]],_0x1f393a=[_0x575e1c[_0x4a8058(0x156)]['new_adjust_qty']],_0x1ba94c=[_0x575e1c[_0x4a8058(0x156)]['prod_code']],_0x23c1c8=[_0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x1cf)]],_0x3e7b58=[_0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x1bc)]],_0x51b99c=[_0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x172)]],_0x326d42=[_0x575e1c[_0x4a8058(0x156)]['expiry_date']];else var _0x71f21c=[..._0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x187)]],_0x50b169=[..._0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x1fc)]],_0x28caf1=[..._0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x1be)]],_0x1bea33=[..._0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x1a0)]],_0x4b1185=[..._0x575e1c['body'][_0x4a8058(0x1d1)]],_0x1f393a=[..._0x575e1c[_0x4a8058(0x156)]['new_adjust_qty']],_0x1ba94c=[..._0x575e1c[_0x4a8058(0x156)]['prod_code']],_0x23c1c8=[..._0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x1cf)]],_0x3e7b58=[..._0x575e1c['body'][_0x4a8058(0x1bc)]],_0x51b99c=[..._0x575e1c[_0x4a8058(0x156)][_0x4a8058(0x172)]],_0x326d42=[..._0x575e1c['body'][_0x4a8058(0x1c9)]];const _0x133246=_0x71f21c[_0x4a8058(0x1b6)](_0x19d0a6=>{return _0x19d0a6={'product_name':_0x19d0a6};});_0x50b169['forEach']((_0x560419,_0x1ef019)=>{var _0x48f35f=_0x4a8058;_0x133246[_0x1ef019][_0x48f35f(0x17c)]=_0x560419;}),_0x28caf1[_0x4a8058(0x19e)]((_0x5d9e4f,_0x119d69)=>{_0x133246[_0x119d69]['stockBefore']=_0x5d9e4f;}),_0x1bea33['forEach']((_0x5d6f05,_0x2674c)=>{var _0x481c39=_0x4a8058;_0x133246[_0x2674c][_0x481c39(0x1a0)]=_0x5d6f05;}),_0x4b1185[_0x4a8058(0x19e)]((_0x1333a9,_0x12e968)=>{_0x133246[_0x12e968]['adjust_qty']=_0x1333a9;}),_0x1f393a[_0x4a8058(0x19e)]((_0xc9f05d,_0x149c15)=>{var _0x4be243=_0x4a8058;_0x133246[_0x149c15][_0x4be243(0x1fa)]=_0xc9f05d;}),_0x23c1c8['forEach']((_0xa989e0,_0x2e77d9)=>{_0x133246[_0x2e77d9]['unit']=_0xa989e0;}),_0x3e7b58['forEach']((_0x6f9cfd,_0x3a5aab)=>{_0x133246[_0x3a5aab]['secondary_unit']=_0x6f9cfd;}),_0x1ba94c[_0x4a8058(0x19e)]((_0x55fa63,_0x42680c)=>{var _0x511ed7=_0x4a8058;_0x133246[_0x42680c][_0x511ed7(0x1a3)]=_0x55fa63;}),_0x51b99c['forEach']((_0xa1fd35,_0x3f2a24)=>{var _0xb6ed33=_0x4a8058;_0x133246[_0x3f2a24][_0xb6ed33(0x172)]=_0xa1fd35;}),_0x326d42[_0x4a8058(0x19e)]((_0x5eaec5,_0x133e19)=>{var _0x4b78c5=_0x4a8058;_0x133246[_0x133e19][_0x4b78c5(0x1c9)]=_0x5eaec5;});const _0x48b532=_0x133246['filter'](_0x38f158=>_0x38f158[_0x4a8058(0x1d1)]!=='0'&&_0x38f158['adjust_qty']!=='');var _0x1a86b0=0x0;_0x48b532[_0x4a8058(0x19e)](_0x3cb4ac=>{var _0x475935=_0x4a8058;console[_0x475935(0x1ca)]('foreach\x20newproduct',_0x3cb4ac),parseInt(_0x3cb4ac['adjust_qty'])<=0x0&&_0x1a86b0++;});if(_0x1a86b0!=0x0)return _0x575e1c[_0x4a8058(0x166)](_0x4a8058(0x206),_0x4a8058(0x1c6)),_0x4b7f44[_0x4a8058(0x1f7)](_0x4a8058(0x1f0));_0x1887c1['warehouse_name']=_0x57f76b,_0x1887c1[_0x4a8058(0x15d)]=_0x2f4306,_0x1887c1['product']=_0x48b532,_0x1887c1[_0x4a8058(0x205)]=_0xf3700b,_0x1887c1[_0x4a8058(0x1d2)]=_0x4d1efa,_0x1887c1[_0x4a8058(0x207)]=_0x2f2cd0,_0x1887c1[_0x4a8058(0x1ff)]=_0x453e8a;const _0x32d0d3=await _0x1887c1[_0x4a8058(0x1d0)](),_0x4ed9b8=await warehouse[_0x4a8058(0x18d)]({'name':_0x57f76b,'room':_0x4d1efa});_0x32d0d3[_0x4a8058(0x1bd)]['forEach'](_0x2a4818=>{var _0x7d49f8=_0x4a8058;const _0x139247=_0x4ed9b8[_0x7d49f8(0x1c0)]['map'](_0x44da29=>{var _0x2c3ce5=_0x7d49f8;_0x2a4818[_0x2c3ce5(0x1a0)]==_0x2c3ce5(0x1af)?_0x44da29[_0x2c3ce5(0x1cd)]==_0x2a4818[_0x2c3ce5(0x1cd)]&&_0x44da29[_0x2c3ce5(0x17c)]==_0x2a4818['bay']&&(_0x44da29['product_stock']=parseInt(_0x44da29[_0x2c3ce5(0x200)])-parseInt(_0x2a4818['adjust_qty'])):_0x44da29[_0x2c3ce5(0x1cd)]==_0x2a4818[_0x2c3ce5(0x1cd)]&&_0x44da29[_0x2c3ce5(0x17c)]==_0x2a4818['bay']&&(_0x44da29[_0x2c3ce5(0x200)]=parseInt(_0x44da29[_0x2c3ce5(0x200)])+parseInt(_0x2a4818['adjust_qty']));});}),await _0x4ed9b8['save'](),_0x575e1c[_0x4a8058(0x166)](_0x4a8058(0x1b5),_0x4a8058(0x159)),_0x4b7f44['redirect']('/adjustment_finished/view');}catch(_0x2f59c6){console['log'](_0x2f59c6);}}),router[a0_0x220bfe(0x1f6)](a0_0x220bfe(0x174),async(_0x127458,_0x167abb)=>{var _0xa5b486=a0_0x220bfe;const {primary_code:_0x52c8f7,warehouse_data:_0x142d1e,rooms_data:_0x1188fb,Roomslist:_0x951249}=_0x127458['body'],_0x3ecd0d=_0x951249[_0xa5b486(0x175)](','),_0x344788=[];async function _0x21de9a(_0x500b84){var _0x467bfb=_0xa5b486;const _0x5303e2=await warehouse[_0x467bfb(0x1fb)]([{'$match':{'name':_0x142d1e,'room':_0x500b84}},{'$unwind':_0x467bfb(0x1e6)},{'$match':{'product_details.primary_code':_0x52c8f7}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x467bfb(0x19f)},'secondary_code':{'$first':_0x467bfb(0x1de)},'product_code':{'$first':_0x467bfb(0x20c)},'level':{'$first':_0x467bfb(0x173)},'isle':{'$first':_0x467bfb(0x1dd)},'type':{'$first':_0x467bfb(0x185)},'pallet':{'$first':_0x467bfb(0x1c2)},'unit':{'$first':_0x467bfb(0x1c7)},'secondary_unit':{'$first':_0x467bfb(0x1bb)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x467bfb(0x1cb)},'production_date':{'$first':_0x467bfb(0x17f)},'batch_code':{'$first':_0x467bfb(0x212)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x467bfb(0x14c)},'roomNamed':{'$first':_0x467bfb(0x1f2)},'invoice':{'$first':_0x467bfb(0x18c)}}}]),_0xf01e5c=await warehouse[_0x467bfb(0x1fb)]([{'$match':{'name':_0x142d1e,'room':_0x500b84}},{'$unwind':_0x467bfb(0x1e6)},{'$match':{'product_details.secondary_code':_0x52c8f7}},{'$group':{'_id':_0x467bfb(0x18f),'name':{'$first':_0x467bfb(0x1e5)},'product_stock':{'$first':_0x467bfb(0x1f4)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x467bfb(0x1de)},'product_code':{'$first':_0x467bfb(0x20c)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x467bfb(0x1dd)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x467bfb(0x1c2)},'unit':{'$first':_0x467bfb(0x1c7)},'secondary_unit':{'$first':_0x467bfb(0x1bb)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x467bfb(0x15e)},'expiry_date':{'$first':_0x467bfb(0x1cb)},'production_date':{'$first':_0x467bfb(0x17f)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x467bfb(0x1f2)},'invoice':{'$first':_0x467bfb(0x18c)}}}]);if(_0x5303e2[_0x467bfb(0x1bf)]>0x0)_0x344788[_0x467bfb(0x204)](_0x5303e2);else _0xf01e5c['length']>0x0&&_0x344788[_0x467bfb(0x204)](_0xf01e5c);}const _0x3bd894=_0x3ecd0d[_0xa5b486(0x1b6)](_0x14317e=>_0x21de9a(_0x14317e));await Promise[_0xa5b486(0x19d)](_0x3bd894),_0x167abb['json'](_0x344788);}),router[a0_0x220bfe(0x1f6)](a0_0x220bfe(0x1d7),async(_0xf2a736,_0x15aa03)=>{var _0x5f4f49=a0_0x220bfe;const {productCode:_0x50813d,bay:_0x56b987,warehouses:_0x4cafff,room:_0x3a10e4}=_0xf2a736['body'];console[_0x5f4f49(0x1ca)](_0xf2a736['body']);try{const _0x33c839=await warehouse[_0x5f4f49(0x1fb)]([{'$match':{'name':_0x4cafff,'room':_0x3a10e4}},{'$unwind':_0x5f4f49(0x1e6)},{'$match':{'product_details.bay':parseInt(_0x56b987)}},{'$group':{'_id':_0x5f4f49(0x18f),'name':{'$first':_0x5f4f49(0x1e5)},'product_stock':{'$first':_0x5f4f49(0x1f4)},'bay':{'$first':_0x5f4f49(0x173)},'maxProducts':{'$first':_0x5f4f49(0x1fd)}}}]);_0x15aa03[_0x5f4f49(0x152)](0xc8)[_0x5f4f49(0x1f3)](_0x33c839);}catch(_0x95b786){_0x15aa03[_0x5f4f49(0x152)](0x194)[_0x5f4f49(0x1f3)]({'message':_0x95b786[_0x5f4f49(0x196)]});}}),module[a0_0x220bfe(0x1a7)]=router;function a0_0xb2d6(_0x5d3129,_0x222b89){var _0x4734f0=a0_0x4734();return a0_0xb2d6=function(_0xb2d604,_0x24f751){_0xb2d604=_0xb2d604-0x148;var _0x253dbf=_0x4734f0[_0xb2d604];return _0x253dbf;},a0_0xb2d6(_0x5d3129,_0x222b89);}function a0_0x4734(){var _0x914830=['render','<h5>','prod_code','Enabled','$product_details.batch_code','../models/all_models','prod_cat','</tbody>','4286475QCcWGQ','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<strong>\x20Regards\x20</strong>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.maxPerUnit','</tr>','<tbody\x20style=\x22text-align:\x20center;\x22>','Logo.png','An\x20error\x20occurred\x20while\x20saving\x20data.','get','status','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Spanish','master','body','error','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','adjustment\x20data\x20update\x20successfully','An\x20error\x20occurred.','</table>','Arabic','date','$product_details.rack','host','image','padStart','/upload/','</head><body>','logo','$date','flash','</thead>','adjustment_finished','DRY\x20GOODS','1971044BqZvIL','../middleware/auth','$product_details.storage','331263RZqRNy','Portuguese','sendMail','finalize','English','batch_code','$product_details.bay','/barcode_scanner','split','purchases_data','Adjustment\x20Finalize\x20Successfully','toString','QA\x20Warehouse','add_adjustment_finished','2djUdNN','bay','string','slice','$product_details.production_date','\x20Order\x20Number\x20:\x20','FGSEmail','5fvADGo','Router','_id','$product_details.type','../public/language/languages.json','prod_name','$name','role','password','$_id','$product_details.invoice','findOne','adjustment\x20add\x20successfull','$product_details._id','then','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','site_title','<tr>','room_names','message','params','French','English\x20(US)','port','$product.room_names','add','all','forEach','$product_details.primary_code','types','createTransport','secondary_unit','product_code','1019809BTbbra','getFullYear','user','exports','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','German','/adjustment/view','Primary_Units','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','language','\x20Order\x20Date\x20:\x20','minus','Ambient','find','getMonth','getDate','Rooms','success','map','Hindi','maxPerUnit','/view/add_adjustment','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.secondary_unit','Secondary_units','product','stock','length','product_details','1230660veaDIb','$product_details.floorlevel','8RSyqqg','ADJF-','/preview/:id','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.unit','New_Qty_Converted_adj','expiry_date','log','$product_details.expiry_date','warehouse_name','product_name','$product','unit','save','adjust_qty','room','production_date','staff','warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/CheckingWarehouse','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<span\x20style=\x22float:\x20right;\x22>','<hr\x20class=\x22my-3\x22>','</body></html>','<div>','$product_details.bin','$product_details.secondary_code','</h5>','18959611TIHBUe','</span>','Finished\x20Goods','227603YRoOZD','/view/:id','$product_details.product_name','$product_details','product_date','prod_invoice','edit_adjustment_finished_view','/adjustment_finished/preview/','Return\x20Rooms','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product.product_name','18qNwgCq','New_Qty_Converted','back','Chinese','$room','json','$product_details.product_stock','email','post','redirect','</div>','Error\x20Occurs','new_adjust_qty','aggregate','level','$product_details.maxProducts','<table\x20style=\x22width:\x20100%\x20!important;\x22>','JO_number','product_stock','catch','<html><head><title></title>','Enclosed','push','note','errors','invoice','findById','Arabic\x20(ae)','<h5\x20style=\x22text-align:\x20left;\x22>','True','$product_details.product_code','Portuguese\x20(BR)'];a0_0x4734=function(){return _0x914830;};return a0_0x4734();}