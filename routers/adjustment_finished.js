var a0_0xee9f14=a0_0x119b;(function(_0x32fc78,_0x67a661){var _0x5cebd1=a0_0x119b,_0x4cea88=_0x32fc78();while(!![]){try{var _0x1860ab=-parseInt(_0x5cebd1(0x247))/0x1*(parseInt(_0x5cebd1(0x1eb))/0x2)+parseInt(_0x5cebd1(0x221))/0x3*(parseInt(_0x5cebd1(0x1f8))/0x4)+-parseInt(_0x5cebd1(0x203))/0x5*(parseInt(_0x5cebd1(0x205))/0x6)+parseInt(_0x5cebd1(0x21a))/0x7+parseInt(_0x5cebd1(0x1c0))/0x8*(parseInt(_0x5cebd1(0x1e0))/0x9)+-parseInt(_0x5cebd1(0x1be))/0xa*(-parseInt(_0x5cebd1(0x237))/0xb)+-parseInt(_0x5cebd1(0x210))/0xc;if(_0x1860ab===_0x67a661)break;else _0x4cea88['push'](_0x4cea88['shift']());}catch(_0x27e078){_0x4cea88['push'](_0x4cea88['shift']());}}}(a0_0x10de,0x7a009));function a0_0x119b(_0x341687,_0x29fa82){var _0x10de20=a0_0x10de();return a0_0x119b=function(_0x119b91,_0x381882){_0x119b91=_0x119b91-0x1ad;var _0xeef207=_0x10de20[_0x119b91];return _0xeef207;},a0_0x119b(_0x341687,_0x29fa82);}function a0_0x10de(){var _0x23e6df=['expiry_date','$room','floor','$product_details.product_code','$product_details.batch_code','render','7112090dTEFxi','English','19072aUGWTk','$product','get','New_Qty_Converted','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','log','$product_details.primary_code','<h5\x20style=\x22text-align:\x20left;\x22>','<h2>\x20','Arabic\x20(ae)','master','Secondary_units','Adjustment\x20Finalize\x20Successfully','</span>','$product_details.product_stock','slice','nodemailer','</td>','$_id','image','$product_details.bin','redirect','success','findOne','port','prod_code','$product_details','<html><head><title></title>','_id','purchases_data','<span\x20style=\x22float:\x20right;\x22>','params','1854aVpQzh','edit_adjustment_finished_view','product_code','Primary_Units','Return\x20Rooms','adjust_qty','stock','</h5>','/adjustment_finished/view','getDate','exports','27350LwJdjC','$product_details.product_name','/upload/','Portuguese\x20(BR)','edit_adjustment_finished','site_title','bay','Adjustment\x20Mail','sendMail','push','$product_details._id','</thead>','post','56uIIRbk','$product_details.secondary_code','$product_details.expiry_date','minus','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/adjustment_finished/preview/','../public/language/languages.json','<div>','../models/all_models','forEach','then','40130TqSPiY','Email\x20sent\x20successfully','564rXazGH','/adjustment/view','/picking_list/PDF_adjustment/','/preview/:id','createTransport','Hindi','padStart','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','role','invoice','Ambient','7324524QZbZkS','<tr>','stockBefore','German','Arabic','Portuguese','level','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','adjustment\x20add\x20successfull','back','1944600ccnKmg','product_date','Enclosed','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.floorlevel','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','toString','85308kquRiI','find','add_adjustment_finished','True','date','$product_details.maxPerUnit','product_stock','catch','$invoice','Finished\x20Goods','unit','Chinese','product','Spanish','Rooms','</head><body>','$product_details.unit','/view/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','prod_cat','/view/add_adjustment','\x20Order\x20Date\x20:\x20','11MqOlyf','English\x20(US)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','getFullYear','host','body','add','An\x20error\x20occurred\x20while\x20saving\x20data.','/barcode_scanner','$product_details.rack','email','findById','flash','Logo.png','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','foreach\x20newproduct','1OZmExa','$product_details.secondary_unit','save','warehouse','json','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','French','staff','finalize','</body></html>','QA\x20Warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','password','/../public','New_Qty_Converted_adj','all','</tr>','room_names','warehouse_name','$product.room_names','secondary_unit','types','production_date','<!DOCTYPE\x20html>','$product_details.storage','aggregate','FGSEmail','room','adjustment\x20data\x20update\x20successfully','ADJF-','prod_invoice','errors','Enabled','adjustment_finished','product_name','length','</tbody>','error','$product_details.bay','map','user','prod_name','status','new_adjust_qty','$product_details.invoice','filter','maxPerUnit','message','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','batch_code','An\x20error\x20occurred.','$product_details.type','../middleware/auth','Error\x20Occurs','</div>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','product_details','$name','string','$product.product_name'];a0_0x10de=function(){return _0x23e6df;};return a0_0x10de();}const express=require('express'),app=express(),router=express['Router'](),auth=require(a0_0xee9f14(0x1b0)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0xee9f14(0x200)),users=require(a0_0xee9f14(0x1fe)),nodemailer=require(a0_0xee9f14(0x1d0));router[a0_0xee9f14(0x1c2)]('/view',auth,async(_0x320ff0,_0x554b04)=>{var _0x99726d=a0_0xee9f14;try{const {username:_0x40fa8f,email:_0x28eb21,role:_0x2f3b0d}=_0x320ff0[_0x99726d(0x26f)],_0x465051=_0x320ff0[_0x99726d(0x26f)],_0x4093f3=await profile['findOne']({'email':_0x465051[_0x99726d(0x241)]}),_0x4a8ad7=await master_shop[_0x99726d(0x222)]();let _0x1b0ec3;if(_0x465051[_0x99726d(0x20d)]==_0x99726d(0x24e)){const _0x21802c=await staff[_0x99726d(0x1d7)]({'email':_0x465051[_0x99726d(0x241)]});_0x1b0ec3=await warehouse[_0x99726d(0x222)]({'status':_0x99726d(0x267),'name':_0x21802c[_0x99726d(0x24a)]});}else _0x1b0ec3=await warehouse[_0x99726d(0x222)]({'status':_0x99726d(0x267)});const _0x31e891=await product[_0x99726d(0x222)]();let _0x2ffb4b;if(_0x465051[_0x99726d(0x20d)]==_0x99726d(0x24e)){const _0x2a6a95=await staff[_0x99726d(0x1d7)]({'email':_0x465051[_0x99726d(0x241)]});_0x2ffb4b=await adjustment_finished[_0x99726d(0x222)]({'warehouse_name':_0x2a6a95[_0x99726d(0x24a)]});}else _0x2ffb4b=await adjustment_finished[_0x99726d(0x260)]([{'$unwind':_0x99726d(0x1c1)},{'$group':{'_id':_0x99726d(0x1d2),'invoice':{'$first':_0x99726d(0x229)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x99726d(0x25a)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x4a8ad7[0x0][_0x99726d(0x277)]==_0x99726d(0x238)){var _0x54cff9=users[_0x99726d(0x1bf)];console[_0x99726d(0x1c5)](_0x54cff9);}else{if(_0x4a8ad7[0x0][_0x99726d(0x277)]==_0x99726d(0x20a))var _0x54cff9=users[_0x99726d(0x20a)];else{if(_0x4a8ad7[0x0][_0x99726d(0x277)]==_0x99726d(0x213))var _0x54cff9=users['German'];else{if(_0x4a8ad7[0x0][_0x99726d(0x277)]==_0x99726d(0x22e))var _0x54cff9=users[_0x99726d(0x22e)];else{if(_0x4a8ad7[0x0][_0x99726d(0x277)]==_0x99726d(0x24d))var _0x54cff9=users['French'];else{if(_0x4a8ad7[0x0][_0x99726d(0x277)]==_0x99726d(0x1ee))var _0x54cff9=users[_0x99726d(0x215)];else{if(_0x4a8ad7[0x0][_0x99726d(0x277)]=='Chinese')var _0x54cff9=users['Chinese'];else{if(_0x4a8ad7[0x0][_0x99726d(0x277)]==_0x99726d(0x1c9))var _0x54cff9=users['Arabic'];}}}}}}}_0x554b04[_0x99726d(0x1bd)](_0x99726d(0x268),{'success':_0x320ff0[_0x99726d(0x243)](_0x99726d(0x1d6)),'errors':_0x320ff0['flash'](_0x99726d(0x266)),'role':_0x465051,'profile':_0x4093f3,'warehouse':_0x1b0ec3,'product':_0x31e891,'adjustment':_0x2ffb4b,'master_shop':_0x4a8ad7,'language':_0x54cff9});}catch(_0x49067e){console[_0x99726d(0x1c5)](_0x49067e);}});async function getRandom8DigitNumber(){var _0x12c3ab=a0_0xee9f14;const _0x2ee80a=0x989680,_0x47f9bf=0x5f5e0ff,_0x41265d=Math[_0x12c3ab(0x1ba)](Math['random']()*(_0x47f9bf-_0x2ee80a+0x1))+_0x2ee80a;var _0x386f97;const _0x35eece=await adjustment_finished['findOne']({'invoice':_0x12c3ab(0x264)+_0x41265d});return _0x35eece&&_0x35eece[_0x12c3ab(0x26a)]>0x0?_0x386f97='ADJF-'+_0x41265d:_0x386f97=_0x12c3ab(0x264)+_0x41265d,_0x386f97;}router[a0_0xee9f14(0x1c2)](a0_0xee9f14(0x235),auth,async(_0x521ddf,_0x5059a3)=>{var _0x4177e3=a0_0xee9f14;try{const {username:_0x463d46,email:_0x21b380,role:_0x4aed11}=_0x521ddf[_0x4177e3(0x26f)],_0x48234f=_0x521ddf[_0x4177e3(0x26f)],_0x2c0e57=await profile[_0x4177e3(0x1d7)]({'email':_0x48234f[_0x4177e3(0x241)]}),_0x1d2b63=await master_shop[_0x4177e3(0x222)]();let _0x4781e0;if(_0x48234f['role']=='staff'){const _0x4b1e9a=await staff[_0x4177e3(0x1d7)]({'email':_0x48234f[_0x4177e3(0x241)]});_0x4781e0=await warehouse[_0x4177e3(0x260)]([{'$match':{'status':_0x4177e3(0x267),'name':_0x4b1e9a[_0x4177e3(0x24a)],'warehouse_category':_0x4177e3(0x22a),'name':{'$ne':_0x4177e3(0x251)}}},{'$group':{'_id':_0x4177e3(0x1b5),'name':{'$first':_0x4177e3(0x1b5)}}}]);}else _0x4781e0=await warehouse[_0x4177e3(0x260)]([{'$match':{'status':_0x4177e3(0x267),'warehouse_category':_0x4177e3(0x22a),'name':{'$ne':_0x4177e3(0x251)}}},{'$group':{'_id':_0x4177e3(0x1b5),'name':{'$first':'$name'}}}]);const _0x124308=await product[_0x4177e3(0x222)]({}),_0x8b5332=await adjustment_finished[_0x4177e3(0x222)]({}),_0x2cf235=_0x8b5332['length']+0x1,_0xd73082=_0x4177e3(0x264)+_0x2cf235[_0x4177e3(0x220)]()[_0x4177e3(0x20b)](0x5,'0');var _0x48118e=[_0x4177e3(0x20f),_0x4177e3(0x21c),_0x4177e3(0x1e4)];if(_0x1d2b63[0x0][_0x4177e3(0x277)]==_0x4177e3(0x238))var _0x3ac3b6=users[_0x4177e3(0x1bf)];else{if(_0x1d2b63[0x0][_0x4177e3(0x277)]==_0x4177e3(0x20a))var _0x3ac3b6=users[_0x4177e3(0x20a)];else{if(_0x1d2b63[0x0][_0x4177e3(0x277)]==_0x4177e3(0x213))var _0x3ac3b6=users['German'];else{if(_0x1d2b63[0x0]['language']=='Spanish')var _0x3ac3b6=users[_0x4177e3(0x22e)];else{if(_0x1d2b63[0x0][_0x4177e3(0x277)]==_0x4177e3(0x24d))var _0x3ac3b6=users['French'];else{if(_0x1d2b63[0x0]['language']==_0x4177e3(0x1ee))var _0x3ac3b6=users[_0x4177e3(0x215)];else{if(_0x1d2b63[0x0][_0x4177e3(0x277)]=='Chinese')var _0x3ac3b6=users[_0x4177e3(0x22c)];else{if(_0x1d2b63[0x0][_0x4177e3(0x277)]==_0x4177e3(0x1c9))var _0x3ac3b6=users[_0x4177e3(0x214)];}}}}}}}const _0x1a2dd7=getRandom8DigitNumber();_0x1a2dd7[_0x4177e3(0x202)](_0x161136=>{var _0x3b49b6=_0x4177e3;_0x5059a3[_0x3b49b6(0x1bd)](_0x3b49b6(0x223),{'success':_0x521ddf[_0x3b49b6(0x243)]('success'),'errors':_0x521ddf[_0x3b49b6(0x243)](_0x3b49b6(0x266)),'role':_0x48234f,'profile':_0x2c0e57,'warehouse':_0x4781e0,'product':_0x124308,'master_shop':_0x1d2b63,'language':_0x3ac3b6,'rooms_data':_0x48118e,'invoice_no':_0x161136});})[_0x4177e3(0x228)](_0x595229=>{var _0x48ef9b=_0x4177e3;_0x521ddf['flash'](_0x48ef9b(0x266),_0x48ef9b(0x1fc)),_0x5059a3['redirect'](_0x48ef9b(0x206));});}catch(_0x4bdc84){console['log'](_0x4bdc84);}}),router[a0_0xee9f14(0x1f7)](a0_0xee9f14(0x235),auth,async(_0x3cf13f,_0x2f450e)=>{var _0x33c1ea=a0_0xee9f14;try{const {warehouse_name:_0x23f6d1,date:_0x17819f,prod_name:_0xa3191a,level:_0x44aaac,isle:_0x344651,pallet:_0x5c2677,stock:_0xee6c6e,types:_0x7bcfd4,adjust_qty:_0x57d19f,new_adjust_qty:_0x29f26e,note:_0x3ce320,Room_name:_0x4fc78f,invoice:_0x2e1a75,JO_number:_0x24bd4d,expiry_date:_0x2e6f18}=_0x3cf13f[_0x33c1ea(0x23c)];if(typeof _0xa3191a==_0x33c1ea(0x1b6))var _0x254f72=[_0x3cf13f['body'][_0x33c1ea(0x270)]],_0x58acb0=[_0x3cf13f['body']['level']],_0x4a1509=[_0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x1e6)]],_0x448c95=[_0x3cf13f['body'][_0x33c1ea(0x25c)]],_0x5e51f0=[_0x3cf13f[_0x33c1ea(0x23c)]['New_Qty_Converted_adj']],_0x3960d4=[_0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x1c3)]],_0x182727=[_0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x1e3)]],_0x3005c1=[_0x3cf13f[_0x33c1ea(0x23c)]['Secondary_units']],_0x2a02f8=[_0x3cf13f[_0x33c1ea(0x23c)]['prod_code']],_0x214879=[_0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x1ad)]],_0x166594=[_0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x1b8)]],_0x1c7c36=[_0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x21b)]],_0xc2fac=[_0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x234)]],_0x1cdfdf=[_0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x22f)]],_0x40b752=[_0x3cf13f[_0x33c1ea(0x23c)]['maxPerUnit']],_0x2f1a71=[_0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x265)]];else var _0x254f72=[..._0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x270)]],_0x58acb0=[..._0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x216)]],_0x4a1509=[..._0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x1e6)]],_0x448c95=[..._0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x25c)]],_0x5e51f0=[..._0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x255)]],_0x3960d4=[..._0x3cf13f[_0x33c1ea(0x23c)]['New_Qty_Converted']],_0x182727=[..._0x3cf13f[_0x33c1ea(0x23c)]['Primary_Units']],_0x3005c1=[..._0x3cf13f['body']['Secondary_units']],_0x2a02f8=[..._0x3cf13f['body'][_0x33c1ea(0x1d9)]],_0x214879=[..._0x3cf13f['body']['batch_code']],_0x166594=[..._0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x1b8)]],_0x1c7c36=[..._0x3cf13f['body']['product_date']],_0xc2fac=[..._0x3cf13f['body'][_0x33c1ea(0x234)]],_0x1cdfdf=[..._0x3cf13f[_0x33c1ea(0x23c)]['Rooms']],_0x40b752=[..._0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x275)]],_0x2f1a71=[..._0x3cf13f[_0x33c1ea(0x23c)][_0x33c1ea(0x265)]];const _0x1a6e9e=_0x254f72[_0x33c1ea(0x26e)](_0x4e68f2=>{return _0x4e68f2={'product_name':_0x4e68f2};});_0x58acb0['forEach']((_0x4cc94b,_0x7372df)=>{var _0x9c173f=_0x33c1ea;_0x1a6e9e[_0x7372df][_0x9c173f(0x1f1)]=_0x4cc94b;}),_0x4a1509[_0x33c1ea(0x201)]((_0x36bb02,_0x213960)=>{var _0x1a4971=_0x33c1ea;_0x1a6e9e[_0x213960][_0x1a4971(0x212)]=_0x36bb02;}),_0x448c95[_0x33c1ea(0x201)]((_0x100b84,_0x57ac4e)=>{var _0xbe67d0=_0x33c1ea;_0x1a6e9e[_0x57ac4e][_0xbe67d0(0x25c)]=_0x100b84;}),_0x5e51f0[_0x33c1ea(0x201)]((_0x5a0e4a,_0x4f5726)=>{_0x1a6e9e[_0x4f5726]['adjust_qty']=_0x5a0e4a;}),_0x3960d4[_0x33c1ea(0x201)]((_0x5d2a9b,_0x4bfb42)=>{_0x1a6e9e[_0x4bfb42]['new_adjust_qty']=_0x5d2a9b;}),_0x182727[_0x33c1ea(0x201)]((_0xf064ae,_0x2e7761)=>{var _0x1783d6=_0x33c1ea;_0x1a6e9e[_0x2e7761][_0x1783d6(0x22b)]=_0xf064ae;}),_0x3005c1[_0x33c1ea(0x201)]((_0x49243c,_0x4e0a41)=>{var _0x2eb11f=_0x33c1ea;_0x1a6e9e[_0x4e0a41][_0x2eb11f(0x25b)]=_0x49243c;}),_0x2a02f8[_0x33c1ea(0x201)]((_0xe7f049,_0x134729)=>{var _0x4934a9=_0x33c1ea;_0x1a6e9e[_0x134729][_0x4934a9(0x1e2)]=_0xe7f049;}),_0x214879['forEach']((_0x3cea47,_0x3f3d57)=>{var _0x390aa0=_0x33c1ea;_0x1a6e9e[_0x3f3d57][_0x390aa0(0x1ad)]=_0x3cea47;}),_0x166594[_0x33c1ea(0x201)]((_0x160734,_0xce955c)=>{var _0x5cd132=_0x33c1ea;_0x1a6e9e[_0xce955c][_0x5cd132(0x1b8)]=_0x160734;}),_0x1c7c36['forEach']((_0x249734,_0x5a3716)=>{var _0x3cf21b=_0x33c1ea;_0x1a6e9e[_0x5a3716][_0x3cf21b(0x25d)]=_0x249734;}),_0xc2fac[_0x33c1ea(0x201)]((_0x3f73c7,_0x4386dc)=>{var _0x4b8234=_0x33c1ea;_0x1a6e9e[_0x4386dc][_0x4b8234(0x234)]=_0x3f73c7;}),_0x1cdfdf[_0x33c1ea(0x201)]((_0xed10b5,_0x1599ef)=>{var _0x5c7ac6=_0x33c1ea;_0x1a6e9e[_0x1599ef][_0x5c7ac6(0x258)]=_0xed10b5;}),_0x40b752[_0x33c1ea(0x201)]((_0x36d822,_0x40384f)=>{var _0x543e04=_0x33c1ea;_0x1a6e9e[_0x40384f][_0x543e04(0x275)]=_0x36d822;}),_0x2f1a71[_0x33c1ea(0x201)]((_0x393a42,_0x592dd5)=>{var _0x2bef43=_0x33c1ea;_0x1a6e9e[_0x592dd5][_0x2bef43(0x20e)]=_0x393a42;});const _0xfe062a=_0x1a6e9e[_0x33c1ea(0x274)](_0x1058f2=>_0x1058f2[_0x33c1ea(0x1e5)]!=='0'&&_0x1058f2[_0x33c1ea(0x1e5)]!=='');var _0x5f3b7d=0x0;_0xfe062a[_0x33c1ea(0x201)](_0x4077ca=>{var _0x151856=_0x33c1ea;console[_0x151856(0x1c5)](_0x151856(0x246),_0x4077ca),parseInt(_0x4077ca[_0x151856(0x1e5)])<=0x0&&_0x5f3b7d++;});if(_0x5f3b7d!=0x0)return _0x3cf13f[_0x33c1ea(0x243)]('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x2f450e[_0x33c1ea(0x1d5)]('back');const _0x6c6bad=new adjustment_finished({'warehouse_name':_0x23f6d1,'date':_0x17819f,'product':_0xfe062a,'note':_0x3ce320,'room':_0x4fc78f,'invoice':_0x2e1a75,'JO_number':_0x24bd4d,'expiry_date':_0x2e6f18}),_0x229b8e=await _0x6c6bad['save']();_0x3cf13f['flash'](_0x33c1ea(0x1d6),_0x33c1ea(0x218)),_0x2f450e['redirect'](_0x33c1ea(0x1fd)+_0x229b8e[_0x33c1ea(0x1dc)]);}catch(_0xfdb3a5){console['log'](_0xfdb3a5),_0x2f450e['status'](0xc8)[_0x33c1ea(0x24b)]({'message':_0xfdb3a5[_0x33c1ea(0x276)]});}}),router[a0_0xee9f14(0x1c2)](a0_0xee9f14(0x208),auth,async(_0x238f8a,_0x357798)=>{var _0xc1e0c7=a0_0xee9f14;try{const {username:_0x532ba7,email:_0x86d4c8,role:_0x1cc430}=_0x238f8a['user'],_0x8f0f6b=_0x238f8a[_0xc1e0c7(0x26f)],_0x5674c4=await profile[_0xc1e0c7(0x1d7)]({'email':_0x8f0f6b[_0xc1e0c7(0x241)]}),_0x59a21=await master_shop['find'](),_0xa1bb22=_0x238f8a[_0xc1e0c7(0x1df)]['id'],_0x15fad4=await adjustment_finished[_0xc1e0c7(0x242)]({'_id':_0xa1bb22}),_0x993b9=await purchases['aggregate']([{'$match':{'warehouse_name':_0x15fad4[_0xc1e0c7(0x259)]}},{'$unwind':_0xc1e0c7(0x1c1)},{'$group':{'_id':_0xc1e0c7(0x1b7)}}]);console['log']('purchases_data',_0x993b9);const _0x423344=await product[_0xc1e0c7(0x222)]({}),_0x4e8a66=await warehouse[_0xc1e0c7(0x260)]([{'$match':{'name':_0x15fad4[_0xc1e0c7(0x259)],'warehouse_category':_0xc1e0c7(0x22a)}},{'$unwind':_0xc1e0c7(0x1da)},{'$group':{'_id':_0xc1e0c7(0x1f5),'name':{'$first':_0xc1e0c7(0x1ec)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xc1e0c7(0x26d)},'bin':{'$first':_0xc1e0c7(0x1d4)},'type':{'$first':_0xc1e0c7(0x1af)},'floorlevel':{'$first':_0xc1e0c7(0x21e)},'primary_code':{'$first':_0xc1e0c7(0x1c6)},'secondary_code':{'$first':_0xc1e0c7(0x1f9)},'product_code':{'$first':_0xc1e0c7(0x1bb)},'storage':{'$first':_0xc1e0c7(0x25f)},'rack':{'$first':_0xc1e0c7(0x240)},'expiry_date':{'$first':_0xc1e0c7(0x1fa)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':_0xc1e0c7(0x1b9)}}}]);if(_0x59a21[0x0][_0xc1e0c7(0x277)]=='English\x20(US)'){var _0x3e6a3b=users[_0xc1e0c7(0x1bf)];console['log'](_0x3e6a3b);}else{if(_0x59a21[0x0][_0xc1e0c7(0x277)]==_0xc1e0c7(0x20a))var _0x3e6a3b=users[_0xc1e0c7(0x20a)];else{if(_0x59a21[0x0][_0xc1e0c7(0x277)]==_0xc1e0c7(0x213))var _0x3e6a3b=users[_0xc1e0c7(0x213)];else{if(_0x59a21[0x0][_0xc1e0c7(0x277)]==_0xc1e0c7(0x22e))var _0x3e6a3b=users[_0xc1e0c7(0x22e)];else{if(_0x59a21[0x0][_0xc1e0c7(0x277)]==_0xc1e0c7(0x24d))var _0x3e6a3b=users['French'];else{if(_0x59a21[0x0][_0xc1e0c7(0x277)]==_0xc1e0c7(0x1ee))var _0x3e6a3b=users['Portuguese'];else{if(_0x59a21[0x0][_0xc1e0c7(0x277)]==_0xc1e0c7(0x22c))var _0x3e6a3b=users['Chinese'];else{if(_0x59a21[0x0][_0xc1e0c7(0x277)]==_0xc1e0c7(0x1c9))var _0x3e6a3b=users[_0xc1e0c7(0x214)];}}}}}}}_0x357798['render'](_0xc1e0c7(0x1e1),{'success':_0x238f8a[_0xc1e0c7(0x243)](_0xc1e0c7(0x1d6)),'errors':_0x238f8a[_0xc1e0c7(0x243)](_0xc1e0c7(0x266)),'role':_0x8f0f6b,'profile':_0x5674c4,'adjustment':_0x15fad4,'stock':_0x4e8a66,'master_shop':_0x59a21,'warehouse_name':_0x993b9,'unit':_0x423344,'language':_0x3e6a3b});}catch(_0x38b59b){console['log'](_0x38b59b),_0x357798[_0xc1e0c7(0x271)](0xc8)['json']({'message':_0x38b59b[_0xc1e0c7(0x276)]});}}),router[a0_0xee9f14(0x1f7)](a0_0xee9f14(0x208),auth,async(_0x3d7383,_0xf277bb)=>{var _0x381cb2=a0_0xee9f14;try{const {invoice:_0x48b1cf,warehouse_name:_0x293b65,Room_name:_0x5a3305}=_0x3d7383['body'],_0x403e65=_0x3d7383[_0x381cb2(0x1df)]['id'],_0x52a1c7=await adjustment_finished[_0x381cb2(0x242)]({'_id':_0x403e65});var _0x18452a;const _0x161573=_0x52a1c7['product'][_0x381cb2(0x26e)](async _0x57809c=>{var _0x2ca6dc=_0x381cb2;if(_0x57809c[_0x2ca6dc(0x1e5)]>0x0){_0x18452a=await warehouse['findOne']({'name':_0x293b65,'room':_0x57809c[_0x2ca6dc(0x258)],'warehouse_category':_0x2ca6dc(0x22a)});const _0x3792c0=_0x18452a['product_details']['map'](_0x10294d=>{var _0x39e45b=_0x2ca6dc;console[_0x39e45b(0x1c5)](_0x57809c['types']);if(_0x57809c['types']==_0x39e45b(0x1fb))_0x10294d[_0x39e45b(0x269)]==_0x57809c['product_name']&&_0x10294d[_0x39e45b(0x1f1)]==_0x57809c[_0x39e45b(0x1f1)]&&_0x10294d[_0x39e45b(0x1b8)]==_0x57809c[_0x39e45b(0x1b8)]&&_0x10294d['production_date']==_0x57809c[_0x39e45b(0x25d)]&&_0x10294d['batch_code']==_0x57809c[_0x39e45b(0x1ad)]&&_0x10294d[_0x39e45b(0x20e)]==_0x57809c[_0x39e45b(0x20e)]&&(_0x10294d[_0x39e45b(0x227)]=_0x10294d[_0x39e45b(0x227)]-_0x57809c[_0x39e45b(0x1e5)]);else _0x57809c[_0x39e45b(0x25c)]==_0x39e45b(0x23d)&&(_0x10294d['product_name']==_0x57809c[_0x39e45b(0x269)]&&_0x10294d[_0x39e45b(0x1f1)]==_0x57809c['bay']&&_0x10294d[_0x39e45b(0x1b8)]==_0x57809c[_0x39e45b(0x1b8)]&&_0x10294d[_0x39e45b(0x25d)]==_0x57809c[_0x39e45b(0x25d)]&&_0x10294d[_0x39e45b(0x1ad)]==_0x57809c[_0x39e45b(0x1ad)]&&_0x10294d[_0x39e45b(0x20e)]==_0x57809c[_0x39e45b(0x20e)]&&(_0x10294d[_0x39e45b(0x227)]=_0x10294d[_0x39e45b(0x227)]+_0x57809c[_0x39e45b(0x1e5)]));});}return _0x18452a;});Promise[_0x381cb2(0x256)](_0x161573)[_0x381cb2(0x202)](async _0x2a20f4=>{var _0x447cab=_0x381cb2;try{for(const _0x4b5aa2 of _0x2a20f4){await _0x4b5aa2['save']();}_0x52a1c7[_0x447cab(0x24f)]=_0x447cab(0x224);const _0x2742d7=await _0x52a1c7[_0x447cab(0x249)](),_0x102357=await master_shop[_0x447cab(0x222)](),_0x2c03a6=await email_settings[_0x447cab(0x1d7)](),_0xdacd36=await supervisor_settings['find']();var _0x54734d=_0x52a1c7[_0x447cab(0x22d)],_0x3186b3='',_0x1bb385;for(_0x1bb385 in _0x54734d){var _0x3f1040='FG';_0x52a1c7[_0x447cab(0x259)]=='DRY\x20GOODS'&&(_0x3f1040='DG'),_0x3186b3+=_0x447cab(0x211)+_0x447cab(0x217)+_0x54734d[_0x1bb385][_0x447cab(0x269)]+_0x447cab(0x1d1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54734d[_0x1bb385][_0x447cab(0x1e2)]+'</td>'+_0x447cab(0x217)+_0x54734d[_0x1bb385][_0x447cab(0x1e5)]+_0x447cab(0x1d1)+_0x447cab(0x217)+_0x54734d[_0x1bb385][_0x447cab(0x22b)]+_0x447cab(0x1d1)+_0x447cab(0x217)+_0x54734d[_0x1bb385][_0x447cab(0x25b)]+_0x447cab(0x1d1)+_0x447cab(0x217)+_0x52a1c7['warehouse_name']+_0x447cab(0x1d1)+_0x447cab(0x217)+_0x54734d[_0x1bb385]['room_names']+_0x447cab(0x1d1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3f1040+_0x54734d[_0x1bb385]['bay']+_0x447cab(0x1d1)+_0x447cab(0x257);}let _0x17830d=nodemailer[_0x447cab(0x209)]({'host':_0x2c03a6[_0x447cab(0x23b)],'port':Number(_0x2c03a6[_0x447cab(0x1d8)]),'secure':![],'auth':{'user':_0x2c03a6[_0x447cab(0x241)],'pass':_0x2c03a6[_0x447cab(0x253)]}}),_0x5961f5={'from':_0x2c03a6['email'],'to':_0xdacd36[0x0][_0x447cab(0x261)],'subject':_0x447cab(0x1f2),'attachments':[{'filename':_0x447cab(0x244),'path':__dirname+_0x447cab(0x254)+_0x447cab(0x1ed)+_0x102357[0x0][_0x447cab(0x1d3)],'cid':'logo'}],'html':_0x447cab(0x25e)+_0x447cab(0x1db)+_0x447cab(0x230)+'<div>'+_0x447cab(0x21d)+'<div>'+_0x447cab(0x245)+_0x447cab(0x1b2)+_0x447cab(0x1ff)+_0x447cab(0x1c8)+_0x102357[0x0][_0x447cab(0x1f0)]+'\x20</h2>'+_0x447cab(0x1b2)+_0x447cab(0x1b2)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x447cab(0x1c7)+'\x20Order\x20Number\x20:\x20'+_0x52a1c7['invoice']+'\x20'+_0x447cab(0x1de)+_0x447cab(0x236)+_0x52a1c7[_0x447cab(0x225)]+'\x20'+_0x447cab(0x1cd)+_0x447cab(0x1e7)+_0x447cab(0x1b2)+_0x447cab(0x1b3)+_0x447cab(0x24c)+'<tr>'+_0x447cab(0x233)+_0x447cab(0x278)+_0x447cab(0x252)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x447cab(0x20c)+_0x447cab(0x239)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x447cab(0x1c4)+_0x447cab(0x257)+_0x447cab(0x1f6)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x3186b3+'\x20'+_0x447cab(0x26b)+'</table>'+_0x447cab(0x1ff)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x102357[0x0][_0x447cab(0x1f0)]+_0x447cab(0x1e7)+_0x447cab(0x1b2)+_0x447cab(0x1b2)+_0x447cab(0x250)};_0x17830d[_0x447cab(0x1f3)](_0x5961f5,function(_0x47d051,_0x2d5c08){var _0x3a29b9=_0x447cab;_0x47d051?(console[_0x3a29b9(0x1c5)](_0x47d051),console['log'](_0x3a29b9(0x1b1))):console[_0x3a29b9(0x1c5)](_0x3a29b9(0x204));}),_0x3d7383[_0x447cab(0x243)](_0x447cab(0x1d6),_0x447cab(0x1cc)),_0xf277bb['redirect'](_0x447cab(0x207)+_0x2742d7[_0x447cab(0x1dc)]);}catch(_0x1295b5){console[_0x447cab(0x26c)](_0x1295b5),_0xf277bb[_0x447cab(0x271)](0x1f4)[_0x447cab(0x24b)]({'error':_0x447cab(0x23e)});}})[_0x381cb2(0x228)](_0x2dbe05=>{var _0x30ca14=_0x381cb2;console['error'](_0x2dbe05),_0xf277bb['status'](0x1f4)[_0x30ca14(0x24b)]({'error':_0x30ca14(0x1ae)});});}catch(_0x4461a3){_0xf277bb[_0x381cb2(0x24b)]({'message':_0x4461a3[_0x381cb2(0x276)]});}}),router[a0_0xee9f14(0x1c2)](a0_0xee9f14(0x232),auth,async(_0x3fa773,_0x24cabc)=>{var _0x510d1e=a0_0xee9f14;try{const {username:_0x4330c2,email:_0x52fdd7,role:_0x2bad99}=_0x3fa773[_0x510d1e(0x26f)],_0x34e565=_0x3fa773[_0x510d1e(0x26f)],_0x3c3edb=await profile['findOne']({'email':_0x34e565['email']}),_0x4f70c1=await master_shop[_0x510d1e(0x222)]();console['log'](_0x510d1e(0x1ca),_0x4f70c1);const _0x284970=_0x3fa773['params']['id'],_0x45bdce=await adjustment_finished[_0x510d1e(0x242)]({'_id':_0x284970});let _0x113eac=new Date(_0x45bdce[_0x510d1e(0x1b8)]),_0x329bc8=('0'+_0x113eac[_0x510d1e(0x1e9)]())[_0x510d1e(0x1cf)](-0x2),_0x30f411=('0'+(_0x113eac['getMonth']()+0x1))['slice'](-0x2),_0x1f5af0=_0x113eac[_0x510d1e(0x23a)](),_0x3a7275=_0x1f5af0+'-'+_0x30f411+'-'+_0x329bc8;var _0x42d520=[_0x510d1e(0x20f),_0x510d1e(0x21c),_0x510d1e(0x1e4)];const _0x29e388=await purchases[_0x510d1e(0x260)]([{'$match':{'warehouse_name':_0x45bdce[_0x510d1e(0x259)]}},{'$unwind':'$product'},{'$group':{'_id':_0x510d1e(0x1b7)}}]);console['log'](_0x510d1e(0x1dd),_0x29e388);const _0x1ab80d=await product[_0x510d1e(0x222)]({}),_0x268a34=await warehouse[_0x510d1e(0x260)]([{'$match':{'name':_0x45bdce['warehouse_name'],'room':_0x45bdce[_0x510d1e(0x262)]}},{'$unwind':_0x510d1e(0x1da)},{'$group':{'_id':_0x510d1e(0x1f5),'name':{'$first':_0x510d1e(0x1ec)},'product_stock':{'$first':_0x510d1e(0x1ce)},'bay':{'$first':_0x510d1e(0x26d)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x510d1e(0x1af)},'floorlevel':{'$first':_0x510d1e(0x21e)},'primary_code':{'$first':_0x510d1e(0x1c6)},'secondary_code':{'$first':_0x510d1e(0x1f9)},'product_code':{'$first':_0x510d1e(0x1bb)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x510d1e(0x240)}}}]);if(_0x4f70c1[0x0][_0x510d1e(0x277)]=='English\x20(US)'){var _0x4ede6a=users[_0x510d1e(0x1bf)];console[_0x510d1e(0x1c5)](_0x4ede6a);}else{if(_0x4f70c1[0x0][_0x510d1e(0x277)]==_0x510d1e(0x20a))var _0x4ede6a=users[_0x510d1e(0x20a)];else{if(_0x4f70c1[0x0][_0x510d1e(0x277)]=='German')var _0x4ede6a=users['German'];else{if(_0x4f70c1[0x0][_0x510d1e(0x277)]=='Spanish')var _0x4ede6a=users['Spanish'];else{if(_0x4f70c1[0x0]['language']==_0x510d1e(0x24d))var _0x4ede6a=users[_0x510d1e(0x24d)];else{if(_0x4f70c1[0x0][_0x510d1e(0x277)]==_0x510d1e(0x1ee))var _0x4ede6a=users[_0x510d1e(0x215)];else{if(_0x4f70c1[0x0]['language']==_0x510d1e(0x22c))var _0x4ede6a=users[_0x510d1e(0x22c)];else{if(_0x4f70c1[0x0][_0x510d1e(0x277)]=='Arabic\x20(ae)')var _0x4ede6a=users[_0x510d1e(0x214)];}}}}}}}_0x24cabc[_0x510d1e(0x1bd)](_0x510d1e(0x1ef),{'success':_0x3fa773[_0x510d1e(0x243)](_0x510d1e(0x1d6)),'errors':_0x3fa773['flash'](_0x510d1e(0x266)),'role':_0x34e565,'profile':_0x3c3edb,'adjustment':_0x45bdce,'stock':_0x268a34,'master_shop':_0x4f70c1,'warehouse_name':_0x29e388,'unit':_0x1ab80d,'language':_0x4ede6a,'rooms_data':_0x42d520,'ed_fullDate':_0x3a7275});}catch(_0x58bcb2){console['log'](_0x58bcb2),_0x24cabc[_0x510d1e(0x271)](0xc8)['json']({'message':_0x58bcb2[_0x510d1e(0x276)]});}}),router['post'](a0_0xee9f14(0x232),auth,async(_0xb546c5,_0x4843f0)=>{var _0x277f1c=a0_0xee9f14;try{const _0x5d5562=_0xb546c5[_0x277f1c(0x1df)]['id'],_0x638910=await adjustment_finished[_0x277f1c(0x242)]({'_id':_0x5d5562}),_0x355091=await warehouse['findOne']({'name':_0x638910[_0x277f1c(0x259)],'room':_0x638910[_0x277f1c(0x262)]}),{warehouse_name:_0x1c9135,date:_0x16bc96,prod_name:_0x3515eb,level:_0x1c2c75,isle:_0x4fc34b,pallet:_0x586d41,stock:_0x37d188,types:_0x292f67,adjust_qty:_0x197de6,new_adjust_qty:_0x33e6a7,note:_0x4b2501,Room_name:_0x3745f1,invoice:_0x53ab62,JO_number:_0x6eb9e7}=_0xb546c5[_0x277f1c(0x23c)];if(typeof _0x3515eb==_0x277f1c(0x1b6))var _0x3404ae=[_0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x270)]],_0x27dc64=[_0xb546c5['body']['level']],_0x24d295=[_0xb546c5[_0x277f1c(0x23c)]['stock']],_0x1a6395=[_0xb546c5['body'][_0x277f1c(0x25c)]],_0x1a3b81=[_0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x1e5)]],_0x541da3=[_0xb546c5[_0x277f1c(0x23c)]['new_adjust_qty']],_0x53952e=[_0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x1d9)]],_0x1ace69=[_0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x22b)]],_0x92e045=[_0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x1cb)]],_0x464525=[_0xb546c5['body'][_0x277f1c(0x1ad)]],_0x5ee13b=[_0xb546c5['body']['expiry_date']];else var _0x3404ae=[..._0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x270)]],_0x27dc64=[..._0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x216)]],_0x24d295=[..._0xb546c5['body'][_0x277f1c(0x1e6)]],_0x1a6395=[..._0xb546c5['body'][_0x277f1c(0x25c)]],_0x1a3b81=[..._0xb546c5['body']['adjust_qty']],_0x541da3=[..._0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x272)]],_0x53952e=[..._0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x1d9)]],_0x1ace69=[..._0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x22b)]],_0x92e045=[..._0xb546c5['body'][_0x277f1c(0x1cb)]],_0x464525=[..._0xb546c5['body']['batch_code']],_0x5ee13b=[..._0xb546c5[_0x277f1c(0x23c)][_0x277f1c(0x1b8)]];const _0x598fcd=_0x3404ae['map'](_0x1863c7=>{return _0x1863c7={'product_name':_0x1863c7};});_0x27dc64[_0x277f1c(0x201)]((_0x3308c9,_0x30afdb)=>{var _0x506084=_0x277f1c;_0x598fcd[_0x30afdb][_0x506084(0x1f1)]=_0x3308c9;}),_0x24d295[_0x277f1c(0x201)]((_0x2b8825,_0x1465c7)=>{var _0x59a0d0=_0x277f1c;_0x598fcd[_0x1465c7][_0x59a0d0(0x212)]=_0x2b8825;}),_0x1a6395[_0x277f1c(0x201)]((_0x310824,_0xa3b673)=>{_0x598fcd[_0xa3b673]['types']=_0x310824;}),_0x1a3b81['forEach']((_0x106e2f,_0x2709a3)=>{var _0x4f149e=_0x277f1c;_0x598fcd[_0x2709a3][_0x4f149e(0x1e5)]=_0x106e2f;}),_0x541da3[_0x277f1c(0x201)]((_0x4c8378,_0x59ee1d)=>{_0x598fcd[_0x59ee1d]['new_adjust_qty']=_0x4c8378;}),_0x1ace69[_0x277f1c(0x201)]((_0x168d2c,_0x3a75a0)=>{var _0x3f2d36=_0x277f1c;_0x598fcd[_0x3a75a0][_0x3f2d36(0x22b)]=_0x168d2c;}),_0x92e045[_0x277f1c(0x201)]((_0x269ebc,_0x1be9d9)=>{var _0x3cf358=_0x277f1c;_0x598fcd[_0x1be9d9][_0x3cf358(0x25b)]=_0x269ebc;}),_0x53952e[_0x277f1c(0x201)]((_0x2631a5,_0x78c00a)=>{var _0x5662f=_0x277f1c;_0x598fcd[_0x78c00a][_0x5662f(0x1e2)]=_0x2631a5;}),_0x464525['forEach']((_0x148fd1,_0x373f63)=>{var _0x35a0ee=_0x277f1c;_0x598fcd[_0x373f63][_0x35a0ee(0x1ad)]=_0x148fd1;}),_0x5ee13b['forEach']((_0x798a56,_0xff179f)=>{var _0xdf1f85=_0x277f1c;_0x598fcd[_0xff179f][_0xdf1f85(0x1b8)]=_0x798a56;});const _0x5cbec0=_0x598fcd[_0x277f1c(0x274)](_0x306fa7=>_0x306fa7[_0x277f1c(0x1e5)]!=='0'&&_0x306fa7[_0x277f1c(0x1e5)]!=='');var _0x3b509f=0x0;_0x5cbec0[_0x277f1c(0x201)](_0x4b6d2a=>{var _0x12add2=_0x277f1c;console[_0x12add2(0x1c5)](_0x12add2(0x246),_0x4b6d2a),parseInt(_0x4b6d2a[_0x12add2(0x1e5)])<=0x0&&_0x3b509f++;});if(_0x3b509f!=0x0)return _0xb546c5[_0x277f1c(0x243)](_0x277f1c(0x266),_0x277f1c(0x21f)),_0x4843f0[_0x277f1c(0x1d5)](_0x277f1c(0x219));_0x638910[_0x277f1c(0x259)]=_0x1c9135,_0x638910['date']=_0x16bc96,_0x638910[_0x277f1c(0x22d)]=_0x5cbec0,_0x638910['note']=_0x4b2501,_0x638910[_0x277f1c(0x262)]=_0x3745f1,_0x638910[_0x277f1c(0x20e)]=_0x53ab62,_0x638910['JO_number']=_0x6eb9e7;const _0x4b33d7=await _0x638910[_0x277f1c(0x249)](),_0x54ea04=await warehouse[_0x277f1c(0x1d7)]({'name':_0x1c9135,'room':_0x3745f1});_0x4b33d7[_0x277f1c(0x22d)][_0x277f1c(0x201)](_0x2b3bb4=>{var _0x1119be=_0x277f1c;const _0x41e938=_0x54ea04[_0x1119be(0x1b4)][_0x1119be(0x26e)](_0x438932=>{var _0xa08a78=_0x1119be;_0x2b3bb4['types']==_0xa08a78(0x1fb)?_0x438932[_0xa08a78(0x269)]==_0x2b3bb4[_0xa08a78(0x269)]&&_0x438932[_0xa08a78(0x1f1)]==_0x2b3bb4[_0xa08a78(0x1f1)]&&(_0x438932[_0xa08a78(0x227)]=parseInt(_0x438932['product_stock'])-parseInt(_0x2b3bb4['adjust_qty'])):_0x438932[_0xa08a78(0x269)]==_0x2b3bb4[_0xa08a78(0x269)]&&_0x438932[_0xa08a78(0x1f1)]==_0x2b3bb4[_0xa08a78(0x1f1)]&&(_0x438932[_0xa08a78(0x227)]=parseInt(_0x438932[_0xa08a78(0x227)])+parseInt(_0x2b3bb4[_0xa08a78(0x1e5)]));});}),await _0x54ea04[_0x277f1c(0x249)](),_0xb546c5['flash'](_0x277f1c(0x1d6),_0x277f1c(0x263)),_0x4843f0[_0x277f1c(0x1d5)](_0x277f1c(0x1e8));}catch(_0x181de4){console[_0x277f1c(0x1c5)](_0x181de4);}}),router[a0_0xee9f14(0x1f7)](a0_0xee9f14(0x23f),async(_0x14df46,_0xae849d)=>{var _0x37bc2b=a0_0xee9f14;const {primary_code:_0x48c3df,warehouse_data:_0x4a21e2,rooms_data:_0x2885dc,Roomslist:_0x43a044}=_0x14df46['body'],_0x1c834a=_0x43a044['split'](','),_0x2e60af=[];async function _0x4461e6(_0x333681){var _0x45426d=a0_0x119b;const _0xe40535=await warehouse['aggregate']([{'$match':{'name':_0x4a21e2,'room':_0x333681}},{'$unwind':_0x45426d(0x1da)},{'$match':{'product_details.primary_code':_0x48c3df}},{'$group':{'_id':_0x45426d(0x1f5),'name':{'$first':_0x45426d(0x1ec)},'product_stock':{'$first':_0x45426d(0x1ce)},'primary_code':{'$first':_0x45426d(0x1c6)},'secondary_code':{'$first':_0x45426d(0x1f9)},'product_code':{'$first':_0x45426d(0x1bb)},'level':{'$first':_0x45426d(0x26d)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x45426d(0x1af)},'pallet':{'$first':_0x45426d(0x21e)},'unit':{'$first':_0x45426d(0x231)},'secondary_unit':{'$first':_0x45426d(0x248)},'storage':{'$first':_0x45426d(0x25f)},'rack':{'$first':_0x45426d(0x240)},'expiry_date':{'$first':_0x45426d(0x1fa)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x45426d(0x1bc)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x45426d(0x226)},'roomNamed':{'$first':_0x45426d(0x1b9)},'invoice':{'$first':_0x45426d(0x273)}}}]),_0x5def1e=await warehouse[_0x45426d(0x260)]([{'$match':{'name':_0x4a21e2,'room':_0x333681}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x48c3df}},{'$group':{'_id':_0x45426d(0x1f5),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x45426d(0x1ce)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x45426d(0x1f9)},'product_code':{'$first':_0x45426d(0x1bb)},'level':{'$first':_0x45426d(0x26d)},'isle':{'$first':_0x45426d(0x1d4)},'type':{'$first':_0x45426d(0x1af)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x45426d(0x231)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x45426d(0x25f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x45426d(0x1bc)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x45426d(0x226)},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x45426d(0x273)}}}]);if(_0xe40535[_0x45426d(0x26a)]>0x0)_0x2e60af[_0x45426d(0x1f4)](_0xe40535);else _0x5def1e['length']>0x0&&_0x2e60af[_0x45426d(0x1f4)](_0x5def1e);}const _0x2397ac=_0x1c834a[_0x37bc2b(0x26e)](_0x265c88=>_0x4461e6(_0x265c88));await Promise[_0x37bc2b(0x256)](_0x2397ac),_0xae849d[_0x37bc2b(0x24b)](_0x2e60af);}),router[a0_0xee9f14(0x1f7)]('/CheckingWarehouse',async(_0x5ae2cf,_0x5db23f)=>{var _0x111c24=a0_0xee9f14;const {productCode:_0x223e84,bay:_0x2ad013,warehouses:_0x302dac,room:_0x26f33b}=_0x5ae2cf[_0x111c24(0x23c)];console[_0x111c24(0x1c5)](_0x5ae2cf[_0x111c24(0x23c)]);try{const _0x1d65a8=await warehouse['aggregate']([{'$match':{'name':_0x302dac,'room':_0x26f33b}},{'$unwind':_0x111c24(0x1da)},{'$match':{'product_details.bay':parseInt(_0x2ad013)}},{'$group':{'_id':_0x111c24(0x1f5),'name':{'$first':_0x111c24(0x1ec)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x111c24(0x26d)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x5db23f['status'](0xc8)[_0x111c24(0x24b)](_0x1d65a8);}catch(_0x557c07){_0x5db23f['status'](0x194)['json']({'message':_0x557c07[_0x111c24(0x276)]});}}),module[a0_0xee9f14(0x1ea)]=router;