var a0_0x149d1b=a0_0x1ed4;function a0_0x4b97(){var _0x31fb1f=['forEach','Error\x20Occurs','</head><body>','master','findById','post','flash','expiry_date','Logo.png','811576agUaJL','toString','$product_details.secondary_code','$_id','/adjustment_finished/view','staff','then','batch_code','/adjustment_finished/preview/','body','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','9233739SkJoIH','message','map','random','product_date','Arabic\x20(ae)','errors','Spanish','$product_details.maxProducts','email','$product_details.product_stock','JO_number','stock','$product_details.invoice','<tr>','express','New_Qty_Converted_adj','Arabic','add_adjustment_finished','$warehouse_name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','FGSEmail','maxPerUnit','floor','redirect','56VfdlAd','$product_details.bin','Portuguese\x20(BR)','createTransport','Chinese','render','\x20</h2>','337011blViVj','<tbody\x20style=\x22text-align:\x20center;\x22>','/barcode_scanner','slice','note','all','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','nodemailer','<html><head><title></title>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<hr\x20class=\x22my-3\x22>','Rooms','minus','port','/../public','</div>','True','production_date','image','find','../models/all_models','product_stock','New_Qty_Converted','\x20Order\x20Number\x20:\x20','room','/view/add_adjustment','</span>','15599090MAuzVq','An\x20error\x20occurred\x20while\x20saving\x20data.','room_names','language','/CheckingWarehouse','$product_details.storage','$product','error','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','user','Primary_Units','French','/view','$product_details.maxPerUnit','product_details','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Router','push','unit','findOne','$product_details.product_code','$product_details.production_date','string','../public/language/languages.json','$name','warehouse','<h5\x20style=\x22text-align:\x20left;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','new_adjust_qty','Finished\x20Goods','/picking_list/PDF_adjustment/','$product_details.floorlevel','get','/preview/:id','</td>','70eiCcvm','$product_details','Secondary_units','getFullYear','exports','types','English\x20(US)','save','$product_details.rack','adjust_qty','level','prod_cat','$date','QA\x20Warehouse','$product_details.unit','Enabled','Return\x20Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','date','product','$product_details._id','status','$invoice','adjustment\x20add\x20successfull','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.batch_code','_id','params','$product_details.product_name','/view/:id','\x20Order\x20Date\x20:\x20','2037628eOZYnI','adjustment_finished','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','invoice','Adjustment\x20Mail','<h2>\x20','split','aggregate','stockBefore','log','adjustment\x20data\x20update\x20successfully','back','$product.product_name','Enclosed','host','json','secondary_unit','ADJF-','product_name','4AHvpDh','Hindi','getMonth','<strong>\x20Regards\x20</strong>','edit_adjustment_finished','length','Ambient','$product_details.secondary_unit','</h5>','logo','password','240432OdEwBm','$room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','English','product_code','<span\x20style=\x22float:\x20right;\x22>','Portuguese','warehouse_name','role','bay','$product_details.primary_code','$product_details.type','German','filter','../middleware/auth','prod_code','$product.room_names','<div>','<!DOCTYPE\x20html>','422052ECZyfb','$product_details.expiry_date','$finalize','success','$product_details.bay','/upload/','finalize','site_title','prod_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'];a0_0x4b97=function(){return _0x31fb1f;};return a0_0x4b97();}(function(_0x428ee6,_0x3bab3e){var _0x216a6e=a0_0x1ed4,_0x29ff91=_0x428ee6();while(!![]){try{var _0x1196ba=-parseInt(_0x216a6e(0x221))/0x1+parseInt(_0x216a6e(0x1dd))/0x2+-parseInt(_0x216a6e(0x24d))/0x3*(-parseInt(_0x216a6e(0x1f0))/0x4)+parseInt(_0x216a6e(0x28b))/0x5*(parseInt(_0x216a6e(0x20e))/0x6)+parseInt(_0x216a6e(0x246))/0x7*(-parseInt(_0x216a6e(0x1fb))/0x8)+parseInt(_0x216a6e(0x22d))/0x9+-parseInt(_0x216a6e(0x268))/0xa;if(_0x1196ba===_0x3bab3e)break;else _0x29ff91['push'](_0x29ff91['shift']());}catch(_0x56bd8d){_0x29ff91['push'](_0x29ff91['shift']());}}}(a0_0x4b97,0x81649));const express=require(a0_0x149d1b(0x23c)),app=express(),router=express[a0_0x149d1b(0x278)](),auth=require(a0_0x149d1b(0x209)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x149d1b(0x261)),users=require(a0_0x149d1b(0x27f)),nodemailer=require(a0_0x149d1b(0x254));router[a0_0x149d1b(0x288)](a0_0x149d1b(0x274),auth,async(_0x28de37,_0x4e29fc)=>{var _0x199ac0=a0_0x149d1b;try{const {username:_0x577c4c,email:_0x55118c,role:_0x2071b0}=_0x28de37[_0x199ac0(0x271)],_0x9e6026=_0x28de37[_0x199ac0(0x271)],_0x367097=await profile[_0x199ac0(0x27b)]({'email':_0x9e6026['email']}),_0x39b913=await master_shop['find']();let _0x3a6f11;if(_0x9e6026[_0x199ac0(0x203)]==_0x199ac0(0x226)){const _0x14914c=await staff[_0x199ac0(0x27b)]({'email':_0x9e6026[_0x199ac0(0x236)]});_0x3a6f11=await warehouse[_0x199ac0(0x260)]({'status':'Enabled','name':_0x14914c[_0x199ac0(0x281)]});}else _0x3a6f11=await warehouse['find']({'status':_0x199ac0(0x1cc)});const _0xda0d10=await product[_0x199ac0(0x260)]();let _0x4004ea;if(_0x9e6026[_0x199ac0(0x203)]=='staff'){const _0x54011f=await staff[_0x199ac0(0x27b)]({'email':_0x9e6026['email']});_0x4004ea=await adjustment_finished[_0x199ac0(0x260)]({'warehouse_name':_0x54011f[_0x199ac0(0x281)]});}else _0x4004ea=await adjustment_finished[_0x199ac0(0x1e4)]([{'$unwind':_0x199ac0(0x26e)},{'$group':{'_id':_0x199ac0(0x224),'invoice':{'$first':_0x199ac0(0x1d3)},'date':{'$first':_0x199ac0(0x1c9)},'warehouse_name':{'$first':_0x199ac0(0x240)},'room':{'$addToSet':_0x199ac0(0x20b)},'finalize':{'$first':_0x199ac0(0x210)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x39b913[0x0]['language']=='English\x20(US)'){var _0x3a3805=users[_0x199ac0(0x1fe)];console[_0x199ac0(0x1e6)](_0x3a3805);}else{if(_0x39b913[0x0][_0x199ac0(0x26b)]==_0x199ac0(0x1f1))var _0x3a3805=users['Hindi'];else{if(_0x39b913[0x0]['language']==_0x199ac0(0x207))var _0x3a3805=users[_0x199ac0(0x207)];else{if(_0x39b913[0x0][_0x199ac0(0x26b)]==_0x199ac0(0x234))var _0x3a3805=users['Spanish'];else{if(_0x39b913[0x0][_0x199ac0(0x26b)]==_0x199ac0(0x273))var _0x3a3805=users[_0x199ac0(0x273)];else{if(_0x39b913[0x0][_0x199ac0(0x26b)]==_0x199ac0(0x248))var _0x3a3805=users['Portuguese'];else{if(_0x39b913[0x0][_0x199ac0(0x26b)]==_0x199ac0(0x24a))var _0x3a3805=users[_0x199ac0(0x24a)];else{if(_0x39b913[0x0][_0x199ac0(0x26b)]==_0x199ac0(0x232))var _0x3a3805=users[_0x199ac0(0x23e)];}}}}}}}_0x4e29fc['render'](_0x199ac0(0x1de),{'success':_0x28de37[_0x199ac0(0x21e)](_0x199ac0(0x211)),'errors':_0x28de37[_0x199ac0(0x21e)]('errors'),'role':_0x9e6026,'profile':_0x367097,'warehouse':_0x3a6f11,'product':_0xda0d10,'adjustment':_0x4004ea,'master_shop':_0x39b913,'language':_0x3a3805});}catch(_0x405548){console[_0x199ac0(0x1e6)](_0x405548);}});function a0_0x1ed4(_0x578122,_0x5699c8){var _0x4b977f=a0_0x4b97();return a0_0x1ed4=function(_0x1ed49e,_0x1e781c){_0x1ed49e=_0x1ed49e-0x1c0;var _0x568cb7=_0x4b977f[_0x1ed49e];return _0x568cb7;},a0_0x1ed4(_0x578122,_0x5699c8);}async function getRandom8DigitNumber(){var _0x16bf7e=a0_0x149d1b;const _0x341d99=0x989680,_0x6af092=0x5f5e0ff,_0x1475f6=Math[_0x16bf7e(0x244)](Math[_0x16bf7e(0x230)]()*(_0x6af092-_0x341d99+0x1))+_0x341d99;var _0x283ab7;const _0x501082=await adjustment_finished[_0x16bf7e(0x27b)]({'invoice':_0x16bf7e(0x1ee)+_0x1475f6});return _0x501082&&_0x501082[_0x16bf7e(0x1f5)]>0x0?_0x283ab7=_0x16bf7e(0x1ee)+_0x1475f6:_0x283ab7=_0x16bf7e(0x1ee)+_0x1475f6,_0x283ab7;}router[a0_0x149d1b(0x288)](a0_0x149d1b(0x266),auth,async(_0x541bb4,_0x2bf08b)=>{var _0x463872=a0_0x149d1b;try{const {username:_0x5490fc,email:_0xa813ae,role:_0x48fdfe}=_0x541bb4[_0x463872(0x271)],_0x1d4c64=_0x541bb4[_0x463872(0x271)],_0x202079=await profile['findOne']({'email':_0x1d4c64['email']}),_0x4d515d=await master_shop[_0x463872(0x260)]();let _0x3ae227;if(_0x1d4c64[_0x463872(0x203)]==_0x463872(0x226)){const _0xab62ae=await staff[_0x463872(0x27b)]({'email':_0x1d4c64['email']});_0x3ae227=await warehouse['aggregate']([{'$match':{'status':_0x463872(0x1cc),'name':_0xab62ae[_0x463872(0x281)],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x463872(0x1ca)}}},{'$group':{'_id':_0x463872(0x280),'name':{'$first':_0x463872(0x280)}}}]);}else _0x3ae227=await warehouse[_0x463872(0x1e4)]([{'$match':{'status':_0x463872(0x1cc),'warehouse_category':_0x463872(0x285),'name':{'$ne':_0x463872(0x1ca)}}},{'$group':{'_id':_0x463872(0x280),'name':{'$first':_0x463872(0x280)}}}]);const _0x5c4ad0=await product['find']({}),_0x168676=await adjustment_finished[_0x463872(0x260)]({}),_0x17a75d=_0x168676[_0x463872(0x1f5)]+0x1,_0x1b78b6=_0x463872(0x1ee)+_0x17a75d[_0x463872(0x222)]()['padStart'](0x5,'0');var _0x22ba32=['Ambient',_0x463872(0x1ea),_0x463872(0x1cd)];if(_0x4d515d[0x0][_0x463872(0x26b)]=='English\x20(US)')var _0xa8dac1=users[_0x463872(0x1fe)];else{if(_0x4d515d[0x0][_0x463872(0x26b)]==_0x463872(0x1f1))var _0xa8dac1=users['Hindi'];else{if(_0x4d515d[0x0][_0x463872(0x26b)]==_0x463872(0x207))var _0xa8dac1=users[_0x463872(0x207)];else{if(_0x4d515d[0x0][_0x463872(0x26b)]==_0x463872(0x234))var _0xa8dac1=users['Spanish'];else{if(_0x4d515d[0x0]['language']==_0x463872(0x273))var _0xa8dac1=users['French'];else{if(_0x4d515d[0x0]['language']==_0x463872(0x248))var _0xa8dac1=users[_0x463872(0x201)];else{if(_0x4d515d[0x0][_0x463872(0x26b)]==_0x463872(0x24a))var _0xa8dac1=users[_0x463872(0x24a)];else{if(_0x4d515d[0x0][_0x463872(0x26b)]==_0x463872(0x232))var _0xa8dac1=users['Arabic'];}}}}}}}const _0x529d23=getRandom8DigitNumber();_0x529d23[_0x463872(0x227)](_0x2cf5e1=>{var _0x3db9e8=_0x463872;_0x2bf08b[_0x3db9e8(0x24b)](_0x3db9e8(0x23f),{'success':_0x541bb4[_0x3db9e8(0x21e)](_0x3db9e8(0x211)),'errors':_0x541bb4[_0x3db9e8(0x21e)](_0x3db9e8(0x233)),'role':_0x1d4c64,'profile':_0x202079,'warehouse':_0x3ae227,'product':_0x5c4ad0,'master_shop':_0x4d515d,'language':_0xa8dac1,'rooms_data':_0x22ba32,'invoice_no':_0x2cf5e1});})['catch'](_0x40672b=>{var _0x189330=_0x463872;_0x541bb4[_0x189330(0x21e)](_0x189330(0x233),_0x189330(0x241)),_0x2bf08b['redirect']('/adjustment/view');});}catch(_0x59348b){console[_0x463872(0x1e6)](_0x59348b);}}),router[a0_0x149d1b(0x21d)](a0_0x149d1b(0x266),auth,async(_0x39206c,_0x5c2c15)=>{var _0x5e3ec5=a0_0x149d1b;try{const {warehouse_name:_0x5b69e2,date:_0x55c7ca,prod_name:_0x4956f3,level:_0x70ff09,isle:_0x4f9d1e,pallet:_0x20aee7,stock:_0x4583de,types:_0x4a26ed,adjust_qty:_0x1287aa,new_adjust_qty:_0x24b9ae,note:_0x204176,Room_name:_0xf27b49,invoice:_0x4e433d,JO_number:_0x2b2221,expiry_date:_0x480ae4}=_0x39206c[_0x5e3ec5(0x22a)];if(typeof _0x4956f3==_0x5e3ec5(0x27e))var _0x3ba75a=[_0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x216)]],_0x128d71=[_0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x1c7)]],_0x50987c=[_0x39206c['body'][_0x5e3ec5(0x239)]],_0x3cb510=[_0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x1c2)]],_0x3526de=[_0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x23d)]],_0x263a33=[_0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x263)]],_0x5e406b=[_0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x272)]],_0x1c56c5=[_0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x28d)]],_0x200a18=[_0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x20a)]],_0x350c04=[_0x39206c['body']['batch_code']],_0x4c4c6e=[_0x39206c[_0x5e3ec5(0x22a)]['expiry_date']],_0x292644=[_0x39206c[_0x5e3ec5(0x22a)]['product_date']],_0x14362e=[_0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x1c8)]],_0x57f538=[_0x39206c[_0x5e3ec5(0x22a)]['Rooms']],_0x59bda2=[_0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x243)]],_0x100f5a=[_0x39206c[_0x5e3ec5(0x22a)]['prod_invoice']];else var _0x3ba75a=[..._0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x216)]],_0x128d71=[..._0x39206c[_0x5e3ec5(0x22a)]['level']],_0x50987c=[..._0x39206c['body'][_0x5e3ec5(0x239)]],_0x3cb510=[..._0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x1c2)]],_0x3526de=[..._0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x23d)]],_0x263a33=[..._0x39206c['body'][_0x5e3ec5(0x263)]],_0x5e406b=[..._0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x272)]],_0x1c56c5=[..._0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x28d)]],_0x200a18=[..._0x39206c[_0x5e3ec5(0x22a)]['prod_code']],_0x350c04=[..._0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x228)]],_0x4c4c6e=[..._0x39206c[_0x5e3ec5(0x22a)]['expiry_date']],_0x292644=[..._0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x231)]],_0x14362e=[..._0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x1c8)]],_0x57f538=[..._0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x258)]],_0x59bda2=[..._0x39206c[_0x5e3ec5(0x22a)][_0x5e3ec5(0x243)]],_0x100f5a=[..._0x39206c['body']['prod_invoice']];const _0x3ecf7c=_0x3ba75a['map'](_0x584d0c=>{return _0x584d0c={'product_name':_0x584d0c};});_0x128d71[_0x5e3ec5(0x218)]((_0x108279,_0x118119)=>{var _0x217c43=_0x5e3ec5;_0x3ecf7c[_0x118119][_0x217c43(0x204)]=_0x108279;}),_0x50987c[_0x5e3ec5(0x218)]((_0x49ea37,_0x20a9af)=>{var _0x5d59eb=_0x5e3ec5;_0x3ecf7c[_0x20a9af][_0x5d59eb(0x1e5)]=_0x49ea37;}),_0x3cb510['forEach']((_0x56c7cd,_0xe048c9)=>{var _0x5464c2=_0x5e3ec5;_0x3ecf7c[_0xe048c9][_0x5464c2(0x1c2)]=_0x56c7cd;}),_0x3526de[_0x5e3ec5(0x218)]((_0x5aa77a,_0x2ecef9)=>{var _0x155081=_0x5e3ec5;_0x3ecf7c[_0x2ecef9][_0x155081(0x1c6)]=_0x5aa77a;}),_0x263a33[_0x5e3ec5(0x218)]((_0x93ec4d,_0x26c18a)=>{var _0xb69b13=_0x5e3ec5;_0x3ecf7c[_0x26c18a][_0xb69b13(0x284)]=_0x93ec4d;}),_0x5e406b[_0x5e3ec5(0x218)]((_0x3ec4e9,_0x139c1b)=>{var _0x37096f=_0x5e3ec5;_0x3ecf7c[_0x139c1b][_0x37096f(0x27a)]=_0x3ec4e9;}),_0x1c56c5[_0x5e3ec5(0x218)]((_0x1eaaf0,_0x5d1cc5)=>{var _0x244969=_0x5e3ec5;_0x3ecf7c[_0x5d1cc5][_0x244969(0x1ed)]=_0x1eaaf0;}),_0x200a18[_0x5e3ec5(0x218)]((_0x4b223a,_0x266c82)=>{var _0x3e10a7=_0x5e3ec5;_0x3ecf7c[_0x266c82][_0x3e10a7(0x1ff)]=_0x4b223a;}),_0x350c04[_0x5e3ec5(0x218)]((_0x5abecf,_0x31dad1)=>{var _0x1759fc=_0x5e3ec5;_0x3ecf7c[_0x31dad1][_0x1759fc(0x228)]=_0x5abecf;}),_0x4c4c6e[_0x5e3ec5(0x218)]((_0x30b7db,_0x42c093)=>{var _0x34f484=_0x5e3ec5;_0x3ecf7c[_0x42c093][_0x34f484(0x21f)]=_0x30b7db;}),_0x292644[_0x5e3ec5(0x218)]((_0x107b3f,_0x9fc428)=>{_0x3ecf7c[_0x9fc428]['production_date']=_0x107b3f;}),_0x14362e[_0x5e3ec5(0x218)]((_0x739690,_0x17e47f)=>{var _0x48bce5=_0x5e3ec5;_0x3ecf7c[_0x17e47f][_0x48bce5(0x1c8)]=_0x739690;}),_0x57f538['forEach']((_0xe12db9,_0x4e1fe5)=>{var _0x2acf30=_0x5e3ec5;_0x3ecf7c[_0x4e1fe5][_0x2acf30(0x26a)]=_0xe12db9;}),_0x59bda2[_0x5e3ec5(0x218)]((_0x3dbc68,_0x130f71)=>{_0x3ecf7c[_0x130f71]['maxPerUnit']=_0x3dbc68;}),_0x100f5a[_0x5e3ec5(0x218)]((_0x22c7a2,_0x53f7a4)=>{var _0x2b1f70=_0x5e3ec5;_0x3ecf7c[_0x53f7a4][_0x2b1f70(0x1e0)]=_0x22c7a2;});const _0x467bf2=_0x3ecf7c[_0x5e3ec5(0x208)](_0x305403=>_0x305403[_0x5e3ec5(0x1c6)]!=='0'&&_0x305403[_0x5e3ec5(0x1c6)]!=='');var _0x2f3335=0x0;_0x467bf2[_0x5e3ec5(0x218)](_0x922899=>{var _0x2143e4=_0x5e3ec5;console[_0x2143e4(0x1e6)]('foreach\x20newproduct',_0x922899),parseInt(_0x922899[_0x2143e4(0x1c6)])<=0x0&&_0x2f3335++;});if(_0x2f3335!=0x0)return _0x39206c[_0x5e3ec5(0x21e)]('errors',_0x5e3ec5(0x253)),_0x5c2c15['redirect']('back');const _0x247f82=new adjustment_finished({'warehouse_name':_0x5b69e2,'date':_0x55c7ca,'product':_0x467bf2,'note':_0x204176,'room':_0xf27b49,'invoice':_0x4e433d,'JO_number':_0x2b2221,'expiry_date':_0x480ae4}),_0x59b718=await _0x247f82[_0x5e3ec5(0x1c4)]();_0x39206c[_0x5e3ec5(0x21e)](_0x5e3ec5(0x211),_0x5e3ec5(0x1d4)),_0x5c2c15[_0x5e3ec5(0x245)](_0x5e3ec5(0x229)+_0x59b718[_0x5e3ec5(0x1d8)]);}catch(_0x35ec07){console[_0x5e3ec5(0x1e6)](_0x35ec07),_0x5c2c15['status'](0xc8)[_0x5e3ec5(0x1ec)]({'message':_0x35ec07[_0x5e3ec5(0x22e)]});}}),router['get'](a0_0x149d1b(0x289),auth,async(_0x27404f,_0x146510)=>{var _0xc6fcbd=a0_0x149d1b;try{const {username:_0x349826,email:_0x3a12b2,role:_0x31419a}=_0x27404f[_0xc6fcbd(0x271)],_0x447321=_0x27404f[_0xc6fcbd(0x271)],_0x2d8450=await profile[_0xc6fcbd(0x27b)]({'email':_0x447321[_0xc6fcbd(0x236)]}),_0x3fd077=await master_shop['find'](),_0x3fc6d2=_0x27404f[_0xc6fcbd(0x1d9)]['id'],_0x15799f=await adjustment_finished[_0xc6fcbd(0x21c)]({'_id':_0x3fc6d2}),_0x5ed519=await purchases[_0xc6fcbd(0x1e4)]([{'$match':{'warehouse_name':_0x15799f[_0xc6fcbd(0x202)]}},{'$unwind':_0xc6fcbd(0x26e)},{'$group':{'_id':'$product.product_name'}}]);console['log']('purchases_data',_0x5ed519);const _0x4c962b=await product[_0xc6fcbd(0x260)]({}),_0x505b77=await warehouse['aggregate']([{'$match':{'name':_0x15799f[_0xc6fcbd(0x202)],'warehouse_category':_0xc6fcbd(0x285)}},{'$unwind':'$product_details'},{'$group':{'_id':_0xc6fcbd(0x1d1),'name':{'$first':_0xc6fcbd(0x1da)},'product_stock':{'$first':_0xc6fcbd(0x237)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0xc6fcbd(0x247)},'type':{'$first':_0xc6fcbd(0x206)},'floorlevel':{'$first':_0xc6fcbd(0x287)},'primary_code':{'$first':_0xc6fcbd(0x205)},'secondary_code':{'$first':_0xc6fcbd(0x223)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xc6fcbd(0x1c5)},'expiry_date':{'$first':_0xc6fcbd(0x20f)},'production_date':{'$first':_0xc6fcbd(0x27d)},'batch_code':{'$first':_0xc6fcbd(0x1d7)},'maxPerUnit':{'$first':_0xc6fcbd(0x275)},'room':{'$first':_0xc6fcbd(0x1fc)}}}]);if(_0x3fd077[0x0][_0xc6fcbd(0x26b)]==_0xc6fcbd(0x1c3)){var _0xe16363=users['English'];console[_0xc6fcbd(0x1e6)](_0xe16363);}else{if(_0x3fd077[0x0]['language']=='Hindi')var _0xe16363=users[_0xc6fcbd(0x1f1)];else{if(_0x3fd077[0x0][_0xc6fcbd(0x26b)]==_0xc6fcbd(0x207))var _0xe16363=users['German'];else{if(_0x3fd077[0x0][_0xc6fcbd(0x26b)]=='Spanish')var _0xe16363=users['Spanish'];else{if(_0x3fd077[0x0][_0xc6fcbd(0x26b)]==_0xc6fcbd(0x273))var _0xe16363=users[_0xc6fcbd(0x273)];else{if(_0x3fd077[0x0][_0xc6fcbd(0x26b)]==_0xc6fcbd(0x248))var _0xe16363=users['Portuguese'];else{if(_0x3fd077[0x0]['language']==_0xc6fcbd(0x24a))var _0xe16363=users[_0xc6fcbd(0x24a)];else{if(_0x3fd077[0x0][_0xc6fcbd(0x26b)]=='Arabic\x20(ae)')var _0xe16363=users['Arabic'];}}}}}}}_0x146510[_0xc6fcbd(0x24b)]('edit_adjustment_finished_view',{'success':_0x27404f[_0xc6fcbd(0x21e)](_0xc6fcbd(0x211)),'errors':_0x27404f[_0xc6fcbd(0x21e)](_0xc6fcbd(0x233)),'role':_0x447321,'profile':_0x2d8450,'adjustment':_0x15799f,'stock':_0x505b77,'master_shop':_0x3fd077,'warehouse_name':_0x5ed519,'unit':_0x4c962b,'language':_0xe16363});}catch(_0x1fe61c){console['log'](_0x1fe61c),_0x146510['status'](0xc8)[_0xc6fcbd(0x1ec)]({'message':_0x1fe61c[_0xc6fcbd(0x22e)]});}}),router[a0_0x149d1b(0x21d)](a0_0x149d1b(0x289),auth,async(_0x513d7f,_0xd755df)=>{var _0x16209c=a0_0x149d1b;try{const {invoice:_0x3276a6,warehouse_name:_0x342f5d,Room_name:_0x5721ae}=_0x513d7f[_0x16209c(0x22a)],_0x17c2ea=_0x513d7f[_0x16209c(0x1d9)]['id'],_0x3f3b91=await adjustment_finished['findById']({'_id':_0x17c2ea});var _0x55c595;const _0x1afdbd=_0x3f3b91[_0x16209c(0x1d0)]['map'](async _0x3f9526=>{var _0x309d31=_0x16209c;if(_0x3f9526[_0x309d31(0x1c6)]>0x0){_0x55c595=await warehouse['findOne']({'name':_0x342f5d,'room':_0x3f9526[_0x309d31(0x26a)],'warehouse_category':_0x309d31(0x285)});const _0x311426=_0x55c595[_0x309d31(0x276)]['map'](_0x27d7e6=>{var _0x4289dc=_0x309d31;console[_0x4289dc(0x1e6)](_0x3f9526[_0x4289dc(0x1c2)]);if(_0x3f9526[_0x4289dc(0x1c2)]==_0x4289dc(0x259))_0x27d7e6[_0x4289dc(0x1ef)]==_0x3f9526['product_name']&&_0x27d7e6[_0x4289dc(0x204)]==_0x3f9526[_0x4289dc(0x204)]&&_0x27d7e6[_0x4289dc(0x21f)]==_0x3f9526[_0x4289dc(0x21f)]&&_0x27d7e6[_0x4289dc(0x25e)]==_0x3f9526['production_date']&&_0x27d7e6['batch_code']==_0x3f9526[_0x4289dc(0x228)]&&_0x27d7e6[_0x4289dc(0x1e0)]==_0x3f9526['invoice']&&(_0x27d7e6[_0x4289dc(0x262)]=_0x27d7e6[_0x4289dc(0x262)]-_0x3f9526[_0x4289dc(0x1c6)]);else _0x3f9526['types']=='add'&&(_0x27d7e6[_0x4289dc(0x1ef)]==_0x3f9526[_0x4289dc(0x1ef)]&&_0x27d7e6[_0x4289dc(0x204)]==_0x3f9526[_0x4289dc(0x204)]&&_0x27d7e6[_0x4289dc(0x21f)]==_0x3f9526[_0x4289dc(0x21f)]&&_0x27d7e6[_0x4289dc(0x25e)]==_0x3f9526['production_date']&&_0x27d7e6[_0x4289dc(0x228)]==_0x3f9526[_0x4289dc(0x228)]&&_0x27d7e6[_0x4289dc(0x1e0)]==_0x3f9526[_0x4289dc(0x1e0)]&&(_0x27d7e6[_0x4289dc(0x262)]=_0x27d7e6[_0x4289dc(0x262)]+_0x3f9526[_0x4289dc(0x1c6)]));});}return _0x55c595;});Promise[_0x16209c(0x252)](_0x1afdbd)[_0x16209c(0x227)](async _0x12cae0=>{var _0x21e56f=_0x16209c;try{for(const _0x1ff668 of _0x12cae0){await _0x1ff668[_0x21e56f(0x1c4)]();}_0x3f3b91[_0x21e56f(0x214)]=_0x21e56f(0x25d);const _0x568b9c=await _0x3f3b91[_0x21e56f(0x1c4)](),_0x141a8b=await master_shop[_0x21e56f(0x260)](),_0x378560=await email_settings[_0x21e56f(0x27b)](),_0x2db729=await supervisor_settings[_0x21e56f(0x260)]();var _0x326b27=_0x3f3b91[_0x21e56f(0x1d0)],_0xe59ba0='',_0x3fb483;for(_0x3fb483 in _0x326b27){var _0xc0a8f4='FG';_0x3f3b91[_0x21e56f(0x202)]=='DRY\x20GOODS'&&(_0xc0a8f4='DG'),_0xe59ba0+=_0x21e56f(0x23b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x326b27[_0x3fb483]['product_name']+_0x21e56f(0x28a)+_0x21e56f(0x22c)+_0x326b27[_0x3fb483][_0x21e56f(0x1ff)]+_0x21e56f(0x28a)+_0x21e56f(0x22c)+_0x326b27[_0x3fb483][_0x21e56f(0x1c6)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x326b27[_0x3fb483][_0x21e56f(0x27a)]+_0x21e56f(0x28a)+_0x21e56f(0x22c)+_0x326b27[_0x3fb483][_0x21e56f(0x1ed)]+'</td>'+_0x21e56f(0x22c)+_0x3f3b91[_0x21e56f(0x202)]+'</td>'+_0x21e56f(0x22c)+_0x326b27[_0x3fb483][_0x21e56f(0x26a)]+_0x21e56f(0x28a)+_0x21e56f(0x22c)+_0xc0a8f4+_0x326b27[_0x3fb483][_0x21e56f(0x204)]+_0x21e56f(0x28a)+_0x21e56f(0x1d5);}let _0xde8d17=nodemailer[_0x21e56f(0x249)]({'host':_0x378560[_0x21e56f(0x1eb)],'port':Number(_0x378560[_0x21e56f(0x25a)]),'secure':![],'auth':{'user':_0x378560['email'],'pass':_0x378560[_0x21e56f(0x1fa)]}}),_0x932a2f={'from':_0x378560['email'],'to':_0x2db729[0x0][_0x21e56f(0x242)],'subject':_0x21e56f(0x1e1),'attachments':[{'filename':_0x21e56f(0x220),'path':__dirname+_0x21e56f(0x25b)+_0x21e56f(0x213)+_0x141a8b[0x0][_0x21e56f(0x25f)],'cid':_0x21e56f(0x1f9)}],'html':_0x21e56f(0x20d)+_0x21e56f(0x255)+_0x21e56f(0x21a)+_0x21e56f(0x20c)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x21e56f(0x20c)+_0x21e56f(0x22b)+_0x21e56f(0x25c)+_0x21e56f(0x20c)+_0x21e56f(0x1e2)+_0x141a8b[0x0]['site_title']+_0x21e56f(0x24c)+_0x21e56f(0x25c)+_0x21e56f(0x25c)+_0x21e56f(0x257)+_0x21e56f(0x20c)+_0x21e56f(0x282)+_0x21e56f(0x264)+_0x3f3b91[_0x21e56f(0x1e0)]+'\x20'+_0x21e56f(0x200)+_0x21e56f(0x1dc)+_0x3f3b91[_0x21e56f(0x1cf)]+'\x20'+_0x21e56f(0x267)+_0x21e56f(0x1f8)+_0x21e56f(0x25c)+_0x21e56f(0x277)+_0x21e56f(0x270)+_0x21e56f(0x23b)+_0x21e56f(0x283)+_0x21e56f(0x1df)+_0x21e56f(0x1d6)+_0x21e56f(0x1ce)+_0x21e56f(0x217)+_0x21e56f(0x1fd)+_0x21e56f(0x256)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x21e56f(0x1d5)+'</thead>'+_0x21e56f(0x24e)+'\x20'+_0xe59ba0+'\x20'+'</tbody>'+'</table>'+_0x21e56f(0x20c)+_0x21e56f(0x1f3)+'<h5>'+_0x141a8b[0x0][_0x21e56f(0x215)]+_0x21e56f(0x1f8)+'</div>'+_0x21e56f(0x25c)+'</body></html>'};_0xde8d17['sendMail'](_0x932a2f,function(_0x35700d,_0x9a9280){var _0x420561=_0x21e56f;_0x35700d?(console['log'](_0x35700d),console[_0x420561(0x1e6)](_0x420561(0x219))):console['log']('Email\x20sent\x20successfully');}),_0x513d7f['flash'](_0x21e56f(0x211),'Adjustment\x20Finalize\x20Successfully'),_0xd755df[_0x21e56f(0x245)](_0x21e56f(0x286)+_0x568b9c['_id']);}catch(_0x1a3e5a){console[_0x21e56f(0x26f)](_0x1a3e5a),_0xd755df[_0x21e56f(0x1d2)](0x1f4)[_0x21e56f(0x1ec)]({'error':_0x21e56f(0x269)});}})['catch'](_0x5df36e=>{var _0x5c13f9=_0x16209c;console[_0x5c13f9(0x26f)](_0x5df36e),_0xd755df[_0x5c13f9(0x1d2)](0x1f4)[_0x5c13f9(0x1ec)]({'error':'An\x20error\x20occurred.'});});}catch(_0x3d24b3){_0xd755df[_0x16209c(0x1ec)]({'message':_0x3d24b3['message']});}}),router[a0_0x149d1b(0x288)](a0_0x149d1b(0x1db),auth,async(_0x560242,_0x1b2770)=>{var _0x2eeff0=a0_0x149d1b;try{const {username:_0x5d813e,email:_0x540429,role:_0x512cc0}=_0x560242[_0x2eeff0(0x271)],_0x25b59b=_0x560242[_0x2eeff0(0x271)],_0x3e9ca0=await profile['findOne']({'email':_0x25b59b[_0x2eeff0(0x236)]}),_0x49ea2a=await master_shop[_0x2eeff0(0x260)]();console[_0x2eeff0(0x1e6)](_0x2eeff0(0x21b),_0x49ea2a);const _0x44baec=_0x560242[_0x2eeff0(0x1d9)]['id'],_0x206cb9=await adjustment_finished[_0x2eeff0(0x21c)]({'_id':_0x44baec});let _0x2ef2aa=new Date(_0x206cb9[_0x2eeff0(0x21f)]),_0x3a76ed=('0'+_0x2ef2aa['getDate']())[_0x2eeff0(0x250)](-0x2),_0xfde1d2=('0'+(_0x2ef2aa[_0x2eeff0(0x1f2)]()+0x1))[_0x2eeff0(0x250)](-0x2),_0x22c079=_0x2ef2aa[_0x2eeff0(0x1c0)](),_0x5bce86=_0x22c079+'-'+_0xfde1d2+'-'+_0x3a76ed;var _0x5696a=[_0x2eeff0(0x1f6),_0x2eeff0(0x1ea),_0x2eeff0(0x1cd)];const _0x539feb=await purchases[_0x2eeff0(0x1e4)]([{'$match':{'warehouse_name':_0x206cb9[_0x2eeff0(0x202)]}},{'$unwind':_0x2eeff0(0x26e)},{'$group':{'_id':_0x2eeff0(0x1e9)}}]);console['log']('purchases_data',_0x539feb);const _0x5751cb=await product['find']({}),_0xd5ac6f=await warehouse['aggregate']([{'$match':{'name':_0x206cb9[_0x2eeff0(0x202)],'room':_0x206cb9[_0x2eeff0(0x265)]}},{'$unwind':_0x2eeff0(0x28c)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2eeff0(0x1da)},'product_stock':{'$first':_0x2eeff0(0x237)},'bay':{'$first':_0x2eeff0(0x212)},'bin':{'$first':_0x2eeff0(0x247)},'type':{'$first':_0x2eeff0(0x206)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2eeff0(0x205)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2eeff0(0x27c)},'storage':{'$first':_0x2eeff0(0x26d)},'rack':{'$first':_0x2eeff0(0x1c5)}}}]);if(_0x49ea2a[0x0]['language']==_0x2eeff0(0x1c3)){var _0x2bacf8=users['English'];console[_0x2eeff0(0x1e6)](_0x2bacf8);}else{if(_0x49ea2a[0x0][_0x2eeff0(0x26b)]=='Hindi')var _0x2bacf8=users[_0x2eeff0(0x1f1)];else{if(_0x49ea2a[0x0][_0x2eeff0(0x26b)]==_0x2eeff0(0x207))var _0x2bacf8=users[_0x2eeff0(0x207)];else{if(_0x49ea2a[0x0][_0x2eeff0(0x26b)]==_0x2eeff0(0x234))var _0x2bacf8=users[_0x2eeff0(0x234)];else{if(_0x49ea2a[0x0][_0x2eeff0(0x26b)]=='French')var _0x2bacf8=users[_0x2eeff0(0x273)];else{if(_0x49ea2a[0x0]['language']==_0x2eeff0(0x248))var _0x2bacf8=users[_0x2eeff0(0x201)];else{if(_0x49ea2a[0x0]['language']==_0x2eeff0(0x24a))var _0x2bacf8=users[_0x2eeff0(0x24a)];else{if(_0x49ea2a[0x0]['language']==_0x2eeff0(0x232))var _0x2bacf8=users[_0x2eeff0(0x23e)];}}}}}}}_0x1b2770[_0x2eeff0(0x24b)](_0x2eeff0(0x1f4),{'success':_0x560242['flash']('success'),'errors':_0x560242[_0x2eeff0(0x21e)](_0x2eeff0(0x233)),'role':_0x25b59b,'profile':_0x3e9ca0,'adjustment':_0x206cb9,'stock':_0xd5ac6f,'master_shop':_0x49ea2a,'warehouse_name':_0x539feb,'unit':_0x5751cb,'language':_0x2bacf8,'rooms_data':_0x5696a,'ed_fullDate':_0x5bce86});}catch(_0x1b5e30){console[_0x2eeff0(0x1e6)](_0x1b5e30),_0x1b2770['status'](0xc8)[_0x2eeff0(0x1ec)]({'message':_0x1b5e30[_0x2eeff0(0x22e)]});}}),router[a0_0x149d1b(0x21d)](a0_0x149d1b(0x1db),auth,async(_0x210f70,_0x7903d9)=>{var _0x4a3fc2=a0_0x149d1b;try{const _0x2cdb71=_0x210f70[_0x4a3fc2(0x1d9)]['id'],_0x16b8ca=await adjustment_finished[_0x4a3fc2(0x21c)]({'_id':_0x2cdb71}),_0x3f39ee=await warehouse[_0x4a3fc2(0x27b)]({'name':_0x16b8ca[_0x4a3fc2(0x202)],'room':_0x16b8ca['room']}),{warehouse_name:_0x1d7f30,date:_0x37205a,prod_name:_0x3ecfda,level:_0x2fe54e,isle:_0x189a0c,pallet:_0x51ba69,stock:_0x5ba59f,types:_0x2489b7,adjust_qty:_0x4c00b1,new_adjust_qty:_0x2e9050,note:_0x3136d0,Room_name:_0x3fb7ff,invoice:_0x42c46f,JO_number:_0x37f20e}=_0x210f70[_0x4a3fc2(0x22a)];if(typeof _0x3ecfda==_0x4a3fc2(0x27e))var _0x2ecb09=[_0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x216)]],_0x3d0133=[_0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x1c7)]],_0x31e844=[_0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x239)]],_0x1f97dc=[_0x210f70['body'][_0x4a3fc2(0x1c2)]],_0x11e2a8=[_0x210f70[_0x4a3fc2(0x22a)]['adjust_qty']],_0x1abe37=[_0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x284)]],_0x33ace2=[_0x210f70['body'][_0x4a3fc2(0x20a)]],_0x2a8678=[_0x210f70[_0x4a3fc2(0x22a)]['unit']],_0x58b278=[_0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x28d)]],_0x39683b=[_0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x228)]],_0x306151=[_0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x21f)]];else var _0x2ecb09=[..._0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x216)]],_0x3d0133=[..._0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x1c7)]],_0x31e844=[..._0x210f70['body'][_0x4a3fc2(0x239)]],_0x1f97dc=[..._0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x1c2)]],_0x11e2a8=[..._0x210f70['body'][_0x4a3fc2(0x1c6)]],_0x1abe37=[..._0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x284)]],_0x33ace2=[..._0x210f70['body'][_0x4a3fc2(0x20a)]],_0x2a8678=[..._0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x27a)]],_0x58b278=[..._0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x28d)]],_0x39683b=[..._0x210f70[_0x4a3fc2(0x22a)][_0x4a3fc2(0x228)]],_0x306151=[..._0x210f70['body']['expiry_date']];const _0x2dbc2b=_0x2ecb09[_0x4a3fc2(0x22f)](_0x404aa3=>{return _0x404aa3={'product_name':_0x404aa3};});_0x3d0133[_0x4a3fc2(0x218)]((_0x1e60ff,_0x1d7daa)=>{var _0x45046a=_0x4a3fc2;_0x2dbc2b[_0x1d7daa][_0x45046a(0x204)]=_0x1e60ff;}),_0x31e844['forEach']((_0x2007ce,_0x37aec0)=>{var _0x7de8dc=_0x4a3fc2;_0x2dbc2b[_0x37aec0][_0x7de8dc(0x1e5)]=_0x2007ce;}),_0x1f97dc[_0x4a3fc2(0x218)]((_0x2a0001,_0x44d8b2)=>{_0x2dbc2b[_0x44d8b2]['types']=_0x2a0001;}),_0x11e2a8[_0x4a3fc2(0x218)]((_0x19d558,_0xa1eb8c)=>{var _0x26fefa=_0x4a3fc2;_0x2dbc2b[_0xa1eb8c][_0x26fefa(0x1c6)]=_0x19d558;}),_0x1abe37[_0x4a3fc2(0x218)]((_0x30e83c,_0x13e5dd)=>{var _0x338b93=_0x4a3fc2;_0x2dbc2b[_0x13e5dd][_0x338b93(0x284)]=_0x30e83c;}),_0x2a8678[_0x4a3fc2(0x218)]((_0x269d7d,_0x48d4c1)=>{_0x2dbc2b[_0x48d4c1]['unit']=_0x269d7d;}),_0x58b278['forEach']((_0x7c0474,_0x3e0833)=>{var _0x18d71b=_0x4a3fc2;_0x2dbc2b[_0x3e0833][_0x18d71b(0x1ed)]=_0x7c0474;}),_0x33ace2[_0x4a3fc2(0x218)]((_0x17886c,_0x1dad07)=>{var _0x55d5ba=_0x4a3fc2;_0x2dbc2b[_0x1dad07][_0x55d5ba(0x1ff)]=_0x17886c;}),_0x39683b[_0x4a3fc2(0x218)]((_0x34ec1c,_0x3fcdaa)=>{var _0x4a98a5=_0x4a3fc2;_0x2dbc2b[_0x3fcdaa][_0x4a98a5(0x228)]=_0x34ec1c;}),_0x306151[_0x4a3fc2(0x218)]((_0x11b26a,_0x3801f2)=>{_0x2dbc2b[_0x3801f2]['expiry_date']=_0x11b26a;});const _0x30f1c6=_0x2dbc2b[_0x4a3fc2(0x208)](_0xc8b22f=>_0xc8b22f[_0x4a3fc2(0x1c6)]!=='0'&&_0xc8b22f[_0x4a3fc2(0x1c6)]!=='');var _0x50ec81=0x0;_0x30f1c6[_0x4a3fc2(0x218)](_0x3274e9=>{var _0x3cb054=_0x4a3fc2;console[_0x3cb054(0x1e6)]('foreach\x20newproduct',_0x3274e9),parseInt(_0x3274e9[_0x3cb054(0x1c6)])<=0x0&&_0x50ec81++;});if(_0x50ec81!=0x0)return _0x210f70[_0x4a3fc2(0x21e)](_0x4a3fc2(0x233),_0x4a3fc2(0x253)),_0x7903d9[_0x4a3fc2(0x245)](_0x4a3fc2(0x1e8));_0x16b8ca['warehouse_name']=_0x1d7f30,_0x16b8ca[_0x4a3fc2(0x1cf)]=_0x37205a,_0x16b8ca['product']=_0x30f1c6,_0x16b8ca[_0x4a3fc2(0x251)]=_0x3136d0,_0x16b8ca[_0x4a3fc2(0x265)]=_0x3fb7ff,_0x16b8ca[_0x4a3fc2(0x1e0)]=_0x42c46f,_0x16b8ca[_0x4a3fc2(0x238)]=_0x37f20e;const _0x2993e5=await _0x16b8ca['save'](),_0x5f5c63=await warehouse[_0x4a3fc2(0x27b)]({'name':_0x1d7f30,'room':_0x3fb7ff});_0x2993e5['product']['forEach'](_0x90df36=>{var _0x1435e7=_0x4a3fc2;const _0x5cdce3=_0x5f5c63['product_details'][_0x1435e7(0x22f)](_0x3e904d=>{var _0x558abb=_0x1435e7;_0x90df36[_0x558abb(0x1c2)]=='minus'?_0x3e904d[_0x558abb(0x1ef)]==_0x90df36[_0x558abb(0x1ef)]&&_0x3e904d[_0x558abb(0x204)]==_0x90df36['bay']&&(_0x3e904d[_0x558abb(0x262)]=parseInt(_0x3e904d[_0x558abb(0x262)])-parseInt(_0x90df36[_0x558abb(0x1c6)])):_0x3e904d[_0x558abb(0x1ef)]==_0x90df36[_0x558abb(0x1ef)]&&_0x3e904d[_0x558abb(0x204)]==_0x90df36[_0x558abb(0x204)]&&(_0x3e904d[_0x558abb(0x262)]=parseInt(_0x3e904d[_0x558abb(0x262)])+parseInt(_0x90df36[_0x558abb(0x1c6)]));});}),await _0x5f5c63[_0x4a3fc2(0x1c4)](),_0x210f70['flash'](_0x4a3fc2(0x211),_0x4a3fc2(0x1e7)),_0x7903d9[_0x4a3fc2(0x245)](_0x4a3fc2(0x225));}catch(_0x213f8f){console[_0x4a3fc2(0x1e6)](_0x213f8f);}}),router['post'](a0_0x149d1b(0x24f),async(_0x42ffb8,_0x194712)=>{var _0x27278e=a0_0x149d1b;const {primary_code:_0x4a17f1,warehouse_data:_0x163a12,rooms_data:_0x29432d,Roomslist:_0x101520}=_0x42ffb8[_0x27278e(0x22a)],_0x557ede=_0x101520[_0x27278e(0x1e3)](','),_0x37f21b=[];async function _0x8a8878(_0x2f8583){var _0x5bde2a=_0x27278e;const _0x3de9fb=await warehouse[_0x5bde2a(0x1e4)]([{'$match':{'name':_0x163a12,'room':_0x2f8583}},{'$unwind':_0x5bde2a(0x28c)},{'$match':{'product_details.primary_code':_0x4a17f1}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5bde2a(0x1da)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x5bde2a(0x205)},'secondary_code':{'$first':_0x5bde2a(0x223)},'product_code':{'$first':_0x5bde2a(0x27c)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5bde2a(0x247)},'type':{'$first':_0x5bde2a(0x206)},'pallet':{'$first':_0x5bde2a(0x287)},'unit':{'$first':_0x5bde2a(0x1cb)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x5bde2a(0x26d)},'rack':{'$first':_0x5bde2a(0x1c5)},'expiry_date':{'$first':_0x5bde2a(0x20f)},'production_date':{'$first':_0x5bde2a(0x27d)},'batch_code':{'$first':_0x5bde2a(0x1d7)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x5bde2a(0x275)},'roomNamed':{'$first':_0x5bde2a(0x1fc)},'invoice':{'$first':_0x5bde2a(0x23a)}}}]),_0x3994e5=await warehouse[_0x5bde2a(0x1e4)]([{'$match':{'name':_0x163a12,'room':_0x2f8583}},{'$unwind':_0x5bde2a(0x28c)},{'$match':{'product_details.secondary_code':_0x4a17f1}},{'$group':{'_id':_0x5bde2a(0x1d1),'name':{'$first':_0x5bde2a(0x1da)},'product_stock':{'$first':_0x5bde2a(0x237)},'primary_code':{'$first':_0x5bde2a(0x205)},'secondary_code':{'$first':_0x5bde2a(0x223)},'product_code':{'$first':_0x5bde2a(0x27c)},'level':{'$first':_0x5bde2a(0x212)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x5bde2a(0x206)},'pallet':{'$first':_0x5bde2a(0x287)},'unit':{'$first':_0x5bde2a(0x1cb)},'secondary_unit':{'$first':_0x5bde2a(0x1f7)},'storage':{'$first':_0x5bde2a(0x26d)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5bde2a(0x20f)},'production_date':{'$first':_0x5bde2a(0x27d)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x5bde2a(0x275)},'roomNamed':{'$first':_0x5bde2a(0x1fc)},'invoice':{'$first':_0x5bde2a(0x23a)}}}]);if(_0x3de9fb['length']>0x0)_0x37f21b[_0x5bde2a(0x279)](_0x3de9fb);else _0x3994e5[_0x5bde2a(0x1f5)]>0x0&&_0x37f21b[_0x5bde2a(0x279)](_0x3994e5);}const _0x48a8be=_0x557ede[_0x27278e(0x22f)](_0xb887ce=>_0x8a8878(_0xb887ce));await Promise[_0x27278e(0x252)](_0x48a8be),_0x194712[_0x27278e(0x1ec)](_0x37f21b);}),router[a0_0x149d1b(0x21d)](a0_0x149d1b(0x26c),async(_0x20b274,_0x69f1e)=>{var _0xe528e4=a0_0x149d1b;const {productCode:_0x48b0c6,bay:_0x5ee28b,warehouses:_0x280af5,room:_0x5b67c6}=_0x20b274['body'];console[_0xe528e4(0x1e6)](_0x20b274['body']);try{const _0x5cb833=await warehouse[_0xe528e4(0x1e4)]([{'$match':{'name':_0x280af5,'room':_0x5b67c6}},{'$unwind':_0xe528e4(0x28c)},{'$match':{'product_details.bay':parseInt(_0x5ee28b)}},{'$group':{'_id':_0xe528e4(0x1d1),'name':{'$first':_0xe528e4(0x1da)},'product_stock':{'$first':_0xe528e4(0x237)},'bay':{'$first':_0xe528e4(0x212)},'maxProducts':{'$first':_0xe528e4(0x235)}}}]);_0x69f1e['status'](0xc8)[_0xe528e4(0x1ec)](_0x5cb833);}catch(_0x2948f9){_0x69f1e['status'](0x194)[_0xe528e4(0x1ec)]({'message':_0x2948f9[_0xe528e4(0x22e)]});}}),module[a0_0x149d1b(0x1c1)]=router;