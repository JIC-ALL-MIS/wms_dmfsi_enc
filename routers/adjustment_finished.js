function a0_0x3d5d(){var _0x11a8ec=['logo','errors','4591485kYASOQ','product_date','invoice','product_name','$product_details.expiry_date','level','room','$product_details.product_name','$product_details.secondary_code','aggregate','An\x20error\x20occurred.','</head><body>','$product_details.bay','warehouse_name','note','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','master','Portuguese\x20(BR)','catch','post','product','<!DOCTYPE\x20html>','date','</td>','$product_details.bin','email','status','expiry_date','product_stock','<div>','$product_details.maxProducts','/adjustment_finished/view','English\x20(US)','add_adjustment_finished','New_Qty_Converted_adj','secondary_unit','staff','1796856YXJTjf','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','True','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.type','</h5>','/view','28ZDmrfU','prod_code','adjust_qty','$product_details','map','back','$invoice','maxPerUnit','Chinese','</div>','exports','express','types','purchases_data','$product.product_name','role','json','random','Enclosed','$product_details.floorlevel','/preview/:id','message','$product_details.unit','Return\x20Rooms','product_code','stockBefore','French','$product_details.batch_code','</span>','floor','<hr\x20class=\x22my-3\x22>','/upload/','user','Primary_Units','room_names','image','language','get','$name','/barcode_scanner','$product_details.product_code','findOne','46872HQogwm','padStart','1616645ETtTTI','flash','$product_details._id','$warehouse_name','Rooms','stock','getDate','push','$product_details.production_date','../middleware/auth','foreach\x20newproduct','/CheckingWarehouse','German','success','JO_number','</tbody>','$product_details.rack','\x20Order\x20Number\x20:\x20','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Logo.png','prod_invoice','_id','</thead>','adjustment\x20add\x20successfull','bay','$finalize','getMonth','find','$product_details.primary_code','../public/language/languages.json','redirect','$product','render','product_details','$product_details.invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','error','Finished\x20Goods','forEach','Ambient','length','An\x20error\x20occurred\x20while\x20saving\x20data.','ADJF-','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Secondary_units','/view/:id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','params','English','findById','log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','prod_name','Portuguese','batch_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Router','Enabled','body','slice','nodemailer','then','$product_details.secondary_unit','adjustment\x20data\x20update\x20successfully','<h5>','minus','1632416gnVKTB','filter','Arabic','sendMail','$product_details.maxPerUnit','$_id','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','edit_adjustment_finished_view','unit','Arabic\x20(ae)','</body></html>','prod_cat','Email\x20sent\x20successfully','/view/add_adjustment','<tr>','warehouse','split','adjustment_finished','Spanish','string','$date','342486PQTAMI','<strong>\x20Regards\x20</strong>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Error\x20Occurs','$room','site_title','14763KqEKOB','/../public','new_adjust_qty','password','save','Hindi','$product_details.product_stock','/adjustment_finished/preview/','QA\x20Warehouse','add','7rjXoWZ','Adjustment\x20Finalize\x20Successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'];a0_0x3d5d=function(){return _0x11a8ec;};return a0_0x3d5d();}var a0_0x3ff8a4=a0_0x1cc6;(function(_0x1ffbe1,_0x16fbd3){var _0x1c1baa=a0_0x1cc6,_0x145a05=_0x1ffbe1();while(!![]){try{var _0x42e44d=parseInt(_0x1c1baa(0x1a8))/0x1+-parseInt(_0x1c1baa(0x13d))/0x2+parseInt(_0x1c1baa(0x143))/0x3*(parseInt(_0x1c1baa(0x17e))/0x4)+-parseInt(_0x1c1baa(0x1aa))/0x5+parseInt(_0x1c1baa(0x177))/0x6+parseInt(_0x1c1baa(0x14d))/0x7*(-parseInt(_0x1c1baa(0x127))/0x8)+parseInt(_0x1c1baa(0x152))/0x9;if(_0x42e44d===_0x16fbd3)break;else _0x145a05['push'](_0x145a05['shift']());}catch(_0x187806){_0x145a05['push'](_0x145a05['shift']());}}}(a0_0x3d5d,0x2ef50));const express=require(a0_0x3ff8a4(0x189)),app=express(),router=express[a0_0x3ff8a4(0x11d)](),auth=require(a0_0x3ff8a4(0x1b3)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require('../models/all_models'),users=require(a0_0x3ff8a4(0x102)),nodemailer=require(a0_0x3ff8a4(0x121));router[a0_0x3ff8a4(0x1a3)](a0_0x3ff8a4(0x17d),auth,async(_0x462442,_0x1cd026)=>{var _0x246c17=a0_0x3ff8a4;try{const {username:_0x5778e3,email:_0x339862,role:_0x39c897}=_0x462442[_0x246c17(0x19e)],_0x5bce23=_0x462442[_0x246c17(0x19e)],_0x171c40=await profile[_0x246c17(0x1a7)]({'email':_0x5bce23[_0x246c17(0x16b)]}),_0x2a03f2=await master_shop[_0x246c17(0x100)]();let _0x4bdce2;if(_0x5bce23[_0x246c17(0x18d)]=='staff'){const _0x3f1bb9=await staff[_0x246c17(0x1a7)]({'email':_0x5bce23[_0x246c17(0x16b)]});_0x4bdce2=await warehouse[_0x246c17(0x100)]({'status':_0x246c17(0x11e),'name':_0x3f1bb9[_0x246c17(0x137)]});}else _0x4bdce2=await warehouse['find']({'status':_0x246c17(0x11e)});const _0x46b11e=await product[_0x246c17(0x100)]();let _0x2a7a16;if(_0x5bce23[_0x246c17(0x18d)]==_0x246c17(0x176)){const _0x1852ee=await staff['findOne']({'email':_0x5bce23[_0x246c17(0x16b)]});_0x2a7a16=await adjustment_finished[_0x246c17(0x100)]({'warehouse_name':_0x1852ee[_0x246c17(0x137)]});}else _0x2a7a16=await adjustment_finished[_0x246c17(0x15b)]([{'$unwind':'$product'},{'$group':{'_id':_0x246c17(0x12c),'invoice':{'$first':_0x246c17(0x184)},'date':{'$first':_0x246c17(0x13c)},'warehouse_name':{'$first':_0x246c17(0x1ad)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x246c17(0xfe)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x2a03f2[0x0]['language']==_0x246c17(0x172)){var _0x1b5043=users[_0x246c17(0x115)];console['log'](_0x1b5043);}else{if(_0x2a03f2[0x0][_0x246c17(0x1a2)]==_0x246c17(0x148))var _0x1b5043=users[_0x246c17(0x148)];else{if(_0x2a03f2[0x0][_0x246c17(0x1a2)]==_0x246c17(0x1b6))var _0x1b5043=users[_0x246c17(0x1b6)];else{if(_0x2a03f2[0x0][_0x246c17(0x1a2)]==_0x246c17(0x13a))var _0x1b5043=users[_0x246c17(0x13a)];else{if(_0x2a03f2[0x0][_0x246c17(0x1a2)]==_0x246c17(0x198))var _0x1b5043=users['French'];else{if(_0x2a03f2[0x0][_0x246c17(0x1a2)]==_0x246c17(0x163))var _0x1b5043=users[_0x246c17(0x11a)];else{if(_0x2a03f2[0x0][_0x246c17(0x1a2)]==_0x246c17(0x186))var _0x1b5043=users[_0x246c17(0x186)];else{if(_0x2a03f2[0x0]['language']==_0x246c17(0x131))var _0x1b5043=users[_0x246c17(0x129)];}}}}}}}_0x1cd026[_0x246c17(0x105)](_0x246c17(0x139),{'success':_0x462442['flash'](_0x246c17(0x1b7)),'errors':_0x462442[_0x246c17(0x1ab)]('errors'),'role':_0x5bce23,'profile':_0x171c40,'warehouse':_0x4bdce2,'product':_0x46b11e,'adjustment':_0x2a7a16,'master_shop':_0x2a03f2,'language':_0x1b5043});}catch(_0x4b0c46){console['log'](_0x4b0c46);}});async function getRandom8DigitNumber(){var _0x342bba=a0_0x3ff8a4;const _0x45e382=0x989680,_0x23982a=0x5f5e0ff,_0x44b3ca=Math[_0x342bba(0x19b)](Math[_0x342bba(0x18f)]()*(_0x23982a-_0x45e382+0x1))+_0x45e382;var _0x4054ec;const _0x113d60=await adjustment_finished['findOne']({'invoice':_0x342bba(0x10f)+_0x44b3ca});return _0x113d60&&_0x113d60['length']>0x0?_0x4054ec=_0x342bba(0x10f)+_0x44b3ca:_0x4054ec='ADJF-'+_0x44b3ca,_0x4054ec;}function a0_0x1cc6(_0x115265,_0x46065a){var _0x3d5d18=a0_0x3d5d();return a0_0x1cc6=function(_0x1cc69a,_0x32192d){_0x1cc69a=_0x1cc69a-0xf1;var _0x55f9a5=_0x3d5d18[_0x1cc69a];return _0x55f9a5;},a0_0x1cc6(_0x115265,_0x46065a);}router[a0_0x3ff8a4(0x1a3)](a0_0x3ff8a4(0x135),auth,async(_0x44e275,_0x160138)=>{var _0x3d40fa=a0_0x3ff8a4;try{const {username:_0x464967,email:_0x4f6e51,role:_0x6d539a}=_0x44e275[_0x3d40fa(0x19e)],_0x4be740=_0x44e275[_0x3d40fa(0x19e)],_0x47be97=await profile[_0x3d40fa(0x1a7)]({'email':_0x4be740[_0x3d40fa(0x16b)]}),_0x583d6b=await master_shop['find']();let _0xc22d55;if(_0x4be740[_0x3d40fa(0x18d)]==_0x3d40fa(0x176)){const _0x7c9f90=await staff['findOne']({'email':_0x4be740[_0x3d40fa(0x16b)]});_0xc22d55=await warehouse[_0x3d40fa(0x15b)]([{'$match':{'status':_0x3d40fa(0x11e),'name':_0x7c9f90['warehouse'],'warehouse_category':_0x3d40fa(0x10a),'name':{'$ne':_0x3d40fa(0x14b)}}},{'$group':{'_id':_0x3d40fa(0x1a4),'name':{'$first':_0x3d40fa(0x1a4)}}}]);}else _0xc22d55=await warehouse[_0x3d40fa(0x15b)]([{'$match':{'status':_0x3d40fa(0x11e),'warehouse_category':_0x3d40fa(0x10a),'name':{'$ne':_0x3d40fa(0x14b)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x349ec7=await product[_0x3d40fa(0x100)]({}),_0x719096=await adjustment_finished[_0x3d40fa(0x100)]({}),_0x3aae25=_0x719096[_0x3d40fa(0x10d)]+0x1,_0xfc9c2f=_0x3d40fa(0x10f)+_0x3aae25['toString']()[_0x3d40fa(0x1a9)](0x5,'0');var _0x8a1b1e=[_0x3d40fa(0x10c),_0x3d40fa(0x190),_0x3d40fa(0x195)];if(_0x583d6b[0x0][_0x3d40fa(0x1a2)]=='English\x20(US)')var _0x3dc875=users[_0x3d40fa(0x115)];else{if(_0x583d6b[0x0][_0x3d40fa(0x1a2)]==_0x3d40fa(0x148))var _0x3dc875=users['Hindi'];else{if(_0x583d6b[0x0][_0x3d40fa(0x1a2)]==_0x3d40fa(0x1b6))var _0x3dc875=users[_0x3d40fa(0x1b6)];else{if(_0x583d6b[0x0][_0x3d40fa(0x1a2)]==_0x3d40fa(0x13a))var _0x3dc875=users[_0x3d40fa(0x13a)];else{if(_0x583d6b[0x0][_0x3d40fa(0x1a2)]==_0x3d40fa(0x198))var _0x3dc875=users[_0x3d40fa(0x198)];else{if(_0x583d6b[0x0][_0x3d40fa(0x1a2)]==_0x3d40fa(0x163))var _0x3dc875=users[_0x3d40fa(0x11a)];else{if(_0x583d6b[0x0][_0x3d40fa(0x1a2)]=='Chinese')var _0x3dc875=users[_0x3d40fa(0x186)];else{if(_0x583d6b[0x0]['language']=='Arabic\x20(ae)')var _0x3dc875=users[_0x3d40fa(0x129)];}}}}}}}const _0x1096e5=getRandom8DigitNumber();_0x1096e5[_0x3d40fa(0x122)](_0x2d8ebc=>{var _0x1f7e1d=_0x3d40fa;_0x160138[_0x1f7e1d(0x105)](_0x1f7e1d(0x173),{'success':_0x44e275['flash'](_0x1f7e1d(0x1b7)),'errors':_0x44e275[_0x1f7e1d(0x1ab)](_0x1f7e1d(0x151)),'role':_0x4be740,'profile':_0x47be97,'warehouse':_0xc22d55,'product':_0x349ec7,'master_shop':_0x583d6b,'language':_0x3dc875,'rooms_data':_0x8a1b1e,'invoice_no':_0x2d8ebc});})[_0x3d40fa(0x164)](_0x3dd752=>{var _0x5c1669=_0x3d40fa;_0x44e275[_0x5c1669(0x1ab)](_0x5c1669(0x151),_0x5c1669(0x110)),_0x160138[_0x5c1669(0x103)]('/adjustment/view');});}catch(_0x17d0c6){console[_0x3d40fa(0x117)](_0x17d0c6);}}),router[a0_0x3ff8a4(0x165)](a0_0x3ff8a4(0x135),auth,async(_0x2da9ae,_0x30666a)=>{var _0x7cbf9f=a0_0x3ff8a4;try{const {warehouse_name:_0x2bb6cc,date:_0x1dd848,prod_name:_0x4dc584,level:_0x123b27,isle:_0x58c8b6,pallet:_0x496772,stock:_0xb9488c,types:_0x359c14,adjust_qty:_0x36b07b,new_adjust_qty:_0x73d807,note:_0x1f3469,Room_name:_0x594588,invoice:_0x5c376f,JO_number:_0x40e541,expiry_date:_0x2bc56a}=_0x2da9ae[_0x7cbf9f(0x11f)];if(typeof _0x4dc584=='string')var _0x172558=[_0x2da9ae['body'][_0x7cbf9f(0x119)]],_0x6f11f5=[_0x2da9ae['body']['level']],_0x145ef6=[_0x2da9ae[_0x7cbf9f(0x11f)]['stock']],_0x52200d=[_0x2da9ae[_0x7cbf9f(0x11f)]['types']],_0x3624cb=[_0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x174)]],_0x5cd249=[_0x2da9ae[_0x7cbf9f(0x11f)]['New_Qty_Converted']],_0x2fbe82=[_0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x19f)]],_0x3a068c=[_0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x111)]],_0xf0bf2a=[_0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x17f)]],_0x2b8cc7=[_0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x11b)]],_0x5c853b=[_0x2da9ae['body'][_0x7cbf9f(0x16d)]],_0xdd6a94=[_0x2da9ae[_0x7cbf9f(0x11f)]['product_date']],_0x4138b5=[_0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x133)]],_0x46ba6c=[_0x2da9ae['body'][_0x7cbf9f(0x1ae)]],_0x16b5bd=[_0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x185)]],_0x5037f7=[_0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0xf9)]];else var _0x172558=[..._0x2da9ae[_0x7cbf9f(0x11f)]['prod_name']],_0x6f11f5=[..._0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x157)]],_0x145ef6=[..._0x2da9ae['body'][_0x7cbf9f(0x1af)]],_0x52200d=[..._0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x18a)]],_0x3624cb=[..._0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x174)]],_0x5cd249=[..._0x2da9ae[_0x7cbf9f(0x11f)]['New_Qty_Converted']],_0x2fbe82=[..._0x2da9ae[_0x7cbf9f(0x11f)]['Primary_Units']],_0x3a068c=[..._0x2da9ae['body']['Secondary_units']],_0xf0bf2a=[..._0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x17f)]],_0x2b8cc7=[..._0x2da9ae['body'][_0x7cbf9f(0x11b)]],_0x5c853b=[..._0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x16d)]],_0xdd6a94=[..._0x2da9ae[_0x7cbf9f(0x11f)][_0x7cbf9f(0x153)]],_0x4138b5=[..._0x2da9ae['body']['prod_cat']],_0x46ba6c=[..._0x2da9ae['body']['Rooms']],_0x16b5bd=[..._0x2da9ae[_0x7cbf9f(0x11f)]['maxPerUnit']],_0x5037f7=[..._0x2da9ae[_0x7cbf9f(0x11f)]['prod_invoice']];const _0x177236=_0x172558[_0x7cbf9f(0x182)](_0xec39a9=>{return _0xec39a9={'product_name':_0xec39a9};});_0x6f11f5[_0x7cbf9f(0x10b)]((_0x137ade,_0x6166db)=>{var _0x11300f=_0x7cbf9f;_0x177236[_0x6166db][_0x11300f(0xfd)]=_0x137ade;}),_0x145ef6[_0x7cbf9f(0x10b)]((_0x3cd960,_0x101e61)=>{var _0x2e98b3=_0x7cbf9f;_0x177236[_0x101e61][_0x2e98b3(0x197)]=_0x3cd960;}),_0x52200d[_0x7cbf9f(0x10b)]((_0x249e9b,_0x4e4d04)=>{var _0x3ba924=_0x7cbf9f;_0x177236[_0x4e4d04][_0x3ba924(0x18a)]=_0x249e9b;}),_0x3624cb['forEach']((_0x316b09,_0x4b2489)=>{var _0x41d65e=_0x7cbf9f;_0x177236[_0x4b2489][_0x41d65e(0x180)]=_0x316b09;}),_0x5cd249[_0x7cbf9f(0x10b)]((_0x407202,_0x3116d1)=>{var _0x590de6=_0x7cbf9f;_0x177236[_0x3116d1][_0x590de6(0x145)]=_0x407202;}),_0x2fbe82['forEach']((_0x1af845,_0x3af295)=>{var _0x2d6ea3=_0x7cbf9f;_0x177236[_0x3af295][_0x2d6ea3(0x130)]=_0x1af845;}),_0x3a068c['forEach']((_0x42e190,_0xa2405d)=>{var _0x3888ef=_0x7cbf9f;_0x177236[_0xa2405d][_0x3888ef(0x175)]=_0x42e190;}),_0xf0bf2a['forEach']((_0x3fd719,_0x1a4fef)=>{_0x177236[_0x1a4fef]['product_code']=_0x3fd719;}),_0x2b8cc7['forEach']((_0x302868,_0x4bc367)=>{var _0x255272=_0x7cbf9f;_0x177236[_0x4bc367][_0x255272(0x11b)]=_0x302868;}),_0x5c853b[_0x7cbf9f(0x10b)]((_0x7e0ab2,_0xc7ab9f)=>{_0x177236[_0xc7ab9f]['expiry_date']=_0x7e0ab2;}),_0xdd6a94[_0x7cbf9f(0x10b)]((_0x4b3fbf,_0x1a5928)=>{var _0x23b6a4=_0x7cbf9f;_0x177236[_0x1a5928][_0x23b6a4(0x12d)]=_0x4b3fbf;}),_0x4138b5['forEach']((_0x1e3bf,_0x19f052)=>{_0x177236[_0x19f052]['prod_cat']=_0x1e3bf;}),_0x46ba6c[_0x7cbf9f(0x10b)]((_0x49c594,_0x878d9e)=>{var _0x212445=_0x7cbf9f;_0x177236[_0x878d9e][_0x212445(0x1a0)]=_0x49c594;}),_0x16b5bd[_0x7cbf9f(0x10b)]((_0x28d8df,_0x4e9139)=>{var _0x887dce=_0x7cbf9f;_0x177236[_0x4e9139][_0x887dce(0x185)]=_0x28d8df;}),_0x5037f7['forEach']((_0xda17f,_0x3aa84a)=>{_0x177236[_0x3aa84a]['invoice']=_0xda17f;});const _0xdf38c8=_0x177236[_0x7cbf9f(0x128)](_0x5066f1=>_0x5066f1['adjust_qty']!=='0'&&_0x5066f1['adjust_qty']!=='');var _0x37644e=0x0;_0xdf38c8[_0x7cbf9f(0x10b)](_0x35ceab=>{var _0x48ab36=_0x7cbf9f;console[_0x48ab36(0x117)](_0x48ab36(0x1b4),_0x35ceab),parseInt(_0x35ceab[_0x48ab36(0x180)])<=0x0&&_0x37644e++;});if(_0x37644e!=0x0)return _0x2da9ae[_0x7cbf9f(0x1ab)](_0x7cbf9f(0x151),_0x7cbf9f(0x17a)),_0x30666a[_0x7cbf9f(0x103)](_0x7cbf9f(0x183));const _0x592bb3=new adjustment_finished({'warehouse_name':_0x2bb6cc,'date':_0x1dd848,'product':_0xdf38c8,'note':_0x1f3469,'room':_0x594588,'invoice':_0x5c376f,'JO_number':_0x40e541,'expiry_date':_0x2bc56a}),_0x4c7215=await _0x592bb3['save']();_0x2da9ae[_0x7cbf9f(0x1ab)](_0x7cbf9f(0x1b7),_0x7cbf9f(0xfc)),_0x30666a[_0x7cbf9f(0x103)](_0x7cbf9f(0x14a)+_0x4c7215[_0x7cbf9f(0xfa)]);}catch(_0x3a5f8){console[_0x7cbf9f(0x117)](_0x3a5f8),_0x30666a[_0x7cbf9f(0x16c)](0xc8)[_0x7cbf9f(0x18e)]({'message':_0x3a5f8[_0x7cbf9f(0x193)]});}}),router[a0_0x3ff8a4(0x1a3)](a0_0x3ff8a4(0x192),auth,async(_0x586a68,_0x2282c3)=>{var _0x1e8f7b=a0_0x3ff8a4;try{const {username:_0x38fd96,email:_0x3fd22c,role:_0x136989}=_0x586a68[_0x1e8f7b(0x19e)],_0x4dd12a=_0x586a68['user'],_0x29ac9c=await profile['findOne']({'email':_0x4dd12a[_0x1e8f7b(0x16b)]}),_0x57ccc6=await master_shop[_0x1e8f7b(0x100)](),_0x1647d7=_0x586a68[_0x1e8f7b(0x114)]['id'],_0x16efe2=await adjustment_finished['findById']({'_id':_0x1647d7}),_0x53df9c=await purchases[_0x1e8f7b(0x15b)]([{'$match':{'warehouse_name':_0x16efe2[_0x1e8f7b(0x15f)]}},{'$unwind':_0x1e8f7b(0x104)},{'$group':{'_id':_0x1e8f7b(0x18c)}}]);console['log']('purchases_data',_0x53df9c);const _0x3c63a5=await product[_0x1e8f7b(0x100)]({}),_0x1d0963=await warehouse[_0x1e8f7b(0x15b)]([{'$match':{'name':_0x16efe2['warehouse_name'],'warehouse_category':_0x1e8f7b(0x10a)}},{'$unwind':_0x1e8f7b(0x181)},{'$group':{'_id':_0x1e8f7b(0x1ac),'name':{'$first':_0x1e8f7b(0x159)},'product_stock':{'$first':_0x1e8f7b(0x149)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x1e8f7b(0x17b)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1e8f7b(0x101)},'secondary_code':{'$first':_0x1e8f7b(0x15a)},'product_code':{'$first':_0x1e8f7b(0x1a6)},'storage':{'$first':_0x1e8f7b(0xf6)},'rack':{'$first':_0x1e8f7b(0xf3)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1e8f7b(0x1b2)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x1e8f7b(0x12b)},'room':{'$first':_0x1e8f7b(0x141)}}}]);if(_0x57ccc6[0x0]['language']=='English\x20(US)'){var _0x1eed90=users['English'];console[_0x1e8f7b(0x117)](_0x1eed90);}else{if(_0x57ccc6[0x0][_0x1e8f7b(0x1a2)]==_0x1e8f7b(0x148))var _0x1eed90=users[_0x1e8f7b(0x148)];else{if(_0x57ccc6[0x0][_0x1e8f7b(0x1a2)]==_0x1e8f7b(0x1b6))var _0x1eed90=users[_0x1e8f7b(0x1b6)];else{if(_0x57ccc6[0x0]['language']==_0x1e8f7b(0x13a))var _0x1eed90=users[_0x1e8f7b(0x13a)];else{if(_0x57ccc6[0x0]['language']==_0x1e8f7b(0x198))var _0x1eed90=users[_0x1e8f7b(0x198)];else{if(_0x57ccc6[0x0][_0x1e8f7b(0x1a2)]==_0x1e8f7b(0x163))var _0x1eed90=users['Portuguese'];else{if(_0x57ccc6[0x0]['language']==_0x1e8f7b(0x186))var _0x1eed90=users['Chinese'];else{if(_0x57ccc6[0x0][_0x1e8f7b(0x1a2)]==_0x1e8f7b(0x131))var _0x1eed90=users[_0x1e8f7b(0x129)];}}}}}}}_0x2282c3['render'](_0x1e8f7b(0x12f),{'success':_0x586a68['flash'](_0x1e8f7b(0x1b7)),'errors':_0x586a68[_0x1e8f7b(0x1ab)](_0x1e8f7b(0x151)),'role':_0x4dd12a,'profile':_0x29ac9c,'adjustment':_0x16efe2,'stock':_0x1d0963,'master_shop':_0x57ccc6,'warehouse_name':_0x53df9c,'unit':_0x3c63a5,'language':_0x1eed90});}catch(_0x53f6a7){console[_0x1e8f7b(0x117)](_0x53f6a7),_0x2282c3[_0x1e8f7b(0x16c)](0xc8)['json']({'message':_0x53f6a7['message']});}}),router[a0_0x3ff8a4(0x165)]('/preview/:id',auth,async(_0x254e58,_0x59dccb)=>{var _0x264e57=a0_0x3ff8a4;try{const {invoice:_0x4d4ab9,warehouse_name:_0x2d4a73,Room_name:_0x5ed47f}=_0x254e58[_0x264e57(0x11f)],_0x3d81f9=_0x254e58[_0x264e57(0x114)]['id'],_0xa50dd1=await adjustment_finished['findById']({'_id':_0x3d81f9});var _0x18834e;const _0x8ac609=_0xa50dd1['product'][_0x264e57(0x182)](async _0x5547e1=>{var _0x61566=_0x264e57;if(_0x5547e1[_0x61566(0x180)]>0x0){_0x18834e=await warehouse[_0x61566(0x1a7)]({'name':_0x2d4a73,'room':_0x5547e1[_0x61566(0x1a0)],'warehouse_category':_0x61566(0x10a)});const _0x39a8db=_0x18834e[_0x61566(0x106)][_0x61566(0x182)](_0x42d964=>{var _0x581b8f=_0x61566;console['log'](_0x5547e1[_0x581b8f(0x18a)]);if(_0x5547e1[_0x581b8f(0x18a)]==_0x581b8f(0x126))_0x42d964[_0x581b8f(0x155)]==_0x5547e1[_0x581b8f(0x155)]&&_0x42d964[_0x581b8f(0xfd)]==_0x5547e1['bay']&&_0x42d964[_0x581b8f(0x16d)]==_0x5547e1['expiry_date']&&_0x42d964[_0x581b8f(0x12d)]==_0x5547e1[_0x581b8f(0x12d)]&&_0x42d964[_0x581b8f(0x11b)]==_0x5547e1[_0x581b8f(0x11b)]&&_0x42d964[_0x581b8f(0x154)]==_0x5547e1[_0x581b8f(0x154)]&&(_0x42d964[_0x581b8f(0x16e)]=_0x42d964[_0x581b8f(0x16e)]-_0x5547e1[_0x581b8f(0x180)]);else _0x5547e1[_0x581b8f(0x18a)]==_0x581b8f(0x14c)&&(_0x42d964['product_name']==_0x5547e1['product_name']&&_0x42d964['bay']==_0x5547e1[_0x581b8f(0xfd)]&&_0x42d964[_0x581b8f(0x16d)]==_0x5547e1[_0x581b8f(0x16d)]&&_0x42d964[_0x581b8f(0x12d)]==_0x5547e1[_0x581b8f(0x12d)]&&_0x42d964[_0x581b8f(0x11b)]==_0x5547e1[_0x581b8f(0x11b)]&&_0x42d964[_0x581b8f(0x154)]==_0x5547e1[_0x581b8f(0x154)]&&(_0x42d964[_0x581b8f(0x16e)]=_0x42d964['product_stock']+_0x5547e1[_0x581b8f(0x180)]));});}return _0x18834e;});Promise['all'](_0x8ac609)[_0x264e57(0x122)](async _0x2748b0=>{var _0x43dd8d=_0x264e57;try{for(const _0x2339a1 of _0x2748b0){await _0x2339a1[_0x43dd8d(0x147)]();}_0xa50dd1['finalize']=_0x43dd8d(0x179);const _0x1fcdea=await _0xa50dd1[_0x43dd8d(0x147)](),_0x231726=await master_shop[_0x43dd8d(0x100)](),_0x44e082=await email_settings[_0x43dd8d(0x1a7)](),_0x27c905=await supervisor_settings[_0x43dd8d(0x100)]();var _0x1a90b4=_0xa50dd1[_0x43dd8d(0x166)],_0x31ecde='',_0x3c8ba;for(_0x3c8ba in _0x1a90b4){var _0xe8a03c='FG';_0xa50dd1[_0x43dd8d(0x15f)]=='DRY\x20GOODS'&&(_0xe8a03c='DG'),_0x31ecde+=_0x43dd8d(0x136)+_0x43dd8d(0x161)+_0x1a90b4[_0x3c8ba][_0x43dd8d(0x155)]+_0x43dd8d(0x169)+_0x43dd8d(0x161)+_0x1a90b4[_0x3c8ba]['product_code']+_0x43dd8d(0x169)+_0x43dd8d(0x161)+_0x1a90b4[_0x3c8ba][_0x43dd8d(0x180)]+'</td>'+_0x43dd8d(0x161)+_0x1a90b4[_0x3c8ba][_0x43dd8d(0x130)]+_0x43dd8d(0x169)+_0x43dd8d(0x161)+_0x1a90b4[_0x3c8ba][_0x43dd8d(0x175)]+'</td>'+_0x43dd8d(0x161)+_0xa50dd1[_0x43dd8d(0x15f)]+_0x43dd8d(0x169)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1a90b4[_0x3c8ba]['room_names']+'</td>'+_0x43dd8d(0x161)+_0xe8a03c+_0x1a90b4[_0x3c8ba]['bay']+_0x43dd8d(0x169)+'</tr>';}let _0x3d79e5=nodemailer['createTransport']({'host':_0x44e082['host'],'port':Number(_0x44e082['port']),'secure':![],'auth':{'user':_0x44e082['email'],'pass':_0x44e082[_0x43dd8d(0x146)]}}),_0x16c8b6={'from':_0x44e082['email'],'to':_0x27c905[0x0]['FGSEmail'],'subject':'Adjustment\x20Mail','attachments':[{'filename':_0x43dd8d(0xf8),'path':__dirname+_0x43dd8d(0x144)+_0x43dd8d(0x19d)+_0x231726[0x0][_0x43dd8d(0x1a1)],'cid':_0x43dd8d(0x150)}],'html':_0x43dd8d(0x167)+'<html><head><title></title>'+_0x43dd8d(0x15d)+_0x43dd8d(0x16f)+_0x43dd8d(0xf5)+'<div>'+_0x43dd8d(0x13f)+'</div>'+'<div>'+'<h2>\x20'+_0x231726[0x0][_0x43dd8d(0x142)]+'\x20</h2>'+_0x43dd8d(0x187)+_0x43dd8d(0x187)+_0x43dd8d(0x19c)+_0x43dd8d(0x16f)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x43dd8d(0xf4)+_0xa50dd1['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0xa50dd1[_0x43dd8d(0x168)]+'\x20'+_0x43dd8d(0x19a)+_0x43dd8d(0x17c)+'</div>'+_0x43dd8d(0x113)+_0x43dd8d(0x11c)+_0x43dd8d(0x136)+_0x43dd8d(0xf7)+_0x43dd8d(0x118)+_0x43dd8d(0x14f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x43dd8d(0x178)+_0x43dd8d(0x108)+_0x43dd8d(0x12e)+'</tr>'+_0x43dd8d(0xfb)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x31ecde+'\x20'+_0x43dd8d(0xf2)+'</table>'+_0x43dd8d(0x16f)+_0x43dd8d(0x13e)+_0x43dd8d(0x125)+_0x231726[0x0][_0x43dd8d(0x142)]+_0x43dd8d(0x17c)+_0x43dd8d(0x187)+_0x43dd8d(0x187)+_0x43dd8d(0x132)};_0x3d79e5[_0x43dd8d(0x12a)](_0x16c8b6,function(_0x340076,_0x1f223c){var _0x41e685=_0x43dd8d;_0x340076?(console[_0x41e685(0x117)](_0x340076),console[_0x41e685(0x117)](_0x41e685(0x140))):console[_0x41e685(0x117)](_0x41e685(0x134));}),_0x254e58[_0x43dd8d(0x1ab)](_0x43dd8d(0x1b7),_0x43dd8d(0x14e)),_0x59dccb['redirect']('/picking_list/PDF_adjustment/'+_0x1fcdea[_0x43dd8d(0xfa)]);}catch(_0x238607){console['error'](_0x238607),_0x59dccb['status'](0x1f4)[_0x43dd8d(0x18e)]({'error':_0x43dd8d(0x10e)});}})[_0x264e57(0x164)](_0x4751b0=>{var _0x4d84ef=_0x264e57;console[_0x4d84ef(0x109)](_0x4751b0),_0x59dccb['status'](0x1f4)[_0x4d84ef(0x18e)]({'error':_0x4d84ef(0x15c)});});}catch(_0x21f956){_0x59dccb[_0x264e57(0x18e)]({'message':_0x21f956[_0x264e57(0x193)]});}}),router[a0_0x3ff8a4(0x1a3)](a0_0x3ff8a4(0x112),auth,async(_0x306d87,_0x4258e6)=>{var _0x5984a7=a0_0x3ff8a4;try{const {username:_0x4dbec2,email:_0x206e74,role:_0x4bca9b}=_0x306d87[_0x5984a7(0x19e)],_0x253e56=_0x306d87[_0x5984a7(0x19e)],_0x376529=await profile['findOne']({'email':_0x253e56[_0x5984a7(0x16b)]}),_0x22ca91=await master_shop['find']();console[_0x5984a7(0x117)](_0x5984a7(0x162),_0x22ca91);const _0x1ab7ae=_0x306d87[_0x5984a7(0x114)]['id'],_0x9d2779=await adjustment_finished[_0x5984a7(0x116)]({'_id':_0x1ab7ae});let _0x2cc468=new Date(_0x9d2779[_0x5984a7(0x16d)]),_0x536d06=('0'+_0x2cc468[_0x5984a7(0x1b0)]())[_0x5984a7(0x120)](-0x2),_0x49362b=('0'+(_0x2cc468[_0x5984a7(0xff)]()+0x1))[_0x5984a7(0x120)](-0x2),_0x23198d=_0x2cc468['getFullYear'](),_0x2c8e1f=_0x23198d+'-'+_0x49362b+'-'+_0x536d06;var _0x3e219f=['Ambient',_0x5984a7(0x190),_0x5984a7(0x195)];const _0x3243b5=await purchases[_0x5984a7(0x15b)]([{'$match':{'warehouse_name':_0x9d2779[_0x5984a7(0x15f)]}},{'$unwind':_0x5984a7(0x104)},{'$group':{'_id':_0x5984a7(0x18c)}}]);console[_0x5984a7(0x117)](_0x5984a7(0x18b),_0x3243b5);const _0x2eac95=await product[_0x5984a7(0x100)]({}),_0x39420f=await warehouse[_0x5984a7(0x15b)]([{'$match':{'name':_0x9d2779['warehouse_name'],'room':_0x9d2779[_0x5984a7(0x158)]}},{'$unwind':_0x5984a7(0x181)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5984a7(0x159)},'product_stock':{'$first':_0x5984a7(0x149)},'bay':{'$first':_0x5984a7(0x15e)},'bin':{'$first':_0x5984a7(0x16a)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5984a7(0x191)},'primary_code':{'$first':_0x5984a7(0x101)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5984a7(0xf6)},'rack':{'$first':'$product_details.rack'}}}]);if(_0x22ca91[0x0][_0x5984a7(0x1a2)]==_0x5984a7(0x172)){var _0x173bac=users[_0x5984a7(0x115)];console[_0x5984a7(0x117)](_0x173bac);}else{if(_0x22ca91[0x0][_0x5984a7(0x1a2)]=='Hindi')var _0x173bac=users[_0x5984a7(0x148)];else{if(_0x22ca91[0x0][_0x5984a7(0x1a2)]==_0x5984a7(0x1b6))var _0x173bac=users['German'];else{if(_0x22ca91[0x0]['language']=='Spanish')var _0x173bac=users[_0x5984a7(0x13a)];else{if(_0x22ca91[0x0][_0x5984a7(0x1a2)]==_0x5984a7(0x198))var _0x173bac=users[_0x5984a7(0x198)];else{if(_0x22ca91[0x0][_0x5984a7(0x1a2)]==_0x5984a7(0x163))var _0x173bac=users[_0x5984a7(0x11a)];else{if(_0x22ca91[0x0]['language']==_0x5984a7(0x186))var _0x173bac=users[_0x5984a7(0x186)];else{if(_0x22ca91[0x0][_0x5984a7(0x1a2)]==_0x5984a7(0x131))var _0x173bac=users[_0x5984a7(0x129)];}}}}}}}_0x4258e6[_0x5984a7(0x105)]('edit_adjustment_finished',{'success':_0x306d87['flash'](_0x5984a7(0x1b7)),'errors':_0x306d87[_0x5984a7(0x1ab)](_0x5984a7(0x151)),'role':_0x253e56,'profile':_0x376529,'adjustment':_0x9d2779,'stock':_0x39420f,'master_shop':_0x22ca91,'warehouse_name':_0x3243b5,'unit':_0x2eac95,'language':_0x173bac,'rooms_data':_0x3e219f,'ed_fullDate':_0x2c8e1f});}catch(_0x2d78ae){console[_0x5984a7(0x117)](_0x2d78ae),_0x4258e6[_0x5984a7(0x16c)](0xc8)['json']({'message':_0x2d78ae[_0x5984a7(0x193)]});}}),router[a0_0x3ff8a4(0x165)](a0_0x3ff8a4(0x112),auth,async(_0x4840c1,_0x43d0d9)=>{var _0x581a30=a0_0x3ff8a4;try{const _0x15103e=_0x4840c1[_0x581a30(0x114)]['id'],_0x3544d5=await adjustment_finished[_0x581a30(0x116)]({'_id':_0x15103e}),_0x47eaf6=await warehouse['findOne']({'name':_0x3544d5['warehouse_name'],'room':_0x3544d5[_0x581a30(0x158)]}),{warehouse_name:_0x37d4b5,date:_0x3f0524,prod_name:_0x17d31a,level:_0x2f41b3,isle:_0x152de3,pallet:_0x53568e,stock:_0x218262,types:_0x95536b,adjust_qty:_0x5be7fe,new_adjust_qty:_0x520e94,note:_0x583577,Room_name:_0x24e6ae,invoice:_0x53400c,JO_number:_0x2c6d3d}=_0x4840c1[_0x581a30(0x11f)];if(typeof _0x17d31a==_0x581a30(0x13b))var _0x25a02f=[_0x4840c1[_0x581a30(0x11f)]['prod_name']],_0x372a02=[_0x4840c1[_0x581a30(0x11f)][_0x581a30(0x157)]],_0x2bc45f=[_0x4840c1[_0x581a30(0x11f)][_0x581a30(0x1af)]],_0x4614eb=[_0x4840c1['body'][_0x581a30(0x18a)]],_0x213140=[_0x4840c1[_0x581a30(0x11f)]['adjust_qty']],_0x55d389=[_0x4840c1['body'][_0x581a30(0x145)]],_0x1f0c82=[_0x4840c1[_0x581a30(0x11f)][_0x581a30(0x17f)]],_0x13641a=[_0x4840c1[_0x581a30(0x11f)]['unit']],_0x3acb5f=[_0x4840c1['body'][_0x581a30(0x111)]],_0x355fee=[_0x4840c1[_0x581a30(0x11f)][_0x581a30(0x11b)]],_0x414dbc=[_0x4840c1[_0x581a30(0x11f)]['expiry_date']];else var _0x25a02f=[..._0x4840c1['body']['prod_name']],_0x372a02=[..._0x4840c1[_0x581a30(0x11f)][_0x581a30(0x157)]],_0x2bc45f=[..._0x4840c1['body']['stock']],_0x4614eb=[..._0x4840c1['body']['types']],_0x213140=[..._0x4840c1['body'][_0x581a30(0x180)]],_0x55d389=[..._0x4840c1[_0x581a30(0x11f)][_0x581a30(0x145)]],_0x1f0c82=[..._0x4840c1['body'][_0x581a30(0x17f)]],_0x13641a=[..._0x4840c1['body'][_0x581a30(0x130)]],_0x3acb5f=[..._0x4840c1[_0x581a30(0x11f)]['Secondary_units']],_0x355fee=[..._0x4840c1[_0x581a30(0x11f)][_0x581a30(0x11b)]],_0x414dbc=[..._0x4840c1[_0x581a30(0x11f)][_0x581a30(0x16d)]];const _0x22aa74=_0x25a02f['map'](_0x2250b8=>{return _0x2250b8={'product_name':_0x2250b8};});_0x372a02[_0x581a30(0x10b)]((_0x2b1add,_0x59e282)=>{var _0x6c6f21=_0x581a30;_0x22aa74[_0x59e282][_0x6c6f21(0xfd)]=_0x2b1add;}),_0x2bc45f[_0x581a30(0x10b)]((_0xd7e203,_0x5b7498)=>{var _0x30ac27=_0x581a30;_0x22aa74[_0x5b7498][_0x30ac27(0x197)]=_0xd7e203;}),_0x4614eb['forEach']((_0x4caf5f,_0x5634f6)=>{var _0x12c1f4=_0x581a30;_0x22aa74[_0x5634f6][_0x12c1f4(0x18a)]=_0x4caf5f;}),_0x213140[_0x581a30(0x10b)]((_0x770190,_0xb31e5e)=>{var _0x5a0a30=_0x581a30;_0x22aa74[_0xb31e5e][_0x5a0a30(0x180)]=_0x770190;}),_0x55d389[_0x581a30(0x10b)]((_0x87ea1,_0x52eca2)=>{var _0x10b687=_0x581a30;_0x22aa74[_0x52eca2][_0x10b687(0x145)]=_0x87ea1;}),_0x13641a['forEach']((_0x429430,_0x3d6a49)=>{var _0x48bfd5=_0x581a30;_0x22aa74[_0x3d6a49][_0x48bfd5(0x130)]=_0x429430;}),_0x3acb5f[_0x581a30(0x10b)]((_0x5ecf45,_0x684b2a)=>{var _0x3cbcb3=_0x581a30;_0x22aa74[_0x684b2a][_0x3cbcb3(0x175)]=_0x5ecf45;}),_0x1f0c82[_0x581a30(0x10b)]((_0x17abb7,_0x2e4702)=>{var _0x322dc6=_0x581a30;_0x22aa74[_0x2e4702][_0x322dc6(0x196)]=_0x17abb7;}),_0x355fee[_0x581a30(0x10b)]((_0x948800,_0x55e21c)=>{var _0x4e10fe=_0x581a30;_0x22aa74[_0x55e21c][_0x4e10fe(0x11b)]=_0x948800;}),_0x414dbc['forEach']((_0x516772,_0x2b4b6c)=>{var _0x137ff8=_0x581a30;_0x22aa74[_0x2b4b6c][_0x137ff8(0x16d)]=_0x516772;});const _0x22f53a=_0x22aa74['filter'](_0x3131a6=>_0x3131a6[_0x581a30(0x180)]!=='0'&&_0x3131a6[_0x581a30(0x180)]!=='');var _0x312e3c=0x0;_0x22f53a[_0x581a30(0x10b)](_0x1b6672=>{var _0x1a5857=_0x581a30;console[_0x1a5857(0x117)](_0x1a5857(0x1b4),_0x1b6672),parseInt(_0x1b6672['adjust_qty'])<=0x0&&_0x312e3c++;});if(_0x312e3c!=0x0)return _0x4840c1[_0x581a30(0x1ab)](_0x581a30(0x151),_0x581a30(0x17a)),_0x43d0d9[_0x581a30(0x103)](_0x581a30(0x183));_0x3544d5[_0x581a30(0x15f)]=_0x37d4b5,_0x3544d5[_0x581a30(0x168)]=_0x3f0524,_0x3544d5[_0x581a30(0x166)]=_0x22f53a,_0x3544d5[_0x581a30(0x160)]=_0x583577,_0x3544d5[_0x581a30(0x158)]=_0x24e6ae,_0x3544d5[_0x581a30(0x154)]=_0x53400c,_0x3544d5[_0x581a30(0xf1)]=_0x2c6d3d;const _0x370ed=await _0x3544d5[_0x581a30(0x147)](),_0x4d122b=await warehouse[_0x581a30(0x1a7)]({'name':_0x37d4b5,'room':_0x24e6ae});_0x370ed['product']['forEach'](_0xbaa50=>{var _0x51580b=_0x581a30;const _0x57ef9f=_0x4d122b['product_details'][_0x51580b(0x182)](_0x56e74f=>{var _0x1e5232=_0x51580b;_0xbaa50[_0x1e5232(0x18a)]=='minus'?_0x56e74f[_0x1e5232(0x155)]==_0xbaa50[_0x1e5232(0x155)]&&_0x56e74f[_0x1e5232(0xfd)]==_0xbaa50['bay']&&(_0x56e74f[_0x1e5232(0x16e)]=parseInt(_0x56e74f[_0x1e5232(0x16e)])-parseInt(_0xbaa50['adjust_qty'])):_0x56e74f[_0x1e5232(0x155)]==_0xbaa50[_0x1e5232(0x155)]&&_0x56e74f[_0x1e5232(0xfd)]==_0xbaa50['bay']&&(_0x56e74f[_0x1e5232(0x16e)]=parseInt(_0x56e74f[_0x1e5232(0x16e)])+parseInt(_0xbaa50[_0x1e5232(0x180)]));});}),await _0x4d122b[_0x581a30(0x147)](),_0x4840c1[_0x581a30(0x1ab)](_0x581a30(0x1b7),_0x581a30(0x124)),_0x43d0d9[_0x581a30(0x103)](_0x581a30(0x171));}catch(_0x16c7b2){console[_0x581a30(0x117)](_0x16c7b2);}}),router[a0_0x3ff8a4(0x165)](a0_0x3ff8a4(0x1a5),async(_0x41ec1e,_0x17fd73)=>{var _0x15354f=a0_0x3ff8a4;const {primary_code:_0x4eb202,warehouse_data:_0x10f3f1,rooms_data:_0x5b2440,Roomslist:_0x5137ab}=_0x41ec1e[_0x15354f(0x11f)],_0x186406=_0x5137ab[_0x15354f(0x138)](','),_0x30ae5e=[];async function _0x34bb9b(_0x32558c){var _0x1f9663=_0x15354f;const _0x404cfe=await warehouse[_0x1f9663(0x15b)]([{'$match':{'name':_0x10f3f1,'room':_0x32558c}},{'$unwind':_0x1f9663(0x181)},{'$match':{'product_details.primary_code':_0x4eb202}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1f9663(0x159)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1f9663(0x1a6)},'level':{'$first':_0x1f9663(0x15e)},'isle':{'$first':_0x1f9663(0x16a)},'type':{'$first':_0x1f9663(0x17b)},'pallet':{'$first':_0x1f9663(0x191)},'unit':{'$first':_0x1f9663(0x194)},'secondary_unit':{'$first':_0x1f9663(0x123)},'storage':{'$first':_0x1f9663(0xf6)},'rack':{'$first':_0x1f9663(0xf3)},'expiry_date':{'$first':_0x1f9663(0x156)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x1f9663(0x199)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x1f9663(0x12b)},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x1f9663(0x107)}}}]),_0x4b4376=await warehouse[_0x1f9663(0x15b)]([{'$match':{'name':_0x10f3f1,'room':_0x32558c}},{'$unwind':_0x1f9663(0x181)},{'$match':{'product_details.secondary_code':_0x4eb202}},{'$group':{'_id':_0x1f9663(0x1ac),'name':{'$first':_0x1f9663(0x159)},'product_stock':{'$first':_0x1f9663(0x149)},'primary_code':{'$first':_0x1f9663(0x101)},'secondary_code':{'$first':_0x1f9663(0x15a)},'product_code':{'$first':_0x1f9663(0x1a6)},'level':{'$first':_0x1f9663(0x15e)},'isle':{'$first':_0x1f9663(0x16a)},'type':{'$first':_0x1f9663(0x17b)},'pallet':{'$first':_0x1f9663(0x191)},'unit':{'$first':_0x1f9663(0x194)},'secondary_unit':{'$first':_0x1f9663(0x123)},'storage':{'$first':_0x1f9663(0xf6)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1f9663(0x156)},'production_date':{'$first':_0x1f9663(0x1b2)},'batch_code':{'$first':_0x1f9663(0x199)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x1f9663(0x12b)},'roomNamed':{'$first':_0x1f9663(0x141)},'invoice':{'$first':_0x1f9663(0x107)}}}]);if(_0x404cfe[_0x1f9663(0x10d)]>0x0)_0x30ae5e['push'](_0x404cfe);else _0x4b4376[_0x1f9663(0x10d)]>0x0&&_0x30ae5e[_0x1f9663(0x1b1)](_0x4b4376);}const _0x229462=_0x186406[_0x15354f(0x182)](_0x1e6918=>_0x34bb9b(_0x1e6918));await Promise['all'](_0x229462),_0x17fd73['json'](_0x30ae5e);}),router['post'](a0_0x3ff8a4(0x1b5),async(_0xc154b7,_0x24b002)=>{var _0xa0dea4=a0_0x3ff8a4;const {productCode:_0x2cdb33,bay:_0x3ce3ef,warehouses:_0x960150,room:_0x580b85}=_0xc154b7[_0xa0dea4(0x11f)];console[_0xa0dea4(0x117)](_0xc154b7[_0xa0dea4(0x11f)]);try{const _0x5a4dd1=await warehouse[_0xa0dea4(0x15b)]([{'$match':{'name':_0x960150,'room':_0x580b85}},{'$unwind':_0xa0dea4(0x181)},{'$match':{'product_details.bay':parseInt(_0x3ce3ef)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xa0dea4(0x159)},'product_stock':{'$first':_0xa0dea4(0x149)},'bay':{'$first':_0xa0dea4(0x15e)},'maxProducts':{'$first':_0xa0dea4(0x170)}}}]);_0x24b002[_0xa0dea4(0x16c)](0xc8)[_0xa0dea4(0x18e)](_0x5a4dd1);}catch(_0x3d7f8c){_0x24b002['status'](0x194)[_0xa0dea4(0x18e)]({'message':_0x3d7f8c[_0xa0dea4(0x193)]});}}),module[a0_0x3ff8a4(0x188)]=router;