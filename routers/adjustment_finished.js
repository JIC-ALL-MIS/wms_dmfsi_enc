var a0_0x49a1d6=a0_0x2b83;(function(_0x5bb8e6,_0x40e28f){var _0x1ed6c2=a0_0x2b83,_0x1744db=_0x5bb8e6();while(!![]){try{var _0x295b50=parseInt(_0x1ed6c2(0x192))/0x1*(-parseInt(_0x1ed6c2(0x14d))/0x2)+parseInt(_0x1ed6c2(0x1c5))/0x3+-parseInt(_0x1ed6c2(0x17b))/0x4+parseInt(_0x1ed6c2(0x19c))/0x5+-parseInt(_0x1ed6c2(0x16e))/0x6*(-parseInt(_0x1ed6c2(0x209))/0x7)+parseInt(_0x1ed6c2(0x1f6))/0x8*(parseInt(_0x1ed6c2(0x15a))/0x9)+-parseInt(_0x1ed6c2(0x17f))/0xa;if(_0x295b50===_0x40e28f)break;else _0x1744db['push'](_0x1744db['shift']());}catch(_0x425304){_0x1744db['push'](_0x1744db['shift']());}}}(a0_0x305f,0x8a4fa));function a0_0x305f(){var _0x24a4f8=['adjustment\x20add\x20successfull','date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','production_date','forEach','$product_details._id','$product_details.invoice','staff','errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.floorlevel','$product_details.product_name','Ambient','True','room_names','/../public','$name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','73376EzyQbu','Rooms','Secondary_units','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','findOne','params','stockBefore','render','Hindi','$product_details','then','prod_name','/view','express','site_title','$finalize','Error\x20Occurs','getMonth','469OTpeuW','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<h5\x20style=\x22text-align:\x20left;\x22>','length','body','$product_details.secondary_code','$product_details.primary_code','Primary_Units','json','2LXQjYI','</thead>','purchases_data','map','</h5>','product','save','add','finalize','$product_details.type','/CheckingWarehouse','password','An\x20error\x20occurred\x20while\x20saving\x20data.','45FvAfie','Portuguese\x20(BR)','error','role','email','</td>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<hr\x20class=\x22my-3\x22>','DRY\x20GOODS','push','$product_details.expiry_date','</div>','getDate','$_id','get','$invoice','find','_id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','edit_adjustment_finished','83376sOEPJu','slice','/adjustment/view','<html><head><title></title>','product_details','invoice','$product_details.batch_code','/preview/:id','$product_details.maxPerUnit','toString','New_Qty_Converted','Return\x20Rooms','product_name','1414868BoMEcG','<h2>\x20','<table\x20style=\x22width:\x20100%\x20!important;\x22>','adjustment_finished','1592990cwKrFr','string','room','batch_code','$product_details.bay','\x20</h2>','bay','FGSEmail','Enclosed','catch','</tr>','master','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.product_code','$product_details.maxProducts','unit','post','$product_details.production_date','1002217KEFKMM','<div>','redirect','ADJF-','$product','</body></html>','/adjustment_finished/preview/','Email\x20sent\x20successfully','success','filter','3928030ohHVOH','prod_invoice','Arabic\x20(ae)','port','prod_cat','floor','Router','prod_code','all','/view/add_adjustment','English','$product_details.storage','logo','new_adjust_qty','Chinese','$room','stock','/picking_list/PDF_adjustment/','English\x20(US)','back','$product_details.secondary_unit','../models/all_models','$warehouse_name','German','padStart','status','maxPerUnit','expiry_date','aggregate','adjust_qty','$product_details.bin','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','French','user','Spanish','</tbody>','flash','log','image','New_Qty_Converted_adj','$product_details.unit','957771AwsCjs','createTransport','message','QA\x20Warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Adjustment\x20Finalize\x20Successfully','$product_details.rack','split','note','types','Enabled','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Adjustment\x20Mail','$product.product_name','level','$product_details.product_stock','warehouse_name','warehouse','Arabic','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','adjustment\x20data\x20update\x20successfully','findById','product_code','$product.room_names','secondary_unit','Finished\x20Goods','product_stock','minus','Portuguese','<strong>\x20Regards\x20</strong>'];a0_0x305f=function(){return _0x24a4f8;};return a0_0x305f();}const express=require(a0_0x49a1d6(0x204)),app=express(),router=express[a0_0x49a1d6(0x1a2)](),auth=require(a0_0x49a1d6(0x1d8)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x49a1d6(0x1b1)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x49a1d6(0x168)](a0_0x49a1d6(0x203),auth,async(_0x5199b3,_0x417c68)=>{var _0x17d784=a0_0x49a1d6;try{const {username:_0x391aee,email:_0xbe0143,role:_0x397b86}=_0x5199b3[_0x17d784(0x1bd)],_0x56d4de=_0x5199b3[_0x17d784(0x1bd)],_0x718682=await profile[_0x17d784(0x1fb)]({'email':_0x56d4de[_0x17d784(0x15e)]}),_0x1f7746=await master_shop[_0x17d784(0x16a)]();let _0x48ac1a;if(_0x56d4de[_0x17d784(0x15d)]==_0x17d784(0x1eb)){const _0x1cd350=await staff[_0x17d784(0x1fb)]({'email':_0x56d4de[_0x17d784(0x15e)]});_0x48ac1a=await warehouse['find']({'status':_0x17d784(0x1cf),'name':_0x1cd350[_0x17d784(0x1d6)]});}else _0x48ac1a=await warehouse[_0x17d784(0x16a)]({'status':_0x17d784(0x1cf)});const _0x3045a5=await product[_0x17d784(0x16a)]();let _0x445f1e;if(_0x56d4de[_0x17d784(0x15d)]==_0x17d784(0x1eb)){const _0xbab80c=await staff['findOne']({'email':_0x56d4de[_0x17d784(0x15e)]});_0x445f1e=await adjustment_finished[_0x17d784(0x16a)]({'warehouse_name':_0xbab80c[_0x17d784(0x1d6)]});}else _0x445f1e=await adjustment_finished['aggregate']([{'$unwind':_0x17d784(0x196)},{'$group':{'_id':_0x17d784(0x167),'invoice':{'$first':_0x17d784(0x169)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x17d784(0x1b2)},'room':{'$addToSet':_0x17d784(0x1dd)},'finalize':{'$first':_0x17d784(0x206)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x1f7746[0x0][_0x17d784(0x18b)]==_0x17d784(0x1ae)){var _0x5aa740=users[_0x17d784(0x1a6)];console['log'](_0x5aa740);}else{if(_0x1f7746[0x0]['language']==_0x17d784(0x1ff))var _0x5aa740=users[_0x17d784(0x1ff)];else{if(_0x1f7746[0x0]['language']==_0x17d784(0x1b3))var _0x5aa740=users[_0x17d784(0x1b3)];else{if(_0x1f7746[0x0][_0x17d784(0x18b)]==_0x17d784(0x1be))var _0x5aa740=users[_0x17d784(0x1be)];else{if(_0x1f7746[0x0]['language']=='French')var _0x5aa740=users[_0x17d784(0x1bc)];else{if(_0x1f7746[0x0][_0x17d784(0x18b)]=='Portuguese\x20(BR)')var _0x5aa740=users[_0x17d784(0x1e2)];else{if(_0x1f7746[0x0][_0x17d784(0x18b)]==_0x17d784(0x1aa))var _0x5aa740=users[_0x17d784(0x1aa)];else{if(_0x1f7746[0x0][_0x17d784(0x18b)]==_0x17d784(0x19e))var _0x5aa740=users['Arabic'];}}}}}}}_0x417c68['render'](_0x17d784(0x17e),{'success':_0x5199b3[_0x17d784(0x1c0)](_0x17d784(0x19a)),'errors':_0x5199b3[_0x17d784(0x1c0)](_0x17d784(0x1ec)),'role':_0x56d4de,'profile':_0x718682,'warehouse':_0x48ac1a,'product':_0x3045a5,'adjustment':_0x445f1e,'master_shop':_0x1f7746,'language':_0x5aa740});}catch(_0x3745a3){console[_0x17d784(0x1c1)](_0x3745a3);}});function a0_0x2b83(_0x4feb73,_0x3ad6d7){var _0x305f32=a0_0x305f();return a0_0x2b83=function(_0x2b833e,_0x27c225){_0x2b833e=_0x2b833e-0x146;var _0x295d28=_0x305f32[_0x2b833e];return _0x295d28;},a0_0x2b83(_0x4feb73,_0x3ad6d7);}async function getRandom8DigitNumber(){var _0xe0ca56=a0_0x49a1d6;const _0x1e6655=0x989680,_0x2035bb=0x5f5e0ff,_0x5a0e1c=Math[_0xe0ca56(0x1a1)](Math['random']()*(_0x2035bb-_0x1e6655+0x1))+_0x1e6655;var _0x311fce;const _0x532e04=await adjustment_finished['findOne']({'invoice':_0xe0ca56(0x195)+_0x5a0e1c});return _0x532e04&&_0x532e04[_0xe0ca56(0x147)]>0x0?_0x311fce=_0xe0ca56(0x195)+_0x5a0e1c:_0x311fce=_0xe0ca56(0x195)+_0x5a0e1c,_0x311fce;}router[a0_0x49a1d6(0x168)]('/view/add_adjustment',auth,async(_0x1176df,_0x585013)=>{var _0x232c77=a0_0x49a1d6;try{const {username:_0x314797,email:_0xc6d06d,role:_0x43a20c}=_0x1176df[_0x232c77(0x1bd)],_0x3e10ea=_0x1176df[_0x232c77(0x1bd)],_0x1f9357=await profile['findOne']({'email':_0x3e10ea['email']}),_0x2af198=await master_shop[_0x232c77(0x16a)]();let _0x4742c3;if(_0x3e10ea[_0x232c77(0x15d)]==_0x232c77(0x1eb)){const _0x199588=await staff[_0x232c77(0x1fb)]({'email':_0x3e10ea[_0x232c77(0x15e)]});_0x4742c3=await warehouse[_0x232c77(0x1b8)]([{'$match':{'status':_0x232c77(0x1cf),'name':_0x199588[_0x232c77(0x1d6)],'warehouse_category':_0x232c77(0x1df),'name':{'$ne':_0x232c77(0x1c8)}}},{'$group':{'_id':_0x232c77(0x1f4),'name':{'$first':_0x232c77(0x1f4)}}}]);}else _0x4742c3=await warehouse['aggregate']([{'$match':{'status':_0x232c77(0x1cf),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x232c77(0x1c8)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x11493d=await product[_0x232c77(0x16a)]({}),_0x40c64a=await adjustment_finished['find']({}),_0x2c5909=_0x40c64a[_0x232c77(0x147)]+0x1,_0x3512b=_0x232c77(0x195)+_0x2c5909[_0x232c77(0x177)]()[_0x232c77(0x1b4)](0x5,'0');var _0x492e0d=['Ambient',_0x232c77(0x187),'Return\x20Rooms'];if(_0x2af198[0x0][_0x232c77(0x18b)]=='English\x20(US)')var _0x4a8064=users[_0x232c77(0x1a6)];else{if(_0x2af198[0x0][_0x232c77(0x18b)]==_0x232c77(0x1ff))var _0x4a8064=users[_0x232c77(0x1ff)];else{if(_0x2af198[0x0]['language']==_0x232c77(0x1b3))var _0x4a8064=users[_0x232c77(0x1b3)];else{if(_0x2af198[0x0][_0x232c77(0x18b)]=='Spanish')var _0x4a8064=users[_0x232c77(0x1be)];else{if(_0x2af198[0x0][_0x232c77(0x18b)]==_0x232c77(0x1bc))var _0x4a8064=users[_0x232c77(0x1bc)];else{if(_0x2af198[0x0][_0x232c77(0x18b)]==_0x232c77(0x15b))var _0x4a8064=users[_0x232c77(0x1e2)];else{if(_0x2af198[0x0][_0x232c77(0x18b)]==_0x232c77(0x1aa))var _0x4a8064=users[_0x232c77(0x1aa)];else{if(_0x2af198[0x0][_0x232c77(0x18b)]=='Arabic\x20(ae)')var _0x4a8064=users['Arabic'];}}}}}}}const _0x447975=getRandom8DigitNumber();_0x447975['then'](_0x3f7067=>{var _0x42b9e8=_0x232c77;_0x585013['render']('add_adjustment_finished',{'success':_0x1176df[_0x42b9e8(0x1c0)](_0x42b9e8(0x19a)),'errors':_0x1176df[_0x42b9e8(0x1c0)]('errors'),'role':_0x3e10ea,'profile':_0x1f9357,'warehouse':_0x4742c3,'product':_0x11493d,'master_shop':_0x2af198,'language':_0x4a8064,'rooms_data':_0x492e0d,'invoice_no':_0x3f7067});})[_0x232c77(0x188)](_0x5a8f0a=>{var _0x543b02=_0x232c77;_0x1176df[_0x543b02(0x1c0)](_0x543b02(0x1ec),_0x543b02(0x160)),_0x585013[_0x543b02(0x194)](_0x543b02(0x170));});}catch(_0x5a643e){console[_0x232c77(0x1c1)](_0x5a643e);}}),router[a0_0x49a1d6(0x190)](a0_0x49a1d6(0x1a5),auth,async(_0x575134,_0x2f0881)=>{var _0x34f3f7=a0_0x49a1d6;try{const {warehouse_name:_0x5906c6,date:_0xde9f53,prod_name:_0x2156b8,level:_0x1fa312,isle:_0x488c83,pallet:_0xd4e2da,stock:_0x502264,types:_0x2e6267,adjust_qty:_0x541461,new_adjust_qty:_0x3f5f2f,note:_0x5a8c71,Room_name:_0x551b26,invoice:_0x3f93fe,JO_number:_0xbc5a07,expiry_date:_0x3ba162}=_0x575134[_0x34f3f7(0x148)];if(typeof _0x2156b8==_0x34f3f7(0x180))var _0x574c03=[_0x575134['body'][_0x34f3f7(0x202)]],_0x14cba6=[_0x575134['body'][_0x34f3f7(0x1d3)]],_0xffb0fa=[_0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x1ac)]],_0x3a9894=[_0x575134[_0x34f3f7(0x148)]['types']],_0x14086e=[_0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x1c3)]],_0x3498f9=[_0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x178)]],_0x309f63=[_0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x14b)]],_0x3aa19e=[_0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x1f8)]],_0x2dc2b6=[_0x575134['body']['prod_code']],_0x394fba=[_0x575134['body']['batch_code']],_0x207399=[_0x575134['body'][_0x34f3f7(0x1b7)]],_0x2fd622=[_0x575134[_0x34f3f7(0x148)]['product_date']],_0x24de0f=[_0x575134[_0x34f3f7(0x148)]['prod_cat']],_0x5ecaf7=[_0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x1f7)]],_0x27f0fa=[_0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x1b6)]],_0x5d9e04=[_0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x19d)]];else var _0x574c03=[..._0x575134['body'][_0x34f3f7(0x202)]],_0x14cba6=[..._0x575134[_0x34f3f7(0x148)]['level']],_0xffb0fa=[..._0x575134[_0x34f3f7(0x148)]['stock']],_0x3a9894=[..._0x575134['body']['types']],_0x14086e=[..._0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x1c3)]],_0x3498f9=[..._0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x178)]],_0x309f63=[..._0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x14b)]],_0x3aa19e=[..._0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x1f8)]],_0x2dc2b6=[..._0x575134['body'][_0x34f3f7(0x1a3)]],_0x394fba=[..._0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x182)]],_0x207399=[..._0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x1b7)]],_0x2fd622=[..._0x575134[_0x34f3f7(0x148)]['product_date']],_0x24de0f=[..._0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x1a0)]],_0x5ecaf7=[..._0x575134['body'][_0x34f3f7(0x1f7)]],_0x27f0fa=[..._0x575134[_0x34f3f7(0x148)][_0x34f3f7(0x1b6)]],_0x5d9e04=[..._0x575134[_0x34f3f7(0x148)]['prod_invoice']];const _0x5c4dea=_0x574c03['map'](_0x24217b=>{return _0x24217b={'product_name':_0x24217b};});_0x14cba6[_0x34f3f7(0x1e8)]((_0xebffa9,_0x44e49e)=>{var _0x5e1530=_0x34f3f7;_0x5c4dea[_0x44e49e][_0x5e1530(0x185)]=_0xebffa9;}),_0xffb0fa[_0x34f3f7(0x1e8)]((_0x5df689,_0x4e1a63)=>{var _0x20c3ed=_0x34f3f7;_0x5c4dea[_0x4e1a63][_0x20c3ed(0x1fd)]=_0x5df689;}),_0x3a9894[_0x34f3f7(0x1e8)]((_0x1d9d8e,_0x152bd4)=>{var _0x20b46f=_0x34f3f7;_0x5c4dea[_0x152bd4][_0x20b46f(0x1ce)]=_0x1d9d8e;}),_0x14086e[_0x34f3f7(0x1e8)]((_0x4c230c,_0x4e4921)=>{var _0x39d90b=_0x34f3f7;_0x5c4dea[_0x4e4921][_0x39d90b(0x1b9)]=_0x4c230c;}),_0x3498f9[_0x34f3f7(0x1e8)]((_0x4cf702,_0x593088)=>{var _0x595c57=_0x34f3f7;_0x5c4dea[_0x593088][_0x595c57(0x1a9)]=_0x4cf702;}),_0x309f63[_0x34f3f7(0x1e8)]((_0x4a0d72,_0x3e026a)=>{var _0x10fcdb=_0x34f3f7;_0x5c4dea[_0x3e026a][_0x10fcdb(0x18f)]=_0x4a0d72;}),_0x3aa19e[_0x34f3f7(0x1e8)]((_0x51050d,_0x17b530)=>{var _0x4725de=_0x34f3f7;_0x5c4dea[_0x17b530][_0x4725de(0x1de)]=_0x51050d;}),_0x2dc2b6[_0x34f3f7(0x1e8)]((_0x4d0440,_0x4110ad)=>{var _0xf4cf66=_0x34f3f7;_0x5c4dea[_0x4110ad][_0xf4cf66(0x1dc)]=_0x4d0440;}),_0x394fba[_0x34f3f7(0x1e8)]((_0x5bd3a2,_0x5a71e5)=>{_0x5c4dea[_0x5a71e5]['batch_code']=_0x5bd3a2;}),_0x207399[_0x34f3f7(0x1e8)]((_0x8a0911,_0x3329d2)=>{_0x5c4dea[_0x3329d2]['expiry_date']=_0x8a0911;}),_0x2fd622[_0x34f3f7(0x1e8)]((_0x4322a8,_0x48ddde)=>{var _0x3fe88a=_0x34f3f7;_0x5c4dea[_0x48ddde][_0x3fe88a(0x1e7)]=_0x4322a8;}),_0x24de0f[_0x34f3f7(0x1e8)]((_0x3ba742,_0x4af958)=>{_0x5c4dea[_0x4af958]['prod_cat']=_0x3ba742;}),_0x5ecaf7[_0x34f3f7(0x1e8)]((_0x40eddf,_0x3e1f22)=>{var _0x3984c9=_0x34f3f7;_0x5c4dea[_0x3e1f22][_0x3984c9(0x1f2)]=_0x40eddf;}),_0x27f0fa[_0x34f3f7(0x1e8)]((_0x3c00a4,_0x562b05)=>{var _0x1ef378=_0x34f3f7;_0x5c4dea[_0x562b05][_0x1ef378(0x1b6)]=_0x3c00a4;}),_0x5d9e04['forEach']((_0x11e34a,_0x23b101)=>{var _0x2bb67a=_0x34f3f7;_0x5c4dea[_0x23b101][_0x2bb67a(0x173)]=_0x11e34a;});const _0x2626e1=_0x5c4dea[_0x34f3f7(0x19b)](_0x2a264f=>_0x2a264f[_0x34f3f7(0x1b9)]!=='0'&&_0x2a264f[_0x34f3f7(0x1b9)]!=='');var _0x35d83a=0x0;_0x2626e1[_0x34f3f7(0x1e8)](_0x1e561e=>{var _0x414270=_0x34f3f7;console[_0x414270(0x1c1)]('foreach\x20newproduct',_0x1e561e),parseInt(_0x1e561e[_0x414270(0x1b9)])<=0x0&&_0x35d83a++;});if(_0x35d83a!=0x0)return _0x575134['flash'](_0x34f3f7(0x1ec),_0x34f3f7(0x1ed)),_0x2f0881[_0x34f3f7(0x194)]('back');const _0x468805=new adjustment_finished({'warehouse_name':_0x5906c6,'date':_0xde9f53,'product':_0x2626e1,'note':_0x5a8c71,'room':_0x551b26,'invoice':_0x3f93fe,'JO_number':_0xbc5a07,'expiry_date':_0x3ba162}),_0xd7ead1=await _0x468805[_0x34f3f7(0x153)]();_0x575134[_0x34f3f7(0x1c0)]('success',_0x34f3f7(0x1e4)),_0x2f0881[_0x34f3f7(0x194)](_0x34f3f7(0x198)+_0xd7ead1[_0x34f3f7(0x16b)]);}catch(_0x1da96f){console['log'](_0x1da96f),_0x2f0881[_0x34f3f7(0x1b5)](0xc8)[_0x34f3f7(0x14c)]({'message':_0x1da96f[_0x34f3f7(0x1c7)]});}}),router[a0_0x49a1d6(0x168)]('/preview/:id',auth,async(_0x1b40ee,_0x239c85)=>{var _0x1a124d=a0_0x49a1d6;try{const {username:_0x4ce94d,email:_0x558e52,role:_0x12f8e2}=_0x1b40ee[_0x1a124d(0x1bd)],_0xfa37d4=_0x1b40ee[_0x1a124d(0x1bd)],_0x2693fe=await profile[_0x1a124d(0x1fb)]({'email':_0xfa37d4[_0x1a124d(0x15e)]}),_0x58a3f8=await master_shop[_0x1a124d(0x16a)](),_0x2f4e2f=_0x1b40ee['params']['id'],_0x46a514=await adjustment_finished[_0x1a124d(0x1db)]({'_id':_0x2f4e2f}),_0x4bd494=await purchases[_0x1a124d(0x1b8)]([{'$match':{'warehouse_name':_0x46a514['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':_0x1a124d(0x1d2)}}]);console['log'](_0x1a124d(0x14f),_0x4bd494);const _0x36135f=await product['find']({}),_0xcea8f9=await warehouse[_0x1a124d(0x1b8)]([{'$match':{'name':_0x46a514[_0x1a124d(0x1d5)],'warehouse_category':_0x1a124d(0x1df)}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1a124d(0x1d4)},'bay':{'$first':_0x1a124d(0x183)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x1a124d(0x156)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1a124d(0x14a)},'secondary_code':{'$first':_0x1a124d(0x149)},'product_code':{'$first':_0x1a124d(0x18d)},'storage':{'$first':_0x1a124d(0x1a7)},'rack':{'$first':_0x1a124d(0x1cb)},'expiry_date':{'$first':_0x1a124d(0x164)},'production_date':{'$first':_0x1a124d(0x191)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x1a124d(0x176)},'room':{'$first':'$room'}}}]);if(_0x58a3f8[0x0][_0x1a124d(0x18b)]=='English\x20(US)'){var _0x61c7a0=users[_0x1a124d(0x1a6)];console['log'](_0x61c7a0);}else{if(_0x58a3f8[0x0][_0x1a124d(0x18b)]==_0x1a124d(0x1ff))var _0x61c7a0=users[_0x1a124d(0x1ff)];else{if(_0x58a3f8[0x0]['language']==_0x1a124d(0x1b3))var _0x61c7a0=users[_0x1a124d(0x1b3)];else{if(_0x58a3f8[0x0][_0x1a124d(0x18b)]=='Spanish')var _0x61c7a0=users[_0x1a124d(0x1be)];else{if(_0x58a3f8[0x0]['language']==_0x1a124d(0x1bc))var _0x61c7a0=users[_0x1a124d(0x1bc)];else{if(_0x58a3f8[0x0][_0x1a124d(0x18b)]==_0x1a124d(0x15b))var _0x61c7a0=users['Portuguese'];else{if(_0x58a3f8[0x0][_0x1a124d(0x18b)]==_0x1a124d(0x1aa))var _0x61c7a0=users[_0x1a124d(0x1aa)];else{if(_0x58a3f8[0x0][_0x1a124d(0x18b)]==_0x1a124d(0x19e))var _0x61c7a0=users[_0x1a124d(0x1d7)];}}}}}}}_0x239c85[_0x1a124d(0x1fe)]('edit_adjustment_finished_view',{'success':_0x1b40ee['flash'](_0x1a124d(0x19a)),'errors':_0x1b40ee[_0x1a124d(0x1c0)](_0x1a124d(0x1ec)),'role':_0xfa37d4,'profile':_0x2693fe,'adjustment':_0x46a514,'stock':_0xcea8f9,'master_shop':_0x58a3f8,'warehouse_name':_0x4bd494,'unit':_0x36135f,'language':_0x61c7a0});}catch(_0x4f6e3b){console[_0x1a124d(0x1c1)](_0x4f6e3b),_0x239c85[_0x1a124d(0x1b5)](0xc8)['json']({'message':_0x4f6e3b[_0x1a124d(0x1c7)]});}}),router[a0_0x49a1d6(0x190)](a0_0x49a1d6(0x175),auth,async(_0xfbb9c4,_0x2eeb6e)=>{var _0x353cd5=a0_0x49a1d6;try{const {invoice:_0x155e80,warehouse_name:_0x2016cd,Room_name:_0x2db46c}=_0xfbb9c4[_0x353cd5(0x148)],_0x5abd6b=_0xfbb9c4[_0x353cd5(0x1fc)]['id'],_0x2afd8d=await adjustment_finished[_0x353cd5(0x1db)]({'_id':_0x5abd6b});var _0x47422c;const _0x381dc3=_0x2afd8d[_0x353cd5(0x152)][_0x353cd5(0x150)](async _0xa64d2c=>{var _0x16f10b=_0x353cd5;if(_0xa64d2c[_0x16f10b(0x1b9)]>0x0){_0x47422c=await warehouse[_0x16f10b(0x1fb)]({'name':_0x2016cd,'room':_0xa64d2c['room_names'],'warehouse_category':_0x16f10b(0x1df)});const _0x47afda=_0x47422c[_0x16f10b(0x172)]['map'](_0x14ac42=>{var _0xf7487c=_0x16f10b;console[_0xf7487c(0x1c1)](_0xa64d2c[_0xf7487c(0x1ce)]);if(_0xa64d2c[_0xf7487c(0x1ce)]=='minus')_0x14ac42[_0xf7487c(0x17a)]==_0xa64d2c['product_name']&&_0x14ac42[_0xf7487c(0x185)]==_0xa64d2c['bay']&&_0x14ac42[_0xf7487c(0x1b7)]==_0xa64d2c[_0xf7487c(0x1b7)]&&_0x14ac42[_0xf7487c(0x1e7)]==_0xa64d2c[_0xf7487c(0x1e7)]&&_0x14ac42[_0xf7487c(0x182)]==_0xa64d2c[_0xf7487c(0x182)]&&_0x14ac42['invoice']==_0xa64d2c['invoice']&&(_0x14ac42[_0xf7487c(0x1e0)]=_0x14ac42[_0xf7487c(0x1e0)]-_0xa64d2c[_0xf7487c(0x1b9)]);else _0xa64d2c['types']==_0xf7487c(0x154)&&(_0x14ac42['product_name']==_0xa64d2c[_0xf7487c(0x17a)]&&_0x14ac42[_0xf7487c(0x185)]==_0xa64d2c[_0xf7487c(0x185)]&&_0x14ac42[_0xf7487c(0x1b7)]==_0xa64d2c[_0xf7487c(0x1b7)]&&_0x14ac42[_0xf7487c(0x1e7)]==_0xa64d2c[_0xf7487c(0x1e7)]&&_0x14ac42[_0xf7487c(0x182)]==_0xa64d2c[_0xf7487c(0x182)]&&_0x14ac42[_0xf7487c(0x173)]==_0xa64d2c[_0xf7487c(0x173)]&&(_0x14ac42['product_stock']=_0x14ac42['product_stock']+_0xa64d2c[_0xf7487c(0x1b9)]));});}return _0x47422c;});Promise[_0x353cd5(0x1a4)](_0x381dc3)[_0x353cd5(0x201)](async _0x2b7490=>{var _0x4b2ed2=_0x353cd5;try{for(const _0x1cae08 of _0x2b7490){await _0x1cae08[_0x4b2ed2(0x153)]();}_0x2afd8d[_0x4b2ed2(0x155)]=_0x4b2ed2(0x1f1);const _0x33ad67=await _0x2afd8d[_0x4b2ed2(0x153)](),_0x4eb32d=await master_shop[_0x4b2ed2(0x16a)](),_0x1eeb1a=await email_settings[_0x4b2ed2(0x1fb)](),_0x4e2a65=await supervisor_settings['find']();var _0x5bb587=_0x2afd8d[_0x4b2ed2(0x152)],_0x3c9967='',_0x12dee2;for(_0x12dee2 in _0x5bb587){var _0x224624='FG';_0x2afd8d[_0x4b2ed2(0x1d5)]==_0x4b2ed2(0x162)&&(_0x224624='DG'),_0x3c9967+='<tr>'+_0x4b2ed2(0x1bb)+_0x5bb587[_0x12dee2][_0x4b2ed2(0x17a)]+_0x4b2ed2(0x15f)+_0x4b2ed2(0x1bb)+_0x5bb587[_0x12dee2][_0x4b2ed2(0x1dc)]+'</td>'+_0x4b2ed2(0x1bb)+_0x5bb587[_0x12dee2][_0x4b2ed2(0x1b9)]+'</td>'+_0x4b2ed2(0x1bb)+_0x5bb587[_0x12dee2][_0x4b2ed2(0x18f)]+_0x4b2ed2(0x15f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5bb587[_0x12dee2][_0x4b2ed2(0x1de)]+_0x4b2ed2(0x15f)+_0x4b2ed2(0x1bb)+_0x2afd8d['warehouse_name']+_0x4b2ed2(0x15f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5bb587[_0x12dee2][_0x4b2ed2(0x1f2)]+_0x4b2ed2(0x15f)+_0x4b2ed2(0x1bb)+_0x224624+_0x5bb587[_0x12dee2]['bay']+_0x4b2ed2(0x15f)+_0x4b2ed2(0x189);}let _0xc20e4d=nodemailer[_0x4b2ed2(0x1c6)]({'host':_0x1eeb1a['host'],'port':Number(_0x1eeb1a[_0x4b2ed2(0x19f)]),'secure':![],'auth':{'user':_0x1eeb1a[_0x4b2ed2(0x15e)],'pass':_0x1eeb1a[_0x4b2ed2(0x158)]}}),_0x4b6ee6={'from':_0x1eeb1a['email'],'to':_0x4e2a65[0x0][_0x4b2ed2(0x186)],'subject':_0x4b2ed2(0x1d1),'attachments':[{'filename':'Logo.png','path':__dirname+_0x4b2ed2(0x1f3)+'/upload/'+_0x4eb32d[0x0][_0x4b2ed2(0x1c2)],'cid':_0x4b2ed2(0x1a8)}],'html':'<!DOCTYPE\x20html>'+_0x4b2ed2(0x171)+'</head><body>'+'<div>'+_0x4b2ed2(0x16c)+_0x4b2ed2(0x193)+_0x4b2ed2(0x1d0)+_0x4b2ed2(0x165)+_0x4b2ed2(0x193)+_0x4b2ed2(0x17c)+_0x4eb32d[0x0][_0x4b2ed2(0x205)]+_0x4b2ed2(0x184)+_0x4b2ed2(0x165)+'</div>'+_0x4b2ed2(0x161)+_0x4b2ed2(0x193)+_0x4b2ed2(0x146)+'\x20Order\x20Number\x20:\x20'+_0x2afd8d[_0x4b2ed2(0x173)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x2afd8d['date']+'\x20'+'</span>'+_0x4b2ed2(0x151)+_0x4b2ed2(0x165)+_0x4b2ed2(0x17d)+_0x4b2ed2(0x20a)+'<tr>'+_0x4b2ed2(0x1f5)+_0x4b2ed2(0x1d9)+_0x4b2ed2(0x1e6)+_0x4b2ed2(0x1c9)+_0x4b2ed2(0x18c)+_0x4b2ed2(0x1fa)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x4b2ed2(0x1f9)+_0x4b2ed2(0x189)+_0x4b2ed2(0x14e)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x3c9967+'\x20'+_0x4b2ed2(0x1bf)+'</table>'+_0x4b2ed2(0x193)+_0x4b2ed2(0x1e3)+'<h5>'+_0x4eb32d[0x0][_0x4b2ed2(0x205)]+'</h5>'+'</div>'+_0x4b2ed2(0x165)+_0x4b2ed2(0x197)};_0xc20e4d['sendMail'](_0x4b6ee6,function(_0x31a296,_0x16b6f5){var _0x577436=_0x4b2ed2;_0x31a296?(console[_0x577436(0x1c1)](_0x31a296),console[_0x577436(0x1c1)](_0x577436(0x207))):console[_0x577436(0x1c1)](_0x577436(0x199));}),_0xfbb9c4['flash'](_0x4b2ed2(0x19a),_0x4b2ed2(0x1ca)),_0x2eeb6e[_0x4b2ed2(0x194)](_0x4b2ed2(0x1ad)+_0x33ad67[_0x4b2ed2(0x16b)]);}catch(_0x1091e7){console[_0x4b2ed2(0x15c)](_0x1091e7),_0x2eeb6e[_0x4b2ed2(0x1b5)](0x1f4)[_0x4b2ed2(0x14c)]({'error':_0x4b2ed2(0x159)});}})[_0x353cd5(0x188)](_0x1b3486=>{var _0x993123=_0x353cd5;console[_0x993123(0x15c)](_0x1b3486),_0x2eeb6e[_0x993123(0x1b5)](0x1f4)[_0x993123(0x14c)]({'error':'An\x20error\x20occurred.'});});}catch(_0x1a6351){_0x2eeb6e[_0x353cd5(0x14c)]({'message':_0x1a6351[_0x353cd5(0x1c7)]});}}),router['get']('/view/:id',auth,async(_0x4af488,_0x2b1a03)=>{var _0x27a5b9=a0_0x49a1d6;try{const {username:_0x323cf2,email:_0x181d72,role:_0x4a5f00}=_0x4af488[_0x27a5b9(0x1bd)],_0x2705bf=_0x4af488['user'],_0x41938e=await profile[_0x27a5b9(0x1fb)]({'email':_0x2705bf[_0x27a5b9(0x15e)]}),_0x4baa39=await master_shop['find']();console[_0x27a5b9(0x1c1)](_0x27a5b9(0x18a),_0x4baa39);const _0x340f88=_0x4af488[_0x27a5b9(0x1fc)]['id'],_0x3da804=await adjustment_finished[_0x27a5b9(0x1db)]({'_id':_0x340f88});let _0x25df59=new Date(_0x3da804[_0x27a5b9(0x1b7)]),_0x10664e=('0'+_0x25df59[_0x27a5b9(0x166)]())['slice'](-0x2),_0x2e9f93=('0'+(_0x25df59[_0x27a5b9(0x208)]()+0x1))[_0x27a5b9(0x16f)](-0x2),_0x236492=_0x25df59['getFullYear'](),_0x38e5af=_0x236492+'-'+_0x2e9f93+'-'+_0x10664e;var _0x1312b9=[_0x27a5b9(0x1f0),_0x27a5b9(0x187),_0x27a5b9(0x179)];const _0xaedfee=await purchases[_0x27a5b9(0x1b8)]([{'$match':{'warehouse_name':_0x3da804[_0x27a5b9(0x1d5)]}},{'$unwind':_0x27a5b9(0x196)},{'$group':{'_id':_0x27a5b9(0x1d2)}}]);console[_0x27a5b9(0x1c1)]('purchases_data',_0xaedfee);const _0x2223d3=await product[_0x27a5b9(0x16a)]({}),_0x45483c=await warehouse[_0x27a5b9(0x1b8)]([{'$match':{'name':_0x3da804['warehouse_name'],'room':_0x3da804[_0x27a5b9(0x181)]}},{'$unwind':_0x27a5b9(0x200)},{'$group':{'_id':_0x27a5b9(0x1e9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x27a5b9(0x183)},'bin':{'$first':_0x27a5b9(0x1ba)},'type':{'$first':_0x27a5b9(0x156)},'floorlevel':{'$first':_0x27a5b9(0x1ee)},'primary_code':{'$first':_0x27a5b9(0x14a)},'secondary_code':{'$first':_0x27a5b9(0x149)},'product_code':{'$first':_0x27a5b9(0x18d)},'storage':{'$first':_0x27a5b9(0x1a7)},'rack':{'$first':'$product_details.rack'}}}]);if(_0x4baa39[0x0][_0x27a5b9(0x18b)]==_0x27a5b9(0x1ae)){var _0x185a7a=users[_0x27a5b9(0x1a6)];console[_0x27a5b9(0x1c1)](_0x185a7a);}else{if(_0x4baa39[0x0]['language']==_0x27a5b9(0x1ff))var _0x185a7a=users[_0x27a5b9(0x1ff)];else{if(_0x4baa39[0x0][_0x27a5b9(0x18b)]==_0x27a5b9(0x1b3))var _0x185a7a=users[_0x27a5b9(0x1b3)];else{if(_0x4baa39[0x0][_0x27a5b9(0x18b)]==_0x27a5b9(0x1be))var _0x185a7a=users[_0x27a5b9(0x1be)];else{if(_0x4baa39[0x0][_0x27a5b9(0x18b)]==_0x27a5b9(0x1bc))var _0x185a7a=users[_0x27a5b9(0x1bc)];else{if(_0x4baa39[0x0][_0x27a5b9(0x18b)]=='Portuguese\x20(BR)')var _0x185a7a=users[_0x27a5b9(0x1e2)];else{if(_0x4baa39[0x0][_0x27a5b9(0x18b)]=='Chinese')var _0x185a7a=users['Chinese'];else{if(_0x4baa39[0x0][_0x27a5b9(0x18b)]=='Arabic\x20(ae)')var _0x185a7a=users[_0x27a5b9(0x1d7)];}}}}}}}_0x2b1a03['render'](_0x27a5b9(0x16d),{'success':_0x4af488['flash'](_0x27a5b9(0x19a)),'errors':_0x4af488['flash']('errors'),'role':_0x2705bf,'profile':_0x41938e,'adjustment':_0x3da804,'stock':_0x45483c,'master_shop':_0x4baa39,'warehouse_name':_0xaedfee,'unit':_0x2223d3,'language':_0x185a7a,'rooms_data':_0x1312b9,'ed_fullDate':_0x38e5af});}catch(_0x5b9e2a){console['log'](_0x5b9e2a),_0x2b1a03[_0x27a5b9(0x1b5)](0xc8)[_0x27a5b9(0x14c)]({'message':_0x5b9e2a['message']});}}),router[a0_0x49a1d6(0x190)]('/view/:id',auth,async(_0x5926bb,_0x4a467a)=>{var _0x92851b=a0_0x49a1d6;try{const _0x3bc95f=_0x5926bb['params']['id'],_0x2f4f7f=await adjustment_finished['findById']({'_id':_0x3bc95f}),_0xb04edc=await warehouse[_0x92851b(0x1fb)]({'name':_0x2f4f7f[_0x92851b(0x1d5)],'room':_0x2f4f7f[_0x92851b(0x181)]}),{warehouse_name:_0x17e627,date:_0x556841,prod_name:_0xdb15a7,level:_0x5d6fe1,isle:_0x3da6ed,pallet:_0x1e2c28,stock:_0xcc14e7,types:_0x34d179,adjust_qty:_0x1f5584,new_adjust_qty:_0x500a04,note:_0x430300,Room_name:_0x521257,invoice:_0x4b5959,JO_number:_0x70a994}=_0x5926bb[_0x92851b(0x148)];if(typeof _0xdb15a7==_0x92851b(0x180))var _0x116a10=[_0x5926bb[_0x92851b(0x148)]['prod_name']],_0x47909b=[_0x5926bb[_0x92851b(0x148)][_0x92851b(0x1d3)]],_0x240eae=[_0x5926bb[_0x92851b(0x148)][_0x92851b(0x1ac)]],_0x55995d=[_0x5926bb['body'][_0x92851b(0x1ce)]],_0x13e1e0=[_0x5926bb[_0x92851b(0x148)][_0x92851b(0x1b9)]],_0x3fd0b4=[_0x5926bb['body'][_0x92851b(0x1a9)]],_0x421461=[_0x5926bb[_0x92851b(0x148)][_0x92851b(0x1a3)]],_0x27a184=[_0x5926bb['body'][_0x92851b(0x18f)]],_0x4a0fd8=[_0x5926bb[_0x92851b(0x148)][_0x92851b(0x1f8)]],_0x47b39e=[_0x5926bb[_0x92851b(0x148)][_0x92851b(0x182)]],_0x14d9e1=[_0x5926bb[_0x92851b(0x148)][_0x92851b(0x1b7)]];else var _0x116a10=[..._0x5926bb[_0x92851b(0x148)]['prod_name']],_0x47909b=[..._0x5926bb[_0x92851b(0x148)][_0x92851b(0x1d3)]],_0x240eae=[..._0x5926bb[_0x92851b(0x148)]['stock']],_0x55995d=[..._0x5926bb[_0x92851b(0x148)][_0x92851b(0x1ce)]],_0x13e1e0=[..._0x5926bb[_0x92851b(0x148)][_0x92851b(0x1b9)]],_0x3fd0b4=[..._0x5926bb['body'][_0x92851b(0x1a9)]],_0x421461=[..._0x5926bb[_0x92851b(0x148)][_0x92851b(0x1a3)]],_0x27a184=[..._0x5926bb[_0x92851b(0x148)][_0x92851b(0x18f)]],_0x4a0fd8=[..._0x5926bb[_0x92851b(0x148)][_0x92851b(0x1f8)]],_0x47b39e=[..._0x5926bb[_0x92851b(0x148)][_0x92851b(0x182)]],_0x14d9e1=[..._0x5926bb[_0x92851b(0x148)]['expiry_date']];const _0x3123fb=_0x116a10[_0x92851b(0x150)](_0x3bbe97=>{return _0x3bbe97={'product_name':_0x3bbe97};});_0x47909b[_0x92851b(0x1e8)]((_0x246038,_0x33b20a)=>{var _0x34b6d3=_0x92851b;_0x3123fb[_0x33b20a][_0x34b6d3(0x185)]=_0x246038;}),_0x240eae[_0x92851b(0x1e8)]((_0x40b0cd,_0xcc089b)=>{_0x3123fb[_0xcc089b]['stockBefore']=_0x40b0cd;}),_0x55995d[_0x92851b(0x1e8)]((_0x444f80,_0x38bdcb)=>{var _0x180d6e=_0x92851b;_0x3123fb[_0x38bdcb][_0x180d6e(0x1ce)]=_0x444f80;}),_0x13e1e0[_0x92851b(0x1e8)]((_0x43460d,_0x5ec55d)=>{var _0x31840d=_0x92851b;_0x3123fb[_0x5ec55d][_0x31840d(0x1b9)]=_0x43460d;}),_0x3fd0b4[_0x92851b(0x1e8)]((_0x48135b,_0x3b3786)=>{var _0x4888cc=_0x92851b;_0x3123fb[_0x3b3786][_0x4888cc(0x1a9)]=_0x48135b;}),_0x27a184['forEach']((_0x51c0ba,_0x4a7752)=>{var _0x4e9ed5=_0x92851b;_0x3123fb[_0x4a7752][_0x4e9ed5(0x18f)]=_0x51c0ba;}),_0x4a0fd8[_0x92851b(0x1e8)]((_0x6cd6d2,_0x257dea)=>{var _0x488097=_0x92851b;_0x3123fb[_0x257dea][_0x488097(0x1de)]=_0x6cd6d2;}),_0x421461[_0x92851b(0x1e8)]((_0x288eb8,_0x2d5959)=>{var _0x3397eb=_0x92851b;_0x3123fb[_0x2d5959][_0x3397eb(0x1dc)]=_0x288eb8;}),_0x47b39e[_0x92851b(0x1e8)]((_0x38833e,_0x30b72f)=>{var _0x2926c2=_0x92851b;_0x3123fb[_0x30b72f][_0x2926c2(0x182)]=_0x38833e;}),_0x14d9e1[_0x92851b(0x1e8)]((_0x56752f,_0x5ed88b)=>{var _0x31bfa9=_0x92851b;_0x3123fb[_0x5ed88b][_0x31bfa9(0x1b7)]=_0x56752f;});const _0x572d4c=_0x3123fb[_0x92851b(0x19b)](_0x31db31=>_0x31db31[_0x92851b(0x1b9)]!=='0'&&_0x31db31[_0x92851b(0x1b9)]!=='');var _0x387c15=0x0;_0x572d4c[_0x92851b(0x1e8)](_0x3d85cb=>{var _0x13b1eb=_0x92851b;console['log']('foreach\x20newproduct',_0x3d85cb),parseInt(_0x3d85cb[_0x13b1eb(0x1b9)])<=0x0&&_0x387c15++;});if(_0x387c15!=0x0)return _0x5926bb[_0x92851b(0x1c0)](_0x92851b(0x1ec),_0x92851b(0x1ed)),_0x4a467a[_0x92851b(0x194)](_0x92851b(0x1af));_0x2f4f7f[_0x92851b(0x1d5)]=_0x17e627,_0x2f4f7f[_0x92851b(0x1e5)]=_0x556841,_0x2f4f7f[_0x92851b(0x152)]=_0x572d4c,_0x2f4f7f[_0x92851b(0x1cd)]=_0x430300,_0x2f4f7f[_0x92851b(0x181)]=_0x521257,_0x2f4f7f[_0x92851b(0x173)]=_0x4b5959,_0x2f4f7f['JO_number']=_0x70a994;const _0x2ffa57=await _0x2f4f7f[_0x92851b(0x153)](),_0xa2bf87=await warehouse[_0x92851b(0x1fb)]({'name':_0x17e627,'room':_0x521257});_0x2ffa57[_0x92851b(0x152)][_0x92851b(0x1e8)](_0x143a4b=>{var _0x44e113=_0x92851b;const _0x578367=_0xa2bf87[_0x44e113(0x172)][_0x44e113(0x150)](_0x71280e=>{var _0xa8ffb5=_0x44e113;_0x143a4b[_0xa8ffb5(0x1ce)]==_0xa8ffb5(0x1e1)?_0x71280e[_0xa8ffb5(0x17a)]==_0x143a4b[_0xa8ffb5(0x17a)]&&_0x71280e[_0xa8ffb5(0x185)]==_0x143a4b[_0xa8ffb5(0x185)]&&(_0x71280e[_0xa8ffb5(0x1e0)]=parseInt(_0x71280e[_0xa8ffb5(0x1e0)])-parseInt(_0x143a4b[_0xa8ffb5(0x1b9)])):_0x71280e[_0xa8ffb5(0x17a)]==_0x143a4b[_0xa8ffb5(0x17a)]&&_0x71280e['bay']==_0x143a4b[_0xa8ffb5(0x185)]&&(_0x71280e['product_stock']=parseInt(_0x71280e[_0xa8ffb5(0x1e0)])+parseInt(_0x143a4b[_0xa8ffb5(0x1b9)]));});}),await _0xa2bf87[_0x92851b(0x153)](),_0x5926bb[_0x92851b(0x1c0)](_0x92851b(0x19a),_0x92851b(0x1da)),_0x4a467a[_0x92851b(0x194)]('/adjustment_finished/view');}catch(_0x211452){console['log'](_0x211452);}}),router[a0_0x49a1d6(0x190)]('/barcode_scanner',async(_0x40b2c7,_0x17965f)=>{var _0xf2e954=a0_0x49a1d6;const {primary_code:_0xc1acc7,warehouse_data:_0xf1514a,rooms_data:_0x430afb,Roomslist:_0x51b55e}=_0x40b2c7['body'],_0x282ca9=_0x51b55e[_0xf2e954(0x1cc)](','),_0x5148f9=[];async function _0x167e37(_0x58eed2){var _0x1f2848=_0xf2e954;const _0x313737=await warehouse[_0x1f2848(0x1b8)]([{'$match':{'name':_0xf1514a,'room':_0x58eed2}},{'$unwind':_0x1f2848(0x200)},{'$match':{'product_details.primary_code':_0xc1acc7}},{'$group':{'_id':_0x1f2848(0x1e9),'name':{'$first':_0x1f2848(0x1ef)},'product_stock':{'$first':_0x1f2848(0x1d4)},'primary_code':{'$first':_0x1f2848(0x14a)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1f2848(0x156)},'pallet':{'$first':_0x1f2848(0x1ee)},'unit':{'$first':_0x1f2848(0x1c4)},'secondary_unit':{'$first':_0x1f2848(0x1b0)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1f2848(0x1cb)},'expiry_date':{'$first':_0x1f2848(0x164)},'production_date':{'$first':_0x1f2848(0x191)},'batch_code':{'$first':_0x1f2848(0x174)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x1f2848(0x176)},'roomNamed':{'$first':_0x1f2848(0x1ab)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x1a3703=await warehouse['aggregate']([{'$match':{'name':_0xf1514a,'room':_0x58eed2}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0xc1acc7}},{'$group':{'_id':_0x1f2848(0x1e9),'name':{'$first':_0x1f2848(0x1ef)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1f2848(0x149)},'product_code':{'$first':_0x1f2848(0x18d)},'level':{'$first':_0x1f2848(0x183)},'isle':{'$first':_0x1f2848(0x1ba)},'type':{'$first':_0x1f2848(0x156)},'pallet':{'$first':_0x1f2848(0x1ee)},'unit':{'$first':_0x1f2848(0x1c4)},'secondary_unit':{'$first':_0x1f2848(0x1b0)},'storage':{'$first':_0x1f2848(0x1a7)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1f2848(0x191)},'batch_code':{'$first':_0x1f2848(0x174)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x1f2848(0x1ab)},'invoice':{'$first':_0x1f2848(0x1ea)}}}]);if(_0x313737['length']>0x0)_0x5148f9[_0x1f2848(0x163)](_0x313737);else _0x1a3703['length']>0x0&&_0x5148f9[_0x1f2848(0x163)](_0x1a3703);}const _0x26c5c9=_0x282ca9[_0xf2e954(0x150)](_0x1f2d04=>_0x167e37(_0x1f2d04));await Promise[_0xf2e954(0x1a4)](_0x26c5c9),_0x17965f[_0xf2e954(0x14c)](_0x5148f9);}),router[a0_0x49a1d6(0x190)](a0_0x49a1d6(0x157),async(_0x29fb15,_0x288cb8)=>{var _0x325bf4=a0_0x49a1d6;const {productCode:_0x501270,bay:_0x4015a4,warehouses:_0x546c3f,room:_0x30f0a4}=_0x29fb15[_0x325bf4(0x148)];console[_0x325bf4(0x1c1)](_0x29fb15[_0x325bf4(0x148)]);try{const _0x329f67=await warehouse[_0x325bf4(0x1b8)]([{'$match':{'name':_0x546c3f,'room':_0x30f0a4}},{'$unwind':_0x325bf4(0x200)},{'$match':{'product_details.bay':parseInt(_0x4015a4)}},{'$group':{'_id':_0x325bf4(0x1e9),'name':{'$first':_0x325bf4(0x1ef)},'product_stock':{'$first':_0x325bf4(0x1d4)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x325bf4(0x18e)}}}]);_0x288cb8[_0x325bf4(0x1b5)](0xc8)['json'](_0x329f67);}catch(_0x28386e){_0x288cb8[_0x325bf4(0x1b5)](0x194)[_0x325bf4(0x14c)]({'message':_0x28386e['message']});}}),module['exports']=router;