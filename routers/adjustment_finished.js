function a0_0x3efe(){var _0x12a279=['1877914SefJBx','minus','Finished\x20Goods','user','Enclosed','random','$product_details.bin','/barcode_scanner','/../public','log','level','1248728pgWybD','$product_details.unit','$finalize','FGSEmail','$product_details.product_name','<h5\x20style=\x22text-align:\x20left;\x22>','product_code','5ixuOrF','$product_details.product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','../middleware/auth','language','expiry_date','$product.product_name','/view/:id','$product_details.batch_code','foreach\x20newproduct','all','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/view','$product_details.rack','find','<tr>','</body></html>','add','</table>','maxPerUnit','/CheckingWarehouse','$product_details.expiry_date','$product_details.invoice','$product','filter','master','types','Logo.png','$product_details.floorlevel','9AHGiVe','Enabled','prod_code','40MTgKWV','prod_cat','_id','7705229OUEkAc','$date','aggregate','</div>','Portuguese','then','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Return\x20Rooms','new_adjust_qty','German','redirect','length','$name','../public/language/languages.json','Adjustment\x20Finalize\x20Successfully','bay','unit','sendMail','warehouse','invoice','English\x20(US)','product_date','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','batch_code','/adjustment/view','finalize','product_details','</h5>','edit_adjustment_finished','adjustment_finished','$product_details.primary_code','/preview/:id','An\x20error\x20occurred.','toString','product','6901602YPZKyL','map','stock','$product_details.bay','date','$product_details.secondary_code','New_Qty_Converted_adj','save','</head><body>','exports','getFullYear','</td>','string','createTransport','/picking_list/PDF_adjustment/','product_stock','</thead>','$_id','3oSyErJ','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','3792232rwQJxd','<hr\x20class=\x22my-3\x22>','Spanish','secondary_unit','image','Portuguese\x20(BR)','Secondary_units','English','Primary_Units','password','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','status','Email\x20sent\x20successfully','warehouse_name','getDate','Chinese','Rooms','findOne','$invoice','New_Qty_Converted','staff','/view/add_adjustment','<table\x20style=\x22width:\x20100%\x20!important;\x22>','adjustment\x20data\x20update\x20successfully','message','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','catch','errors','getMonth','success','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','\x20</h2>','<strong>\x20Regards\x20</strong>','Hindi','role','<div>','note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.secondary_unit','host','room','json','room_names','port','body','prod_name','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','422700tNKQAj','$product_details.production_date','production_date','slice','<!DOCTYPE\x20html>','purchases_data','<tbody\x20style=\x22text-align:\x20center;\x22>','push','Arabic','$product_details.product_code','add_adjustment_finished','error','logo','$product.room_names','back','$product_details.storage','$room','<html><head><title></title>','Arabic\x20(ae)','ADJF-','French','stockBefore','adjust_qty','edit_adjustment_finished_view','product_name','11539979ibjZNq','post','params','$product_details.maxPerUnit','</tr>','express','/adjustment_finished/preview/','flash','$product_details._id','<span\x20style=\x22float:\x20right;\x22>','get','forEach','render','prod_invoice','QA\x20Warehouse','findById','$product_details','../models/all_models','$warehouse_name','site_title','$product_details.type','\x20Order\x20Number\x20:\x20','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'];a0_0x3efe=function(){return _0x12a279;};return a0_0x3efe();}function a0_0x98af(_0x26dde9,_0x1a52f7){var _0x3efea2=a0_0x3efe();return a0_0x98af=function(_0x98afc6,_0x5ca7ab){_0x98afc6=_0x98afc6-0xec;var _0x51ec17=_0x3efea2[_0x98afc6];return _0x51ec17;},a0_0x98af(_0x26dde9,_0x1a52f7);}var a0_0x545795=a0_0x98af;(function(_0xb0175f,_0x1f6127){var _0x3bf832=a0_0x98af,_0x157443=_0xb0175f();while(!![]){try{var _0x274d8d=parseInt(_0x3bf832(0x149))/0x1+-parseInt(_0x3bf832(0x179))/0x2*(parseInt(_0x3bf832(0x117))/0x3)+-parseInt(_0x3bf832(0x184))/0x4+parseInt(_0x3bf832(0x18b))/0x5*(-parseInt(_0x3bf832(0x105))/0x6)+-parseInt(_0x3bf832(0x1ae))/0x7+parseInt(_0x3bf832(0x119))/0x8*(-parseInt(_0x3bf832(0x1a8))/0x9)+parseInt(_0x3bf832(0x1ab))/0xa*(parseInt(_0x3bf832(0x162))/0xb);if(_0x274d8d===_0x1f6127)break;else _0x157443['push'](_0x157443['shift']());}catch(_0x533960){_0x157443['push'](_0x157443['shift']());}}}(a0_0x3efe,0x9cf3a));const express=require(a0_0x545795(0x167)),app=express(),router=express['Router'](),auth=require(a0_0x545795(0x18e)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x545795(0x173)),users=require(a0_0x545795(0xef)),nodemailer=require('nodemailer');router[a0_0x545795(0x16c)](a0_0x545795(0x197),auth,async(_0x11ad67,_0x32811e)=>{var _0x2a4a6a=a0_0x545795;try{const {username:_0x431fd8,email:_0xed3502,role:_0x2d46c3}=_0x11ad67[_0x2a4a6a(0x17c)],_0x42c884=_0x11ad67[_0x2a4a6a(0x17c)],_0x54e3ad=await profile[_0x2a4a6a(0x12a)]({'email':_0x42c884['email']}),_0x456659=await master_shop[_0x2a4a6a(0x199)]();let _0xed4b89;if(_0x42c884[_0x2a4a6a(0x13b)]=='staff'){const _0x1d4742=await staff[_0x2a4a6a(0x12a)]({'email':_0x42c884[_0x2a4a6a(0x147)]});_0xed4b89=await warehouse[_0x2a4a6a(0x199)]({'status':_0x2a4a6a(0x1a9),'name':_0x1d4742[_0x2a4a6a(0xf4)]});}else _0xed4b89=await warehouse[_0x2a4a6a(0x199)]({'status':_0x2a4a6a(0x1a9)});const _0x3bd897=await product[_0x2a4a6a(0x199)]();let _0x44eddd;if(_0x42c884[_0x2a4a6a(0x13b)]==_0x2a4a6a(0x12d)){const _0x30ab47=await staff[_0x2a4a6a(0x12a)]({'email':_0x42c884[_0x2a4a6a(0x147)]});_0x44eddd=await adjustment_finished['find']({'warehouse_name':_0x30ab47[_0x2a4a6a(0xf4)]});}else _0x44eddd=await adjustment_finished[_0x2a4a6a(0x1b0)]([{'$unwind':'$product'},{'$group':{'_id':_0x2a4a6a(0x116),'invoice':{'$first':_0x2a4a6a(0x12b)},'date':{'$first':_0x2a4a6a(0x1af)},'warehouse_name':{'$first':_0x2a4a6a(0x174)},'room':{'$addToSet':_0x2a4a6a(0x156)},'finalize':{'$first':_0x2a4a6a(0x186)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x456659[0x0]['language']==_0x2a4a6a(0xf6)){var _0x5a5a3d=users[_0x2a4a6a(0x120)];console[_0x2a4a6a(0x182)](_0x5a5a3d);}else{if(_0x456659[0x0][_0x2a4a6a(0x18f)]==_0x2a4a6a(0x13a))var _0x5a5a3d=users['Hindi'];else{if(_0x456659[0x0][_0x2a4a6a(0x18f)]==_0x2a4a6a(0x1b7))var _0x5a5a3d=users['German'];else{if(_0x456659[0x0]['language']=='Spanish')var _0x5a5a3d=users[_0x2a4a6a(0x11b)];else{if(_0x456659[0x0][_0x2a4a6a(0x18f)]==_0x2a4a6a(0x15d))var _0x5a5a3d=users[_0x2a4a6a(0x15d)];else{if(_0x456659[0x0]['language']=='Portuguese\x20(BR)')var _0x5a5a3d=users[_0x2a4a6a(0x1b2)];else{if(_0x456659[0x0]['language']==_0x2a4a6a(0x128))var _0x5a5a3d=users[_0x2a4a6a(0x128)];else{if(_0x456659[0x0]['language']=='Arabic\x20(ae)')var _0x5a5a3d=users['Arabic'];}}}}}}}_0x32811e['render'](_0x2a4a6a(0xff),{'success':_0x11ad67[_0x2a4a6a(0x169)](_0x2a4a6a(0x136)),'errors':_0x11ad67[_0x2a4a6a(0x169)](_0x2a4a6a(0x134)),'role':_0x42c884,'profile':_0x54e3ad,'warehouse':_0xed4b89,'product':_0x3bd897,'adjustment':_0x44eddd,'master_shop':_0x456659,'language':_0x5a5a3d});}catch(_0x2824d8){console['log'](_0x2824d8);}});async function getRandom8DigitNumber(){var _0x35cede=a0_0x545795;const _0x3a0f07=0x989680,_0x2ee419=0x5f5e0ff,_0x2ef850=Math['floor'](Math[_0x35cede(0x17e)]()*(_0x2ee419-_0x3a0f07+0x1))+_0x3a0f07;var _0x443973;const _0x4379c4=await adjustment_finished[_0x35cede(0x12a)]({'invoice':_0x35cede(0x15c)+_0x2ef850});return _0x4379c4&&_0x4379c4[_0x35cede(0xed)]>0x0?_0x443973=_0x35cede(0x15c)+_0x2ef850:_0x443973=_0x35cede(0x15c)+_0x2ef850,_0x443973;}router[a0_0x545795(0x16c)]('/view/add_adjustment',auth,async(_0x1a41d5,_0x1fc182)=>{var _0x237754=a0_0x545795;try{const {username:_0x4f7658,email:_0x114839,role:_0x461eaa}=_0x1a41d5[_0x237754(0x17c)],_0x1f4c8c=_0x1a41d5[_0x237754(0x17c)],_0x2eb7fe=await profile[_0x237754(0x12a)]({'email':_0x1f4c8c[_0x237754(0x147)]}),_0x2a9692=await master_shop['find']();let _0x5a536d;if(_0x1f4c8c['role']==_0x237754(0x12d)){const _0x29a598=await staff[_0x237754(0x12a)]({'email':_0x1f4c8c['email']});_0x5a536d=await warehouse[_0x237754(0x1b0)]([{'$match':{'status':_0x237754(0x1a9),'name':_0x29a598['warehouse'],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x237754(0x170)}}},{'$group':{'_id':_0x237754(0xee),'name':{'$first':'$name'}}}]);}else _0x5a536d=await warehouse[_0x237754(0x1b0)]([{'$match':{'status':_0x237754(0x1a9),'warehouse_category':_0x237754(0x17b),'name':{'$ne':_0x237754(0x170)}}},{'$group':{'_id':_0x237754(0xee),'name':{'$first':_0x237754(0xee)}}}]);const _0x3cc0e5=await product[_0x237754(0x199)]({}),_0x29d86f=await adjustment_finished[_0x237754(0x199)]({}),_0x16f048=_0x29d86f[_0x237754(0xed)]+0x1,_0x36fcf9=_0x237754(0x15c)+_0x16f048[_0x237754(0x103)]()['padStart'](0x5,'0');var _0x5dec48=['Ambient',_0x237754(0x17d),'Return\x20Rooms'];if(_0x2a9692[0x0]['language']=='English\x20(US)')var _0x47be8a=users[_0x237754(0x120)];else{if(_0x2a9692[0x0][_0x237754(0x18f)]=='Hindi')var _0x47be8a=users[_0x237754(0x13a)];else{if(_0x2a9692[0x0][_0x237754(0x18f)]==_0x237754(0x1b7))var _0x47be8a=users[_0x237754(0x1b7)];else{if(_0x2a9692[0x0][_0x237754(0x18f)]=='Spanish')var _0x47be8a=users['Spanish'];else{if(_0x2a9692[0x0][_0x237754(0x18f)]=='French')var _0x47be8a=users[_0x237754(0x15d)];else{if(_0x2a9692[0x0][_0x237754(0x18f)]=='Portuguese\x20(BR)')var _0x47be8a=users[_0x237754(0x1b2)];else{if(_0x2a9692[0x0][_0x237754(0x18f)]==_0x237754(0x128))var _0x47be8a=users['Chinese'];else{if(_0x2a9692[0x0][_0x237754(0x18f)]=='Arabic\x20(ae)')var _0x47be8a=users[_0x237754(0x151)];}}}}}}}const _0x1d2113=getRandom8DigitNumber();_0x1d2113[_0x237754(0x1b3)](_0x21cf83=>{var _0x230018=_0x237754;_0x1fc182[_0x230018(0x16e)](_0x230018(0x153),{'success':_0x1a41d5[_0x230018(0x169)]('success'),'errors':_0x1a41d5['flash'](_0x230018(0x134)),'role':_0x1f4c8c,'profile':_0x2eb7fe,'warehouse':_0x5a536d,'product':_0x3cc0e5,'master_shop':_0x2a9692,'language':_0x47be8a,'rooms_data':_0x5dec48,'invoice_no':_0x21cf83});})['catch'](_0x107c9d=>{var _0xbe296f=_0x237754;_0x1a41d5[_0xbe296f(0x169)](_0xbe296f(0x134),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x1fc182[_0xbe296f(0xec)](_0xbe296f(0xfa));});}catch(_0x4c7855){console[_0x237754(0x182)](_0x4c7855);}}),router[a0_0x545795(0x163)](a0_0x545795(0x12e),auth,async(_0x481eb7,_0x4e7c39)=>{var _0x27b672=a0_0x545795;try{const {warehouse_name:_0x149d52,date:_0x2ed326,prod_name:_0x49d145,level:_0x5b0c84,isle:_0x1ee7e3,pallet:_0x5eb4d1,stock:_0x46d11e,types:_0x5305e4,adjust_qty:_0x733dda,new_adjust_qty:_0x29b035,note:_0x39f133,Room_name:_0x37949d,invoice:_0xaa0714,JO_number:_0x4bf984,expiry_date:_0x556e21}=_0x481eb7['body'];if(typeof _0x49d145==_0x27b672(0x111))var _0x18a0d2=[_0x481eb7[_0x27b672(0x145)][_0x27b672(0x146)]],_0x7fc2d4=[_0x481eb7[_0x27b672(0x145)]['level']],_0x4ac3df=[_0x481eb7['body'][_0x27b672(0x107)]],_0x4182f4=[_0x481eb7[_0x27b672(0x145)][_0x27b672(0x1a5)]],_0x3d6ff4=[_0x481eb7['body'][_0x27b672(0x10b)]],_0x4f4f71=[_0x481eb7[_0x27b672(0x145)][_0x27b672(0x12c)]],_0x2645e1=[_0x481eb7[_0x27b672(0x145)]['Primary_Units']],_0x415448=[_0x481eb7[_0x27b672(0x145)][_0x27b672(0x11f)]],_0x577736=[_0x481eb7[_0x27b672(0x145)][_0x27b672(0x1aa)]],_0x541320=[_0x481eb7[_0x27b672(0x145)][_0x27b672(0xf9)]],_0x1f7d7c=[_0x481eb7['body'][_0x27b672(0x190)]],_0x7bed44=[_0x481eb7[_0x27b672(0x145)][_0x27b672(0xf7)]],_0x6be090=[_0x481eb7[_0x27b672(0x145)][_0x27b672(0x1ac)]],_0x1836c7=[_0x481eb7['body'][_0x27b672(0x129)]],_0x5198b0=[_0x481eb7['body'][_0x27b672(0x19e)]],_0x2555d5=[_0x481eb7[_0x27b672(0x145)]['prod_invoice']];else var _0x18a0d2=[..._0x481eb7['body'][_0x27b672(0x146)]],_0x7fc2d4=[..._0x481eb7[_0x27b672(0x145)]['level']],_0x4ac3df=[..._0x481eb7[_0x27b672(0x145)][_0x27b672(0x107)]],_0x4182f4=[..._0x481eb7[_0x27b672(0x145)][_0x27b672(0x1a5)]],_0x3d6ff4=[..._0x481eb7['body'][_0x27b672(0x10b)]],_0x4f4f71=[..._0x481eb7[_0x27b672(0x145)][_0x27b672(0x12c)]],_0x2645e1=[..._0x481eb7[_0x27b672(0x145)][_0x27b672(0x121)]],_0x415448=[..._0x481eb7[_0x27b672(0x145)][_0x27b672(0x11f)]],_0x577736=[..._0x481eb7[_0x27b672(0x145)]['prod_code']],_0x541320=[..._0x481eb7[_0x27b672(0x145)][_0x27b672(0xf9)]],_0x1f7d7c=[..._0x481eb7[_0x27b672(0x145)]['expiry_date']],_0x7bed44=[..._0x481eb7['body']['product_date']],_0x6be090=[..._0x481eb7[_0x27b672(0x145)]['prod_cat']],_0x1836c7=[..._0x481eb7[_0x27b672(0x145)][_0x27b672(0x129)]],_0x5198b0=[..._0x481eb7[_0x27b672(0x145)][_0x27b672(0x19e)]],_0x2555d5=[..._0x481eb7['body'][_0x27b672(0x16f)]];const _0x31924d=_0x18a0d2[_0x27b672(0x106)](_0x3cddf9=>{return _0x3cddf9={'product_name':_0x3cddf9};});_0x7fc2d4['forEach']((_0x497544,_0x496dbd)=>{var _0x20123b=_0x27b672;_0x31924d[_0x496dbd][_0x20123b(0xf1)]=_0x497544;}),_0x4ac3df[_0x27b672(0x16d)]((_0x1360ac,_0x6d0a54)=>{var _0x4aa0d1=_0x27b672;_0x31924d[_0x6d0a54][_0x4aa0d1(0x15e)]=_0x1360ac;}),_0x4182f4[_0x27b672(0x16d)]((_0x2765c6,_0x48c0b3)=>{_0x31924d[_0x48c0b3]['types']=_0x2765c6;}),_0x3d6ff4['forEach']((_0x44d5bd,_0x18e407)=>{var _0x2cd866=_0x27b672;_0x31924d[_0x18e407][_0x2cd866(0x15f)]=_0x44d5bd;}),_0x4f4f71[_0x27b672(0x16d)]((_0x220549,_0x89e413)=>{var _0x27b7b1=_0x27b672;_0x31924d[_0x89e413][_0x27b7b1(0x1b6)]=_0x220549;}),_0x2645e1[_0x27b672(0x16d)]((_0x4bed1b,_0x3b208d)=>{var _0x3052c0=_0x27b672;_0x31924d[_0x3b208d][_0x3052c0(0xf2)]=_0x4bed1b;}),_0x415448['forEach']((_0x4d1f2d,_0x8b645e)=>{var _0x5cf972=_0x27b672;_0x31924d[_0x8b645e][_0x5cf972(0x11c)]=_0x4d1f2d;}),_0x577736[_0x27b672(0x16d)]((_0x100cdf,_0x3d7c96)=>{_0x31924d[_0x3d7c96]['product_code']=_0x100cdf;}),_0x541320[_0x27b672(0x16d)]((_0x1d38b4,_0x3b2973)=>{_0x31924d[_0x3b2973]['batch_code']=_0x1d38b4;}),_0x1f7d7c[_0x27b672(0x16d)]((_0x3cb614,_0x3adb09)=>{var _0x1b8393=_0x27b672;_0x31924d[_0x3adb09][_0x1b8393(0x190)]=_0x3cb614;}),_0x7bed44[_0x27b672(0x16d)]((_0x318986,_0x57fbbb)=>{var _0x4364fc=_0x27b672;_0x31924d[_0x57fbbb][_0x4364fc(0x14b)]=_0x318986;}),_0x6be090['forEach']((_0xcd6e2b,_0x253fff)=>{var _0x50c10b=_0x27b672;_0x31924d[_0x253fff][_0x50c10b(0x1ac)]=_0xcd6e2b;}),_0x1836c7[_0x27b672(0x16d)]((_0x2e2955,_0x905df5)=>{var _0x5cb06e=_0x27b672;_0x31924d[_0x905df5][_0x5cb06e(0x143)]=_0x2e2955;}),_0x5198b0[_0x27b672(0x16d)]((_0x35e2e5,_0x3c6287)=>{var _0x336028=_0x27b672;_0x31924d[_0x3c6287][_0x336028(0x19e)]=_0x35e2e5;}),_0x2555d5[_0x27b672(0x16d)]((_0x46595f,_0x3a8e30)=>{var _0x1d93be=_0x27b672;_0x31924d[_0x3a8e30][_0x1d93be(0xf5)]=_0x46595f;});const _0x2c8939=_0x31924d[_0x27b672(0x1a3)](_0x518320=>_0x518320[_0x27b672(0x15f)]!=='0'&&_0x518320['adjust_qty']!=='');var _0x298adc=0x0;_0x2c8939[_0x27b672(0x16d)](_0x258276=>{var _0x220e93=_0x27b672;console['log'](_0x220e93(0x194),_0x258276),parseInt(_0x258276[_0x220e93(0x15f)])<=0x0&&_0x298adc++;});if(_0x298adc!=0x0)return _0x481eb7[_0x27b672(0x169)](_0x27b672(0x134),_0x27b672(0x118)),_0x4e7c39[_0x27b672(0xec)](_0x27b672(0x157));const _0x387200=new adjustment_finished({'warehouse_name':_0x149d52,'date':_0x2ed326,'product':_0x2c8939,'note':_0x39f133,'room':_0x37949d,'invoice':_0xaa0714,'JO_number':_0x4bf984,'expiry_date':_0x556e21}),_0x2d68b4=await _0x387200[_0x27b672(0x10c)]();_0x481eb7[_0x27b672(0x169)](_0x27b672(0x136),'adjustment\x20add\x20successfull'),_0x4e7c39[_0x27b672(0xec)](_0x27b672(0x168)+_0x2d68b4[_0x27b672(0x1ad)]);}catch(_0x15c80e){console[_0x27b672(0x182)](_0x15c80e),_0x4e7c39[_0x27b672(0x124)](0xc8)[_0x27b672(0x142)]({'message':_0x15c80e['message']});}}),router[a0_0x545795(0x16c)](a0_0x545795(0x101),auth,async(_0x4eee14,_0x303e4c)=>{var _0x8c0aee=a0_0x545795;try{const {username:_0x479f49,email:_0x44fbf7,role:_0x412007}=_0x4eee14[_0x8c0aee(0x17c)],_0x5707ab=_0x4eee14['user'],_0x1ad185=await profile[_0x8c0aee(0x12a)]({'email':_0x5707ab[_0x8c0aee(0x147)]}),_0x2351d3=await master_shop[_0x8c0aee(0x199)](),_0x5cbbd8=_0x4eee14['params']['id'],_0x1b57c6=await adjustment_finished[_0x8c0aee(0x171)]({'_id':_0x5cbbd8}),_0x39b041=await purchases[_0x8c0aee(0x1b0)]([{'$match':{'warehouse_name':_0x1b57c6[_0x8c0aee(0x126)]}},{'$unwind':_0x8c0aee(0x1a2)},{'$group':{'_id':_0x8c0aee(0x191)}}]);console['log'](_0x8c0aee(0x14e),_0x39b041);const _0x27d853=await product['find']({}),_0x2738fc=await warehouse[_0x8c0aee(0x1b0)]([{'$match':{'name':_0x1b57c6[_0x8c0aee(0x126)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x8c0aee(0x172)},{'$group':{'_id':_0x8c0aee(0x16a),'name':{'$first':_0x8c0aee(0x188)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x8c0aee(0x108)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x8c0aee(0x1a7)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x8c0aee(0x10a)},'product_code':{'$first':_0x8c0aee(0x152)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x8c0aee(0x198)},'expiry_date':{'$first':_0x8c0aee(0x1a0)},'production_date':{'$first':_0x8c0aee(0x14a)},'batch_code':{'$first':_0x8c0aee(0x193)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':_0x8c0aee(0x159)}}}]);if(_0x2351d3[0x0][_0x8c0aee(0x18f)]==_0x8c0aee(0xf6)){var _0x53b96d=users['English'];console['log'](_0x53b96d);}else{if(_0x2351d3[0x0][_0x8c0aee(0x18f)]==_0x8c0aee(0x13a))var _0x53b96d=users[_0x8c0aee(0x13a)];else{if(_0x2351d3[0x0][_0x8c0aee(0x18f)]==_0x8c0aee(0x1b7))var _0x53b96d=users['German'];else{if(_0x2351d3[0x0][_0x8c0aee(0x18f)]==_0x8c0aee(0x11b))var _0x53b96d=users[_0x8c0aee(0x11b)];else{if(_0x2351d3[0x0][_0x8c0aee(0x18f)]=='French')var _0x53b96d=users[_0x8c0aee(0x15d)];else{if(_0x2351d3[0x0][_0x8c0aee(0x18f)]=='Portuguese\x20(BR)')var _0x53b96d=users[_0x8c0aee(0x1b2)];else{if(_0x2351d3[0x0][_0x8c0aee(0x18f)]==_0x8c0aee(0x128))var _0x53b96d=users[_0x8c0aee(0x128)];else{if(_0x2351d3[0x0][_0x8c0aee(0x18f)]==_0x8c0aee(0x15b))var _0x53b96d=users[_0x8c0aee(0x151)];}}}}}}}_0x303e4c[_0x8c0aee(0x16e)](_0x8c0aee(0x160),{'success':_0x4eee14['flash'](_0x8c0aee(0x136)),'errors':_0x4eee14[_0x8c0aee(0x169)]('errors'),'role':_0x5707ab,'profile':_0x1ad185,'adjustment':_0x1b57c6,'stock':_0x2738fc,'master_shop':_0x2351d3,'warehouse_name':_0x39b041,'unit':_0x27d853,'language':_0x53b96d});}catch(_0x5982cb){console[_0x8c0aee(0x182)](_0x5982cb),_0x303e4c[_0x8c0aee(0x124)](0xc8)[_0x8c0aee(0x142)]({'message':_0x5982cb[_0x8c0aee(0x131)]});}}),router[a0_0x545795(0x163)]('/preview/:id',auth,async(_0x13503c,_0x5c8597)=>{var _0x1bb947=a0_0x545795;try{const {invoice:_0x294699,warehouse_name:_0x200ac7,Room_name:_0x4cee90}=_0x13503c[_0x1bb947(0x145)],_0xfcfb7e=_0x13503c['params']['id'],_0x4b28ee=await adjustment_finished[_0x1bb947(0x171)]({'_id':_0xfcfb7e});var _0x3fca51;const _0x58c5ea=_0x4b28ee[_0x1bb947(0x104)][_0x1bb947(0x106)](async _0x3bf4e0=>{var _0xd568ca=_0x1bb947;if(_0x3bf4e0[_0xd568ca(0x15f)]>0x0){_0x3fca51=await warehouse['findOne']({'name':_0x200ac7,'room':_0x3bf4e0['room_names'],'warehouse_category':_0xd568ca(0x17b)});const _0x39ca7f=_0x3fca51['product_details'][_0xd568ca(0x106)](_0xf68df5=>{var _0x41069b=_0xd568ca;console['log'](_0x3bf4e0[_0x41069b(0x1a5)]);if(_0x3bf4e0[_0x41069b(0x1a5)]==_0x41069b(0x17a))_0xf68df5['product_name']==_0x3bf4e0[_0x41069b(0x161)]&&_0xf68df5[_0x41069b(0xf1)]==_0x3bf4e0[_0x41069b(0xf1)]&&_0xf68df5['expiry_date']==_0x3bf4e0[_0x41069b(0x190)]&&_0xf68df5['production_date']==_0x3bf4e0[_0x41069b(0x14b)]&&_0xf68df5[_0x41069b(0xf9)]==_0x3bf4e0[_0x41069b(0xf9)]&&_0xf68df5[_0x41069b(0xf5)]==_0x3bf4e0[_0x41069b(0xf5)]&&(_0xf68df5[_0x41069b(0x114)]=_0xf68df5[_0x41069b(0x114)]-_0x3bf4e0[_0x41069b(0x15f)]);else _0x3bf4e0[_0x41069b(0x1a5)]==_0x41069b(0x19c)&&(_0xf68df5[_0x41069b(0x161)]==_0x3bf4e0[_0x41069b(0x161)]&&_0xf68df5['bay']==_0x3bf4e0[_0x41069b(0xf1)]&&_0xf68df5[_0x41069b(0x190)]==_0x3bf4e0['expiry_date']&&_0xf68df5[_0x41069b(0x14b)]==_0x3bf4e0[_0x41069b(0x14b)]&&_0xf68df5['batch_code']==_0x3bf4e0[_0x41069b(0xf9)]&&_0xf68df5[_0x41069b(0xf5)]==_0x3bf4e0[_0x41069b(0xf5)]&&(_0xf68df5['product_stock']=_0xf68df5[_0x41069b(0x114)]+_0x3bf4e0[_0x41069b(0x15f)]));});}return _0x3fca51;});Promise[_0x1bb947(0x195)](_0x58c5ea)[_0x1bb947(0x1b3)](async _0x3d130d=>{var _0x415b39=_0x1bb947;try{for(const _0x393acc of _0x3d130d){await _0x393acc[_0x415b39(0x10c)]();}_0x4b28ee[_0x415b39(0xfb)]='True';const _0x28f78d=await _0x4b28ee[_0x415b39(0x10c)](),_0x5b24fa=await master_shop[_0x415b39(0x199)](),_0x2e5947=await email_settings[_0x415b39(0x12a)](),_0x142d51=await supervisor_settings[_0x415b39(0x199)]();var _0x4fc355=_0x4b28ee[_0x415b39(0x104)],_0x280d35='',_0x37755a;for(_0x37755a in _0x4fc355){var _0x5dd683='FG';_0x4b28ee['warehouse_name']=='DRY\x20GOODS'&&(_0x5dd683='DG'),_0x280d35+='<tr>'+_0x415b39(0x132)+_0x4fc355[_0x37755a]['product_name']+'</td>'+_0x415b39(0x132)+_0x4fc355[_0x37755a][_0x415b39(0x18a)]+_0x415b39(0x110)+_0x415b39(0x132)+_0x4fc355[_0x37755a]['adjust_qty']+_0x415b39(0x110)+_0x415b39(0x132)+_0x4fc355[_0x37755a][_0x415b39(0xf2)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4fc355[_0x37755a][_0x415b39(0x11c)]+_0x415b39(0x110)+_0x415b39(0x132)+_0x4b28ee['warehouse_name']+_0x415b39(0x110)+_0x415b39(0x132)+_0x4fc355[_0x37755a][_0x415b39(0x143)]+_0x415b39(0x110)+_0x415b39(0x132)+_0x5dd683+_0x4fc355[_0x37755a][_0x415b39(0xf1)]+_0x415b39(0x110)+_0x415b39(0x166);}let _0x3f217c=nodemailer[_0x415b39(0x112)]({'host':_0x2e5947[_0x415b39(0x140)],'port':Number(_0x2e5947[_0x415b39(0x144)]),'secure':![],'auth':{'user':_0x2e5947['email'],'pass':_0x2e5947[_0x415b39(0x122)]}}),_0x46a4c9={'from':_0x2e5947[_0x415b39(0x147)],'to':_0x142d51[0x0][_0x415b39(0x187)],'subject':'Adjustment\x20Mail','attachments':[{'filename':_0x415b39(0x1a6),'path':__dirname+_0x415b39(0x181)+'/upload/'+_0x5b24fa[0x0][_0x415b39(0x11d)],'cid':_0x415b39(0x155)}],'html':_0x415b39(0x14d)+_0x415b39(0x15a)+_0x415b39(0x10d)+'<div>'+_0x415b39(0x178)+'<div>'+_0x415b39(0x196)+_0x415b39(0x1b1)+_0x415b39(0x13c)+'<h2>\x20'+_0x5b24fa[0x0]['site_title']+_0x415b39(0x138)+_0x415b39(0x1b1)+_0x415b39(0x1b1)+_0x415b39(0x11a)+_0x415b39(0x13c)+_0x415b39(0x189)+_0x415b39(0x177)+_0x4b28ee[_0x415b39(0xf5)]+'\x20'+_0x415b39(0x16b)+'\x20Order\x20Date\x20:\x20'+_0x4b28ee['date']+'\x20'+'</span>'+_0x415b39(0xfd)+'</div>'+_0x415b39(0x12f)+_0x415b39(0xf8)+_0x415b39(0x19a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x415b39(0x18d)+_0x415b39(0x137)+_0x415b39(0x123)+_0x415b39(0x148)+_0x415b39(0x13e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x415b39(0x1b4)+'</tr>'+_0x415b39(0x115)+_0x415b39(0x14f)+'\x20'+_0x280d35+'\x20'+'</tbody>'+_0x415b39(0x19d)+'<div>'+_0x415b39(0x139)+'<h5>'+_0x5b24fa[0x0][_0x415b39(0x175)]+_0x415b39(0xfd)+_0x415b39(0x1b1)+_0x415b39(0x1b1)+_0x415b39(0x19b)};_0x3f217c[_0x415b39(0xf3)](_0x46a4c9,function(_0x22ed01,_0x3cfeb7){var _0x16a563=_0x415b39;_0x22ed01?(console[_0x16a563(0x182)](_0x22ed01),console[_0x16a563(0x182)]('Error\x20Occurs')):console[_0x16a563(0x182)](_0x16a563(0x125));}),_0x13503c[_0x415b39(0x169)]('success',_0x415b39(0xf0)),_0x5c8597[_0x415b39(0xec)](_0x415b39(0x113)+_0x28f78d['_id']);}catch(_0x20a70c){console[_0x415b39(0x154)](_0x20a70c),_0x5c8597[_0x415b39(0x124)](0x1f4)[_0x415b39(0x142)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x1bb947(0x133)](_0x7b71f6=>{var _0xfb2feb=_0x1bb947;console['error'](_0x7b71f6),_0x5c8597[_0xfb2feb(0x124)](0x1f4)['json']({'error':_0xfb2feb(0x102)});});}catch(_0x5d995d){_0x5c8597['json']({'message':_0x5d995d[_0x1bb947(0x131)]});}}),router[a0_0x545795(0x16c)](a0_0x545795(0x192),auth,async(_0x57582c,_0x70162e)=>{var _0x34a154=a0_0x545795;try{const {username:_0x83117e,email:_0x92f9ce,role:_0x1eee9d}=_0x57582c['user'],_0xd0c814=_0x57582c['user'],_0x39c586=await profile[_0x34a154(0x12a)]({'email':_0xd0c814[_0x34a154(0x147)]}),_0x3cd699=await master_shop[_0x34a154(0x199)]();console[_0x34a154(0x182)](_0x34a154(0x1a4),_0x3cd699);const _0x327328=_0x57582c['params']['id'],_0x2797c2=await adjustment_finished[_0x34a154(0x171)]({'_id':_0x327328});let _0x51ca44=new Date(_0x2797c2[_0x34a154(0x190)]),_0x15ffc8=('0'+_0x51ca44[_0x34a154(0x127)]())[_0x34a154(0x14c)](-0x2),_0x55d3b7=('0'+(_0x51ca44[_0x34a154(0x135)]()+0x1))['slice'](-0x2),_0x5f1f5c=_0x51ca44[_0x34a154(0x10f)](),_0x419b6b=_0x5f1f5c+'-'+_0x55d3b7+'-'+_0x15ffc8;var _0x32accd=['Ambient',_0x34a154(0x17d),_0x34a154(0x1b5)];const _0xafa8c7=await purchases[_0x34a154(0x1b0)]([{'$match':{'warehouse_name':_0x2797c2[_0x34a154(0x126)]}},{'$unwind':_0x34a154(0x1a2)},{'$group':{'_id':_0x34a154(0x191)}}]);console['log'](_0x34a154(0x14e),_0xafa8c7);const _0x2cce15=await product['find']({}),_0x1a9233=await warehouse[_0x34a154(0x1b0)]([{'$match':{'name':_0x2797c2[_0x34a154(0x126)],'room':_0x2797c2[_0x34a154(0x141)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x34a154(0x188)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x34a154(0x108)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x34a154(0x176)},'floorlevel':{'$first':_0x34a154(0x1a7)},'primary_code':{'$first':_0x34a154(0x100)},'secondary_code':{'$first':_0x34a154(0x10a)},'product_code':{'$first':_0x34a154(0x152)},'storage':{'$first':_0x34a154(0x158)},'rack':{'$first':_0x34a154(0x198)}}}]);if(_0x3cd699[0x0][_0x34a154(0x18f)]==_0x34a154(0xf6)){var _0x37d383=users[_0x34a154(0x120)];console['log'](_0x37d383);}else{if(_0x3cd699[0x0][_0x34a154(0x18f)]==_0x34a154(0x13a))var _0x37d383=users['Hindi'];else{if(_0x3cd699[0x0][_0x34a154(0x18f)]==_0x34a154(0x1b7))var _0x37d383=users['German'];else{if(_0x3cd699[0x0][_0x34a154(0x18f)]==_0x34a154(0x11b))var _0x37d383=users[_0x34a154(0x11b)];else{if(_0x3cd699[0x0][_0x34a154(0x18f)]==_0x34a154(0x15d))var _0x37d383=users[_0x34a154(0x15d)];else{if(_0x3cd699[0x0][_0x34a154(0x18f)]==_0x34a154(0x11e))var _0x37d383=users[_0x34a154(0x1b2)];else{if(_0x3cd699[0x0][_0x34a154(0x18f)]==_0x34a154(0x128))var _0x37d383=users[_0x34a154(0x128)];else{if(_0x3cd699[0x0][_0x34a154(0x18f)]==_0x34a154(0x15b))var _0x37d383=users['Arabic'];}}}}}}}_0x70162e['render'](_0x34a154(0xfe),{'success':_0x57582c['flash']('success'),'errors':_0x57582c['flash'](_0x34a154(0x134)),'role':_0xd0c814,'profile':_0x39c586,'adjustment':_0x2797c2,'stock':_0x1a9233,'master_shop':_0x3cd699,'warehouse_name':_0xafa8c7,'unit':_0x2cce15,'language':_0x37d383,'rooms_data':_0x32accd,'ed_fullDate':_0x419b6b});}catch(_0x45de69){console['log'](_0x45de69),_0x70162e[_0x34a154(0x124)](0xc8)['json']({'message':_0x45de69[_0x34a154(0x131)]});}}),router['post'](a0_0x545795(0x192),auth,async(_0x4b55e7,_0x480df8)=>{var _0x1ac06a=a0_0x545795;try{const _0x1aaf66=_0x4b55e7[_0x1ac06a(0x164)]['id'],_0x421b5e=await adjustment_finished[_0x1ac06a(0x171)]({'_id':_0x1aaf66}),_0x3830df=await warehouse[_0x1ac06a(0x12a)]({'name':_0x421b5e['warehouse_name'],'room':_0x421b5e[_0x1ac06a(0x141)]}),{warehouse_name:_0x2aed6d,date:_0x283c25,prod_name:_0x41e1dc,level:_0x5cb076,isle:_0x50e01c,pallet:_0x136c60,stock:_0xaf8d44,types:_0x1a1746,adjust_qty:_0x52254a,new_adjust_qty:_0x11ecf1,note:_0x489bae,Room_name:_0x541cf6,invoice:_0x29209c,JO_number:_0x2e7aee}=_0x4b55e7['body'];if(typeof _0x41e1dc=='string')var _0x3e34b4=[_0x4b55e7['body'][_0x1ac06a(0x146)]],_0x255ecc=[_0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0x183)]],_0xb87781=[_0x4b55e7[_0x1ac06a(0x145)]['stock']],_0x1af8fd=[_0x4b55e7[_0x1ac06a(0x145)]['types']],_0x260bfe=[_0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0x15f)]],_0x2aa276=[_0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0x1b6)]],_0x1efe09=[_0x4b55e7['body'][_0x1ac06a(0x1aa)]],_0x44294a=[_0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0xf2)]],_0x51d32c=[_0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0x11f)]],_0x2d7f85=[_0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0xf9)]],_0x3af0e8=[_0x4b55e7['body']['expiry_date']];else var _0x3e34b4=[..._0x4b55e7['body'][_0x1ac06a(0x146)]],_0x255ecc=[..._0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0x183)]],_0xb87781=[..._0x4b55e7['body']['stock']],_0x1af8fd=[..._0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0x1a5)]],_0x260bfe=[..._0x4b55e7['body']['adjust_qty']],_0x2aa276=[..._0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0x1b6)]],_0x1efe09=[..._0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0x1aa)]],_0x44294a=[..._0x4b55e7['body'][_0x1ac06a(0xf2)]],_0x51d32c=[..._0x4b55e7[_0x1ac06a(0x145)]['Secondary_units']],_0x2d7f85=[..._0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0xf9)]],_0x3af0e8=[..._0x4b55e7[_0x1ac06a(0x145)][_0x1ac06a(0x190)]];const _0x5984ff=_0x3e34b4[_0x1ac06a(0x106)](_0xab7592=>{return _0xab7592={'product_name':_0xab7592};});_0x255ecc[_0x1ac06a(0x16d)]((_0x224c96,_0x2ea0f1)=>{var _0x289520=_0x1ac06a;_0x5984ff[_0x2ea0f1][_0x289520(0xf1)]=_0x224c96;}),_0xb87781['forEach']((_0x4326e0,_0x3f9a83)=>{var _0x407767=_0x1ac06a;_0x5984ff[_0x3f9a83][_0x407767(0x15e)]=_0x4326e0;}),_0x1af8fd[_0x1ac06a(0x16d)]((_0x1474ae,_0xc2e79)=>{var _0x5d8044=_0x1ac06a;_0x5984ff[_0xc2e79][_0x5d8044(0x1a5)]=_0x1474ae;}),_0x260bfe[_0x1ac06a(0x16d)]((_0x1d98dc,_0x4f717f)=>{var _0x153ae0=_0x1ac06a;_0x5984ff[_0x4f717f][_0x153ae0(0x15f)]=_0x1d98dc;}),_0x2aa276['forEach']((_0xd5195a,_0x2685c2)=>{var _0x3678b8=_0x1ac06a;_0x5984ff[_0x2685c2][_0x3678b8(0x1b6)]=_0xd5195a;}),_0x44294a[_0x1ac06a(0x16d)]((_0x19f979,_0x736616)=>{var _0x57098a=_0x1ac06a;_0x5984ff[_0x736616][_0x57098a(0xf2)]=_0x19f979;}),_0x51d32c[_0x1ac06a(0x16d)]((_0x248b22,_0x287122)=>{var _0x2a5293=_0x1ac06a;_0x5984ff[_0x287122][_0x2a5293(0x11c)]=_0x248b22;}),_0x1efe09['forEach']((_0x5ea8ef,_0x5347dc)=>{var _0x464235=_0x1ac06a;_0x5984ff[_0x5347dc][_0x464235(0x18a)]=_0x5ea8ef;}),_0x2d7f85[_0x1ac06a(0x16d)]((_0x35c0bd,_0x230506)=>{var _0x128b2a=_0x1ac06a;_0x5984ff[_0x230506][_0x128b2a(0xf9)]=_0x35c0bd;}),_0x3af0e8['forEach']((_0x35575d,_0x5e0630)=>{var _0x193db0=_0x1ac06a;_0x5984ff[_0x5e0630][_0x193db0(0x190)]=_0x35575d;});const _0x42eebe=_0x5984ff[_0x1ac06a(0x1a3)](_0x2eac9f=>_0x2eac9f['adjust_qty']!=='0'&&_0x2eac9f['adjust_qty']!=='');var _0x903398=0x0;_0x42eebe[_0x1ac06a(0x16d)](_0x4584a7=>{var _0x13e893=_0x1ac06a;console[_0x13e893(0x182)](_0x13e893(0x194),_0x4584a7),parseInt(_0x4584a7['adjust_qty'])<=0x0&&_0x903398++;});if(_0x903398!=0x0)return _0x4b55e7[_0x1ac06a(0x169)](_0x1ac06a(0x134),_0x1ac06a(0x118)),_0x480df8[_0x1ac06a(0xec)](_0x1ac06a(0x157));_0x421b5e[_0x1ac06a(0x126)]=_0x2aed6d,_0x421b5e[_0x1ac06a(0x109)]=_0x283c25,_0x421b5e[_0x1ac06a(0x104)]=_0x42eebe,_0x421b5e[_0x1ac06a(0x13d)]=_0x489bae,_0x421b5e['room']=_0x541cf6,_0x421b5e[_0x1ac06a(0xf5)]=_0x29209c,_0x421b5e['JO_number']=_0x2e7aee;const _0x1045c3=await _0x421b5e[_0x1ac06a(0x10c)](),_0x499be2=await warehouse[_0x1ac06a(0x12a)]({'name':_0x2aed6d,'room':_0x541cf6});_0x1045c3[_0x1ac06a(0x104)][_0x1ac06a(0x16d)](_0x20a745=>{var _0x4390f5=_0x1ac06a;const _0x41d047=_0x499be2[_0x4390f5(0xfc)][_0x4390f5(0x106)](_0x45e66b=>{var _0x337974=_0x4390f5;_0x20a745[_0x337974(0x1a5)]=='minus'?_0x45e66b[_0x337974(0x161)]==_0x20a745['product_name']&&_0x45e66b[_0x337974(0xf1)]==_0x20a745[_0x337974(0xf1)]&&(_0x45e66b[_0x337974(0x114)]=parseInt(_0x45e66b[_0x337974(0x114)])-parseInt(_0x20a745[_0x337974(0x15f)])):_0x45e66b[_0x337974(0x161)]==_0x20a745[_0x337974(0x161)]&&_0x45e66b[_0x337974(0xf1)]==_0x20a745[_0x337974(0xf1)]&&(_0x45e66b['product_stock']=parseInt(_0x45e66b['product_stock'])+parseInt(_0x20a745[_0x337974(0x15f)]));});}),await _0x499be2['save'](),_0x4b55e7[_0x1ac06a(0x169)](_0x1ac06a(0x136),_0x1ac06a(0x130)),_0x480df8[_0x1ac06a(0xec)]('/adjustment_finished/view');}catch(_0x5730df){console['log'](_0x5730df);}}),router['post'](a0_0x545795(0x180),async(_0x39136e,_0x59c0a5)=>{var _0xb0c636=a0_0x545795;const {primary_code:_0x370ed2,warehouse_data:_0x5c5fde,rooms_data:_0x1cd974,Roomslist:_0x45992c}=_0x39136e[_0xb0c636(0x145)],_0x269484=_0x45992c['split'](','),_0x22e100=[];async function _0xf91275(_0x1a51f2){var _0x36ab52=_0xb0c636;const _0x3b3eaf=await warehouse[_0x36ab52(0x1b0)]([{'$match':{'name':_0x5c5fde,'room':_0x1a51f2}},{'$unwind':_0x36ab52(0x172)},{'$match':{'product_details.primary_code':_0x370ed2}},{'$group':{'_id':_0x36ab52(0x16a),'name':{'$first':_0x36ab52(0x188)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x36ab52(0x100)},'secondary_code':{'$first':_0x36ab52(0x10a)},'product_code':{'$first':_0x36ab52(0x152)},'level':{'$first':_0x36ab52(0x108)},'isle':{'$first':_0x36ab52(0x17f)},'type':{'$first':_0x36ab52(0x176)},'pallet':{'$first':_0x36ab52(0x1a7)},'unit':{'$first':_0x36ab52(0x185)},'secondary_unit':{'$first':_0x36ab52(0x13f)},'storage':{'$first':_0x36ab52(0x158)},'rack':{'$first':_0x36ab52(0x198)},'expiry_date':{'$first':_0x36ab52(0x1a0)},'production_date':{'$first':_0x36ab52(0x14a)},'batch_code':{'$first':_0x36ab52(0x193)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x36ab52(0x165)},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x36ab52(0x1a1)}}}]),_0x2ef30d=await warehouse[_0x36ab52(0x1b0)]([{'$match':{'name':_0x5c5fde,'room':_0x1a51f2}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x370ed2}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x36ab52(0x188)},'product_stock':{'$first':_0x36ab52(0x18c)},'primary_code':{'$first':_0x36ab52(0x100)},'secondary_code':{'$first':_0x36ab52(0x10a)},'product_code':{'$first':_0x36ab52(0x152)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x36ab52(0x17f)},'type':{'$first':_0x36ab52(0x176)},'pallet':{'$first':_0x36ab52(0x1a7)},'unit':{'$first':_0x36ab52(0x185)},'secondary_unit':{'$first':_0x36ab52(0x13f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x36ab52(0x198)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x36ab52(0x14a)},'batch_code':{'$first':_0x36ab52(0x193)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x36ab52(0x165)},'roomNamed':{'$first':_0x36ab52(0x159)},'invoice':{'$first':_0x36ab52(0x1a1)}}}]);if(_0x3b3eaf[_0x36ab52(0xed)]>0x0)_0x22e100[_0x36ab52(0x150)](_0x3b3eaf);else _0x2ef30d[_0x36ab52(0xed)]>0x0&&_0x22e100[_0x36ab52(0x150)](_0x2ef30d);}const _0x54b066=_0x269484['map'](_0x70a6b=>_0xf91275(_0x70a6b));await Promise[_0xb0c636(0x195)](_0x54b066),_0x59c0a5[_0xb0c636(0x142)](_0x22e100);}),router[a0_0x545795(0x163)](a0_0x545795(0x19f),async(_0x2a21c8,_0x89fdc7)=>{var _0x1b2768=a0_0x545795;const {productCode:_0x1cdaec,bay:_0x2b85a8,warehouses:_0x3cb92a,room:_0x160b72}=_0x2a21c8[_0x1b2768(0x145)];console[_0x1b2768(0x182)](_0x2a21c8[_0x1b2768(0x145)]);try{const _0x5c76ac=await warehouse[_0x1b2768(0x1b0)]([{'$match':{'name':_0x3cb92a,'room':_0x160b72}},{'$unwind':_0x1b2768(0x172)},{'$match':{'product_details.bay':parseInt(_0x2b85a8)}},{'$group':{'_id':_0x1b2768(0x16a),'name':{'$first':_0x1b2768(0x188)},'product_stock':{'$first':_0x1b2768(0x18c)},'bay':{'$first':_0x1b2768(0x108)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x89fdc7['status'](0xc8)[_0x1b2768(0x142)](_0x5c76ac);}catch(_0x5aefc){_0x89fdc7[_0x1b2768(0x124)](0x194)[_0x1b2768(0x142)]({'message':_0x5aefc[_0x1b2768(0x131)]});}}),module[a0_0x545795(0x10e)]=router;