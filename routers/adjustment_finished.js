var a0_0x53a67d=a0_0x5a64;function a0_0x3bad(){var _0x19688e=['$product_details.bay','$product_details.storage','forEach','errors','maxPerUnit','$invoice','finalize','<h5\x20style=\x22text-align:\x20left;\x22>','Arabic','expiry_date','An\x20error\x20occurred.','$product','$warehouse_name','<!DOCTYPE\x20html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','</h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','room','$date','Arabic\x20(ae)','product','edit_adjustment_finished_view','getMonth','product_name','error','<div>','createTransport','Chinese','New_Qty_Converted_adj','$product_details.secondary_code','image','$product_details.product_stock','nodemailer','$product.product_name','adjustment\x20data\x20update\x20successfully','<tr>','add','\x20</h2>','../models/all_models','master','4778630whAqso','Adjustment\x20Mail','date','Primary_Units','$product_details.floorlevel','<html><head><title></title>','room_names','staff','invoice','Adjustment\x20Finalize\x20Successfully','$product_details.invoice','French','ADJF-','slice','toString','minus','<h5>','add_adjustment_finished','role','back','site_title','$product_details.rack','2566227nexxsA','$product_details.bin','floor','Portuguese\x20(BR)','string','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','product_stock','padStart','$product_details.secondary_unit','split','unit','/view/:id','save','Hindi','An\x20error\x20occurred\x20while\x20saving\x20data.','Ambient','$name','status','random','length','push','821482GMmFye','German','$product_details.production_date','/barcode_scanner','product_code','$product_details.primary_code','$product_details.maxPerUnit','render','aggregate','True','/upload/','warehouse_name','</tr>','prod_code','adjustment\x20add\x20successfull','secondary_unit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','_id','Enclosed','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<tbody\x20style=\x22text-align:\x20center;\x22>','Rooms','$finalize','English\x20(US)','1ANMByb','types','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','map','Portuguese','5903676LGuxQd','New_Qty_Converted','new_adjust_qty','/CheckingWarehouse','$product_details.product_code','filter','exports','product_date','</td>','$product_details.batch_code','flash','Spanish','QA\x20Warehouse','log','post','json','$product_details.product_name','body','catch','</div>','</tbody>','note','message','getDate','params','/../public','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view','success','/picking_list/PDF_adjustment/','stockBefore','all','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','</span>','Enabled','language','Secondary_units','get','findById','</body></html>','level','stock','Finished\x20Goods','$product.room_names','$product_details.unit','Error\x20Occurs','batch_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','production_date','JO_number','/view/add_adjustment','1474740MQnnXb','Return\x20Rooms','prod_cat','purchases_data','email','prod_name','then','Logo.png','user','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','4GFWCVX','3827304ZLChCu','English','foreach\x20newproduct','findOne','adjust_qty','</head><body>','logo','4220944YRfkdZ','../public/language/languages.json','/preview/:id','$product_details','redirect','prod_invoice','../middleware/auth','bay','warehouse','$product_details._id','$product_details.type','sendMail','</thead>','$room','$_id','/adjustment/view','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','express'];a0_0x3bad=function(){return _0x19688e;};return a0_0x3bad();}function a0_0x5a64(_0x3be0a8,_0x5120cf){var _0x3bad8d=a0_0x3bad();return a0_0x5a64=function(_0x5a642d,_0x32ba81){_0x5a642d=_0x5a642d-0xc5;var _0x22ef00=_0x3bad8d[_0x5a642d];return _0x22ef00;},a0_0x5a64(_0x3be0a8,_0x5120cf);}(function(_0x2dfd79,_0xa6d964){var _0x170ba2=a0_0x5a64,_0x1bb502=_0x2dfd79();while(!![]){try{var _0xfe61fc=parseInt(_0x170ba2(0x16e))/0x1*(parseInt(_0x170ba2(0x156))/0x2)+parseInt(_0x170ba2(0x141))/0x3*(parseInt(_0x170ba2(0xe9))/0x4)+-parseInt(_0x170ba2(0x12b))/0x5+-parseInt(_0x170ba2(0xdf))/0x6+parseInt(_0x170ba2(0xf1))/0x7+parseInt(_0x170ba2(0xea))/0x8+-parseInt(_0x170ba2(0x174))/0x9;if(_0xfe61fc===_0xa6d964)break;else _0x1bb502['push'](_0x1bb502['shift']());}catch(_0x1ed482){_0x1bb502['push'](_0x1bb502['shift']());}}}(a0_0x3bad,0x77a5b));const express=require(a0_0x53a67d(0x102)),app=express(),router=express['Router'](),auth=require(a0_0x53a67d(0xf7)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x53a67d(0x129)),users=require(a0_0x53a67d(0xf2)),nodemailer=require(a0_0x53a67d(0x123));router[a0_0x53a67d(0xd1)](a0_0x53a67d(0xc6),auth,async(_0x51ea9e,_0x453362)=>{var _0x2c5e39=a0_0x53a67d;try{const {username:_0x6ebbe,email:_0x58a1f8,role:_0x2b6eec}=_0x51ea9e['user'],_0x1c823e=_0x51ea9e[_0x2c5e39(0xe7)],_0x4bff4c=await profile['findOne']({'email':_0x1c823e[_0x2c5e39(0xe3)]}),_0x2ff320=await master_shop['find']();let _0x32c12c;if(_0x1c823e[_0x2c5e39(0x13d)]==_0x2c5e39(0x132)){const _0x1313f6=await staff[_0x2c5e39(0xed)]({'email':_0x1c823e['email']});_0x32c12c=await warehouse[_0x2c5e39(0x170)]({'status':_0x2c5e39(0xce),'name':_0x1313f6['warehouse']});}else _0x32c12c=await warehouse['find']({'status':_0x2c5e39(0xce)});const _0x501a75=await product[_0x2c5e39(0x170)]();let _0x505a59;if(_0x1c823e[_0x2c5e39(0x13d)]==_0x2c5e39(0x132)){const _0x3e2da5=await staff[_0x2c5e39(0xed)]({'email':_0x1c823e[_0x2c5e39(0xe3)]});_0x505a59=await adjustment_finished[_0x2c5e39(0x170)]({'warehouse_name':_0x3e2da5[_0x2c5e39(0xf9)]});}else _0x505a59=await adjustment_finished['aggregate']([{'$unwind':_0x2c5e39(0x10e)},{'$group':{'_id':_0x2c5e39(0xff),'invoice':{'$first':_0x2c5e39(0x108)},'date':{'$first':_0x2c5e39(0x115)},'warehouse_name':{'$first':_0x2c5e39(0x10f)},'room':{'$addToSet':_0x2c5e39(0xd7)},'finalize':{'$first':_0x2c5e39(0x16c)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x2ff320[0x0]['language']=='English\x20(US)'){var _0x8dde7d=users[_0x2c5e39(0xeb)];console[_0x2c5e39(0x181)](_0x8dde7d);}else{if(_0x2ff320[0x0][_0x2c5e39(0xcf)]=='Hindi')var _0x8dde7d=users[_0x2c5e39(0x14e)];else{if(_0x2ff320[0x0][_0x2c5e39(0xcf)]==_0x2c5e39(0x157))var _0x8dde7d=users[_0x2c5e39(0x157)];else{if(_0x2ff320[0x0][_0x2c5e39(0xcf)]==_0x2c5e39(0x17f))var _0x8dde7d=users[_0x2c5e39(0x17f)];else{if(_0x2ff320[0x0][_0x2c5e39(0xcf)]==_0x2c5e39(0x136))var _0x8dde7d=users[_0x2c5e39(0x136)];else{if(_0x2ff320[0x0]['language']==_0x2c5e39(0x144))var _0x8dde7d=users[_0x2c5e39(0x173)];else{if(_0x2ff320[0x0][_0x2c5e39(0xcf)]==_0x2c5e39(0x11e))var _0x8dde7d=users[_0x2c5e39(0x11e)];else{if(_0x2ff320[0x0][_0x2c5e39(0xcf)]=='Arabic\x20(ae)')var _0x8dde7d=users[_0x2c5e39(0x10b)];}}}}}}}_0x453362['render']('adjustment_finished',{'success':_0x51ea9e[_0x2c5e39(0x17e)](_0x2c5e39(0xc7)),'errors':_0x51ea9e['flash']('errors'),'role':_0x1c823e,'profile':_0x4bff4c,'warehouse':_0x32c12c,'product':_0x501a75,'adjustment':_0x505a59,'master_shop':_0x2ff320,'language':_0x8dde7d});}catch(_0x28612c){console[_0x2c5e39(0x181)](_0x28612c);}});async function getRandom8DigitNumber(){var _0x300ce2=a0_0x53a67d;const _0x5bb05b=0x989680,_0x42148e=0x5f5e0ff,_0x3900fb=Math[_0x300ce2(0x143)](Math[_0x300ce2(0x153)]()*(_0x42148e-_0x5bb05b+0x1))+_0x5bb05b;var _0x27973e;const _0x1d777c=await adjustment_finished[_0x300ce2(0xed)]({'invoice':'ADJF-'+_0x3900fb});return _0x1d777c&&_0x1d777c[_0x300ce2(0x154)]>0x0?_0x27973e='ADJF-'+_0x3900fb:_0x27973e='ADJF-'+_0x3900fb,_0x27973e;}router[a0_0x53a67d(0xd1)](a0_0x53a67d(0xde),auth,async(_0x4127d8,_0x752782)=>{var _0x53902b=a0_0x53a67d;try{const {username:_0x40de2f,email:_0x4faad9,role:_0x4dcfc1}=_0x4127d8['user'],_0x3685eb=_0x4127d8[_0x53902b(0xe7)],_0x379849=await profile[_0x53902b(0xed)]({'email':_0x3685eb[_0x53902b(0xe3)]}),_0x208fcd=await master_shop['find']();let _0x2401ad;if(_0x3685eb[_0x53902b(0x13d)]==_0x53902b(0x132)){const _0x294be1=await staff['findOne']({'email':_0x3685eb[_0x53902b(0xe3)]});_0x2401ad=await warehouse['aggregate']([{'$match':{'status':_0x53902b(0xce),'name':_0x294be1[_0x53902b(0xf9)],'warehouse_category':_0x53902b(0xd6),'name':{'$ne':_0x53902b(0x180)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x2401ad=await warehouse[_0x53902b(0x15e)]([{'$match':{'status':_0x53902b(0xce),'warehouse_category':_0x53902b(0xd6),'name':{'$ne':_0x53902b(0x180)}}},{'$group':{'_id':'$name','name':{'$first':_0x53902b(0x151)}}}]);const _0x19f471=await product[_0x53902b(0x170)]({}),_0x5125da=await adjustment_finished['find']({}),_0x52c485=_0x5125da['length']+0x1,_0x1eb324=_0x53902b(0x137)+_0x52c485[_0x53902b(0x139)]()[_0x53902b(0x148)](0x5,'0');var _0x2712d8=[_0x53902b(0x150),_0x53902b(0x168),_0x53902b(0xe0)];if(_0x208fcd[0x0][_0x53902b(0xcf)]==_0x53902b(0x16d))var _0x3cb01a=users[_0x53902b(0xeb)];else{if(_0x208fcd[0x0][_0x53902b(0xcf)]==_0x53902b(0x14e))var _0x3cb01a=users['Hindi'];else{if(_0x208fcd[0x0]['language']==_0x53902b(0x157))var _0x3cb01a=users['German'];else{if(_0x208fcd[0x0][_0x53902b(0xcf)]==_0x53902b(0x17f))var _0x3cb01a=users[_0x53902b(0x17f)];else{if(_0x208fcd[0x0][_0x53902b(0xcf)]==_0x53902b(0x136))var _0x3cb01a=users['French'];else{if(_0x208fcd[0x0][_0x53902b(0xcf)]==_0x53902b(0x144))var _0x3cb01a=users[_0x53902b(0x173)];else{if(_0x208fcd[0x0][_0x53902b(0xcf)]==_0x53902b(0x11e))var _0x3cb01a=users[_0x53902b(0x11e)];else{if(_0x208fcd[0x0][_0x53902b(0xcf)]=='Arabic\x20(ae)')var _0x3cb01a=users[_0x53902b(0x10b)];}}}}}}}const _0x5906e1=getRandom8DigitNumber();_0x5906e1['then'](_0x5b46aa=>{var _0x18be50=_0x53902b;_0x752782[_0x18be50(0x15d)](_0x18be50(0x13c),{'success':_0x4127d8[_0x18be50(0x17e)](_0x18be50(0xc7)),'errors':_0x4127d8[_0x18be50(0x17e)](_0x18be50(0x106)),'role':_0x3685eb,'profile':_0x379849,'warehouse':_0x2401ad,'product':_0x19f471,'master_shop':_0x208fcd,'language':_0x3cb01a,'rooms_data':_0x2712d8,'invoice_no':_0x5b46aa});})[_0x53902b(0x186)](_0x111cf4=>{var _0x20dd60=_0x53902b;_0x4127d8[_0x20dd60(0x17e)](_0x20dd60(0x106),_0x20dd60(0x166)),_0x752782['redirect'](_0x20dd60(0x100));});}catch(_0x24ecaf){console[_0x53902b(0x181)](_0x24ecaf);}}),router[a0_0x53a67d(0x182)](a0_0x53a67d(0xde),auth,async(_0x522ce1,_0x2924e6)=>{var _0x4eebd9=a0_0x53a67d;try{const {warehouse_name:_0x59bf11,date:_0x2ad85d,prod_name:_0x2b30c4,level:_0x5af529,isle:_0x31a307,pallet:_0x312276,stock:_0x202e8b,types:_0x189cdc,adjust_qty:_0x1fb22b,new_adjust_qty:_0x30a4ee,note:_0x28f99c,Room_name:_0x3a638d,invoice:_0xf5cd5,JO_number:_0x386d04,expiry_date:_0x1a05d0}=_0x522ce1[_0x4eebd9(0x185)];if(typeof _0x2b30c4==_0x4eebd9(0x145))var _0x5ec75b=[_0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0xe4)]],_0x231c24=[_0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0xd4)]],_0x1afaa2=[_0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0xd5)]],_0x279cbe=[_0x522ce1[_0x4eebd9(0x185)]['types']],_0x4a3f56=[_0x522ce1[_0x4eebd9(0x185)]['New_Qty_Converted_adj']],_0x53ca63=[_0x522ce1[_0x4eebd9(0x185)]['New_Qty_Converted']],_0x4095d8=[_0x522ce1['body'][_0x4eebd9(0x12e)]],_0x2df64d=[_0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0xd0)]],_0x347352=[_0x522ce1['body']['prod_code']],_0x351de8=[_0x522ce1[_0x4eebd9(0x185)]['batch_code']],_0x1ec8cd=[_0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0x10c)]],_0x2e3e6d=[_0x522ce1['body'][_0x4eebd9(0x17b)]],_0x4327e8=[_0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0xe1)]],_0x2af25f=[_0x522ce1[_0x4eebd9(0x185)]['Rooms']],_0x45cb95=[_0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0x107)]],_0x307a8e=[_0x522ce1['body']['prod_invoice']];else var _0x5ec75b=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0xe4)]],_0x231c24=[..._0x522ce1['body'][_0x4eebd9(0xd4)]],_0x1afaa2=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0xd5)]],_0x279cbe=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0x16f)]],_0x4a3f56=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0x11f)]],_0x53ca63=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0x175)]],_0x4095d8=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0x12e)]],_0x2df64d=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0xd0)]],_0x347352=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0x163)]],_0x351de8=[..._0x522ce1['body']['batch_code']],_0x1ec8cd=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0x10c)]],_0x2e3e6d=[..._0x522ce1['body'][_0x4eebd9(0x17b)]],_0x4327e8=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0xe1)]],_0x2af25f=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0x16b)]],_0x45cb95=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0x107)]],_0x307a8e=[..._0x522ce1[_0x4eebd9(0x185)][_0x4eebd9(0xf6)]];const _0x1186df=_0x5ec75b[_0x4eebd9(0x172)](_0x53ea44=>{return _0x53ea44={'product_name':_0x53ea44};});_0x231c24[_0x4eebd9(0x105)]((_0x84aa5,_0x254574)=>{var _0x2f9226=_0x4eebd9;_0x1186df[_0x254574][_0x2f9226(0xf8)]=_0x84aa5;}),_0x1afaa2[_0x4eebd9(0x105)]((_0x1d9c5a,_0x45b5b1)=>{var _0xfdbdf9=_0x4eebd9;_0x1186df[_0x45b5b1][_0xfdbdf9(0xc9)]=_0x1d9c5a;}),_0x279cbe[_0x4eebd9(0x105)]((_0x3aa5c7,_0x1046d3)=>{var _0x55f7df=_0x4eebd9;_0x1186df[_0x1046d3][_0x55f7df(0x16f)]=_0x3aa5c7;}),_0x4a3f56[_0x4eebd9(0x105)]((_0x4b25e0,_0x396111)=>{var _0x34238c=_0x4eebd9;_0x1186df[_0x396111][_0x34238c(0xee)]=_0x4b25e0;}),_0x53ca63[_0x4eebd9(0x105)]((_0xf74549,_0x2646cd)=>{var _0x160886=_0x4eebd9;_0x1186df[_0x2646cd][_0x160886(0x176)]=_0xf74549;}),_0x4095d8['forEach']((_0x27f0a0,_0x5103ce)=>{var _0x15cd18=_0x4eebd9;_0x1186df[_0x5103ce][_0x15cd18(0x14b)]=_0x27f0a0;}),_0x2df64d[_0x4eebd9(0x105)]((_0x429f90,_0x405264)=>{_0x1186df[_0x405264]['secondary_unit']=_0x429f90;}),_0x347352['forEach']((_0x247feb,_0x374ee5)=>{_0x1186df[_0x374ee5]['product_code']=_0x247feb;}),_0x351de8['forEach']((_0x3c6d3b,_0x32bd52)=>{var _0x648478=_0x4eebd9;_0x1186df[_0x32bd52][_0x648478(0xda)]=_0x3c6d3b;}),_0x1ec8cd[_0x4eebd9(0x105)]((_0x25552c,_0x32ae41)=>{var _0x4f769e=_0x4eebd9;_0x1186df[_0x32ae41][_0x4f769e(0x10c)]=_0x25552c;}),_0x2e3e6d['forEach']((_0x1264c8,_0xc3d0a7)=>{_0x1186df[_0xc3d0a7]['production_date']=_0x1264c8;}),_0x4327e8[_0x4eebd9(0x105)]((_0x340721,_0x3de81e)=>{var _0x1bfc14=_0x4eebd9;_0x1186df[_0x3de81e][_0x1bfc14(0xe1)]=_0x340721;}),_0x2af25f[_0x4eebd9(0x105)]((_0x411dad,_0x487772)=>{var _0x34e9df=_0x4eebd9;_0x1186df[_0x487772][_0x34e9df(0x131)]=_0x411dad;}),_0x45cb95['forEach']((_0x51ba84,_0x180e58)=>{var _0x12e9ed=_0x4eebd9;_0x1186df[_0x180e58][_0x12e9ed(0x107)]=_0x51ba84;}),_0x307a8e[_0x4eebd9(0x105)]((_0x3c3f7a,_0x4bc159)=>{var _0x2002cc=_0x4eebd9;_0x1186df[_0x4bc159][_0x2002cc(0x133)]=_0x3c3f7a;});const _0x157c7e=_0x1186df['filter'](_0x448ba9=>_0x448ba9[_0x4eebd9(0xee)]!=='0'&&_0x448ba9[_0x4eebd9(0xee)]!=='');var _0x102118=0x0;_0x157c7e['forEach'](_0x1f1a0d=>{var _0x3d17cc=_0x4eebd9;console[_0x3d17cc(0x181)]('foreach\x20newproduct',_0x1f1a0d),parseInt(_0x1f1a0d[_0x3d17cc(0xee)])<=0x0&&_0x102118++;});if(_0x102118!=0x0)return _0x522ce1[_0x4eebd9(0x17e)](_0x4eebd9(0x106),_0x4eebd9(0xcc)),_0x2924e6[_0x4eebd9(0xf5)]('back');const _0x376782=new adjustment_finished({'warehouse_name':_0x59bf11,'date':_0x2ad85d,'product':_0x157c7e,'note':_0x28f99c,'room':_0x3a638d,'invoice':_0xf5cd5,'JO_number':_0x386d04,'expiry_date':_0x1a05d0}),_0x4c9c58=await _0x376782[_0x4eebd9(0x14d)]();_0x522ce1[_0x4eebd9(0x17e)](_0x4eebd9(0xc7),_0x4eebd9(0x164)),_0x2924e6[_0x4eebd9(0xf5)]('/adjustment_finished/preview/'+_0x4c9c58[_0x4eebd9(0x167)]);}catch(_0x53851f){console['log'](_0x53851f),_0x2924e6[_0x4eebd9(0x152)](0xc8)['json']({'message':_0x53851f[_0x4eebd9(0x18a)]});}}),router[a0_0x53a67d(0xd1)]('/preview/:id',auth,async(_0x218b6e,_0x40587f)=>{var _0x338901=a0_0x53a67d;try{const {username:_0x1a6aa2,email:_0x3fe9ea,role:_0x3c264d}=_0x218b6e[_0x338901(0xe7)],_0x593df2=_0x218b6e['user'],_0x2a7b71=await profile['findOne']({'email':_0x593df2[_0x338901(0xe3)]}),_0x1a3e1a=await master_shop[_0x338901(0x170)](),_0x2466a7=_0x218b6e[_0x338901(0x18c)]['id'],_0x1ba0b0=await adjustment_finished[_0x338901(0xd2)]({'_id':_0x2466a7}),_0x221f14=await purchases['aggregate']([{'$match':{'warehouse_name':_0x1ba0b0[_0x338901(0x161)]}},{'$unwind':_0x338901(0x10e)},{'$group':{'_id':_0x338901(0x124)}}]);console[_0x338901(0x181)]('purchases_data',_0x221f14);const _0x27b617=await product[_0x338901(0x170)]({}),_0x46f9df=await warehouse[_0x338901(0x15e)]([{'$match':{'name':_0x1ba0b0[_0x338901(0x161)],'warehouse_category':_0x338901(0xd6)}},{'$unwind':_0x338901(0xf4)},{'$group':{'_id':_0x338901(0xfa),'name':{'$first':_0x338901(0x184)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x338901(0x12f)},'primary_code':{'$first':_0x338901(0x15b)},'secondary_code':{'$first':_0x338901(0x120)},'product_code':{'$first':_0x338901(0x178)},'storage':{'$first':_0x338901(0x104)},'rack':{'$first':_0x338901(0x140)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x338901(0x158)},'batch_code':{'$first':_0x338901(0x17d)},'maxPerUnit':{'$first':_0x338901(0x15c)},'room':{'$first':'$room'}}}]);if(_0x1a3e1a[0x0]['language']==_0x338901(0x16d)){var _0x1d6b98=users[_0x338901(0xeb)];console[_0x338901(0x181)](_0x1d6b98);}else{if(_0x1a3e1a[0x0][_0x338901(0xcf)]=='Hindi')var _0x1d6b98=users[_0x338901(0x14e)];else{if(_0x1a3e1a[0x0][_0x338901(0xcf)]==_0x338901(0x157))var _0x1d6b98=users['German'];else{if(_0x1a3e1a[0x0]['language']=='Spanish')var _0x1d6b98=users[_0x338901(0x17f)];else{if(_0x1a3e1a[0x0][_0x338901(0xcf)]=='French')var _0x1d6b98=users[_0x338901(0x136)];else{if(_0x1a3e1a[0x0]['language']==_0x338901(0x144))var _0x1d6b98=users['Portuguese'];else{if(_0x1a3e1a[0x0][_0x338901(0xcf)]==_0x338901(0x11e))var _0x1d6b98=users[_0x338901(0x11e)];else{if(_0x1a3e1a[0x0][_0x338901(0xcf)]==_0x338901(0x116))var _0x1d6b98=users['Arabic'];}}}}}}}_0x40587f[_0x338901(0x15d)](_0x338901(0x118),{'success':_0x218b6e['flash']('success'),'errors':_0x218b6e[_0x338901(0x17e)](_0x338901(0x106)),'role':_0x593df2,'profile':_0x2a7b71,'adjustment':_0x1ba0b0,'stock':_0x46f9df,'master_shop':_0x1a3e1a,'warehouse_name':_0x221f14,'unit':_0x27b617,'language':_0x1d6b98});}catch(_0x141e23){console[_0x338901(0x181)](_0x141e23),_0x40587f[_0x338901(0x152)](0xc8)['json']({'message':_0x141e23[_0x338901(0x18a)]});}}),router[a0_0x53a67d(0x182)](a0_0x53a67d(0xf3),auth,async(_0x24e06f,_0x26b168)=>{var _0x115292=a0_0x53a67d;try{const {invoice:_0x16f4cd,warehouse_name:_0x29b11c,Room_name:_0x1c8142}=_0x24e06f[_0x115292(0x185)],_0x33e7ae=_0x24e06f[_0x115292(0x18c)]['id'],_0x5c34a7=await adjustment_finished['findById']({'_id':_0x33e7ae});var _0xebe8c9;const _0x148afa=_0x5c34a7['product'][_0x115292(0x172)](async _0x1a898d=>{var _0x2cf79c=_0x115292;if(_0x1a898d[_0x2cf79c(0xee)]>0x0){_0xebe8c9=await warehouse[_0x2cf79c(0xed)]({'name':_0x29b11c,'room':_0x1a898d[_0x2cf79c(0x131)],'warehouse_category':_0x2cf79c(0xd6)});const _0x24336a=_0xebe8c9['product_details'][_0x2cf79c(0x172)](_0x464aba=>{var _0x163344=_0x2cf79c;console[_0x163344(0x181)](_0x1a898d['types']);if(_0x1a898d['types']==_0x163344(0x13a))_0x464aba[_0x163344(0x11a)]==_0x1a898d[_0x163344(0x11a)]&&_0x464aba[_0x163344(0xf8)]==_0x1a898d[_0x163344(0xf8)]&&_0x464aba[_0x163344(0x10c)]==_0x1a898d[_0x163344(0x10c)]&&_0x464aba[_0x163344(0xdc)]==_0x1a898d[_0x163344(0xdc)]&&_0x464aba[_0x163344(0xda)]==_0x1a898d[_0x163344(0xda)]&&_0x464aba[_0x163344(0x133)]==_0x1a898d[_0x163344(0x133)]&&(_0x464aba[_0x163344(0x147)]=_0x464aba[_0x163344(0x147)]-_0x1a898d[_0x163344(0xee)]);else _0x1a898d[_0x163344(0x16f)]==_0x163344(0x127)&&(_0x464aba['product_name']==_0x1a898d[_0x163344(0x11a)]&&_0x464aba[_0x163344(0xf8)]==_0x1a898d[_0x163344(0xf8)]&&_0x464aba['expiry_date']==_0x1a898d[_0x163344(0x10c)]&&_0x464aba[_0x163344(0xdc)]==_0x1a898d['production_date']&&_0x464aba[_0x163344(0xda)]==_0x1a898d[_0x163344(0xda)]&&_0x464aba[_0x163344(0x133)]==_0x1a898d[_0x163344(0x133)]&&(_0x464aba[_0x163344(0x147)]=_0x464aba[_0x163344(0x147)]+_0x1a898d[_0x163344(0xee)]));});}return _0xebe8c9;});Promise[_0x115292(0xca)](_0x148afa)[_0x115292(0xe5)](async _0x2ae907=>{var _0x247336=_0x115292;try{for(const _0x2c6e4e of _0x2ae907){await _0x2c6e4e[_0x247336(0x14d)]();}_0x5c34a7[_0x247336(0x109)]=_0x247336(0x15f);const _0x26f096=await _0x5c34a7[_0x247336(0x14d)](),_0x358400=await master_shop[_0x247336(0x170)](),_0x3b5547=await email_settings[_0x247336(0xed)](),_0x45638d=await supervisor_settings['find']();var _0x565c7b=_0x5c34a7['product'],_0x1aca68='',_0x5d93c6;for(_0x5d93c6 in _0x565c7b){var _0x695927='FG';_0x5c34a7[_0x247336(0x161)]=='DRY\x20GOODS'&&(_0x695927='DG'),_0x1aca68+=_0x247336(0x126)+_0x247336(0xdb)+_0x565c7b[_0x5d93c6]['product_name']+_0x247336(0x17c)+_0x247336(0xdb)+_0x565c7b[_0x5d93c6][_0x247336(0x15a)]+_0x247336(0x17c)+_0x247336(0xdb)+_0x565c7b[_0x5d93c6][_0x247336(0xee)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x565c7b[_0x5d93c6][_0x247336(0x14b)]+_0x247336(0x17c)+_0x247336(0xdb)+_0x565c7b[_0x5d93c6]['secondary_unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5c34a7[_0x247336(0x161)]+_0x247336(0x17c)+_0x247336(0xdb)+_0x565c7b[_0x5d93c6][_0x247336(0x131)]+_0x247336(0x17c)+_0x247336(0xdb)+_0x695927+_0x565c7b[_0x5d93c6]['bay']+_0x247336(0x17c)+_0x247336(0x162);}let _0x5dad34=nodemailer[_0x247336(0x11d)]({'host':_0x3b5547['host'],'port':Number(_0x3b5547['port']),'secure':![],'auth':{'user':_0x3b5547[_0x247336(0xe3)],'pass':_0x3b5547['password']}}),_0x1e951a={'from':_0x3b5547[_0x247336(0xe3)],'to':_0x45638d[0x0]['FGSEmail'],'subject':_0x247336(0x12c),'attachments':[{'filename':_0x247336(0xe6),'path':__dirname+_0x247336(0x18d)+_0x247336(0x160)+_0x358400[0x0][_0x247336(0x121)],'cid':_0x247336(0xf0)}],'html':_0x247336(0x110)+_0x247336(0x130)+_0x247336(0xef)+_0x247336(0x11c)+_0x247336(0x146)+_0x247336(0x11c)+_0x247336(0xe8)+_0x247336(0x187)+_0x247336(0x11c)+'<h2>\x20'+_0x358400[0x0][_0x247336(0x13f)]+_0x247336(0x128)+_0x247336(0x187)+_0x247336(0x187)+'<hr\x20class=\x22my-3\x22>'+_0x247336(0x11c)+_0x247336(0x10a)+'\x20Order\x20Number\x20:\x20'+_0x5c34a7[_0x247336(0x133)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x5c34a7[_0x247336(0x12d)]+'\x20'+_0x247336(0xcd)+_0x247336(0x112)+_0x247336(0x187)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x247336(0x101)+_0x247336(0x126)+_0x247336(0xc5)+_0x247336(0x169)+_0x247336(0x113)+_0x247336(0x171)+_0x247336(0xcb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x247336(0x111)+_0x247336(0x162)+_0x247336(0xfd)+_0x247336(0x16a)+'\x20'+_0x1aca68+'\x20'+_0x247336(0x188)+'</table>'+_0x247336(0x11c)+'<strong>\x20Regards\x20</strong>'+_0x247336(0x13b)+_0x358400[0x0]['site_title']+'</h5>'+_0x247336(0x187)+_0x247336(0x187)+_0x247336(0xd3)};_0x5dad34[_0x247336(0xfc)](_0x1e951a,function(_0x4016ca,_0x4ed831){var _0xe5738f=_0x247336;_0x4016ca?(console['log'](_0x4016ca),console[_0xe5738f(0x181)](_0xe5738f(0xd9))):console[_0xe5738f(0x181)]('Email\x20sent\x20successfully');}),_0x24e06f[_0x247336(0x17e)](_0x247336(0xc7),_0x247336(0x134)),_0x26b168[_0x247336(0xf5)](_0x247336(0xc8)+_0x26f096[_0x247336(0x167)]);}catch(_0x3ed155){console[_0x247336(0x11b)](_0x3ed155),_0x26b168[_0x247336(0x152)](0x1f4)[_0x247336(0x183)]({'error':_0x247336(0x14f)});}})[_0x115292(0x186)](_0x287a83=>{var _0x49f625=_0x115292;console[_0x49f625(0x11b)](_0x287a83),_0x26b168[_0x49f625(0x152)](0x1f4)[_0x49f625(0x183)]({'error':_0x49f625(0x10d)});});}catch(_0x132fd7){_0x26b168['json']({'message':_0x132fd7[_0x115292(0x18a)]});}}),router[a0_0x53a67d(0xd1)]('/view/:id',auth,async(_0x266c2f,_0x4b6bd0)=>{var _0xc8909b=a0_0x53a67d;try{const {username:_0x2083a,email:_0x5205c9,role:_0x50e0dd}=_0x266c2f[_0xc8909b(0xe7)],_0x7fc901=_0x266c2f[_0xc8909b(0xe7)],_0x287772=await profile[_0xc8909b(0xed)]({'email':_0x7fc901[_0xc8909b(0xe3)]}),_0x26c2ac=await master_shop[_0xc8909b(0x170)]();console[_0xc8909b(0x181)](_0xc8909b(0x12a),_0x26c2ac);const _0x2f3ad3=_0x266c2f[_0xc8909b(0x18c)]['id'],_0x53326d=await adjustment_finished[_0xc8909b(0xd2)]({'_id':_0x2f3ad3});let _0x20ecac=new Date(_0x53326d[_0xc8909b(0x10c)]),_0x23f566=('0'+_0x20ecac[_0xc8909b(0x18b)]())[_0xc8909b(0x138)](-0x2),_0x2965fd=('0'+(_0x20ecac[_0xc8909b(0x119)]()+0x1))[_0xc8909b(0x138)](-0x2),_0x3c307d=_0x20ecac['getFullYear'](),_0x412cc9=_0x3c307d+'-'+_0x2965fd+'-'+_0x23f566;var _0x51fb50=[_0xc8909b(0x150),_0xc8909b(0x168),_0xc8909b(0xe0)];const _0x53d0f0=await purchases[_0xc8909b(0x15e)]([{'$match':{'warehouse_name':_0x53326d[_0xc8909b(0x161)]}},{'$unwind':_0xc8909b(0x10e)},{'$group':{'_id':_0xc8909b(0x124)}}]);console['log'](_0xc8909b(0xe2),_0x53d0f0);const _0xfc73f0=await product[_0xc8909b(0x170)]({}),_0x3b0634=await warehouse[_0xc8909b(0x15e)]([{'$match':{'name':_0x53326d[_0xc8909b(0x161)],'room':_0x53326d[_0xc8909b(0x114)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0xc8909b(0xfa),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xc8909b(0x103)},'bin':{'$first':_0xc8909b(0x142)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xc8909b(0x12f)},'primary_code':{'$first':_0xc8909b(0x15b)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xc8909b(0x178)},'storage':{'$first':_0xc8909b(0x104)},'rack':{'$first':'$product_details.rack'}}}]);if(_0x26c2ac[0x0][_0xc8909b(0xcf)]==_0xc8909b(0x16d)){var _0x54903f=users[_0xc8909b(0xeb)];console[_0xc8909b(0x181)](_0x54903f);}else{if(_0x26c2ac[0x0][_0xc8909b(0xcf)]==_0xc8909b(0x14e))var _0x54903f=users['Hindi'];else{if(_0x26c2ac[0x0][_0xc8909b(0xcf)]=='German')var _0x54903f=users[_0xc8909b(0x157)];else{if(_0x26c2ac[0x0]['language']=='Spanish')var _0x54903f=users[_0xc8909b(0x17f)];else{if(_0x26c2ac[0x0][_0xc8909b(0xcf)]==_0xc8909b(0x136))var _0x54903f=users[_0xc8909b(0x136)];else{if(_0x26c2ac[0x0][_0xc8909b(0xcf)]==_0xc8909b(0x144))var _0x54903f=users[_0xc8909b(0x173)];else{if(_0x26c2ac[0x0][_0xc8909b(0xcf)]==_0xc8909b(0x11e))var _0x54903f=users[_0xc8909b(0x11e)];else{if(_0x26c2ac[0x0][_0xc8909b(0xcf)]==_0xc8909b(0x116))var _0x54903f=users[_0xc8909b(0x10b)];}}}}}}}_0x4b6bd0[_0xc8909b(0x15d)]('edit_adjustment_finished',{'success':_0x266c2f[_0xc8909b(0x17e)](_0xc8909b(0xc7)),'errors':_0x266c2f[_0xc8909b(0x17e)](_0xc8909b(0x106)),'role':_0x7fc901,'profile':_0x287772,'adjustment':_0x53326d,'stock':_0x3b0634,'master_shop':_0x26c2ac,'warehouse_name':_0x53d0f0,'unit':_0xfc73f0,'language':_0x54903f,'rooms_data':_0x51fb50,'ed_fullDate':_0x412cc9});}catch(_0x12fefc){console[_0xc8909b(0x181)](_0x12fefc),_0x4b6bd0[_0xc8909b(0x152)](0xc8)['json']({'message':_0x12fefc[_0xc8909b(0x18a)]});}}),router[a0_0x53a67d(0x182)](a0_0x53a67d(0x14c),auth,async(_0x42c31b,_0x21b61a)=>{var _0x448add=a0_0x53a67d;try{const _0x3fc810=_0x42c31b['params']['id'],_0x3e3994=await adjustment_finished['findById']({'_id':_0x3fc810}),_0x43e681=await warehouse[_0x448add(0xed)]({'name':_0x3e3994['warehouse_name'],'room':_0x3e3994[_0x448add(0x114)]}),{warehouse_name:_0x4780fd,date:_0xc1da59,prod_name:_0x5c0c37,level:_0x58e5bb,isle:_0x12a230,pallet:_0x8c411,stock:_0x16980a,types:_0x3d345a,adjust_qty:_0x48f817,new_adjust_qty:_0x4e2f23,note:_0x39f4ea,Room_name:_0x517e74,invoice:_0x462c38,JO_number:_0x4d5bef}=_0x42c31b[_0x448add(0x185)];if(typeof _0x5c0c37==_0x448add(0x145))var _0x2abae9=[_0x42c31b[_0x448add(0x185)][_0x448add(0xe4)]],_0x23b145=[_0x42c31b[_0x448add(0x185)][_0x448add(0xd4)]],_0x226273=[_0x42c31b[_0x448add(0x185)][_0x448add(0xd5)]],_0x3af8e8=[_0x42c31b['body'][_0x448add(0x16f)]],_0x740397=[_0x42c31b[_0x448add(0x185)][_0x448add(0xee)]],_0x461645=[_0x42c31b[_0x448add(0x185)][_0x448add(0x176)]],_0x34be74=[_0x42c31b[_0x448add(0x185)][_0x448add(0x163)]],_0x310b1f=[_0x42c31b[_0x448add(0x185)][_0x448add(0x14b)]],_0x296a02=[_0x42c31b[_0x448add(0x185)][_0x448add(0xd0)]],_0x48dfab=[_0x42c31b[_0x448add(0x185)]['batch_code']],_0x2fc7c8=[_0x42c31b[_0x448add(0x185)][_0x448add(0x10c)]];else var _0x2abae9=[..._0x42c31b[_0x448add(0x185)][_0x448add(0xe4)]],_0x23b145=[..._0x42c31b[_0x448add(0x185)]['level']],_0x226273=[..._0x42c31b[_0x448add(0x185)][_0x448add(0xd5)]],_0x3af8e8=[..._0x42c31b['body'][_0x448add(0x16f)]],_0x740397=[..._0x42c31b[_0x448add(0x185)][_0x448add(0xee)]],_0x461645=[..._0x42c31b[_0x448add(0x185)][_0x448add(0x176)]],_0x34be74=[..._0x42c31b[_0x448add(0x185)]['prod_code']],_0x310b1f=[..._0x42c31b[_0x448add(0x185)][_0x448add(0x14b)]],_0x296a02=[..._0x42c31b['body'][_0x448add(0xd0)]],_0x48dfab=[..._0x42c31b[_0x448add(0x185)][_0x448add(0xda)]],_0x2fc7c8=[..._0x42c31b['body'][_0x448add(0x10c)]];const _0x1deb08=_0x2abae9[_0x448add(0x172)](_0x13fdf5=>{return _0x13fdf5={'product_name':_0x13fdf5};});_0x23b145['forEach']((_0x331f87,_0x153a9b)=>{var _0x25b3d3=_0x448add;_0x1deb08[_0x153a9b][_0x25b3d3(0xf8)]=_0x331f87;}),_0x226273[_0x448add(0x105)]((_0x265c2e,_0x3dd71e)=>{var _0x4812c9=_0x448add;_0x1deb08[_0x3dd71e][_0x4812c9(0xc9)]=_0x265c2e;}),_0x3af8e8[_0x448add(0x105)]((_0xd9df44,_0x3fab73)=>{_0x1deb08[_0x3fab73]['types']=_0xd9df44;}),_0x740397[_0x448add(0x105)]((_0x8a8270,_0x2b4d8b)=>{var _0x26ed71=_0x448add;_0x1deb08[_0x2b4d8b][_0x26ed71(0xee)]=_0x8a8270;}),_0x461645[_0x448add(0x105)]((_0x428945,_0x34f96a)=>{_0x1deb08[_0x34f96a]['new_adjust_qty']=_0x428945;}),_0x310b1f[_0x448add(0x105)]((_0x1bcd9d,_0xfc8344)=>{var _0x556f68=_0x448add;_0x1deb08[_0xfc8344][_0x556f68(0x14b)]=_0x1bcd9d;}),_0x296a02[_0x448add(0x105)]((_0x46270c,_0x27b1af)=>{var _0x4f01fd=_0x448add;_0x1deb08[_0x27b1af][_0x4f01fd(0x165)]=_0x46270c;}),_0x34be74[_0x448add(0x105)]((_0x561bc8,_0x523736)=>{var _0x16e289=_0x448add;_0x1deb08[_0x523736][_0x16e289(0x15a)]=_0x561bc8;}),_0x48dfab['forEach']((_0x376273,_0xeb3a5)=>{var _0x210605=_0x448add;_0x1deb08[_0xeb3a5][_0x210605(0xda)]=_0x376273;}),_0x2fc7c8[_0x448add(0x105)]((_0x2e60f2,_0x44b045)=>{var _0x4bb52d=_0x448add;_0x1deb08[_0x44b045][_0x4bb52d(0x10c)]=_0x2e60f2;});const _0x9abbd2=_0x1deb08[_0x448add(0x179)](_0x5e314b=>_0x5e314b[_0x448add(0xee)]!=='0'&&_0x5e314b[_0x448add(0xee)]!=='');var _0x2a2ab4=0x0;_0x9abbd2[_0x448add(0x105)](_0x2eb160=>{var _0x24720a=_0x448add;console['log'](_0x24720a(0xec),_0x2eb160),parseInt(_0x2eb160[_0x24720a(0xee)])<=0x0&&_0x2a2ab4++;});if(_0x2a2ab4!=0x0)return _0x42c31b[_0x448add(0x17e)]('errors',_0x448add(0xcc)),_0x21b61a[_0x448add(0xf5)](_0x448add(0x13e));_0x3e3994[_0x448add(0x161)]=_0x4780fd,_0x3e3994[_0x448add(0x12d)]=_0xc1da59,_0x3e3994[_0x448add(0x117)]=_0x9abbd2,_0x3e3994[_0x448add(0x189)]=_0x39f4ea,_0x3e3994[_0x448add(0x114)]=_0x517e74,_0x3e3994[_0x448add(0x133)]=_0x462c38,_0x3e3994[_0x448add(0xdd)]=_0x4d5bef;const _0x34c813=await _0x3e3994[_0x448add(0x14d)](),_0x3b4c25=await warehouse['findOne']({'name':_0x4780fd,'room':_0x517e74});_0x34c813['product'][_0x448add(0x105)](_0x41470c=>{var _0x3701dc=_0x448add;const _0x328419=_0x3b4c25['product_details'][_0x3701dc(0x172)](_0xb5ae45=>{var _0x45a739=_0x3701dc;_0x41470c[_0x45a739(0x16f)]==_0x45a739(0x13a)?_0xb5ae45[_0x45a739(0x11a)]==_0x41470c[_0x45a739(0x11a)]&&_0xb5ae45[_0x45a739(0xf8)]==_0x41470c[_0x45a739(0xf8)]&&(_0xb5ae45['product_stock']=parseInt(_0xb5ae45['product_stock'])-parseInt(_0x41470c[_0x45a739(0xee)])):_0xb5ae45[_0x45a739(0x11a)]==_0x41470c[_0x45a739(0x11a)]&&_0xb5ae45[_0x45a739(0xf8)]==_0x41470c[_0x45a739(0xf8)]&&(_0xb5ae45[_0x45a739(0x147)]=parseInt(_0xb5ae45[_0x45a739(0x147)])+parseInt(_0x41470c[_0x45a739(0xee)]));});}),await _0x3b4c25[_0x448add(0x14d)](),_0x42c31b[_0x448add(0x17e)](_0x448add(0xc7),_0x448add(0x125)),_0x21b61a[_0x448add(0xf5)]('/adjustment_finished/view');}catch(_0x1a3cc2){console[_0x448add(0x181)](_0x1a3cc2);}}),router[a0_0x53a67d(0x182)](a0_0x53a67d(0x159),async(_0x423d3c,_0x31fb12)=>{var _0x595199=a0_0x53a67d;const {primary_code:_0x5e0105,warehouse_data:_0x33944e,rooms_data:_0x140f50,Roomslist:_0x50f7ff}=_0x423d3c[_0x595199(0x185)],_0x87fa1a=_0x50f7ff[_0x595199(0x14a)](','),_0x2d8d6c=[];async function _0x59b7d0(_0x41559d){var _0x42f625=_0x595199;const _0x12fb9a=await warehouse[_0x42f625(0x15e)]([{'$match':{'name':_0x33944e,'room':_0x41559d}},{'$unwind':_0x42f625(0xf4)},{'$match':{'product_details.primary_code':_0x5e0105}},{'$group':{'_id':_0x42f625(0xfa),'name':{'$first':_0x42f625(0x184)},'product_stock':{'$first':_0x42f625(0x122)},'primary_code':{'$first':_0x42f625(0x15b)},'secondary_code':{'$first':_0x42f625(0x120)},'product_code':{'$first':_0x42f625(0x178)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x42f625(0x142)},'type':{'$first':_0x42f625(0xfb)},'pallet':{'$first':_0x42f625(0x12f)},'unit':{'$first':_0x42f625(0xd8)},'secondary_unit':{'$first':_0x42f625(0x149)},'storage':{'$first':_0x42f625(0x104)},'rack':{'$first':_0x42f625(0x140)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x42f625(0x158)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x42f625(0x15c)},'roomNamed':{'$first':_0x42f625(0xfe)},'invoice':{'$first':_0x42f625(0x135)}}}]),_0x378ff0=await warehouse['aggregate']([{'$match':{'name':_0x33944e,'room':_0x41559d}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x5e0105}},{'$group':{'_id':_0x42f625(0xfa),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x42f625(0x122)},'primary_code':{'$first':_0x42f625(0x15b)},'secondary_code':{'$first':_0x42f625(0x120)},'product_code':{'$first':_0x42f625(0x178)},'level':{'$first':_0x42f625(0x103)},'isle':{'$first':_0x42f625(0x142)},'type':{'$first':_0x42f625(0xfb)},'pallet':{'$first':_0x42f625(0x12f)},'unit':{'$first':_0x42f625(0xd8)},'secondary_unit':{'$first':_0x42f625(0x149)},'storage':{'$first':_0x42f625(0x104)},'rack':{'$first':_0x42f625(0x140)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x42f625(0x158)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x42f625(0x15c)},'roomNamed':{'$first':_0x42f625(0xfe)},'invoice':{'$first':_0x42f625(0x135)}}}]);if(_0x12fb9a[_0x42f625(0x154)]>0x0)_0x2d8d6c[_0x42f625(0x155)](_0x12fb9a);else _0x378ff0[_0x42f625(0x154)]>0x0&&_0x2d8d6c[_0x42f625(0x155)](_0x378ff0);}const _0x204492=_0x87fa1a[_0x595199(0x172)](_0x1f05c6=>_0x59b7d0(_0x1f05c6));await Promise[_0x595199(0xca)](_0x204492),_0x31fb12['json'](_0x2d8d6c);}),router['post'](a0_0x53a67d(0x177),async(_0x2d6067,_0x2cc57e)=>{var _0x5267cf=a0_0x53a67d;const {productCode:_0x51a81b,bay:_0x3d8d03,warehouses:_0x493905,room:_0x46dd32}=_0x2d6067['body'];console[_0x5267cf(0x181)](_0x2d6067[_0x5267cf(0x185)]);try{const _0x434bb0=await warehouse[_0x5267cf(0x15e)]([{'$match':{'name':_0x493905,'room':_0x46dd32}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x3d8d03)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5267cf(0x184)},'product_stock':{'$first':_0x5267cf(0x122)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2cc57e['status'](0xc8)['json'](_0x434bb0);}catch(_0x3e6eff){_0x2cc57e[_0x5267cf(0x152)](0x194)['json']({'message':_0x3e6eff[_0x5267cf(0x18a)]});}}),module[a0_0x53a67d(0x17a)]=router;