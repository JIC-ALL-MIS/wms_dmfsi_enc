function a0_0xc74a(_0x3bc0c0,_0x5bc45d){var _0x497d37=a0_0x497d();return a0_0xc74a=function(_0xc74af6,_0x101e12){_0xc74af6=_0xc74af6-0x76;var _0x17b047=_0x497d37[_0xc74af6];return _0x17b047;},a0_0xc74a(_0x3bc0c0,_0x5bc45d);}var a0_0x5964d5=a0_0xc74a;(function(_0x128bab,_0x868a06){var _0x42b10b=a0_0xc74a,_0x46e15b=_0x128bab();while(!![]){try{var _0x5e0aa6=parseInt(_0x42b10b(0x77))/0x1*(-parseInt(_0x42b10b(0x111))/0x2)+-parseInt(_0x42b10b(0xb4))/0x3+-parseInt(_0x42b10b(0x13f))/0x4*(-parseInt(_0x42b10b(0x9c))/0x5)+parseInt(_0x42b10b(0x136))/0x6*(-parseInt(_0x42b10b(0x102))/0x7)+parseInt(_0x42b10b(0x12b))/0x8*(-parseInt(_0x42b10b(0x9d))/0x9)+-parseInt(_0x42b10b(0x125))/0xa*(parseInt(_0x42b10b(0xdc))/0xb)+parseInt(_0x42b10b(0x8e))/0xc*(parseInt(_0x42b10b(0x78))/0xd);if(_0x5e0aa6===_0x868a06)break;else _0x46e15b['push'](_0x46e15b['shift']());}catch(_0x1f98b0){_0x46e15b['push'](_0x46e15b['shift']());}}}(a0_0x497d,0xe1597));function a0_0x497d(){var _0x2321c3=['English','express','prod_invoice','adjustment\x20data\x20update\x20successfully','French','$_id','\x20</h2>','_id','388oxdyxt','FGSEmail','965279QsDZhh','13OKgQrX','unit','product_code','Arabic','adjust_qty','<html><head><title></title>','string','redirect','$product_details.unit','types','all','stockBefore','adjustment\x20add\x20successfull','/picking_list/PDF_adjustment/','prod_name','$product_details.secondary_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','English\x20(US)','/view','/preview/:id','$product_details.primary_code','Portuguese\x20(BR)','61046952auimEG','$product_details.product_stock','$product_details._id','Router','</table>','catch','</tr>','ADJF-','</h5>','/view/:id','logo','invoice','$product_details.maxProducts','$product_details.secondary_unit','26735nlXeLb','4491ZUrLWs','../models/all_models','Return\x20Rooms','params','Hindi','$product_details.rack','</tbody>','site_title','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/adjustment/view','Email\x20sent\x20successfully','/adjustment_finished/preview/','product_stock','password','product_date','purchases_data','get','Spanish','<h5>','filter','json','role','note','5535471CnfdDH','findOne','</head><body>','minus','warehouse_name','user','secondary_unit','product','German','An\x20error\x20occurred.','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$invoice','length','getMonth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','new_adjust_qty','finalize','nodemailer','Logo.png','Enclosed','error','$product_details.expiry_date','Portuguese','staff','createTransport','$product_details.batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','language','$product_details','<tbody\x20style=\x22text-align:\x20center;\x22>','host','findById','$product','find','stock','edit_adjustment_finished_view','push','floor','map','flash','11PILssF','$product_details.product_name','body','render','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','level','bay','aggregate','Rooms','<h2>\x20','$product_details.maxPerUnit','maxPerUnit','room_names','product_details','forEach','toString','post','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','../middleware/auth','\x20Order\x20Number\x20:\x20','log','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','email','Ambient','/view/add_adjustment','sendMail','success','slice','Adjustment\x20Finalize\x20Successfully','<span\x20style=\x22float:\x20right;\x22>','edit_adjustment_finished','$product_details.type','$product_details.bay','</div>','QA\x20Warehouse','\x20Order\x20Date\x20:\x20','foreach\x20newproduct','Adjustment\x20Mail','2604qGYsEW','$room','Arabic\x20(ae)','$product_details.storage','New_Qty_Converted','JO_number','New_Qty_Converted_adj','batch_code','$product_details.product_code','image','$product_details.production_date','$product_details.bin','expiry_date','then','prod_code','2ZqpOND','prod_cat','Enabled','$product.product_name','$product_details.floorlevel','$finalize','$name','warehouse','Chinese','back','exports','random','master','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','status','</td>','errors','<hr\x20class=\x22my-3\x22>','adjustment_finished','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','3328300SGmdAd','$warehouse_name','getDate','</thead>','date','Finished\x20Goods','8992bHqvCn','save','production_date','/adjustment_finished/view','room','An\x20error\x20occurred\x20while\x20saving\x20data.','Secondary_units','<div>','/barcode_scanner','product_name','message','15786AnwhTy'];a0_0x497d=function(){return _0x2321c3;};return a0_0x497d();}const express=require(a0_0x5964d5(0x138)),app=express(),router=express[a0_0x5964d5(0x91)](),auth=require(a0_0x5964d5(0xee)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x5964d5(0x9e)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x5964d5(0xc5));router[a0_0x5964d5(0xad)](a0_0x5964d5(0x8a),auth,async(_0x42eeba,_0x340006)=>{var _0x1f284f=a0_0x5964d5;try{const {username:_0x17b499,email:_0x29e172,role:_0x2006ac}=_0x42eeba[_0x1f284f(0xb9)],_0x22e119=_0x42eeba[_0x1f284f(0xb9)],_0x5ee0f1=await profile[_0x1f284f(0xb5)]({'email':_0x22e119[_0x1f284f(0xf2)]}),_0x162e54=await master_shop[_0x1f284f(0xd5)]();let _0x206ced;if(_0x22e119['role']==_0x1f284f(0xcb)){const _0x261bcb=await staff['findOne']({'email':_0x22e119[_0x1f284f(0xf2)]});_0x206ced=await warehouse['find']({'status':_0x1f284f(0x113),'name':_0x261bcb[_0x1f284f(0x118)]});}else _0x206ced=await warehouse[_0x1f284f(0xd5)]({'status':_0x1f284f(0x113)});const _0x2a73aa=await product[_0x1f284f(0xd5)]();let _0x1a9be2;if(_0x22e119[_0x1f284f(0xb2)]=='staff'){const _0x324092=await staff[_0x1f284f(0xb5)]({'email':_0x22e119[_0x1f284f(0xf2)]});_0x1a9be2=await adjustment_finished['find']({'warehouse_name':_0x324092[_0x1f284f(0x118)]});}else _0x1a9be2=await adjustment_finished[_0x1f284f(0xe3)]([{'$unwind':_0x1f284f(0xd4)},{'$group':{'_id':_0x1f284f(0x13c),'invoice':{'$first':_0x1f284f(0xbf)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x1f284f(0x126)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x1f284f(0x116)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x162e54[0x0][_0x1f284f(0xcf)]==_0x1f284f(0x89)){var _0x55ec32=users[_0x1f284f(0x137)];console[_0x1f284f(0xf0)](_0x55ec32);}else{if(_0x162e54[0x0][_0x1f284f(0xcf)]==_0x1f284f(0xa1))var _0x55ec32=users[_0x1f284f(0xa1)];else{if(_0x162e54[0x0][_0x1f284f(0xcf)]==_0x1f284f(0xbc))var _0x55ec32=users[_0x1f284f(0xbc)];else{if(_0x162e54[0x0][_0x1f284f(0xcf)]==_0x1f284f(0xae))var _0x55ec32=users[_0x1f284f(0xae)];else{if(_0x162e54[0x0][_0x1f284f(0xcf)]=='French')var _0x55ec32=users[_0x1f284f(0x13b)];else{if(_0x162e54[0x0][_0x1f284f(0xcf)]==_0x1f284f(0x8d))var _0x55ec32=users[_0x1f284f(0xca)];else{if(_0x162e54[0x0][_0x1f284f(0xcf)]=='Chinese')var _0x55ec32=users[_0x1f284f(0x119)];else{if(_0x162e54[0x0]['language']=='Arabic\x20(ae)')var _0x55ec32=users['Arabic'];}}}}}}}_0x340006[_0x1f284f(0xdf)](_0x1f284f(0x123),{'success':_0x42eeba['flash'](_0x1f284f(0xf6)),'errors':_0x42eeba['flash']('errors'),'role':_0x22e119,'profile':_0x5ee0f1,'warehouse':_0x206ced,'product':_0x2a73aa,'adjustment':_0x1a9be2,'master_shop':_0x162e54,'language':_0x55ec32});}catch(_0x398dd1){console[_0x1f284f(0xf0)](_0x398dd1);}});async function getRandom8DigitNumber(){var _0x20fb7b=a0_0x5964d5;const _0x5a8a3f=0x989680,_0x5316e0=0x5f5e0ff,_0xa3e211=Math[_0x20fb7b(0xd9)](Math[_0x20fb7b(0x11c)]()*(_0x5316e0-_0x5a8a3f+0x1))+_0x5a8a3f;var _0x394944;const _0x2f34d8=await adjustment_finished[_0x20fb7b(0xb5)]({'invoice':_0x20fb7b(0x95)+_0xa3e211});return _0x2f34d8&&_0x2f34d8['length']>0x0?_0x394944='ADJF-'+_0xa3e211:_0x394944=_0x20fb7b(0x95)+_0xa3e211,_0x394944;}router['get'](a0_0x5964d5(0xf4),auth,async(_0x2e19f5,_0x21f05f)=>{var _0x1b68b9=a0_0x5964d5;try{const {username:_0x28e842,email:_0x52d157,role:_0x541cb9}=_0x2e19f5['user'],_0x6228cc=_0x2e19f5['user'],_0x4e5ccc=await profile[_0x1b68b9(0xb5)]({'email':_0x6228cc[_0x1b68b9(0xf2)]}),_0x50db8c=await master_shop['find']();let _0x30ef76;if(_0x6228cc['role']==_0x1b68b9(0xcb)){const _0x4edecc=await staff[_0x1b68b9(0xb5)]({'email':_0x6228cc[_0x1b68b9(0xf2)]});_0x30ef76=await warehouse[_0x1b68b9(0xe3)]([{'$match':{'status':'Enabled','name':_0x4edecc[_0x1b68b9(0x118)],'warehouse_category':_0x1b68b9(0x12a),'name':{'$ne':_0x1b68b9(0xfe)}}},{'$group':{'_id':_0x1b68b9(0x117),'name':{'$first':'$name'}}}]);}else _0x30ef76=await warehouse[_0x1b68b9(0xe3)]([{'$match':{'status':_0x1b68b9(0x113),'warehouse_category':_0x1b68b9(0x12a),'name':{'$ne':_0x1b68b9(0xfe)}}},{'$group':{'_id':_0x1b68b9(0x117),'name':{'$first':_0x1b68b9(0x117)}}}]);const _0x545520=await product[_0x1b68b9(0xd5)]({}),_0x34e65f=await adjustment_finished[_0x1b68b9(0xd5)]({}),_0x53dd4f=_0x34e65f['length']+0x1,_0x5c08ae='ADJF-'+_0x53dd4f[_0x1b68b9(0xeb)]()['padStart'](0x5,'0');var _0x216f6f=['Ambient',_0x1b68b9(0xc7),_0x1b68b9(0x9f)];if(_0x50db8c[0x0][_0x1b68b9(0xcf)]==_0x1b68b9(0x89))var _0x200631=users[_0x1b68b9(0x137)];else{if(_0x50db8c[0x0][_0x1b68b9(0xcf)]==_0x1b68b9(0xa1))var _0x200631=users[_0x1b68b9(0xa1)];else{if(_0x50db8c[0x0][_0x1b68b9(0xcf)]=='German')var _0x200631=users[_0x1b68b9(0xbc)];else{if(_0x50db8c[0x0][_0x1b68b9(0xcf)]==_0x1b68b9(0xae))var _0x200631=users['Spanish'];else{if(_0x50db8c[0x0][_0x1b68b9(0xcf)]==_0x1b68b9(0x13b))var _0x200631=users[_0x1b68b9(0x13b)];else{if(_0x50db8c[0x0][_0x1b68b9(0xcf)]=='Portuguese\x20(BR)')var _0x200631=users[_0x1b68b9(0xca)];else{if(_0x50db8c[0x0][_0x1b68b9(0xcf)]=='Chinese')var _0x200631=users[_0x1b68b9(0x119)];else{if(_0x50db8c[0x0][_0x1b68b9(0xcf)]==_0x1b68b9(0x104))var _0x200631=users[_0x1b68b9(0x7b)];}}}}}}}const _0x2f63b7=getRandom8DigitNumber();_0x2f63b7[_0x1b68b9(0x10f)](_0x11aa15=>{var _0x184499=_0x1b68b9;_0x21f05f[_0x184499(0xdf)]('add_adjustment_finished',{'success':_0x2e19f5[_0x184499(0xdb)]('success'),'errors':_0x2e19f5[_0x184499(0xdb)](_0x184499(0x121)),'role':_0x6228cc,'profile':_0x4e5ccc,'warehouse':_0x30ef76,'product':_0x545520,'master_shop':_0x50db8c,'language':_0x200631,'rooms_data':_0x216f6f,'invoice_no':_0x11aa15});})[_0x1b68b9(0x93)](_0x599021=>{var _0x195fcd=_0x1b68b9;_0x2e19f5[_0x195fcd(0xdb)](_0x195fcd(0x121),_0x195fcd(0xbe)),_0x21f05f[_0x195fcd(0x7f)](_0x195fcd(0xa6));});}catch(_0xd5f178){console[_0x1b68b9(0xf0)](_0xd5f178);}}),router['post']('/view/add_adjustment',auth,async(_0x400bba,_0x331ac9)=>{var _0xc0afee=a0_0x5964d5;try{const {warehouse_name:_0x31b119,date:_0x58235c,prod_name:_0x4a4270,level:_0x422e47,isle:_0x4bc4b0,pallet:_0x16fcb2,stock:_0xde144d,types:_0xe9c01f,adjust_qty:_0x4e9ed5,new_adjust_qty:_0x324574,note:_0x542eee,Room_name:_0x4ebe34,invoice:_0x15053c,JO_number:_0x5718b2,expiry_date:_0x40f2f9}=_0x400bba[_0xc0afee(0xde)];if(typeof _0x4a4270==_0xc0afee(0x7e))var _0x664410=[_0x400bba['body'][_0xc0afee(0x86)]],_0x45ebf2=[_0x400bba[_0xc0afee(0xde)][_0xc0afee(0xe1)]],_0x351f2b=[_0x400bba['body']['stock']],_0x261e28=[_0x400bba[_0xc0afee(0xde)][_0xc0afee(0x81)]],_0x44b74e=[_0x400bba[_0xc0afee(0xde)]['New_Qty_Converted_adj']],_0x56e792=[_0x400bba['body'][_0xc0afee(0x106)]],_0x1d8430=[_0x400bba[_0xc0afee(0xde)]['Primary_Units']],_0x261818=[_0x400bba[_0xc0afee(0xde)]['Secondary_units']],_0x3722ce=[_0x400bba[_0xc0afee(0xde)][_0xc0afee(0x110)]],_0x5e7a86=[_0x400bba[_0xc0afee(0xde)][_0xc0afee(0x109)]],_0x5bacf1=[_0x400bba['body']['expiry_date']],_0x1e66b8=[_0x400bba[_0xc0afee(0xde)][_0xc0afee(0xab)]],_0x44f43a=[_0x400bba[_0xc0afee(0xde)][_0xc0afee(0x112)]],_0x546da1=[_0x400bba[_0xc0afee(0xde)]['Rooms']],_0x35157d=[_0x400bba[_0xc0afee(0xde)]['maxPerUnit']],_0x1e94bf=[_0x400bba[_0xc0afee(0xde)]['prod_invoice']];else var _0x664410=[..._0x400bba[_0xc0afee(0xde)][_0xc0afee(0x86)]],_0x45ebf2=[..._0x400bba[_0xc0afee(0xde)][_0xc0afee(0xe1)]],_0x351f2b=[..._0x400bba['body'][_0xc0afee(0xd6)]],_0x261e28=[..._0x400bba[_0xc0afee(0xde)]['types']],_0x44b74e=[..._0x400bba[_0xc0afee(0xde)][_0xc0afee(0x108)]],_0x56e792=[..._0x400bba[_0xc0afee(0xde)]['New_Qty_Converted']],_0x1d8430=[..._0x400bba[_0xc0afee(0xde)]['Primary_Units']],_0x261818=[..._0x400bba[_0xc0afee(0xde)]['Secondary_units']],_0x3722ce=[..._0x400bba[_0xc0afee(0xde)][_0xc0afee(0x110)]],_0x5e7a86=[..._0x400bba[_0xc0afee(0xde)][_0xc0afee(0x109)]],_0x5bacf1=[..._0x400bba[_0xc0afee(0xde)][_0xc0afee(0x10e)]],_0x1e66b8=[..._0x400bba['body']['product_date']],_0x44f43a=[..._0x400bba[_0xc0afee(0xde)]['prod_cat']],_0x546da1=[..._0x400bba['body'][_0xc0afee(0xe4)]],_0x35157d=[..._0x400bba[_0xc0afee(0xde)][_0xc0afee(0xe7)]],_0x1e94bf=[..._0x400bba[_0xc0afee(0xde)][_0xc0afee(0x139)]];const _0x3b6a63=_0x664410[_0xc0afee(0xda)](_0xa1b0de=>{return _0xa1b0de={'product_name':_0xa1b0de};});_0x45ebf2[_0xc0afee(0xea)]((_0x3ffb9a,_0x59878f)=>{var _0x415f6f=_0xc0afee;_0x3b6a63[_0x59878f][_0x415f6f(0xe2)]=_0x3ffb9a;}),_0x351f2b[_0xc0afee(0xea)]((_0x34947a,_0x5bbc73)=>{var _0x576e18=_0xc0afee;_0x3b6a63[_0x5bbc73][_0x576e18(0x83)]=_0x34947a;}),_0x261e28[_0xc0afee(0xea)]((_0x572eac,_0x5529b1)=>{var _0x5e1f7f=_0xc0afee;_0x3b6a63[_0x5529b1][_0x5e1f7f(0x81)]=_0x572eac;}),_0x44b74e['forEach']((_0x45acf4,_0x274325)=>{_0x3b6a63[_0x274325]['adjust_qty']=_0x45acf4;}),_0x56e792[_0xc0afee(0xea)]((_0x6bc37,_0x487d21)=>{var _0x215e53=_0xc0afee;_0x3b6a63[_0x487d21][_0x215e53(0xc3)]=_0x6bc37;}),_0x1d8430[_0xc0afee(0xea)]((_0x533e1c,_0x3dd442)=>{var _0x3f8fdb=_0xc0afee;_0x3b6a63[_0x3dd442][_0x3f8fdb(0x79)]=_0x533e1c;}),_0x261818['forEach']((_0x3e75eb,_0x27576b)=>{var _0x494fb6=_0xc0afee;_0x3b6a63[_0x27576b][_0x494fb6(0xba)]=_0x3e75eb;}),_0x3722ce[_0xc0afee(0xea)]((_0x4fbf0d,_0x562bc7)=>{_0x3b6a63[_0x562bc7]['product_code']=_0x4fbf0d;}),_0x5e7a86['forEach']((_0x217f93,_0x3a74a5)=>{var _0x589dae=_0xc0afee;_0x3b6a63[_0x3a74a5][_0x589dae(0x109)]=_0x217f93;}),_0x5bacf1[_0xc0afee(0xea)]((_0x15d1e0,_0x25cfa2)=>{var _0x583f1d=_0xc0afee;_0x3b6a63[_0x25cfa2][_0x583f1d(0x10e)]=_0x15d1e0;}),_0x1e66b8['forEach']((_0x1b43ad,_0x742600)=>{var _0x518c80=_0xc0afee;_0x3b6a63[_0x742600][_0x518c80(0x12d)]=_0x1b43ad;}),_0x44f43a[_0xc0afee(0xea)]((_0x33089f,_0xac5c85)=>{_0x3b6a63[_0xac5c85]['prod_cat']=_0x33089f;}),_0x546da1[_0xc0afee(0xea)]((_0x70a3ab,_0x4862a0)=>{var _0x991fe4=_0xc0afee;_0x3b6a63[_0x4862a0][_0x991fe4(0xe8)]=_0x70a3ab;}),_0x35157d['forEach']((_0x50cf77,_0x537d58)=>{_0x3b6a63[_0x537d58]['maxPerUnit']=_0x50cf77;}),_0x1e94bf[_0xc0afee(0xea)]((_0x377cfd,_0x5154bf)=>{var _0x198759=_0xc0afee;_0x3b6a63[_0x5154bf][_0x198759(0x99)]=_0x377cfd;});const _0x20981d=_0x3b6a63[_0xc0afee(0xb0)](_0x426c69=>_0x426c69[_0xc0afee(0x7c)]!=='0'&&_0x426c69['adjust_qty']!=='');var _0x451da6=0x0;_0x20981d[_0xc0afee(0xea)](_0x4a5144=>{var _0x398d37=_0xc0afee;console[_0x398d37(0xf0)]('foreach\x20newproduct',_0x4a5144),parseInt(_0x4a5144['adjust_qty'])<=0x0&&_0x451da6++;});if(_0x451da6!=0x0)return _0x400bba[_0xc0afee(0xdb)](_0xc0afee(0x121),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x331ac9[_0xc0afee(0x7f)](_0xc0afee(0x11a));const _0x53dbc4=new adjustment_finished({'warehouse_name':_0x31b119,'date':_0x58235c,'product':_0x20981d,'note':_0x542eee,'room':_0x4ebe34,'invoice':_0x15053c,'JO_number':_0x5718b2,'expiry_date':_0x40f2f9}),_0x5c1a57=await _0x53dbc4[_0xc0afee(0x12c)]();_0x400bba['flash'](_0xc0afee(0xf6),_0xc0afee(0x84)),_0x331ac9[_0xc0afee(0x7f)](_0xc0afee(0xa8)+_0x5c1a57[_0xc0afee(0x13e)]);}catch(_0x120f6a){console[_0xc0afee(0xf0)](_0x120f6a),_0x331ac9[_0xc0afee(0x11f)](0xc8)[_0xc0afee(0xb1)]({'message':_0x120f6a[_0xc0afee(0x135)]});}}),router[a0_0x5964d5(0xad)](a0_0x5964d5(0x8b),auth,async(_0x122bc8,_0x211302)=>{var _0x2c57f6=a0_0x5964d5;try{const {username:_0x3e4ac9,email:_0x572c66,role:_0x1be48c}=_0x122bc8['user'],_0x37c482=_0x122bc8[_0x2c57f6(0xb9)],_0x2ad72e=await profile[_0x2c57f6(0xb5)]({'email':_0x37c482['email']}),_0x9be4a0=await master_shop[_0x2c57f6(0xd5)](),_0x591509=_0x122bc8[_0x2c57f6(0xa0)]['id'],_0xc7b93a=await adjustment_finished[_0x2c57f6(0xd3)]({'_id':_0x591509}),_0x44225c=await purchases[_0x2c57f6(0xe3)]([{'$match':{'warehouse_name':_0xc7b93a[_0x2c57f6(0xb8)]}},{'$unwind':'$product'},{'$group':{'_id':_0x2c57f6(0x114)}}]);console[_0x2c57f6(0xf0)](_0x2c57f6(0xac),_0x44225c);const _0x5b34b2=await product['find']({}),_0x33215d=await warehouse[_0x2c57f6(0xe3)]([{'$match':{'name':_0xc7b93a[_0x2c57f6(0xb8)],'warehouse_category':_0x2c57f6(0x12a)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2c57f6(0x90),'name':{'$first':_0x2c57f6(0xdd)},'product_stock':{'$first':_0x2c57f6(0x8f)},'bay':{'$first':_0x2c57f6(0xfc)},'bin':{'$first':_0x2c57f6(0x10d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2c57f6(0x8c)},'secondary_code':{'$first':_0x2c57f6(0x87)},'product_code':{'$first':_0x2c57f6(0x10a)},'storage':{'$first':_0x2c57f6(0x105)},'rack':{'$first':_0x2c57f6(0xa2)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2c57f6(0x10c)},'batch_code':{'$first':_0x2c57f6(0xcd)},'maxPerUnit':{'$first':_0x2c57f6(0xe6)},'room':{'$first':_0x2c57f6(0x103)}}}]);if(_0x9be4a0[0x0][_0x2c57f6(0xcf)]==_0x2c57f6(0x89)){var _0x71ad1e=users[_0x2c57f6(0x137)];console[_0x2c57f6(0xf0)](_0x71ad1e);}else{if(_0x9be4a0[0x0][_0x2c57f6(0xcf)]=='Hindi')var _0x71ad1e=users['Hindi'];else{if(_0x9be4a0[0x0][_0x2c57f6(0xcf)]==_0x2c57f6(0xbc))var _0x71ad1e=users[_0x2c57f6(0xbc)];else{if(_0x9be4a0[0x0]['language']==_0x2c57f6(0xae))var _0x71ad1e=users[_0x2c57f6(0xae)];else{if(_0x9be4a0[0x0][_0x2c57f6(0xcf)]==_0x2c57f6(0x13b))var _0x71ad1e=users[_0x2c57f6(0x13b)];else{if(_0x9be4a0[0x0]['language']==_0x2c57f6(0x8d))var _0x71ad1e=users[_0x2c57f6(0xca)];else{if(_0x9be4a0[0x0][_0x2c57f6(0xcf)]=='Chinese')var _0x71ad1e=users[_0x2c57f6(0x119)];else{if(_0x9be4a0[0x0][_0x2c57f6(0xcf)]==_0x2c57f6(0x104))var _0x71ad1e=users[_0x2c57f6(0x7b)];}}}}}}}_0x211302[_0x2c57f6(0xdf)](_0x2c57f6(0xd7),{'success':_0x122bc8[_0x2c57f6(0xdb)](_0x2c57f6(0xf6)),'errors':_0x122bc8['flash']('errors'),'role':_0x37c482,'profile':_0x2ad72e,'adjustment':_0xc7b93a,'stock':_0x33215d,'master_shop':_0x9be4a0,'warehouse_name':_0x44225c,'unit':_0x5b34b2,'language':_0x71ad1e});}catch(_0x398678){console[_0x2c57f6(0xf0)](_0x398678),_0x211302[_0x2c57f6(0x11f)](0xc8)[_0x2c57f6(0xb1)]({'message':_0x398678[_0x2c57f6(0x135)]});}}),router[a0_0x5964d5(0xec)](a0_0x5964d5(0x8b),auth,async(_0x29ee51,_0x10c457)=>{var _0x2418fe=a0_0x5964d5;try{const {invoice:_0x4bfd1e,warehouse_name:_0x1d2def,Room_name:_0x22a640}=_0x29ee51[_0x2418fe(0xde)],_0x3428d4=_0x29ee51[_0x2418fe(0xa0)]['id'],_0xb6d0da=await adjustment_finished[_0x2418fe(0xd3)]({'_id':_0x3428d4});var _0x57a24a;const _0x1a4911=_0xb6d0da[_0x2418fe(0xbb)][_0x2418fe(0xda)](async _0x2b6cd9=>{var _0x250d55=_0x2418fe;if(_0x2b6cd9[_0x250d55(0x7c)]>0x0){_0x57a24a=await warehouse[_0x250d55(0xb5)]({'name':_0x1d2def,'room':_0x2b6cd9['room_names'],'warehouse_category':_0x250d55(0x12a)});const _0x1fb2cd=_0x57a24a[_0x250d55(0xe9)][_0x250d55(0xda)](_0x3cee6a=>{var _0x45e725=_0x250d55;console['log'](_0x2b6cd9[_0x45e725(0x81)]);if(_0x2b6cd9[_0x45e725(0x81)]==_0x45e725(0xb7))_0x3cee6a[_0x45e725(0x134)]==_0x2b6cd9[_0x45e725(0x134)]&&_0x3cee6a[_0x45e725(0xe2)]==_0x2b6cd9[_0x45e725(0xe2)]&&_0x3cee6a[_0x45e725(0x10e)]==_0x2b6cd9['expiry_date']&&_0x3cee6a['production_date']==_0x2b6cd9[_0x45e725(0x12d)]&&_0x3cee6a[_0x45e725(0x109)]==_0x2b6cd9[_0x45e725(0x109)]&&_0x3cee6a[_0x45e725(0x99)]==_0x2b6cd9['invoice']&&(_0x3cee6a[_0x45e725(0xa9)]=_0x3cee6a[_0x45e725(0xa9)]-_0x2b6cd9[_0x45e725(0x7c)]);else _0x2b6cd9[_0x45e725(0x81)]=='add'&&(_0x3cee6a[_0x45e725(0x134)]==_0x2b6cd9[_0x45e725(0x134)]&&_0x3cee6a[_0x45e725(0xe2)]==_0x2b6cd9['bay']&&_0x3cee6a[_0x45e725(0x10e)]==_0x2b6cd9[_0x45e725(0x10e)]&&_0x3cee6a[_0x45e725(0x12d)]==_0x2b6cd9[_0x45e725(0x12d)]&&_0x3cee6a[_0x45e725(0x109)]==_0x2b6cd9['batch_code']&&_0x3cee6a[_0x45e725(0x99)]==_0x2b6cd9['invoice']&&(_0x3cee6a[_0x45e725(0xa9)]=_0x3cee6a[_0x45e725(0xa9)]+_0x2b6cd9[_0x45e725(0x7c)]));});}return _0x57a24a;});Promise[_0x2418fe(0x82)](_0x1a4911)[_0x2418fe(0x10f)](async _0x4f2e6d=>{var _0x18d7ec=_0x2418fe;try{for(const _0x5effcb of _0x4f2e6d){await _0x5effcb[_0x18d7ec(0x12c)]();}_0xb6d0da[_0x18d7ec(0xc4)]='True';const _0x446192=await _0xb6d0da[_0x18d7ec(0x12c)](),_0x1098b4=await master_shop['find'](),_0x56f134=await email_settings[_0x18d7ec(0xb5)](),_0x597f00=await supervisor_settings[_0x18d7ec(0xd5)]();var _0x34a787=_0xb6d0da['product'],_0x3626ee='',_0x305a29;for(_0x305a29 in _0x34a787){var _0x5a78e0='FG';_0xb6d0da['warehouse_name']=='DRY\x20GOODS'&&(_0x5a78e0='DG'),_0x3626ee+='<tr>'+_0x18d7ec(0x88)+_0x34a787[_0x305a29][_0x18d7ec(0x134)]+'</td>'+_0x18d7ec(0x88)+_0x34a787[_0x305a29]['product_code']+'</td>'+_0x18d7ec(0x88)+_0x34a787[_0x305a29]['adjust_qty']+_0x18d7ec(0x120)+_0x18d7ec(0x88)+_0x34a787[_0x305a29][_0x18d7ec(0x79)]+_0x18d7ec(0x120)+_0x18d7ec(0x88)+_0x34a787[_0x305a29][_0x18d7ec(0xba)]+_0x18d7ec(0x120)+_0x18d7ec(0x88)+_0xb6d0da[_0x18d7ec(0xb8)]+_0x18d7ec(0x120)+_0x18d7ec(0x88)+_0x34a787[_0x305a29][_0x18d7ec(0xe8)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5a78e0+_0x34a787[_0x305a29][_0x18d7ec(0xe2)]+_0x18d7ec(0x120)+_0x18d7ec(0x94);}let _0x5be043=nodemailer[_0x18d7ec(0xcc)]({'host':_0x56f134[_0x18d7ec(0xd2)],'port':Number(_0x56f134['port']),'secure':![],'auth':{'user':_0x56f134[_0x18d7ec(0xf2)],'pass':_0x56f134[_0x18d7ec(0xaa)]}}),_0x2f5e84={'from':_0x56f134[_0x18d7ec(0xf2)],'to':_0x597f00[0x0][_0x18d7ec(0x76)],'subject':_0x18d7ec(0x101),'attachments':[{'filename':_0x18d7ec(0xc6),'path':__dirname+'/../public'+'/upload/'+_0x1098b4[0x0][_0x18d7ec(0x10b)],'cid':_0x18d7ec(0x98)}],'html':'<!DOCTYPE\x20html>'+_0x18d7ec(0x7d)+_0x18d7ec(0xb6)+_0x18d7ec(0x132)+_0x18d7ec(0xa5)+'<div>'+_0x18d7ec(0x124)+'</div>'+_0x18d7ec(0x132)+_0x18d7ec(0xe5)+_0x1098b4[0x0][_0x18d7ec(0xa4)]+_0x18d7ec(0x13d)+_0x18d7ec(0xfd)+_0x18d7ec(0xfd)+_0x18d7ec(0x122)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x18d7ec(0xef)+_0xb6d0da[_0x18d7ec(0x99)]+'\x20'+_0x18d7ec(0xf9)+_0x18d7ec(0xff)+_0xb6d0da[_0x18d7ec(0x129)]+'\x20'+'</span>'+_0x18d7ec(0x96)+_0x18d7ec(0xfd)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x18d7ec(0xed)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x18d7ec(0x11e)+_0x18d7ec(0xc2)+_0x18d7ec(0xe0)+_0x18d7ec(0xce)+_0x18d7ec(0x94)+_0x18d7ec(0x128)+_0x18d7ec(0xd1)+'\x20'+_0x3626ee+'\x20'+_0x18d7ec(0xa3)+_0x18d7ec(0x92)+_0x18d7ec(0x132)+'<strong>\x20Regards\x20</strong>'+_0x18d7ec(0xaf)+_0x1098b4[0x0][_0x18d7ec(0xa4)]+_0x18d7ec(0x96)+_0x18d7ec(0xfd)+_0x18d7ec(0xfd)+'</body></html>'};_0x5be043[_0x18d7ec(0xf5)](_0x2f5e84,function(_0x440f50,_0x43a094){var _0x5ea107=_0x18d7ec;_0x440f50?(console[_0x5ea107(0xf0)](_0x440f50),console[_0x5ea107(0xf0)]('Error\x20Occurs')):console[_0x5ea107(0xf0)](_0x5ea107(0xa7));}),_0x29ee51[_0x18d7ec(0xdb)](_0x18d7ec(0xf6),_0x18d7ec(0xf8)),_0x10c457[_0x18d7ec(0x7f)](_0x18d7ec(0x85)+_0x446192['_id']);}catch(_0x2ed0fe){console[_0x18d7ec(0xc8)](_0x2ed0fe),_0x10c457[_0x18d7ec(0x11f)](0x1f4)[_0x18d7ec(0xb1)]({'error':_0x18d7ec(0x130)});}})[_0x2418fe(0x93)](_0x376752=>{var _0x526ed9=_0x2418fe;console['error'](_0x376752),_0x10c457[_0x526ed9(0x11f)](0x1f4)['json']({'error':_0x526ed9(0xbd)});});}catch(_0x4c2399){_0x10c457[_0x2418fe(0xb1)]({'message':_0x4c2399[_0x2418fe(0x135)]});}}),router[a0_0x5964d5(0xad)](a0_0x5964d5(0x97),auth,async(_0x8c6712,_0x3f1c6c)=>{var _0x33f923=a0_0x5964d5;try{const {username:_0x4bd239,email:_0x39e516,role:_0x358664}=_0x8c6712[_0x33f923(0xb9)],_0x283520=_0x8c6712[_0x33f923(0xb9)],_0x39fa0a=await profile[_0x33f923(0xb5)]({'email':_0x283520['email']}),_0x52161e=await master_shop[_0x33f923(0xd5)]();console[_0x33f923(0xf0)](_0x33f923(0x11d),_0x52161e);const _0x2f2fd1=_0x8c6712[_0x33f923(0xa0)]['id'],_0x208f26=await adjustment_finished[_0x33f923(0xd3)]({'_id':_0x2f2fd1});let _0x5140ca=new Date(_0x208f26[_0x33f923(0x10e)]),_0x5424c3=('0'+_0x5140ca[_0x33f923(0x127)]())[_0x33f923(0xf7)](-0x2),_0x2ece21=('0'+(_0x5140ca[_0x33f923(0xc1)]()+0x1))[_0x33f923(0xf7)](-0x2),_0x3466d2=_0x5140ca['getFullYear'](),_0x3b8d87=_0x3466d2+'-'+_0x2ece21+'-'+_0x5424c3;var _0x11ac32=[_0x33f923(0xf3),'Enclosed','Return\x20Rooms'];const _0x405ed6=await purchases[_0x33f923(0xe3)]([{'$match':{'warehouse_name':_0x208f26[_0x33f923(0xb8)]}},{'$unwind':'$product'},{'$group':{'_id':_0x33f923(0x114)}}]);console[_0x33f923(0xf0)]('purchases_data',_0x405ed6);const _0x4b0eed=await product[_0x33f923(0xd5)]({}),_0x3c24ce=await warehouse[_0x33f923(0xe3)]([{'$match':{'name':_0x208f26[_0x33f923(0xb8)],'room':_0x208f26[_0x33f923(0x12f)]}},{'$unwind':_0x33f923(0xd0)},{'$group':{'_id':_0x33f923(0x90),'name':{'$first':_0x33f923(0xdd)},'product_stock':{'$first':_0x33f923(0x8f)},'bay':{'$first':_0x33f923(0xfc)},'bin':{'$first':_0x33f923(0x10d)},'type':{'$first':_0x33f923(0xfb)},'floorlevel':{'$first':_0x33f923(0x115)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x33f923(0x87)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x33f923(0xa2)}}}]);if(_0x52161e[0x0][_0x33f923(0xcf)]==_0x33f923(0x89)){var _0x480040=users[_0x33f923(0x137)];console[_0x33f923(0xf0)](_0x480040);}else{if(_0x52161e[0x0]['language']==_0x33f923(0xa1))var _0x480040=users[_0x33f923(0xa1)];else{if(_0x52161e[0x0][_0x33f923(0xcf)]==_0x33f923(0xbc))var _0x480040=users[_0x33f923(0xbc)];else{if(_0x52161e[0x0]['language']=='Spanish')var _0x480040=users[_0x33f923(0xae)];else{if(_0x52161e[0x0][_0x33f923(0xcf)]==_0x33f923(0x13b))var _0x480040=users[_0x33f923(0x13b)];else{if(_0x52161e[0x0]['language']==_0x33f923(0x8d))var _0x480040=users[_0x33f923(0xca)];else{if(_0x52161e[0x0][_0x33f923(0xcf)]==_0x33f923(0x119))var _0x480040=users['Chinese'];else{if(_0x52161e[0x0][_0x33f923(0xcf)]==_0x33f923(0x104))var _0x480040=users[_0x33f923(0x7b)];}}}}}}}_0x3f1c6c['render'](_0x33f923(0xfa),{'success':_0x8c6712[_0x33f923(0xdb)](_0x33f923(0xf6)),'errors':_0x8c6712['flash'](_0x33f923(0x121)),'role':_0x283520,'profile':_0x39fa0a,'adjustment':_0x208f26,'stock':_0x3c24ce,'master_shop':_0x52161e,'warehouse_name':_0x405ed6,'unit':_0x4b0eed,'language':_0x480040,'rooms_data':_0x11ac32,'ed_fullDate':_0x3b8d87});}catch(_0x57fa7b){console[_0x33f923(0xf0)](_0x57fa7b),_0x3f1c6c[_0x33f923(0x11f)](0xc8)[_0x33f923(0xb1)]({'message':_0x57fa7b[_0x33f923(0x135)]});}}),router[a0_0x5964d5(0xec)]('/view/:id',auth,async(_0x227437,_0x4e464d)=>{var _0x46d54c=a0_0x5964d5;try{const _0x5ea884=_0x227437[_0x46d54c(0xa0)]['id'],_0xb795af=await adjustment_finished[_0x46d54c(0xd3)]({'_id':_0x5ea884}),_0x2cbf06=await warehouse[_0x46d54c(0xb5)]({'name':_0xb795af[_0x46d54c(0xb8)],'room':_0xb795af['room']}),{warehouse_name:_0x1c0542,date:_0x1806c9,prod_name:_0x9b094f,level:_0x55b9e6,isle:_0x58299d,pallet:_0x50a00f,stock:_0x3ef944,types:_0x425ba4,adjust_qty:_0x1073e6,new_adjust_qty:_0x2cb031,note:_0x46a0b1,Room_name:_0x25f21a,invoice:_0x27da90,JO_number:_0x2296fe}=_0x227437[_0x46d54c(0xde)];if(typeof _0x9b094f=='string')var _0x334e55=[_0x227437[_0x46d54c(0xde)][_0x46d54c(0x86)]],_0x1ef625=[_0x227437[_0x46d54c(0xde)][_0x46d54c(0xe1)]],_0x56437b=[_0x227437['body']['stock']],_0x3e52e5=[_0x227437['body'][_0x46d54c(0x81)]],_0x66454b=[_0x227437[_0x46d54c(0xde)]['adjust_qty']],_0x157fad=[_0x227437[_0x46d54c(0xde)][_0x46d54c(0xc3)]],_0x62755c=[_0x227437[_0x46d54c(0xde)]['prod_code']],_0x6d681a=[_0x227437[_0x46d54c(0xde)]['unit']],_0x5c3a0b=[_0x227437[_0x46d54c(0xde)][_0x46d54c(0x131)]],_0x20bce0=[_0x227437[_0x46d54c(0xde)][_0x46d54c(0x109)]],_0x30f564=[_0x227437['body'][_0x46d54c(0x10e)]];else var _0x334e55=[..._0x227437[_0x46d54c(0xde)][_0x46d54c(0x86)]],_0x1ef625=[..._0x227437[_0x46d54c(0xde)][_0x46d54c(0xe1)]],_0x56437b=[..._0x227437['body'][_0x46d54c(0xd6)]],_0x3e52e5=[..._0x227437[_0x46d54c(0xde)]['types']],_0x66454b=[..._0x227437[_0x46d54c(0xde)]['adjust_qty']],_0x157fad=[..._0x227437['body'][_0x46d54c(0xc3)]],_0x62755c=[..._0x227437[_0x46d54c(0xde)][_0x46d54c(0x110)]],_0x6d681a=[..._0x227437[_0x46d54c(0xde)][_0x46d54c(0x79)]],_0x5c3a0b=[..._0x227437['body'][_0x46d54c(0x131)]],_0x20bce0=[..._0x227437[_0x46d54c(0xde)][_0x46d54c(0x109)]],_0x30f564=[..._0x227437[_0x46d54c(0xde)][_0x46d54c(0x10e)]];const _0x29d1b3=_0x334e55['map'](_0x24f8cd=>{return _0x24f8cd={'product_name':_0x24f8cd};});_0x1ef625['forEach']((_0x477612,_0x360db7)=>{var _0x2449dd=_0x46d54c;_0x29d1b3[_0x360db7][_0x2449dd(0xe2)]=_0x477612;}),_0x56437b[_0x46d54c(0xea)]((_0xd2e71d,_0x5bdab1)=>{var _0x243ee9=_0x46d54c;_0x29d1b3[_0x5bdab1][_0x243ee9(0x83)]=_0xd2e71d;}),_0x3e52e5[_0x46d54c(0xea)]((_0x3b8e08,_0x2ec2d0)=>{var _0x4b8c06=_0x46d54c;_0x29d1b3[_0x2ec2d0][_0x4b8c06(0x81)]=_0x3b8e08;}),_0x66454b[_0x46d54c(0xea)]((_0x494922,_0x2a1634)=>{_0x29d1b3[_0x2a1634]['adjust_qty']=_0x494922;}),_0x157fad['forEach']((_0x2ec97c,_0x4d8de1)=>{var _0x3612af=_0x46d54c;_0x29d1b3[_0x4d8de1][_0x3612af(0xc3)]=_0x2ec97c;}),_0x6d681a[_0x46d54c(0xea)]((_0x29f45f,_0x30d8e7)=>{_0x29d1b3[_0x30d8e7]['unit']=_0x29f45f;}),_0x5c3a0b['forEach']((_0x2a50a4,_0x495503)=>{var _0x105989=_0x46d54c;_0x29d1b3[_0x495503][_0x105989(0xba)]=_0x2a50a4;}),_0x62755c['forEach']((_0x34f1ad,_0x430801)=>{var _0x37f40a=_0x46d54c;_0x29d1b3[_0x430801][_0x37f40a(0x7a)]=_0x34f1ad;}),_0x20bce0[_0x46d54c(0xea)]((_0x32ae36,_0x3ae656)=>{var _0x28b374=_0x46d54c;_0x29d1b3[_0x3ae656][_0x28b374(0x109)]=_0x32ae36;}),_0x30f564[_0x46d54c(0xea)]((_0xd298c6,_0x38a6b1)=>{var _0x5043cb=_0x46d54c;_0x29d1b3[_0x38a6b1][_0x5043cb(0x10e)]=_0xd298c6;});const _0x252178=_0x29d1b3[_0x46d54c(0xb0)](_0x3f1816=>_0x3f1816[_0x46d54c(0x7c)]!=='0'&&_0x3f1816[_0x46d54c(0x7c)]!=='');var _0x226214=0x0;_0x252178[_0x46d54c(0xea)](_0x15da62=>{var _0x190b65=_0x46d54c;console[_0x190b65(0xf0)](_0x190b65(0x100),_0x15da62),parseInt(_0x15da62['adjust_qty'])<=0x0&&_0x226214++;});if(_0x226214!=0x0)return _0x227437['flash'](_0x46d54c(0x121),_0x46d54c(0xf1)),_0x4e464d[_0x46d54c(0x7f)](_0x46d54c(0x11a));_0xb795af[_0x46d54c(0xb8)]=_0x1c0542,_0xb795af[_0x46d54c(0x129)]=_0x1806c9,_0xb795af['product']=_0x252178,_0xb795af[_0x46d54c(0xb3)]=_0x46a0b1,_0xb795af[_0x46d54c(0x12f)]=_0x25f21a,_0xb795af[_0x46d54c(0x99)]=_0x27da90,_0xb795af[_0x46d54c(0x107)]=_0x2296fe;const _0x270a50=await _0xb795af['save'](),_0x52e17c=await warehouse['findOne']({'name':_0x1c0542,'room':_0x25f21a});_0x270a50[_0x46d54c(0xbb)][_0x46d54c(0xea)](_0x465a54=>{var _0x274b7a=_0x46d54c;const _0x5a6d17=_0x52e17c[_0x274b7a(0xe9)]['map'](_0x58ee91=>{var _0x156544=_0x274b7a;_0x465a54['types']==_0x156544(0xb7)?_0x58ee91[_0x156544(0x134)]==_0x465a54['product_name']&&_0x58ee91[_0x156544(0xe2)]==_0x465a54['bay']&&(_0x58ee91[_0x156544(0xa9)]=parseInt(_0x58ee91['product_stock'])-parseInt(_0x465a54[_0x156544(0x7c)])):_0x58ee91[_0x156544(0x134)]==_0x465a54['product_name']&&_0x58ee91[_0x156544(0xe2)]==_0x465a54[_0x156544(0xe2)]&&(_0x58ee91[_0x156544(0xa9)]=parseInt(_0x58ee91[_0x156544(0xa9)])+parseInt(_0x465a54[_0x156544(0x7c)]));});}),await _0x52e17c['save'](),_0x227437[_0x46d54c(0xdb)](_0x46d54c(0xf6),_0x46d54c(0x13a)),_0x4e464d[_0x46d54c(0x7f)](_0x46d54c(0x12e));}catch(_0x4dd705){console[_0x46d54c(0xf0)](_0x4dd705);}}),router[a0_0x5964d5(0xec)](a0_0x5964d5(0x133),async(_0x36bf04,_0x5adb9d)=>{var _0x241add=a0_0x5964d5;const {primary_code:_0x61e92e,warehouse_data:_0x301e94,rooms_data:_0x5ee3a9,Roomslist:_0x43a89a}=_0x36bf04[_0x241add(0xde)],_0x4b7061=_0x43a89a['split'](','),_0x21cf8d=[];async function _0xf05294(_0x70d37){var _0x15ee0=_0x241add;const _0x6dc7fa=await warehouse[_0x15ee0(0xe3)]([{'$match':{'name':_0x301e94,'room':_0x70d37}},{'$unwind':_0x15ee0(0xd0)},{'$match':{'product_details.primary_code':_0x61e92e}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x15ee0(0xdd)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x15ee0(0x8c)},'secondary_code':{'$first':_0x15ee0(0x87)},'product_code':{'$first':_0x15ee0(0x10a)},'level':{'$first':_0x15ee0(0xfc)},'isle':{'$first':_0x15ee0(0x10d)},'type':{'$first':_0x15ee0(0xfb)},'pallet':{'$first':_0x15ee0(0x115)},'unit':{'$first':_0x15ee0(0x80)},'secondary_unit':{'$first':_0x15ee0(0x9b)},'storage':{'$first':_0x15ee0(0x105)},'rack':{'$first':_0x15ee0(0xa2)},'expiry_date':{'$first':_0x15ee0(0xc9)},'production_date':{'$first':_0x15ee0(0x10c)},'batch_code':{'$first':_0x15ee0(0xcd)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x15ee0(0xe6)},'roomNamed':{'$first':_0x15ee0(0x103)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x5858f8=await warehouse[_0x15ee0(0xe3)]([{'$match':{'name':_0x301e94,'room':_0x70d37}},{'$unwind':_0x15ee0(0xd0)},{'$match':{'product_details.secondary_code':_0x61e92e}},{'$group':{'_id':_0x15ee0(0x90),'name':{'$first':_0x15ee0(0xdd)},'product_stock':{'$first':_0x15ee0(0x8f)},'primary_code':{'$first':_0x15ee0(0x8c)},'secondary_code':{'$first':_0x15ee0(0x87)},'product_code':{'$first':_0x15ee0(0x10a)},'level':{'$first':_0x15ee0(0xfc)},'isle':{'$first':_0x15ee0(0x10d)},'type':{'$first':_0x15ee0(0xfb)},'pallet':{'$first':_0x15ee0(0x115)},'unit':{'$first':_0x15ee0(0x80)},'secondary_unit':{'$first':_0x15ee0(0x9b)},'storage':{'$first':_0x15ee0(0x105)},'rack':{'$first':_0x15ee0(0xa2)},'expiry_date':{'$first':_0x15ee0(0xc9)},'production_date':{'$first':_0x15ee0(0x10c)},'batch_code':{'$first':_0x15ee0(0xcd)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x15ee0(0xe6)},'roomNamed':{'$first':'$room'},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x6dc7fa[_0x15ee0(0xc0)]>0x0)_0x21cf8d['push'](_0x6dc7fa);else _0x5858f8[_0x15ee0(0xc0)]>0x0&&_0x21cf8d[_0x15ee0(0xd8)](_0x5858f8);}const _0x5336f6=_0x4b7061[_0x241add(0xda)](_0x357e7b=>_0xf05294(_0x357e7b));await Promise[_0x241add(0x82)](_0x5336f6),_0x5adb9d[_0x241add(0xb1)](_0x21cf8d);}),router[a0_0x5964d5(0xec)]('/CheckingWarehouse',async(_0x573a21,_0x5ef65b)=>{var _0x332232=a0_0x5964d5;const {productCode:_0xaa94fe,bay:_0x213601,warehouses:_0x5f31f1,room:_0x21555a}=_0x573a21[_0x332232(0xde)];console[_0x332232(0xf0)](_0x573a21[_0x332232(0xde)]);try{const _0x52a5f5=await warehouse[_0x332232(0xe3)]([{'$match':{'name':_0x5f31f1,'room':_0x21555a}},{'$unwind':_0x332232(0xd0)},{'$match':{'product_details.bay':parseInt(_0x213601)}},{'$group':{'_id':_0x332232(0x90),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x332232(0x8f)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x332232(0x9a)}}}]);_0x5ef65b[_0x332232(0x11f)](0xc8)['json'](_0x52a5f5);}catch(_0x420750){_0x5ef65b['status'](0x194)[_0x332232(0xb1)]({'message':_0x420750[_0x332232(0x135)]});}}),module[a0_0x5964d5(0x11b)]=router;