function a0_0x2c8d(){var _0x13a97a=['<span\x20style=\x22float:\x20right;\x22>','/preview/:id','flash','An\x20error\x20occurred.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','save','product_details','getFullYear','$product.product_name','adjust_qty','add_adjustment_finished','padStart','getDate','getMonth','Adjustment\x20Finalize\x20Successfully','stockBefore','level','product_name','toString','slice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$room','all','find','$product_details.product_code','$product_details.secondary_code','<tbody\x20style=\x22text-align:\x20center;\x22>','post','New_Qty_Converted_adj','$product_details.product_stock','/adjustment_finished/view','map','English','secondary_unit','$product_details.maxPerUnit','Logo.png','</head><body>','FGSEmail','$product_details.expiry_date','/upload/','$product.room_names','11320672fZlqWC','unit','success','note','Arabic\x20(ae)','redirect','$product_details.product_name','/barcode_scanner','$product_details.invoice','Spanish','/CheckingWarehouse','Enabled','318329UtTHrV','<!DOCTYPE\x20html>','<h5>','QA\x20Warehouse','Primary_Units','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','4LxjjVy','product_code','DRY\x20GOODS','purchases_data','room','</h5>','/view','../models/all_models','Return\x20Rooms','message','random','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','batch_code','render','$product_details.bay','New_Qty_Converted','Ambient','nodemailer','maxPerUnit','/picking_list/PDF_adjustment/','warehouse','params','</tbody>','master','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','</td>','site_title','/adjustment_finished/preview/','Arabic','1605860dcTcUb','push','Portuguese\x20(BR)','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','date','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Adjustment\x20Mail','split','True','errors','Router','$product_details.secondary_unit','product_date','Hindi','foreach\x20newproduct','aggregate','types','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','json','get','status','findOne','860160hHayGO','<html><head><title></title>','French','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','sendMail','$finalize','minus','host','</div>','stock','warehouse_name','1098222McltNz','expiry_date','</tr>','port','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','filter','\x20</h2>','ADJF-','adjustment\x20add\x20successfull','</thead>','$product_details.production_date','$name','$product','Finished\x20Goods','</body></html>','product','production_date','$product_details.storage','$product_details.unit','Chinese','$product_details.floorlevel','catch','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','English\x20(US)','$product_details.batch_code','Enclosed','string','$product_details.bin','\x20Order\x20Number\x20:\x20','<div>','language','7uPRHtq','/view/:id','staff','back','Secondary_units','$product_details.rack','$date','20GFhWJz','body','222714jnXBzj','adjustment\x20data\x20update\x20successfully','German','log','168IxYYJh','prod_code','$product_details.maxProducts','$product_details.type','image','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Email\x20sent\x20successfully','createTransport','new_adjust_qty','bay','then','$product_details.primary_code','product_stock','error','email','prod_cat','role','An\x20error\x20occurred\x20while\x20saving\x20data.','length','findById','$warehouse_name','Portuguese','user','../middleware/auth','</span>','/view/add_adjustment','$product_details._id','1862994ogNIGJ','prod_name','$product_details','prod_invoice','<strong>\x20Regards\x20</strong>','forEach'];a0_0x2c8d=function(){return _0x13a97a;};return a0_0x2c8d();}var a0_0x212560=a0_0x520b;(function(_0x35fd6b,_0x1762dd){var _0x2b7f85=a0_0x520b,_0x274ae1=_0x35fd6b();while(!![]){try{var _0xd5f710=-parseInt(_0x2b7f85(0x1fd))/0x1+parseInt(_0x2b7f85(0x244))/0x2+-parseInt(_0x2b7f85(0x239))/0x3+parseInt(_0x2b7f85(0x203))/0x4*(-parseInt(_0x2b7f85(0x221))/0x5)+-parseInt(_0x2b7f85(0x1c2))/0x6*(parseInt(_0x2b7f85(0x263))/0x7)+parseInt(_0x2b7f85(0x270))/0x8*(-parseInt(_0x2b7f85(0x26c))/0x9)+-parseInt(_0x2b7f85(0x26a))/0xa*(-parseInt(_0x2b7f85(0x1f1))/0xb);if(_0xd5f710===_0x1762dd)break;else _0x274ae1['push'](_0x274ae1['shift']());}catch(_0x497e10){_0x274ae1['push'](_0x274ae1['shift']());}}}(a0_0x2c8d,0xcfc55));const express=require('express'),app=express(),router=express[a0_0x212560(0x22c)](),auth=require(a0_0x212560(0x1be)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x212560(0x20a)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x212560(0x214));router[a0_0x212560(0x236)](a0_0x212560(0x209),auth,async(_0xdabbf5,_0x508f89)=>{var _0x355c08=a0_0x212560;try{const {username:_0x5bdf23,email:_0x52d7ce,role:_0x1ad96c}=_0xdabbf5['user'],_0x13e4f8=_0xdabbf5[_0x355c08(0x1bd)],_0x4233d2=await profile[_0x355c08(0x238)]({'email':_0x13e4f8[_0x355c08(0x27e)]}),_0x5f51d1=await master_shop[_0x355c08(0x1df)]();let _0x972bba;if(_0x13e4f8[_0x355c08(0x1b7)]==_0x355c08(0x265)){const _0x54dfa1=await staff[_0x355c08(0x238)]({'email':_0x13e4f8[_0x355c08(0x27e)]});_0x972bba=await warehouse['find']({'status':_0x355c08(0x1fc),'name':_0x54dfa1[_0x355c08(0x217)]});}else _0x972bba=await warehouse['find']({'status':_0x355c08(0x1fc)});const _0x43fad7=await product[_0x355c08(0x1df)]();let _0x319618;if(_0x13e4f8[_0x355c08(0x1b7)]==_0x355c08(0x265)){const _0x46664c=await staff[_0x355c08(0x238)]({'email':_0x13e4f8[_0x355c08(0x27e)]});_0x319618=await adjustment_finished[_0x355c08(0x1df)]({'warehouse_name':_0x46664c[_0x355c08(0x217)]});}else _0x319618=await adjustment_finished[_0x355c08(0x231)]([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x355c08(0x269)},'warehouse_name':{'$first':_0x355c08(0x1bb)},'room':{'$addToSet':_0x355c08(0x1f0)},'finalize':{'$first':_0x355c08(0x23e)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x5f51d1[0x0][_0x355c08(0x262)]==_0x355c08(0x25b)){var _0x4d9afd=users[_0x355c08(0x1e8)];console[_0x355c08(0x26f)](_0x4d9afd);}else{if(_0x5f51d1[0x0][_0x355c08(0x262)]=='Hindi')var _0x4d9afd=users[_0x355c08(0x22f)];else{if(_0x5f51d1[0x0][_0x355c08(0x262)]==_0x355c08(0x26e))var _0x4d9afd=users['German'];else{if(_0x5f51d1[0x0]['language']==_0x355c08(0x1fa))var _0x4d9afd=users[_0x355c08(0x1fa)];else{if(_0x5f51d1[0x0][_0x355c08(0x262)]==_0x355c08(0x23b))var _0x4d9afd=users[_0x355c08(0x23b)];else{if(_0x5f51d1[0x0][_0x355c08(0x262)]=='Portuguese\x20(BR)')var _0x4d9afd=users[_0x355c08(0x1bc)];else{if(_0x5f51d1[0x0]['language']==_0x355c08(0x257))var _0x4d9afd=users[_0x355c08(0x257)];else{if(_0x5f51d1[0x0]['language']==_0x355c08(0x1f5))var _0x4d9afd=users['Arabic'];}}}}}}}_0x508f89[_0x355c08(0x210)]('adjustment_finished',{'success':_0xdabbf5[_0x355c08(0x1ca)]('success'),'errors':_0xdabbf5[_0x355c08(0x1ca)]('errors'),'role':_0x13e4f8,'profile':_0x4233d2,'warehouse':_0x972bba,'product':_0x43fad7,'adjustment':_0x319618,'master_shop':_0x5f51d1,'language':_0x4d9afd});}catch(_0x5cbdac){console[_0x355c08(0x26f)](_0x5cbdac);}});async function getRandom8DigitNumber(){var _0xb77df0=a0_0x212560;const _0x4442e6=0x989680,_0x1063c1=0x5f5e0ff,_0x48b740=Math['floor'](Math[_0xb77df0(0x20d)]()*(_0x1063c1-_0x4442e6+0x1))+_0x4442e6;var _0x4d0a8f;const _0x1a2dd7=await adjustment_finished[_0xb77df0(0x238)]({'invoice':'ADJF-'+_0x48b740});return _0x1a2dd7&&_0x1a2dd7[_0xb77df0(0x1b9)]>0x0?_0x4d0a8f=_0xb77df0(0x24b)+_0x48b740:_0x4d0a8f='ADJF-'+_0x48b740,_0x4d0a8f;}function a0_0x520b(_0x5c9b27,_0x1f69b8){var _0x2c8d2d=a0_0x2c8d();return a0_0x520b=function(_0x520ba0,_0x149ce5){_0x520ba0=_0x520ba0-0x1b6;var _0x5e991b=_0x2c8d2d[_0x520ba0];return _0x5e991b;},a0_0x520b(_0x5c9b27,_0x1f69b8);}router[a0_0x212560(0x236)]('/view/add_adjustment',auth,async(_0x53bc13,_0x29186e)=>{var _0x56070f=a0_0x212560;try{const {username:_0x5efe75,email:_0x508cbb,role:_0xb035bd}=_0x53bc13[_0x56070f(0x1bd)],_0x30e6fd=_0x53bc13['user'],_0x4628db=await profile[_0x56070f(0x238)]({'email':_0x30e6fd['email']}),_0x2a473f=await master_shop[_0x56070f(0x1df)]();let _0x23b71a;if(_0x30e6fd[_0x56070f(0x1b7)]=='staff'){const _0x5326db=await staff[_0x56070f(0x238)]({'email':_0x30e6fd['email']});_0x23b71a=await warehouse[_0x56070f(0x231)]([{'$match':{'status':'Enabled','name':_0x5326db[_0x56070f(0x217)],'warehouse_category':_0x56070f(0x251),'name':{'$ne':_0x56070f(0x200)}}},{'$group':{'_id':_0x56070f(0x24f),'name':{'$first':'$name'}}}]);}else _0x23b71a=await warehouse[_0x56070f(0x231)]([{'$match':{'status':_0x56070f(0x1fc),'warehouse_category':_0x56070f(0x251),'name':{'$ne':_0x56070f(0x200)}}},{'$group':{'_id':_0x56070f(0x24f),'name':{'$first':'$name'}}}]);const _0x26b4ae=await product[_0x56070f(0x1df)]({}),_0x592f30=await adjustment_finished[_0x56070f(0x1df)]({}),_0x4ad947=_0x592f30[_0x56070f(0x1b9)]+0x1,_0x260216=_0x56070f(0x24b)+_0x4ad947[_0x56070f(0x1da)]()[_0x56070f(0x1d3)](0x5,'0');var _0x19f9b6=[_0x56070f(0x213),'Enclosed',_0x56070f(0x20b)];if(_0x2a473f[0x0][_0x56070f(0x262)]=='English\x20(US)')var _0x16e00e=users[_0x56070f(0x1e8)];else{if(_0x2a473f[0x0][_0x56070f(0x262)]==_0x56070f(0x22f))var _0x16e00e=users[_0x56070f(0x22f)];else{if(_0x2a473f[0x0]['language']==_0x56070f(0x26e))var _0x16e00e=users[_0x56070f(0x26e)];else{if(_0x2a473f[0x0]['language']=='Spanish')var _0x16e00e=users['Spanish'];else{if(_0x2a473f[0x0]['language']==_0x56070f(0x23b))var _0x16e00e=users[_0x56070f(0x23b)];else{if(_0x2a473f[0x0][_0x56070f(0x262)]=='Portuguese\x20(BR)')var _0x16e00e=users[_0x56070f(0x1bc)];else{if(_0x2a473f[0x0][_0x56070f(0x262)]==_0x56070f(0x257))var _0x16e00e=users[_0x56070f(0x257)];else{if(_0x2a473f[0x0][_0x56070f(0x262)]=='Arabic\x20(ae)')var _0x16e00e=users[_0x56070f(0x220)];}}}}}}}const _0x1d06f9=getRandom8DigitNumber();_0x1d06f9[_0x56070f(0x27a)](_0x522926=>{var _0x5ec2c1=_0x56070f;_0x29186e[_0x5ec2c1(0x210)](_0x5ec2c1(0x1d2),{'success':_0x53bc13[_0x5ec2c1(0x1ca)]('success'),'errors':_0x53bc13[_0x5ec2c1(0x1ca)]('errors'),'role':_0x30e6fd,'profile':_0x4628db,'warehouse':_0x23b71a,'product':_0x26b4ae,'master_shop':_0x2a473f,'language':_0x16e00e,'rooms_data':_0x19f9b6,'invoice_no':_0x522926});})[_0x56070f(0x259)](_0x530e0=>{var _0x366ba5=_0x56070f;_0x53bc13[_0x366ba5(0x1ca)]('errors',_0x366ba5(0x1dc)),_0x29186e['redirect']('/adjustment/view');});}catch(_0x3e8a0d){console['log'](_0x3e8a0d);}}),router['post'](a0_0x212560(0x1c0),auth,async(_0x31a846,_0x4ae9bf)=>{var _0x48c8ac=a0_0x212560;try{const {warehouse_name:_0x940b00,date:_0x1c3be1,prod_name:_0x2d7676,level:_0x43389f,isle:_0x55b9f3,pallet:_0x2fbe02,stock:_0x53920f,types:_0x3e986a,adjust_qty:_0x454ec3,new_adjust_qty:_0x10789f,note:_0x5db502,Room_name:_0x592495,invoice:_0x1eb6c9,JO_number:_0x4ad3d2,expiry_date:_0x495fe8}=_0x31a846[_0x48c8ac(0x26b)];if(typeof _0x2d7676==_0x48c8ac(0x25e))var _0x2df496=[_0x31a846['body']['prod_name']],_0x58d8b6=[_0x31a846[_0x48c8ac(0x26b)]['level']],_0x3acdbc=[_0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x242)]],_0x2cf950=[_0x31a846[_0x48c8ac(0x26b)]['types']],_0x1ae114=[_0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x1e4)]],_0x5d1029=[_0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x212)]],_0x2418fa=[_0x31a846['body']['Primary_Units']],_0x280dec=[_0x31a846[_0x48c8ac(0x26b)]['Secondary_units']],_0xbe434b=[_0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x271)]],_0x5a363b=[_0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x20f)]],_0x509690=[_0x31a846['body'][_0x48c8ac(0x245)]],_0x15043e=[_0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x22e)]],_0x1554df=[_0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x1b6)]],_0x278198=[_0x31a846[_0x48c8ac(0x26b)]['Rooms']],_0x589473=[_0x31a846['body'][_0x48c8ac(0x215)]],_0x1ed7d1=[_0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x1c5)]];else var _0x2df496=[..._0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x1c3)]],_0x58d8b6=[..._0x31a846[_0x48c8ac(0x26b)]['level']],_0x3acdbc=[..._0x31a846[_0x48c8ac(0x26b)]['stock']],_0x2cf950=[..._0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x232)]],_0x1ae114=[..._0x31a846[_0x48c8ac(0x26b)]['New_Qty_Converted_adj']],_0x5d1029=[..._0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x212)]],_0x2418fa=[..._0x31a846['body'][_0x48c8ac(0x201)]],_0x280dec=[..._0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x267)]],_0xbe434b=[..._0x31a846['body'][_0x48c8ac(0x271)]],_0x5a363b=[..._0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x20f)]],_0x509690=[..._0x31a846[_0x48c8ac(0x26b)]['expiry_date']],_0x15043e=[..._0x31a846['body'][_0x48c8ac(0x22e)]],_0x1554df=[..._0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x1b6)]],_0x278198=[..._0x31a846['body']['Rooms']],_0x589473=[..._0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x215)]],_0x1ed7d1=[..._0x31a846[_0x48c8ac(0x26b)][_0x48c8ac(0x1c5)]];const _0x1e8ee4=_0x2df496['map'](_0x1a9866=>{return _0x1a9866={'product_name':_0x1a9866};});_0x58d8b6['forEach']((_0x259319,_0x34e873)=>{_0x1e8ee4[_0x34e873]['bay']=_0x259319;}),_0x3acdbc['forEach']((_0x2cb8db,_0x12b375)=>{var _0x355760=_0x48c8ac;_0x1e8ee4[_0x12b375][_0x355760(0x1d7)]=_0x2cb8db;}),_0x2cf950[_0x48c8ac(0x1c7)]((_0xeb3bf8,_0x563dcc)=>{var _0x2609f2=_0x48c8ac;_0x1e8ee4[_0x563dcc][_0x2609f2(0x232)]=_0xeb3bf8;}),_0x1ae114['forEach']((_0x14468a,_0x3843a5)=>{var _0x31fb7e=_0x48c8ac;_0x1e8ee4[_0x3843a5][_0x31fb7e(0x1d1)]=_0x14468a;}),_0x5d1029['forEach']((_0x2d3245,_0x2a1bee)=>{_0x1e8ee4[_0x2a1bee]['new_adjust_qty']=_0x2d3245;}),_0x2418fa[_0x48c8ac(0x1c7)]((_0x21b791,_0x120716)=>{_0x1e8ee4[_0x120716]['unit']=_0x21b791;}),_0x280dec[_0x48c8ac(0x1c7)]((_0x5268fa,_0x1956e2)=>{_0x1e8ee4[_0x1956e2]['secondary_unit']=_0x5268fa;}),_0xbe434b['forEach']((_0x33d2e6,_0x1ebf1e)=>{var _0x1a2fc2=_0x48c8ac;_0x1e8ee4[_0x1ebf1e][_0x1a2fc2(0x204)]=_0x33d2e6;}),_0x5a363b[_0x48c8ac(0x1c7)]((_0xffe8c9,_0x4adc06)=>{var _0x39f2a4=_0x48c8ac;_0x1e8ee4[_0x4adc06][_0x39f2a4(0x20f)]=_0xffe8c9;}),_0x509690['forEach']((_0x39d2e0,_0x76aacc)=>{_0x1e8ee4[_0x76aacc]['expiry_date']=_0x39d2e0;}),_0x15043e[_0x48c8ac(0x1c7)]((_0xfde48b,_0x2f7150)=>{_0x1e8ee4[_0x2f7150]['production_date']=_0xfde48b;}),_0x1554df[_0x48c8ac(0x1c7)]((_0x57c003,_0xad7d80)=>{var _0x5661b4=_0x48c8ac;_0x1e8ee4[_0xad7d80][_0x5661b4(0x1b6)]=_0x57c003;}),_0x278198[_0x48c8ac(0x1c7)]((_0x16d25c,_0x1cee23)=>{_0x1e8ee4[_0x1cee23]['room_names']=_0x16d25c;}),_0x589473[_0x48c8ac(0x1c7)]((_0x36d863,_0x1d2a8f)=>{var _0x51bb59=_0x48c8ac;_0x1e8ee4[_0x1d2a8f][_0x51bb59(0x215)]=_0x36d863;}),_0x1ed7d1[_0x48c8ac(0x1c7)]((_0x24355b,_0x70d849)=>{var _0x4a66aa=_0x48c8ac;_0x1e8ee4[_0x70d849][_0x4a66aa(0x21b)]=_0x24355b;});const _0x1d2d0a=_0x1e8ee4[_0x48c8ac(0x249)](_0x41781b=>_0x41781b[_0x48c8ac(0x1d1)]!=='0'&&_0x41781b[_0x48c8ac(0x1d1)]!=='');var _0x386894=0x0;_0x1d2d0a[_0x48c8ac(0x1c7)](_0x4116a8=>{var _0x5cf7ba=_0x48c8ac;console[_0x5cf7ba(0x26f)](_0x5cf7ba(0x230),_0x4116a8),parseInt(_0x4116a8[_0x5cf7ba(0x1d1)])<=0x0&&_0x386894++;});if(_0x386894!=0x0)return _0x31a846[_0x48c8ac(0x1ca)](_0x48c8ac(0x22b),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x4ae9bf['redirect'](_0x48c8ac(0x266));const _0x5944bd=new adjustment_finished({'warehouse_name':_0x940b00,'date':_0x1c3be1,'product':_0x1d2d0a,'note':_0x5db502,'room':_0x592495,'invoice':_0x1eb6c9,'JO_number':_0x4ad3d2,'expiry_date':_0x495fe8}),_0x1b8881=await _0x5944bd[_0x48c8ac(0x1cd)]();_0x31a846[_0x48c8ac(0x1ca)](_0x48c8ac(0x1f3),_0x48c8ac(0x24c)),_0x4ae9bf[_0x48c8ac(0x1f6)](_0x48c8ac(0x21f)+_0x1b8881['_id']);}catch(_0x25e71b){console[_0x48c8ac(0x26f)](_0x25e71b),_0x4ae9bf[_0x48c8ac(0x237)](0xc8)[_0x48c8ac(0x235)]({'message':_0x25e71b['message']});}}),router['get'](a0_0x212560(0x1c9),auth,async(_0x52d4e9,_0x58e063)=>{var _0x540ba5=a0_0x212560;try{const {username:_0x150826,email:_0x939ba1,role:_0x38babb}=_0x52d4e9[_0x540ba5(0x1bd)],_0x5d9e6b=_0x52d4e9[_0x540ba5(0x1bd)],_0xb59881=await profile[_0x540ba5(0x238)]({'email':_0x5d9e6b[_0x540ba5(0x27e)]}),_0x3e90e4=await master_shop[_0x540ba5(0x1df)](),_0x696191=_0x52d4e9[_0x540ba5(0x218)]['id'],_0x2597ae=await adjustment_finished[_0x540ba5(0x1ba)]({'_id':_0x696191}),_0x266e2e=await purchases[_0x540ba5(0x231)]([{'$match':{'warehouse_name':_0x2597ae[_0x540ba5(0x243)]}},{'$unwind':_0x540ba5(0x250)},{'$group':{'_id':_0x540ba5(0x1d0)}}]);console[_0x540ba5(0x26f)](_0x540ba5(0x206),_0x266e2e);const _0x4f8bef=await product[_0x540ba5(0x1df)]({}),_0x17cc05=await warehouse[_0x540ba5(0x231)]([{'$match':{'name':_0x2597ae[_0x540ba5(0x243)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x540ba5(0x1c4)},{'$group':{'_id':_0x540ba5(0x1c1),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x540ba5(0x1e5)},'bay':{'$first':_0x540ba5(0x211)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x540ba5(0x273)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x540ba5(0x27b)},'secondary_code':{'$first':_0x540ba5(0x1e1)},'product_code':{'$first':_0x540ba5(0x1e0)},'storage':{'$first':_0x540ba5(0x255)},'rack':{'$first':_0x540ba5(0x268)},'expiry_date':{'$first':_0x540ba5(0x1ee)},'production_date':{'$first':_0x540ba5(0x24e)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x540ba5(0x1ea)},'room':{'$first':_0x540ba5(0x1dd)}}}]);if(_0x3e90e4[0x0]['language']=='English\x20(US)'){var _0x55a666=users[_0x540ba5(0x1e8)];console[_0x540ba5(0x26f)](_0x55a666);}else{if(_0x3e90e4[0x0][_0x540ba5(0x262)]==_0x540ba5(0x22f))var _0x55a666=users[_0x540ba5(0x22f)];else{if(_0x3e90e4[0x0][_0x540ba5(0x262)]=='German')var _0x55a666=users[_0x540ba5(0x26e)];else{if(_0x3e90e4[0x0]['language']==_0x540ba5(0x1fa))var _0x55a666=users[_0x540ba5(0x1fa)];else{if(_0x3e90e4[0x0][_0x540ba5(0x262)]==_0x540ba5(0x23b))var _0x55a666=users[_0x540ba5(0x23b)];else{if(_0x3e90e4[0x0][_0x540ba5(0x262)]=='Portuguese\x20(BR)')var _0x55a666=users[_0x540ba5(0x1bc)];else{if(_0x3e90e4[0x0][_0x540ba5(0x262)]==_0x540ba5(0x257))var _0x55a666=users['Chinese'];else{if(_0x3e90e4[0x0]['language']==_0x540ba5(0x1f5))var _0x55a666=users[_0x540ba5(0x220)];}}}}}}}_0x58e063[_0x540ba5(0x210)]('edit_adjustment_finished_view',{'success':_0x52d4e9[_0x540ba5(0x1ca)]('success'),'errors':_0x52d4e9[_0x540ba5(0x1ca)](_0x540ba5(0x22b)),'role':_0x5d9e6b,'profile':_0xb59881,'adjustment':_0x2597ae,'stock':_0x17cc05,'master_shop':_0x3e90e4,'warehouse_name':_0x266e2e,'unit':_0x4f8bef,'language':_0x55a666});}catch(_0x5e6470){console['log'](_0x5e6470),_0x58e063[_0x540ba5(0x237)](0xc8)[_0x540ba5(0x235)]({'message':_0x5e6470[_0x540ba5(0x20c)]});}}),router[a0_0x212560(0x1e3)](a0_0x212560(0x1c9),auth,async(_0x503638,_0x591010)=>{var _0x362de6=a0_0x212560;try{const {invoice:_0x10aa1c,warehouse_name:_0x340d8e,Room_name:_0x16b343}=_0x503638['body'],_0x2f51b4=_0x503638[_0x362de6(0x218)]['id'],_0x20fb61=await adjustment_finished[_0x362de6(0x1ba)]({'_id':_0x2f51b4});var _0x3729eb;const _0x49df60=_0x20fb61[_0x362de6(0x253)][_0x362de6(0x1e7)](async _0x29c368=>{var _0x490e2c=_0x362de6;if(_0x29c368['adjust_qty']>0x0){_0x3729eb=await warehouse[_0x490e2c(0x238)]({'name':_0x340d8e,'room':_0x29c368['room_names'],'warehouse_category':_0x490e2c(0x251)});const _0x14fc9f=_0x3729eb[_0x490e2c(0x1ce)][_0x490e2c(0x1e7)](_0x3b40a4=>{var _0x4ca591=_0x490e2c;console[_0x4ca591(0x26f)](_0x29c368[_0x4ca591(0x232)]);if(_0x29c368['types']==_0x4ca591(0x23f))_0x3b40a4[_0x4ca591(0x1d9)]==_0x29c368['product_name']&&_0x3b40a4[_0x4ca591(0x279)]==_0x29c368[_0x4ca591(0x279)]&&_0x3b40a4[_0x4ca591(0x245)]==_0x29c368[_0x4ca591(0x245)]&&_0x3b40a4[_0x4ca591(0x254)]==_0x29c368[_0x4ca591(0x254)]&&_0x3b40a4[_0x4ca591(0x20f)]==_0x29c368[_0x4ca591(0x20f)]&&_0x3b40a4[_0x4ca591(0x21b)]==_0x29c368['invoice']&&(_0x3b40a4['product_stock']=_0x3b40a4[_0x4ca591(0x27c)]-_0x29c368['adjust_qty']);else _0x29c368[_0x4ca591(0x232)]=='add'&&(_0x3b40a4[_0x4ca591(0x1d9)]==_0x29c368[_0x4ca591(0x1d9)]&&_0x3b40a4[_0x4ca591(0x279)]==_0x29c368[_0x4ca591(0x279)]&&_0x3b40a4[_0x4ca591(0x245)]==_0x29c368['expiry_date']&&_0x3b40a4[_0x4ca591(0x254)]==_0x29c368[_0x4ca591(0x254)]&&_0x3b40a4['batch_code']==_0x29c368[_0x4ca591(0x20f)]&&_0x3b40a4['invoice']==_0x29c368[_0x4ca591(0x21b)]&&(_0x3b40a4[_0x4ca591(0x27c)]=_0x3b40a4[_0x4ca591(0x27c)]+_0x29c368[_0x4ca591(0x1d1)]));});}return _0x3729eb;});Promise[_0x362de6(0x1de)](_0x49df60)[_0x362de6(0x27a)](async _0x1d9531=>{var _0x387450=_0x362de6;try{for(const _0x214668 of _0x1d9531){await _0x214668[_0x387450(0x1cd)]();}_0x20fb61['finalize']=_0x387450(0x22a);const _0x300314=await _0x20fb61[_0x387450(0x1cd)](),_0x111c79=await master_shop[_0x387450(0x1df)](),_0x1efe58=await email_settings[_0x387450(0x238)](),_0x37a057=await supervisor_settings['find']();var _0x1a4556=_0x20fb61['product'],_0x30276f='',_0x3e67c3;for(_0x3e67c3 in _0x1a4556){var _0x450d98='FG';_0x20fb61[_0x387450(0x243)]==_0x387450(0x205)&&(_0x450d98='DG'),_0x30276f+='<tr>'+_0x387450(0x224)+_0x1a4556[_0x3e67c3]['product_name']+'</td>'+_0x387450(0x224)+_0x1a4556[_0x3e67c3][_0x387450(0x204)]+_0x387450(0x21d)+_0x387450(0x224)+_0x1a4556[_0x3e67c3][_0x387450(0x1d1)]+'</td>'+_0x387450(0x224)+_0x1a4556[_0x3e67c3][_0x387450(0x1f2)]+_0x387450(0x21d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1a4556[_0x3e67c3]['secondary_unit']+'</td>'+_0x387450(0x224)+_0x20fb61[_0x387450(0x243)]+_0x387450(0x21d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1a4556[_0x3e67c3]['room_names']+_0x387450(0x21d)+_0x387450(0x224)+_0x450d98+_0x1a4556[_0x3e67c3][_0x387450(0x279)]+_0x387450(0x21d)+_0x387450(0x246);}let _0x4cb501=nodemailer[_0x387450(0x277)]({'host':_0x1efe58[_0x387450(0x240)],'port':Number(_0x1efe58[_0x387450(0x247)]),'secure':![],'auth':{'user':_0x1efe58[_0x387450(0x27e)],'pass':_0x1efe58['password']}}),_0xdeae4d={'from':_0x1efe58[_0x387450(0x27e)],'to':_0x37a057[0x0][_0x387450(0x1ed)],'subject':_0x387450(0x228),'attachments':[{'filename':_0x387450(0x1eb),'path':__dirname+'/../public'+_0x387450(0x1ef)+_0x111c79[0x0][_0x387450(0x274)],'cid':'logo'}],'html':_0x387450(0x1fe)+_0x387450(0x23a)+_0x387450(0x1ec)+'<div>'+_0x387450(0x233)+'<div>'+_0x387450(0x248)+'</div>'+_0x387450(0x261)+'<h2>\x20'+_0x111c79[0x0][_0x387450(0x21e)]+_0x387450(0x24a)+_0x387450(0x241)+_0x387450(0x241)+'<hr\x20class=\x22my-3\x22>'+_0x387450(0x261)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x387450(0x260)+_0x20fb61['invoice']+'\x20'+_0x387450(0x1c8)+'\x20Order\x20Date\x20:\x20'+_0x20fb61[_0x387450(0x225)]+'\x20'+_0x387450(0x1bf)+_0x387450(0x208)+_0x387450(0x241)+_0x387450(0x226)+_0x387450(0x23c)+'<tr>'+_0x387450(0x20e)+_0x387450(0x21c)+_0x387450(0x227)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x387450(0x275)+_0x387450(0x25a)+_0x387450(0x1cc)+_0x387450(0x202)+_0x387450(0x246)+_0x387450(0x24d)+_0x387450(0x1e2)+'\x20'+_0x30276f+'\x20'+_0x387450(0x219)+'</table>'+_0x387450(0x261)+_0x387450(0x1c6)+_0x387450(0x1ff)+_0x111c79[0x0]['site_title']+_0x387450(0x208)+_0x387450(0x241)+_0x387450(0x241)+_0x387450(0x252)};_0x4cb501[_0x387450(0x23d)](_0xdeae4d,function(_0x23a8e4,_0x5d338f){var _0x4dbb8b=_0x387450;_0x23a8e4?(console['log'](_0x23a8e4),console[_0x4dbb8b(0x26f)]('Error\x20Occurs')):console['log'](_0x4dbb8b(0x276));}),_0x503638[_0x387450(0x1ca)](_0x387450(0x1f3),_0x387450(0x1d6)),_0x591010[_0x387450(0x1f6)](_0x387450(0x216)+_0x300314['_id']);}catch(_0x46569f){console[_0x387450(0x27d)](_0x46569f),_0x591010[_0x387450(0x237)](0x1f4)[_0x387450(0x235)]({'error':_0x387450(0x1b8)});}})['catch'](_0x202c9d=>{var _0x24d295=_0x362de6;console[_0x24d295(0x27d)](_0x202c9d),_0x591010[_0x24d295(0x237)](0x1f4)[_0x24d295(0x235)]({'error':_0x24d295(0x1cb)});});}catch(_0x52a60a){_0x591010[_0x362de6(0x235)]({'message':_0x52a60a[_0x362de6(0x20c)]});}}),router[a0_0x212560(0x236)](a0_0x212560(0x264),auth,async(_0x3b490d,_0x46494f)=>{var _0x4378b0=a0_0x212560;try{const {username:_0x30d03b,email:_0x44e7b7,role:_0x27f0e7}=_0x3b490d[_0x4378b0(0x1bd)],_0x4fa00f=_0x3b490d['user'],_0x2fb963=await profile['findOne']({'email':_0x4fa00f[_0x4378b0(0x27e)]}),_0x41c41f=await master_shop[_0x4378b0(0x1df)]();console[_0x4378b0(0x26f)](_0x4378b0(0x21a),_0x41c41f);const _0x15d10b=_0x3b490d[_0x4378b0(0x218)]['id'],_0x4dd5c2=await adjustment_finished[_0x4378b0(0x1ba)]({'_id':_0x15d10b});let _0x1de116=new Date(_0x4dd5c2[_0x4378b0(0x245)]),_0x33eba5=('0'+_0x1de116[_0x4378b0(0x1d4)]())[_0x4378b0(0x1db)](-0x2),_0x3d563d=('0'+(_0x1de116[_0x4378b0(0x1d5)]()+0x1))[_0x4378b0(0x1db)](-0x2),_0x471ee6=_0x1de116[_0x4378b0(0x1cf)](),_0x55fcf9=_0x471ee6+'-'+_0x3d563d+'-'+_0x33eba5;var _0x1f96bf=[_0x4378b0(0x213),_0x4378b0(0x25d),_0x4378b0(0x20b)];const _0x2a79cb=await purchases[_0x4378b0(0x231)]([{'$match':{'warehouse_name':_0x4dd5c2[_0x4378b0(0x243)]}},{'$unwind':_0x4378b0(0x250)},{'$group':{'_id':_0x4378b0(0x1d0)}}]);console[_0x4378b0(0x26f)](_0x4378b0(0x206),_0x2a79cb);const _0x2ed29a=await product['find']({}),_0x5915dd=await warehouse[_0x4378b0(0x231)]([{'$match':{'name':_0x4dd5c2[_0x4378b0(0x243)],'room':_0x4dd5c2[_0x4378b0(0x207)]}},{'$unwind':_0x4378b0(0x1c4)},{'$group':{'_id':_0x4378b0(0x1c1),'name':{'$first':_0x4378b0(0x1f7)},'product_stock':{'$first':_0x4378b0(0x1e5)},'bay':{'$first':_0x4378b0(0x211)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4378b0(0x258)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4378b0(0x1e1)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]);if(_0x41c41f[0x0][_0x4378b0(0x262)]==_0x4378b0(0x25b)){var _0x43927e=users[_0x4378b0(0x1e8)];console[_0x4378b0(0x26f)](_0x43927e);}else{if(_0x41c41f[0x0][_0x4378b0(0x262)]=='Hindi')var _0x43927e=users[_0x4378b0(0x22f)];else{if(_0x41c41f[0x0][_0x4378b0(0x262)]==_0x4378b0(0x26e))var _0x43927e=users[_0x4378b0(0x26e)];else{if(_0x41c41f[0x0][_0x4378b0(0x262)]==_0x4378b0(0x1fa))var _0x43927e=users[_0x4378b0(0x1fa)];else{if(_0x41c41f[0x0]['language']=='French')var _0x43927e=users[_0x4378b0(0x23b)];else{if(_0x41c41f[0x0][_0x4378b0(0x262)]==_0x4378b0(0x223))var _0x43927e=users['Portuguese'];else{if(_0x41c41f[0x0][_0x4378b0(0x262)]=='Chinese')var _0x43927e=users['Chinese'];else{if(_0x41c41f[0x0][_0x4378b0(0x262)]==_0x4378b0(0x1f5))var _0x43927e=users[_0x4378b0(0x220)];}}}}}}}_0x46494f[_0x4378b0(0x210)]('edit_adjustment_finished',{'success':_0x3b490d[_0x4378b0(0x1ca)](_0x4378b0(0x1f3)),'errors':_0x3b490d[_0x4378b0(0x1ca)]('errors'),'role':_0x4fa00f,'profile':_0x2fb963,'adjustment':_0x4dd5c2,'stock':_0x5915dd,'master_shop':_0x41c41f,'warehouse_name':_0x2a79cb,'unit':_0x2ed29a,'language':_0x43927e,'rooms_data':_0x1f96bf,'ed_fullDate':_0x55fcf9});}catch(_0x46b908){console['log'](_0x46b908),_0x46494f[_0x4378b0(0x237)](0xc8)[_0x4378b0(0x235)]({'message':_0x46b908[_0x4378b0(0x20c)]});}}),router[a0_0x212560(0x1e3)](a0_0x212560(0x264),auth,async(_0x3ab509,_0x5dcbec)=>{var _0x17c7e6=a0_0x212560;try{const _0x483044=_0x3ab509[_0x17c7e6(0x218)]['id'],_0x2f76f0=await adjustment_finished[_0x17c7e6(0x1ba)]({'_id':_0x483044}),_0x302375=await warehouse[_0x17c7e6(0x238)]({'name':_0x2f76f0[_0x17c7e6(0x243)],'room':_0x2f76f0[_0x17c7e6(0x207)]}),{warehouse_name:_0x59efaa,date:_0x1255cf,prod_name:_0x1c90b1,level:_0x37acb2,isle:_0xdd4135,pallet:_0x13dbb3,stock:_0x22c6a6,types:_0x500b84,adjust_qty:_0x43517d,new_adjust_qty:_0x2aef8c,note:_0x146861,Room_name:_0x5278f0,invoice:_0x40fda8,JO_number:_0x6c30a6}=_0x3ab509[_0x17c7e6(0x26b)];if(typeof _0x1c90b1==_0x17c7e6(0x25e))var _0x12beb9=[_0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x1c3)]],_0x122f51=[_0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x1d8)]],_0x4013fb=[_0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x242)]],_0x10fb71=[_0x3ab509['body'][_0x17c7e6(0x232)]],_0x62952e=[_0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x1d1)]],_0x537965=[_0x3ab509['body'][_0x17c7e6(0x278)]],_0x30e9ce=[_0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x271)]],_0x926b44=[_0x3ab509[_0x17c7e6(0x26b)]['unit']],_0x3df91e=[_0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x267)]],_0x29963f=[_0x3ab509['body'][_0x17c7e6(0x20f)]],_0x6161af=[_0x3ab509['body'][_0x17c7e6(0x245)]];else var _0x12beb9=[..._0x3ab509[_0x17c7e6(0x26b)]['prod_name']],_0x122f51=[..._0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x1d8)]],_0x4013fb=[..._0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x242)]],_0x10fb71=[..._0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x232)]],_0x62952e=[..._0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x1d1)]],_0x537965=[..._0x3ab509[_0x17c7e6(0x26b)]['new_adjust_qty']],_0x30e9ce=[..._0x3ab509[_0x17c7e6(0x26b)]['prod_code']],_0x926b44=[..._0x3ab509['body'][_0x17c7e6(0x1f2)]],_0x3df91e=[..._0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x267)]],_0x29963f=[..._0x3ab509[_0x17c7e6(0x26b)][_0x17c7e6(0x20f)]],_0x6161af=[..._0x3ab509['body'][_0x17c7e6(0x245)]];const _0xfb9558=_0x12beb9[_0x17c7e6(0x1e7)](_0xbe50b8=>{return _0xbe50b8={'product_name':_0xbe50b8};});_0x122f51[_0x17c7e6(0x1c7)]((_0x3e3e4d,_0x321292)=>{_0xfb9558[_0x321292]['bay']=_0x3e3e4d;}),_0x4013fb['forEach']((_0x1b2364,_0x58d065)=>{var _0x417e2d=_0x17c7e6;_0xfb9558[_0x58d065][_0x417e2d(0x1d7)]=_0x1b2364;}),_0x10fb71[_0x17c7e6(0x1c7)]((_0x4e6ec3,_0x310113)=>{var _0x5df1fa=_0x17c7e6;_0xfb9558[_0x310113][_0x5df1fa(0x232)]=_0x4e6ec3;}),_0x62952e[_0x17c7e6(0x1c7)]((_0x52cb6f,_0x41d5e4)=>{var _0xe11ee6=_0x17c7e6;_0xfb9558[_0x41d5e4][_0xe11ee6(0x1d1)]=_0x52cb6f;}),_0x537965[_0x17c7e6(0x1c7)]((_0x563ee5,_0x2a934b)=>{var _0x3e05a4=_0x17c7e6;_0xfb9558[_0x2a934b][_0x3e05a4(0x278)]=_0x563ee5;}),_0x926b44[_0x17c7e6(0x1c7)]((_0x5b5a5a,_0x375012)=>{var _0x3e3228=_0x17c7e6;_0xfb9558[_0x375012][_0x3e3228(0x1f2)]=_0x5b5a5a;}),_0x3df91e[_0x17c7e6(0x1c7)]((_0x3e04f2,_0x9474a8)=>{var _0x54c469=_0x17c7e6;_0xfb9558[_0x9474a8][_0x54c469(0x1e9)]=_0x3e04f2;}),_0x30e9ce['forEach']((_0x5cadb9,_0x5234b6)=>{var _0x456b4a=_0x17c7e6;_0xfb9558[_0x5234b6][_0x456b4a(0x204)]=_0x5cadb9;}),_0x29963f['forEach']((_0x3bb5af,_0x228e1c)=>{_0xfb9558[_0x228e1c]['batch_code']=_0x3bb5af;}),_0x6161af['forEach']((_0x2b5776,_0x4d9c92)=>{var _0x38386a=_0x17c7e6;_0xfb9558[_0x4d9c92][_0x38386a(0x245)]=_0x2b5776;});const _0x94e0fd=_0xfb9558[_0x17c7e6(0x249)](_0x4a170a=>_0x4a170a[_0x17c7e6(0x1d1)]!=='0'&&_0x4a170a[_0x17c7e6(0x1d1)]!=='');var _0x48b88d=0x0;_0x94e0fd[_0x17c7e6(0x1c7)](_0x3418e3=>{var _0x307e26=_0x17c7e6;console['log'](_0x307e26(0x230),_0x3418e3),parseInt(_0x3418e3[_0x307e26(0x1d1)])<=0x0&&_0x48b88d++;});if(_0x48b88d!=0x0)return _0x3ab509[_0x17c7e6(0x1ca)](_0x17c7e6(0x22b),_0x17c7e6(0x234)),_0x5dcbec[_0x17c7e6(0x1f6)](_0x17c7e6(0x266));_0x2f76f0[_0x17c7e6(0x243)]=_0x59efaa,_0x2f76f0[_0x17c7e6(0x225)]=_0x1255cf,_0x2f76f0['product']=_0x94e0fd,_0x2f76f0[_0x17c7e6(0x1f4)]=_0x146861,_0x2f76f0['room']=_0x5278f0,_0x2f76f0[_0x17c7e6(0x21b)]=_0x40fda8,_0x2f76f0['JO_number']=_0x6c30a6;const _0x77150d=await _0x2f76f0[_0x17c7e6(0x1cd)](),_0x53f657=await warehouse['findOne']({'name':_0x59efaa,'room':_0x5278f0});_0x77150d['product'][_0x17c7e6(0x1c7)](_0x404976=>{var _0x4a7aed=_0x17c7e6;const _0x31f097=_0x53f657[_0x4a7aed(0x1ce)][_0x4a7aed(0x1e7)](_0x44f717=>{var _0x5ed4b8=_0x4a7aed;_0x404976[_0x5ed4b8(0x232)]==_0x5ed4b8(0x23f)?_0x44f717[_0x5ed4b8(0x1d9)]==_0x404976[_0x5ed4b8(0x1d9)]&&_0x44f717[_0x5ed4b8(0x279)]==_0x404976[_0x5ed4b8(0x279)]&&(_0x44f717[_0x5ed4b8(0x27c)]=parseInt(_0x44f717[_0x5ed4b8(0x27c)])-parseInt(_0x404976['adjust_qty'])):_0x44f717[_0x5ed4b8(0x1d9)]==_0x404976[_0x5ed4b8(0x1d9)]&&_0x44f717[_0x5ed4b8(0x279)]==_0x404976[_0x5ed4b8(0x279)]&&(_0x44f717[_0x5ed4b8(0x27c)]=parseInt(_0x44f717[_0x5ed4b8(0x27c)])+parseInt(_0x404976[_0x5ed4b8(0x1d1)]));});}),await _0x53f657['save'](),_0x3ab509[_0x17c7e6(0x1ca)](_0x17c7e6(0x1f3),_0x17c7e6(0x26d)),_0x5dcbec[_0x17c7e6(0x1f6)](_0x17c7e6(0x1e6));}catch(_0x136cb1){console[_0x17c7e6(0x26f)](_0x136cb1);}}),router[a0_0x212560(0x1e3)](a0_0x212560(0x1f8),async(_0x247e07,_0x32ea5c)=>{var _0x9a20a2=a0_0x212560;const {primary_code:_0x4654ab,warehouse_data:_0x3e06d6,rooms_data:_0x5dfb38,Roomslist:_0x14bd7b}=_0x247e07[_0x9a20a2(0x26b)],_0x192bf7=_0x14bd7b[_0x9a20a2(0x229)](','),_0x93a42d=[];async function _0x269fb6(_0x1f8c70){var _0x556c01=_0x9a20a2;const _0x268267=await warehouse[_0x556c01(0x231)]([{'$match':{'name':_0x3e06d6,'room':_0x1f8c70}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x4654ab}},{'$group':{'_id':_0x556c01(0x1c1),'name':{'$first':_0x556c01(0x1f7)},'product_stock':{'$first':_0x556c01(0x1e5)},'primary_code':{'$first':_0x556c01(0x27b)},'secondary_code':{'$first':_0x556c01(0x1e1)},'product_code':{'$first':_0x556c01(0x1e0)},'level':{'$first':_0x556c01(0x211)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x556c01(0x258)},'unit':{'$first':_0x556c01(0x256)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x556c01(0x255)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x556c01(0x1ee)},'production_date':{'$first':_0x556c01(0x24e)},'batch_code':{'$first':_0x556c01(0x25c)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x556c01(0x1ea)},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x556c01(0x1f9)}}}]),_0x106215=await warehouse['aggregate']([{'$match':{'name':_0x3e06d6,'room':_0x1f8c70}},{'$unwind':_0x556c01(0x1c4)},{'$match':{'product_details.secondary_code':_0x4654ab}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x556c01(0x1f7)},'product_stock':{'$first':_0x556c01(0x1e5)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x556c01(0x1e0)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x556c01(0x25f)},'type':{'$first':_0x556c01(0x273)},'pallet':{'$first':_0x556c01(0x258)},'unit':{'$first':_0x556c01(0x256)},'secondary_unit':{'$first':_0x556c01(0x22d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x556c01(0x268)},'expiry_date':{'$first':_0x556c01(0x1ee)},'production_date':{'$first':_0x556c01(0x24e)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x556c01(0x1dd)},'invoice':{'$first':_0x556c01(0x1f9)}}}]);if(_0x268267[_0x556c01(0x1b9)]>0x0)_0x93a42d['push'](_0x268267);else _0x106215[_0x556c01(0x1b9)]>0x0&&_0x93a42d[_0x556c01(0x222)](_0x106215);}const _0x4feb14=_0x192bf7[_0x9a20a2(0x1e7)](_0x4f9926=>_0x269fb6(_0x4f9926));await Promise[_0x9a20a2(0x1de)](_0x4feb14),_0x32ea5c['json'](_0x93a42d);}),router[a0_0x212560(0x1e3)](a0_0x212560(0x1fb),async(_0x451787,_0x307589)=>{var _0x1416f9=a0_0x212560;const {productCode:_0x1db0d3,bay:_0x503f24,warehouses:_0x412489,room:_0x2f93cc}=_0x451787['body'];console['log'](_0x451787['body']);try{const _0x2bc246=await warehouse[_0x1416f9(0x231)]([{'$match':{'name':_0x412489,'room':_0x2f93cc}},{'$unwind':_0x1416f9(0x1c4)},{'$match':{'product_details.bay':parseInt(_0x503f24)}},{'$group':{'_id':_0x1416f9(0x1c1),'name':{'$first':_0x1416f9(0x1f7)},'product_stock':{'$first':_0x1416f9(0x1e5)},'bay':{'$first':_0x1416f9(0x211)},'maxProducts':{'$first':_0x1416f9(0x272)}}}]);_0x307589['status'](0xc8)['json'](_0x2bc246);}catch(_0xc0791e){_0x307589[_0x1416f9(0x237)](0x194)[_0x1416f9(0x235)]({'message':_0xc0791e[_0x1416f9(0x20c)]});}}),module['exports']=router;