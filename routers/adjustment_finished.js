function a0_0x5042(){var _0x32396b=['<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Enabled','all','Hindi','<tr>','39vOoMPt','Adjustment\x20Mail','prod_name','/picking_list/PDF_adjustment/','223076wXJXwQ','error','JO_number','log','push','\x20Order\x20Date\x20:\x20','createTransport','134464svbzZl','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.production_date','Finished\x20Goods','product_name','9830AcwxbM','unit','toString','\x20Order\x20Number\x20:\x20','batch_code','<h5>','save','filter','room','split','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Portuguese','body','role','Primary_Units','expiry_date','$product_details.unit','express','<table\x20style=\x22width:\x20100%\x20!important;\x22>','English','347045mfwtMw','redirect','$product_details.type','product_date','../public/language/languages.json','German','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<html><head><title></title>','QA\x20Warehouse','$product_details.invoice','length','product','</h5>','<div>','nodemailer','$name','bay','DRY\x20GOODS','language','$finalize','post','An\x20error\x20occurred\x20while\x20saving\x20data.','</thead>','prod_code','2277324EWSARD','json','params','Chinese','map','$product_details.maxPerUnit','edit_adjustment_finished_view','string','$invoice','$product_details.product_name','<span\x20style=\x22float:\x20right;\x22>','Ambient','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Email\x20sent\x20successfully','finalize','<h5\x20style=\x22text-align:\x20left;\x22>','level','getDate','$product_details.product_code','_id','/barcode_scanner','maxPerUnit','Adjustment\x20Finalize\x20Successfully','status','</tr>','prod_invoice','$product.product_name','</tbody>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','image','stock','FGSEmail','slice','site_title','staff','production_date','stockBefore','warehouse_name','forEach','secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','11303556zzRKOi','Secondary_units','adjust_qty','<strong>\x20Regards\x20</strong>','$product_details.floorlevel','new_adjust_qty','</div>','note','Logo.png','floor','adjustment\x20data\x20update\x20successfully','render','master','$product_details.rack','$room','ADJF-','</td>','message','prod_cat','/view','flash','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','../models/all_models','\x20</h2>','Portuguese\x20(BR)','<!DOCTYPE\x20html>','find','/CheckingWarehouse','1268BektNz','product_stock','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','An\x20error\x20occurred.','/upload/','errors','adjustment_finished','$product_details.secondary_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','findById','Arabic','then','72AEDVDp','$product_details.product_stock','purchases_data','$_id','success','/adjustment_finished/preview/','<h2>\x20','getMonth','</head><body>','$product_details.batch_code','/view/add_adjustment','468SZgwOj','adjustment\x20add\x20successfull','findOne','sendMail','product_details','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.secondary_unit','$product_details.primary_code','/adjustment_finished/view','room_names','English\x20(US)','password','Arabic\x20(ae)','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','warehouse','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details','Spanish','back','get','minus','date','French','product_code','$product_details.expiry_date','$product','exports','add','$product_details.bin','True','$product_details._id','catch','email','New_Qty_Converted_adj','$product_details.storage','New_Qty_Converted','$product_details.bay','user','$warehouse_name','types','port','1953FhdNFv'];a0_0x5042=function(){return _0x32396b;};return a0_0x5042();}function a0_0x26af(_0x46a534,_0x2d2bc8){var _0x50420e=a0_0x5042();return a0_0x26af=function(_0x26afc1,_0x314b60){_0x26afc1=_0x26afc1-0x90;var _0x36d187=_0x50420e[_0x26afc1];return _0x36d187;},a0_0x26af(_0x46a534,_0x2d2bc8);}var a0_0x242ce9=a0_0x26af;(function(_0x1c440,_0x325570){var _0x580b86=a0_0x26af,_0xcc96f4=_0x1c440();while(!![]){try{var _0x5eb6a4=parseInt(_0x580b86(0x11a))/0x1*(-parseInt(_0x580b86(0x103))/0x2)+-parseInt(_0x580b86(0x14a))/0x3*(-parseInt(_0x580b86(0x155))/0x4)+parseInt(_0x580b86(0xa6))/0x5+-parseInt(_0x580b86(0xbe))/0x6+parseInt(_0x580b86(0x14e))/0x7*(-parseInt(_0x580b86(0x10f))/0x8)+parseInt(_0x580b86(0x144))/0x9*(-parseInt(_0x580b86(0x91))/0xa)+parseInt(_0x580b86(0xe7))/0xb;if(_0x5eb6a4===_0x325570)break;else _0xcc96f4['push'](_0xcc96f4['shift']());}catch(_0x1e3fba){_0xcc96f4['push'](_0xcc96f4['shift']());}}}(a0_0x5042,0x574f8));const express=require(a0_0x242ce9(0xa3)),app=express(),router=express['Router'](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x242ce9(0xfd)),users=require(a0_0x242ce9(0xaa)),nodemailer=require(a0_0x242ce9(0xb4));router['get'](a0_0x242ce9(0xfa),auth,async(_0x29e09e,_0x259a5e)=>{var _0x3c88f7=a0_0x242ce9;try{const {username:_0x51a90c,email:_0x268a71,role:_0x32dc3f}=_0x29e09e[_0x3c88f7(0x140)],_0x54c8e3=_0x29e09e['user'],_0x5a6586=await profile[_0x3c88f7(0x11c)]({'email':_0x54c8e3['email']}),_0xff83a7=await master_shop[_0x3c88f7(0x101)]();let _0x40d11a;if(_0x54c8e3[_0x3c88f7(0x9f)]=='staff'){const _0x312f2c=await staff[_0x3c88f7(0x11c)]({'email':_0x54c8e3['email']});_0x40d11a=await warehouse[_0x3c88f7(0x101)]({'status':_0x3c88f7(0x146),'name':_0x312f2c[_0x3c88f7(0x129)]});}else _0x40d11a=await warehouse[_0x3c88f7(0x101)]({'status':_0x3c88f7(0x146)});const _0x5d479d=await product[_0x3c88f7(0x101)]();let _0x4dd1d1;if(_0x54c8e3[_0x3c88f7(0x9f)]==_0x3c88f7(0xe0)){const _0x41b36b=await staff[_0x3c88f7(0x11c)]({'email':_0x54c8e3['email']});_0x4dd1d1=await adjustment_finished['find']({'warehouse_name':_0x41b36b[_0x3c88f7(0x129)]});}else _0x4dd1d1=await adjustment_finished['aggregate']([{'$unwind':_0x3c88f7(0x134)},{'$group':{'_id':_0x3c88f7(0x112),'invoice':{'$first':_0x3c88f7(0xc6)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x3c88f7(0x141)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x3c88f7(0xb9)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0xff83a7[0x0][_0x3c88f7(0xb8)]=='English\x20(US)'){var _0x42c543=users[_0x3c88f7(0xa5)];console[_0x3c88f7(0x151)](_0x42c543);}else{if(_0xff83a7[0x0][_0x3c88f7(0xb8)]==_0x3c88f7(0x148))var _0x42c543=users[_0x3c88f7(0x148)];else{if(_0xff83a7[0x0]['language']==_0x3c88f7(0xab))var _0x42c543=users[_0x3c88f7(0xab)];else{if(_0xff83a7[0x0][_0x3c88f7(0xb8)]=='Spanish')var _0x42c543=users[_0x3c88f7(0x12c)];else{if(_0xff83a7[0x0][_0x3c88f7(0xb8)]=='French')var _0x42c543=users['French'];else{if(_0xff83a7[0x0][_0x3c88f7(0xb8)]==_0x3c88f7(0xff))var _0x42c543=users[_0x3c88f7(0x9d)];else{if(_0xff83a7[0x0][_0x3c88f7(0xb8)]=='Chinese')var _0x42c543=users[_0x3c88f7(0xc1)];else{if(_0xff83a7[0x0]['language']==_0x3c88f7(0x127))var _0x42c543=users[_0x3c88f7(0x10d)];}}}}}}}_0x259a5e[_0x3c88f7(0xf2)](_0x3c88f7(0x109),{'success':_0x29e09e[_0x3c88f7(0xfb)](_0x3c88f7(0x113)),'errors':_0x29e09e[_0x3c88f7(0xfb)](_0x3c88f7(0x108)),'role':_0x54c8e3,'profile':_0x5a6586,'warehouse':_0x40d11a,'product':_0x5d479d,'adjustment':_0x4dd1d1,'master_shop':_0xff83a7,'language':_0x42c543});}catch(_0x4df2b2){console[_0x3c88f7(0x151)](_0x4df2b2);}});async function getRandom8DigitNumber(){var _0x88779b=a0_0x242ce9;const _0x5ebd8a=0x989680,_0x542dff=0x5f5e0ff,_0x2380d9=Math[_0x88779b(0xf0)](Math['random']()*(_0x542dff-_0x5ebd8a+0x1))+_0x5ebd8a;var _0x458fba;const _0x4d835a=await adjustment_finished['findOne']({'invoice':_0x88779b(0xf6)+_0x2380d9});return _0x4d835a&&_0x4d835a[_0x88779b(0xb0)]>0x0?_0x458fba='ADJF-'+_0x2380d9:_0x458fba=_0x88779b(0xf6)+_0x2380d9,_0x458fba;}router['get'](a0_0x242ce9(0x119),auth,async(_0x3b77c4,_0x3f175b)=>{var _0x3799e4=a0_0x242ce9;try{const {username:_0x167a21,email:_0x3e36b2,role:_0x367db7}=_0x3b77c4[_0x3799e4(0x140)],_0x31163a=_0x3b77c4['user'],_0x5e7adc=await profile[_0x3799e4(0x11c)]({'email':_0x31163a['email']}),_0x564e1a=await master_shop['find']();let _0x313e13;if(_0x31163a[_0x3799e4(0x9f)]==_0x3799e4(0xe0)){const _0x226883=await staff[_0x3799e4(0x11c)]({'email':_0x31163a[_0x3799e4(0x13b)]});_0x313e13=await warehouse[_0x3799e4(0x9b)]([{'$match':{'status':'Enabled','name':_0x226883[_0x3799e4(0x129)],'warehouse_category':_0x3799e4(0x158),'name':{'$ne':_0x3799e4(0xae)}}},{'$group':{'_id':_0x3799e4(0xb5),'name':{'$first':_0x3799e4(0xb5)}}}]);}else _0x313e13=await warehouse[_0x3799e4(0x9b)]([{'$match':{'status':_0x3799e4(0x146),'warehouse_category':_0x3799e4(0x158),'name':{'$ne':_0x3799e4(0xae)}}},{'$group':{'_id':_0x3799e4(0xb5),'name':{'$first':_0x3799e4(0xb5)}}}]);const _0x16c17b=await product[_0x3799e4(0x101)]({}),_0x39c4aa=await adjustment_finished[_0x3799e4(0x101)]({}),_0x110ea0=_0x39c4aa[_0x3799e4(0xb0)]+0x1,_0x4d2426=_0x3799e4(0xf6)+_0x110ea0[_0x3799e4(0x93)]()['padStart'](0x5,'0');var _0x1362d4=[_0x3799e4(0xc9),'Enclosed','Return\x20Rooms'];if(_0x564e1a[0x0][_0x3799e4(0xb8)]=='English\x20(US)')var _0x28896d=users[_0x3799e4(0xa5)];else{if(_0x564e1a[0x0][_0x3799e4(0xb8)]==_0x3799e4(0x148))var _0x28896d=users[_0x3799e4(0x148)];else{if(_0x564e1a[0x0][_0x3799e4(0xb8)]==_0x3799e4(0xab))var _0x28896d=users[_0x3799e4(0xab)];else{if(_0x564e1a[0x0]['language']==_0x3799e4(0x12c))var _0x28896d=users[_0x3799e4(0x12c)];else{if(_0x564e1a[0x0]['language']==_0x3799e4(0x131))var _0x28896d=users[_0x3799e4(0x131)];else{if(_0x564e1a[0x0]['language']==_0x3799e4(0xff))var _0x28896d=users['Portuguese'];else{if(_0x564e1a[0x0][_0x3799e4(0xb8)]=='Chinese')var _0x28896d=users[_0x3799e4(0xc1)];else{if(_0x564e1a[0x0][_0x3799e4(0xb8)]==_0x3799e4(0x127))var _0x28896d=users[_0x3799e4(0x10d)];}}}}}}}const _0x53c43b=getRandom8DigitNumber();_0x53c43b[_0x3799e4(0x10e)](_0x15d169=>{var _0xeaa31c=_0x3799e4;_0x3f175b['render']('add_adjustment_finished',{'success':_0x3b77c4[_0xeaa31c(0xfb)](_0xeaa31c(0x113)),'errors':_0x3b77c4[_0xeaa31c(0xfb)]('errors'),'role':_0x31163a,'profile':_0x5e7adc,'warehouse':_0x313e13,'product':_0x16c17b,'master_shop':_0x564e1a,'language':_0x28896d,'rooms_data':_0x1362d4,'invoice_no':_0x15d169});})[_0x3799e4(0x13a)](_0xe57517=>{var _0x43ea43=_0x3799e4;_0x3b77c4[_0x43ea43(0xfb)](_0x43ea43(0x108),_0x43ea43(0x10b)),_0x3f175b[_0x43ea43(0xa7)]('/adjustment/view');});}catch(_0x2579b9){console['log'](_0x2579b9);}}),router[a0_0x242ce9(0xba)](a0_0x242ce9(0x119),auth,async(_0x4dc651,_0x7a1f4c)=>{var _0x1f05a0=a0_0x242ce9;try{const {warehouse_name:_0x4169bb,date:_0x40ba31,prod_name:_0x357c81,level:_0x2b9f3e,isle:_0x53c0b2,pallet:_0x3f6fa8,stock:_0x14e66b,types:_0x1c0b55,adjust_qty:_0x19fdde,new_adjust_qty:_0x5d77a5,note:_0x585440,Room_name:_0x3e318f,invoice:_0x3e220e,JO_number:_0x28d73b,expiry_date:_0x51268d}=_0x4dc651[_0x1f05a0(0x9e)];if(typeof _0x357c81==_0x1f05a0(0xc5))var _0x2ad710=[_0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0x14c)]],_0x459002=[_0x4dc651['body'][_0x1f05a0(0xce)]],_0x503336=[_0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xdc)]],_0x4256af=[_0x4dc651[_0x1f05a0(0x9e)]['types']],_0x5ade52=[_0x4dc651['body'][_0x1f05a0(0x13c)]],_0x250cae=[_0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0x13e)]],_0x5b424c=[_0x4dc651['body'][_0x1f05a0(0xa0)]],_0x1b288c=[_0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xe8)]],_0x188515=[_0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xbd)]],_0x58308f=[_0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0x95)]],_0x13d54e=[_0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xa1)]],_0xdefcf2=[_0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xa9)]],_0x59f1dc=[_0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xf9)]],_0x4c7c29=[_0x4dc651['body']['Rooms']],_0x1cb644=[_0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xd3)]],_0x366642=[_0x4dc651['body'][_0x1f05a0(0xd7)]];else var _0x2ad710=[..._0x4dc651[_0x1f05a0(0x9e)]['prod_name']],_0x459002=[..._0x4dc651['body'][_0x1f05a0(0xce)]],_0x503336=[..._0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xdc)]],_0x4256af=[..._0x4dc651['body'][_0x1f05a0(0x142)]],_0x5ade52=[..._0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0x13c)]],_0x250cae=[..._0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0x13e)]],_0x5b424c=[..._0x4dc651['body'][_0x1f05a0(0xa0)]],_0x1b288c=[..._0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xe8)]],_0x188515=[..._0x4dc651[_0x1f05a0(0x9e)]['prod_code']],_0x58308f=[..._0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0x95)]],_0x13d54e=[..._0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xa1)]],_0xdefcf2=[..._0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xa9)]],_0x59f1dc=[..._0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xf9)]],_0x4c7c29=[..._0x4dc651[_0x1f05a0(0x9e)]['Rooms']],_0x1cb644=[..._0x4dc651['body']['maxPerUnit']],_0x366642=[..._0x4dc651[_0x1f05a0(0x9e)][_0x1f05a0(0xd7)]];const _0x3ed265=_0x2ad710[_0x1f05a0(0xc2)](_0x447db5=>{return _0x447db5={'product_name':_0x447db5};});_0x459002[_0x1f05a0(0xe4)]((_0x6fc438,_0x256198)=>{var _0x12c45f=_0x1f05a0;_0x3ed265[_0x256198][_0x12c45f(0xb6)]=_0x6fc438;}),_0x503336[_0x1f05a0(0xe4)]((_0x5614c9,_0x31f25f)=>{var _0x2c6593=_0x1f05a0;_0x3ed265[_0x31f25f][_0x2c6593(0xe2)]=_0x5614c9;}),_0x4256af['forEach']((_0x2b092c,_0xa27e34)=>{var _0x2f7cf8=_0x1f05a0;_0x3ed265[_0xa27e34][_0x2f7cf8(0x142)]=_0x2b092c;}),_0x5ade52[_0x1f05a0(0xe4)]((_0x25a0b3,_0x51203e)=>{var _0xa91b45=_0x1f05a0;_0x3ed265[_0x51203e][_0xa91b45(0xe9)]=_0x25a0b3;}),_0x250cae[_0x1f05a0(0xe4)]((_0x5800d3,_0x1c7441)=>{var _0x3cb5d0=_0x1f05a0;_0x3ed265[_0x1c7441][_0x3cb5d0(0xec)]=_0x5800d3;}),_0x5b424c[_0x1f05a0(0xe4)]((_0x5c7b8e,_0x49590a)=>{var _0x37c950=_0x1f05a0;_0x3ed265[_0x49590a][_0x37c950(0x92)]=_0x5c7b8e;}),_0x1b288c[_0x1f05a0(0xe4)]((_0x4548d3,_0x33eeb4)=>{var _0x4bc213=_0x1f05a0;_0x3ed265[_0x33eeb4][_0x4bc213(0xe5)]=_0x4548d3;}),_0x188515[_0x1f05a0(0xe4)]((_0x4b55b8,_0x53a148)=>{var _0x47a333=_0x1f05a0;_0x3ed265[_0x53a148][_0x47a333(0x132)]=_0x4b55b8;}),_0x58308f[_0x1f05a0(0xe4)]((_0x5d7f20,_0x45a301)=>{var _0x59aa65=_0x1f05a0;_0x3ed265[_0x45a301][_0x59aa65(0x95)]=_0x5d7f20;}),_0x13d54e[_0x1f05a0(0xe4)]((_0x4930f5,_0x5c873a)=>{var _0xb90dfd=_0x1f05a0;_0x3ed265[_0x5c873a][_0xb90dfd(0xa1)]=_0x4930f5;}),_0xdefcf2[_0x1f05a0(0xe4)]((_0x585aab,_0x25b8cc)=>{var _0x517242=_0x1f05a0;_0x3ed265[_0x25b8cc][_0x517242(0xe1)]=_0x585aab;}),_0x59f1dc['forEach']((_0x17960c,_0x4cec55)=>{var _0x3b1f0b=_0x1f05a0;_0x3ed265[_0x4cec55][_0x3b1f0b(0xf9)]=_0x17960c;}),_0x4c7c29[_0x1f05a0(0xe4)]((_0x4ea514,_0xbc957f)=>{var _0x87c7da=_0x1f05a0;_0x3ed265[_0xbc957f][_0x87c7da(0x124)]=_0x4ea514;}),_0x1cb644['forEach']((_0x10dd1a,_0x2dd22a)=>{var _0x5f4b8f=_0x1f05a0;_0x3ed265[_0x2dd22a][_0x5f4b8f(0xd3)]=_0x10dd1a;}),_0x366642[_0x1f05a0(0xe4)]((_0x1c062b,_0x3b78e0)=>{var _0x48f8ce=_0x1f05a0;_0x3ed265[_0x3b78e0][_0x48f8ce(0x11f)]=_0x1c062b;});const _0x56fd29=_0x3ed265['filter'](_0x38d907=>_0x38d907[_0x1f05a0(0xe9)]!=='0'&&_0x38d907[_0x1f05a0(0xe9)]!=='');var _0x47e2e6=0x0;_0x56fd29['forEach'](_0x476dcb=>{var _0x3c51dd=_0x1f05a0;console[_0x3c51dd(0x151)]('foreach\x20newproduct',_0x476dcb),parseInt(_0x476dcb[_0x3c51dd(0xe9)])<=0x0&&_0x47e2e6++;});if(_0x47e2e6!=0x0)return _0x4dc651['flash']('errors',_0x1f05a0(0x105)),_0x7a1f4c['redirect'](_0x1f05a0(0x12d));const _0x53587c=new adjustment_finished({'warehouse_name':_0x4169bb,'date':_0x40ba31,'product':_0x56fd29,'note':_0x585440,'room':_0x3e318f,'invoice':_0x3e220e,'JO_number':_0x28d73b,'expiry_date':_0x51268d}),_0x4a8333=await _0x53587c[_0x1f05a0(0x97)]();_0x4dc651['flash'](_0x1f05a0(0x113),_0x1f05a0(0x11b)),_0x7a1f4c['redirect'](_0x1f05a0(0x114)+_0x4a8333['_id']);}catch(_0x4afccb){console[_0x1f05a0(0x151)](_0x4afccb),_0x7a1f4c[_0x1f05a0(0xd5)](0xc8)[_0x1f05a0(0xbf)]({'message':_0x4afccb[_0x1f05a0(0xf8)]});}}),router[a0_0x242ce9(0x12e)]('/preview/:id',auth,async(_0x53d212,_0x5c75ba)=>{var _0x102103=a0_0x242ce9;try{const {username:_0x55e9ff,email:_0x474f43,role:_0x45d7ae}=_0x53d212['user'],_0x2285cd=_0x53d212[_0x102103(0x140)],_0x1649a6=await profile['findOne']({'email':_0x2285cd['email']}),_0x59b14e=await master_shop[_0x102103(0x101)](),_0x436690=_0x53d212['params']['id'],_0x39b32d=await adjustment_finished[_0x102103(0x10c)]({'_id':_0x436690}),_0x1505e9=await purchases[_0x102103(0x9b)]([{'$match':{'warehouse_name':_0x39b32d['warehouse_name']}},{'$unwind':_0x102103(0x134)},{'$group':{'_id':'$product.product_name'}}]);console['log']('purchases_data',_0x1505e9);const _0x3a299e=await product[_0x102103(0x101)]({}),_0x286884=await warehouse[_0x102103(0x9b)]([{'$match':{'name':_0x39b32d['warehouse_name'],'warehouse_category':_0x102103(0x158)}},{'$unwind':_0x102103(0x12b)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x102103(0xc7)},'product_stock':{'$first':_0x102103(0x110)},'bay':{'$first':_0x102103(0x13f)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x102103(0xa8)},'floorlevel':{'$first':_0x102103(0xeb)},'primary_code':{'$first':_0x102103(0x122)},'secondary_code':{'$first':_0x102103(0x10a)},'product_code':{'$first':_0x102103(0xd0)},'storage':{'$first':_0x102103(0x13d)},'rack':{'$first':_0x102103(0xf4)},'expiry_date':{'$first':_0x102103(0x133)},'production_date':{'$first':_0x102103(0x157)},'batch_code':{'$first':_0x102103(0x118)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':_0x102103(0xf5)}}}]);if(_0x59b14e[0x0][_0x102103(0xb8)]==_0x102103(0x125)){var _0x4dd44f=users[_0x102103(0xa5)];console['log'](_0x4dd44f);}else{if(_0x59b14e[0x0][_0x102103(0xb8)]==_0x102103(0x148))var _0x4dd44f=users['Hindi'];else{if(_0x59b14e[0x0]['language']==_0x102103(0xab))var _0x4dd44f=users[_0x102103(0xab)];else{if(_0x59b14e[0x0][_0x102103(0xb8)]==_0x102103(0x12c))var _0x4dd44f=users[_0x102103(0x12c)];else{if(_0x59b14e[0x0][_0x102103(0xb8)]==_0x102103(0x131))var _0x4dd44f=users[_0x102103(0x131)];else{if(_0x59b14e[0x0][_0x102103(0xb8)]=='Portuguese\x20(BR)')var _0x4dd44f=users['Portuguese'];else{if(_0x59b14e[0x0][_0x102103(0xb8)]=='Chinese')var _0x4dd44f=users['Chinese'];else{if(_0x59b14e[0x0][_0x102103(0xb8)]==_0x102103(0x127))var _0x4dd44f=users[_0x102103(0x10d)];}}}}}}}_0x5c75ba[_0x102103(0xf2)](_0x102103(0xc4),{'success':_0x53d212[_0x102103(0xfb)](_0x102103(0x113)),'errors':_0x53d212[_0x102103(0xfb)](_0x102103(0x108)),'role':_0x2285cd,'profile':_0x1649a6,'adjustment':_0x39b32d,'stock':_0x286884,'master_shop':_0x59b14e,'warehouse_name':_0x1505e9,'unit':_0x3a299e,'language':_0x4dd44f});}catch(_0x422d48){console[_0x102103(0x151)](_0x422d48),_0x5c75ba[_0x102103(0xd5)](0xc8)['json']({'message':_0x422d48[_0x102103(0xf8)]});}}),router['post']('/preview/:id',auth,async(_0x151101,_0x4e3a04)=>{var _0x29ca38=a0_0x242ce9;try{const {invoice:_0xf39397,warehouse_name:_0x88ade1,Room_name:_0x222cad}=_0x151101[_0x29ca38(0x9e)],_0x278f0d=_0x151101['params']['id'],_0x5250a8=await adjustment_finished[_0x29ca38(0x10c)]({'_id':_0x278f0d});var _0x51d06c;const _0x5b1e1e=_0x5250a8[_0x29ca38(0xb1)]['map'](async _0x11ae34=>{var _0x434765=_0x29ca38;if(_0x11ae34[_0x434765(0xe9)]>0x0){_0x51d06c=await warehouse['findOne']({'name':_0x88ade1,'room':_0x11ae34[_0x434765(0x124)],'warehouse_category':_0x434765(0x158)});const _0x492076=_0x51d06c[_0x434765(0x11e)]['map'](_0x3c6784=>{var _0x2c3802=_0x434765;console['log'](_0x11ae34['types']);if(_0x11ae34[_0x2c3802(0x142)]==_0x2c3802(0x12f))_0x3c6784[_0x2c3802(0x90)]==_0x11ae34[_0x2c3802(0x90)]&&_0x3c6784['bay']==_0x11ae34[_0x2c3802(0xb6)]&&_0x3c6784[_0x2c3802(0xa1)]==_0x11ae34[_0x2c3802(0xa1)]&&_0x3c6784[_0x2c3802(0xe1)]==_0x11ae34[_0x2c3802(0xe1)]&&_0x3c6784[_0x2c3802(0x95)]==_0x11ae34[_0x2c3802(0x95)]&&_0x3c6784[_0x2c3802(0x11f)]==_0x11ae34['invoice']&&(_0x3c6784[_0x2c3802(0x104)]=_0x3c6784[_0x2c3802(0x104)]-_0x11ae34['adjust_qty']);else _0x11ae34[_0x2c3802(0x142)]==_0x2c3802(0x136)&&(_0x3c6784[_0x2c3802(0x90)]==_0x11ae34[_0x2c3802(0x90)]&&_0x3c6784[_0x2c3802(0xb6)]==_0x11ae34[_0x2c3802(0xb6)]&&_0x3c6784[_0x2c3802(0xa1)]==_0x11ae34['expiry_date']&&_0x3c6784['production_date']==_0x11ae34[_0x2c3802(0xe1)]&&_0x3c6784[_0x2c3802(0x95)]==_0x11ae34[_0x2c3802(0x95)]&&_0x3c6784[_0x2c3802(0x11f)]==_0x11ae34[_0x2c3802(0x11f)]&&(_0x3c6784[_0x2c3802(0x104)]=_0x3c6784[_0x2c3802(0x104)]+_0x11ae34[_0x2c3802(0xe9)]));});}return _0x51d06c;});Promise[_0x29ca38(0x147)](_0x5b1e1e)[_0x29ca38(0x10e)](async _0x3a1e00=>{var _0x3133bf=_0x29ca38;try{for(const _0x2dd954 of _0x3a1e00){await _0x2dd954[_0x3133bf(0x97)]();}_0x5250a8[_0x3133bf(0xcc)]=_0x3133bf(0x138);const _0x1ea669=await _0x5250a8[_0x3133bf(0x97)](),_0x4b932b=await master_shop[_0x3133bf(0x101)](),_0x5440ea=await email_settings[_0x3133bf(0x11c)](),_0x375afc=await supervisor_settings[_0x3133bf(0x101)]();var _0x151b77=_0x5250a8[_0x3133bf(0xb1)],_0x4f4b39='',_0x2236a3;for(_0x2236a3 in _0x151b77){var _0x3d7746='FG';_0x5250a8[_0x3133bf(0xe3)]==_0x3133bf(0xb7)&&(_0x3d7746='DG'),_0x4f4b39+=_0x3133bf(0x149)+_0x3133bf(0xda)+_0x151b77[_0x2236a3]['product_name']+_0x3133bf(0xf7)+_0x3133bf(0xda)+_0x151b77[_0x2236a3][_0x3133bf(0x132)]+_0x3133bf(0xf7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x151b77[_0x2236a3]['adjust_qty']+'</td>'+_0x3133bf(0xda)+_0x151b77[_0x2236a3][_0x3133bf(0x92)]+_0x3133bf(0xf7)+_0x3133bf(0xda)+_0x151b77[_0x2236a3][_0x3133bf(0xe5)]+_0x3133bf(0xf7)+_0x3133bf(0xda)+_0x5250a8[_0x3133bf(0xe3)]+'</td>'+_0x3133bf(0xda)+_0x151b77[_0x2236a3][_0x3133bf(0x124)]+'</td>'+_0x3133bf(0xda)+_0x3d7746+_0x151b77[_0x2236a3]['bay']+'</td>'+_0x3133bf(0xd6);}let _0x153607=nodemailer[_0x3133bf(0x154)]({'host':_0x5440ea['host'],'port':Number(_0x5440ea[_0x3133bf(0x143)]),'secure':![],'auth':{'user':_0x5440ea[_0x3133bf(0x13b)],'pass':_0x5440ea[_0x3133bf(0x126)]}}),_0x9c7f8a={'from':_0x5440ea[_0x3133bf(0x13b)],'to':_0x375afc[0x0][_0x3133bf(0xdd)],'subject':_0x3133bf(0x14b),'attachments':[{'filename':_0x3133bf(0xef),'path':__dirname+'/../public'+_0x3133bf(0x107)+_0x4b932b[0x0][_0x3133bf(0xdb)],'cid':'logo'}],'html':_0x3133bf(0x100)+_0x3133bf(0xad)+_0x3133bf(0x117)+'<div>'+_0x3133bf(0x12a)+_0x3133bf(0xb3)+_0x3133bf(0x128)+_0x3133bf(0xed)+_0x3133bf(0xb3)+_0x3133bf(0x115)+_0x4b932b[0x0][_0x3133bf(0xdf)]+_0x3133bf(0xfe)+_0x3133bf(0xed)+_0x3133bf(0xed)+'<hr\x20class=\x22my-3\x22>'+_0x3133bf(0xb3)+_0x3133bf(0xcd)+_0x3133bf(0x94)+_0x5250a8['invoice']+'\x20'+_0x3133bf(0xc8)+_0x3133bf(0x153)+_0x5250a8['date']+'\x20'+'</span>'+_0x3133bf(0xb2)+_0x3133bf(0xed)+_0x3133bf(0xa4)+_0x3133bf(0xfc)+_0x3133bf(0x149)+_0x3133bf(0xca)+_0x3133bf(0xe6)+_0x3133bf(0x120)+_0x3133bf(0x145)+_0x3133bf(0x156)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x3133bf(0xac)+_0x3133bf(0x9c)+'</tr>'+_0x3133bf(0xbc)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x4f4b39+'\x20'+_0x3133bf(0xd9)+'</table>'+'<div>'+_0x3133bf(0xea)+_0x3133bf(0x96)+_0x4b932b[0x0][_0x3133bf(0xdf)]+'</h5>'+_0x3133bf(0xed)+_0x3133bf(0xed)+'</body></html>'};_0x153607[_0x3133bf(0x11d)](_0x9c7f8a,function(_0x38542e,_0x4c7fc9){var _0x2ba760=_0x3133bf;_0x38542e?(console[_0x2ba760(0x151)](_0x38542e),console['log']('Error\x20Occurs')):console[_0x2ba760(0x151)](_0x2ba760(0xcb));}),_0x151101[_0x3133bf(0xfb)]('success',_0x3133bf(0xd4)),_0x4e3a04['redirect'](_0x3133bf(0x14d)+_0x1ea669[_0x3133bf(0xd1)]);}catch(_0x4e7ab0){console[_0x3133bf(0x14f)](_0x4e7ab0),_0x4e3a04[_0x3133bf(0xd5)](0x1f4)['json']({'error':_0x3133bf(0xbb)});}})['catch'](_0x205e0c=>{var _0x583b77=_0x29ca38;console[_0x583b77(0x14f)](_0x205e0c),_0x4e3a04[_0x583b77(0xd5)](0x1f4)[_0x583b77(0xbf)]({'error':_0x583b77(0x106)});});}catch(_0x49547c){_0x4e3a04[_0x29ca38(0xbf)]({'message':_0x49547c[_0x29ca38(0xf8)]});}}),router['get']('/view/:id',auth,async(_0x4134ce,_0x4d01ea)=>{var _0x33c2a3=a0_0x242ce9;try{const {username:_0x4207a6,email:_0x5bb944,role:_0x21667c}=_0x4134ce['user'],_0x490d1d=_0x4134ce[_0x33c2a3(0x140)],_0x9257c5=await profile[_0x33c2a3(0x11c)]({'email':_0x490d1d[_0x33c2a3(0x13b)]}),_0x276e6d=await master_shop[_0x33c2a3(0x101)]();console['log'](_0x33c2a3(0xf3),_0x276e6d);const _0x2bca11=_0x4134ce[_0x33c2a3(0xc0)]['id'],_0x8eed9f=await adjustment_finished[_0x33c2a3(0x10c)]({'_id':_0x2bca11});let _0x2b1743=new Date(_0x8eed9f['expiry_date']),_0x5f262d=('0'+_0x2b1743[_0x33c2a3(0xcf)]())['slice'](-0x2),_0x19ff0b=('0'+(_0x2b1743[_0x33c2a3(0x116)]()+0x1))[_0x33c2a3(0xde)](-0x2),_0x13c710=_0x2b1743['getFullYear'](),_0x2deffc=_0x13c710+'-'+_0x19ff0b+'-'+_0x5f262d;var _0xc7aa7=[_0x33c2a3(0xc9),'Enclosed','Return\x20Rooms'];const _0x2ff2a9=await purchases[_0x33c2a3(0x9b)]([{'$match':{'warehouse_name':_0x8eed9f['warehouse_name']}},{'$unwind':_0x33c2a3(0x134)},{'$group':{'_id':_0x33c2a3(0xd8)}}]);console[_0x33c2a3(0x151)](_0x33c2a3(0x111),_0x2ff2a9);const _0x24b7ba=await product['find']({}),_0x51beb3=await warehouse['aggregate']([{'$match':{'name':_0x8eed9f[_0x33c2a3(0xe3)],'room':_0x8eed9f['room']}},{'$unwind':_0x33c2a3(0x12b)},{'$group':{'_id':_0x33c2a3(0x139),'name':{'$first':_0x33c2a3(0xc7)},'product_stock':{'$first':_0x33c2a3(0x110)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x33c2a3(0x137)},'type':{'$first':_0x33c2a3(0xa8)},'floorlevel':{'$first':_0x33c2a3(0xeb)},'primary_code':{'$first':_0x33c2a3(0x122)},'secondary_code':{'$first':_0x33c2a3(0x10a)},'product_code':{'$first':_0x33c2a3(0xd0)},'storage':{'$first':_0x33c2a3(0x13d)},'rack':{'$first':'$product_details.rack'}}}]);if(_0x276e6d[0x0][_0x33c2a3(0xb8)]=='English\x20(US)'){var _0x50d1df=users[_0x33c2a3(0xa5)];console[_0x33c2a3(0x151)](_0x50d1df);}else{if(_0x276e6d[0x0][_0x33c2a3(0xb8)]==_0x33c2a3(0x148))var _0x50d1df=users[_0x33c2a3(0x148)];else{if(_0x276e6d[0x0][_0x33c2a3(0xb8)]=='German')var _0x50d1df=users[_0x33c2a3(0xab)];else{if(_0x276e6d[0x0]['language']==_0x33c2a3(0x12c))var _0x50d1df=users[_0x33c2a3(0x12c)];else{if(_0x276e6d[0x0][_0x33c2a3(0xb8)]=='French')var _0x50d1df=users[_0x33c2a3(0x131)];else{if(_0x276e6d[0x0][_0x33c2a3(0xb8)]==_0x33c2a3(0xff))var _0x50d1df=users[_0x33c2a3(0x9d)];else{if(_0x276e6d[0x0]['language']=='Chinese')var _0x50d1df=users[_0x33c2a3(0xc1)];else{if(_0x276e6d[0x0][_0x33c2a3(0xb8)]==_0x33c2a3(0x127))var _0x50d1df=users[_0x33c2a3(0x10d)];}}}}}}}_0x4d01ea['render']('edit_adjustment_finished',{'success':_0x4134ce[_0x33c2a3(0xfb)](_0x33c2a3(0x113)),'errors':_0x4134ce[_0x33c2a3(0xfb)](_0x33c2a3(0x108)),'role':_0x490d1d,'profile':_0x9257c5,'adjustment':_0x8eed9f,'stock':_0x51beb3,'master_shop':_0x276e6d,'warehouse_name':_0x2ff2a9,'unit':_0x24b7ba,'language':_0x50d1df,'rooms_data':_0xc7aa7,'ed_fullDate':_0x2deffc});}catch(_0x5ed0f6){console[_0x33c2a3(0x151)](_0x5ed0f6),_0x4d01ea[_0x33c2a3(0xd5)](0xc8)[_0x33c2a3(0xbf)]({'message':_0x5ed0f6[_0x33c2a3(0xf8)]});}}),router[a0_0x242ce9(0xba)]('/view/:id',auth,async(_0x405bd1,_0x352cf6)=>{var _0x2f9acb=a0_0x242ce9;try{const _0x2317be=_0x405bd1[_0x2f9acb(0xc0)]['id'],_0x4b9c4b=await adjustment_finished[_0x2f9acb(0x10c)]({'_id':_0x2317be}),_0x5a934f=await warehouse[_0x2f9acb(0x11c)]({'name':_0x4b9c4b[_0x2f9acb(0xe3)],'room':_0x4b9c4b[_0x2f9acb(0x99)]}),{warehouse_name:_0xbfaf31,date:_0x5abbec,prod_name:_0x5bf180,level:_0x3618a1,isle:_0x5d1e11,pallet:_0x1feeb2,stock:_0x33443e,types:_0x530489,adjust_qty:_0x1939a8,new_adjust_qty:_0x5c00a6,note:_0x4936a0,Room_name:_0x1bf29a,invoice:_0x3db96f,JO_number:_0x16e6c8}=_0x405bd1[_0x2f9acb(0x9e)];if(typeof _0x5bf180=='string')var _0x2defcf=[_0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0x14c)]],_0x24f054=[_0x405bd1['body']['level']],_0x5190d5=[_0x405bd1['body']['stock']],_0x158a3f=[_0x405bd1[_0x2f9acb(0x9e)]['types']],_0x295614=[_0x405bd1[_0x2f9acb(0x9e)]['adjust_qty']],_0x5bcef=[_0x405bd1['body'][_0x2f9acb(0xec)]],_0x506eb7=[_0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0xbd)]],_0x391fb7=[_0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0x92)]],_0x2d317e=[_0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0xe8)]],_0x2a5f5b=[_0x405bd1[_0x2f9acb(0x9e)]['batch_code']],_0x390750=[_0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0xa1)]];else var _0x2defcf=[..._0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0x14c)]],_0x24f054=[..._0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0xce)]],_0x5190d5=[..._0x405bd1[_0x2f9acb(0x9e)]['stock']],_0x158a3f=[..._0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0x142)]],_0x295614=[..._0x405bd1[_0x2f9acb(0x9e)]['adjust_qty']],_0x5bcef=[..._0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0xec)]],_0x506eb7=[..._0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0xbd)]],_0x391fb7=[..._0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0x92)]],_0x2d317e=[..._0x405bd1['body'][_0x2f9acb(0xe8)]],_0x2a5f5b=[..._0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0x95)]],_0x390750=[..._0x405bd1[_0x2f9acb(0x9e)][_0x2f9acb(0xa1)]];const _0xc87512=_0x2defcf[_0x2f9acb(0xc2)](_0x4f4140=>{return _0x4f4140={'product_name':_0x4f4140};});_0x24f054[_0x2f9acb(0xe4)]((_0x26a7e6,_0xa68879)=>{var _0x5334c6=_0x2f9acb;_0xc87512[_0xa68879][_0x5334c6(0xb6)]=_0x26a7e6;}),_0x5190d5[_0x2f9acb(0xe4)]((_0x2fb1fb,_0x3663bb)=>{var _0xb6fca8=_0x2f9acb;_0xc87512[_0x3663bb][_0xb6fca8(0xe2)]=_0x2fb1fb;}),_0x158a3f[_0x2f9acb(0xe4)]((_0x5089b0,_0x18d281)=>{var _0x318994=_0x2f9acb;_0xc87512[_0x18d281][_0x318994(0x142)]=_0x5089b0;}),_0x295614[_0x2f9acb(0xe4)]((_0x578733,_0x313020)=>{_0xc87512[_0x313020]['adjust_qty']=_0x578733;}),_0x5bcef[_0x2f9acb(0xe4)]((_0x1bb09c,_0x223847)=>{_0xc87512[_0x223847]['new_adjust_qty']=_0x1bb09c;}),_0x391fb7[_0x2f9acb(0xe4)]((_0x4ea195,_0x2ea101)=>{_0xc87512[_0x2ea101]['unit']=_0x4ea195;}),_0x2d317e[_0x2f9acb(0xe4)]((_0x1fc643,_0xa5921f)=>{var _0x59413d=_0x2f9acb;_0xc87512[_0xa5921f][_0x59413d(0xe5)]=_0x1fc643;}),_0x506eb7[_0x2f9acb(0xe4)]((_0x1c66fc,_0x19f072)=>{_0xc87512[_0x19f072]['product_code']=_0x1c66fc;}),_0x2a5f5b['forEach']((_0x166637,_0x589634)=>{_0xc87512[_0x589634]['batch_code']=_0x166637;}),_0x390750['forEach']((_0x5de4d8,_0x284745)=>{_0xc87512[_0x284745]['expiry_date']=_0x5de4d8;});const _0x1bc347=_0xc87512[_0x2f9acb(0x98)](_0x3253a1=>_0x3253a1['adjust_qty']!=='0'&&_0x3253a1[_0x2f9acb(0xe9)]!=='');var _0x1143f0=0x0;_0x1bc347[_0x2f9acb(0xe4)](_0x423200=>{var _0x5abf77=_0x2f9acb;console[_0x5abf77(0x151)]('foreach\x20newproduct',_0x423200),parseInt(_0x423200[_0x5abf77(0xe9)])<=0x0&&_0x1143f0++;});if(_0x1143f0!=0x0)return _0x405bd1[_0x2f9acb(0xfb)](_0x2f9acb(0x108),_0x2f9acb(0x105)),_0x352cf6[_0x2f9acb(0xa7)](_0x2f9acb(0x12d));_0x4b9c4b[_0x2f9acb(0xe3)]=_0xbfaf31,_0x4b9c4b[_0x2f9acb(0x130)]=_0x5abbec,_0x4b9c4b[_0x2f9acb(0xb1)]=_0x1bc347,_0x4b9c4b[_0x2f9acb(0xee)]=_0x4936a0,_0x4b9c4b[_0x2f9acb(0x99)]=_0x1bf29a,_0x4b9c4b[_0x2f9acb(0x11f)]=_0x3db96f,_0x4b9c4b[_0x2f9acb(0x150)]=_0x16e6c8;const _0x21b78d=await _0x4b9c4b['save'](),_0x37c7cc=await warehouse[_0x2f9acb(0x11c)]({'name':_0xbfaf31,'room':_0x1bf29a});_0x21b78d[_0x2f9acb(0xb1)][_0x2f9acb(0xe4)](_0x119e0b=>{var _0x1b75b2=_0x2f9acb;const _0x461fe4=_0x37c7cc[_0x1b75b2(0x11e)][_0x1b75b2(0xc2)](_0x4545ef=>{var _0x380a1c=_0x1b75b2;_0x119e0b[_0x380a1c(0x142)]==_0x380a1c(0x12f)?_0x4545ef['product_name']==_0x119e0b[_0x380a1c(0x90)]&&_0x4545ef[_0x380a1c(0xb6)]==_0x119e0b[_0x380a1c(0xb6)]&&(_0x4545ef['product_stock']=parseInt(_0x4545ef[_0x380a1c(0x104)])-parseInt(_0x119e0b[_0x380a1c(0xe9)])):_0x4545ef['product_name']==_0x119e0b[_0x380a1c(0x90)]&&_0x4545ef[_0x380a1c(0xb6)]==_0x119e0b[_0x380a1c(0xb6)]&&(_0x4545ef[_0x380a1c(0x104)]=parseInt(_0x4545ef[_0x380a1c(0x104)])+parseInt(_0x119e0b['adjust_qty']));});}),await _0x37c7cc[_0x2f9acb(0x97)](),_0x405bd1[_0x2f9acb(0xfb)](_0x2f9acb(0x113),_0x2f9acb(0xf1)),_0x352cf6[_0x2f9acb(0xa7)](_0x2f9acb(0x123));}catch(_0x18f802){console['log'](_0x18f802);}}),router[a0_0x242ce9(0xba)](a0_0x242ce9(0xd2),async(_0x242172,_0x3f0d66)=>{var _0x59d963=a0_0x242ce9;const {primary_code:_0x1df774,warehouse_data:_0x420765,rooms_data:_0x340a78,Roomslist:_0x38905e}=_0x242172[_0x59d963(0x9e)],_0x3e5f1f=_0x38905e[_0x59d963(0x9a)](','),_0x3c958c=[];async function _0x5dda89(_0x27d4ef){var _0x19d773=_0x59d963;const _0x3967a3=await warehouse[_0x19d773(0x9b)]([{'$match':{'name':_0x420765,'room':_0x27d4ef}},{'$unwind':_0x19d773(0x12b)},{'$match':{'product_details.primary_code':_0x1df774}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x19d773(0x110)},'primary_code':{'$first':_0x19d773(0x122)},'secondary_code':{'$first':_0x19d773(0x10a)},'product_code':{'$first':_0x19d773(0xd0)},'level':{'$first':_0x19d773(0x13f)},'isle':{'$first':_0x19d773(0x137)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x19d773(0xa2)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x19d773(0x13d)},'rack':{'$first':_0x19d773(0xf4)},'expiry_date':{'$first':_0x19d773(0x133)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x19d773(0x118)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x19d773(0xc3)},'roomNamed':{'$first':_0x19d773(0xf5)},'invoice':{'$first':_0x19d773(0xaf)}}}]),_0x4c08fc=await warehouse[_0x19d773(0x9b)]([{'$match':{'name':_0x420765,'room':_0x27d4ef}},{'$unwind':_0x19d773(0x12b)},{'$match':{'product_details.secondary_code':_0x1df774}},{'$group':{'_id':_0x19d773(0x139),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x19d773(0x10a)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x19d773(0xa8)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x19d773(0x121)},'storage':{'$first':_0x19d773(0x13d)},'rack':{'$first':_0x19d773(0xf4)},'expiry_date':{'$first':_0x19d773(0x133)},'production_date':{'$first':_0x19d773(0x157)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x19d773(0xf5)},'invoice':{'$first':_0x19d773(0xaf)}}}]);if(_0x3967a3[_0x19d773(0xb0)]>0x0)_0x3c958c[_0x19d773(0x152)](_0x3967a3);else _0x4c08fc[_0x19d773(0xb0)]>0x0&&_0x3c958c[_0x19d773(0x152)](_0x4c08fc);}const _0x4f2aad=_0x3e5f1f['map'](_0x29a1af=>_0x5dda89(_0x29a1af));await Promise[_0x59d963(0x147)](_0x4f2aad),_0x3f0d66[_0x59d963(0xbf)](_0x3c958c);}),router[a0_0x242ce9(0xba)](a0_0x242ce9(0x102),async(_0x599b42,_0x5c44ee)=>{var _0x14e01d=a0_0x242ce9;const {productCode:_0x4d30a5,bay:_0x30965e,warehouses:_0x337085,room:_0x221f63}=_0x599b42['body'];console['log'](_0x599b42[_0x14e01d(0x9e)]);try{const _0x3cdc58=await warehouse[_0x14e01d(0x9b)]([{'$match':{'name':_0x337085,'room':_0x221f63}},{'$unwind':_0x14e01d(0x12b)},{'$match':{'product_details.bay':parseInt(_0x30965e)}},{'$group':{'_id':_0x14e01d(0x139),'name':{'$first':_0x14e01d(0xc7)},'product_stock':{'$first':_0x14e01d(0x110)},'bay':{'$first':_0x14e01d(0x13f)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x5c44ee[_0x14e01d(0xd5)](0xc8)[_0x14e01d(0xbf)](_0x3cdc58);}catch(_0x35a7e2){_0x5c44ee[_0x14e01d(0xd5)](0x194)['json']({'message':_0x35a7e2['message']});}}),module[a0_0x242ce9(0x135)]=router;