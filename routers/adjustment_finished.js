var a0_0x36f68c=a0_0x1a72;function a0_0x1a72(_0x442737,_0x2ccc99){var _0x2680c9=a0_0x2680();return a0_0x1a72=function(_0x1a72be,_0x274ea2){_0x1a72be=_0x1a72be-0x13d;var _0x3868b5=_0x2680c9[_0x1a72be];return _0x3868b5;},a0_0x1a72(_0x442737,_0x2ccc99);}(function(_0x232838,_0x39b5a5){var _0x384785=a0_0x1a72,_0x1f8894=_0x232838();while(!![]){try{var _0x4ded2c=parseInt(_0x384785(0x1b3))/0x1*(parseInt(_0x384785(0x152))/0x2)+parseInt(_0x384785(0x16c))/0x3*(-parseInt(_0x384785(0x15c))/0x4)+-parseInt(_0x384785(0x1fd))/0x5+parseInt(_0x384785(0x1b2))/0x6*(-parseInt(_0x384785(0x1fb))/0x7)+-parseInt(_0x384785(0x15d))/0x8*(-parseInt(_0x384785(0x1cc))/0x9)+-parseInt(_0x384785(0x179))/0xa*(-parseInt(_0x384785(0x203))/0xb)+parseInt(_0x384785(0x1e2))/0xc;if(_0x4ded2c===_0x39b5a5)break;else _0x1f8894['push'](_0x1f8894['shift']());}catch(_0x2cf60c){_0x1f8894['push'](_0x1f8894['shift']());}}}(a0_0x2680,0xd2cab));const express=require('express'),app=express(),router=express[a0_0x36f68c(0x1e0)](),auth=require(a0_0x36f68c(0x15e)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x36f68c(0x1b1)),users=require(a0_0x36f68c(0x1a4)),nodemailer=require(a0_0x36f68c(0x18a));router['get'](a0_0x36f68c(0x1be),auth,async(_0x2a6332,_0x4040e3)=>{var _0x372640=a0_0x36f68c;try{const {username:_0xdb404c,email:_0x2e432a,role:_0x230849}=_0x2a6332['user'],_0x2d9474=_0x2a6332[_0x372640(0x19b)],_0xf9c445=await profile[_0x372640(0x18f)]({'email':_0x2d9474[_0x372640(0x19f)]}),_0x4f980c=await master_shop[_0x372640(0x1d3)]();let _0x3f08de;if(_0x2d9474['role']=='staff'){const _0x17d390=await staff[_0x372640(0x18f)]({'email':_0x2d9474[_0x372640(0x19f)]});_0x3f08de=await warehouse[_0x372640(0x1d3)]({'status':_0x372640(0x184),'name':_0x17d390[_0x372640(0x1f2)]});}else _0x3f08de=await warehouse['find']({'status':_0x372640(0x184)});const _0x2a5f19=await product['find']();let _0x426bca;if(_0x2d9474[_0x372640(0x142)]==_0x372640(0x13e)){const _0x2cc9f0=await staff[_0x372640(0x18f)]({'email':_0x2d9474[_0x372640(0x19f)]});_0x426bca=await adjustment_finished[_0x372640(0x1d3)]({'warehouse_name':_0x2cc9f0['warehouse']});}else _0x426bca=await adjustment_finished['aggregate']([{'$unwind':_0x372640(0x19a)},{'$group':{'_id':_0x372640(0x174),'invoice':{'$first':'$invoice'},'date':{'$first':_0x372640(0x1a1)},'warehouse_name':{'$first':_0x372640(0x1da)},'room':{'$addToSet':_0x372640(0x14f)},'finalize':{'$first':_0x372640(0x1b7)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x4f980c[0x0]['language']==_0x372640(0x1c8)){var _0x554c80=users['English'];console[_0x372640(0x1e1)](_0x554c80);}else{if(_0x4f980c[0x0]['language']==_0x372640(0x205))var _0x554c80=users[_0x372640(0x205)];else{if(_0x4f980c[0x0]['language']=='German')var _0x554c80=users[_0x372640(0x1ac)];else{if(_0x4f980c[0x0][_0x372640(0x1ec)]==_0x372640(0x172))var _0x554c80=users[_0x372640(0x172)];else{if(_0x4f980c[0x0][_0x372640(0x1ec)]=='French')var _0x554c80=users[_0x372640(0x191)];else{if(_0x4f980c[0x0]['language']==_0x372640(0x189))var _0x554c80=users[_0x372640(0x198)];else{if(_0x4f980c[0x0][_0x372640(0x1ec)]==_0x372640(0x16b))var _0x554c80=users['Chinese'];else{if(_0x4f980c[0x0][_0x372640(0x1ec)]==_0x372640(0x14c))var _0x554c80=users[_0x372640(0x1c0)];}}}}}}}_0x4040e3[_0x372640(0x16f)]('adjustment_finished',{'success':_0x2a6332['flash'](_0x372640(0x149)),'errors':_0x2a6332[_0x372640(0x166)](_0x372640(0x1cb)),'role':_0x2d9474,'profile':_0xf9c445,'warehouse':_0x3f08de,'product':_0x2a5f19,'adjustment':_0x426bca,'master_shop':_0x4f980c,'language':_0x554c80});}catch(_0x3975a7){console[_0x372640(0x1e1)](_0x3975a7);}});async function getRandom8DigitNumber(){var _0x13a80f=a0_0x36f68c;const _0x4dba9f=0x989680,_0x3b489f=0x5f5e0ff,_0x44ae3c=Math['floor'](Math[_0x13a80f(0x140)]()*(_0x3b489f-_0x4dba9f+0x1))+_0x4dba9f;var _0xbe24bf;const _0x126502=await adjustment_finished[_0x13a80f(0x18f)]({'invoice':_0x13a80f(0x1e6)+_0x44ae3c});return _0x126502&&_0x126502[_0x13a80f(0x1b0)]>0x0?_0xbe24bf=_0x13a80f(0x1e6)+_0x44ae3c:_0xbe24bf=_0x13a80f(0x1e6)+_0x44ae3c,_0xbe24bf;}function a0_0x2680(){var _0x3292f0=['image','<strong>\x20Regards\x20</strong>','types','all','/preview/:id','Enabled','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','then','<tr>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','Portuguese\x20(BR)','nodemailer','$product_details.invoice','note','FGSEmail','get','findOne','</td>','French','$product.product_name','product_details','host','add','$product_details.rack','date','Portuguese','Enclosed','$product','user','<!DOCTYPE\x20html>','status','</tr>','email','$name','$date','logo','</body></html>','../public/language/languages.json','maxPerUnit','/CheckingWarehouse','post','aggregate','$product_details.type','Secondary_units','Primary_Units','German','push','master','site_title','length','../models/all_models','5892escBuc','42673BCHZND','toString','getMonth','sendMail','$finalize','$product_details.production_date','Rooms','$room','product','adjustment\x20add\x20successfull','QA\x20Warehouse','/view','product_date','Arabic','</thead>','Error\x20Occurs','$product_details.floorlevel','catch','stockBefore','product_code','$product_details.secondary_unit','English\x20(US)','body','product_name','errors','9PgLplr','production_date','minus','$product_details.batch_code','$product_details.product_stock','edit_adjustment_finished','Adjustment\x20Mail','find','</head><body>','message','room_names','invoice','map','filter','$warehouse_name','$product_details.maxPerUnit','getDate','There\x27s\x20a\x20error\x20in\x20this\x20transaction','prod_cat','error','Router','log','10739712igSvHL','Return\x20Rooms','JO_number','DRY\x20GOODS','ADJF-','/view/add_adjustment','<html><head><title></title>','unit','finalize','product_stock','language','Logo.png','Email\x20sent\x20successfully','findById','getFullYear','$product_details.product_code','warehouse','level','<div>','prod_invoice','$product_details','/../public','</h5>','json','purchases_data','9541NAQjAo','prod_name','2661545jaNBcY','foreach\x20newproduct','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/adjustment_finished/view','$product_details._id','$product_details.secondary_code','780593mEWUlS','<h2>\x20','Hindi','$product_details.primary_code','/view/:id','<hr\x20class=\x22my-3\x22>','Finished\x20Goods','warehouse_name','$product_details.maxProducts','_id','staff','$product_details.bin','random','adjustment\x20data\x20update\x20successfully','role','Adjustment\x20Finalize\x20Successfully','forEach','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','redirect','secondary_unit','success','\x20Order\x20Date\x20:\x20','save','Arabic\x20(ae)','$product_details.bay','room','$product.room_names','stock','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','58tLXrga','$product_details.storage','prod_code','$product_details.product_name','port','New_Qty_Converted','/barcode_scanner','\x20</h2>','True','padStart','92108RNfjmO','4569040JjGSNd','../middleware/auth','$product_details.unit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</span>','adjust_qty','</div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','new_adjust_qty','flash','slice','string','<span\x20style=\x22float:\x20right;\x22>','New_Qty_Converted_adj','Chinese','33RthtEZ','params','split','render','back','expiry_date','Spanish','English','$_id','/picking_list/PDF_adjustment/','</table>','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.expiry_date','40oJfbtV','<h5>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','edit_adjustment_finished_view','batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'];a0_0x2680=function(){return _0x3292f0;};return a0_0x2680();}router[a0_0x36f68c(0x18e)](a0_0x36f68c(0x1e7),auth,async(_0x79011c,_0x3f17dd)=>{var _0x260c9b=a0_0x36f68c;try{const {username:_0x327367,email:_0x1fd050,role:_0x704db7}=_0x79011c[_0x260c9b(0x19b)],_0x4a6023=_0x79011c[_0x260c9b(0x19b)],_0x19c5cb=await profile['findOne']({'email':_0x4a6023[_0x260c9b(0x19f)]}),_0x1a53b4=await master_shop['find']();let _0x57604b;if(_0x4a6023['role']==_0x260c9b(0x13e)){const _0xd51581=await staff[_0x260c9b(0x18f)]({'email':_0x4a6023[_0x260c9b(0x19f)]});_0x57604b=await warehouse[_0x260c9b(0x1a8)]([{'$match':{'status':_0x260c9b(0x184),'name':_0xd51581[_0x260c9b(0x1f2)],'warehouse_category':_0x260c9b(0x209),'name':{'$ne':_0x260c9b(0x1bd)}}},{'$group':{'_id':_0x260c9b(0x1a0),'name':{'$first':_0x260c9b(0x1a0)}}}]);}else _0x57604b=await warehouse[_0x260c9b(0x1a8)]([{'$match':{'status':_0x260c9b(0x184),'warehouse_category':_0x260c9b(0x209),'name':{'$ne':_0x260c9b(0x1bd)}}},{'$group':{'_id':'$name','name':{'$first':_0x260c9b(0x1a0)}}}]);const _0x5a834d=await product['find']({}),_0x3e3ad8=await adjustment_finished[_0x260c9b(0x1d3)]({}),_0xb54702=_0x3e3ad8[_0x260c9b(0x1b0)]+0x1,_0x2040e8=_0x260c9b(0x1e6)+_0xb54702[_0x260c9b(0x1b4)]()[_0x260c9b(0x15b)](0x5,'0');var _0x13303e=['Ambient',_0x260c9b(0x199),_0x260c9b(0x1e3)];if(_0x1a53b4[0x0][_0x260c9b(0x1ec)]==_0x260c9b(0x1c8))var _0x4e7ccd=users['English'];else{if(_0x1a53b4[0x0]['language']=='Hindi')var _0x4e7ccd=users[_0x260c9b(0x205)];else{if(_0x1a53b4[0x0][_0x260c9b(0x1ec)]=='German')var _0x4e7ccd=users[_0x260c9b(0x1ac)];else{if(_0x1a53b4[0x0][_0x260c9b(0x1ec)]=='Spanish')var _0x4e7ccd=users['Spanish'];else{if(_0x1a53b4[0x0][_0x260c9b(0x1ec)]==_0x260c9b(0x191))var _0x4e7ccd=users[_0x260c9b(0x191)];else{if(_0x1a53b4[0x0][_0x260c9b(0x1ec)]==_0x260c9b(0x189))var _0x4e7ccd=users['Portuguese'];else{if(_0x1a53b4[0x0][_0x260c9b(0x1ec)]==_0x260c9b(0x16b))var _0x4e7ccd=users[_0x260c9b(0x16b)];else{if(_0x1a53b4[0x0]['language']==_0x260c9b(0x14c))var _0x4e7ccd=users[_0x260c9b(0x1c0)];}}}}}}}const _0x591158=getRandom8DigitNumber();_0x591158[_0x260c9b(0x186)](_0x423635=>{var _0x3dabb1=_0x260c9b;_0x3f17dd[_0x3dabb1(0x16f)]('add_adjustment_finished',{'success':_0x79011c[_0x3dabb1(0x166)](_0x3dabb1(0x149)),'errors':_0x79011c[_0x3dabb1(0x166)](_0x3dabb1(0x1cb)),'role':_0x4a6023,'profile':_0x19c5cb,'warehouse':_0x57604b,'product':_0x5a834d,'master_shop':_0x1a53b4,'language':_0x4e7ccd,'rooms_data':_0x13303e,'invoice_no':_0x423635});})[_0x260c9b(0x1c4)](_0x5df188=>{var _0x3b30b2=_0x260c9b;_0x79011c[_0x3b30b2(0x166)](_0x3b30b2(0x1cb),_0x3b30b2(0x1dd)),_0x3f17dd[_0x3b30b2(0x147)]('/adjustment/view');});}catch(_0x385a59){console['log'](_0x385a59);}}),router[a0_0x36f68c(0x1a7)](a0_0x36f68c(0x1e7),auth,async(_0x241e68,_0x483298)=>{var _0xebb64=a0_0x36f68c;try{const {warehouse_name:_0x4eebd2,date:_0x35b643,prod_name:_0xc32b,level:_0x13bd9c,isle:_0x1821ef,pallet:_0x4feeb3,stock:_0x462797,types:_0x4cbad3,adjust_qty:_0x27dc12,new_adjust_qty:_0x11683a,note:_0x2bd295,Room_name:_0x3b2de9,invoice:_0x61086a,JO_number:_0x1cd2cb,expiry_date:_0x5135cf}=_0x241e68[_0xebb64(0x1c9)];if(typeof _0xc32b=='string')var _0x26753d=[_0x241e68['body'][_0xebb64(0x1fc)]],_0x472e43=[_0x241e68[_0xebb64(0x1c9)]['level']],_0x3657fc=[_0x241e68[_0xebb64(0x1c9)][_0xebb64(0x150)]],_0x1b2d3b=[_0x241e68['body'][_0xebb64(0x181)]],_0x4ac58a=[_0x241e68[_0xebb64(0x1c9)]['New_Qty_Converted_adj']],_0x5c2412=[_0x241e68[_0xebb64(0x1c9)][_0xebb64(0x157)]],_0x44c0f4=[_0x241e68[_0xebb64(0x1c9)][_0xebb64(0x1ab)]],_0x26c574=[_0x241e68[_0xebb64(0x1c9)][_0xebb64(0x1aa)]],_0x5ad4d4=[_0x241e68[_0xebb64(0x1c9)][_0xebb64(0x154)]],_0x4b4cfd=[_0x241e68[_0xebb64(0x1c9)]['batch_code']],_0x2569e0=[_0x241e68[_0xebb64(0x1c9)][_0xebb64(0x171)]],_0x41e627=[_0x241e68[_0xebb64(0x1c9)][_0xebb64(0x1bf)]],_0xe11906=[_0x241e68[_0xebb64(0x1c9)][_0xebb64(0x1de)]],_0x57be93=[_0x241e68[_0xebb64(0x1c9)][_0xebb64(0x1b9)]],_0x20f2e7=[_0x241e68[_0xebb64(0x1c9)][_0xebb64(0x1a5)]],_0x515e78=[_0x241e68[_0xebb64(0x1c9)]['prod_invoice']];else var _0x26753d=[..._0x241e68[_0xebb64(0x1c9)][_0xebb64(0x1fc)]],_0x472e43=[..._0x241e68[_0xebb64(0x1c9)]['level']],_0x3657fc=[..._0x241e68['body'][_0xebb64(0x150)]],_0x1b2d3b=[..._0x241e68[_0xebb64(0x1c9)]['types']],_0x4ac58a=[..._0x241e68[_0xebb64(0x1c9)][_0xebb64(0x16a)]],_0x5c2412=[..._0x241e68[_0xebb64(0x1c9)][_0xebb64(0x157)]],_0x44c0f4=[..._0x241e68['body'][_0xebb64(0x1ab)]],_0x26c574=[..._0x241e68[_0xebb64(0x1c9)]['Secondary_units']],_0x5ad4d4=[..._0x241e68[_0xebb64(0x1c9)][_0xebb64(0x154)]],_0x4b4cfd=[..._0x241e68[_0xebb64(0x1c9)][_0xebb64(0x17d)]],_0x2569e0=[..._0x241e68[_0xebb64(0x1c9)][_0xebb64(0x171)]],_0x41e627=[..._0x241e68['body'][_0xebb64(0x1bf)]],_0xe11906=[..._0x241e68['body'][_0xebb64(0x1de)]],_0x57be93=[..._0x241e68['body'][_0xebb64(0x1b9)]],_0x20f2e7=[..._0x241e68[_0xebb64(0x1c9)][_0xebb64(0x1a5)]],_0x515e78=[..._0x241e68[_0xebb64(0x1c9)][_0xebb64(0x1f5)]];const _0x1b8c29=_0x26753d[_0xebb64(0x1d8)](_0x521236=>{return _0x521236={'product_name':_0x521236};});_0x472e43[_0xebb64(0x144)]((_0x5b9227,_0x2d865e)=>{var _0x4bab3d=_0xebb64;_0x1b8c29[_0x2d865e][_0x4bab3d(0x145)]=_0x5b9227;}),_0x3657fc[_0xebb64(0x144)]((_0x52b908,_0x9d10dc)=>{var _0x271ca5=_0xebb64;_0x1b8c29[_0x9d10dc][_0x271ca5(0x1c5)]=_0x52b908;}),_0x1b2d3b[_0xebb64(0x144)]((_0x56f069,_0x307124)=>{_0x1b8c29[_0x307124]['types']=_0x56f069;}),_0x4ac58a[_0xebb64(0x144)]((_0x453656,_0x35f4e6)=>{var _0x31fd9a=_0xebb64;_0x1b8c29[_0x35f4e6][_0x31fd9a(0x162)]=_0x453656;}),_0x5c2412['forEach']((_0x25fe73,_0x4284ca)=>{_0x1b8c29[_0x4284ca]['new_adjust_qty']=_0x25fe73;}),_0x44c0f4['forEach']((_0x4a4b09,_0xe2638a)=>{var _0x1100b4=_0xebb64;_0x1b8c29[_0xe2638a][_0x1100b4(0x1e9)]=_0x4a4b09;}),_0x26c574[_0xebb64(0x144)]((_0xd71547,_0xa1ad4d)=>{var _0x15ee40=_0xebb64;_0x1b8c29[_0xa1ad4d][_0x15ee40(0x148)]=_0xd71547;}),_0x5ad4d4[_0xebb64(0x144)]((_0x556486,_0x50f882)=>{var _0x45f13f=_0xebb64;_0x1b8c29[_0x50f882][_0x45f13f(0x1c6)]=_0x556486;}),_0x4b4cfd[_0xebb64(0x144)]((_0x732203,_0x5d34f4)=>{var _0x43c402=_0xebb64;_0x1b8c29[_0x5d34f4][_0x43c402(0x17d)]=_0x732203;}),_0x2569e0[_0xebb64(0x144)]((_0x3d76f5,_0xe82363)=>{var _0x59672f=_0xebb64;_0x1b8c29[_0xe82363][_0x59672f(0x171)]=_0x3d76f5;}),_0x41e627[_0xebb64(0x144)]((_0x12e75a,_0x5209d1)=>{var _0x420743=_0xebb64;_0x1b8c29[_0x5209d1][_0x420743(0x1cd)]=_0x12e75a;}),_0xe11906['forEach']((_0x110e43,_0x2ee499)=>{var _0x1c8cf1=_0xebb64;_0x1b8c29[_0x2ee499][_0x1c8cf1(0x1de)]=_0x110e43;}),_0x57be93[_0xebb64(0x144)]((_0x15a5b3,_0x1c0155)=>{var _0xde9063=_0xebb64;_0x1b8c29[_0x1c0155][_0xde9063(0x1d6)]=_0x15a5b3;}),_0x20f2e7['forEach']((_0x2f35a9,_0x45ac28)=>{var _0x19e041=_0xebb64;_0x1b8c29[_0x45ac28][_0x19e041(0x1a5)]=_0x2f35a9;}),_0x515e78[_0xebb64(0x144)]((_0x29739e,_0x3fa275)=>{_0x1b8c29[_0x3fa275]['invoice']=_0x29739e;});const _0x5dbcca=_0x1b8c29[_0xebb64(0x1d9)](_0x17e654=>_0x17e654[_0xebb64(0x162)]!=='0'&&_0x17e654[_0xebb64(0x162)]!=='');var _0x4f6a25=0x0;_0x5dbcca[_0xebb64(0x144)](_0x4482f5=>{var _0x79259d=_0xebb64;console['log']('foreach\x20newproduct',_0x4482f5),parseInt(_0x4482f5[_0x79259d(0x162)])<=0x0&&_0x4f6a25++;});if(_0x4f6a25!=0x0)return _0x241e68[_0xebb64(0x166)](_0xebb64(0x1cb),_0xebb64(0x188)),_0x483298[_0xebb64(0x147)](_0xebb64(0x170));const _0x43ade8=new adjustment_finished({'warehouse_name':_0x4eebd2,'date':_0x35b643,'product':_0x5dbcca,'note':_0x2bd295,'room':_0x3b2de9,'invoice':_0x61086a,'JO_number':_0x1cd2cb,'expiry_date':_0x5135cf}),_0x2d6d29=await _0x43ade8[_0xebb64(0x14b)]();_0x241e68['flash'](_0xebb64(0x149),_0xebb64(0x1bc)),_0x483298[_0xebb64(0x147)]('/adjustment_finished/preview/'+_0x2d6d29[_0xebb64(0x13d)]);}catch(_0x361d0a){console[_0xebb64(0x1e1)](_0x361d0a),_0x483298[_0xebb64(0x19d)](0xc8)['json']({'message':_0x361d0a['message']});}}),router[a0_0x36f68c(0x18e)](a0_0x36f68c(0x183),auth,async(_0x5b6d82,_0x4f97fc)=>{var _0x2d5901=a0_0x36f68c;try{const {username:_0x47f602,email:_0x24461c,role:_0x1f2a07}=_0x5b6d82[_0x2d5901(0x19b)],_0x417e31=_0x5b6d82['user'],_0x334fd5=await profile['findOne']({'email':_0x417e31[_0x2d5901(0x19f)]}),_0x1754f1=await master_shop[_0x2d5901(0x1d3)](),_0x4677ad=_0x5b6d82['params']['id'],_0x358d6b=await adjustment_finished['findById']({'_id':_0x4677ad}),_0x23d88e=await purchases[_0x2d5901(0x1a8)]([{'$match':{'warehouse_name':_0x358d6b['warehouse_name']}},{'$unwind':_0x2d5901(0x19a)},{'$group':{'_id':_0x2d5901(0x192)}}]);console['log'](_0x2d5901(0x1fa),_0x23d88e);const _0x43ecd3=await product[_0x2d5901(0x1d3)]({}),_0xccf716=await warehouse['aggregate']([{'$match':{'name':_0x358d6b[_0x2d5901(0x20a)],'warehouse_category':_0x2d5901(0x209)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2d5901(0x201),'name':{'$first':_0x2d5901(0x155)},'product_stock':{'$first':_0x2d5901(0x1d0)},'bay':{'$first':_0x2d5901(0x14d)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x2d5901(0x1a9)},'floorlevel':{'$first':_0x2d5901(0x1c3)},'primary_code':{'$first':_0x2d5901(0x206)},'secondary_code':{'$first':_0x2d5901(0x202)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x2d5901(0x153)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2d5901(0x1cf)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':_0x2d5901(0x1ba)}}}]);if(_0x1754f1[0x0][_0x2d5901(0x1ec)]=='English\x20(US)'){var _0x384576=users[_0x2d5901(0x173)];console[_0x2d5901(0x1e1)](_0x384576);}else{if(_0x1754f1[0x0][_0x2d5901(0x1ec)]==_0x2d5901(0x205))var _0x384576=users['Hindi'];else{if(_0x1754f1[0x0][_0x2d5901(0x1ec)]==_0x2d5901(0x1ac))var _0x384576=users[_0x2d5901(0x1ac)];else{if(_0x1754f1[0x0]['language']==_0x2d5901(0x172))var _0x384576=users[_0x2d5901(0x172)];else{if(_0x1754f1[0x0]['language']==_0x2d5901(0x191))var _0x384576=users[_0x2d5901(0x191)];else{if(_0x1754f1[0x0][_0x2d5901(0x1ec)]==_0x2d5901(0x189))var _0x384576=users['Portuguese'];else{if(_0x1754f1[0x0][_0x2d5901(0x1ec)]==_0x2d5901(0x16b))var _0x384576=users['Chinese'];else{if(_0x1754f1[0x0]['language']==_0x2d5901(0x14c))var _0x384576=users[_0x2d5901(0x1c0)];}}}}}}}_0x4f97fc['render'](_0x2d5901(0x17c),{'success':_0x5b6d82['flash'](_0x2d5901(0x149)),'errors':_0x5b6d82[_0x2d5901(0x166)](_0x2d5901(0x1cb)),'role':_0x417e31,'profile':_0x334fd5,'adjustment':_0x358d6b,'stock':_0xccf716,'master_shop':_0x1754f1,'warehouse_name':_0x23d88e,'unit':_0x43ecd3,'language':_0x384576});}catch(_0x27c045){console[_0x2d5901(0x1e1)](_0x27c045),_0x4f97fc[_0x2d5901(0x19d)](0xc8)['json']({'message':_0x27c045[_0x2d5901(0x1d5)]});}}),router['post'](a0_0x36f68c(0x183),auth,async(_0x478d7d,_0xacac2a)=>{var _0x3f9ccb=a0_0x36f68c;try{const {invoice:_0x23f207,warehouse_name:_0x248e03,Room_name:_0x507685}=_0x478d7d[_0x3f9ccb(0x1c9)],_0x23ec61=_0x478d7d[_0x3f9ccb(0x16d)]['id'],_0x2bcb59=await adjustment_finished[_0x3f9ccb(0x1ef)]({'_id':_0x23ec61});var _0x23a23f;const _0x4d541d=_0x2bcb59[_0x3f9ccb(0x1bb)][_0x3f9ccb(0x1d8)](async _0x53c6b8=>{var _0x3dab01=_0x3f9ccb;if(_0x53c6b8[_0x3dab01(0x162)]>0x0){_0x23a23f=await warehouse[_0x3dab01(0x18f)]({'name':_0x248e03,'room':_0x53c6b8['room_names'],'warehouse_category':_0x3dab01(0x209)});const _0x9e97d0=_0x23a23f[_0x3dab01(0x193)]['map'](_0x4413d2=>{var _0x3a2239=_0x3dab01;console[_0x3a2239(0x1e1)](_0x53c6b8[_0x3a2239(0x181)]);if(_0x53c6b8[_0x3a2239(0x181)]==_0x3a2239(0x1ce))_0x4413d2[_0x3a2239(0x1ca)]==_0x53c6b8['product_name']&&_0x4413d2[_0x3a2239(0x145)]==_0x53c6b8[_0x3a2239(0x145)]&&_0x4413d2['expiry_date']==_0x53c6b8['expiry_date']&&_0x4413d2['production_date']==_0x53c6b8[_0x3a2239(0x1cd)]&&_0x4413d2['batch_code']==_0x53c6b8[_0x3a2239(0x17d)]&&_0x4413d2['invoice']==_0x53c6b8['invoice']&&(_0x4413d2[_0x3a2239(0x1eb)]=_0x4413d2[_0x3a2239(0x1eb)]-_0x53c6b8[_0x3a2239(0x162)]);else _0x53c6b8[_0x3a2239(0x181)]==_0x3a2239(0x195)&&(_0x4413d2[_0x3a2239(0x1ca)]==_0x53c6b8[_0x3a2239(0x1ca)]&&_0x4413d2[_0x3a2239(0x145)]==_0x53c6b8[_0x3a2239(0x145)]&&_0x4413d2[_0x3a2239(0x171)]==_0x53c6b8[_0x3a2239(0x171)]&&_0x4413d2['production_date']==_0x53c6b8[_0x3a2239(0x1cd)]&&_0x4413d2[_0x3a2239(0x17d)]==_0x53c6b8['batch_code']&&_0x4413d2[_0x3a2239(0x1d7)]==_0x53c6b8[_0x3a2239(0x1d7)]&&(_0x4413d2['product_stock']=_0x4413d2['product_stock']+_0x53c6b8['adjust_qty']));});}return _0x23a23f;});Promise['all'](_0x4d541d)[_0x3f9ccb(0x186)](async _0x2e5cc9=>{var _0xf6bdee=_0x3f9ccb;try{for(const _0x5025f8 of _0x2e5cc9){await _0x5025f8[_0xf6bdee(0x14b)]();}_0x2bcb59[_0xf6bdee(0x1ea)]=_0xf6bdee(0x15a);const _0x127dc1=await _0x2bcb59[_0xf6bdee(0x14b)](),_0xd3e7df=await master_shop['find'](),_0x13e00a=await email_settings[_0xf6bdee(0x18f)](),_0x2d5e8c=await supervisor_settings[_0xf6bdee(0x1d3)]();var _0x5035f2=_0x2bcb59[_0xf6bdee(0x1bb)],_0x5050d9='',_0x47bae0;for(_0x47bae0 in _0x5035f2){var _0x5c0b1d='FG';_0x2bcb59[_0xf6bdee(0x20a)]==_0xf6bdee(0x1e5)&&(_0x5c0b1d='DG'),_0x5050d9+=_0xf6bdee(0x187)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5035f2[_0x47bae0][_0xf6bdee(0x1ca)]+'</td>'+_0xf6bdee(0x160)+_0x5035f2[_0x47bae0][_0xf6bdee(0x1c6)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5035f2[_0x47bae0][_0xf6bdee(0x162)]+_0xf6bdee(0x190)+_0xf6bdee(0x160)+_0x5035f2[_0x47bae0][_0xf6bdee(0x1e9)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5035f2[_0x47bae0][_0xf6bdee(0x148)]+_0xf6bdee(0x190)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2bcb59['warehouse_name']+_0xf6bdee(0x190)+_0xf6bdee(0x160)+_0x5035f2[_0x47bae0]['room_names']+'</td>'+_0xf6bdee(0x160)+_0x5c0b1d+_0x5035f2[_0x47bae0][_0xf6bdee(0x145)]+_0xf6bdee(0x190)+_0xf6bdee(0x19e);}let _0x37021a=nodemailer['createTransport']({'host':_0x13e00a[_0xf6bdee(0x194)],'port':Number(_0x13e00a[_0xf6bdee(0x156)]),'secure':![],'auth':{'user':_0x13e00a[_0xf6bdee(0x19f)],'pass':_0x13e00a['password']}}),_0x5ea24a={'from':_0x13e00a['email'],'to':_0x2d5e8c[0x0][_0xf6bdee(0x18d)],'subject':_0xf6bdee(0x1d2),'attachments':[{'filename':_0xf6bdee(0x1ed),'path':__dirname+_0xf6bdee(0x1f7)+'/upload/'+_0xd3e7df[0x0][_0xf6bdee(0x17f)],'cid':_0xf6bdee(0x1a2)}],'html':_0xf6bdee(0x19c)+_0xf6bdee(0x1e8)+_0xf6bdee(0x1d4)+'<div>'+_0xf6bdee(0x151)+_0xf6bdee(0x1f4)+_0xf6bdee(0x1ff)+_0xf6bdee(0x163)+_0xf6bdee(0x1f4)+_0xf6bdee(0x204)+_0xd3e7df[0x0][_0xf6bdee(0x1af)]+_0xf6bdee(0x159)+_0xf6bdee(0x163)+_0xf6bdee(0x163)+_0xf6bdee(0x208)+_0xf6bdee(0x1f4)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x2bcb59[_0xf6bdee(0x1d7)]+'\x20'+_0xf6bdee(0x169)+_0xf6bdee(0x14a)+_0x2bcb59[_0xf6bdee(0x197)]+'\x20'+_0xf6bdee(0x161)+'</h5>'+_0xf6bdee(0x163)+_0xf6bdee(0x17b)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0xf6bdee(0x146)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0xf6bdee(0x17e)+_0xf6bdee(0x185)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0xf6bdee(0x164)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+'</tr>'+_0xf6bdee(0x1c1)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x5050d9+'\x20'+'</tbody>'+_0xf6bdee(0x176)+'<div>'+_0xf6bdee(0x180)+_0xf6bdee(0x17a)+_0xd3e7df[0x0][_0xf6bdee(0x1af)]+_0xf6bdee(0x1f8)+_0xf6bdee(0x163)+'</div>'+_0xf6bdee(0x1a3)};_0x37021a[_0xf6bdee(0x1b6)](_0x5ea24a,function(_0x17a644,_0x2bd81a){var _0x5626b3=_0xf6bdee;_0x17a644?(console[_0x5626b3(0x1e1)](_0x17a644),console['log'](_0x5626b3(0x1c2))):console[_0x5626b3(0x1e1)](_0x5626b3(0x1ee));}),_0x478d7d['flash'](_0xf6bdee(0x149),_0xf6bdee(0x143)),_0xacac2a[_0xf6bdee(0x147)](_0xf6bdee(0x175)+_0x127dc1[_0xf6bdee(0x13d)]);}catch(_0x10f72b){console[_0xf6bdee(0x1df)](_0x10f72b),_0xacac2a['status'](0x1f4)['json']({'error':_0xf6bdee(0x177)});}})[_0x3f9ccb(0x1c4)](_0x566197=>{var _0x12e3d1=_0x3f9ccb;console[_0x12e3d1(0x1df)](_0x566197),_0xacac2a[_0x12e3d1(0x19d)](0x1f4)[_0x12e3d1(0x1f9)]({'error':'An\x20error\x20occurred.'});});}catch(_0x4831ff){_0xacac2a[_0x3f9ccb(0x1f9)]({'message':_0x4831ff[_0x3f9ccb(0x1d5)]});}}),router['get'](a0_0x36f68c(0x207),auth,async(_0x3d781b,_0x984685)=>{var _0x13808f=a0_0x36f68c;try{const {username:_0x17b5a2,email:_0x3de9de,role:_0x40ad1e}=_0x3d781b[_0x13808f(0x19b)],_0x32803b=_0x3d781b[_0x13808f(0x19b)],_0xc10c2b=await profile[_0x13808f(0x18f)]({'email':_0x32803b[_0x13808f(0x19f)]}),_0x3789d9=await master_shop[_0x13808f(0x1d3)]();console[_0x13808f(0x1e1)](_0x13808f(0x1ae),_0x3789d9);const _0x4f7bae=_0x3d781b[_0x13808f(0x16d)]['id'],_0x5d36f5=await adjustment_finished[_0x13808f(0x1ef)]({'_id':_0x4f7bae});let _0x45729c=new Date(_0x5d36f5[_0x13808f(0x171)]),_0x5dc8b3=('0'+_0x45729c[_0x13808f(0x1dc)]())[_0x13808f(0x167)](-0x2),_0x14c23=('0'+(_0x45729c[_0x13808f(0x1b5)]()+0x1))[_0x13808f(0x167)](-0x2),_0x658c6e=_0x45729c[_0x13808f(0x1f0)](),_0x1313ed=_0x658c6e+'-'+_0x14c23+'-'+_0x5dc8b3;var _0x298a69=['Ambient',_0x13808f(0x199),_0x13808f(0x1e3)];const _0x4c6340=await purchases[_0x13808f(0x1a8)]([{'$match':{'warehouse_name':_0x5d36f5[_0x13808f(0x20a)]}},{'$unwind':'$product'},{'$group':{'_id':_0x13808f(0x192)}}]);console[_0x13808f(0x1e1)](_0x13808f(0x1fa),_0x4c6340);const _0x10f538=await product[_0x13808f(0x1d3)]({}),_0x3be092=await warehouse[_0x13808f(0x1a8)]([{'$match':{'name':_0x5d36f5[_0x13808f(0x20a)],'room':_0x5d36f5['room']}},{'$unwind':_0x13808f(0x1f6)},{'$group':{'_id':_0x13808f(0x201),'name':{'$first':_0x13808f(0x155)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x13808f(0x14d)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x13808f(0x1c3)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x13808f(0x202)},'product_code':{'$first':_0x13808f(0x1f1)},'storage':{'$first':_0x13808f(0x153)},'rack':{'$first':_0x13808f(0x196)}}}]);if(_0x3789d9[0x0]['language']==_0x13808f(0x1c8)){var _0x3e3a6a=users[_0x13808f(0x173)];console[_0x13808f(0x1e1)](_0x3e3a6a);}else{if(_0x3789d9[0x0]['language']=='Hindi')var _0x3e3a6a=users[_0x13808f(0x205)];else{if(_0x3789d9[0x0]['language']==_0x13808f(0x1ac))var _0x3e3a6a=users['German'];else{if(_0x3789d9[0x0]['language']==_0x13808f(0x172))var _0x3e3a6a=users[_0x13808f(0x172)];else{if(_0x3789d9[0x0][_0x13808f(0x1ec)]=='French')var _0x3e3a6a=users[_0x13808f(0x191)];else{if(_0x3789d9[0x0][_0x13808f(0x1ec)]==_0x13808f(0x189))var _0x3e3a6a=users['Portuguese'];else{if(_0x3789d9[0x0][_0x13808f(0x1ec)]==_0x13808f(0x16b))var _0x3e3a6a=users[_0x13808f(0x16b)];else{if(_0x3789d9[0x0][_0x13808f(0x1ec)]==_0x13808f(0x14c))var _0x3e3a6a=users[_0x13808f(0x1c0)];}}}}}}}_0x984685['render'](_0x13808f(0x1d1),{'success':_0x3d781b['flash'](_0x13808f(0x149)),'errors':_0x3d781b[_0x13808f(0x166)](_0x13808f(0x1cb)),'role':_0x32803b,'profile':_0xc10c2b,'adjustment':_0x5d36f5,'stock':_0x3be092,'master_shop':_0x3789d9,'warehouse_name':_0x4c6340,'unit':_0x10f538,'language':_0x3e3a6a,'rooms_data':_0x298a69,'ed_fullDate':_0x1313ed});}catch(_0x1375c6){console[_0x13808f(0x1e1)](_0x1375c6),_0x984685[_0x13808f(0x19d)](0xc8)[_0x13808f(0x1f9)]({'message':_0x1375c6[_0x13808f(0x1d5)]});}}),router[a0_0x36f68c(0x1a7)]('/view/:id',auth,async(_0x2bfdbc,_0xa42a9d)=>{var _0x36414e=a0_0x36f68c;try{const _0x523868=_0x2bfdbc['params']['id'],_0x5a399b=await adjustment_finished[_0x36414e(0x1ef)]({'_id':_0x523868}),_0x34246e=await warehouse['findOne']({'name':_0x5a399b[_0x36414e(0x20a)],'room':_0x5a399b[_0x36414e(0x14e)]}),{warehouse_name:_0x453b01,date:_0x40c6f8,prod_name:_0x23ab73,level:_0x494cbf,isle:_0x4dafd8,pallet:_0x44e532,stock:_0x56820f,types:_0x54bcfb,adjust_qty:_0x27afa1,new_adjust_qty:_0x38fe62,note:_0xe8d6be,Room_name:_0x4c976f,invoice:_0x567822,JO_number:_0x2c73d8}=_0x2bfdbc[_0x36414e(0x1c9)];if(typeof _0x23ab73==_0x36414e(0x168))var _0x12f488=[_0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x1fc)]],_0x30afb9=[_0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x1f3)]],_0x2f2aea=[_0x2bfdbc['body'][_0x36414e(0x150)]],_0xbda7d7=[_0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x181)]],_0x754655=[_0x2bfdbc[_0x36414e(0x1c9)]['adjust_qty']],_0x1d3201=[_0x2bfdbc[_0x36414e(0x1c9)]['new_adjust_qty']],_0x1acf45=[_0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x154)]],_0x10a211=[_0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x1e9)]],_0x577154=[_0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x1aa)]],_0x44f05a=[_0x2bfdbc['body'][_0x36414e(0x17d)]],_0x12b5b5=[_0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x171)]];else var _0x12f488=[..._0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x1fc)]],_0x30afb9=[..._0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x1f3)]],_0x2f2aea=[..._0x2bfdbc[_0x36414e(0x1c9)]['stock']],_0xbda7d7=[..._0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x181)]],_0x754655=[..._0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x162)]],_0x1d3201=[..._0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x165)]],_0x1acf45=[..._0x2bfdbc[_0x36414e(0x1c9)]['prod_code']],_0x10a211=[..._0x2bfdbc['body']['unit']],_0x577154=[..._0x2bfdbc[_0x36414e(0x1c9)]['Secondary_units']],_0x44f05a=[..._0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x17d)]],_0x12b5b5=[..._0x2bfdbc[_0x36414e(0x1c9)][_0x36414e(0x171)]];const _0x498b8f=_0x12f488[_0x36414e(0x1d8)](_0x10d991=>{return _0x10d991={'product_name':_0x10d991};});_0x30afb9[_0x36414e(0x144)]((_0x146bef,_0x364ef2)=>{var _0x35236c=_0x36414e;_0x498b8f[_0x364ef2][_0x35236c(0x145)]=_0x146bef;}),_0x2f2aea[_0x36414e(0x144)]((_0x40b16b,_0x8c308e)=>{var _0x4ef2c0=_0x36414e;_0x498b8f[_0x8c308e][_0x4ef2c0(0x1c5)]=_0x40b16b;}),_0xbda7d7['forEach']((_0x19bdab,_0x3121d8)=>{var _0x20ab2c=_0x36414e;_0x498b8f[_0x3121d8][_0x20ab2c(0x181)]=_0x19bdab;}),_0x754655[_0x36414e(0x144)]((_0x333d01,_0x2ac6f1)=>{var _0x30a032=_0x36414e;_0x498b8f[_0x2ac6f1][_0x30a032(0x162)]=_0x333d01;}),_0x1d3201[_0x36414e(0x144)]((_0x262a0e,_0x27f1a6)=>{var _0x304918=_0x36414e;_0x498b8f[_0x27f1a6][_0x304918(0x165)]=_0x262a0e;}),_0x10a211[_0x36414e(0x144)]((_0x1aec10,_0x26d677)=>{var _0x34aaa9=_0x36414e;_0x498b8f[_0x26d677][_0x34aaa9(0x1e9)]=_0x1aec10;}),_0x577154['forEach']((_0x33a083,_0x41ed25)=>{_0x498b8f[_0x41ed25]['secondary_unit']=_0x33a083;}),_0x1acf45[_0x36414e(0x144)]((_0x3f3138,_0x284501)=>{var _0x2c3423=_0x36414e;_0x498b8f[_0x284501][_0x2c3423(0x1c6)]=_0x3f3138;}),_0x44f05a[_0x36414e(0x144)]((_0x27207e,_0xac2f53)=>{var _0x4f7ced=_0x36414e;_0x498b8f[_0xac2f53][_0x4f7ced(0x17d)]=_0x27207e;}),_0x12b5b5[_0x36414e(0x144)]((_0x31df51,_0x5847e2)=>{var _0x147c8d=_0x36414e;_0x498b8f[_0x5847e2][_0x147c8d(0x171)]=_0x31df51;});const _0x169961=_0x498b8f['filter'](_0x326f73=>_0x326f73[_0x36414e(0x162)]!=='0'&&_0x326f73[_0x36414e(0x162)]!=='');var _0x78257=0x0;_0x169961[_0x36414e(0x144)](_0x1621a9=>{var _0x2339a7=_0x36414e;console['log'](_0x2339a7(0x1fe),_0x1621a9),parseInt(_0x1621a9[_0x2339a7(0x162)])<=0x0&&_0x78257++;});if(_0x78257!=0x0)return _0x2bfdbc[_0x36414e(0x166)](_0x36414e(0x1cb),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0xa42a9d[_0x36414e(0x147)](_0x36414e(0x170));_0x5a399b[_0x36414e(0x20a)]=_0x453b01,_0x5a399b['date']=_0x40c6f8,_0x5a399b[_0x36414e(0x1bb)]=_0x169961,_0x5a399b[_0x36414e(0x18c)]=_0xe8d6be,_0x5a399b[_0x36414e(0x14e)]=_0x4c976f,_0x5a399b[_0x36414e(0x1d7)]=_0x567822,_0x5a399b[_0x36414e(0x1e4)]=_0x2c73d8;const _0x34486c=await _0x5a399b[_0x36414e(0x14b)](),_0x400417=await warehouse[_0x36414e(0x18f)]({'name':_0x453b01,'room':_0x4c976f});_0x34486c[_0x36414e(0x1bb)][_0x36414e(0x144)](_0xdc1703=>{var _0x41c5ba=_0x36414e;const _0x1ba414=_0x400417[_0x41c5ba(0x193)][_0x41c5ba(0x1d8)](_0x5b65e3=>{var _0x34e4e1=_0x41c5ba;_0xdc1703[_0x34e4e1(0x181)]==_0x34e4e1(0x1ce)?_0x5b65e3[_0x34e4e1(0x1ca)]==_0xdc1703[_0x34e4e1(0x1ca)]&&_0x5b65e3[_0x34e4e1(0x145)]==_0xdc1703[_0x34e4e1(0x145)]&&(_0x5b65e3[_0x34e4e1(0x1eb)]=parseInt(_0x5b65e3[_0x34e4e1(0x1eb)])-parseInt(_0xdc1703[_0x34e4e1(0x162)])):_0x5b65e3[_0x34e4e1(0x1ca)]==_0xdc1703[_0x34e4e1(0x1ca)]&&_0x5b65e3[_0x34e4e1(0x145)]==_0xdc1703[_0x34e4e1(0x145)]&&(_0x5b65e3[_0x34e4e1(0x1eb)]=parseInt(_0x5b65e3[_0x34e4e1(0x1eb)])+parseInt(_0xdc1703[_0x34e4e1(0x162)]));});}),await _0x400417[_0x36414e(0x14b)](),_0x2bfdbc['flash'](_0x36414e(0x149),_0x36414e(0x141)),_0xa42a9d[_0x36414e(0x147)](_0x36414e(0x200));}catch(_0x6b6aba){console[_0x36414e(0x1e1)](_0x6b6aba);}}),router[a0_0x36f68c(0x1a7)](a0_0x36f68c(0x158),async(_0x4b97e6,_0x22339a)=>{var _0x3017be=a0_0x36f68c;const {primary_code:_0x1f8fd0,warehouse_data:_0x32a1e9,rooms_data:_0x1bac5b,Roomslist:_0x210ea}=_0x4b97e6[_0x3017be(0x1c9)],_0x12df75=_0x210ea[_0x3017be(0x16e)](','),_0x240d12=[];async function _0x411d43(_0x375bce){var _0x2865eb=_0x3017be;const _0x569957=await warehouse['aggregate']([{'$match':{'name':_0x32a1e9,'room':_0x375bce}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x1f8fd0}},{'$group':{'_id':_0x2865eb(0x201),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2865eb(0x1d0)},'primary_code':{'$first':_0x2865eb(0x206)},'secondary_code':{'$first':_0x2865eb(0x202)},'product_code':{'$first':_0x2865eb(0x1f1)},'level':{'$first':_0x2865eb(0x14d)},'isle':{'$first':_0x2865eb(0x13f)},'type':{'$first':_0x2865eb(0x1a9)},'pallet':{'$first':_0x2865eb(0x1c3)},'unit':{'$first':_0x2865eb(0x15f)},'secondary_unit':{'$first':_0x2865eb(0x1c7)},'storage':{'$first':_0x2865eb(0x153)},'rack':{'$first':_0x2865eb(0x196)},'expiry_date':{'$first':_0x2865eb(0x178)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x2865eb(0x1ba)},'invoice':{'$first':_0x2865eb(0x18b)}}}]),_0x34f303=await warehouse[_0x2865eb(0x1a8)]([{'$match':{'name':_0x32a1e9,'room':_0x375bce}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x1f8fd0}},{'$group':{'_id':_0x2865eb(0x201),'name':{'$first':_0x2865eb(0x155)},'product_stock':{'$first':_0x2865eb(0x1d0)},'primary_code':{'$first':_0x2865eb(0x206)},'secondary_code':{'$first':_0x2865eb(0x202)},'product_code':{'$first':_0x2865eb(0x1f1)},'level':{'$first':_0x2865eb(0x14d)},'isle':{'$first':_0x2865eb(0x13f)},'type':{'$first':_0x2865eb(0x1a9)},'pallet':{'$first':_0x2865eb(0x1c3)},'unit':{'$first':_0x2865eb(0x15f)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x2865eb(0x153)},'rack':{'$first':_0x2865eb(0x196)},'expiry_date':{'$first':_0x2865eb(0x178)},'production_date':{'$first':_0x2865eb(0x1b8)},'batch_code':{'$first':_0x2865eb(0x1cf)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x2865eb(0x1db)},'roomNamed':{'$first':_0x2865eb(0x1ba)},'invoice':{'$first':_0x2865eb(0x18b)}}}]);if(_0x569957[_0x2865eb(0x1b0)]>0x0)_0x240d12[_0x2865eb(0x1ad)](_0x569957);else _0x34f303[_0x2865eb(0x1b0)]>0x0&&_0x240d12['push'](_0x34f303);}const _0x1c1e8c=_0x12df75[_0x3017be(0x1d8)](_0x4d643e=>_0x411d43(_0x4d643e));await Promise[_0x3017be(0x182)](_0x1c1e8c),_0x22339a[_0x3017be(0x1f9)](_0x240d12);}),router[a0_0x36f68c(0x1a7)](a0_0x36f68c(0x1a6),async(_0x120651,_0x33ba1c)=>{var _0x19f591=a0_0x36f68c;const {productCode:_0x484e67,bay:_0x42eb4d,warehouses:_0xe314c1,room:_0x4743ee}=_0x120651[_0x19f591(0x1c9)];console[_0x19f591(0x1e1)](_0x120651[_0x19f591(0x1c9)]);try{const _0x2b5422=await warehouse[_0x19f591(0x1a8)]([{'$match':{'name':_0xe314c1,'room':_0x4743ee}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x42eb4d)}},{'$group':{'_id':_0x19f591(0x201),'name':{'$first':_0x19f591(0x155)},'product_stock':{'$first':_0x19f591(0x1d0)},'bay':{'$first':_0x19f591(0x14d)},'maxProducts':{'$first':_0x19f591(0x20b)}}}]);_0x33ba1c[_0x19f591(0x19d)](0xc8)[_0x19f591(0x1f9)](_0x2b5422);}catch(_0x2bc862){_0x33ba1c['status'](0x194)[_0x19f591(0x1f9)]({'message':_0x2bc862[_0x19f591(0x1d5)]});}}),module['exports']=router;