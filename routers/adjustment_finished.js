function a0_0x3eae(){var _0x5a4024=['flash','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','product_details','</body></html>','2437050Dkyagj','length','$product_details.product_stock','$product.room_names','$product_details.bay','secondary_unit','</h5>','map','True','production_date','<h5>','$product_details.floorlevel','find','role','Portuguese\x20(BR)','log','/adjustment/view','Adjustment\x20Mail','express','padStart','$product_details.expiry_date','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','4BvbRcf','push','/view/:id','3321180qjsujn','slice','types','$product_details.product_name','status','prod_cat','Ambient','redirect','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.maxPerUnit','product_date','$product_details.storage','$name','<span\x20style=\x22float:\x20right;\x22>','/adjustment_finished/preview/','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.secondary_unit','product','Rooms','/preview/:id','params','2195451pOsqjz','Chinese','new_adjust_qty','Portuguese','\x20</h2>','adjust_qty','171711nfVdrF','<h5\x20style=\x22text-align:\x20left;\x22>','forEach','2442875aBJRkj','product_stock','English\x20(US)','\x20Order\x20Date\x20:\x20','level','finalize','purchases_data','$product_details._id','$product_details.product_code','get','New_Qty_Converted_adj','</head><body>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','all','<strong>\x20Regards\x20</strong>','message','Enabled','$product_details','FGSEmail','findOne','\x20Order\x20Number\x20:\x20','</table>','password','/CheckingWarehouse','QA\x20Warehouse','</div>','../public/language/languages.json','$product','catch','warehouse_name','An\x20error\x20occurred.','/view/add_adjustment','<table\x20style=\x22width:\x20100%\x20!important;\x22>','success','edit_adjustment_finished_view','prod_invoice','$product_details.rack','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','site_title','$warehouse_name','$product_details.bin','$product_details.secondary_code','invoice','stock','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','findById','</thead>','$date','post','exports','product_code','85104mfqtaK','string','$finalize','bay','staff','../middleware/auth','getFullYear','sendMail','toString','Secondary_units','<tbody\x20style=\x22text-align:\x20center;\x22>','minus','<div>','<hr\x20class=\x22my-3\x22>','22xYwNpO','New_Qty_Converted','then','German','aggregate','stockBefore','back','<h2>\x20','Return\x20Rooms','date','email','$product_details.type','$product_details.production_date','prod_code','getMonth','warehouse','createTransport','master','ADJF-','expiry_date','Error\x20Occurs','21rNwEtM','Arabic','Arabic\x20(ae)','language','json','French','An\x20error\x20occurred\x20while\x20saving\x20data.','/../public','errors','$product_details.unit','body','$room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','getDate','error','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_name','Logo.png','</td>','adjustment\x20add\x20successfull','$product_details.primary_code','save','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<html><head><title></title>','../models/all_models','_id','Hindi','Finished\x20Goods','Spanish','image','render','maxPerUnit','add','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','unit','room','$product_details.batch_code','</tr>','adjustment\x20data\x20update\x20successfully','user','Router','282383kCwAin','$invoice','room_names','$product.product_name','$product_details.invoice','Email\x20sent\x20successfully','DRY\x20GOODS','English','add_adjustment_finished','prod_name','<tr>','Primary_Units','filter','batch_code','JO_number'];a0_0x3eae=function(){return _0x5a4024;};return a0_0x3eae();}var a0_0x1b5c36=a0_0x1f11;(function(_0x13588c,_0x34e2e0){var _0x3bf6e7=a0_0x1f11,_0x16b5f1=_0x13588c();while(!![]){try{var _0x4b84a2=parseInt(_0x3bf6e7(0x278))/0x1+parseInt(_0x3bf6e7(0x23a))/0x2*(-parseInt(_0x3bf6e7(0x1f5))/0x3)+parseInt(_0x3bf6e7(0x2a1))/0x4*(parseInt(_0x3bf6e7(0x1f8))/0x5)+parseInt(_0x3bf6e7(0x28b))/0x6+parseInt(_0x3bf6e7(0x24f))/0x7*(-parseInt(_0x3bf6e7(0x22c))/0x8)+parseInt(_0x3bf6e7(0x1ef))/0x9+-parseInt(_0x3bf6e7(0x2a4))/0xa;if(_0x4b84a2===_0x34e2e0)break;else _0x16b5f1['push'](_0x16b5f1['shift']());}catch(_0x1c8de9){_0x16b5f1['push'](_0x16b5f1['shift']());}}}(a0_0x3eae,0x685a9));const express=require(a0_0x1b5c36(0x29d)),app=express(),router=express[a0_0x1b5c36(0x277)](),auth=require(a0_0x1b5c36(0x231)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x1b5c36(0x267)),users=require(a0_0x1b5c36(0x212)),nodemailer=require('nodemailer');function a0_0x1f11(_0x1e3b6d,_0x2a122a){var _0x3eae42=a0_0x3eae();return a0_0x1f11=function(_0x1f11eb,_0x11eae8){_0x1f11eb=_0x1f11eb-0x1e1;var _0x4a3443=_0x3eae42[_0x1f11eb];return _0x4a3443;},a0_0x1f11(_0x1e3b6d,_0x2a122a);}router['get']('/view',auth,async(_0x439267,_0x45ce6c)=>{var _0x27779b=a0_0x1b5c36;try{const {username:_0x52d860,email:_0x446728,role:_0x556ab9}=_0x439267[_0x27779b(0x276)],_0x546064=_0x439267[_0x27779b(0x276)],_0x2f6330=await profile[_0x27779b(0x20b)]({'email':_0x546064[_0x27779b(0x244)]}),_0x59d5b6=await master_shop['find']();let _0xb75f34;if(_0x546064[_0x27779b(0x298)]==_0x27779b(0x230)){const _0x272cf5=await staff['findOne']({'email':_0x546064[_0x27779b(0x244)]});_0xb75f34=await warehouse[_0x27779b(0x297)]({'status':'Enabled','name':_0x272cf5[_0x27779b(0x249)]});}else _0xb75f34=await warehouse['find']({'status':_0x27779b(0x208)});const _0x14d59a=await product[_0x27779b(0x297)]();let _0x23aa55;if(_0x546064[_0x27779b(0x298)]==_0x27779b(0x230)){const _0x4af6d6=await staff[_0x27779b(0x20b)]({'email':_0x546064[_0x27779b(0x244)]});_0x23aa55=await adjustment_finished[_0x27779b(0x297)]({'warehouse_name':_0x4af6d6[_0x27779b(0x249)]});}else _0x23aa55=await adjustment_finished['aggregate']([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x27779b(0x279)},'date':{'$first':_0x27779b(0x228)},'warehouse_name':{'$first':_0x27779b(0x220)},'room':{'$addToSet':_0x27779b(0x28e)},'finalize':{'$first':_0x27779b(0x22e)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x59d5b6[0x0][_0x27779b(0x252)]==_0x27779b(0x1fa)){var _0x549347=users['English'];console['log'](_0x549347);}else{if(_0x59d5b6[0x0][_0x27779b(0x252)]==_0x27779b(0x269))var _0x549347=users[_0x27779b(0x269)];else{if(_0x59d5b6[0x0][_0x27779b(0x252)]=='German')var _0x549347=users[_0x27779b(0x23d)];else{if(_0x59d5b6[0x0][_0x27779b(0x252)]==_0x27779b(0x26b))var _0x549347=users['Spanish'];else{if(_0x59d5b6[0x0][_0x27779b(0x252)]==_0x27779b(0x254))var _0x549347=users['French'];else{if(_0x59d5b6[0x0][_0x27779b(0x252)]==_0x27779b(0x299))var _0x549347=users[_0x27779b(0x1f2)];else{if(_0x59d5b6[0x0][_0x27779b(0x252)]=='Chinese')var _0x549347=users[_0x27779b(0x1f0)];else{if(_0x59d5b6[0x0][_0x27779b(0x252)]=='Arabic\x20(ae)')var _0x549347=users[_0x27779b(0x250)];}}}}}}}_0x45ce6c[_0x27779b(0x26d)]('adjustment_finished',{'success':_0x439267[_0x27779b(0x287)](_0x27779b(0x219)),'errors':_0x439267[_0x27779b(0x287)](_0x27779b(0x257)),'role':_0x546064,'profile':_0x2f6330,'warehouse':_0xb75f34,'product':_0x14d59a,'adjustment':_0x23aa55,'master_shop':_0x59d5b6,'language':_0x549347});}catch(_0x331a45){console['log'](_0x331a45);}});async function getRandom8DigitNumber(){var _0x3ffc30=a0_0x1b5c36;const _0x4a863e=0x989680,_0x5b35b8=0x5f5e0ff,_0x5d1c6a=Math['floor'](Math['random']()*(_0x5b35b8-_0x4a863e+0x1))+_0x4a863e;var _0x2dd56f;const _0x1515d0=await adjustment_finished[_0x3ffc30(0x20b)]({'invoice':_0x3ffc30(0x24c)+_0x5d1c6a});return _0x1515d0&&_0x1515d0[_0x3ffc30(0x28c)]>0x0?_0x2dd56f=_0x3ffc30(0x24c)+_0x5d1c6a:_0x2dd56f=_0x3ffc30(0x24c)+_0x5d1c6a,_0x2dd56f;}router['get'](a0_0x1b5c36(0x217),auth,async(_0xd4d4db,_0x22422b)=>{var _0x2446be=a0_0x1b5c36;try{const {username:_0xed1d4d,email:_0x36fff5,role:_0x379a82}=_0xd4d4db[_0x2446be(0x276)],_0x15a13f=_0xd4d4db[_0x2446be(0x276)],_0x4af1e0=await profile[_0x2446be(0x20b)]({'email':_0x15a13f[_0x2446be(0x244)]}),_0x1d64a8=await master_shop['find']();let _0x237aef;if(_0x15a13f[_0x2446be(0x298)]=='staff'){const _0x34407f=await staff[_0x2446be(0x20b)]({'email':_0x15a13f['email']});_0x237aef=await warehouse[_0x2446be(0x23e)]([{'$match':{'status':'Enabled','name':_0x34407f[_0x2446be(0x249)],'warehouse_category':_0x2446be(0x26a),'name':{'$ne':_0x2446be(0x210)}}},{'$group':{'_id':'$name','name':{'$first':_0x2446be(0x1e6)}}}]);}else _0x237aef=await warehouse['aggregate']([{'$match':{'status':_0x2446be(0x208),'warehouse_category':_0x2446be(0x26a),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x2446be(0x1e6),'name':{'$first':_0x2446be(0x1e6)}}}]);const _0x5a7630=await product[_0x2446be(0x297)]({}),_0x29a5c4=await adjustment_finished[_0x2446be(0x297)]({}),_0x292a21=_0x29a5c4[_0x2446be(0x28c)]+0x1,_0x33ba9f=_0x2446be(0x24c)+_0x292a21[_0x2446be(0x234)]()[_0x2446be(0x29e)](0x5,'0');var _0x20e2a3=[_0x2446be(0x2aa),'Enclosed','Return\x20Rooms'];if(_0x1d64a8[0x0][_0x2446be(0x252)]=='English\x20(US)')var _0x3f546e=users[_0x2446be(0x27f)];else{if(_0x1d64a8[0x0][_0x2446be(0x252)]==_0x2446be(0x269))var _0x3f546e=users['Hindi'];else{if(_0x1d64a8[0x0][_0x2446be(0x252)]==_0x2446be(0x23d))var _0x3f546e=users['German'];else{if(_0x1d64a8[0x0][_0x2446be(0x252)]==_0x2446be(0x26b))var _0x3f546e=users[_0x2446be(0x26b)];else{if(_0x1d64a8[0x0][_0x2446be(0x252)]==_0x2446be(0x254))var _0x3f546e=users[_0x2446be(0x254)];else{if(_0x1d64a8[0x0][_0x2446be(0x252)]==_0x2446be(0x299))var _0x3f546e=users[_0x2446be(0x1f2)];else{if(_0x1d64a8[0x0]['language']==_0x2446be(0x1f0))var _0x3f546e=users['Chinese'];else{if(_0x1d64a8[0x0][_0x2446be(0x252)]=='Arabic\x20(ae)')var _0x3f546e=users[_0x2446be(0x250)];}}}}}}}const _0x33a6c6=getRandom8DigitNumber();_0x33a6c6['then'](_0x29f7d4=>{var _0x830d20=_0x2446be;_0x22422b[_0x830d20(0x26d)](_0x830d20(0x280),{'success':_0xd4d4db[_0x830d20(0x287)](_0x830d20(0x219)),'errors':_0xd4d4db['flash'](_0x830d20(0x257)),'role':_0x15a13f,'profile':_0x4af1e0,'warehouse':_0x237aef,'product':_0x5a7630,'master_shop':_0x1d64a8,'language':_0x3f546e,'rooms_data':_0x20e2a3,'invoice_no':_0x29f7d4});})[_0x2446be(0x214)](_0x1497df=>{var _0x5d82f4=_0x2446be;_0xd4d4db[_0x5d82f4(0x287)](_0x5d82f4(0x257),_0x5d82f4(0x1e2)),_0x22422b[_0x5d82f4(0x1e1)](_0x5d82f4(0x29b));});}catch(_0x4a56d4){console['log'](_0x4a56d4);}}),router['post'](a0_0x1b5c36(0x217),auth,async(_0x634456,_0x50ef6e)=>{var _0x4f0ede=a0_0x1b5c36;try{const {warehouse_name:_0x431326,date:_0x58819a,prod_name:_0x329759,level:_0x25dd40,isle:_0x96e9f1,pallet:_0x513742,stock:_0xeb3e,types:_0x2fd525,adjust_qty:_0x5e5928,new_adjust_qty:_0x1a0356,note:_0x3b6db5,Room_name:_0x3cfce7,invoice:_0x44367a,JO_number:_0x721cc6,expiry_date:_0x25577b}=_0x634456['body'];if(typeof _0x329759==_0x4f0ede(0x22d))var _0x3bf33a=[_0x634456['body'][_0x4f0ede(0x281)]],_0x4398ce=[_0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x1fc)]],_0x18e80b=[_0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x224)]],_0xb096f2=[_0x634456['body'][_0x4f0ede(0x2a6)]],_0x3f11df=[_0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x202)]],_0x437f27=[_0x634456['body'][_0x4f0ede(0x23b)]],_0x1f834d=[_0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x283)]],_0x20400f=[_0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x235)]],_0xcbd565=[_0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x247)]],_0x282fb3=[_0x634456[_0x4f0ede(0x259)]['batch_code']],_0x9cd672=[_0x634456[_0x4f0ede(0x259)]['expiry_date']],_0x326083=[_0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x1e4)]],_0x1b2856=[_0x634456[_0x4f0ede(0x259)]['prod_cat']],_0x5a3d9c=[_0x634456['body'][_0x4f0ede(0x1ec)]],_0x4cb3dc=[_0x634456['body'][_0x4f0ede(0x26e)]],_0xe797ed=[_0x634456['body'][_0x4f0ede(0x21b)]];else var _0x3bf33a=[..._0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x281)]],_0x4398ce=[..._0x634456[_0x4f0ede(0x259)]['level']],_0x18e80b=[..._0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x224)]],_0xb096f2=[..._0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x2a6)]],_0x3f11df=[..._0x634456['body'][_0x4f0ede(0x202)]],_0x437f27=[..._0x634456[_0x4f0ede(0x259)]['New_Qty_Converted']],_0x1f834d=[..._0x634456['body'][_0x4f0ede(0x283)]],_0x20400f=[..._0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x235)]],_0xcbd565=[..._0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x247)]],_0x282fb3=[..._0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x285)]],_0x9cd672=[..._0x634456['body'][_0x4f0ede(0x24d)]],_0x326083=[..._0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x1e4)]],_0x1b2856=[..._0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x2a9)]],_0x5a3d9c=[..._0x634456['body'][_0x4f0ede(0x1ec)]],_0x4cb3dc=[..._0x634456['body'][_0x4f0ede(0x26e)]],_0xe797ed=[..._0x634456[_0x4f0ede(0x259)][_0x4f0ede(0x21b)]];const _0x5d959=_0x3bf33a[_0x4f0ede(0x292)](_0x33a1fc=>{return _0x33a1fc={'product_name':_0x33a1fc};});_0x4398ce[_0x4f0ede(0x1f7)]((_0x310ab2,_0x397fc6)=>{var _0x5bf35c=_0x4f0ede;_0x5d959[_0x397fc6][_0x5bf35c(0x22f)]=_0x310ab2;}),_0x18e80b['forEach']((_0x23c799,_0x54a4ad)=>{var _0x38f67c=_0x4f0ede;_0x5d959[_0x54a4ad][_0x38f67c(0x23f)]=_0x23c799;}),_0xb096f2[_0x4f0ede(0x1f7)]((_0x47cda8,_0x1eac66)=>{var _0x5d384a=_0x4f0ede;_0x5d959[_0x1eac66][_0x5d384a(0x2a6)]=_0x47cda8;}),_0x3f11df[_0x4f0ede(0x1f7)]((_0x167e6,_0x380a09)=>{var _0x45529d=_0x4f0ede;_0x5d959[_0x380a09][_0x45529d(0x1f4)]=_0x167e6;}),_0x437f27[_0x4f0ede(0x1f7)]((_0xf776f4,_0x4133f4)=>{var _0x2955a6=_0x4f0ede;_0x5d959[_0x4133f4][_0x2955a6(0x1f1)]=_0xf776f4;}),_0x1f834d['forEach']((_0x13eca1,_0x4edad3)=>{var _0x123d38=_0x4f0ede;_0x5d959[_0x4edad3][_0x123d38(0x271)]=_0x13eca1;}),_0x20400f[_0x4f0ede(0x1f7)]((_0x363ff7,_0x5d9fd9)=>{var _0x4f2185=_0x4f0ede;_0x5d959[_0x5d9fd9][_0x4f2185(0x290)]=_0x363ff7;}),_0xcbd565[_0x4f0ede(0x1f7)]((_0x1f3e12,_0x2907de)=>{var _0x3e9fd4=_0x4f0ede;_0x5d959[_0x2907de][_0x3e9fd4(0x22b)]=_0x1f3e12;}),_0x282fb3[_0x4f0ede(0x1f7)]((_0x3a681c,_0x442309)=>{var _0x20bc22=_0x4f0ede;_0x5d959[_0x442309][_0x20bc22(0x285)]=_0x3a681c;}),_0x9cd672['forEach']((_0x4759c7,_0x119396)=>{var _0x226c96=_0x4f0ede;_0x5d959[_0x119396][_0x226c96(0x24d)]=_0x4759c7;}),_0x326083[_0x4f0ede(0x1f7)]((_0x100fe1,_0x32992c)=>{var _0x1841ac=_0x4f0ede;_0x5d959[_0x32992c][_0x1841ac(0x294)]=_0x100fe1;}),_0x1b2856[_0x4f0ede(0x1f7)]((_0x3dcb05,_0x25fff3)=>{var _0x3c48bc=_0x4f0ede;_0x5d959[_0x25fff3][_0x3c48bc(0x2a9)]=_0x3dcb05;}),_0x5a3d9c[_0x4f0ede(0x1f7)]((_0x20e2e5,_0x4ce978)=>{var _0x20942a=_0x4f0ede;_0x5d959[_0x4ce978][_0x20942a(0x27a)]=_0x20e2e5;}),_0x4cb3dc['forEach']((_0xc7ac63,_0x1d2520)=>{_0x5d959[_0x1d2520]['maxPerUnit']=_0xc7ac63;}),_0xe797ed[_0x4f0ede(0x1f7)]((_0x3b1d67,_0x335226)=>{var _0x45aa8c=_0x4f0ede;_0x5d959[_0x335226][_0x45aa8c(0x223)]=_0x3b1d67;});const _0x128816=_0x5d959[_0x4f0ede(0x284)](_0x2575be=>_0x2575be[_0x4f0ede(0x1f4)]!=='0'&&_0x2575be[_0x4f0ede(0x1f4)]!=='');var _0x307c6a=0x0;_0x128816[_0x4f0ede(0x1f7)](_0x1cde91=>{var _0x1fb694=_0x4f0ede;console[_0x1fb694(0x29a)]('foreach\x20newproduct',_0x1cde91),parseInt(_0x1cde91[_0x1fb694(0x1f4)])<=0x0&&_0x307c6a++;});if(_0x307c6a!=0x0)return _0x634456['flash'](_0x4f0ede(0x257),_0x4f0ede(0x21d)),_0x50ef6e[_0x4f0ede(0x1e1)](_0x4f0ede(0x240));const _0x498eea=new adjustment_finished({'warehouse_name':_0x431326,'date':_0x58819a,'product':_0x128816,'note':_0x3b6db5,'room':_0x3cfce7,'invoice':_0x44367a,'JO_number':_0x721cc6,'expiry_date':_0x25577b}),_0x7dc5fb=await _0x498eea[_0x4f0ede(0x264)]();_0x634456[_0x4f0ede(0x287)](_0x4f0ede(0x219),_0x4f0ede(0x262)),_0x50ef6e[_0x4f0ede(0x1e1)](_0x4f0ede(0x1e8)+_0x7dc5fb[_0x4f0ede(0x268)]);}catch(_0x2bc3eb){console['log'](_0x2bc3eb),_0x50ef6e['status'](0xc8)[_0x4f0ede(0x253)]({'message':_0x2bc3eb[_0x4f0ede(0x207)]});}}),router[a0_0x1b5c36(0x201)](a0_0x1b5c36(0x1ed),auth,async(_0x28827d,_0x4d361e)=>{var _0xae6ff0=a0_0x1b5c36;try{const {username:_0x1a7685,email:_0x1cc7ad,role:_0xc6e250}=_0x28827d[_0xae6ff0(0x276)],_0x4a866f=_0x28827d[_0xae6ff0(0x276)],_0x300e45=await profile[_0xae6ff0(0x20b)]({'email':_0x4a866f[_0xae6ff0(0x244)]}),_0x3e690a=await master_shop[_0xae6ff0(0x297)](),_0x200754=_0x28827d[_0xae6ff0(0x1ee)]['id'],_0x2ee5e7=await adjustment_finished[_0xae6ff0(0x226)]({'_id':_0x200754}),_0x1c54f1=await purchases[_0xae6ff0(0x23e)]([{'$match':{'warehouse_name':_0x2ee5e7[_0xae6ff0(0x215)]}},{'$unwind':_0xae6ff0(0x213)},{'$group':{'_id':_0xae6ff0(0x27b)}}]);console[_0xae6ff0(0x29a)](_0xae6ff0(0x1fe),_0x1c54f1);const _0xb690e5=await product['find']({}),_0x53dc1c=await warehouse[_0xae6ff0(0x23e)]([{'$match':{'name':_0x2ee5e7['warehouse_name'],'warehouse_category':_0xae6ff0(0x26a)}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0xae6ff0(0x2a7)},'product_stock':{'$first':_0xae6ff0(0x28d)},'bay':{'$first':_0xae6ff0(0x28f)},'bin':{'$first':_0xae6ff0(0x221)},'type':{'$first':_0xae6ff0(0x245)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0xae6ff0(0x263)},'secondary_code':{'$first':_0xae6ff0(0x222)},'product_code':{'$first':_0xae6ff0(0x200)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xae6ff0(0x29f)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0xae6ff0(0x1e3)},'room':{'$first':_0xae6ff0(0x25a)}}}]);if(_0x3e690a[0x0]['language']==_0xae6ff0(0x1fa)){var _0x24cca0=users[_0xae6ff0(0x27f)];console[_0xae6ff0(0x29a)](_0x24cca0);}else{if(_0x3e690a[0x0]['language']==_0xae6ff0(0x269))var _0x24cca0=users[_0xae6ff0(0x269)];else{if(_0x3e690a[0x0]['language']=='German')var _0x24cca0=users[_0xae6ff0(0x23d)];else{if(_0x3e690a[0x0][_0xae6ff0(0x252)]==_0xae6ff0(0x26b))var _0x24cca0=users[_0xae6ff0(0x26b)];else{if(_0x3e690a[0x0][_0xae6ff0(0x252)]==_0xae6ff0(0x254))var _0x24cca0=users[_0xae6ff0(0x254)];else{if(_0x3e690a[0x0][_0xae6ff0(0x252)]==_0xae6ff0(0x299))var _0x24cca0=users[_0xae6ff0(0x1f2)];else{if(_0x3e690a[0x0][_0xae6ff0(0x252)]==_0xae6ff0(0x1f0))var _0x24cca0=users[_0xae6ff0(0x1f0)];else{if(_0x3e690a[0x0][_0xae6ff0(0x252)]==_0xae6ff0(0x251))var _0x24cca0=users[_0xae6ff0(0x250)];}}}}}}}_0x4d361e[_0xae6ff0(0x26d)](_0xae6ff0(0x21a),{'success':_0x28827d[_0xae6ff0(0x287)]('success'),'errors':_0x28827d[_0xae6ff0(0x287)](_0xae6ff0(0x257)),'role':_0x4a866f,'profile':_0x300e45,'adjustment':_0x2ee5e7,'stock':_0x53dc1c,'master_shop':_0x3e690a,'warehouse_name':_0x1c54f1,'unit':_0xb690e5,'language':_0x24cca0});}catch(_0x4329dd){console[_0xae6ff0(0x29a)](_0x4329dd),_0x4d361e['status'](0xc8)['json']({'message':_0x4329dd[_0xae6ff0(0x207)]});}}),router[a0_0x1b5c36(0x229)]('/preview/:id',auth,async(_0x1703bd,_0x3231e0)=>{var _0x54a192=a0_0x1b5c36;try{const {invoice:_0x21511b,warehouse_name:_0x44ceaf,Room_name:_0x3a2ecc}=_0x1703bd[_0x54a192(0x259)],_0x4dc0db=_0x1703bd[_0x54a192(0x1ee)]['id'],_0x441eb7=await adjustment_finished[_0x54a192(0x226)]({'_id':_0x4dc0db});var _0x466235;const _0x3f12f7=_0x441eb7[_0x54a192(0x1eb)][_0x54a192(0x292)](async _0x191fa8=>{var _0x34764a=_0x54a192;if(_0x191fa8[_0x34764a(0x1f4)]>0x0){_0x466235=await warehouse[_0x34764a(0x20b)]({'name':_0x44ceaf,'room':_0x191fa8['room_names'],'warehouse_category':_0x34764a(0x26a)});const _0x296396=_0x466235[_0x34764a(0x289)][_0x34764a(0x292)](_0x20e750=>{var _0x28a042=_0x34764a;console[_0x28a042(0x29a)](_0x191fa8['types']);if(_0x191fa8[_0x28a042(0x2a6)]==_0x28a042(0x237))_0x20e750['product_name']==_0x191fa8['product_name']&&_0x20e750[_0x28a042(0x22f)]==_0x191fa8[_0x28a042(0x22f)]&&_0x20e750[_0x28a042(0x24d)]==_0x191fa8[_0x28a042(0x24d)]&&_0x20e750['production_date']==_0x191fa8[_0x28a042(0x294)]&&_0x20e750['batch_code']==_0x191fa8['batch_code']&&_0x20e750[_0x28a042(0x223)]==_0x191fa8[_0x28a042(0x223)]&&(_0x20e750[_0x28a042(0x1f9)]=_0x20e750[_0x28a042(0x1f9)]-_0x191fa8['adjust_qty']);else _0x191fa8[_0x28a042(0x2a6)]==_0x28a042(0x26f)&&(_0x20e750[_0x28a042(0x25f)]==_0x191fa8[_0x28a042(0x25f)]&&_0x20e750[_0x28a042(0x22f)]==_0x191fa8[_0x28a042(0x22f)]&&_0x20e750[_0x28a042(0x24d)]==_0x191fa8[_0x28a042(0x24d)]&&_0x20e750[_0x28a042(0x294)]==_0x191fa8[_0x28a042(0x294)]&&_0x20e750[_0x28a042(0x285)]==_0x191fa8[_0x28a042(0x285)]&&_0x20e750[_0x28a042(0x223)]==_0x191fa8[_0x28a042(0x223)]&&(_0x20e750[_0x28a042(0x1f9)]=_0x20e750[_0x28a042(0x1f9)]+_0x191fa8[_0x28a042(0x1f4)]));});}return _0x466235;});Promise[_0x54a192(0x205)](_0x3f12f7)[_0x54a192(0x23c)](async _0x153b4a=>{var _0x33103a=_0x54a192;try{for(const _0x294bed of _0x153b4a){await _0x294bed[_0x33103a(0x264)]();}_0x441eb7[_0x33103a(0x1fd)]=_0x33103a(0x293);const _0x11062a=await _0x441eb7[_0x33103a(0x264)](),_0x556866=await master_shop[_0x33103a(0x297)](),_0x52e6d4=await email_settings[_0x33103a(0x20b)](),_0x42c716=await supervisor_settings[_0x33103a(0x297)]();var _0x2bb4f3=_0x441eb7[_0x33103a(0x1eb)],_0x6c909='',_0x404114;for(_0x404114 in _0x2bb4f3){var _0x25864f='FG';_0x441eb7[_0x33103a(0x215)]==_0x33103a(0x27e)&&(_0x25864f='DG'),_0x6c909+=_0x33103a(0x282)+_0x33103a(0x25e)+_0x2bb4f3[_0x404114]['product_name']+_0x33103a(0x261)+_0x33103a(0x25e)+_0x2bb4f3[_0x404114]['product_code']+'</td>'+_0x33103a(0x25e)+_0x2bb4f3[_0x404114][_0x33103a(0x1f4)]+_0x33103a(0x261)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2bb4f3[_0x404114][_0x33103a(0x271)]+_0x33103a(0x261)+_0x33103a(0x25e)+_0x2bb4f3[_0x404114]['secondary_unit']+_0x33103a(0x261)+_0x33103a(0x25e)+_0x441eb7['warehouse_name']+_0x33103a(0x261)+_0x33103a(0x25e)+_0x2bb4f3[_0x404114][_0x33103a(0x27a)]+_0x33103a(0x261)+_0x33103a(0x25e)+_0x25864f+_0x2bb4f3[_0x404114]['bay']+_0x33103a(0x261)+_0x33103a(0x274);}let _0x2889c3=nodemailer[_0x33103a(0x24a)]({'host':_0x52e6d4['host'],'port':Number(_0x52e6d4['port']),'secure':![],'auth':{'user':_0x52e6d4[_0x33103a(0x244)],'pass':_0x52e6d4[_0x33103a(0x20e)]}}),_0xb67f8f={'from':_0x52e6d4[_0x33103a(0x244)],'to':_0x42c716[0x0][_0x33103a(0x20a)],'subject':_0x33103a(0x29c),'attachments':[{'filename':_0x33103a(0x260),'path':__dirname+_0x33103a(0x256)+'/upload/'+_0x556866[0x0][_0x33103a(0x26c)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x33103a(0x266)+_0x33103a(0x203)+_0x33103a(0x238)+_0x33103a(0x2a0)+_0x33103a(0x238)+_0x33103a(0x1e9)+_0x33103a(0x211)+_0x33103a(0x238)+_0x33103a(0x241)+_0x556866[0x0][_0x33103a(0x21f)]+_0x33103a(0x1f3)+_0x33103a(0x211)+'</div>'+_0x33103a(0x239)+_0x33103a(0x238)+_0x33103a(0x1f6)+_0x33103a(0x20c)+_0x441eb7[_0x33103a(0x223)]+'\x20'+_0x33103a(0x1e7)+_0x33103a(0x1fb)+_0x441eb7[_0x33103a(0x243)]+'\x20'+'</span>'+'</h5>'+_0x33103a(0x211)+_0x33103a(0x218)+_0x33103a(0x225)+_0x33103a(0x282)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x33103a(0x21e)+_0x33103a(0x265)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x33103a(0x288)+_0x33103a(0x270)+_0x33103a(0x25b)+_0x33103a(0x204)+_0x33103a(0x274)+_0x33103a(0x227)+_0x33103a(0x236)+'\x20'+_0x6c909+'\x20'+'</tbody>'+_0x33103a(0x20d)+_0x33103a(0x238)+_0x33103a(0x206)+_0x33103a(0x295)+_0x556866[0x0][_0x33103a(0x21f)]+_0x33103a(0x291)+_0x33103a(0x211)+_0x33103a(0x211)+_0x33103a(0x28a)};_0x2889c3[_0x33103a(0x233)](_0xb67f8f,function(_0x535daf,_0x4e03ec){var _0x1d73f6=_0x33103a;_0x535daf?(console[_0x1d73f6(0x29a)](_0x535daf),console[_0x1d73f6(0x29a)](_0x1d73f6(0x24e))):console[_0x1d73f6(0x29a)](_0x1d73f6(0x27d));}),_0x1703bd[_0x33103a(0x287)]('success','Adjustment\x20Finalize\x20Successfully'),_0x3231e0[_0x33103a(0x1e1)]('/picking_list/PDF_adjustment/'+_0x11062a[_0x33103a(0x268)]);}catch(_0x5bb6d3){console[_0x33103a(0x25d)](_0x5bb6d3),_0x3231e0['status'](0x1f4)[_0x33103a(0x253)]({'error':_0x33103a(0x255)});}})[_0x54a192(0x214)](_0x2019fc=>{var _0x6e760d=_0x54a192;console[_0x6e760d(0x25d)](_0x2019fc),_0x3231e0[_0x6e760d(0x2a8)](0x1f4)[_0x6e760d(0x253)]({'error':_0x6e760d(0x216)});});}catch(_0x43836b){_0x3231e0['json']({'message':_0x43836b[_0x54a192(0x207)]});}}),router['get'](a0_0x1b5c36(0x2a3),auth,async(_0x12321d,_0x55bd74)=>{var _0x1fcbc4=a0_0x1b5c36;try{const {username:_0x431f79,email:_0x238648,role:_0x3de58b}=_0x12321d[_0x1fcbc4(0x276)],_0x17d602=_0x12321d[_0x1fcbc4(0x276)],_0x486b0d=await profile[_0x1fcbc4(0x20b)]({'email':_0x17d602[_0x1fcbc4(0x244)]}),_0x20f08a=await master_shop['find']();console[_0x1fcbc4(0x29a)](_0x1fcbc4(0x24b),_0x20f08a);const _0x1dad98=_0x12321d[_0x1fcbc4(0x1ee)]['id'],_0xc3ad71=await adjustment_finished[_0x1fcbc4(0x226)]({'_id':_0x1dad98});let _0x2dd334=new Date(_0xc3ad71[_0x1fcbc4(0x24d)]),_0xe1cb9a=('0'+_0x2dd334[_0x1fcbc4(0x25c)]())[_0x1fcbc4(0x2a5)](-0x2),_0x3b2a6c=('0'+(_0x2dd334[_0x1fcbc4(0x248)]()+0x1))['slice'](-0x2),_0x5161e3=_0x2dd334[_0x1fcbc4(0x232)](),_0x47ef61=_0x5161e3+'-'+_0x3b2a6c+'-'+_0xe1cb9a;var _0x1c012a=[_0x1fcbc4(0x2aa),'Enclosed',_0x1fcbc4(0x242)];const _0x156fa5=await purchases[_0x1fcbc4(0x23e)]([{'$match':{'warehouse_name':_0xc3ad71[_0x1fcbc4(0x215)]}},{'$unwind':_0x1fcbc4(0x213)},{'$group':{'_id':_0x1fcbc4(0x27b)}}]);console[_0x1fcbc4(0x29a)](_0x1fcbc4(0x1fe),_0x156fa5);const _0x497411=await product[_0x1fcbc4(0x297)]({}),_0x5412f5=await warehouse[_0x1fcbc4(0x23e)]([{'$match':{'name':_0xc3ad71['warehouse_name'],'room':_0xc3ad71[_0x1fcbc4(0x272)]}},{'$unwind':_0x1fcbc4(0x209)},{'$group':{'_id':_0x1fcbc4(0x1ff),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1fcbc4(0x28f)},'bin':{'$first':_0x1fcbc4(0x221)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1fcbc4(0x296)},'primary_code':{'$first':_0x1fcbc4(0x263)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1fcbc4(0x200)},'storage':{'$first':_0x1fcbc4(0x1e5)},'rack':{'$first':_0x1fcbc4(0x21c)}}}]);if(_0x20f08a[0x0][_0x1fcbc4(0x252)]==_0x1fcbc4(0x1fa)){var _0x14f499=users[_0x1fcbc4(0x27f)];console[_0x1fcbc4(0x29a)](_0x14f499);}else{if(_0x20f08a[0x0]['language']==_0x1fcbc4(0x269))var _0x14f499=users[_0x1fcbc4(0x269)];else{if(_0x20f08a[0x0][_0x1fcbc4(0x252)]=='German')var _0x14f499=users['German'];else{if(_0x20f08a[0x0][_0x1fcbc4(0x252)]==_0x1fcbc4(0x26b))var _0x14f499=users[_0x1fcbc4(0x26b)];else{if(_0x20f08a[0x0][_0x1fcbc4(0x252)]==_0x1fcbc4(0x254))var _0x14f499=users[_0x1fcbc4(0x254)];else{if(_0x20f08a[0x0][_0x1fcbc4(0x252)]==_0x1fcbc4(0x299))var _0x14f499=users['Portuguese'];else{if(_0x20f08a[0x0][_0x1fcbc4(0x252)]==_0x1fcbc4(0x1f0))var _0x14f499=users[_0x1fcbc4(0x1f0)];else{if(_0x20f08a[0x0][_0x1fcbc4(0x252)]==_0x1fcbc4(0x251))var _0x14f499=users[_0x1fcbc4(0x250)];}}}}}}}_0x55bd74[_0x1fcbc4(0x26d)]('edit_adjustment_finished',{'success':_0x12321d[_0x1fcbc4(0x287)](_0x1fcbc4(0x219)),'errors':_0x12321d[_0x1fcbc4(0x287)]('errors'),'role':_0x17d602,'profile':_0x486b0d,'adjustment':_0xc3ad71,'stock':_0x5412f5,'master_shop':_0x20f08a,'warehouse_name':_0x156fa5,'unit':_0x497411,'language':_0x14f499,'rooms_data':_0x1c012a,'ed_fullDate':_0x47ef61});}catch(_0x14a491){console[_0x1fcbc4(0x29a)](_0x14a491),_0x55bd74['status'](0xc8)[_0x1fcbc4(0x253)]({'message':_0x14a491['message']});}}),router['post'](a0_0x1b5c36(0x2a3),auth,async(_0x47be58,_0x315061)=>{var _0x330536=a0_0x1b5c36;try{const _0x182081=_0x47be58['params']['id'],_0xb5abed=await adjustment_finished[_0x330536(0x226)]({'_id':_0x182081}),_0xa282bf=await warehouse[_0x330536(0x20b)]({'name':_0xb5abed[_0x330536(0x215)],'room':_0xb5abed['room']}),{warehouse_name:_0x133ada,date:_0x4b8b50,prod_name:_0x39d4e6,level:_0x532604,isle:_0x46489d,pallet:_0xf2de8a,stock:_0xb44705,types:_0x15a9ba,adjust_qty:_0xd987e0,new_adjust_qty:_0x4774fc,note:_0x373ad3,Room_name:_0x445d67,invoice:_0x43e341,JO_number:_0x3fda51}=_0x47be58[_0x330536(0x259)];if(typeof _0x39d4e6==_0x330536(0x22d))var _0x1f9d70=[_0x47be58[_0x330536(0x259)][_0x330536(0x281)]],_0x536b01=[_0x47be58[_0x330536(0x259)][_0x330536(0x1fc)]],_0x595bd6=[_0x47be58[_0x330536(0x259)][_0x330536(0x224)]],_0x24c2dd=[_0x47be58[_0x330536(0x259)][_0x330536(0x2a6)]],_0x161472=[_0x47be58['body']['adjust_qty']],_0x109b0c=[_0x47be58[_0x330536(0x259)][_0x330536(0x1f1)]],_0xe14a67=[_0x47be58[_0x330536(0x259)][_0x330536(0x247)]],_0x45e93c=[_0x47be58['body']['unit']],_0xc37f7d=[_0x47be58[_0x330536(0x259)][_0x330536(0x235)]],_0x3d0de9=[_0x47be58[_0x330536(0x259)][_0x330536(0x285)]],_0x31f0e2=[_0x47be58[_0x330536(0x259)][_0x330536(0x24d)]];else var _0x1f9d70=[..._0x47be58[_0x330536(0x259)][_0x330536(0x281)]],_0x536b01=[..._0x47be58[_0x330536(0x259)][_0x330536(0x1fc)]],_0x595bd6=[..._0x47be58[_0x330536(0x259)][_0x330536(0x224)]],_0x24c2dd=[..._0x47be58[_0x330536(0x259)][_0x330536(0x2a6)]],_0x161472=[..._0x47be58[_0x330536(0x259)][_0x330536(0x1f4)]],_0x109b0c=[..._0x47be58[_0x330536(0x259)]['new_adjust_qty']],_0xe14a67=[..._0x47be58['body'][_0x330536(0x247)]],_0x45e93c=[..._0x47be58[_0x330536(0x259)][_0x330536(0x271)]],_0xc37f7d=[..._0x47be58[_0x330536(0x259)]['Secondary_units']],_0x3d0de9=[..._0x47be58[_0x330536(0x259)][_0x330536(0x285)]],_0x31f0e2=[..._0x47be58[_0x330536(0x259)][_0x330536(0x24d)]];const _0x34ab9b=_0x1f9d70[_0x330536(0x292)](_0x45432c=>{return _0x45432c={'product_name':_0x45432c};});_0x536b01[_0x330536(0x1f7)]((_0x20230d,_0x12074d)=>{var _0x10c471=_0x330536;_0x34ab9b[_0x12074d][_0x10c471(0x22f)]=_0x20230d;}),_0x595bd6[_0x330536(0x1f7)]((_0x2d72a2,_0x280d10)=>{_0x34ab9b[_0x280d10]['stockBefore']=_0x2d72a2;}),_0x24c2dd[_0x330536(0x1f7)]((_0x5ceea8,_0x5b7220)=>{_0x34ab9b[_0x5b7220]['types']=_0x5ceea8;}),_0x161472[_0x330536(0x1f7)]((_0x44d161,_0x51c3ae)=>{_0x34ab9b[_0x51c3ae]['adjust_qty']=_0x44d161;}),_0x109b0c[_0x330536(0x1f7)]((_0x42bfa3,_0x24dd64)=>{var _0x1cbe86=_0x330536;_0x34ab9b[_0x24dd64][_0x1cbe86(0x1f1)]=_0x42bfa3;}),_0x45e93c[_0x330536(0x1f7)]((_0x30fa5b,_0x42d476)=>{var _0x5466af=_0x330536;_0x34ab9b[_0x42d476][_0x5466af(0x271)]=_0x30fa5b;}),_0xc37f7d[_0x330536(0x1f7)]((_0x5d560b,_0x1070fd)=>{var _0x1a9077=_0x330536;_0x34ab9b[_0x1070fd][_0x1a9077(0x290)]=_0x5d560b;}),_0xe14a67[_0x330536(0x1f7)]((_0x1c8ba7,_0x5c6d09)=>{var _0x2ba721=_0x330536;_0x34ab9b[_0x5c6d09][_0x2ba721(0x22b)]=_0x1c8ba7;}),_0x3d0de9[_0x330536(0x1f7)]((_0x5d78e8,_0x2601c7)=>{var _0x5bc689=_0x330536;_0x34ab9b[_0x2601c7][_0x5bc689(0x285)]=_0x5d78e8;}),_0x31f0e2[_0x330536(0x1f7)]((_0x4fd088,_0x39dd25)=>{_0x34ab9b[_0x39dd25]['expiry_date']=_0x4fd088;});const _0x29a6eb=_0x34ab9b['filter'](_0x4b033d=>_0x4b033d[_0x330536(0x1f4)]!=='0'&&_0x4b033d[_0x330536(0x1f4)]!=='');var _0x3ed1ee=0x0;_0x29a6eb[_0x330536(0x1f7)](_0x540712=>{var _0x200973=_0x330536;console[_0x200973(0x29a)]('foreach\x20newproduct',_0x540712),parseInt(_0x540712[_0x200973(0x1f4)])<=0x0&&_0x3ed1ee++;});if(_0x3ed1ee!=0x0)return _0x47be58[_0x330536(0x287)]('errors',_0x330536(0x21d)),_0x315061['redirect'](_0x330536(0x240));_0xb5abed[_0x330536(0x215)]=_0x133ada,_0xb5abed[_0x330536(0x243)]=_0x4b8b50,_0xb5abed[_0x330536(0x1eb)]=_0x29a6eb,_0xb5abed['note']=_0x373ad3,_0xb5abed['room']=_0x445d67,_0xb5abed['invoice']=_0x43e341,_0xb5abed[_0x330536(0x286)]=_0x3fda51;const _0x2df07a=await _0xb5abed[_0x330536(0x264)](),_0x50ba19=await warehouse[_0x330536(0x20b)]({'name':_0x133ada,'room':_0x445d67});_0x2df07a[_0x330536(0x1eb)][_0x330536(0x1f7)](_0x5cdbb3=>{var _0x534ae4=_0x330536;const _0x4c6478=_0x50ba19['product_details'][_0x534ae4(0x292)](_0x520252=>{var _0x3aa7dd=_0x534ae4;_0x5cdbb3[_0x3aa7dd(0x2a6)]==_0x3aa7dd(0x237)?_0x520252[_0x3aa7dd(0x25f)]==_0x5cdbb3[_0x3aa7dd(0x25f)]&&_0x520252[_0x3aa7dd(0x22f)]==_0x5cdbb3[_0x3aa7dd(0x22f)]&&(_0x520252[_0x3aa7dd(0x1f9)]=parseInt(_0x520252['product_stock'])-parseInt(_0x5cdbb3[_0x3aa7dd(0x1f4)])):_0x520252[_0x3aa7dd(0x25f)]==_0x5cdbb3[_0x3aa7dd(0x25f)]&&_0x520252[_0x3aa7dd(0x22f)]==_0x5cdbb3[_0x3aa7dd(0x22f)]&&(_0x520252[_0x3aa7dd(0x1f9)]=parseInt(_0x520252['product_stock'])+parseInt(_0x5cdbb3[_0x3aa7dd(0x1f4)]));});}),await _0x50ba19[_0x330536(0x264)](),_0x47be58[_0x330536(0x287)](_0x330536(0x219),_0x330536(0x275)),_0x315061[_0x330536(0x1e1)]('/adjustment_finished/view');}catch(_0x2ff206){console['log'](_0x2ff206);}}),router['post']('/barcode_scanner',async(_0xca913,_0x5e7e71)=>{const {primary_code:_0x20b949,warehouse_data:_0x402939,rooms_data:_0xc5a3cf,Roomslist:_0x5b729f}=_0xca913['body'],_0x5c16eb=_0x5b729f['split'](','),_0x229024=[];async function _0x2bfb8e(_0x300995){var _0x91bd35=a0_0x1f11;const _0x19b6f8=await warehouse[_0x91bd35(0x23e)]([{'$match':{'name':_0x402939,'room':_0x300995}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x20b949}},{'$group':{'_id':_0x91bd35(0x1ff),'name':{'$first':_0x91bd35(0x2a7)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x91bd35(0x222)},'product_code':{'$first':_0x91bd35(0x200)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x91bd35(0x221)},'type':{'$first':_0x91bd35(0x245)},'pallet':{'$first':_0x91bd35(0x296)},'unit':{'$first':_0x91bd35(0x258)},'secondary_unit':{'$first':_0x91bd35(0x1ea)},'storage':{'$first':_0x91bd35(0x1e5)},'rack':{'$first':_0x91bd35(0x21c)},'expiry_date':{'$first':_0x91bd35(0x29f)},'production_date':{'$first':_0x91bd35(0x246)},'batch_code':{'$first':_0x91bd35(0x273)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x91bd35(0x27c)}}}]),_0x4bfe13=await warehouse[_0x91bd35(0x23e)]([{'$match':{'name':_0x402939,'room':_0x300995}},{'$unwind':_0x91bd35(0x209)},{'$match':{'product_details.secondary_code':_0x20b949}},{'$group':{'_id':_0x91bd35(0x1ff),'name':{'$first':_0x91bd35(0x2a7)},'product_stock':{'$first':_0x91bd35(0x28d)},'primary_code':{'$first':_0x91bd35(0x263)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x91bd35(0x200)},'level':{'$first':_0x91bd35(0x28f)},'isle':{'$first':_0x91bd35(0x221)},'type':{'$first':_0x91bd35(0x245)},'pallet':{'$first':_0x91bd35(0x296)},'unit':{'$first':_0x91bd35(0x258)},'secondary_unit':{'$first':_0x91bd35(0x1ea)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x91bd35(0x21c)},'expiry_date':{'$first':_0x91bd35(0x29f)},'production_date':{'$first':_0x91bd35(0x246)},'batch_code':{'$first':_0x91bd35(0x273)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x91bd35(0x1e3)},'roomNamed':{'$first':_0x91bd35(0x25a)},'invoice':{'$first':_0x91bd35(0x27c)}}}]);if(_0x19b6f8[_0x91bd35(0x28c)]>0x0)_0x229024[_0x91bd35(0x2a2)](_0x19b6f8);else _0x4bfe13[_0x91bd35(0x28c)]>0x0&&_0x229024[_0x91bd35(0x2a2)](_0x4bfe13);}const _0x1338c6=_0x5c16eb['map'](_0x4bc504=>_0x2bfb8e(_0x4bc504));await Promise['all'](_0x1338c6),_0x5e7e71['json'](_0x229024);}),router[a0_0x1b5c36(0x229)](a0_0x1b5c36(0x20f),async(_0x4dc9b8,_0x2ef248)=>{var _0x361b44=a0_0x1b5c36;const {productCode:_0x11dca6,bay:_0x306776,warehouses:_0x2f51d5,room:_0x3494b0}=_0x4dc9b8[_0x361b44(0x259)];console[_0x361b44(0x29a)](_0x4dc9b8[_0x361b44(0x259)]);try{const _0x3c0c2b=await warehouse[_0x361b44(0x23e)]([{'$match':{'name':_0x2f51d5,'room':_0x3494b0}},{'$unwind':_0x361b44(0x209)},{'$match':{'product_details.bay':parseInt(_0x306776)}},{'$group':{'_id':_0x361b44(0x1ff),'name':{'$first':_0x361b44(0x2a7)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x361b44(0x28f)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2ef248[_0x361b44(0x2a8)](0xc8)['json'](_0x3c0c2b);}catch(_0x204e43){_0x2ef248[_0x361b44(0x2a8)](0x194)[_0x361b44(0x253)]({'message':_0x204e43['message']});}}),module[a0_0x1b5c36(0x22a)]=router;