var a0_0x2f5586=a0_0x1b97;(function(_0x256eac,_0x35ea41){var _0x2671b6=a0_0x1b97,_0x4e7776=_0x256eac();while(!![]){try{var _0x577434=parseInt(_0x2671b6(0x157))/0x1*(parseInt(_0x2671b6(0x1ce))/0x2)+-parseInt(_0x2671b6(0x14c))/0x3*(-parseInt(_0x2671b6(0x178))/0x4)+-parseInt(_0x2671b6(0x142))/0x5+parseInt(_0x2671b6(0x166))/0x6*(-parseInt(_0x2671b6(0x154))/0x7)+-parseInt(_0x2671b6(0x199))/0x8+parseInt(_0x2671b6(0x13c))/0x9*(parseInt(_0x2671b6(0x1ba))/0xa)+-parseInt(_0x2671b6(0x185))/0xb;if(_0x577434===_0x35ea41)break;else _0x4e7776['push'](_0x4e7776['shift']());}catch(_0x4a9ca5){_0x4e7776['push'](_0x4e7776['shift']());}}}(a0_0x5dca,0x1c404));const express=require(a0_0x2f5586(0x13e)),app=express(),router=express['Router'](),auth=require(a0_0x2f5586(0x132)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x2f5586(0x138)),users=require(a0_0x2f5586(0x187)),nodemailer=require(a0_0x2f5586(0x141));router[a0_0x2f5586(0x1a9)](a0_0x2f5586(0x1b8),auth,async(_0x2336e9,_0x1cefca)=>{var _0xfa5b28=a0_0x2f5586;try{const {username:_0x5ac51f,email:_0x2212a9,role:_0x3e73dc}=_0x2336e9['user'],_0x3615d0=_0x2336e9[_0xfa5b28(0x1b7)],_0xebc3ed=await profile['findOne']({'email':_0x3615d0[_0xfa5b28(0x15f)]}),_0x44f260=await master_shop[_0xfa5b28(0x18f)]();let _0x48c075;if(_0x3615d0[_0xfa5b28(0x163)]=='staff'){const _0x2b5adb=await staff[_0xfa5b28(0x180)]({'email':_0x3615d0[_0xfa5b28(0x15f)]});_0x48c075=await warehouse[_0xfa5b28(0x18f)]({'status':_0xfa5b28(0x1de),'name':_0x2b5adb[_0xfa5b28(0x1ad)]});}else _0x48c075=await warehouse[_0xfa5b28(0x18f)]({'status':_0xfa5b28(0x1de)});const _0x10e187=await product[_0xfa5b28(0x18f)]();let _0x4c46b6;if(_0x3615d0['role']==_0xfa5b28(0x1ec)){const _0x592da9=await staff['findOne']({'email':_0x3615d0[_0xfa5b28(0x15f)]});_0x4c46b6=await adjustment_finished[_0xfa5b28(0x18f)]({'warehouse_name':_0x592da9[_0xfa5b28(0x1ad)]});}else _0x4c46b6=await adjustment_finished[_0xfa5b28(0x1ab)]([{'$unwind':_0xfa5b28(0x135)},{'$group':{'_id':_0xfa5b28(0x1a5),'invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0xfa5b28(0x161)},'room':{'$addToSet':_0xfa5b28(0x1db)},'finalize':{'$first':_0xfa5b28(0x1e9)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x44f260[0x0][_0xfa5b28(0x16a)]=='English\x20(US)'){var _0x4164ae=users[_0xfa5b28(0x1dc)];console[_0xfa5b28(0x16c)](_0x4164ae);}else{if(_0x44f260[0x0][_0xfa5b28(0x16a)]=='Hindi')var _0x4164ae=users[_0xfa5b28(0x1d3)];else{if(_0x44f260[0x0][_0xfa5b28(0x16a)]==_0xfa5b28(0x17d))var _0x4164ae=users[_0xfa5b28(0x17d)];else{if(_0x44f260[0x0][_0xfa5b28(0x16a)]==_0xfa5b28(0x14a))var _0x4164ae=users[_0xfa5b28(0x14a)];else{if(_0x44f260[0x0][_0xfa5b28(0x16a)]==_0xfa5b28(0x18e))var _0x4164ae=users['French'];else{if(_0x44f260[0x0][_0xfa5b28(0x16a)]=='Portuguese\x20(BR)')var _0x4164ae=users[_0xfa5b28(0x18a)];else{if(_0x44f260[0x0][_0xfa5b28(0x16a)]==_0xfa5b28(0x149))var _0x4164ae=users[_0xfa5b28(0x149)];else{if(_0x44f260[0x0][_0xfa5b28(0x16a)]=='Arabic\x20(ae)')var _0x4164ae=users[_0xfa5b28(0x140)];}}}}}}}_0x1cefca[_0xfa5b28(0x1b1)](_0xfa5b28(0x175),{'success':_0x2336e9[_0xfa5b28(0x195)](_0xfa5b28(0x1a4)),'errors':_0x2336e9[_0xfa5b28(0x195)](_0xfa5b28(0x17e)),'role':_0x3615d0,'profile':_0xebc3ed,'warehouse':_0x48c075,'product':_0x10e187,'adjustment':_0x4c46b6,'master_shop':_0x44f260,'language':_0x4164ae});}catch(_0x427ee4){console[_0xfa5b28(0x16c)](_0x427ee4);}});function a0_0x1b97(_0x3ebc63,_0x339acd){var _0x5dcae6=a0_0x5dca();return a0_0x1b97=function(_0x1b976e,_0x2e0672){_0x1b976e=_0x1b976e-0x12d;var _0x30e394=_0x5dcae6[_0x1b976e];return _0x30e394;},a0_0x1b97(_0x3ebc63,_0x339acd);}async function getRandom8DigitNumber(){var _0x576dad=a0_0x2f5586;const _0x46589f=0x989680,_0x54c3b1=0x5f5e0ff,_0x461b14=Math['floor'](Math['random']()*(_0x54c3b1-_0x46589f+0x1))+_0x46589f;var _0x427cde;const _0x136713=await adjustment_finished[_0x576dad(0x180)]({'invoice':_0x576dad(0x1d7)+_0x461b14});return _0x136713&&_0x136713[_0x576dad(0x150)]>0x0?_0x427cde='ADJF-'+_0x461b14:_0x427cde='ADJF-'+_0x461b14,_0x427cde;}router[a0_0x2f5586(0x1a9)]('/view/add_adjustment',auth,async(_0x902886,_0x93f67b)=>{var _0x394b21=a0_0x2f5586;try{const {username:_0x3c4d64,email:_0x3ac32c,role:_0x3e71ad}=_0x902886[_0x394b21(0x1b7)],_0x34b8aa=_0x902886[_0x394b21(0x1b7)],_0x38a4d3=await profile[_0x394b21(0x180)]({'email':_0x34b8aa[_0x394b21(0x15f)]}),_0x4afb1e=await master_shop[_0x394b21(0x18f)]();let _0x3d261b;if(_0x34b8aa[_0x394b21(0x163)]==_0x394b21(0x1ec)){const _0x1e8f3d=await staff[_0x394b21(0x180)]({'email':_0x34b8aa[_0x394b21(0x15f)]});_0x3d261b=await warehouse['aggregate']([{'$match':{'status':_0x394b21(0x1de),'name':_0x1e8f3d['warehouse'],'warehouse_category':_0x394b21(0x194),'name':{'$ne':_0x394b21(0x16e)}}},{'$group':{'_id':_0x394b21(0x1c8),'name':{'$first':_0x394b21(0x1c8)}}}]);}else _0x3d261b=await warehouse[_0x394b21(0x1ab)]([{'$match':{'status':'Enabled','warehouse_category':_0x394b21(0x194),'name':{'$ne':_0x394b21(0x16e)}}},{'$group':{'_id':_0x394b21(0x1c8),'name':{'$first':_0x394b21(0x1c8)}}}]);const _0x4d5f11=await product['find']({}),_0x53852c=await adjustment_finished[_0x394b21(0x18f)]({}),_0xd97440=_0x53852c[_0x394b21(0x150)]+0x1,_0xb06084=_0x394b21(0x1d7)+_0xd97440['toString']()['padStart'](0x5,'0');var _0x2dd080=[_0x394b21(0x1e8),_0x394b21(0x133),_0x394b21(0x152)];if(_0x4afb1e[0x0][_0x394b21(0x16a)]==_0x394b21(0x1c6))var _0x5effeb=users[_0x394b21(0x1dc)];else{if(_0x4afb1e[0x0][_0x394b21(0x16a)]==_0x394b21(0x1d3))var _0x5effeb=users['Hindi'];else{if(_0x4afb1e[0x0][_0x394b21(0x16a)]==_0x394b21(0x17d))var _0x5effeb=users[_0x394b21(0x17d)];else{if(_0x4afb1e[0x0]['language']==_0x394b21(0x14a))var _0x5effeb=users['Spanish'];else{if(_0x4afb1e[0x0][_0x394b21(0x16a)]==_0x394b21(0x18e))var _0x5effeb=users['French'];else{if(_0x4afb1e[0x0]['language']=='Portuguese\x20(BR)')var _0x5effeb=users[_0x394b21(0x18a)];else{if(_0x4afb1e[0x0]['language']==_0x394b21(0x149))var _0x5effeb=users[_0x394b21(0x149)];else{if(_0x4afb1e[0x0][_0x394b21(0x16a)]==_0x394b21(0x1aa))var _0x5effeb=users['Arabic'];}}}}}}}const _0xdbacb2=getRandom8DigitNumber();_0xdbacb2[_0x394b21(0x15c)](_0x3a2a87=>{var _0x50f2c5=_0x394b21;_0x93f67b[_0x50f2c5(0x1b1)]('add_adjustment_finished',{'success':_0x902886[_0x50f2c5(0x195)](_0x50f2c5(0x1a4)),'errors':_0x902886[_0x50f2c5(0x195)](_0x50f2c5(0x17e)),'role':_0x34b8aa,'profile':_0x38a4d3,'warehouse':_0x3d261b,'product':_0x4d5f11,'master_shop':_0x4afb1e,'language':_0x5effeb,'rooms_data':_0x2dd080,'invoice_no':_0x3a2a87});})[_0x394b21(0x16d)](_0x557f80=>{var _0x5c72b2=_0x394b21;_0x902886[_0x5c72b2(0x195)](_0x5c72b2(0x17e),_0x5c72b2(0x1d4)),_0x93f67b[_0x5c72b2(0x14f)](_0x5c72b2(0x172));});}catch(_0x5d79e1){console[_0x394b21(0x16c)](_0x5d79e1);}}),router[a0_0x2f5586(0x192)]('/view/add_adjustment',auth,async(_0x39887f,_0x549f43)=>{var _0x3bd473=a0_0x2f5586;try{const {warehouse_name:_0x46e51b,date:_0x156afe,prod_name:_0x465504,level:_0x3ba8a3,isle:_0x323a89,pallet:_0x1fc2b0,stock:_0x56d356,types:_0x3beddc,adjust_qty:_0x225d66,new_adjust_qty:_0x20ca5c,note:_0x11184b,Room_name:_0x4a950f,invoice:_0x39538b,JO_number:_0x1ae091,expiry_date:_0x37a921}=_0x39887f['body'];if(typeof _0x465504=='string')var _0x5cb1e5=[_0x39887f['body'][_0x3bd473(0x1d0)]],_0x1e3537=[_0x39887f[_0x3bd473(0x193)]['level']],_0x323ef3=[_0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1b5)]],_0x57b9f9=[_0x39887f[_0x3bd473(0x193)][_0x3bd473(0x145)]],_0x2ff2ea=[_0x39887f['body'][_0x3bd473(0x1c3)]],_0x1db0d9=[_0x39887f[_0x3bd473(0x193)][_0x3bd473(0x177)]],_0x3d4266=[_0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1e2)]],_0x291335=[_0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1b2)]],_0x49fb51=[_0x39887f[_0x3bd473(0x193)][_0x3bd473(0x17b)]],_0x58b885=[_0x39887f[_0x3bd473(0x193)]['batch_code']],_0x43d7ca=[_0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1d5)]],_0x2f550f=[_0x39887f['body'][_0x3bd473(0x164)]],_0x5df337=[_0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1eb)]],_0x3ca528=[_0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1c1)]],_0x498951=[_0x39887f[_0x3bd473(0x193)]['maxPerUnit']],_0x3eb6c0=[_0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1c0)]];else var _0x5cb1e5=[..._0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1d0)]],_0x1e3537=[..._0x39887f['body'][_0x3bd473(0x1da)]],_0x323ef3=[..._0x39887f['body'][_0x3bd473(0x1b5)]],_0x57b9f9=[..._0x39887f['body'][_0x3bd473(0x145)]],_0x2ff2ea=[..._0x39887f[_0x3bd473(0x193)]['New_Qty_Converted_adj']],_0x1db0d9=[..._0x39887f[_0x3bd473(0x193)]['New_Qty_Converted']],_0x3d4266=[..._0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1e2)]],_0x291335=[..._0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1b2)]],_0x49fb51=[..._0x39887f['body']['prod_code']],_0x58b885=[..._0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1d1)]],_0x43d7ca=[..._0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1d5)]],_0x2f550f=[..._0x39887f[_0x3bd473(0x193)][_0x3bd473(0x164)]],_0x5df337=[..._0x39887f['body'][_0x3bd473(0x1eb)]],_0x3ca528=[..._0x39887f[_0x3bd473(0x193)][_0x3bd473(0x1c1)]],_0x498951=[..._0x39887f[_0x3bd473(0x193)][_0x3bd473(0x198)]],_0x3eb6c0=[..._0x39887f['body']['prod_invoice']];const _0x4b21ec=_0x5cb1e5[_0x3bd473(0x1b0)](_0x29bdaa=>{return _0x29bdaa={'product_name':_0x29bdaa};});_0x1e3537[_0x3bd473(0x170)]((_0x3b63b5,_0x709c53)=>{_0x4b21ec[_0x709c53]['bay']=_0x3b63b5;}),_0x323ef3[_0x3bd473(0x170)]((_0x4de0af,_0x2c9440)=>{_0x4b21ec[_0x2c9440]['stockBefore']=_0x4de0af;}),_0x57b9f9[_0x3bd473(0x170)]((_0x3fc17b,_0xd66c2)=>{var _0x25b1cb=_0x3bd473;_0x4b21ec[_0xd66c2][_0x25b1cb(0x145)]=_0x3fc17b;}),_0x2ff2ea[_0x3bd473(0x170)]((_0x3322be,_0xd95251)=>{var _0x1eb530=_0x3bd473;_0x4b21ec[_0xd95251][_0x1eb530(0x18b)]=_0x3322be;}),_0x1db0d9[_0x3bd473(0x170)]((_0x19db87,_0x1d8c21)=>{_0x4b21ec[_0x1d8c21]['new_adjust_qty']=_0x19db87;}),_0x3d4266[_0x3bd473(0x170)]((_0x2a1b56,_0x50360c)=>{var _0x3a60b9=_0x3bd473;_0x4b21ec[_0x50360c][_0x3a60b9(0x15d)]=_0x2a1b56;}),_0x291335[_0x3bd473(0x170)]((_0x4591b1,_0xe7493)=>{_0x4b21ec[_0xe7493]['secondary_unit']=_0x4591b1;}),_0x49fb51[_0x3bd473(0x170)]((_0xf2bbdb,_0x205496)=>{_0x4b21ec[_0x205496]['product_code']=_0xf2bbdb;}),_0x58b885[_0x3bd473(0x170)]((_0x1650d2,_0x398e38)=>{var _0x45ab97=_0x3bd473;_0x4b21ec[_0x398e38][_0x45ab97(0x1d1)]=_0x1650d2;}),_0x43d7ca['forEach']((_0x43d5cc,_0x5306e4)=>{var _0x38f0cd=_0x3bd473;_0x4b21ec[_0x5306e4][_0x38f0cd(0x1d5)]=_0x43d5cc;}),_0x2f550f[_0x3bd473(0x170)]((_0x2d5cda,_0x550d2d)=>{var _0x3ac7f6=_0x3bd473;_0x4b21ec[_0x550d2d][_0x3ac7f6(0x147)]=_0x2d5cda;}),_0x5df337['forEach']((_0x4510d0,_0x3178b6)=>{var _0x59c542=_0x3bd473;_0x4b21ec[_0x3178b6][_0x59c542(0x1eb)]=_0x4510d0;}),_0x3ca528[_0x3bd473(0x170)]((_0x132183,_0x261e55)=>{var _0x561f5f=_0x3bd473;_0x4b21ec[_0x261e55][_0x561f5f(0x1af)]=_0x132183;}),_0x498951['forEach']((_0x361fd0,_0x5d2c13)=>{var _0x51c801=_0x3bd473;_0x4b21ec[_0x5d2c13][_0x51c801(0x198)]=_0x361fd0;}),_0x3eb6c0['forEach']((_0xc9556e,_0x2f03c5)=>{_0x4b21ec[_0x2f03c5]['invoice']=_0xc9556e;});const _0x1a2fb9=_0x4b21ec[_0x3bd473(0x136)](_0x4a0c83=>_0x4a0c83[_0x3bd473(0x18b)]!=='0'&&_0x4a0c83[_0x3bd473(0x18b)]!=='');var _0x349df5=0x0;_0x1a2fb9[_0x3bd473(0x170)](_0x22e097=>{var _0x543c44=_0x3bd473;console[_0x543c44(0x16c)]('foreach\x20newproduct',_0x22e097),parseInt(_0x22e097['adjust_qty'])<=0x0&&_0x349df5++;});if(_0x349df5!=0x0)return _0x39887f[_0x3bd473(0x195)](_0x3bd473(0x17e),_0x3bd473(0x1e4)),_0x549f43[_0x3bd473(0x14f)]('back');const _0x2ce517=new adjustment_finished({'warehouse_name':_0x46e51b,'date':_0x156afe,'product':_0x1a2fb9,'note':_0x11184b,'room':_0x4a950f,'invoice':_0x39538b,'JO_number':_0x1ae091,'expiry_date':_0x37a921}),_0x3f0781=await _0x2ce517[_0x3bd473(0x173)]();_0x39887f[_0x3bd473(0x195)](_0x3bd473(0x1a4),_0x3bd473(0x1cf)),_0x549f43['redirect'](_0x3bd473(0x156)+_0x3f0781['_id']);}catch(_0x4ea335){console['log'](_0x4ea335),_0x549f43['status'](0xc8)[_0x3bd473(0x19a)]({'message':_0x4ea335['message']});}}),router[a0_0x2f5586(0x1a9)]('/preview/:id',auth,async(_0x3eec93,_0x5ddfdb)=>{var _0x700f7e=a0_0x2f5586;try{const {username:_0x2a9e12,email:_0x4d6347,role:_0x5bc98e}=_0x3eec93['user'],_0x102530=_0x3eec93[_0x700f7e(0x1b7)],_0x1dcf1a=await profile[_0x700f7e(0x180)]({'email':_0x102530[_0x700f7e(0x15f)]}),_0x9e5f1a=await master_shop[_0x700f7e(0x18f)](),_0x1720d9=_0x3eec93[_0x700f7e(0x19b)]['id'],_0x429d8f=await adjustment_finished[_0x700f7e(0x1bd)]({'_id':_0x1720d9}),_0x3d177f=await purchases[_0x700f7e(0x1ab)]([{'$match':{'warehouse_name':_0x429d8f[_0x700f7e(0x1a3)]}},{'$unwind':_0x700f7e(0x135)},{'$group':{'_id':_0x700f7e(0x162)}}]);console['log'](_0x700f7e(0x1a0),_0x3d177f);const _0x60a5a8=await product[_0x700f7e(0x18f)]({}),_0x1d6c2b=await warehouse['aggregate']([{'$match':{'name':_0x429d8f[_0x700f7e(0x1a3)],'warehouse_category':_0x700f7e(0x194)}},{'$unwind':_0x700f7e(0x1d8)},{'$group':{'_id':_0x700f7e(0x155),'name':{'$first':_0x700f7e(0x1a2)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x700f7e(0x160)},'bin':{'$first':_0x700f7e(0x190)},'type':{'$first':_0x700f7e(0x176)},'floorlevel':{'$first':_0x700f7e(0x1d6)},'primary_code':{'$first':_0x700f7e(0x1a1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x700f7e(0x1d2)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x700f7e(0x181)},'batch_code':{'$first':_0x700f7e(0x18c)},'maxPerUnit':{'$first':_0x700f7e(0x1ca)},'room':{'$first':_0x700f7e(0x17c)}}}]);if(_0x9e5f1a[0x0][_0x700f7e(0x16a)]==_0x700f7e(0x1c6)){var _0x18caed=users[_0x700f7e(0x1dc)];console[_0x700f7e(0x16c)](_0x18caed);}else{if(_0x9e5f1a[0x0][_0x700f7e(0x16a)]==_0x700f7e(0x1d3))var _0x18caed=users['Hindi'];else{if(_0x9e5f1a[0x0][_0x700f7e(0x16a)]=='German')var _0x18caed=users[_0x700f7e(0x17d)];else{if(_0x9e5f1a[0x0][_0x700f7e(0x16a)]==_0x700f7e(0x14a))var _0x18caed=users[_0x700f7e(0x14a)];else{if(_0x9e5f1a[0x0][_0x700f7e(0x16a)]==_0x700f7e(0x18e))var _0x18caed=users[_0x700f7e(0x18e)];else{if(_0x9e5f1a[0x0][_0x700f7e(0x16a)]==_0x700f7e(0x168))var _0x18caed=users[_0x700f7e(0x18a)];else{if(_0x9e5f1a[0x0][_0x700f7e(0x16a)]==_0x700f7e(0x149))var _0x18caed=users[_0x700f7e(0x149)];else{if(_0x9e5f1a[0x0][_0x700f7e(0x16a)]=='Arabic\x20(ae)')var _0x18caed=users[_0x700f7e(0x140)];}}}}}}}_0x5ddfdb['render']('edit_adjustment_finished_view',{'success':_0x3eec93[_0x700f7e(0x195)]('success'),'errors':_0x3eec93[_0x700f7e(0x195)]('errors'),'role':_0x102530,'profile':_0x1dcf1a,'adjustment':_0x429d8f,'stock':_0x1d6c2b,'master_shop':_0x9e5f1a,'warehouse_name':_0x3d177f,'unit':_0x60a5a8,'language':_0x18caed});}catch(_0x6910d6){console['log'](_0x6910d6),_0x5ddfdb[_0x700f7e(0x130)](0xc8)[_0x700f7e(0x19a)]({'message':_0x6910d6[_0x700f7e(0x1b4)]});}}),router[a0_0x2f5586(0x192)](a0_0x2f5586(0x1e7),auth,async(_0x221642,_0x20def7)=>{var _0x592dee=a0_0x2f5586;try{const {invoice:_0x1ccc10,warehouse_name:_0x181372,Room_name:_0x5551aa}=_0x221642[_0x592dee(0x193)],_0x329b17=_0x221642['params']['id'],_0x550378=await adjustment_finished[_0x592dee(0x1bd)]({'_id':_0x329b17});var _0x31b8d6;const _0x14b34e=_0x550378['product'][_0x592dee(0x1b0)](async _0x3df3f9=>{var _0xe5a204=_0x592dee;if(_0x3df3f9[_0xe5a204(0x18b)]>0x0){_0x31b8d6=await warehouse[_0xe5a204(0x180)]({'name':_0x181372,'room':_0x3df3f9['room_names'],'warehouse_category':_0xe5a204(0x194)});const _0x29b383=_0x31b8d6[_0xe5a204(0x144)][_0xe5a204(0x1b0)](_0x4753b4=>{var _0x46feba=_0xe5a204;console[_0x46feba(0x16c)](_0x3df3f9[_0x46feba(0x145)]);if(_0x3df3f9[_0x46feba(0x145)]=='minus')_0x4753b4['product_name']==_0x3df3f9[_0x46feba(0x167)]&&_0x4753b4[_0x46feba(0x1dd)]==_0x3df3f9['bay']&&_0x4753b4[_0x46feba(0x1d5)]==_0x3df3f9[_0x46feba(0x1d5)]&&_0x4753b4['production_date']==_0x3df3f9[_0x46feba(0x147)]&&_0x4753b4[_0x46feba(0x1d1)]==_0x3df3f9[_0x46feba(0x1d1)]&&_0x4753b4[_0x46feba(0x143)]==_0x3df3f9[_0x46feba(0x143)]&&(_0x4753b4[_0x46feba(0x186)]=_0x4753b4['product_stock']-_0x3df3f9['adjust_qty']);else _0x3df3f9['types']==_0x46feba(0x1bf)&&(_0x4753b4[_0x46feba(0x167)]==_0x3df3f9['product_name']&&_0x4753b4['bay']==_0x3df3f9[_0x46feba(0x1dd)]&&_0x4753b4[_0x46feba(0x1d5)]==_0x3df3f9[_0x46feba(0x1d5)]&&_0x4753b4[_0x46feba(0x147)]==_0x3df3f9['production_date']&&_0x4753b4['batch_code']==_0x3df3f9[_0x46feba(0x1d1)]&&_0x4753b4[_0x46feba(0x143)]==_0x3df3f9[_0x46feba(0x143)]&&(_0x4753b4[_0x46feba(0x186)]=_0x4753b4['product_stock']+_0x3df3f9['adjust_qty']));});}return _0x31b8d6;});Promise[_0x592dee(0x1ef)](_0x14b34e)[_0x592dee(0x15c)](async _0x58abb4=>{var _0x3de8b2=_0x592dee;try{for(const _0x17fe6f of _0x58abb4){await _0x17fe6f[_0x3de8b2(0x173)]();}_0x550378['finalize']=_0x3de8b2(0x1bc);const _0x86e21e=await _0x550378[_0x3de8b2(0x173)](),_0x1cd38a=await master_shop[_0x3de8b2(0x18f)](),_0x24d3a3=await email_settings[_0x3de8b2(0x180)](),_0x502860=await supervisor_settings[_0x3de8b2(0x18f)]();var _0x6e7e8e=_0x550378[_0x3de8b2(0x13f)],_0x3f7675='',_0x5a25c7;for(_0x5a25c7 in _0x6e7e8e){var _0x4d5c98='FG';_0x550378[_0x3de8b2(0x1a3)]==_0x3de8b2(0x19c)&&(_0x4d5c98='DG'),_0x3f7675+=_0x3de8b2(0x197)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x6e7e8e[_0x5a25c7]['product_name']+_0x3de8b2(0x14d)+_0x3de8b2(0x134)+_0x6e7e8e[_0x5a25c7]['product_code']+_0x3de8b2(0x14d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x6e7e8e[_0x5a25c7][_0x3de8b2(0x18b)]+_0x3de8b2(0x14d)+_0x3de8b2(0x134)+_0x6e7e8e[_0x5a25c7]['unit']+_0x3de8b2(0x14d)+_0x3de8b2(0x134)+_0x6e7e8e[_0x5a25c7][_0x3de8b2(0x13a)]+_0x3de8b2(0x14d)+_0x3de8b2(0x134)+_0x550378[_0x3de8b2(0x1a3)]+_0x3de8b2(0x14d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x6e7e8e[_0x5a25c7][_0x3de8b2(0x1af)]+_0x3de8b2(0x14d)+_0x3de8b2(0x134)+_0x4d5c98+_0x6e7e8e[_0x5a25c7][_0x3de8b2(0x1dd)]+_0x3de8b2(0x14d)+_0x3de8b2(0x165);}let _0x4ce5cc=nodemailer[_0x3de8b2(0x1e3)]({'host':_0x24d3a3[_0x3de8b2(0x1a7)],'port':Number(_0x24d3a3[_0x3de8b2(0x19f)]),'secure':![],'auth':{'user':_0x24d3a3['email'],'pass':_0x24d3a3[_0x3de8b2(0x182)]}}),_0x2e76b0={'from':_0x24d3a3[_0x3de8b2(0x15f)],'to':_0x502860[0x0][_0x3de8b2(0x15b)],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x3de8b2(0x174)+'/upload/'+_0x1cd38a[0x0][_0x3de8b2(0x196)],'cid':_0x3de8b2(0x1e1)}],'html':_0x3de8b2(0x17a)+'<html><head><title></title>'+_0x3de8b2(0x169)+_0x3de8b2(0x1cc)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x3de8b2(0x1cc)+_0x3de8b2(0x1ea)+_0x3de8b2(0x1c2)+_0x3de8b2(0x1cc)+_0x3de8b2(0x1b3)+_0x1cd38a[0x0][_0x3de8b2(0x1c9)]+'\x20</h2>'+_0x3de8b2(0x1c2)+_0x3de8b2(0x1c2)+_0x3de8b2(0x1ac)+_0x3de8b2(0x1cc)+_0x3de8b2(0x14e)+'\x20Order\x20Number\x20:\x20'+_0x550378[_0x3de8b2(0x143)]+'\x20'+_0x3de8b2(0x1df)+_0x3de8b2(0x12d)+_0x550378[_0x3de8b2(0x1ee)]+'\x20'+_0x3de8b2(0x1b9)+_0x3de8b2(0x1c4)+_0x3de8b2(0x1c2)+_0x3de8b2(0x15e)+_0x3de8b2(0x158)+'<tr>'+_0x3de8b2(0x19e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x3de8b2(0x1ae)+_0x3de8b2(0x1cb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x3de8b2(0x1d9)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x3de8b2(0x131)+_0x3de8b2(0x165)+_0x3de8b2(0x146)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x3f7675+'\x20'+_0x3de8b2(0x12e)+'</table>'+_0x3de8b2(0x1cc)+_0x3de8b2(0x16f)+_0x3de8b2(0x13d)+_0x1cd38a[0x0][_0x3de8b2(0x1c9)]+_0x3de8b2(0x1c4)+'</div>'+_0x3de8b2(0x1c2)+'</body></html>'};_0x4ce5cc['sendMail'](_0x2e76b0,function(_0x37332d,_0x5638cf){var _0x1b0c70=_0x3de8b2;_0x37332d?(console[_0x1b0c70(0x16c)](_0x37332d),console['log'](_0x1b0c70(0x148))):console[_0x1b0c70(0x16c)](_0x1b0c70(0x1a8));}),_0x221642[_0x3de8b2(0x195)](_0x3de8b2(0x1a4),_0x3de8b2(0x1bb)),_0x20def7[_0x3de8b2(0x14f)](_0x3de8b2(0x19d)+_0x86e21e[_0x3de8b2(0x151)]);}catch(_0x110f03){console[_0x3de8b2(0x179)](_0x110f03),_0x20def7[_0x3de8b2(0x130)](0x1f4)['json']({'error':_0x3de8b2(0x139)});}})[_0x592dee(0x16d)](_0x46f86e=>{var _0x3810fa=_0x592dee;console[_0x3810fa(0x179)](_0x46f86e),_0x20def7[_0x3810fa(0x130)](0x1f4)[_0x3810fa(0x19a)]({'error':'An\x20error\x20occurred.'});});}catch(_0x10f3db){_0x20def7[_0x592dee(0x19a)]({'message':_0x10f3db[_0x592dee(0x1b4)]});}}),router['get'](a0_0x2f5586(0x184),auth,async(_0x506886,_0x52df25)=>{var _0x1b1900=a0_0x2f5586;try{const {username:_0x188122,email:_0x380a41,role:_0x4d50d3}=_0x506886['user'],_0x5a171d=_0x506886[_0x1b1900(0x1b7)],_0x2b7f05=await profile[_0x1b1900(0x180)]({'email':_0x5a171d[_0x1b1900(0x15f)]}),_0x2f3807=await master_shop[_0x1b1900(0x18f)]();console[_0x1b1900(0x16c)](_0x1b1900(0x171),_0x2f3807);const _0x388b51=_0x506886[_0x1b1900(0x19b)]['id'],_0x106e0e=await adjustment_finished['findById']({'_id':_0x388b51});let _0x341a2c=new Date(_0x106e0e[_0x1b1900(0x1d5)]),_0xbd7549=('0'+_0x341a2c[_0x1b1900(0x1b6)]())['slice'](-0x2),_0x47bc25=('0'+(_0x341a2c[_0x1b1900(0x1cd)]()+0x1))[_0x1b1900(0x14b)](-0x2),_0x917eae=_0x341a2c[_0x1b1900(0x159)](),_0x323607=_0x917eae+'-'+_0x47bc25+'-'+_0xbd7549;var _0x300d1c=[_0x1b1900(0x1e8),_0x1b1900(0x133),_0x1b1900(0x152)];const _0x196def=await purchases[_0x1b1900(0x1ab)]([{'$match':{'warehouse_name':_0x106e0e[_0x1b1900(0x1a3)]}},{'$unwind':_0x1b1900(0x135)},{'$group':{'_id':'$product.product_name'}}]);console[_0x1b1900(0x16c)](_0x1b1900(0x1a0),_0x196def);const _0x48311d=await product['find']({}),_0x14abf7=await warehouse[_0x1b1900(0x1ab)]([{'$match':{'name':_0x106e0e[_0x1b1900(0x1a3)],'room':_0x106e0e['room']}},{'$unwind':_0x1b1900(0x1d8)},{'$group':{'_id':_0x1b1900(0x155),'name':{'$first':_0x1b1900(0x1a2)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1b1900(0x160)},'bin':{'$first':_0x1b1900(0x190)},'type':{'$first':_0x1b1900(0x176)},'floorlevel':{'$first':_0x1b1900(0x1d6)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1b1900(0x1e0)},'storage':{'$first':_0x1b1900(0x188)},'rack':{'$first':'$product_details.rack'}}}]);if(_0x2f3807[0x0][_0x1b1900(0x16a)]==_0x1b1900(0x1c6)){var _0xc32814=users[_0x1b1900(0x1dc)];console['log'](_0xc32814);}else{if(_0x2f3807[0x0][_0x1b1900(0x16a)]==_0x1b1900(0x1d3))var _0xc32814=users[_0x1b1900(0x1d3)];else{if(_0x2f3807[0x0][_0x1b1900(0x16a)]=='German')var _0xc32814=users[_0x1b1900(0x17d)];else{if(_0x2f3807[0x0][_0x1b1900(0x16a)]==_0x1b1900(0x14a))var _0xc32814=users[_0x1b1900(0x14a)];else{if(_0x2f3807[0x0][_0x1b1900(0x16a)]==_0x1b1900(0x18e))var _0xc32814=users['French'];else{if(_0x2f3807[0x0][_0x1b1900(0x16a)]==_0x1b1900(0x168))var _0xc32814=users[_0x1b1900(0x18a)];else{if(_0x2f3807[0x0][_0x1b1900(0x16a)]==_0x1b1900(0x149))var _0xc32814=users['Chinese'];else{if(_0x2f3807[0x0][_0x1b1900(0x16a)]==_0x1b1900(0x1aa))var _0xc32814=users[_0x1b1900(0x140)];}}}}}}}_0x52df25['render']('edit_adjustment_finished',{'success':_0x506886[_0x1b1900(0x195)](_0x1b1900(0x1a4)),'errors':_0x506886[_0x1b1900(0x195)](_0x1b1900(0x17e)),'role':_0x5a171d,'profile':_0x2b7f05,'adjustment':_0x106e0e,'stock':_0x14abf7,'master_shop':_0x2f3807,'warehouse_name':_0x196def,'unit':_0x48311d,'language':_0xc32814,'rooms_data':_0x300d1c,'ed_fullDate':_0x323607});}catch(_0x58c707){console[_0x1b1900(0x16c)](_0x58c707),_0x52df25[_0x1b1900(0x130)](0xc8)['json']({'message':_0x58c707[_0x1b1900(0x1b4)]});}}),router['post']('/view/:id',auth,async(_0x5b5885,_0x364b44)=>{var _0x2ec109=a0_0x2f5586;try{const _0x1d9063=_0x5b5885[_0x2ec109(0x19b)]['id'],_0x336d79=await adjustment_finished[_0x2ec109(0x1bd)]({'_id':_0x1d9063}),_0x5a28df=await warehouse['findOne']({'name':_0x336d79[_0x2ec109(0x1a3)],'room':_0x336d79[_0x2ec109(0x1be)]}),{warehouse_name:_0x2e8f2a,date:_0x490c87,prod_name:_0x32e217,level:_0x2bf8c0,isle:_0x521cd9,pallet:_0x266e3a,stock:_0x55a3d5,types:_0x331102,adjust_qty:_0x848e2f,new_adjust_qty:_0x5cdad4,note:_0x6b7692,Room_name:_0x2840dc,invoice:_0x5ebbf8,JO_number:_0x1b6b2c}=_0x5b5885[_0x2ec109(0x193)];if(typeof _0x32e217==_0x2ec109(0x1c7))var _0x4c69cd=[_0x5b5885[_0x2ec109(0x193)]['prod_name']],_0x2b6a8b=[_0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x1da)]],_0x55dbae=[_0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x1b5)]],_0x284fef=[_0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x145)]],_0x5c421c=[_0x5b5885['body']['adjust_qty']],_0x2ed071=[_0x5b5885[_0x2ec109(0x193)]['new_adjust_qty']],_0x5a72c0=[_0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x17b)]],_0x5cfbb4=[_0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x15d)]],_0x33c0ba=[_0x5b5885[_0x2ec109(0x193)]['Secondary_units']],_0x13361d=[_0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x1d1)]],_0x4f8b29=[_0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x1d5)]];else var _0x4c69cd=[..._0x5b5885['body']['prod_name']],_0x2b6a8b=[..._0x5b5885[_0x2ec109(0x193)]['level']],_0x55dbae=[..._0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x1b5)]],_0x284fef=[..._0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x145)]],_0x5c421c=[..._0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x18b)]],_0x2ed071=[..._0x5b5885[_0x2ec109(0x193)]['new_adjust_qty']],_0x5a72c0=[..._0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x17b)]],_0x5cfbb4=[..._0x5b5885[_0x2ec109(0x193)]['unit']],_0x33c0ba=[..._0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x1b2)]],_0x13361d=[..._0x5b5885[_0x2ec109(0x193)][_0x2ec109(0x1d1)]],_0x4f8b29=[..._0x5b5885[_0x2ec109(0x193)]['expiry_date']];const _0x4d3ec7=_0x4c69cd[_0x2ec109(0x1b0)](_0x5e7086=>{return _0x5e7086={'product_name':_0x5e7086};});_0x2b6a8b[_0x2ec109(0x170)]((_0x32f7a9,_0x20c663)=>{var _0x320006=_0x2ec109;_0x4d3ec7[_0x20c663][_0x320006(0x1dd)]=_0x32f7a9;}),_0x55dbae[_0x2ec109(0x170)]((_0x47687f,_0x239236)=>{_0x4d3ec7[_0x239236]['stockBefore']=_0x47687f;}),_0x284fef[_0x2ec109(0x170)]((_0x1c533f,_0x368f67)=>{_0x4d3ec7[_0x368f67]['types']=_0x1c533f;}),_0x5c421c[_0x2ec109(0x170)]((_0x747cbe,_0x30c14b)=>{var _0x41e966=_0x2ec109;_0x4d3ec7[_0x30c14b][_0x41e966(0x18b)]=_0x747cbe;}),_0x2ed071[_0x2ec109(0x170)]((_0x274991,_0x2cc128)=>{_0x4d3ec7[_0x2cc128]['new_adjust_qty']=_0x274991;}),_0x5cfbb4[_0x2ec109(0x170)]((_0x1e1619,_0xe875fd)=>{_0x4d3ec7[_0xe875fd]['unit']=_0x1e1619;}),_0x33c0ba[_0x2ec109(0x170)]((_0x3a98e6,_0x27d946)=>{var _0x987a1f=_0x2ec109;_0x4d3ec7[_0x27d946][_0x987a1f(0x13a)]=_0x3a98e6;}),_0x5a72c0[_0x2ec109(0x170)]((_0x185f29,_0x507b2a)=>{_0x4d3ec7[_0x507b2a]['product_code']=_0x185f29;}),_0x13361d[_0x2ec109(0x170)]((_0x11d4e7,_0xa4046)=>{var _0x7c3a60=_0x2ec109;_0x4d3ec7[_0xa4046][_0x7c3a60(0x1d1)]=_0x11d4e7;}),_0x4f8b29[_0x2ec109(0x170)]((_0x2afc65,_0x30258c)=>{var _0x2107e9=_0x2ec109;_0x4d3ec7[_0x30258c][_0x2107e9(0x1d5)]=_0x2afc65;});const _0x2c62d8=_0x4d3ec7['filter'](_0x438fdd=>_0x438fdd[_0x2ec109(0x18b)]!=='0'&&_0x438fdd[_0x2ec109(0x18b)]!=='');var _0x196099=0x0;_0x2c62d8[_0x2ec109(0x170)](_0x4c9073=>{var _0x1a6c15=_0x2ec109;console['log']('foreach\x20newproduct',_0x4c9073),parseInt(_0x4c9073[_0x1a6c15(0x18b)])<=0x0&&_0x196099++;});if(_0x196099!=0x0)return _0x5b5885[_0x2ec109(0x195)](_0x2ec109(0x17e),_0x2ec109(0x1e4)),_0x364b44[_0x2ec109(0x14f)](_0x2ec109(0x191));_0x336d79[_0x2ec109(0x1a3)]=_0x2e8f2a,_0x336d79['date']=_0x490c87,_0x336d79['product']=_0x2c62d8,_0x336d79[_0x2ec109(0x1e5)]=_0x6b7692,_0x336d79['room']=_0x2840dc,_0x336d79['invoice']=_0x5ebbf8,_0x336d79['JO_number']=_0x1b6b2c;const _0x4ae9f1=await _0x336d79[_0x2ec109(0x173)](),_0x1a6185=await warehouse[_0x2ec109(0x180)]({'name':_0x2e8f2a,'room':_0x2840dc});_0x4ae9f1[_0x2ec109(0x13f)]['forEach'](_0x3c3387=>{var _0x417b1b=_0x2ec109;const _0x15b5b1=_0x1a6185[_0x417b1b(0x144)][_0x417b1b(0x1b0)](_0x38603c=>{var _0x504dd5=_0x417b1b;_0x3c3387['types']==_0x504dd5(0x16b)?_0x38603c[_0x504dd5(0x167)]==_0x3c3387[_0x504dd5(0x167)]&&_0x38603c[_0x504dd5(0x1dd)]==_0x3c3387[_0x504dd5(0x1dd)]&&(_0x38603c['product_stock']=parseInt(_0x38603c['product_stock'])-parseInt(_0x3c3387[_0x504dd5(0x18b)])):_0x38603c[_0x504dd5(0x167)]==_0x3c3387[_0x504dd5(0x167)]&&_0x38603c[_0x504dd5(0x1dd)]==_0x3c3387['bay']&&(_0x38603c['product_stock']=parseInt(_0x38603c['product_stock'])+parseInt(_0x3c3387['adjust_qty']));});}),await _0x1a6185[_0x2ec109(0x173)](),_0x5b5885['flash']('success','adjustment\x20data\x20update\x20successfully'),_0x364b44[_0x2ec109(0x14f)](_0x2ec109(0x1e6));}catch(_0x212d4e){console[_0x2ec109(0x16c)](_0x212d4e);}}),router[a0_0x2f5586(0x192)](a0_0x2f5586(0x153),async(_0x26dca0,_0x50e68e)=>{var _0x315fba=a0_0x2f5586;const {primary_code:_0x147fbf,warehouse_data:_0x3e79cb,rooms_data:_0x15492e,Roomslist:_0x293e22}=_0x26dca0[_0x315fba(0x193)],_0x3ffc99=_0x293e22[_0x315fba(0x1ed)](','),_0x5c2362=[];async function _0x15adb5(_0x14a90a){var _0x556fd5=_0x315fba;const _0x217d99=await warehouse[_0x556fd5(0x1ab)]([{'$match':{'name':_0x3e79cb,'room':_0x14a90a}},{'$unwind':_0x556fd5(0x1d8)},{'$match':{'product_details.primary_code':_0x147fbf}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x556fd5(0x1a2)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x556fd5(0x1a1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x556fd5(0x1e0)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x556fd5(0x190)},'type':{'$first':_0x556fd5(0x176)},'pallet':{'$first':_0x556fd5(0x1d6)},'unit':{'$first':_0x556fd5(0x15a)},'secondary_unit':{'$first':_0x556fd5(0x189)},'storage':{'$first':_0x556fd5(0x188)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x556fd5(0x1c5)},'production_date':{'$first':_0x556fd5(0x181)},'batch_code':{'$first':_0x556fd5(0x18c)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x556fd5(0x1ca)},'roomNamed':{'$first':_0x556fd5(0x17c)},'invoice':{'$first':_0x556fd5(0x137)}}}]),_0x3621eb=await warehouse[_0x556fd5(0x1ab)]([{'$match':{'name':_0x3e79cb,'room':_0x14a90a}},{'$unwind':_0x556fd5(0x1d8)},{'$match':{'product_details.secondary_code':_0x147fbf}},{'$group':{'_id':_0x556fd5(0x155),'name':{'$first':_0x556fd5(0x1a2)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x556fd5(0x1a1)},'secondary_code':{'$first':_0x556fd5(0x17f)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x556fd5(0x160)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x556fd5(0x176)},'pallet':{'$first':_0x556fd5(0x1d6)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x556fd5(0x189)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x556fd5(0x1d2)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x556fd5(0x181)},'batch_code':{'$first':_0x556fd5(0x18c)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x556fd5(0x1ca)},'roomNamed':{'$first':_0x556fd5(0x17c)},'invoice':{'$first':_0x556fd5(0x137)}}}]);if(_0x217d99['length']>0x0)_0x5c2362[_0x556fd5(0x12f)](_0x217d99);else _0x3621eb[_0x556fd5(0x150)]>0x0&&_0x5c2362[_0x556fd5(0x12f)](_0x3621eb);}const _0x5ae5fb=_0x3ffc99['map'](_0x348afc=>_0x15adb5(_0x348afc));await Promise['all'](_0x5ae5fb),_0x50e68e['json'](_0x5c2362);}),router[a0_0x2f5586(0x192)](a0_0x2f5586(0x183),async(_0x4ab331,_0x2955dd)=>{var _0x45d984=a0_0x2f5586;const {productCode:_0x5a95f4,bay:_0x4d614b,warehouses:_0x2a62db,room:_0x39e281}=_0x4ab331[_0x45d984(0x193)];console[_0x45d984(0x16c)](_0x4ab331[_0x45d984(0x193)]);try{const _0x3c4a17=await warehouse[_0x45d984(0x1ab)]([{'$match':{'name':_0x2a62db,'room':_0x39e281}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x4d614b)}},{'$group':{'_id':_0x45d984(0x155),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x45d984(0x18d)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x45d984(0x13b)}}}]);_0x2955dd[_0x45d984(0x130)](0xc8)[_0x45d984(0x19a)](_0x3c4a17);}catch(_0x5c1dac){_0x2955dd[_0x45d984(0x130)](0x194)['json']({'message':_0x5c1dac['message']});}}),module[a0_0x2f5586(0x1a6)]=router;function a0_0x5dca(){var _0x2bc68e=['English\x20(US)','string','$name','site_title','$product_details.maxPerUnit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<div>','getMonth','351366POhQsR','adjustment\x20add\x20successfull','prod_name','batch_code','$product_details.rack','Hindi','There\x27s\x20a\x20error\x20in\x20this\x20transaction','expiry_date','$product_details.floorlevel','ADJF-','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','level','$product.room_names','English','bay','Enabled','<span\x20style=\x22float:\x20right;\x22>','$product_details.product_code','logo','Primary_Units','createTransport','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','note','/adjustment_finished/view','/preview/:id','Ambient','$finalize','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','prod_cat','staff','split','date','all','\x20Order\x20Date\x20:\x20','</tbody>','push','status','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','../middleware/auth','Enclosed','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product','filter','$product_details.invoice','../models/all_models','An\x20error\x20occurred\x20while\x20saving\x20data.','secondary_unit','$product_details.maxProducts','108MRGTGy','<h5>','express','product','Arabic','nodemailer','124360rglSPk','invoice','product_details','types','</thead>','production_date','Error\x20Occurs','Chinese','Spanish','slice','416823aheYGN','</td>','<h5\x20style=\x22text-align:\x20left;\x22>','redirect','length','_id','Return\x20Rooms','/barcode_scanner','91VGTjjo','$product_details._id','/adjustment_finished/preview/','1KTwRvw','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','getFullYear','$product_details.unit','FGSEmail','then','unit','<table\x20style=\x22width:\x20100%\x20!important;\x22>','email','$product_details.bay','$warehouse_name','$product.product_name','role','product_date','</tr>','12858PjGDdC','product_name','Portuguese\x20(BR)','</head><body>','language','minus','log','catch','QA\x20Warehouse','<strong>\x20Regards\x20</strong>','forEach','master','/adjustment/view','save','/../public','adjustment_finished','$product_details.type','New_Qty_Converted','4JFOsPA','error','<!DOCTYPE\x20html>','prod_code','$room','German','errors','$product_details.secondary_code','findOne','$product_details.production_date','password','/CheckingWarehouse','/view/:id','3247794xPTZxo','product_stock','../public/language/languages.json','$product_details.storage','$product_details.secondary_unit','Portuguese','adjust_qty','$product_details.batch_code','$product_details.product_stock','French','find','$product_details.bin','back','post','body','Finished\x20Goods','flash','image','<tr>','maxPerUnit','176152qjGHve','json','params','DRY\x20GOODS','/picking_list/PDF_adjustment/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','port','purchases_data','$product_details.primary_code','$product_details.product_name','warehouse_name','success','$_id','exports','host','Email\x20sent\x20successfully','get','Arabic\x20(ae)','aggregate','<hr\x20class=\x22my-3\x22>','warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','room_names','map','render','Secondary_units','<h2>\x20','message','stock','getDate','user','/view','</span>','142580NBTALH','Adjustment\x20Finalize\x20Successfully','True','findById','room','add','prod_invoice','Rooms','</div>','New_Qty_Converted_adj','</h5>','$product_details.expiry_date'];a0_0x5dca=function(){return _0x2bc68e;};return a0_0x5dca();}