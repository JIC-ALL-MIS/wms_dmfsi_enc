var a0_0x166d65=a0_0x27bc;function a0_0x2d58(){var _0x17af8b=['ADJF-','$warehouse_name','<tbody\x20style=\x22text-align:\x20center;\x22>','floor','$product_details','staff','invoice','Adjustment\x20Finalize\x20Successfully','catch','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Arabic','/view/add_adjustment','json','unit','product_stock','$product','back','/adjustment_finished/view','errors','1269pLykhX','JO_number','filter','user','prod_invoice','maxPerUnit','</h5>','Router','push','$invoice','$product_details.product_code','55oKQRaC','/view','$product_details.primary_code','\x20Order\x20Number\x20:\x20','error','body','80802KTmsHo','adjustment\x20add\x20successfull','createTransport','product_name','\x20Order\x20Date\x20:\x20','status','find','English\x20(US)','DRY\x20GOODS','</body></html>','exports','new_adjust_qty','getDate','/barcode_scanner','note','Finished\x20Goods','Portuguese\x20(BR)','<span\x20style=\x22float:\x20right;\x22>','findOne','New_Qty_Converted_adj','<html><head><title></title>','date','<tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','production_date','8076190MSjfaz','render','foreach\x20newproduct','room_names','message','level','product_details','edit_adjustment_finished_view','host','Spanish','$date','$product.product_name','../models/all_models','language','$product_details.batch_code','$name','email','/preview/:id','</div>','$product_details.invoice','purchases_data','<div>','</span>','$room','role','bay','20690womkLL','save','image','/view/:id','$product_details.rack','map','sendMail','Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','success','$product_details.type','$product_details.secondary_code','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Arabic\x20(ae)','params','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','flash','add','warehouse','room','German','True','Secondary_units','stockBefore','port','$product_details.product_name','$product_details.product_stock','product_code','prod_code','secondary_unit','stock','FGSEmail','Enabled','post','length','redirect','site_title','<strong>\x20Regards\x20</strong>','$product_details.maxProducts','random','forEach','Error\x20Occurs','warehouse_name','$_id','Ambient','prod_name','/upload/','Hindi','toString','Portuguese','\x20</h2>','types','product_date','edit_adjustment_finished','adjustment_finished','$product_details.floorlevel','getMonth','Return\x20Rooms','findById','$product.room_names','$product_details.bin','69uauMxT','prod_cat','791exLWkS','$product_details.expiry_date','slice','adjustment\x20data\x20update\x20successfully','$product_details._id','An\x20error\x20occurred.','all','logo','61416jzPlCo','batch_code','getFullYear','$product_details.storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.production_date','$product_details.unit','3544737Mrydea','$product_details.bay','expiry_date','Primary_Units','../public/language/languages.json','New_Qty_Converted','</td>','Chinese','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','string','adjust_qty','minus','Enclosed','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','get','4504068SnoCwO','1002795cAKVEf','French','aggregate','log','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</tr>','product','$product_details.maxPerUnit','express','add_adjustment_finished','split'];a0_0x2d58=function(){return _0x17af8b;};return a0_0x2d58();}(function(_0x2ccec4,_0x4a241f){var _0x4f2c4a=a0_0x27bc,_0x5af274=_0x2ccec4();while(!![]){try{var _0x42ce96=parseInt(_0x4f2c4a(0x1ed))/0x1*(-parseInt(_0x4f2c4a(0x1af))/0x2)+-parseInt(_0x4f2c4a(0x1fe))/0x3+-parseInt(_0x4f2c4a(0x20e))/0x4+parseInt(_0x4f2c4a(0x20f))/0x5+parseInt(_0x4f2c4a(0x23e))/0x6*(-parseInt(_0x4f2c4a(0x1ef))/0x7)+parseInt(_0x4f2c4a(0x1f7))/0x8*(parseInt(_0x4f2c4a(0x22d))/0x9)+-parseInt(_0x4f2c4a(0x195))/0xa*(-parseInt(_0x4f2c4a(0x238))/0xb);if(_0x42ce96===_0x4a241f)break;else _0x5af274['push'](_0x5af274['shift']());}catch(_0x1bb681){_0x5af274['push'](_0x5af274['shift']());}}}(a0_0x2d58,0xbded3));const express=require(a0_0x166d65(0x217)),app=express(),router=express[a0_0x166d65(0x234)](),auth=require(a0_0x166d65(0x1bb)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x166d65(0x1a1)),users=require(a0_0x166d65(0x202)),nodemailer=require('nodemailer');router[a0_0x166d65(0x20d)](a0_0x166d65(0x239),auth,async(_0x52e372,_0x10192d)=>{var _0x2dda67=a0_0x166d65;try{const {username:_0x76bd79,email:_0x582bb2,role:_0x3afefa}=_0x52e372['user'],_0x24d0dd=_0x52e372[_0x2dda67(0x230)],_0x7b60b4=await profile['findOne']({'email':_0x24d0dd['email']}),_0x4d2822=await master_shop[_0x2dda67(0x181)]();let _0x4b4863;if(_0x24d0dd[_0x2dda67(0x1ad)]==_0x2dda67(0x21f)){const _0x3b1e78=await staff[_0x2dda67(0x18d)]({'email':_0x24d0dd[_0x2dda67(0x1a5)]});_0x4b4863=await warehouse['find']({'status':_0x2dda67(0x1d0),'name':_0x3b1e78['warehouse']});}else _0x4b4863=await warehouse[_0x2dda67(0x181)]({'status':'Enabled'});const _0x4b220c=await product[_0x2dda67(0x181)]();let _0x3c05e8;if(_0x24d0dd['role']=='staff'){const _0x313d70=await staff[_0x2dda67(0x18d)]({'email':_0x24d0dd[_0x2dda67(0x1a5)]});_0x3c05e8=await adjustment_finished['find']({'warehouse_name':_0x313d70['warehouse']});}else _0x3c05e8=await adjustment_finished['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x2dda67(0x1db),'invoice':{'$first':_0x2dda67(0x236)},'date':{'$first':_0x2dda67(0x19f)},'warehouse_name':{'$first':_0x2dda67(0x21b)},'room':{'$addToSet':_0x2dda67(0x1eb)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x4d2822[0x0][_0x2dda67(0x1a2)]==_0x2dda67(0x182)){var _0x2ca946=users['English'];console['log'](_0x2ca946);}else{if(_0x4d2822[0x0][_0x2dda67(0x1a2)]==_0x2dda67(0x1df))var _0x2ca946=users[_0x2dda67(0x1df)];else{if(_0x4d2822[0x0][_0x2dda67(0x1a2)]=='German')var _0x2ca946=users[_0x2dda67(0x1c4)];else{if(_0x4d2822[0x0][_0x2dda67(0x1a2)]==_0x2dda67(0x19e))var _0x2ca946=users['Spanish'];else{if(_0x4d2822[0x0][_0x2dda67(0x1a2)]==_0x2dda67(0x210))var _0x2ca946=users['French'];else{if(_0x4d2822[0x0]['language']==_0x2dda67(0x18b))var _0x2ca946=users[_0x2dda67(0x1e1)];else{if(_0x4d2822[0x0][_0x2dda67(0x1a2)]=='Chinese')var _0x2ca946=users[_0x2dda67(0x205)];else{if(_0x4d2822[0x0]['language']==_0x2dda67(0x1bd))var _0x2ca946=users['Arabic'];}}}}}}}_0x10192d[_0x2dda67(0x196)](_0x2dda67(0x1e6),{'success':_0x52e372[_0x2dda67(0x1c0)]('success'),'errors':_0x52e372[_0x2dda67(0x1c0)](_0x2dda67(0x22c)),'role':_0x24d0dd,'profile':_0x7b60b4,'warehouse':_0x4b4863,'product':_0x4b220c,'adjustment':_0x3c05e8,'master_shop':_0x4d2822,'language':_0x2ca946});}catch(_0x30e0b0){console[_0x2dda67(0x212)](_0x30e0b0);}});function a0_0x27bc(_0x29f6d6,_0x5c5f16){var _0x2d586c=a0_0x2d58();return a0_0x27bc=function(_0x27bc82,_0x50c911){_0x27bc82=_0x27bc82-0x181;var _0x3a0258=_0x2d586c[_0x27bc82];return _0x3a0258;},a0_0x27bc(_0x29f6d6,_0x5c5f16);}async function getRandom8DigitNumber(){var _0x1c4de9=a0_0x166d65;const _0x58752b=0x989680,_0x44fff5=0x5f5e0ff,_0x51d183=Math[_0x1c4de9(0x21d)](Math[_0x1c4de9(0x1d7)]()*(_0x44fff5-_0x58752b+0x1))+_0x58752b;var _0x3c4347;const _0x1abe59=await adjustment_finished[_0x1c4de9(0x18d)]({'invoice':_0x1c4de9(0x21a)+_0x51d183});return _0x1abe59&&_0x1abe59[_0x1c4de9(0x1d2)]>0x0?_0x3c4347=_0x1c4de9(0x21a)+_0x51d183:_0x3c4347=_0x1c4de9(0x21a)+_0x51d183,_0x3c4347;}router[a0_0x166d65(0x20d)](a0_0x166d65(0x225),auth,async(_0x3afc00,_0x2e6d33)=>{var _0x1cb6c1=a0_0x166d65;try{const {username:_0x37c164,email:_0x1df1c4,role:_0x369aca}=_0x3afc00[_0x1cb6c1(0x230)],_0x11f509=_0x3afc00[_0x1cb6c1(0x230)],_0x5cc228=await profile[_0x1cb6c1(0x18d)]({'email':_0x11f509[_0x1cb6c1(0x1a5)]}),_0x3cfaa3=await master_shop[_0x1cb6c1(0x181)]();let _0x1b96dd;if(_0x11f509[_0x1cb6c1(0x1ad)]==_0x1cb6c1(0x21f)){const _0x5b14fa=await staff[_0x1cb6c1(0x18d)]({'email':_0x11f509[_0x1cb6c1(0x1a5)]});_0x1b96dd=await warehouse[_0x1cb6c1(0x211)]([{'$match':{'status':_0x1cb6c1(0x1d0),'name':_0x5b14fa[_0x1cb6c1(0x1c2)],'warehouse_category':_0x1cb6c1(0x18a),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x1cb6c1(0x1a4),'name':{'$first':_0x1cb6c1(0x1a4)}}}]);}else _0x1b96dd=await warehouse[_0x1cb6c1(0x211)]([{'$match':{'status':'Enabled','warehouse_category':_0x1cb6c1(0x18a),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':_0x1cb6c1(0x1a4)}}}]);const _0x2781cd=await product[_0x1cb6c1(0x181)]({}),_0x3cbaa0=await adjustment_finished[_0x1cb6c1(0x181)]({}),_0x27f131=_0x3cbaa0[_0x1cb6c1(0x1d2)]+0x1,_0x23daa1='ADJF-'+_0x27f131[_0x1cb6c1(0x1e0)]()['padStart'](0x5,'0');var _0x22e231=['Ambient',_0x1cb6c1(0x20a),_0x1cb6c1(0x1e9)];if(_0x3cfaa3[0x0][_0x1cb6c1(0x1a2)]==_0x1cb6c1(0x182))var _0x3909e3=users['English'];else{if(_0x3cfaa3[0x0][_0x1cb6c1(0x1a2)]==_0x1cb6c1(0x1df))var _0x3909e3=users['Hindi'];else{if(_0x3cfaa3[0x0][_0x1cb6c1(0x1a2)]==_0x1cb6c1(0x1c4))var _0x3909e3=users[_0x1cb6c1(0x1c4)];else{if(_0x3cfaa3[0x0][_0x1cb6c1(0x1a2)]==_0x1cb6c1(0x19e))var _0x3909e3=users[_0x1cb6c1(0x19e)];else{if(_0x3cfaa3[0x0]['language']==_0x1cb6c1(0x210))var _0x3909e3=users[_0x1cb6c1(0x210)];else{if(_0x3cfaa3[0x0][_0x1cb6c1(0x1a2)]==_0x1cb6c1(0x18b))var _0x3909e3=users[_0x1cb6c1(0x1e1)];else{if(_0x3cfaa3[0x0][_0x1cb6c1(0x1a2)]==_0x1cb6c1(0x205))var _0x3909e3=users[_0x1cb6c1(0x205)];else{if(_0x3cfaa3[0x0]['language']==_0x1cb6c1(0x1bd))var _0x3909e3=users[_0x1cb6c1(0x224)];}}}}}}}const _0x219385=getRandom8DigitNumber();_0x219385['then'](_0x1dc59e=>{var _0x243eb2=_0x1cb6c1;_0x2e6d33[_0x243eb2(0x196)](_0x243eb2(0x218),{'success':_0x3afc00[_0x243eb2(0x1c0)]('success'),'errors':_0x3afc00[_0x243eb2(0x1c0)]('errors'),'role':_0x11f509,'profile':_0x5cc228,'warehouse':_0x1b96dd,'product':_0x2781cd,'master_shop':_0x3cfaa3,'language':_0x3909e3,'rooms_data':_0x22e231,'invoice_no':_0x1dc59e});})[_0x1cb6c1(0x222)](_0x5f05be=>{var _0x36417a=_0x1cb6c1;_0x3afc00[_0x36417a(0x1c0)](_0x36417a(0x22c),_0x36417a(0x20b)),_0x2e6d33[_0x36417a(0x1d3)]('/adjustment/view');});}catch(_0x5bffc5){console['log'](_0x5bffc5);}}),router['post'](a0_0x166d65(0x225),auth,async(_0x4e7a0a,_0x3108fe)=>{var _0x1aa417=a0_0x166d65;try{const {warehouse_name:_0x526418,date:_0x2b9291,prod_name:_0x2601bc,level:_0x211494,isle:_0xdaa080,pallet:_0x1c52a5,stock:_0x105679,types:_0x5d86f5,adjust_qty:_0x3953b4,new_adjust_qty:_0x9099c6,note:_0x3972d0,Room_name:_0x30824b,invoice:_0x3bbab7,JO_number:_0x279f8c,expiry_date:_0x3b1a8d}=_0x4e7a0a[_0x1aa417(0x23d)];if(typeof _0x2601bc==_0x1aa417(0x207))var _0xfdb252=[_0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1dd)]],_0x56b135=[_0x4e7a0a[_0x1aa417(0x23d)]['level']],_0x378531=[_0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1ce)]],_0x825e23=[_0x4e7a0a[_0x1aa417(0x23d)]['types']],_0x275787=[_0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x18e)]],_0x32f30e=[_0x4e7a0a['body'][_0x1aa417(0x203)]],_0x3e50e9=[_0x4e7a0a[_0x1aa417(0x23d)]['Primary_Units']],_0x2935cc=[_0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1c6)]],_0x4fbb15=[_0x4e7a0a['body'][_0x1aa417(0x1cc)]],_0x457017=[_0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1f8)]],_0x18940f=[_0x4e7a0a[_0x1aa417(0x23d)]['expiry_date']],_0x290896=[_0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1e4)]],_0xac20a0=[_0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1ee)]],_0x4f750d=[_0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1b6)]],_0x2dedbe=[_0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x232)]],_0xd33e8e=[_0x4e7a0a['body'][_0x1aa417(0x231)]];else var _0xfdb252=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1dd)]],_0x56b135=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x19a)]],_0x378531=[..._0x4e7a0a['body']['stock']],_0x825e23=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1e3)]],_0x275787=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x18e)]],_0x32f30e=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x203)]],_0x3e50e9=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x201)]],_0x2935cc=[..._0x4e7a0a['body'][_0x1aa417(0x1c6)]],_0x4fbb15=[..._0x4e7a0a['body'][_0x1aa417(0x1cc)]],_0x457017=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1f8)]],_0x18940f=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x200)]],_0x290896=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1e4)]],_0xac20a0=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1ee)]],_0x4f750d=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x1b6)]],_0x2dedbe=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x232)]],_0xd33e8e=[..._0x4e7a0a[_0x1aa417(0x23d)][_0x1aa417(0x231)]];const _0x599477=_0xfdb252['map'](_0x51db0a=>{return _0x51db0a={'product_name':_0x51db0a};});_0x56b135[_0x1aa417(0x1d8)]((_0x2bb6bb,_0x358e72)=>{_0x599477[_0x358e72]['bay']=_0x2bb6bb;}),_0x378531[_0x1aa417(0x1d8)]((_0x265c8d,_0xd707c0)=>{var _0x528411=_0x1aa417;_0x599477[_0xd707c0][_0x528411(0x1c7)]=_0x265c8d;}),_0x825e23['forEach']((_0x516e25,_0x5dc4ed)=>{_0x599477[_0x5dc4ed]['types']=_0x516e25;}),_0x275787[_0x1aa417(0x1d8)]((_0x1ca3d9,_0x118b74)=>{var _0x2296dc=_0x1aa417;_0x599477[_0x118b74][_0x2296dc(0x208)]=_0x1ca3d9;}),_0x32f30e[_0x1aa417(0x1d8)]((_0x36920b,_0x486aa7)=>{var _0x37ef32=_0x1aa417;_0x599477[_0x486aa7][_0x37ef32(0x186)]=_0x36920b;}),_0x3e50e9['forEach']((_0x459ca4,_0xf03142)=>{var _0x319499=_0x1aa417;_0x599477[_0xf03142][_0x319499(0x227)]=_0x459ca4;}),_0x2935cc[_0x1aa417(0x1d8)]((_0x5da460,_0x3665b1)=>{var _0x31bceb=_0x1aa417;_0x599477[_0x3665b1][_0x31bceb(0x1cd)]=_0x5da460;}),_0x4fbb15['forEach']((_0x3bb52a,_0x5a41d0)=>{var _0x2dce3c=_0x1aa417;_0x599477[_0x5a41d0][_0x2dce3c(0x1cb)]=_0x3bb52a;}),_0x457017['forEach']((_0x124580,_0x320a27)=>{_0x599477[_0x320a27]['batch_code']=_0x124580;}),_0x18940f[_0x1aa417(0x1d8)]((_0xd7635e,_0x24f0ce)=>{var _0x21f16a=_0x1aa417;_0x599477[_0x24f0ce][_0x21f16a(0x200)]=_0xd7635e;}),_0x290896['forEach']((_0x41a9a2,_0x57daba)=>{_0x599477[_0x57daba]['production_date']=_0x41a9a2;}),_0xac20a0[_0x1aa417(0x1d8)]((_0x362227,_0x3a2811)=>{_0x599477[_0x3a2811]['prod_cat']=_0x362227;}),_0x4f750d['forEach']((_0x558d07,_0x1143fc)=>{var _0x145609=_0x1aa417;_0x599477[_0x1143fc][_0x145609(0x198)]=_0x558d07;}),_0x2dedbe['forEach']((_0x8894f9,_0x4df447)=>{var _0x1c2409=_0x1aa417;_0x599477[_0x4df447][_0x1c2409(0x232)]=_0x8894f9;}),_0xd33e8e[_0x1aa417(0x1d8)]((_0x674a6f,_0x432ace)=>{var _0x14a508=_0x1aa417;_0x599477[_0x432ace][_0x14a508(0x220)]=_0x674a6f;});const _0x368442=_0x599477[_0x1aa417(0x22f)](_0x3cf63b=>_0x3cf63b['adjust_qty']!=='0'&&_0x3cf63b[_0x1aa417(0x208)]!=='');var _0x270444=0x0;_0x368442[_0x1aa417(0x1d8)](_0x56d740=>{var _0x5da2d6=_0x1aa417;console[_0x5da2d6(0x212)](_0x5da2d6(0x197),_0x56d740),parseInt(_0x56d740[_0x5da2d6(0x208)])<=0x0&&_0x270444++;});if(_0x270444!=0x0)return _0x4e7a0a[_0x1aa417(0x1c0)](_0x1aa417(0x22c),_0x1aa417(0x206)),_0x3108fe['redirect'](_0x1aa417(0x22a));const _0x5637a7=new adjustment_finished({'warehouse_name':_0x526418,'date':_0x2b9291,'product':_0x368442,'note':_0x3972d0,'room':_0x30824b,'invoice':_0x3bbab7,'JO_number':_0x279f8c,'expiry_date':_0x3b1a8d}),_0x6f564a=await _0x5637a7[_0x1aa417(0x1b0)]();_0x4e7a0a[_0x1aa417(0x1c0)](_0x1aa417(0x1b8),_0x1aa417(0x23f)),_0x3108fe['redirect']('/adjustment_finished/preview/'+_0x6f564a['_id']);}catch(_0x1dd422){console[_0x1aa417(0x212)](_0x1dd422),_0x3108fe[_0x1aa417(0x243)](0xc8)['json']({'message':_0x1dd422[_0x1aa417(0x199)]});}}),router['get'](a0_0x166d65(0x1a6),auth,async(_0x8bc288,_0x2bbe00)=>{var _0x46a51a=a0_0x166d65;try{const {username:_0x4a9865,email:_0x4cc7a5,role:_0x44c289}=_0x8bc288[_0x46a51a(0x230)],_0x50d2b5=_0x8bc288[_0x46a51a(0x230)],_0x568c9c=await profile[_0x46a51a(0x18d)]({'email':_0x50d2b5['email']}),_0x9f8611=await master_shop['find'](),_0x3d19ea=_0x8bc288[_0x46a51a(0x1be)]['id'],_0x598df8=await adjustment_finished['findById']({'_id':_0x3d19ea}),_0x2060eb=await purchases['aggregate']([{'$match':{'warehouse_name':_0x598df8[_0x46a51a(0x1da)]}},{'$unwind':_0x46a51a(0x229)},{'$group':{'_id':_0x46a51a(0x1a0)}}]);console[_0x46a51a(0x212)](_0x46a51a(0x1a9),_0x2060eb);const _0x32e6cc=await product[_0x46a51a(0x181)]({}),_0x356245=await warehouse[_0x46a51a(0x211)]([{'$match':{'name':_0x598df8['warehouse_name'],'warehouse_category':_0x46a51a(0x18a)}},{'$unwind':_0x46a51a(0x21e)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x46a51a(0x1ff)},'bin':{'$first':_0x46a51a(0x1ec)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x46a51a(0x1e7)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x46a51a(0x237)},'storage':{'$first':_0x46a51a(0x1fa)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x46a51a(0x1f0)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x46a51a(0x1a3)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':_0x46a51a(0x1ac)}}}]);if(_0x9f8611[0x0][_0x46a51a(0x1a2)]==_0x46a51a(0x182)){var _0x47e9fb=users['English'];console[_0x46a51a(0x212)](_0x47e9fb);}else{if(_0x9f8611[0x0][_0x46a51a(0x1a2)]==_0x46a51a(0x1df))var _0x47e9fb=users['Hindi'];else{if(_0x9f8611[0x0][_0x46a51a(0x1a2)]==_0x46a51a(0x1c4))var _0x47e9fb=users[_0x46a51a(0x1c4)];else{if(_0x9f8611[0x0][_0x46a51a(0x1a2)]==_0x46a51a(0x19e))var _0x47e9fb=users['Spanish'];else{if(_0x9f8611[0x0][_0x46a51a(0x1a2)]==_0x46a51a(0x210))var _0x47e9fb=users[_0x46a51a(0x210)];else{if(_0x9f8611[0x0][_0x46a51a(0x1a2)]==_0x46a51a(0x18b))var _0x47e9fb=users[_0x46a51a(0x1e1)];else{if(_0x9f8611[0x0]['language']==_0x46a51a(0x205))var _0x47e9fb=users[_0x46a51a(0x205)];else{if(_0x9f8611[0x0]['language']==_0x46a51a(0x1bd))var _0x47e9fb=users[_0x46a51a(0x224)];}}}}}}}_0x2bbe00[_0x46a51a(0x196)](_0x46a51a(0x19c),{'success':_0x8bc288[_0x46a51a(0x1c0)](_0x46a51a(0x1b8)),'errors':_0x8bc288[_0x46a51a(0x1c0)](_0x46a51a(0x22c)),'role':_0x50d2b5,'profile':_0x568c9c,'adjustment':_0x598df8,'stock':_0x356245,'master_shop':_0x9f8611,'warehouse_name':_0x2060eb,'unit':_0x32e6cc,'language':_0x47e9fb});}catch(_0x3aa5e1){console[_0x46a51a(0x212)](_0x3aa5e1),_0x2bbe00['status'](0xc8)[_0x46a51a(0x226)]({'message':_0x3aa5e1['message']});}}),router[a0_0x166d65(0x1d1)]('/preview/:id',auth,async(_0x496ed3,_0xcc9d4f)=>{var _0x535697=a0_0x166d65;try{const {invoice:_0x15a10c,warehouse_name:_0x4b3b58,Room_name:_0xd2a81f}=_0x496ed3[_0x535697(0x23d)],_0x4db101=_0x496ed3['params']['id'],_0x3700e1=await adjustment_finished['findById']({'_id':_0x4db101});var _0x43098b;const _0x44a691=_0x3700e1[_0x535697(0x215)][_0x535697(0x1b4)](async _0x56bd39=>{var _0x36559b=_0x535697;if(_0x56bd39[_0x36559b(0x208)]>0x0){_0x43098b=await warehouse[_0x36559b(0x18d)]({'name':_0x4b3b58,'room':_0x56bd39[_0x36559b(0x198)],'warehouse_category':'Finished\x20Goods'});const _0x3e1194=_0x43098b[_0x36559b(0x19b)][_0x36559b(0x1b4)](_0x1deb26=>{var _0x361cd4=_0x36559b;console[_0x361cd4(0x212)](_0x56bd39[_0x361cd4(0x1e3)]);if(_0x56bd39[_0x361cd4(0x1e3)]=='minus')_0x1deb26['product_name']==_0x56bd39['product_name']&&_0x1deb26['bay']==_0x56bd39[_0x361cd4(0x1ae)]&&_0x1deb26[_0x361cd4(0x200)]==_0x56bd39[_0x361cd4(0x200)]&&_0x1deb26[_0x361cd4(0x194)]==_0x56bd39[_0x361cd4(0x194)]&&_0x1deb26['batch_code']==_0x56bd39[_0x361cd4(0x1f8)]&&_0x1deb26[_0x361cd4(0x220)]==_0x56bd39[_0x361cd4(0x220)]&&(_0x1deb26[_0x361cd4(0x228)]=_0x1deb26[_0x361cd4(0x228)]-_0x56bd39[_0x361cd4(0x208)]);else _0x56bd39['types']==_0x361cd4(0x1c1)&&(_0x1deb26['product_name']==_0x56bd39['product_name']&&_0x1deb26[_0x361cd4(0x1ae)]==_0x56bd39[_0x361cd4(0x1ae)]&&_0x1deb26[_0x361cd4(0x200)]==_0x56bd39['expiry_date']&&_0x1deb26[_0x361cd4(0x194)]==_0x56bd39[_0x361cd4(0x194)]&&_0x1deb26[_0x361cd4(0x1f8)]==_0x56bd39[_0x361cd4(0x1f8)]&&_0x1deb26[_0x361cd4(0x220)]==_0x56bd39[_0x361cd4(0x220)]&&(_0x1deb26['product_stock']=_0x1deb26[_0x361cd4(0x228)]+_0x56bd39[_0x361cd4(0x208)]));});}return _0x43098b;});Promise[_0x535697(0x1f5)](_0x44a691)['then'](async _0x18f075=>{var _0x197773=_0x535697;try{for(const _0x1d480d of _0x18f075){await _0x1d480d[_0x197773(0x1b0)]();}_0x3700e1['finalize']=_0x197773(0x1c5);const _0x5873c3=await _0x3700e1[_0x197773(0x1b0)](),_0x26bce5=await master_shop[_0x197773(0x181)](),_0x4d3540=await email_settings[_0x197773(0x18d)](),_0x5b1cc3=await supervisor_settings[_0x197773(0x181)]();var _0x43497a=_0x3700e1[_0x197773(0x215)],_0x26ab5a='',_0x553610;for(_0x553610 in _0x43497a){var _0x2096c9='FG';_0x3700e1[_0x197773(0x1da)]==_0x197773(0x183)&&(_0x2096c9='DG'),_0x26ab5a+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x43497a[_0x553610]['product_name']+_0x197773(0x204)+_0x197773(0x1bf)+_0x43497a[_0x553610]['product_code']+'</td>'+_0x197773(0x1bf)+_0x43497a[_0x553610][_0x197773(0x208)]+_0x197773(0x204)+_0x197773(0x1bf)+_0x43497a[_0x553610]['unit']+_0x197773(0x204)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x43497a[_0x553610][_0x197773(0x1cd)]+_0x197773(0x204)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3700e1[_0x197773(0x1da)]+_0x197773(0x204)+_0x197773(0x1bf)+_0x43497a[_0x553610][_0x197773(0x198)]+_0x197773(0x204)+_0x197773(0x1bf)+_0x2096c9+_0x43497a[_0x553610][_0x197773(0x1ae)]+'</td>'+'</tr>';}let _0x20cb57=nodemailer[_0x197773(0x240)]({'host':_0x4d3540[_0x197773(0x19d)],'port':Number(_0x4d3540[_0x197773(0x1c8)]),'secure':![],'auth':{'user':_0x4d3540[_0x197773(0x1a5)],'pass':_0x4d3540['password']}}),_0x11c597={'from':_0x4d3540[_0x197773(0x1a5)],'to':_0x5b1cc3[0x0][_0x197773(0x1cf)],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x197773(0x1de)+_0x26bce5[0x0][_0x197773(0x1b1)],'cid':_0x197773(0x1f6)}],'html':'<!DOCTYPE\x20html>'+_0x197773(0x18f)+'</head><body>'+_0x197773(0x1aa)+_0x197773(0x223)+_0x197773(0x1aa)+_0x197773(0x20c)+'</div>'+_0x197773(0x1aa)+'<h2>\x20'+_0x26bce5[0x0]['site_title']+_0x197773(0x1e2)+_0x197773(0x1a7)+_0x197773(0x1a7)+'<hr\x20class=\x22my-3\x22>'+_0x197773(0x1aa)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x197773(0x23b)+_0x3700e1[_0x197773(0x220)]+'\x20'+_0x197773(0x18c)+_0x197773(0x242)+_0x3700e1[_0x197773(0x190)]+'\x20'+_0x197773(0x1ab)+_0x197773(0x233)+_0x197773(0x1a7)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x197773(0x213)+_0x197773(0x191)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x197773(0x193)+_0x197773(0x1bc)+_0x197773(0x1fb)+_0x197773(0x192)+_0x197773(0x1b7)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x197773(0x214)+'</thead>'+_0x197773(0x21c)+'\x20'+_0x26ab5a+'\x20'+'</tbody>'+'</table>'+'<div>'+_0x197773(0x1d5)+'<h5>'+_0x26bce5[0x0][_0x197773(0x1d4)]+'</h5>'+'</div>'+_0x197773(0x1a7)+_0x197773(0x184)};_0x20cb57[_0x197773(0x1b5)](_0x11c597,function(_0x58732a,_0x1fe227){var _0x3135b1=_0x197773;_0x58732a?(console[_0x3135b1(0x212)](_0x58732a),console['log'](_0x3135b1(0x1d9))):console[_0x3135b1(0x212)]('Email\x20sent\x20successfully');}),_0x496ed3[_0x197773(0x1c0)](_0x197773(0x1b8),_0x197773(0x221)),_0xcc9d4f[_0x197773(0x1d3)]('/picking_list/PDF_adjustment/'+_0x5873c3['_id']);}catch(_0x57f698){console[_0x197773(0x23c)](_0x57f698),_0xcc9d4f[_0x197773(0x243)](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x535697(0x222)](_0x421049=>{var _0x1aab8d=_0x535697;console[_0x1aab8d(0x23c)](_0x421049),_0xcc9d4f[_0x1aab8d(0x243)](0x1f4)[_0x1aab8d(0x226)]({'error':_0x1aab8d(0x1f4)});});}catch(_0x5ee4bc){_0xcc9d4f[_0x535697(0x226)]({'message':_0x5ee4bc[_0x535697(0x199)]});}}),router[a0_0x166d65(0x20d)]('/view/:id',auth,async(_0x56c36e,_0x1d2d65)=>{var _0x4ad4e4=a0_0x166d65;try{const {username:_0x2f7f99,email:_0x5173a1,role:_0x17d01e}=_0x56c36e[_0x4ad4e4(0x230)],_0x221ef4=_0x56c36e[_0x4ad4e4(0x230)],_0x416ce6=await profile['findOne']({'email':_0x221ef4[_0x4ad4e4(0x1a5)]}),_0x3cfe26=await master_shop[_0x4ad4e4(0x181)]();console['log']('master',_0x3cfe26);const _0x3e5870=_0x56c36e['params']['id'],_0xa5b1b5=await adjustment_finished[_0x4ad4e4(0x1ea)]({'_id':_0x3e5870});let _0x580b1b=new Date(_0xa5b1b5[_0x4ad4e4(0x200)]),_0x59de=('0'+_0x580b1b[_0x4ad4e4(0x187)]())['slice'](-0x2),_0x55751d=('0'+(_0x580b1b[_0x4ad4e4(0x1e8)]()+0x1))[_0x4ad4e4(0x1f1)](-0x2),_0x3ca58f=_0x580b1b[_0x4ad4e4(0x1f9)](),_0x431572=_0x3ca58f+'-'+_0x55751d+'-'+_0x59de;var _0x5a3df4=[_0x4ad4e4(0x1dc),_0x4ad4e4(0x20a),_0x4ad4e4(0x1e9)];const _0x57d21c=await purchases['aggregate']([{'$match':{'warehouse_name':_0xa5b1b5['warehouse_name']}},{'$unwind':_0x4ad4e4(0x229)},{'$group':{'_id':'$product.product_name'}}]);console['log'](_0x4ad4e4(0x1a9),_0x57d21c);const _0x5965d9=await product[_0x4ad4e4(0x181)]({}),_0x4a7d67=await warehouse[_0x4ad4e4(0x211)]([{'$match':{'name':_0xa5b1b5[_0x4ad4e4(0x1da)],'room':_0xa5b1b5[_0x4ad4e4(0x1c3)]}},{'$unwind':_0x4ad4e4(0x21e)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4ad4e4(0x1c9)},'product_stock':{'$first':_0x4ad4e4(0x1ca)},'bay':{'$first':_0x4ad4e4(0x1ff)},'bin':{'$first':_0x4ad4e4(0x1ec)},'type':{'$first':_0x4ad4e4(0x1b9)},'floorlevel':{'$first':_0x4ad4e4(0x1e7)},'primary_code':{'$first':_0x4ad4e4(0x23a)},'secondary_code':{'$first':_0x4ad4e4(0x1ba)},'product_code':{'$first':_0x4ad4e4(0x237)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4ad4e4(0x1b3)}}}]);if(_0x3cfe26[0x0][_0x4ad4e4(0x1a2)]==_0x4ad4e4(0x182)){var _0x53b21c=users['English'];console[_0x4ad4e4(0x212)](_0x53b21c);}else{if(_0x3cfe26[0x0][_0x4ad4e4(0x1a2)]==_0x4ad4e4(0x1df))var _0x53b21c=users[_0x4ad4e4(0x1df)];else{if(_0x3cfe26[0x0][_0x4ad4e4(0x1a2)]==_0x4ad4e4(0x1c4))var _0x53b21c=users[_0x4ad4e4(0x1c4)];else{if(_0x3cfe26[0x0][_0x4ad4e4(0x1a2)]=='Spanish')var _0x53b21c=users[_0x4ad4e4(0x19e)];else{if(_0x3cfe26[0x0][_0x4ad4e4(0x1a2)]==_0x4ad4e4(0x210))var _0x53b21c=users[_0x4ad4e4(0x210)];else{if(_0x3cfe26[0x0]['language']=='Portuguese\x20(BR)')var _0x53b21c=users[_0x4ad4e4(0x1e1)];else{if(_0x3cfe26[0x0][_0x4ad4e4(0x1a2)]==_0x4ad4e4(0x205))var _0x53b21c=users[_0x4ad4e4(0x205)];else{if(_0x3cfe26[0x0][_0x4ad4e4(0x1a2)]==_0x4ad4e4(0x1bd))var _0x53b21c=users[_0x4ad4e4(0x224)];}}}}}}}_0x1d2d65['render'](_0x4ad4e4(0x1e5),{'success':_0x56c36e['flash'](_0x4ad4e4(0x1b8)),'errors':_0x56c36e[_0x4ad4e4(0x1c0)](_0x4ad4e4(0x22c)),'role':_0x221ef4,'profile':_0x416ce6,'adjustment':_0xa5b1b5,'stock':_0x4a7d67,'master_shop':_0x3cfe26,'warehouse_name':_0x57d21c,'unit':_0x5965d9,'language':_0x53b21c,'rooms_data':_0x5a3df4,'ed_fullDate':_0x431572});}catch(_0x13c75f){console['log'](_0x13c75f),_0x1d2d65['status'](0xc8)[_0x4ad4e4(0x226)]({'message':_0x13c75f[_0x4ad4e4(0x199)]});}}),router[a0_0x166d65(0x1d1)](a0_0x166d65(0x1b2),auth,async(_0x54415b,_0x19881c)=>{var _0x205dfe=a0_0x166d65;try{const _0x3048e6=_0x54415b[_0x205dfe(0x1be)]['id'],_0x131419=await adjustment_finished[_0x205dfe(0x1ea)]({'_id':_0x3048e6}),_0x898ca8=await warehouse[_0x205dfe(0x18d)]({'name':_0x131419[_0x205dfe(0x1da)],'room':_0x131419['room']}),{warehouse_name:_0x860301,date:_0x3a0dbe,prod_name:_0x48bf9c,level:_0x1f1652,isle:_0x48dfde,pallet:_0x3e1f8d,stock:_0x438bac,types:_0x207d73,adjust_qty:_0x571cc9,new_adjust_qty:_0x380dd7,note:_0xd7a681,Room_name:_0x172756,invoice:_0x4c0330,JO_number:_0x58233f}=_0x54415b[_0x205dfe(0x23d)];if(typeof _0x48bf9c==_0x205dfe(0x207))var _0x1ddea6=[_0x54415b[_0x205dfe(0x23d)]['prod_name']],_0xc25de3=[_0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x19a)]],_0x3fe628=[_0x54415b['body'][_0x205dfe(0x1ce)]],_0x42d985=[_0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x1e3)]],_0x47a6ec=[_0x54415b[_0x205dfe(0x23d)]['adjust_qty']],_0x10663c=[_0x54415b[_0x205dfe(0x23d)]['new_adjust_qty']],_0x196045=[_0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x1cc)]],_0x36518f=[_0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x227)]],_0x5b99e5=[_0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x1c6)]],_0x2d9411=[_0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x1f8)]],_0x186704=[_0x54415b[_0x205dfe(0x23d)]['expiry_date']];else var _0x1ddea6=[..._0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x1dd)]],_0xc25de3=[..._0x54415b[_0x205dfe(0x23d)]['level']],_0x3fe628=[..._0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x1ce)]],_0x42d985=[..._0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x1e3)]],_0x47a6ec=[..._0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x208)]],_0x10663c=[..._0x54415b[_0x205dfe(0x23d)]['new_adjust_qty']],_0x196045=[..._0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x1cc)]],_0x36518f=[..._0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x227)]],_0x5b99e5=[..._0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x1c6)]],_0x2d9411=[..._0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x1f8)]],_0x186704=[..._0x54415b[_0x205dfe(0x23d)][_0x205dfe(0x200)]];const _0x31af8f=_0x1ddea6[_0x205dfe(0x1b4)](_0x85dafc=>{return _0x85dafc={'product_name':_0x85dafc};});_0xc25de3[_0x205dfe(0x1d8)]((_0x149065,_0xf11bef)=>{var _0x5c1ca3=_0x205dfe;_0x31af8f[_0xf11bef][_0x5c1ca3(0x1ae)]=_0x149065;}),_0x3fe628[_0x205dfe(0x1d8)]((_0x5e0939,_0x7cc718)=>{var _0x132e51=_0x205dfe;_0x31af8f[_0x7cc718][_0x132e51(0x1c7)]=_0x5e0939;}),_0x42d985[_0x205dfe(0x1d8)]((_0x41239e,_0x2e89e4)=>{_0x31af8f[_0x2e89e4]['types']=_0x41239e;}),_0x47a6ec['forEach']((_0xab992,_0x25b128)=>{_0x31af8f[_0x25b128]['adjust_qty']=_0xab992;}),_0x10663c[_0x205dfe(0x1d8)]((_0x31bbc4,_0x144b0e)=>{_0x31af8f[_0x144b0e]['new_adjust_qty']=_0x31bbc4;}),_0x36518f[_0x205dfe(0x1d8)]((_0x28b089,_0x76a768)=>{_0x31af8f[_0x76a768]['unit']=_0x28b089;}),_0x5b99e5['forEach']((_0x5b6420,_0x35e828)=>{var _0x7e402c=_0x205dfe;_0x31af8f[_0x35e828][_0x7e402c(0x1cd)]=_0x5b6420;}),_0x196045[_0x205dfe(0x1d8)]((_0x4cb6fd,_0x5d3e81)=>{var _0x5aeb4b=_0x205dfe;_0x31af8f[_0x5d3e81][_0x5aeb4b(0x1cb)]=_0x4cb6fd;}),_0x2d9411[_0x205dfe(0x1d8)]((_0x7ce61b,_0x42282e)=>{_0x31af8f[_0x42282e]['batch_code']=_0x7ce61b;}),_0x186704[_0x205dfe(0x1d8)]((_0x3c298d,_0x42310c)=>{var _0x492c16=_0x205dfe;_0x31af8f[_0x42310c][_0x492c16(0x200)]=_0x3c298d;});const _0x6c7e2=_0x31af8f[_0x205dfe(0x22f)](_0x2bd5d9=>_0x2bd5d9[_0x205dfe(0x208)]!=='0'&&_0x2bd5d9[_0x205dfe(0x208)]!=='');var _0x576ca9=0x0;_0x6c7e2[_0x205dfe(0x1d8)](_0x4dc2e5=>{var _0xdfeb51=_0x205dfe;console[_0xdfeb51(0x212)](_0xdfeb51(0x197),_0x4dc2e5),parseInt(_0x4dc2e5[_0xdfeb51(0x208)])<=0x0&&_0x576ca9++;});if(_0x576ca9!=0x0)return _0x54415b[_0x205dfe(0x1c0)](_0x205dfe(0x22c),_0x205dfe(0x206)),_0x19881c[_0x205dfe(0x1d3)](_0x205dfe(0x22a));_0x131419[_0x205dfe(0x1da)]=_0x860301,_0x131419[_0x205dfe(0x190)]=_0x3a0dbe,_0x131419[_0x205dfe(0x215)]=_0x6c7e2,_0x131419[_0x205dfe(0x189)]=_0xd7a681,_0x131419[_0x205dfe(0x1c3)]=_0x172756,_0x131419[_0x205dfe(0x220)]=_0x4c0330,_0x131419[_0x205dfe(0x22e)]=_0x58233f;const _0x3b10ff=await _0x131419[_0x205dfe(0x1b0)](),_0x3721b9=await warehouse['findOne']({'name':_0x860301,'room':_0x172756});_0x3b10ff[_0x205dfe(0x215)][_0x205dfe(0x1d8)](_0x34c9b1=>{var _0xa18915=_0x205dfe;const _0x4fc230=_0x3721b9[_0xa18915(0x19b)][_0xa18915(0x1b4)](_0x4cbcfc=>{var _0x1509e2=_0xa18915;_0x34c9b1[_0x1509e2(0x1e3)]==_0x1509e2(0x209)?_0x4cbcfc['product_name']==_0x34c9b1[_0x1509e2(0x241)]&&_0x4cbcfc[_0x1509e2(0x1ae)]==_0x34c9b1[_0x1509e2(0x1ae)]&&(_0x4cbcfc[_0x1509e2(0x228)]=parseInt(_0x4cbcfc['product_stock'])-parseInt(_0x34c9b1[_0x1509e2(0x208)])):_0x4cbcfc[_0x1509e2(0x241)]==_0x34c9b1[_0x1509e2(0x241)]&&_0x4cbcfc[_0x1509e2(0x1ae)]==_0x34c9b1[_0x1509e2(0x1ae)]&&(_0x4cbcfc[_0x1509e2(0x228)]=parseInt(_0x4cbcfc[_0x1509e2(0x228)])+parseInt(_0x34c9b1[_0x1509e2(0x208)]));});}),await _0x3721b9[_0x205dfe(0x1b0)](),_0x54415b[_0x205dfe(0x1c0)](_0x205dfe(0x1b8),_0x205dfe(0x1f2)),_0x19881c['redirect'](_0x205dfe(0x22b));}catch(_0x3bf96b){console[_0x205dfe(0x212)](_0x3bf96b);}}),router[a0_0x166d65(0x1d1)](a0_0x166d65(0x188),async(_0x46a1b4,_0x262475)=>{var _0x592fa2=a0_0x166d65;const {primary_code:_0x1e1e59,warehouse_data:_0x909860,rooms_data:_0x2e2281,Roomslist:_0x34d32a}=_0x46a1b4[_0x592fa2(0x23d)],_0x3e7b0b=_0x34d32a[_0x592fa2(0x219)](','),_0x56b278=[];async function _0x569890(_0x25a0b3){var _0x3f49d6=_0x592fa2;const _0x45dda5=await warehouse[_0x3f49d6(0x211)]([{'$match':{'name':_0x909860,'room':_0x25a0b3}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x1e1e59}},{'$group':{'_id':_0x3f49d6(0x1f3),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3f49d6(0x1ca)},'primary_code':{'$first':_0x3f49d6(0x23a)},'secondary_code':{'$first':_0x3f49d6(0x1ba)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3f49d6(0x1ff)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3f49d6(0x1b9)},'pallet':{'$first':_0x3f49d6(0x1e7)},'unit':{'$first':_0x3f49d6(0x1fd)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3f49d6(0x1b3)},'expiry_date':{'$first':_0x3f49d6(0x1f0)},'production_date':{'$first':_0x3f49d6(0x1fc)},'batch_code':{'$first':_0x3f49d6(0x1a3)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x3f49d6(0x216)},'roomNamed':{'$first':_0x3f49d6(0x1ac)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x14e819=await warehouse[_0x3f49d6(0x211)]([{'$match':{'name':_0x909860,'room':_0x25a0b3}},{'$unwind':_0x3f49d6(0x21e)},{'$match':{'product_details.secondary_code':_0x1e1e59}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3f49d6(0x1c9)},'product_stock':{'$first':_0x3f49d6(0x1ca)},'primary_code':{'$first':_0x3f49d6(0x23a)},'secondary_code':{'$first':_0x3f49d6(0x1ba)},'product_code':{'$first':_0x3f49d6(0x237)},'level':{'$first':_0x3f49d6(0x1ff)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3f49d6(0x1b9)},'pallet':{'$first':_0x3f49d6(0x1e7)},'unit':{'$first':_0x3f49d6(0x1fd)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3f49d6(0x1f0)},'production_date':{'$first':_0x3f49d6(0x1fc)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x3f49d6(0x216)},'roomNamed':{'$first':_0x3f49d6(0x1ac)},'invoice':{'$first':_0x3f49d6(0x1a8)}}}]);if(_0x45dda5[_0x3f49d6(0x1d2)]>0x0)_0x56b278[_0x3f49d6(0x235)](_0x45dda5);else _0x14e819[_0x3f49d6(0x1d2)]>0x0&&_0x56b278[_0x3f49d6(0x235)](_0x14e819);}const _0x458a7a=_0x3e7b0b['map'](_0x511a9d=>_0x569890(_0x511a9d));await Promise[_0x592fa2(0x1f5)](_0x458a7a),_0x262475[_0x592fa2(0x226)](_0x56b278);}),router[a0_0x166d65(0x1d1)]('/CheckingWarehouse',async(_0x40c3ff,_0x125ffe)=>{var _0x5609ab=a0_0x166d65;const {productCode:_0x13656f,bay:_0x2d44b9,warehouses:_0x2f7a0a,room:_0x32db86}=_0x40c3ff[_0x5609ab(0x23d)];console[_0x5609ab(0x212)](_0x40c3ff[_0x5609ab(0x23d)]);try{const _0x2109e9=await warehouse[_0x5609ab(0x211)]([{'$match':{'name':_0x2f7a0a,'room':_0x32db86}},{'$unwind':_0x5609ab(0x21e)},{'$match':{'product_details.bay':parseInt(_0x2d44b9)}},{'$group':{'_id':_0x5609ab(0x1f3),'name':{'$first':_0x5609ab(0x1c9)},'product_stock':{'$first':_0x5609ab(0x1ca)},'bay':{'$first':_0x5609ab(0x1ff)},'maxProducts':{'$first':_0x5609ab(0x1d6)}}}]);_0x125ffe['status'](0xc8)[_0x5609ab(0x226)](_0x2109e9);}catch(_0x25c5e1){_0x125ffe[_0x5609ab(0x243)](0x194)[_0x5609ab(0x226)]({'message':_0x25c5e1[_0x5609ab(0x199)]});}}),module[a0_0x166d65(0x185)]=router;