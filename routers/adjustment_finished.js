var a0_0x42908c=a0_0x1f5e;function a0_0x1f5e(_0x5a2862,_0x439220){var _0x4793c1=a0_0x4793();return a0_0x1f5e=function(_0x1f5e64,_0x564de4){_0x1f5e64=_0x1f5e64-0x17c;var _0x51d261=_0x4793c1[_0x1f5e64];return _0x51d261;},a0_0x1f5e(_0x5a2862,_0x439220);}(function(_0x61ffa1,_0x5352ec){var _0x24250d=a0_0x1f5e,_0x2fee87=_0x61ffa1();while(!![]){try{var _0x5b288f=parseInt(_0x24250d(0x1dd))/0x1+parseInt(_0x24250d(0x1d0))/0x2*(-parseInt(_0x24250d(0x23e))/0x3)+parseInt(_0x24250d(0x18b))/0x4+-parseInt(_0x24250d(0x19d))/0x5+parseInt(_0x24250d(0x220))/0x6*(parseInt(_0x24250d(0x217))/0x7)+parseInt(_0x24250d(0x1bb))/0x8*(parseInt(_0x24250d(0x19a))/0x9)+-parseInt(_0x24250d(0x221))/0xa*(parseInt(_0x24250d(0x1df))/0xb);if(_0x5b288f===_0x5352ec)break;else _0x2fee87['push'](_0x2fee87['shift']());}catch(_0x50fb0f){_0x2fee87['push'](_0x2fee87['shift']());}}}(a0_0x4793,0x32bdd));const express=require(a0_0x42908c(0x1c8)),app=express(),router=express[a0_0x42908c(0x1a9)](),auth=require(a0_0x42908c(0x1ec)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x42908c(0x18a)),users=require(a0_0x42908c(0x1b0)),nodemailer=require('nodemailer');router[a0_0x42908c(0x248)](a0_0x42908c(0x1db),auth,async(_0x3859ca,_0x30cfc7)=>{var _0x91fded=a0_0x42908c;try{const {username:_0x1f0da4,email:_0x120b3a,role:_0x214169}=_0x3859ca[_0x91fded(0x210)],_0x1e8929=_0x3859ca[_0x91fded(0x210)],_0x304881=await profile[_0x91fded(0x1ae)]({'email':_0x1e8929[_0x91fded(0x1b6)]}),_0x316810=await master_shop[_0x91fded(0x209)]();let _0x227df2;if(_0x1e8929[_0x91fded(0x1b4)]==_0x91fded(0x22f)){const _0x65f92f=await staff['findOne']({'email':_0x1e8929[_0x91fded(0x1b6)]});_0x227df2=await warehouse[_0x91fded(0x209)]({'status':'Enabled','name':_0x65f92f['warehouse']});}else _0x227df2=await warehouse[_0x91fded(0x209)]({'status':'Enabled'});const _0x20e67e=await product[_0x91fded(0x209)]();let _0x2af346;if(_0x1e8929[_0x91fded(0x1b4)]==_0x91fded(0x22f)){const _0x385283=await staff[_0x91fded(0x1ae)]({'email':_0x1e8929[_0x91fded(0x1b6)]});_0x2af346=await adjustment_finished['find']({'warehouse_name':_0x385283['warehouse']});}else _0x2af346=await adjustment_finished[_0x91fded(0x19e)]([{'$unwind':_0x91fded(0x21a)},{'$group':{'_id':_0x91fded(0x1ee),'invoice':{'$first':'$invoice'},'date':{'$first':_0x91fded(0x1c7)},'warehouse_name':{'$first':_0x91fded(0x214)},'room':{'$addToSet':_0x91fded(0x236)},'finalize':{'$first':_0x91fded(0x1ce)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x316810[0x0][_0x91fded(0x190)]==_0x91fded(0x1c3)){var _0x1e90f5=users[_0x91fded(0x1e0)];console[_0x91fded(0x21c)](_0x1e90f5);}else{if(_0x316810[0x0][_0x91fded(0x190)]==_0x91fded(0x21d))var _0x1e90f5=users['Hindi'];else{if(_0x316810[0x0][_0x91fded(0x190)]==_0x91fded(0x1f6))var _0x1e90f5=users[_0x91fded(0x1f6)];else{if(_0x316810[0x0][_0x91fded(0x190)]=='Spanish')var _0x1e90f5=users[_0x91fded(0x1f7)];else{if(_0x316810[0x0][_0x91fded(0x190)]==_0x91fded(0x1f2))var _0x1e90f5=users['French'];else{if(_0x316810[0x0]['language']=='Portuguese\x20(BR)')var _0x1e90f5=users[_0x91fded(0x1fd)];else{if(_0x316810[0x0][_0x91fded(0x190)]=='Chinese')var _0x1e90f5=users[_0x91fded(0x242)];else{if(_0x316810[0x0][_0x91fded(0x190)]==_0x91fded(0x1fa))var _0x1e90f5=users[_0x91fded(0x231)];}}}}}}}_0x30cfc7[_0x91fded(0x19b)](_0x91fded(0x1ca),{'success':_0x3859ca[_0x91fded(0x227)](_0x91fded(0x1b7)),'errors':_0x3859ca[_0x91fded(0x227)](_0x91fded(0x1e2)),'role':_0x1e8929,'profile':_0x304881,'warehouse':_0x227df2,'product':_0x20e67e,'adjustment':_0x2af346,'master_shop':_0x316810,'language':_0x1e90f5});}catch(_0x1a7337){console['log'](_0x1a7337);}});async function getRandom8DigitNumber(){var _0x1b4484=a0_0x42908c;const _0x29784e=0x989680,_0xc3f0f0=0x5f5e0ff,_0x639de4=Math[_0x1b4484(0x1d9)](Math[_0x1b4484(0x239)]()*(_0xc3f0f0-_0x29784e+0x1))+_0x29784e;var _0x140a7c;const _0x3b2596=await adjustment_finished[_0x1b4484(0x1ae)]({'invoice':_0x1b4484(0x1dc)+_0x639de4});return _0x3b2596&&_0x3b2596[_0x1b4484(0x222)]>0x0?_0x140a7c=_0x1b4484(0x1dc)+_0x639de4:_0x140a7c=_0x1b4484(0x1dc)+_0x639de4,_0x140a7c;}function a0_0x4793(){var _0x210df0=['<thead\x20style=\x22width:\x20100%\x20!important;\x22>','then','$product_details.batch_code','map','\x20</h2>','Enabled','$product_details.rack','$product_details.product_stock','note','<tbody\x20style=\x22text-align:\x20center;\x22>','../models/all_models','326768ERIsuZ','split','createTransport','filter','product','language','\x20Order\x20Number\x20:\x20','body','$product_details','forEach','</tbody>','post','adjustment\x20data\x20update\x20successfully','True','Logo.png','53307docEiQ','render','redirect','1780180AMUTbp','aggregate','prod_name','level','FGSEmail','$product_details.maxPerUnit','prod_cat','$product_details.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/adjustment_finished/preview/','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','getFullYear','Router','/adjustment/view','$product_details.storage','port','<span\x20style=\x22float:\x20right;\x22>','findOne','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','../public/language/languages.json','host','/preview/:id','Adjustment\x20Finalize\x20Successfully','role','Primary_Units','email','success','JO_number','Return\x20Rooms','</tr>','184YgDwPi','$product_details._id','date','</div>','$product_details.secondary_unit','$product_details.product_code','Secondary_units','<hr\x20class=\x22my-3\x22>','English\x20(US)','There\x27s\x20a\x20error\x20in\x20this\x20transaction','adjust_qty','add','$date','express','edit_adjustment_finished','adjustment_finished','_id','/../public','json','$finalize','prod_code','2uFeBYh','site_title','$product_details.bay','minus','product_stock','New_Qty_Converted_adj','save','production_date','Portuguese\x20(BR)','floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view','ADJF-','247717oyhYOp','product_details','121WbxZZm','English','</table>','errors','status','string','$product_details.invoice','params','Finished\x20Goods','product_date','$product_details.expiry_date','<table\x20style=\x22width:\x20100%\x20!important;\x22>','</head><body>','../middleware/auth','findById','$_id','<tr>','$product_details.floorlevel','$product_details.unit','French','warehouse','$product_details.production_date','secondary_unit','German','Spanish','\x20Order\x20Date\x20:\x20','Adjustment\x20Mail','Arabic\x20(ae)','stock','message','Portuguese','getMonth','$product_details.type','warehouse_name','product_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/view/:id','stockBefore','error','batch_code','prod_invoice','<html><head><title></title>','find','New_Qty_Converted','</thead>','$name','</h5>','password','$room','user','$product_details.primary_code','add_adjustment_finished','padStart','$warehouse_name','$product_details.bin','master','49nmDsEO','product_name','toString','$product','types','log','Hindi','bay','<h5\x20style=\x22text-align:\x20left;\x22>','355452KDecvV','23090aeGdNh','length','edit_adjustment_finished_view','DRY\x20GOODS','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','exports','flash','Error\x20Occurs','</td>','</span>','/picking_list/PDF_adjustment/','purchases_data','new_adjust_qty','QA\x20Warehouse','staff','<div>','Arabic','/view/add_adjustment','Ambient','$product_details.maxProducts','push','$product.room_names','$product_details.secondary_code','An\x20error\x20occurred.','random','image','<strong>\x20Regards\x20</strong>','<h5>','slice','873180XYtoZu','back','$product.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Chinese','foreach\x20newproduct','Enclosed','getDate','Rooms','expiry_date','get','unit','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','room_names','invoice'];a0_0x4793=function(){return _0x210df0;};return a0_0x4793();}router[a0_0x42908c(0x248)](a0_0x42908c(0x232),auth,async(_0x14f9dd,_0x2873b9)=>{var _0x214abe=a0_0x42908c;try{const {username:_0x4b7d12,email:_0x2c2caf,role:_0x534291}=_0x14f9dd['user'],_0x3887ff=_0x14f9dd[_0x214abe(0x210)],_0x4b3c87=await profile['findOne']({'email':_0x3887ff[_0x214abe(0x1b6)]}),_0x42b1a0=await master_shop[_0x214abe(0x209)]();let _0x57e1bd;if(_0x3887ff['role']=='staff'){const _0x1b042a=await staff[_0x214abe(0x1ae)]({'email':_0x3887ff[_0x214abe(0x1b6)]});_0x57e1bd=await warehouse[_0x214abe(0x19e)]([{'$match':{'status':_0x214abe(0x185),'name':_0x1b042a[_0x214abe(0x1f3)],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x214abe(0x22e)}}},{'$group':{'_id':_0x214abe(0x20c),'name':{'$first':_0x214abe(0x20c)}}}]);}else _0x57e1bd=await warehouse[_0x214abe(0x19e)]([{'$match':{'status':'Enabled','warehouse_category':_0x214abe(0x1e7),'name':{'$ne':_0x214abe(0x22e)}}},{'$group':{'_id':_0x214abe(0x20c),'name':{'$first':_0x214abe(0x20c)}}}]);const _0x23a812=await product[_0x214abe(0x209)]({}),_0x39fc74=await adjustment_finished[_0x214abe(0x209)]({}),_0x22f4b8=_0x39fc74[_0x214abe(0x222)]+0x1,_0x59f90a=_0x214abe(0x1dc)+_0x22f4b8[_0x214abe(0x219)]()[_0x214abe(0x213)](0x5,'0');var _0x13c609=[_0x214abe(0x233),_0x214abe(0x244),_0x214abe(0x1b9)];if(_0x42b1a0[0x0]['language']==_0x214abe(0x1c3))var _0x34bad7=users['English'];else{if(_0x42b1a0[0x0]['language']==_0x214abe(0x21d))var _0x34bad7=users[_0x214abe(0x21d)];else{if(_0x42b1a0[0x0]['language']==_0x214abe(0x1f6))var _0x34bad7=users[_0x214abe(0x1f6)];else{if(_0x42b1a0[0x0]['language']=='Spanish')var _0x34bad7=users[_0x214abe(0x1f7)];else{if(_0x42b1a0[0x0]['language']=='French')var _0x34bad7=users['French'];else{if(_0x42b1a0[0x0][_0x214abe(0x190)]==_0x214abe(0x1d8))var _0x34bad7=users['Portuguese'];else{if(_0x42b1a0[0x0][_0x214abe(0x190)]==_0x214abe(0x242))var _0x34bad7=users[_0x214abe(0x242)];else{if(_0x42b1a0[0x0][_0x214abe(0x190)]==_0x214abe(0x1fa))var _0x34bad7=users[_0x214abe(0x231)];}}}}}}}const _0x12301d=getRandom8DigitNumber();_0x12301d[_0x214abe(0x181)](_0x111bd8=>{var _0x5ecae8=_0x214abe;_0x2873b9['render'](_0x5ecae8(0x212),{'success':_0x14f9dd[_0x5ecae8(0x227)](_0x5ecae8(0x1b7)),'errors':_0x14f9dd['flash'](_0x5ecae8(0x1e2)),'role':_0x3887ff,'profile':_0x4b3c87,'warehouse':_0x57e1bd,'product':_0x23a812,'master_shop':_0x42b1a0,'language':_0x34bad7,'rooms_data':_0x13c609,'invoice_no':_0x111bd8});})['catch'](_0x413743=>{var _0x33ebd6=_0x214abe;_0x14f9dd[_0x33ebd6(0x227)](_0x33ebd6(0x1e2),_0x33ebd6(0x1c4)),_0x2873b9['redirect'](_0x33ebd6(0x1aa));});}catch(_0x5d22e6){console[_0x214abe(0x21c)](_0x5d22e6);}}),router['post']('/view/add_adjustment',auth,async(_0x342581,_0x328404)=>{var _0xdb49b=a0_0x42908c;try{const {warehouse_name:_0x3c2d60,date:_0x4cb134,prod_name:_0x3f77f7,level:_0xdc7596,isle:_0x458c28,pallet:_0x265e65,stock:_0x1cc58c,types:_0x18fa6d,adjust_qty:_0x25c475,new_adjust_qty:_0x5a2f9a,note:_0x1c450e,Room_name:_0x257d7c,invoice:_0x5c612f,JO_number:_0x547deb,expiry_date:_0x385aff}=_0x342581['body'];if(typeof _0x3f77f7=='string')var _0x12c923=[_0x342581[_0xdb49b(0x192)][_0xdb49b(0x19f)]],_0x54355c=[_0x342581['body'][_0xdb49b(0x1a0)]],_0x226e88=[_0x342581[_0xdb49b(0x192)][_0xdb49b(0x1fb)]],_0x1a55ae=[_0x342581['body'][_0xdb49b(0x21b)]],_0x13f3c1=[_0x342581[_0xdb49b(0x192)]['New_Qty_Converted_adj']],_0x572866=[_0x342581['body'][_0xdb49b(0x20a)]],_0xa1336b=[_0x342581[_0xdb49b(0x192)][_0xdb49b(0x1b5)]],_0x53ac1f=[_0x342581[_0xdb49b(0x192)][_0xdb49b(0x1c1)]],_0x61ea80=[_0x342581[_0xdb49b(0x192)][_0xdb49b(0x1cf)]],_0x14fed0=[_0x342581['body'][_0xdb49b(0x206)]],_0x480050=[_0x342581['body']['expiry_date']],_0x29ad2f=[_0x342581['body'][_0xdb49b(0x1e8)]],_0x1ff420=[_0x342581[_0xdb49b(0x192)]['prod_cat']],_0x5f99c9=[_0x342581['body'][_0xdb49b(0x246)]],_0x49f695=[_0x342581['body']['maxPerUnit']],_0x455179=[_0x342581[_0xdb49b(0x192)][_0xdb49b(0x207)]];else var _0x12c923=[..._0x342581[_0xdb49b(0x192)][_0xdb49b(0x19f)]],_0x54355c=[..._0x342581[_0xdb49b(0x192)][_0xdb49b(0x1a0)]],_0x226e88=[..._0x342581[_0xdb49b(0x192)]['stock']],_0x1a55ae=[..._0x342581['body']['types']],_0x13f3c1=[..._0x342581['body'][_0xdb49b(0x1d5)]],_0x572866=[..._0x342581['body']['New_Qty_Converted']],_0xa1336b=[..._0x342581[_0xdb49b(0x192)]['Primary_Units']],_0x53ac1f=[..._0x342581[_0xdb49b(0x192)][_0xdb49b(0x1c1)]],_0x61ea80=[..._0x342581['body'][_0xdb49b(0x1cf)]],_0x14fed0=[..._0x342581[_0xdb49b(0x192)][_0xdb49b(0x206)]],_0x480050=[..._0x342581[_0xdb49b(0x192)][_0xdb49b(0x247)]],_0x29ad2f=[..._0x342581[_0xdb49b(0x192)][_0xdb49b(0x1e8)]],_0x1ff420=[..._0x342581[_0xdb49b(0x192)][_0xdb49b(0x1a3)]],_0x5f99c9=[..._0x342581[_0xdb49b(0x192)][_0xdb49b(0x246)]],_0x49f695=[..._0x342581[_0xdb49b(0x192)]['maxPerUnit']],_0x455179=[..._0x342581[_0xdb49b(0x192)][_0xdb49b(0x207)]];const _0x5545bb=_0x12c923[_0xdb49b(0x183)](_0x4dfadd=>{return _0x4dfadd={'product_name':_0x4dfadd};});_0x54355c[_0xdb49b(0x194)]((_0xb42526,_0xa12fb)=>{var _0x3f13d3=_0xdb49b;_0x5545bb[_0xa12fb][_0x3f13d3(0x21e)]=_0xb42526;}),_0x226e88[_0xdb49b(0x194)]((_0x2e40b8,_0x38a7a4)=>{var _0x301c4f=_0xdb49b;_0x5545bb[_0x38a7a4][_0x301c4f(0x204)]=_0x2e40b8;}),_0x1a55ae[_0xdb49b(0x194)]((_0xeaa81c,_0x5e9785)=>{var _0x24f38a=_0xdb49b;_0x5545bb[_0x5e9785][_0x24f38a(0x21b)]=_0xeaa81c;}),_0x13f3c1['forEach']((_0x47cf5d,_0x3de670)=>{var _0x39d573=_0xdb49b;_0x5545bb[_0x3de670][_0x39d573(0x1c5)]=_0x47cf5d;}),_0x572866[_0xdb49b(0x194)]((_0x29fe93,_0x57f6c7)=>{var _0x31c3f6=_0xdb49b;_0x5545bb[_0x57f6c7][_0x31c3f6(0x22d)]=_0x29fe93;}),_0xa1336b['forEach']((_0x52e45d,_0x5051fe)=>{_0x5545bb[_0x5051fe]['unit']=_0x52e45d;}),_0x53ac1f[_0xdb49b(0x194)]((_0x1feed4,_0x1702f2)=>{var _0x3d0000=_0xdb49b;_0x5545bb[_0x1702f2][_0x3d0000(0x1f5)]=_0x1feed4;}),_0x61ea80[_0xdb49b(0x194)]((_0x536535,_0x3b872a)=>{var _0x47e841=_0xdb49b;_0x5545bb[_0x3b872a][_0x47e841(0x201)]=_0x536535;}),_0x14fed0[_0xdb49b(0x194)]((_0x373939,_0x2c3841)=>{var _0x108bde=_0xdb49b;_0x5545bb[_0x2c3841][_0x108bde(0x206)]=_0x373939;}),_0x480050[_0xdb49b(0x194)]((_0x7b2751,_0x11338b)=>{_0x5545bb[_0x11338b]['expiry_date']=_0x7b2751;}),_0x29ad2f[_0xdb49b(0x194)]((_0x38443c,_0x5a132d)=>{var _0x11875e=_0xdb49b;_0x5545bb[_0x5a132d][_0x11875e(0x1d7)]=_0x38443c;}),_0x1ff420[_0xdb49b(0x194)]((_0x5afcf6,_0x2d8f00)=>{var _0x1944b1=_0xdb49b;_0x5545bb[_0x2d8f00][_0x1944b1(0x1a3)]=_0x5afcf6;}),_0x5f99c9[_0xdb49b(0x194)]((_0x186587,_0x155b06)=>{_0x5545bb[_0x155b06]['room_names']=_0x186587;}),_0x49f695[_0xdb49b(0x194)]((_0xf881a9,_0x49fd6d)=>{_0x5545bb[_0x49fd6d]['maxPerUnit']=_0xf881a9;}),_0x455179[_0xdb49b(0x194)]((_0x3da788,_0x1e5ee9)=>{var _0x445b66=_0xdb49b;_0x5545bb[_0x1e5ee9][_0x445b66(0x17f)]=_0x3da788;});const _0x123eb6=_0x5545bb['filter'](_0xad5687=>_0xad5687[_0xdb49b(0x1c5)]!=='0'&&_0xad5687[_0xdb49b(0x1c5)]!=='');var _0x259158=0x0;_0x123eb6['forEach'](_0x4dc3e4=>{var _0x420901=_0xdb49b;console[_0x420901(0x21c)](_0x420901(0x243),_0x4dc3e4),parseInt(_0x4dc3e4[_0x420901(0x1c5)])<=0x0&&_0x259158++;});if(_0x259158!=0x0)return _0x342581[_0xdb49b(0x227)](_0xdb49b(0x1e2),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x328404[_0xdb49b(0x19c)](_0xdb49b(0x23f));const _0xad42=new adjustment_finished({'warehouse_name':_0x3c2d60,'date':_0x4cb134,'product':_0x123eb6,'note':_0x1c450e,'room':_0x257d7c,'invoice':_0x5c612f,'JO_number':_0x547deb,'expiry_date':_0x385aff}),_0x8ff481=await _0xad42['save']();_0x342581[_0xdb49b(0x227)](_0xdb49b(0x1b7),'adjustment\x20add\x20successfull'),_0x328404[_0xdb49b(0x19c)](_0xdb49b(0x1a6)+_0x8ff481['_id']);}catch(_0x23cdfe){console[_0xdb49b(0x21c)](_0x23cdfe),_0x328404[_0xdb49b(0x1e3)](0xc8)[_0xdb49b(0x1cd)]({'message':_0x23cdfe[_0xdb49b(0x1fc)]});}}),router[a0_0x42908c(0x248)](a0_0x42908c(0x1b2),auth,async(_0x104930,_0x343283)=>{var _0x204208=a0_0x42908c;try{const {username:_0x3c1016,email:_0x3bf67c,role:_0x4e7078}=_0x104930[_0x204208(0x210)],_0x394d6c=_0x104930[_0x204208(0x210)],_0x373b45=await profile['findOne']({'email':_0x394d6c[_0x204208(0x1b6)]}),_0x5d1c92=await master_shop[_0x204208(0x209)](),_0x40d001=_0x104930[_0x204208(0x1e6)]['id'],_0x3e49da=await adjustment_finished[_0x204208(0x1ed)]({'_id':_0x40d001}),_0x110f9c=await purchases[_0x204208(0x19e)]([{'$match':{'warehouse_name':_0x3e49da[_0x204208(0x200)]}},{'$unwind':_0x204208(0x21a)},{'$group':{'_id':_0x204208(0x240)}}]);console[_0x204208(0x21c)]('purchases_data',_0x110f9c);const _0x39386c=await product[_0x204208(0x209)]({}),_0x1996cb=await warehouse[_0x204208(0x19e)]([{'$match':{'name':_0x3e49da[_0x204208(0x200)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x204208(0x193)},{'$group':{'_id':_0x204208(0x1bc),'name':{'$first':_0x204208(0x1a4)},'product_stock':{'$first':_0x204208(0x187)},'bay':{'$first':_0x204208(0x1d2)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x204208(0x1ff)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x204208(0x211)},'secondary_code':{'$first':_0x204208(0x237)},'product_code':{'$first':_0x204208(0x1c0)},'storage':{'$first':_0x204208(0x1ab)},'rack':{'$first':_0x204208(0x186)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x204208(0x1a2)},'room':{'$first':_0x204208(0x20f)}}}]);if(_0x5d1c92[0x0][_0x204208(0x190)]==_0x204208(0x1c3)){var _0x3d5f4b=users[_0x204208(0x1e0)];console[_0x204208(0x21c)](_0x3d5f4b);}else{if(_0x5d1c92[0x0][_0x204208(0x190)]==_0x204208(0x21d))var _0x3d5f4b=users[_0x204208(0x21d)];else{if(_0x5d1c92[0x0][_0x204208(0x190)]=='German')var _0x3d5f4b=users['German'];else{if(_0x5d1c92[0x0][_0x204208(0x190)]==_0x204208(0x1f7))var _0x3d5f4b=users['Spanish'];else{if(_0x5d1c92[0x0][_0x204208(0x190)]==_0x204208(0x1f2))var _0x3d5f4b=users[_0x204208(0x1f2)];else{if(_0x5d1c92[0x0][_0x204208(0x190)]==_0x204208(0x1d8))var _0x3d5f4b=users['Portuguese'];else{if(_0x5d1c92[0x0]['language']=='Chinese')var _0x3d5f4b=users[_0x204208(0x242)];else{if(_0x5d1c92[0x0][_0x204208(0x190)]==_0x204208(0x1fa))var _0x3d5f4b=users['Arabic'];}}}}}}}_0x343283['render'](_0x204208(0x223),{'success':_0x104930[_0x204208(0x227)](_0x204208(0x1b7)),'errors':_0x104930[_0x204208(0x227)](_0x204208(0x1e2)),'role':_0x394d6c,'profile':_0x373b45,'adjustment':_0x3e49da,'stock':_0x1996cb,'master_shop':_0x5d1c92,'warehouse_name':_0x110f9c,'unit':_0x39386c,'language':_0x3d5f4b});}catch(_0x26b300){console[_0x204208(0x21c)](_0x26b300),_0x343283[_0x204208(0x1e3)](0xc8)[_0x204208(0x1cd)]({'message':_0x26b300['message']});}}),router[a0_0x42908c(0x196)](a0_0x42908c(0x1b2),auth,async(_0x2301c7,_0x2693a5)=>{var _0x34e486=a0_0x42908c;try{const {invoice:_0x542aca,warehouse_name:_0x378e84,Room_name:_0x50181f}=_0x2301c7[_0x34e486(0x192)],_0x33b85c=_0x2301c7[_0x34e486(0x1e6)]['id'],_0x5eda60=await adjustment_finished[_0x34e486(0x1ed)]({'_id':_0x33b85c});var _0x3bb746;const _0x142b24=_0x5eda60[_0x34e486(0x18f)]['map'](async _0x500ee4=>{var _0x4bb596=_0x34e486;if(_0x500ee4[_0x4bb596(0x1c5)]>0x0){_0x3bb746=await warehouse[_0x4bb596(0x1ae)]({'name':_0x378e84,'room':_0x500ee4[_0x4bb596(0x17e)],'warehouse_category':_0x4bb596(0x1e7)});const _0x504c6c=_0x3bb746[_0x4bb596(0x1de)][_0x4bb596(0x183)](_0x1ed248=>{var _0x1fc1c3=_0x4bb596;console[_0x1fc1c3(0x21c)](_0x500ee4[_0x1fc1c3(0x21b)]);if(_0x500ee4[_0x1fc1c3(0x21b)]==_0x1fc1c3(0x1d3))_0x1ed248['product_name']==_0x500ee4['product_name']&&_0x1ed248[_0x1fc1c3(0x21e)]==_0x500ee4['bay']&&_0x1ed248['expiry_date']==_0x500ee4[_0x1fc1c3(0x247)]&&_0x1ed248['production_date']==_0x500ee4['production_date']&&_0x1ed248[_0x1fc1c3(0x206)]==_0x500ee4[_0x1fc1c3(0x206)]&&_0x1ed248[_0x1fc1c3(0x17f)]==_0x500ee4['invoice']&&(_0x1ed248['product_stock']=_0x1ed248['product_stock']-_0x500ee4[_0x1fc1c3(0x1c5)]);else _0x500ee4[_0x1fc1c3(0x21b)]==_0x1fc1c3(0x1c6)&&(_0x1ed248[_0x1fc1c3(0x218)]==_0x500ee4[_0x1fc1c3(0x218)]&&_0x1ed248['bay']==_0x500ee4[_0x1fc1c3(0x21e)]&&_0x1ed248[_0x1fc1c3(0x247)]==_0x500ee4['expiry_date']&&_0x1ed248[_0x1fc1c3(0x1d7)]==_0x500ee4[_0x1fc1c3(0x1d7)]&&_0x1ed248[_0x1fc1c3(0x206)]==_0x500ee4[_0x1fc1c3(0x206)]&&_0x1ed248[_0x1fc1c3(0x17f)]==_0x500ee4[_0x1fc1c3(0x17f)]&&(_0x1ed248['product_stock']=_0x1ed248['product_stock']+_0x500ee4[_0x1fc1c3(0x1c5)]));});}return _0x3bb746;});Promise['all'](_0x142b24)[_0x34e486(0x181)](async _0x540a58=>{var _0xe7d345=_0x34e486;try{for(const _0xd9f069 of _0x540a58){await _0xd9f069[_0xe7d345(0x1d6)]();}_0x5eda60['finalize']=_0xe7d345(0x198);const _0x1ae597=await _0x5eda60[_0xe7d345(0x1d6)](),_0xd072d7=await master_shop[_0xe7d345(0x209)](),_0x4e44c3=await email_settings['findOne'](),_0x7cb6be=await supervisor_settings['find']();var _0x4236e2=_0x5eda60[_0xe7d345(0x18f)],_0x1e8616='',_0x3baf55;for(_0x3baf55 in _0x4236e2){var _0x5ccc8a='FG';_0x5eda60['warehouse_name']==_0xe7d345(0x224)&&(_0x5ccc8a='DG'),_0x1e8616+=_0xe7d345(0x1ef)+_0xe7d345(0x202)+_0x4236e2[_0x3baf55]['product_name']+_0xe7d345(0x229)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4236e2[_0x3baf55][_0xe7d345(0x201)]+'</td>'+_0xe7d345(0x202)+_0x4236e2[_0x3baf55][_0xe7d345(0x1c5)]+'</td>'+_0xe7d345(0x202)+_0x4236e2[_0x3baf55]['unit']+'</td>'+_0xe7d345(0x202)+_0x4236e2[_0x3baf55][_0xe7d345(0x1f5)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5eda60['warehouse_name']+_0xe7d345(0x229)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4236e2[_0x3baf55][_0xe7d345(0x17e)]+_0xe7d345(0x229)+_0xe7d345(0x202)+_0x5ccc8a+_0x4236e2[_0x3baf55]['bay']+_0xe7d345(0x229)+_0xe7d345(0x1ba);}let _0x420255=nodemailer[_0xe7d345(0x18d)]({'host':_0x4e44c3[_0xe7d345(0x1b1)],'port':Number(_0x4e44c3[_0xe7d345(0x1ac)]),'secure':![],'auth':{'user':_0x4e44c3['email'],'pass':_0x4e44c3[_0xe7d345(0x20e)]}}),_0x442db9={'from':_0x4e44c3[_0xe7d345(0x1b6)],'to':_0x7cb6be[0x0][_0xe7d345(0x1a1)],'subject':_0xe7d345(0x1f9),'attachments':[{'filename':_0xe7d345(0x199),'path':__dirname+_0xe7d345(0x1cc)+'/upload/'+_0xd072d7[0x0][_0xe7d345(0x23a)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0xe7d345(0x208)+_0xe7d345(0x1eb)+'<div>'+_0xe7d345(0x1a7)+_0xe7d345(0x230)+_0xe7d345(0x17d)+'</div>'+_0xe7d345(0x230)+'<h2>\x20'+_0xd072d7[0x0][_0xe7d345(0x1d1)]+_0xe7d345(0x184)+_0xe7d345(0x1be)+_0xe7d345(0x1be)+_0xe7d345(0x1c2)+_0xe7d345(0x230)+_0xe7d345(0x21f)+_0xe7d345(0x191)+_0x5eda60[_0xe7d345(0x17f)]+'\x20'+_0xe7d345(0x1ad)+_0xe7d345(0x1f8)+_0x5eda60['date']+'\x20'+_0xe7d345(0x22a)+_0xe7d345(0x20d)+_0xe7d345(0x1be)+_0xe7d345(0x1ea)+_0xe7d345(0x180)+'<tr>'+_0xe7d345(0x1da)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0xe7d345(0x241)+_0xe7d345(0x1a5)+_0xe7d345(0x1af)+_0xe7d345(0x1ba)+_0xe7d345(0x20b)+_0xe7d345(0x189)+'\x20'+_0x1e8616+'\x20'+_0xe7d345(0x195)+_0xe7d345(0x1e1)+_0xe7d345(0x230)+_0xe7d345(0x23b)+_0xe7d345(0x23c)+_0xd072d7[0x0]['site_title']+'</h5>'+_0xe7d345(0x1be)+_0xe7d345(0x1be)+'</body></html>'};_0x420255['sendMail'](_0x442db9,function(_0x1b11c3,_0x14b149){var _0x14e3f8=_0xe7d345;_0x1b11c3?(console['log'](_0x1b11c3),console[_0x14e3f8(0x21c)](_0x14e3f8(0x228))):console['log']('Email\x20sent\x20successfully');}),_0x2301c7[_0xe7d345(0x227)](_0xe7d345(0x1b7),_0xe7d345(0x1b3)),_0x2693a5[_0xe7d345(0x19c)](_0xe7d345(0x22b)+_0x1ae597[_0xe7d345(0x1cb)]);}catch(_0x4e9523){console[_0xe7d345(0x205)](_0x4e9523),_0x2693a5[_0xe7d345(0x1e3)](0x1f4)[_0xe7d345(0x1cd)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})['catch'](_0x46c3ea=>{var _0x4f62b4=_0x34e486;console[_0x4f62b4(0x205)](_0x46c3ea),_0x2693a5[_0x4f62b4(0x1e3)](0x1f4)[_0x4f62b4(0x1cd)]({'error':_0x4f62b4(0x238)});});}catch(_0xee7562){_0x2693a5[_0x34e486(0x1cd)]({'message':_0xee7562['message']});}}),router[a0_0x42908c(0x248)](a0_0x42908c(0x203),auth,async(_0x4e4c0a,_0x2b97b5)=>{var _0x20f37a=a0_0x42908c;try{const {username:_0x31d189,email:_0x1454d6,role:_0x54538f}=_0x4e4c0a['user'],_0xf0420e=_0x4e4c0a[_0x20f37a(0x210)],_0x3225fb=await profile['findOne']({'email':_0xf0420e['email']}),_0x45ee4e=await master_shop[_0x20f37a(0x209)]();console[_0x20f37a(0x21c)](_0x20f37a(0x216),_0x45ee4e);const _0x5883f9=_0x4e4c0a[_0x20f37a(0x1e6)]['id'],_0x28698e=await adjustment_finished[_0x20f37a(0x1ed)]({'_id':_0x5883f9});let _0x4ead7c=new Date(_0x28698e[_0x20f37a(0x247)]),_0xa00890=('0'+_0x4ead7c[_0x20f37a(0x245)]())[_0x20f37a(0x23d)](-0x2),_0x125f28=('0'+(_0x4ead7c[_0x20f37a(0x1fe)]()+0x1))['slice'](-0x2),_0x50c706=_0x4ead7c[_0x20f37a(0x1a8)](),_0x3e2bfa=_0x50c706+'-'+_0x125f28+'-'+_0xa00890;var _0x400482=[_0x20f37a(0x233),'Enclosed',_0x20f37a(0x1b9)];const _0x20773f=await purchases[_0x20f37a(0x19e)]([{'$match':{'warehouse_name':_0x28698e[_0x20f37a(0x200)]}},{'$unwind':_0x20f37a(0x21a)},{'$group':{'_id':_0x20f37a(0x240)}}]);console[_0x20f37a(0x21c)](_0x20f37a(0x22c),_0x20773f);const _0x42ab63=await product[_0x20f37a(0x209)]({}),_0xe842cf=await warehouse[_0x20f37a(0x19e)]([{'$match':{'name':_0x28698e[_0x20f37a(0x200)],'room':_0x28698e['room']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x20f37a(0x1bc),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x20f37a(0x237)},'product_code':{'$first':_0x20f37a(0x1c0)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x20f37a(0x186)}}}]);if(_0x45ee4e[0x0][_0x20f37a(0x190)]==_0x20f37a(0x1c3)){var _0x343c01=users['English'];console[_0x20f37a(0x21c)](_0x343c01);}else{if(_0x45ee4e[0x0][_0x20f37a(0x190)]=='Hindi')var _0x343c01=users['Hindi'];else{if(_0x45ee4e[0x0][_0x20f37a(0x190)]=='German')var _0x343c01=users[_0x20f37a(0x1f6)];else{if(_0x45ee4e[0x0]['language']==_0x20f37a(0x1f7))var _0x343c01=users[_0x20f37a(0x1f7)];else{if(_0x45ee4e[0x0][_0x20f37a(0x190)]=='French')var _0x343c01=users[_0x20f37a(0x1f2)];else{if(_0x45ee4e[0x0][_0x20f37a(0x190)]=='Portuguese\x20(BR)')var _0x343c01=users['Portuguese'];else{if(_0x45ee4e[0x0][_0x20f37a(0x190)]==_0x20f37a(0x242))var _0x343c01=users[_0x20f37a(0x242)];else{if(_0x45ee4e[0x0]['language']==_0x20f37a(0x1fa))var _0x343c01=users[_0x20f37a(0x231)];}}}}}}}_0x2b97b5[_0x20f37a(0x19b)](_0x20f37a(0x1c9),{'success':_0x4e4c0a[_0x20f37a(0x227)](_0x20f37a(0x1b7)),'errors':_0x4e4c0a[_0x20f37a(0x227)]('errors'),'role':_0xf0420e,'profile':_0x3225fb,'adjustment':_0x28698e,'stock':_0xe842cf,'master_shop':_0x45ee4e,'warehouse_name':_0x20773f,'unit':_0x42ab63,'language':_0x343c01,'rooms_data':_0x400482,'ed_fullDate':_0x3e2bfa});}catch(_0x2a7990){console['log'](_0x2a7990),_0x2b97b5[_0x20f37a(0x1e3)](0xc8)[_0x20f37a(0x1cd)]({'message':_0x2a7990[_0x20f37a(0x1fc)]});}}),router[a0_0x42908c(0x196)](a0_0x42908c(0x203),auth,async(_0xa85df8,_0x373f06)=>{var _0x213e50=a0_0x42908c;try{const _0x441fc8=_0xa85df8[_0x213e50(0x1e6)]['id'],_0x48042b=await adjustment_finished['findById']({'_id':_0x441fc8}),_0xe97e46=await warehouse['findOne']({'name':_0x48042b[_0x213e50(0x200)],'room':_0x48042b['room']}),{warehouse_name:_0x38b083,date:_0xcfa158,prod_name:_0x2ee0ca,level:_0x1a336a,isle:_0x53467d,pallet:_0x566156,stock:_0x21d405,types:_0x4d30e7,adjust_qty:_0x35e397,new_adjust_qty:_0x1c7855,note:_0x19ff8a,Room_name:_0x3cc061,invoice:_0xe7171f,JO_number:_0x29aa2c}=_0xa85df8['body'];if(typeof _0x2ee0ca==_0x213e50(0x1e4))var _0x57e1ff=[_0xa85df8[_0x213e50(0x192)][_0x213e50(0x19f)]],_0x319d43=[_0xa85df8[_0x213e50(0x192)][_0x213e50(0x1a0)]],_0x99a6b0=[_0xa85df8[_0x213e50(0x192)]['stock']],_0x176960=[_0xa85df8[_0x213e50(0x192)][_0x213e50(0x21b)]],_0x4d9b44=[_0xa85df8[_0x213e50(0x192)][_0x213e50(0x1c5)]],_0x497780=[_0xa85df8['body']['new_adjust_qty']],_0x487957=[_0xa85df8[_0x213e50(0x192)][_0x213e50(0x1cf)]],_0x410d8a=[_0xa85df8[_0x213e50(0x192)][_0x213e50(0x17c)]],_0x4410af=[_0xa85df8['body'][_0x213e50(0x1c1)]],_0x41f7a8=[_0xa85df8[_0x213e50(0x192)][_0x213e50(0x206)]],_0x4255aa=[_0xa85df8['body'][_0x213e50(0x247)]];else var _0x57e1ff=[..._0xa85df8['body'][_0x213e50(0x19f)]],_0x319d43=[..._0xa85df8[_0x213e50(0x192)][_0x213e50(0x1a0)]],_0x99a6b0=[..._0xa85df8[_0x213e50(0x192)]['stock']],_0x176960=[..._0xa85df8['body']['types']],_0x4d9b44=[..._0xa85df8[_0x213e50(0x192)]['adjust_qty']],_0x497780=[..._0xa85df8['body']['new_adjust_qty']],_0x487957=[..._0xa85df8[_0x213e50(0x192)][_0x213e50(0x1cf)]],_0x410d8a=[..._0xa85df8[_0x213e50(0x192)][_0x213e50(0x17c)]],_0x4410af=[..._0xa85df8[_0x213e50(0x192)][_0x213e50(0x1c1)]],_0x41f7a8=[..._0xa85df8[_0x213e50(0x192)][_0x213e50(0x206)]],_0x4255aa=[..._0xa85df8[_0x213e50(0x192)]['expiry_date']];const _0x12c399=_0x57e1ff[_0x213e50(0x183)](_0x246f1b=>{return _0x246f1b={'product_name':_0x246f1b};});_0x319d43[_0x213e50(0x194)]((_0x11c74f,_0x21e618)=>{var _0x36d6a6=_0x213e50;_0x12c399[_0x21e618][_0x36d6a6(0x21e)]=_0x11c74f;}),_0x99a6b0[_0x213e50(0x194)]((_0x3ee3ae,_0x5e8ab7)=>{var _0x59653f=_0x213e50;_0x12c399[_0x5e8ab7][_0x59653f(0x204)]=_0x3ee3ae;}),_0x176960[_0x213e50(0x194)]((_0x170928,_0x18b009)=>{_0x12c399[_0x18b009]['types']=_0x170928;}),_0x4d9b44['forEach']((_0x482385,_0x4d5985)=>{_0x12c399[_0x4d5985]['adjust_qty']=_0x482385;}),_0x497780['forEach']((_0x3c3b8f,_0x395b11)=>{var _0x227368=_0x213e50;_0x12c399[_0x395b11][_0x227368(0x22d)]=_0x3c3b8f;}),_0x410d8a[_0x213e50(0x194)]((_0x26fe02,_0x47a525)=>{var _0x1401b8=_0x213e50;_0x12c399[_0x47a525][_0x1401b8(0x17c)]=_0x26fe02;}),_0x4410af[_0x213e50(0x194)]((_0x22c04f,_0x3c69b9)=>{var _0x2d8e92=_0x213e50;_0x12c399[_0x3c69b9][_0x2d8e92(0x1f5)]=_0x22c04f;}),_0x487957['forEach']((_0xc13465,_0x308a2a)=>{_0x12c399[_0x308a2a]['product_code']=_0xc13465;}),_0x41f7a8['forEach']((_0x4b0598,_0xbd99c9)=>{var _0x4d3592=_0x213e50;_0x12c399[_0xbd99c9][_0x4d3592(0x206)]=_0x4b0598;}),_0x4255aa[_0x213e50(0x194)]((_0x3e2f88,_0xf4de13)=>{var _0x193b1d=_0x213e50;_0x12c399[_0xf4de13][_0x193b1d(0x247)]=_0x3e2f88;});const _0x341a9e=_0x12c399[_0x213e50(0x18e)](_0x3f9d46=>_0x3f9d46[_0x213e50(0x1c5)]!=='0'&&_0x3f9d46[_0x213e50(0x1c5)]!=='');var _0x2f25ff=0x0;_0x341a9e[_0x213e50(0x194)](_0x5033d8=>{var _0x2f0693=_0x213e50;console[_0x2f0693(0x21c)](_0x2f0693(0x243),_0x5033d8),parseInt(_0x5033d8[_0x2f0693(0x1c5)])<=0x0&&_0x2f25ff++;});if(_0x2f25ff!=0x0)return _0xa85df8[_0x213e50(0x227)](_0x213e50(0x1e2),_0x213e50(0x225)),_0x373f06['redirect'](_0x213e50(0x23f));_0x48042b[_0x213e50(0x200)]=_0x38b083,_0x48042b[_0x213e50(0x1bd)]=_0xcfa158,_0x48042b['product']=_0x341a9e,_0x48042b[_0x213e50(0x188)]=_0x19ff8a,_0x48042b['room']=_0x3cc061,_0x48042b['invoice']=_0xe7171f,_0x48042b[_0x213e50(0x1b8)]=_0x29aa2c;const _0x2ec9f1=await _0x48042b['save'](),_0x170b27=await warehouse[_0x213e50(0x1ae)]({'name':_0x38b083,'room':_0x3cc061});_0x2ec9f1['product']['forEach'](_0x4b9ae=>{var _0x8e3768=_0x213e50;const _0x4e8338=_0x170b27[_0x8e3768(0x1de)][_0x8e3768(0x183)](_0x1224a4=>{var _0x2b9648=_0x8e3768;_0x4b9ae[_0x2b9648(0x21b)]==_0x2b9648(0x1d3)?_0x1224a4['product_name']==_0x4b9ae[_0x2b9648(0x218)]&&_0x1224a4[_0x2b9648(0x21e)]==_0x4b9ae['bay']&&(_0x1224a4[_0x2b9648(0x1d4)]=parseInt(_0x1224a4[_0x2b9648(0x1d4)])-parseInt(_0x4b9ae[_0x2b9648(0x1c5)])):_0x1224a4['product_name']==_0x4b9ae['product_name']&&_0x1224a4[_0x2b9648(0x21e)]==_0x4b9ae['bay']&&(_0x1224a4[_0x2b9648(0x1d4)]=parseInt(_0x1224a4[_0x2b9648(0x1d4)])+parseInt(_0x4b9ae[_0x2b9648(0x1c5)]));});}),await _0x170b27[_0x213e50(0x1d6)](),_0xa85df8[_0x213e50(0x227)]('success',_0x213e50(0x197)),_0x373f06[_0x213e50(0x19c)]('/adjustment_finished/view');}catch(_0x503e63){console['log'](_0x503e63);}}),router[a0_0x42908c(0x196)]('/barcode_scanner',async(_0x3695a3,_0x4fda15)=>{var _0x3c37c7=a0_0x42908c;const {primary_code:_0x58ac43,warehouse_data:_0x41659b,rooms_data:_0x346b34,Roomslist:_0x461dd5}=_0x3695a3[_0x3c37c7(0x192)],_0x348e60=_0x461dd5[_0x3c37c7(0x18c)](','),_0x181b4b=[];async function _0x1793c5(_0x1571af){var _0x1a1161=_0x3c37c7;const _0x14697e=await warehouse[_0x1a1161(0x19e)]([{'$match':{'name':_0x41659b,'room':_0x1571af}},{'$unwind':_0x1a1161(0x193)},{'$match':{'product_details.primary_code':_0x58ac43}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1a1161(0x1a4)},'product_stock':{'$first':_0x1a1161(0x187)},'primary_code':{'$first':_0x1a1161(0x211)},'secondary_code':{'$first':_0x1a1161(0x237)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x1a1161(0x1d2)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x1a1161(0x1f0)},'unit':{'$first':_0x1a1161(0x1f1)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x1a1161(0x1ab)},'rack':{'$first':_0x1a1161(0x186)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1a1161(0x1f4)},'batch_code':{'$first':_0x1a1161(0x182)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x1a1161(0x1a2)},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x1a1161(0x1e5)}}}]),_0x1959ec=await warehouse[_0x1a1161(0x19e)]([{'$match':{'name':_0x41659b,'room':_0x1571af}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x58ac43}},{'$group':{'_id':_0x1a1161(0x1bc),'name':{'$first':_0x1a1161(0x1a4)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1a1161(0x237)},'product_code':{'$first':_0x1a1161(0x1c0)},'level':{'$first':_0x1a1161(0x1d2)},'isle':{'$first':_0x1a1161(0x215)},'type':{'$first':_0x1a1161(0x1ff)},'pallet':{'$first':_0x1a1161(0x1f0)},'unit':{'$first':_0x1a1161(0x1f1)},'secondary_unit':{'$first':_0x1a1161(0x1bf)},'storage':{'$first':_0x1a1161(0x1ab)},'rack':{'$first':_0x1a1161(0x186)},'expiry_date':{'$first':_0x1a1161(0x1e9)},'production_date':{'$first':_0x1a1161(0x1f4)},'batch_code':{'$first':_0x1a1161(0x182)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x1a1161(0x1a2)},'roomNamed':{'$first':_0x1a1161(0x20f)},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x14697e['length']>0x0)_0x181b4b[_0x1a1161(0x235)](_0x14697e);else _0x1959ec[_0x1a1161(0x222)]>0x0&&_0x181b4b['push'](_0x1959ec);}const _0x533201=_0x348e60[_0x3c37c7(0x183)](_0x5350c3=>_0x1793c5(_0x5350c3));await Promise['all'](_0x533201),_0x4fda15[_0x3c37c7(0x1cd)](_0x181b4b);}),router['post']('/CheckingWarehouse',async(_0x480e24,_0x34c596)=>{var _0x4de0a0=a0_0x42908c;const {productCode:_0x5a82a8,bay:_0x482cf3,warehouses:_0x6b4bbe,room:_0x37121c}=_0x480e24[_0x4de0a0(0x192)];console[_0x4de0a0(0x21c)](_0x480e24[_0x4de0a0(0x192)]);try{const _0x37bbc8=await warehouse[_0x4de0a0(0x19e)]([{'$match':{'name':_0x6b4bbe,'room':_0x37121c}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x482cf3)}},{'$group':{'_id':_0x4de0a0(0x1bc),'name':{'$first':_0x4de0a0(0x1a4)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4de0a0(0x1d2)},'maxProducts':{'$first':_0x4de0a0(0x234)}}}]);_0x34c596['status'](0xc8)[_0x4de0a0(0x1cd)](_0x37bbc8);}catch(_0x523097){_0x34c596[_0x4de0a0(0x1e3)](0x194)[_0x4de0a0(0x1cd)]({'message':_0x523097[_0x4de0a0(0x1fc)]});}}),module[a0_0x42908c(0x226)]=router;