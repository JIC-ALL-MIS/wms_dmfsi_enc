function a0_0x23d8(){var _0xa1fca=['Rooms','</tr>','findById','2585310Nummxr','Finished\x20Goods','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','stock','Portuguese','$product_details.production_date','Return\x20Rooms','$product_details','catch','render','batch_code','<tbody\x20style=\x22text-align:\x20center;\x22>','French','1128fneAaX','status','image','level','stockBefore','nodemailer','JO_number','Secondary_units','<strong>\x20Regards\x20</strong>','all','Enabled','$product_details.unit','message','Spanish','warehouse_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','length','$product.product_name','Arabic','Ambient','redirect','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','master','getFullYear','$_id','</h5>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','DRY\x20GOODS','room','prod_invoice','purchases_data','split','forEach','finalize','<html><head><title></title>','Primary_Units','exports','/picking_list/PDF_adjustment/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Hindi','unit','/adjustment_finished/view','$date','909466GNeblP','types','toString','note','ADJF-','email','\x20Order\x20Number\x20:\x20','production_date','English','json','adjustment\x20add\x20successfull','/../public','$product_details.product_name','staff','log','/adjustment/view','expiry_date','site_title','/barcode_scanner','warehouse','error','save','$invoice','product_code','post','product','$product.room_names','body','slice','$product_details.batch_code','add_adjustment_finished','$product_details.rack','<div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/adjustment_finished/preview/','getMonth','Chinese','<span\x20style=\x22float:\x20right;\x22>','Email\x20sent\x20successfully','bay','minus','</thead>','language','success','</div>','/view/add_adjustment','$name','adjust_qty','sendMail','logo','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<!DOCTYPE\x20html>','Adjustment\x20Finalize\x20Successfully','$finalize','/view/:id','secondary_unit','An\x20error\x20occurred.','$room','product_name','Enclosed','$product_details.invoice','930240jZjYvM','5Fifzkq','prod_code','Portuguese\x20(BR)','$product_details.secondary_unit','date','$product_details.maxPerUnit','$product_details.product_code','host','find','<tr>','foreach\x20newproduct','Arabic\x20(ae)','maxPerUnit','Error\x20Occurs','$product_details.secondary_code','errors','$product_details.primary_code','aggregate','New_Qty_Converted','/preview/:id','product_date','\x20</h2>','room_names','$product_details.storage','English\x20(US)','then','../public/language/languages.json','New_Qty_Converted_adj','<h5>','$product_details._id','random','German','findOne','filter','1191tXmSSO','_id','map','$product_details.bin','<table\x20style=\x22width:\x20100%\x20!important;\x22>','adjustment_finished','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','614612ZgBnFJ','$product_details.expiry_date','string','$product_details.floorlevel','new_adjust_qty','edit_adjustment_finished','FGSEmail','2233464rdEBBS','$product_details.maxProducts','</td>','get','True','password','product_details','invoice','$product','</span>','edit_adjustment_finished_view','flash','express','</tbody>','../models/all_models','prod_cat','../middleware/auth','<hr\x20class=\x22my-3\x22>','488406uwIiDu','</head><body>','getDate','params','$product_details.bay','Adjustment\x20Mail','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.type','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','padStart','QA\x20Warehouse','Router','product_stock','createTransport','$product_details.product_stock','/view','user','floor','role','add','prod_name','back'];a0_0x23d8=function(){return _0xa1fca;};return a0_0x23d8();}var a0_0x4885ee=a0_0x448b;(function(_0x41e253,_0x29e8b9){var _0x5ae6d7=a0_0x448b,_0x1e5978=_0x41e253();while(!![]){try{var _0xe3624=parseInt(_0x5ae6d7(0x1f9))/0x1+parseInt(_0x5ae6d7(0x192))/0x2+parseInt(_0x5ae6d7(0x1f2))/0x3*(-parseInt(_0x5ae6d7(0x166))/0x4)+parseInt(_0x5ae6d7(0x1d0))/0x5*(-parseInt(_0x5ae6d7(0x212))/0x6)+-parseInt(_0x5ae6d7(0x159))/0x7+-parseInt(_0x5ae6d7(0x200))/0x8+parseInt(_0x5ae6d7(0x1cf))/0x9;if(_0xe3624===_0x29e8b9)break;else _0x1e5978['push'](_0x1e5978['shift']());}catch(_0x28d039){_0x1e5978['push'](_0x1e5978['shift']());}}}(a0_0x23d8,0x50c55));const express=require(a0_0x4885ee(0x20c)),app=express(),router=express[a0_0x4885ee(0x14b)](),auth=require(a0_0x4885ee(0x210)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x4885ee(0x20e)),users=require(a0_0x4885ee(0x1ea)),nodemailer=require(a0_0x4885ee(0x16b));router[a0_0x4885ee(0x203)](a0_0x4885ee(0x14f),auth,async(_0x4faebe,_0x5b8584)=>{var _0x1d4c43=a0_0x4885ee;try{const {username:_0x49c45c,email:_0x29652e,role:_0x2fe1e4}=_0x4faebe[_0x1d4c43(0x150)],_0x2e1861=_0x4faebe[_0x1d4c43(0x150)],_0x9d291b=await profile[_0x1d4c43(0x1f0)]({'email':_0x2e1861[_0x1d4c43(0x197)]}),_0x35f3db=await master_shop[_0x1d4c43(0x1d8)]();let _0x5e3c9e;if(_0x2e1861[_0x1d4c43(0x152)]=='staff'){const _0x540e91=await staff[_0x1d4c43(0x1f0)]({'email':_0x2e1861[_0x1d4c43(0x197)]});_0x5e3c9e=await warehouse[_0x1d4c43(0x1d8)]({'status':_0x1d4c43(0x170),'name':_0x540e91[_0x1d4c43(0x1a5)]});}else _0x5e3c9e=await warehouse['find']({'status':_0x1d4c43(0x170)});const _0x297580=await product[_0x1d4c43(0x1d8)]();let _0x31dd16;if(_0x2e1861[_0x1d4c43(0x152)]==_0x1d4c43(0x19f)){const _0x51e6a4=await staff[_0x1d4c43(0x1f0)]({'email':_0x2e1861[_0x1d4c43(0x197)]});_0x31dd16=await adjustment_finished[_0x1d4c43(0x1d8)]({'warehouse_name':_0x51e6a4['warehouse']});}else _0x31dd16=await adjustment_finished[_0x1d4c43(0x1e1)]([{'$unwind':_0x1d4c43(0x208)},{'$group':{'_id':_0x1d4c43(0x17f),'invoice':{'$first':_0x1d4c43(0x1a8)},'date':{'$first':_0x1d4c43(0x191)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x1d4c43(0x1ac)},'finalize':{'$first':_0x1d4c43(0x1c7)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x35f3db[0x0]['language']==_0x1d4c43(0x1e8)){var _0x42935f=users[_0x1d4c43(0x19a)];console[_0x1d4c43(0x1a0)](_0x42935f);}else{if(_0x35f3db[0x0][_0x1d4c43(0x1bc)]==_0x1d4c43(0x18e))var _0x42935f=users['Hindi'];else{if(_0x35f3db[0x0][_0x1d4c43(0x1bc)]==_0x1d4c43(0x1ef))var _0x42935f=users[_0x1d4c43(0x1ef)];else{if(_0x35f3db[0x0][_0x1d4c43(0x1bc)]==_0x1d4c43(0x173))var _0x42935f=users[_0x1d4c43(0x173)];else{if(_0x35f3db[0x0][_0x1d4c43(0x1bc)]==_0x1d4c43(0x165))var _0x42935f=users[_0x1d4c43(0x165)];else{if(_0x35f3db[0x0][_0x1d4c43(0x1bc)]==_0x1d4c43(0x1d2))var _0x42935f=users['Portuguese'];else{if(_0x35f3db[0x0][_0x1d4c43(0x1bc)]==_0x1d4c43(0x1b6))var _0x42935f=users[_0x1d4c43(0x1b6)];else{if(_0x35f3db[0x0]['language']==_0x1d4c43(0x1db))var _0x42935f=users[_0x1d4c43(0x178)];}}}}}}}_0x5b8584[_0x1d4c43(0x162)](_0x1d4c43(0x1f7),{'success':_0x4faebe[_0x1d4c43(0x20b)](_0x1d4c43(0x1bd)),'errors':_0x4faebe[_0x1d4c43(0x20b)](_0x1d4c43(0x1df)),'role':_0x2e1861,'profile':_0x9d291b,'warehouse':_0x5e3c9e,'product':_0x297580,'adjustment':_0x31dd16,'master_shop':_0x35f3db,'language':_0x42935f});}catch(_0x3f1107){console[_0x1d4c43(0x1a0)](_0x3f1107);}});async function getRandom8DigitNumber(){var _0x6e58d6=a0_0x4885ee;const _0xb2c7a9=0x989680,_0x128589=0x5f5e0ff,_0x4494fd=Math[_0x6e58d6(0x151)](Math[_0x6e58d6(0x1ee)]()*(_0x128589-_0xb2c7a9+0x1))+_0xb2c7a9;var _0x49ab7b;const _0x24a6fa=await adjustment_finished[_0x6e58d6(0x1f0)]({'invoice':'ADJF-'+_0x4494fd});return _0x24a6fa&&_0x24a6fa[_0x6e58d6(0x176)]>0x0?_0x49ab7b=_0x6e58d6(0x196)+_0x4494fd:_0x49ab7b=_0x6e58d6(0x196)+_0x4494fd,_0x49ab7b;}function a0_0x448b(_0x142675,_0x2a0d1e){var _0x23d80e=a0_0x23d8();return a0_0x448b=function(_0x448b8d,_0x30aa3d){_0x448b8d=_0x448b8d-0x148;var _0x423e1f=_0x23d80e[_0x448b8d];return _0x423e1f;},a0_0x448b(_0x142675,_0x2a0d1e);}router[a0_0x4885ee(0x203)](a0_0x4885ee(0x1bf),auth,async(_0x3a0b8f,_0x4ba361)=>{var _0x3b9f21=a0_0x4885ee;try{const {username:_0x2a42b5,email:_0x1fd9e2,role:_0xcf77ee}=_0x3a0b8f[_0x3b9f21(0x150)],_0x158561=_0x3a0b8f[_0x3b9f21(0x150)],_0x12ec4e=await profile['findOne']({'email':_0x158561[_0x3b9f21(0x197)]}),_0x4ad3c0=await master_shop[_0x3b9f21(0x1d8)]();let _0x3f746a;if(_0x158561[_0x3b9f21(0x152)]=='staff'){const _0x3ca1b9=await staff[_0x3b9f21(0x1f0)]({'email':_0x158561[_0x3b9f21(0x197)]});_0x3f746a=await warehouse[_0x3b9f21(0x1e1)]([{'$match':{'status':_0x3b9f21(0x170),'name':_0x3ca1b9[_0x3b9f21(0x1a5)],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x3b9f21(0x14a)}}},{'$group':{'_id':_0x3b9f21(0x1c0),'name':{'$first':_0x3b9f21(0x1c0)}}}]);}else _0x3f746a=await warehouse[_0x3b9f21(0x1e1)]([{'$match':{'status':_0x3b9f21(0x170),'warehouse_category':_0x3b9f21(0x15a),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x3b9f21(0x1c0),'name':{'$first':_0x3b9f21(0x1c0)}}}]);const _0x105a87=await product[_0x3b9f21(0x1d8)]({}),_0x35eff7=await adjustment_finished['find']({}),_0x20becf=_0x35eff7[_0x3b9f21(0x176)]+0x1,_0x1790a9=_0x3b9f21(0x196)+_0x20becf[_0x3b9f21(0x194)]()[_0x3b9f21(0x149)](0x5,'0');var _0x473122=[_0x3b9f21(0x179),'Enclosed',_0x3b9f21(0x15f)];if(_0x4ad3c0[0x0]['language']=='English\x20(US)')var _0x574569=users[_0x3b9f21(0x19a)];else{if(_0x4ad3c0[0x0]['language']==_0x3b9f21(0x18e))var _0x574569=users[_0x3b9f21(0x18e)];else{if(_0x4ad3c0[0x0][_0x3b9f21(0x1bc)]==_0x3b9f21(0x1ef))var _0x574569=users[_0x3b9f21(0x1ef)];else{if(_0x4ad3c0[0x0][_0x3b9f21(0x1bc)]==_0x3b9f21(0x173))var _0x574569=users[_0x3b9f21(0x173)];else{if(_0x4ad3c0[0x0]['language']==_0x3b9f21(0x165))var _0x574569=users['French'];else{if(_0x4ad3c0[0x0][_0x3b9f21(0x1bc)]==_0x3b9f21(0x1d2))var _0x574569=users[_0x3b9f21(0x15d)];else{if(_0x4ad3c0[0x0][_0x3b9f21(0x1bc)]=='Chinese')var _0x574569=users[_0x3b9f21(0x1b6)];else{if(_0x4ad3c0[0x0][_0x3b9f21(0x1bc)]==_0x3b9f21(0x1db))var _0x574569=users[_0x3b9f21(0x178)];}}}}}}}const _0x25927b=getRandom8DigitNumber();_0x25927b[_0x3b9f21(0x1e9)](_0x5f2679=>{var _0x290238=_0x3b9f21;_0x4ba361[_0x290238(0x162)](_0x290238(0x1b0),{'success':_0x3a0b8f['flash'](_0x290238(0x1bd)),'errors':_0x3a0b8f[_0x290238(0x20b)]('errors'),'role':_0x158561,'profile':_0x12ec4e,'warehouse':_0x3f746a,'product':_0x105a87,'master_shop':_0x4ad3c0,'language':_0x574569,'rooms_data':_0x473122,'invoice_no':_0x5f2679});})[_0x3b9f21(0x161)](_0x5a862a=>{var _0x45d196=_0x3b9f21;_0x3a0b8f[_0x45d196(0x20b)](_0x45d196(0x1df),_0x45d196(0x218)),_0x4ba361[_0x45d196(0x17a)](_0x45d196(0x1a1));});}catch(_0x2213fc){console[_0x3b9f21(0x1a0)](_0x2213fc);}}),router['post'](a0_0x4885ee(0x1bf),auth,async(_0x10590c,_0x336ebd)=>{var _0x21c061=a0_0x4885ee;try{const {warehouse_name:_0x44161a,date:_0x3c612a,prod_name:_0x28021a,level:_0x4bed82,isle:_0x43f187,pallet:_0x2a922c,stock:_0x259514,types:_0x44312b,adjust_qty:_0x157834,new_adjust_qty:_0x376290,note:_0x407eb2,Room_name:_0x5a70ea,invoice:_0x2a838a,JO_number:_0x4113af,expiry_date:_0x4cb101}=_0x10590c['body'];if(typeof _0x28021a==_0x21c061(0x1fb))var _0x15d7bd=[_0x10590c[_0x21c061(0x1ad)][_0x21c061(0x154)]],_0x2e459e=[_0x10590c[_0x21c061(0x1ad)][_0x21c061(0x169)]],_0x36111b=[_0x10590c[_0x21c061(0x1ad)]['stock']],_0x33ebe2=[_0x10590c['body'][_0x21c061(0x193)]],_0x214e5a=[_0x10590c[_0x21c061(0x1ad)][_0x21c061(0x1eb)]],_0x804bd0=[_0x10590c['body'][_0x21c061(0x1e2)]],_0x1a9e3d=[_0x10590c[_0x21c061(0x1ad)][_0x21c061(0x18a)]],_0x33e2e4=[_0x10590c[_0x21c061(0x1ad)][_0x21c061(0x16d)]],_0x43533d=[_0x10590c['body']['prod_code']],_0x574907=[_0x10590c[_0x21c061(0x1ad)][_0x21c061(0x163)]],_0x5b3c15=[_0x10590c[_0x21c061(0x1ad)]['expiry_date']],_0x4b1541=[_0x10590c[_0x21c061(0x1ad)][_0x21c061(0x1e4)]],_0x475766=[_0x10590c[_0x21c061(0x1ad)][_0x21c061(0x20f)]],_0x44d85e=[_0x10590c[_0x21c061(0x1ad)][_0x21c061(0x156)]],_0x1dba45=[_0x10590c[_0x21c061(0x1ad)]['maxPerUnit']],_0x2ec9b6=[_0x10590c['body'][_0x21c061(0x184)]];else var _0x15d7bd=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x154)]],_0x2e459e=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x169)]],_0x36111b=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x15c)]],_0x33ebe2=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x193)]],_0x214e5a=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x1eb)]],_0x804bd0=[..._0x10590c[_0x21c061(0x1ad)]['New_Qty_Converted']],_0x1a9e3d=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x18a)]],_0x33e2e4=[..._0x10590c['body'][_0x21c061(0x16d)]],_0x43533d=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x1d1)]],_0x574907=[..._0x10590c['body'][_0x21c061(0x163)]],_0x5b3c15=[..._0x10590c['body'][_0x21c061(0x1a2)]],_0x4b1541=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x1e4)]],_0x475766=[..._0x10590c['body'][_0x21c061(0x20f)]],_0x44d85e=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x156)]],_0x1dba45=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x1dc)]],_0x2ec9b6=[..._0x10590c[_0x21c061(0x1ad)][_0x21c061(0x184)]];const _0x545e20=_0x15d7bd[_0x21c061(0x1f4)](_0x1e1485=>{return _0x1e1485={'product_name':_0x1e1485};});_0x2e459e[_0x21c061(0x187)]((_0x22521f,_0x2f70ef)=>{var _0x5ee250=_0x21c061;_0x545e20[_0x2f70ef][_0x5ee250(0x1b9)]=_0x22521f;}),_0x36111b['forEach']((_0x434dec,_0xf61534)=>{var _0x2ace9b=_0x21c061;_0x545e20[_0xf61534][_0x2ace9b(0x16a)]=_0x434dec;}),_0x33ebe2[_0x21c061(0x187)]((_0x8e4e31,_0x25bfa7)=>{var _0x316acf=_0x21c061;_0x545e20[_0x25bfa7][_0x316acf(0x193)]=_0x8e4e31;}),_0x214e5a[_0x21c061(0x187)]((_0x2a4feb,_0x4a8bc1)=>{var _0x44783e=_0x21c061;_0x545e20[_0x4a8bc1][_0x44783e(0x1c1)]=_0x2a4feb;}),_0x804bd0[_0x21c061(0x187)]((_0x2d3d44,_0x391809)=>{var _0x490613=_0x21c061;_0x545e20[_0x391809][_0x490613(0x1fd)]=_0x2d3d44;}),_0x1a9e3d['forEach']((_0x3a4c16,_0x5c6c0e)=>{var _0x47bc64=_0x21c061;_0x545e20[_0x5c6c0e][_0x47bc64(0x18f)]=_0x3a4c16;}),_0x33e2e4[_0x21c061(0x187)]((_0x20c5b5,_0x5d9f23)=>{var _0x32da88=_0x21c061;_0x545e20[_0x5d9f23][_0x32da88(0x1c9)]=_0x20c5b5;}),_0x43533d[_0x21c061(0x187)]((_0x18dad5,_0xe1e326)=>{var _0x491c60=_0x21c061;_0x545e20[_0xe1e326][_0x491c60(0x1a9)]=_0x18dad5;}),_0x574907['forEach']((_0x2b03ce,_0x19a7ff)=>{var _0x3d262f=_0x21c061;_0x545e20[_0x19a7ff][_0x3d262f(0x163)]=_0x2b03ce;}),_0x5b3c15[_0x21c061(0x187)]((_0xdaca27,_0xb6560)=>{var _0x3bf7cd=_0x21c061;_0x545e20[_0xb6560][_0x3bf7cd(0x1a2)]=_0xdaca27;}),_0x4b1541['forEach']((_0x41220d,_0xb13a2b)=>{_0x545e20[_0xb13a2b]['production_date']=_0x41220d;}),_0x475766[_0x21c061(0x187)]((_0x337a99,_0x1fc618)=>{var _0x45c7d3=_0x21c061;_0x545e20[_0x1fc618][_0x45c7d3(0x20f)]=_0x337a99;}),_0x44d85e['forEach']((_0x4466d6,_0x11bf88)=>{_0x545e20[_0x11bf88]['room_names']=_0x4466d6;}),_0x1dba45[_0x21c061(0x187)]((_0x59e6b0,_0xc07ee)=>{var _0x57f57d=_0x21c061;_0x545e20[_0xc07ee][_0x57f57d(0x1dc)]=_0x59e6b0;}),_0x2ec9b6[_0x21c061(0x187)]((_0xd01c7d,_0x49003e)=>{var _0xaeba19=_0x21c061;_0x545e20[_0x49003e][_0xaeba19(0x207)]=_0xd01c7d;});const _0x5d9bce=_0x545e20[_0x21c061(0x1f1)](_0x33a89d=>_0x33a89d[_0x21c061(0x1c1)]!=='0'&&_0x33a89d[_0x21c061(0x1c1)]!=='');var _0x24b03c=0x0;_0x5d9bce['forEach'](_0x3cb82e=>{var _0x3b6164=_0x21c061;console[_0x3b6164(0x1a0)](_0x3b6164(0x1da),_0x3cb82e),parseInt(_0x3cb82e[_0x3b6164(0x1c1)])<=0x0&&_0x24b03c++;});if(_0x24b03c!=0x0)return _0x10590c['flash'](_0x21c061(0x1df),_0x21c061(0x17b)),_0x336ebd[_0x21c061(0x17a)](_0x21c061(0x155));const _0x28c29a=new adjustment_finished({'warehouse_name':_0x44161a,'date':_0x3c612a,'product':_0x5d9bce,'note':_0x407eb2,'room':_0x5a70ea,'invoice':_0x2a838a,'JO_number':_0x4113af,'expiry_date':_0x4cb101}),_0x54b60b=await _0x28c29a[_0x21c061(0x1a7)]();_0x10590c[_0x21c061(0x20b)](_0x21c061(0x1bd),_0x21c061(0x19c)),_0x336ebd[_0x21c061(0x17a)](_0x21c061(0x1b4)+_0x54b60b[_0x21c061(0x1f3)]);}catch(_0xa29211){console[_0x21c061(0x1a0)](_0xa29211),_0x336ebd[_0x21c061(0x167)](0xc8)[_0x21c061(0x19b)]({'message':_0xa29211[_0x21c061(0x172)]});}}),router[a0_0x4885ee(0x203)](a0_0x4885ee(0x1e3),auth,async(_0x4e74db,_0x12cbc9)=>{var _0x3f84c7=a0_0x4885ee;try{const {username:_0x4168a5,email:_0x4aa4b2,role:_0x3b0e35}=_0x4e74db['user'],_0x8ba294=_0x4e74db[_0x3f84c7(0x150)],_0x4aeb4d=await profile[_0x3f84c7(0x1f0)]({'email':_0x8ba294[_0x3f84c7(0x197)]}),_0x445458=await master_shop[_0x3f84c7(0x1d8)](),_0x4ad052=_0x4e74db[_0x3f84c7(0x215)]['id'],_0x1e3667=await adjustment_finished[_0x3f84c7(0x158)]({'_id':_0x4ad052}),_0x148a87=await purchases['aggregate']([{'$match':{'warehouse_name':_0x1e3667['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':_0x3f84c7(0x177)}}]);console[_0x3f84c7(0x1a0)]('purchases_data',_0x148a87);const _0x7389b2=await product[_0x3f84c7(0x1d8)]({}),_0xadd970=await warehouse[_0x3f84c7(0x1e1)]([{'$match':{'name':_0x1e3667[_0x3f84c7(0x174)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x3f84c7(0x160)},{'$group':{'_id':_0x3f84c7(0x1ed),'name':{'$first':_0x3f84c7(0x19e)},'product_stock':{'$first':_0x3f84c7(0x14e)},'bay':{'$first':_0x3f84c7(0x216)},'bin':{'$first':_0x3f84c7(0x1f5)},'type':{'$first':_0x3f84c7(0x219)},'floorlevel':{'$first':_0x3f84c7(0x1fc)},'primary_code':{'$first':_0x3f84c7(0x1e0)},'secondary_code':{'$first':_0x3f84c7(0x1de)},'product_code':{'$first':_0x3f84c7(0x1d6)},'storage':{'$first':_0x3f84c7(0x1e7)},'rack':{'$first':_0x3f84c7(0x1b1)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3f84c7(0x15e)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x3f84c7(0x1d5)},'room':{'$first':_0x3f84c7(0x1cb)}}}]);if(_0x445458[0x0][_0x3f84c7(0x1bc)]=='English\x20(US)'){var _0x14de4c=users[_0x3f84c7(0x19a)];console[_0x3f84c7(0x1a0)](_0x14de4c);}else{if(_0x445458[0x0][_0x3f84c7(0x1bc)]==_0x3f84c7(0x18e))var _0x14de4c=users[_0x3f84c7(0x18e)];else{if(_0x445458[0x0][_0x3f84c7(0x1bc)]=='German')var _0x14de4c=users[_0x3f84c7(0x1ef)];else{if(_0x445458[0x0][_0x3f84c7(0x1bc)]=='Spanish')var _0x14de4c=users[_0x3f84c7(0x173)];else{if(_0x445458[0x0][_0x3f84c7(0x1bc)]==_0x3f84c7(0x165))var _0x14de4c=users['French'];else{if(_0x445458[0x0][_0x3f84c7(0x1bc)]==_0x3f84c7(0x1d2))var _0x14de4c=users[_0x3f84c7(0x15d)];else{if(_0x445458[0x0][_0x3f84c7(0x1bc)]=='Chinese')var _0x14de4c=users['Chinese'];else{if(_0x445458[0x0][_0x3f84c7(0x1bc)]=='Arabic\x20(ae)')var _0x14de4c=users['Arabic'];}}}}}}}_0x12cbc9[_0x3f84c7(0x162)](_0x3f84c7(0x20a),{'success':_0x4e74db[_0x3f84c7(0x20b)](_0x3f84c7(0x1bd)),'errors':_0x4e74db[_0x3f84c7(0x20b)](_0x3f84c7(0x1df)),'role':_0x8ba294,'profile':_0x4aeb4d,'adjustment':_0x1e3667,'stock':_0xadd970,'master_shop':_0x445458,'warehouse_name':_0x148a87,'unit':_0x7389b2,'language':_0x14de4c});}catch(_0xece7a){console[_0x3f84c7(0x1a0)](_0xece7a),_0x12cbc9[_0x3f84c7(0x167)](0xc8)[_0x3f84c7(0x19b)]({'message':_0xece7a['message']});}}),router[a0_0x4885ee(0x1aa)](a0_0x4885ee(0x1e3),auth,async(_0x41b80f,_0x4a504e)=>{var _0x329622=a0_0x4885ee;try{const {invoice:_0x3cfbf9,warehouse_name:_0x599f12,Room_name:_0x36e3d0}=_0x41b80f[_0x329622(0x1ad)],_0x5f4853=_0x41b80f[_0x329622(0x215)]['id'],_0x5844a6=await adjustment_finished[_0x329622(0x158)]({'_id':_0x5f4853});var _0x422b88;const _0x29d419=_0x5844a6[_0x329622(0x1ab)][_0x329622(0x1f4)](async _0x3b670e=>{var _0x5dea9c=_0x329622;if(_0x3b670e[_0x5dea9c(0x1c1)]>0x0){_0x422b88=await warehouse[_0x5dea9c(0x1f0)]({'name':_0x599f12,'room':_0x3b670e['room_names'],'warehouse_category':_0x5dea9c(0x15a)});const _0x25d415=_0x422b88[_0x5dea9c(0x206)][_0x5dea9c(0x1f4)](_0x5b5d8f=>{var _0x9240d8=_0x5dea9c;console[_0x9240d8(0x1a0)](_0x3b670e[_0x9240d8(0x193)]);if(_0x3b670e[_0x9240d8(0x193)]=='minus')_0x5b5d8f[_0x9240d8(0x1cc)]==_0x3b670e[_0x9240d8(0x1cc)]&&_0x5b5d8f[_0x9240d8(0x1b9)]==_0x3b670e[_0x9240d8(0x1b9)]&&_0x5b5d8f[_0x9240d8(0x1a2)]==_0x3b670e[_0x9240d8(0x1a2)]&&_0x5b5d8f[_0x9240d8(0x199)]==_0x3b670e[_0x9240d8(0x199)]&&_0x5b5d8f[_0x9240d8(0x163)]==_0x3b670e[_0x9240d8(0x163)]&&_0x5b5d8f['invoice']==_0x3b670e[_0x9240d8(0x207)]&&(_0x5b5d8f['product_stock']=_0x5b5d8f[_0x9240d8(0x14c)]-_0x3b670e['adjust_qty']);else _0x3b670e[_0x9240d8(0x193)]==_0x9240d8(0x153)&&(_0x5b5d8f[_0x9240d8(0x1cc)]==_0x3b670e[_0x9240d8(0x1cc)]&&_0x5b5d8f['bay']==_0x3b670e[_0x9240d8(0x1b9)]&&_0x5b5d8f['expiry_date']==_0x3b670e[_0x9240d8(0x1a2)]&&_0x5b5d8f[_0x9240d8(0x199)]==_0x3b670e[_0x9240d8(0x199)]&&_0x5b5d8f[_0x9240d8(0x163)]==_0x3b670e[_0x9240d8(0x163)]&&_0x5b5d8f[_0x9240d8(0x207)]==_0x3b670e[_0x9240d8(0x207)]&&(_0x5b5d8f['product_stock']=_0x5b5d8f['product_stock']+_0x3b670e['adjust_qty']));});}return _0x422b88;});Promise['all'](_0x29d419)[_0x329622(0x1e9)](async _0x2f0cdb=>{var _0x21cc3b=_0x329622;try{for(const _0x40dcfc of _0x2f0cdb){await _0x40dcfc[_0x21cc3b(0x1a7)]();}_0x5844a6[_0x21cc3b(0x188)]=_0x21cc3b(0x204);const _0x287d6d=await _0x5844a6[_0x21cc3b(0x1a7)](),_0x39a79d=await master_shop[_0x21cc3b(0x1d8)](),_0xdac6ae=await email_settings[_0x21cc3b(0x1f0)](),_0x3ed71e=await supervisor_settings['find']();var _0x3e15a0=_0x5844a6[_0x21cc3b(0x1ab)],_0x4969d4='',_0x301a43;for(_0x301a43 in _0x3e15a0){var _0x130c0f='FG';_0x5844a6[_0x21cc3b(0x174)]==_0x21cc3b(0x182)&&(_0x130c0f='DG'),_0x4969d4+='<tr>'+_0x21cc3b(0x1c4)+_0x3e15a0[_0x301a43][_0x21cc3b(0x1cc)]+'</td>'+_0x21cc3b(0x1c4)+_0x3e15a0[_0x301a43][_0x21cc3b(0x1a9)]+_0x21cc3b(0x202)+_0x21cc3b(0x1c4)+_0x3e15a0[_0x301a43]['adjust_qty']+_0x21cc3b(0x202)+_0x21cc3b(0x1c4)+_0x3e15a0[_0x301a43][_0x21cc3b(0x18f)]+'</td>'+_0x21cc3b(0x1c4)+_0x3e15a0[_0x301a43][_0x21cc3b(0x1c9)]+'</td>'+_0x21cc3b(0x1c4)+_0x5844a6[_0x21cc3b(0x174)]+_0x21cc3b(0x202)+_0x21cc3b(0x1c4)+_0x3e15a0[_0x301a43][_0x21cc3b(0x1e6)]+_0x21cc3b(0x202)+_0x21cc3b(0x1c4)+_0x130c0f+_0x3e15a0[_0x301a43][_0x21cc3b(0x1b9)]+_0x21cc3b(0x202)+_0x21cc3b(0x157);}let _0x5cac30=nodemailer[_0x21cc3b(0x14d)]({'host':_0xdac6ae[_0x21cc3b(0x1d7)],'port':Number(_0xdac6ae['port']),'secure':![],'auth':{'user':_0xdac6ae[_0x21cc3b(0x197)],'pass':_0xdac6ae[_0x21cc3b(0x205)]}}),_0x18c4f7={'from':_0xdac6ae[_0x21cc3b(0x197)],'to':_0x3ed71e[0x0][_0x21cc3b(0x1ff)],'subject':_0x21cc3b(0x217),'attachments':[{'filename':'Logo.png','path':__dirname+_0x21cc3b(0x19d)+'/upload/'+_0x39a79d[0x0][_0x21cc3b(0x168)],'cid':_0x21cc3b(0x1c3)}],'html':_0x21cc3b(0x1c5)+_0x21cc3b(0x189)+_0x21cc3b(0x213)+'<div>'+_0x21cc3b(0x148)+_0x21cc3b(0x1b2)+_0x21cc3b(0x15b)+'</div>'+_0x21cc3b(0x1b2)+'<h2>\x20'+_0x39a79d[0x0][_0x21cc3b(0x1a3)]+_0x21cc3b(0x1e5)+_0x21cc3b(0x1be)+'</div>'+_0x21cc3b(0x211)+_0x21cc3b(0x1b2)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x21cc3b(0x198)+_0x5844a6[_0x21cc3b(0x207)]+'\x20'+_0x21cc3b(0x1b7)+'\x20Order\x20Date\x20:\x20'+_0x5844a6[_0x21cc3b(0x1d4)]+'\x20'+_0x21cc3b(0x209)+_0x21cc3b(0x180)+_0x21cc3b(0x1be)+_0x21cc3b(0x1f6)+_0x21cc3b(0x181)+_0x21cc3b(0x1d9)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x21cc3b(0x18d)+_0x21cc3b(0x17c)+_0x21cc3b(0x175)+_0x21cc3b(0x1b3)+_0x21cc3b(0x1f8)+_0x21cc3b(0x157)+_0x21cc3b(0x1bb)+_0x21cc3b(0x164)+'\x20'+_0x4969d4+'\x20'+_0x21cc3b(0x20d)+'</table>'+_0x21cc3b(0x1b2)+_0x21cc3b(0x16e)+_0x21cc3b(0x1ec)+_0x39a79d[0x0][_0x21cc3b(0x1a3)]+'</h5>'+'</div>'+_0x21cc3b(0x1be)+'</body></html>'};_0x5cac30[_0x21cc3b(0x1c2)](_0x18c4f7,function(_0x29087d,_0x29b431){var _0x20bc7b=_0x21cc3b;_0x29087d?(console['log'](_0x29087d),console[_0x20bc7b(0x1a0)](_0x20bc7b(0x1dd))):console[_0x20bc7b(0x1a0)](_0x20bc7b(0x1b8));}),_0x41b80f['flash'](_0x21cc3b(0x1bd),_0x21cc3b(0x1c6)),_0x4a504e[_0x21cc3b(0x17a)](_0x21cc3b(0x18c)+_0x287d6d[_0x21cc3b(0x1f3)]);}catch(_0x20953b){console[_0x21cc3b(0x1a6)](_0x20953b),_0x4a504e[_0x21cc3b(0x167)](0x1f4)[_0x21cc3b(0x19b)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x329622(0x161)](_0x2db9e6=>{var _0x59e336=_0x329622;console[_0x59e336(0x1a6)](_0x2db9e6),_0x4a504e[_0x59e336(0x167)](0x1f4)[_0x59e336(0x19b)]({'error':_0x59e336(0x1ca)});});}catch(_0x135ec5){_0x4a504e['json']({'message':_0x135ec5[_0x329622(0x172)]});}}),router['get'](a0_0x4885ee(0x1c8),auth,async(_0x292d82,_0x633b9b)=>{var _0x105298=a0_0x4885ee;try{const {username:_0xcb3b2a,email:_0x2b571f,role:_0x16782a}=_0x292d82[_0x105298(0x150)],_0x544bc3=_0x292d82[_0x105298(0x150)],_0x40cad3=await profile[_0x105298(0x1f0)]({'email':_0x544bc3[_0x105298(0x197)]}),_0x1807fe=await master_shop[_0x105298(0x1d8)]();console[_0x105298(0x1a0)](_0x105298(0x17d),_0x1807fe);const _0x532c7f=_0x292d82[_0x105298(0x215)]['id'],_0x316683=await adjustment_finished[_0x105298(0x158)]({'_id':_0x532c7f});let _0x5ba8d9=new Date(_0x316683[_0x105298(0x1a2)]),_0x15998c=('0'+_0x5ba8d9[_0x105298(0x214)]())['slice'](-0x2),_0x3c1aeb=('0'+(_0x5ba8d9[_0x105298(0x1b5)]()+0x1))[_0x105298(0x1ae)](-0x2),_0x131fa5=_0x5ba8d9[_0x105298(0x17e)](),_0xac305c=_0x131fa5+'-'+_0x3c1aeb+'-'+_0x15998c;var _0x3acb37=['Ambient',_0x105298(0x1cd),_0x105298(0x15f)];const _0x1db666=await purchases['aggregate']([{'$match':{'warehouse_name':_0x316683[_0x105298(0x174)]}},{'$unwind':'$product'},{'$group':{'_id':_0x105298(0x177)}}]);console[_0x105298(0x1a0)](_0x105298(0x185),_0x1db666);const _0x9ee382=await product[_0x105298(0x1d8)]({}),_0x4d4531=await warehouse['aggregate']([{'$match':{'name':_0x316683[_0x105298(0x174)],'room':_0x316683[_0x105298(0x183)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x105298(0x19e)},'product_stock':{'$first':_0x105298(0x14e)},'bay':{'$first':_0x105298(0x216)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x105298(0x219)},'floorlevel':{'$first':_0x105298(0x1fc)},'primary_code':{'$first':_0x105298(0x1e0)},'secondary_code':{'$first':_0x105298(0x1de)},'product_code':{'$first':_0x105298(0x1d6)},'storage':{'$first':_0x105298(0x1e7)},'rack':{'$first':'$product_details.rack'}}}]);if(_0x1807fe[0x0][_0x105298(0x1bc)]==_0x105298(0x1e8)){var _0x3dc4b4=users[_0x105298(0x19a)];console[_0x105298(0x1a0)](_0x3dc4b4);}else{if(_0x1807fe[0x0]['language']==_0x105298(0x18e))var _0x3dc4b4=users[_0x105298(0x18e)];else{if(_0x1807fe[0x0][_0x105298(0x1bc)]==_0x105298(0x1ef))var _0x3dc4b4=users[_0x105298(0x1ef)];else{if(_0x1807fe[0x0][_0x105298(0x1bc)]==_0x105298(0x173))var _0x3dc4b4=users[_0x105298(0x173)];else{if(_0x1807fe[0x0][_0x105298(0x1bc)]==_0x105298(0x165))var _0x3dc4b4=users['French'];else{if(_0x1807fe[0x0]['language']==_0x105298(0x1d2))var _0x3dc4b4=users['Portuguese'];else{if(_0x1807fe[0x0][_0x105298(0x1bc)]==_0x105298(0x1b6))var _0x3dc4b4=users[_0x105298(0x1b6)];else{if(_0x1807fe[0x0][_0x105298(0x1bc)]=='Arabic\x20(ae)')var _0x3dc4b4=users[_0x105298(0x178)];}}}}}}}_0x633b9b[_0x105298(0x162)](_0x105298(0x1fe),{'success':_0x292d82['flash'](_0x105298(0x1bd)),'errors':_0x292d82[_0x105298(0x20b)](_0x105298(0x1df)),'role':_0x544bc3,'profile':_0x40cad3,'adjustment':_0x316683,'stock':_0x4d4531,'master_shop':_0x1807fe,'warehouse_name':_0x1db666,'unit':_0x9ee382,'language':_0x3dc4b4,'rooms_data':_0x3acb37,'ed_fullDate':_0xac305c});}catch(_0x5bc80c){console[_0x105298(0x1a0)](_0x5bc80c),_0x633b9b['status'](0xc8)[_0x105298(0x19b)]({'message':_0x5bc80c[_0x105298(0x172)]});}}),router['post']('/view/:id',auth,async(_0xa202c1,_0x2a03a8)=>{var _0x3dcda8=a0_0x4885ee;try{const _0x1a9a3c=_0xa202c1[_0x3dcda8(0x215)]['id'],_0x2d8df3=await adjustment_finished[_0x3dcda8(0x158)]({'_id':_0x1a9a3c}),_0x501b3b=await warehouse[_0x3dcda8(0x1f0)]({'name':_0x2d8df3[_0x3dcda8(0x174)],'room':_0x2d8df3[_0x3dcda8(0x183)]}),{warehouse_name:_0x29cb97,date:_0x29d7aa,prod_name:_0x392832,level:_0x1aebb8,isle:_0x1e29c9,pallet:_0x31571d,stock:_0xb627e4,types:_0x1510c1,adjust_qty:_0x4cd165,new_adjust_qty:_0x498dfe,note:_0x17b3b7,Room_name:_0x15f25d,invoice:_0xa8ba29,JO_number:_0xeef9bb}=_0xa202c1[_0x3dcda8(0x1ad)];if(typeof _0x392832==_0x3dcda8(0x1fb))var _0x5ed7f1=[_0xa202c1['body'][_0x3dcda8(0x154)]],_0xa4e65b=[_0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x169)]],_0xda418d=[_0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x15c)]],_0x3a6bb5=[_0xa202c1['body']['types']],_0x4caee4=[_0xa202c1['body']['adjust_qty']],_0x1c4920=[_0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x1fd)]],_0x12dd5b=[_0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x1d1)]],_0x229fca=[_0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x18f)]],_0x1a56d0=[_0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x16d)]],_0x5dd97b=[_0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x163)]],_0x155d2d=[_0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x1a2)]];else var _0x5ed7f1=[..._0xa202c1[_0x3dcda8(0x1ad)]['prod_name']],_0xa4e65b=[..._0xa202c1['body'][_0x3dcda8(0x169)]],_0xda418d=[..._0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x15c)]],_0x3a6bb5=[..._0xa202c1[_0x3dcda8(0x1ad)]['types']],_0x4caee4=[..._0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x1c1)]],_0x1c4920=[..._0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x1fd)]],_0x12dd5b=[..._0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x1d1)]],_0x229fca=[..._0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x18f)]],_0x1a56d0=[..._0xa202c1[_0x3dcda8(0x1ad)][_0x3dcda8(0x16d)]],_0x5dd97b=[..._0xa202c1['body'][_0x3dcda8(0x163)]],_0x155d2d=[..._0xa202c1[_0x3dcda8(0x1ad)]['expiry_date']];const _0x584b28=_0x5ed7f1[_0x3dcda8(0x1f4)](_0x483328=>{return _0x483328={'product_name':_0x483328};});_0xa4e65b[_0x3dcda8(0x187)]((_0x34f4b3,_0x27c414)=>{var _0x44ea87=_0x3dcda8;_0x584b28[_0x27c414][_0x44ea87(0x1b9)]=_0x34f4b3;}),_0xda418d[_0x3dcda8(0x187)]((_0x14c8c7,_0x19ed92)=>{var _0x2a95c0=_0x3dcda8;_0x584b28[_0x19ed92][_0x2a95c0(0x16a)]=_0x14c8c7;}),_0x3a6bb5[_0x3dcda8(0x187)]((_0x83cb9a,_0x17b34e)=>{var _0x31f9cf=_0x3dcda8;_0x584b28[_0x17b34e][_0x31f9cf(0x193)]=_0x83cb9a;}),_0x4caee4[_0x3dcda8(0x187)]((_0xca8e3f,_0x28ef12)=>{var _0x2db746=_0x3dcda8;_0x584b28[_0x28ef12][_0x2db746(0x1c1)]=_0xca8e3f;}),_0x1c4920['forEach']((_0x1d3f6d,_0x5564d6)=>{var _0x6110d9=_0x3dcda8;_0x584b28[_0x5564d6][_0x6110d9(0x1fd)]=_0x1d3f6d;}),_0x229fca[_0x3dcda8(0x187)]((_0x2beb91,_0x66cfc9)=>{var _0x16cc4a=_0x3dcda8;_0x584b28[_0x66cfc9][_0x16cc4a(0x18f)]=_0x2beb91;}),_0x1a56d0['forEach']((_0x8e6335,_0x30f608)=>{_0x584b28[_0x30f608]['secondary_unit']=_0x8e6335;}),_0x12dd5b['forEach']((_0x378523,_0x3774f8)=>{var _0x1160e1=_0x3dcda8;_0x584b28[_0x3774f8][_0x1160e1(0x1a9)]=_0x378523;}),_0x5dd97b['forEach']((_0xc97c84,_0x4fd8c0)=>{_0x584b28[_0x4fd8c0]['batch_code']=_0xc97c84;}),_0x155d2d[_0x3dcda8(0x187)]((_0x1aa743,_0x4b0887)=>{_0x584b28[_0x4b0887]['expiry_date']=_0x1aa743;});const _0x462146=_0x584b28[_0x3dcda8(0x1f1)](_0x282ad4=>_0x282ad4['adjust_qty']!=='0'&&_0x282ad4['adjust_qty']!=='');var _0x3fd093=0x0;_0x462146['forEach'](_0x5305ea=>{var _0x216b65=_0x3dcda8;console[_0x216b65(0x1a0)](_0x216b65(0x1da),_0x5305ea),parseInt(_0x5305ea[_0x216b65(0x1c1)])<=0x0&&_0x3fd093++;});if(_0x3fd093!=0x0)return _0xa202c1[_0x3dcda8(0x20b)](_0x3dcda8(0x1df),_0x3dcda8(0x17b)),_0x2a03a8[_0x3dcda8(0x17a)](_0x3dcda8(0x155));_0x2d8df3[_0x3dcda8(0x174)]=_0x29cb97,_0x2d8df3[_0x3dcda8(0x1d4)]=_0x29d7aa,_0x2d8df3[_0x3dcda8(0x1ab)]=_0x462146,_0x2d8df3[_0x3dcda8(0x195)]=_0x17b3b7,_0x2d8df3['room']=_0x15f25d,_0x2d8df3['invoice']=_0xa8ba29,_0x2d8df3[_0x3dcda8(0x16c)]=_0xeef9bb;const _0x1efcc4=await _0x2d8df3[_0x3dcda8(0x1a7)](),_0xf1867b=await warehouse[_0x3dcda8(0x1f0)]({'name':_0x29cb97,'room':_0x15f25d});_0x1efcc4[_0x3dcda8(0x1ab)][_0x3dcda8(0x187)](_0x54772b=>{var _0x2388f1=_0x3dcda8;const _0x3f1dc2=_0xf1867b[_0x2388f1(0x206)][_0x2388f1(0x1f4)](_0x16eed7=>{var _0x53de0f=_0x2388f1;_0x54772b[_0x53de0f(0x193)]==_0x53de0f(0x1ba)?_0x16eed7['product_name']==_0x54772b['product_name']&&_0x16eed7[_0x53de0f(0x1b9)]==_0x54772b[_0x53de0f(0x1b9)]&&(_0x16eed7[_0x53de0f(0x14c)]=parseInt(_0x16eed7[_0x53de0f(0x14c)])-parseInt(_0x54772b[_0x53de0f(0x1c1)])):_0x16eed7['product_name']==_0x54772b[_0x53de0f(0x1cc)]&&_0x16eed7[_0x53de0f(0x1b9)]==_0x54772b['bay']&&(_0x16eed7[_0x53de0f(0x14c)]=parseInt(_0x16eed7[_0x53de0f(0x14c)])+parseInt(_0x54772b[_0x53de0f(0x1c1)]));});}),await _0xf1867b[_0x3dcda8(0x1a7)](),_0xa202c1[_0x3dcda8(0x20b)](_0x3dcda8(0x1bd),'adjustment\x20data\x20update\x20successfully'),_0x2a03a8[_0x3dcda8(0x17a)](_0x3dcda8(0x190));}catch(_0x26811e){console['log'](_0x26811e);}}),router[a0_0x4885ee(0x1aa)](a0_0x4885ee(0x1a4),async(_0x434f42,_0x544ed0)=>{var _0x2f3163=a0_0x4885ee;const {primary_code:_0x11da0c,warehouse_data:_0x175bac,rooms_data:_0x53985a,Roomslist:_0x4c8d47}=_0x434f42[_0x2f3163(0x1ad)],_0x7dd324=_0x4c8d47[_0x2f3163(0x186)](','),_0x3d8b08=[];async function _0x31dbef(_0x508706){var _0x32c4ac=_0x2f3163;const _0xf380fc=await warehouse[_0x32c4ac(0x1e1)]([{'$match':{'name':_0x175bac,'room':_0x508706}},{'$unwind':_0x32c4ac(0x160)},{'$match':{'product_details.primary_code':_0x11da0c}},{'$group':{'_id':_0x32c4ac(0x1ed),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x32c4ac(0x1e0)},'secondary_code':{'$first':_0x32c4ac(0x1de)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x32c4ac(0x216)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x32c4ac(0x1fc)},'unit':{'$first':_0x32c4ac(0x171)},'secondary_unit':{'$first':_0x32c4ac(0x1d3)},'storage':{'$first':_0x32c4ac(0x1e7)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x32c4ac(0x1fa)},'production_date':{'$first':_0x32c4ac(0x15e)},'batch_code':{'$first':_0x32c4ac(0x1af)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x32c4ac(0x1d5)},'roomNamed':{'$first':_0x32c4ac(0x1cb)},'invoice':{'$first':_0x32c4ac(0x1ce)}}}]),_0x1d7359=await warehouse[_0x32c4ac(0x1e1)]([{'$match':{'name':_0x175bac,'room':_0x508706}},{'$unwind':_0x32c4ac(0x160)},{'$match':{'product_details.secondary_code':_0x11da0c}},{'$group':{'_id':_0x32c4ac(0x1ed),'name':{'$first':_0x32c4ac(0x19e)},'product_stock':{'$first':_0x32c4ac(0x14e)},'primary_code':{'$first':_0x32c4ac(0x1e0)},'secondary_code':{'$first':_0x32c4ac(0x1de)},'product_code':{'$first':_0x32c4ac(0x1d6)},'level':{'$first':_0x32c4ac(0x216)},'isle':{'$first':_0x32c4ac(0x1f5)},'type':{'$first':_0x32c4ac(0x219)},'pallet':{'$first':_0x32c4ac(0x1fc)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x32c4ac(0x1e7)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x32c4ac(0x1fa)},'production_date':{'$first':_0x32c4ac(0x15e)},'batch_code':{'$first':_0x32c4ac(0x1af)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x32c4ac(0x1cb)},'invoice':{'$first':_0x32c4ac(0x1ce)}}}]);if(_0xf380fc[_0x32c4ac(0x176)]>0x0)_0x3d8b08['push'](_0xf380fc);else _0x1d7359[_0x32c4ac(0x176)]>0x0&&_0x3d8b08['push'](_0x1d7359);}const _0x50b602=_0x7dd324[_0x2f3163(0x1f4)](_0x3d938b=>_0x31dbef(_0x3d938b));await Promise[_0x2f3163(0x16f)](_0x50b602),_0x544ed0[_0x2f3163(0x19b)](_0x3d8b08);}),router['post']('/CheckingWarehouse',async(_0x57d512,_0x19aa61)=>{var _0x291c99=a0_0x4885ee;const {productCode:_0x316fd3,bay:_0x5de5b9,warehouses:_0x59556b,room:_0x5d86d4}=_0x57d512[_0x291c99(0x1ad)];console['log'](_0x57d512[_0x291c99(0x1ad)]);try{const _0x543de7=await warehouse[_0x291c99(0x1e1)]([{'$match':{'name':_0x59556b,'room':_0x5d86d4}},{'$unwind':_0x291c99(0x160)},{'$match':{'product_details.bay':parseInt(_0x5de5b9)}},{'$group':{'_id':_0x291c99(0x1ed),'name':{'$first':_0x291c99(0x19e)},'product_stock':{'$first':_0x291c99(0x14e)},'bay':{'$first':_0x291c99(0x216)},'maxProducts':{'$first':_0x291c99(0x201)}}}]);_0x19aa61[_0x291c99(0x167)](0xc8)[_0x291c99(0x19b)](_0x543de7);}catch(_0x17e773){_0x19aa61[_0x291c99(0x167)](0x194)[_0x291c99(0x19b)]({'message':_0x17e773['message']});}}),module[a0_0x4885ee(0x18b)]=router;