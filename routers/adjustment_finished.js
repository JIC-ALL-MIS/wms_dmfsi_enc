var a0_0x4b38d0=a0_0x4946;(function(_0x24db14,_0x2d6739){var _0x24f7db=a0_0x4946,_0x4a4430=_0x24db14();while(!![]){try{var _0x43c0a6=-parseInt(_0x24f7db(0x278))/0x1*(-parseInt(_0x24f7db(0x221))/0x2)+-parseInt(_0x24f7db(0x20b))/0x3+-parseInt(_0x24f7db(0x1dd))/0x4+-parseInt(_0x24f7db(0x1f3))/0x5+parseInt(_0x24f7db(0x1f7))/0x6+parseInt(_0x24f7db(0x1e5))/0x7*(-parseInt(_0x24f7db(0x1e2))/0x8)+-parseInt(_0x24f7db(0x295))/0x9*(-parseInt(_0x24f7db(0x1db))/0xa);if(_0x43c0a6===_0x2d6739)break;else _0x4a4430['push'](_0x4a4430['shift']());}catch(_0x1a9f65){_0x4a4430['push'](_0x4a4430['shift']());}}}(a0_0x1289,0x43f2b));function a0_0x4946(_0x51eede,_0xd3d4e4){var _0x1289f4=a0_0x1289();return a0_0x4946=function(_0x4946f3,_0x4f57da){_0x4946f3=_0x4946f3-0x1d4;var _0x557b35=_0x1289f4[_0x4946f3];return _0x557b35;},a0_0x4946(_0x51eede,_0xd3d4e4);}const express=require(a0_0x4b38d0(0x285)),app=express(),router=express[a0_0x4b38d0(0x255)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require('../models/all_models'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x4b38d0(0x1f4));router[a0_0x4b38d0(0x26f)]('/view',auth,async(_0x4f736b,_0xc48d1e)=>{var _0x564f1b=a0_0x4b38d0;try{const {username:_0x182bdb,email:_0x3d21ac,role:_0xf9bab5}=_0x4f736b[_0x564f1b(0x26b)],_0x5362cf=_0x4f736b['user'],_0x359564=await profile[_0x564f1b(0x1ea)]({'email':_0x5362cf['email']}),_0x43121b=await master_shop['find']();let _0x4da4c2;if(_0x5362cf[_0x564f1b(0x218)]==_0x564f1b(0x242)){const _0xb67a24=await staff[_0x564f1b(0x1ea)]({'email':_0x5362cf[_0x564f1b(0x287)]});_0x4da4c2=await warehouse[_0x564f1b(0x208)]({'status':_0x564f1b(0x249),'name':_0xb67a24[_0x564f1b(0x1e8)]});}else _0x4da4c2=await warehouse[_0x564f1b(0x208)]({'status':'Enabled'});const _0x13ce50=await product[_0x564f1b(0x208)]();let _0x117411;if(_0x5362cf[_0x564f1b(0x218)]=='staff'){const _0x5da9a5=await staff[_0x564f1b(0x1ea)]({'email':_0x5362cf['email']});_0x117411=await adjustment_finished[_0x564f1b(0x208)]({'warehouse_name':_0x5da9a5[_0x564f1b(0x1e8)]});}else _0x117411=await adjustment_finished[_0x564f1b(0x244)]([{'$unwind':'$product'},{'$group':{'_id':_0x564f1b(0x258),'invoice':{'$first':_0x564f1b(0x291)},'date':{'$first':_0x564f1b(0x21e)},'warehouse_name':{'$first':_0x564f1b(0x280)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x564f1b(0x23b)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x43121b[0x0]['language']==_0x564f1b(0x294)){var _0x570f43=users[_0x564f1b(0x239)];console[_0x564f1b(0x21d)](_0x570f43);}else{if(_0x43121b[0x0]['language']==_0x564f1b(0x231))var _0x570f43=users[_0x564f1b(0x231)];else{if(_0x43121b[0x0][_0x564f1b(0x235)]==_0x564f1b(0x1fc))var _0x570f43=users['German'];else{if(_0x43121b[0x0][_0x564f1b(0x235)]==_0x564f1b(0x26c))var _0x570f43=users[_0x564f1b(0x26c)];else{if(_0x43121b[0x0][_0x564f1b(0x235)]==_0x564f1b(0x1f9))var _0x570f43=users[_0x564f1b(0x1f9)];else{if(_0x43121b[0x0][_0x564f1b(0x235)]==_0x564f1b(0x261))var _0x570f43=users[_0x564f1b(0x237)];else{if(_0x43121b[0x0][_0x564f1b(0x235)]==_0x564f1b(0x288))var _0x570f43=users[_0x564f1b(0x288)];else{if(_0x43121b[0x0][_0x564f1b(0x235)]==_0x564f1b(0x219))var _0x570f43=users[_0x564f1b(0x1f2)];}}}}}}}_0xc48d1e[_0x564f1b(0x25a)](_0x564f1b(0x28c),{'success':_0x4f736b[_0x564f1b(0x223)](_0x564f1b(0x203)),'errors':_0x4f736b[_0x564f1b(0x223)](_0x564f1b(0x25f)),'role':_0x5362cf,'profile':_0x359564,'warehouse':_0x4da4c2,'product':_0x13ce50,'adjustment':_0x117411,'master_shop':_0x43121b,'language':_0x570f43});}catch(_0x1b22dc){console['log'](_0x1b22dc);}});async function getRandom8DigitNumber(){var _0x427b76=a0_0x4b38d0;const _0x34d64b=0x989680,_0x262310=0x5f5e0ff,_0x47622d=Math[_0x427b76(0x206)](Math['random']()*(_0x262310-_0x34d64b+0x1))+_0x34d64b;var _0x11ee99;const _0x561dc0=await adjustment_finished[_0x427b76(0x1ea)]({'invoice':_0x427b76(0x276)+_0x47622d});return _0x561dc0&&_0x561dc0[_0x427b76(0x262)]>0x0?_0x11ee99=_0x427b76(0x276)+_0x47622d:_0x11ee99=_0x427b76(0x276)+_0x47622d,_0x11ee99;}function a0_0x1289(){var _0x8de975=['$product_details._id','stockBefore','</tr>','$invoice','room','$product_details.bin','English\x20(US)','9hjAwne','</thead>','save','types','catch','product_details','\x20Order\x20Number\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','room_names','16043990RvwKkx','getDate','2186528vOkMhI','new_adjust_qty','then','$product_details.rack','invoice','3630680kVBtKS','/../public','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','7XjTCan','An\x20error\x20occurred.','findById','warehouse','stock','findOne','product_stock','<tr>','post','<h5\x20style=\x22text-align:\x20left;\x22>','adjustment\x20add\x20successfull','status','product','Arabic','2704350FROOyZ','nodemailer','Enclosed','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','1226694MajjjU','edit_adjustment_finished','French','$product_details.floorlevel','Email\x20sent\x20successfully','German','add','product_name','message','maxPerUnit','product_code','batch_code','success','Ambient','date','floor','createTransport','find','New_Qty_Converted','split','163314rIeuEV','back','Logo.png','finalize','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.bay','New_Qty_Converted_adj','$product_details.expiry_date','/view/add_adjustment','$product_details','exports','error','site_title','role','Arabic\x20(ae)','An\x20error\x20occurred\x20while\x20saving\x20data.','padStart','adjust_qty','log','$date','Error\x20Occurs','params','65242NARtWE','$product_details.maxPerUnit','flash','$product','filter','push','<h5>','foreach\x20newproduct','<hr\x20class=\x22my-3\x22>','warehouse_name','string','body','<tbody\x20style=\x22text-align:\x20center;\x22>','prod_name','$product_details.storage','image','Hindi','/CheckingWarehouse','<span\x20style=\x22float:\x20right;\x22>','prod_cat','language','minus','Portuguese','level','English','adjustment\x20data\x20update\x20successfully','$finalize','$product_details.production_date','prod_code','secondary_unit','$product_details.primary_code','expiry_date','production_date','staff','/preview/:id','aggregate','prod_invoice','<div>','$product_details.secondary_unit','</head><body>','Enabled','$product_details.maxProducts','getFullYear','True','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.product_code','$name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','sendMail','</h5>','</tbody>','/barcode_scanner','Router','/upload/','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$_id','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','render','$product_details.product_stock','_id','$product_details.product_name','/picking_list/PDF_adjustment/','errors','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Portuguese\x20(BR)','length','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','all','Finished\x20Goods','$product_details.unit','</td>','bay','forEach','master','user','Spanish','Adjustment\x20Mail','\x20Order\x20Date\x20:\x20','get','purchases_data','Return\x20Rooms','map','/view/:id','$product_details.type','$product_details.batch_code','ADJF-','$product_details.secondary_code','2oGyHta','json','<!DOCTYPE\x20html>','$room','$product_details.invoice','slice','QA\x20Warehouse','Secondary_units','$warehouse_name','Rooms','redirect','port','JO_number','express','edit_adjustment_finished_view','email','Chinese','getMonth','</div>','unit','adjustment_finished','<table\x20style=\x22width:\x20100%\x20!important;\x22>'];a0_0x1289=function(){return _0x8de975;};return a0_0x1289();}router[a0_0x4b38d0(0x26f)](a0_0x4b38d0(0x213),auth,async(_0x2c025c,_0x24c073)=>{var _0x3d309d=a0_0x4b38d0;try{const {username:_0x121283,email:_0x25d8e0,role:_0x33a9ca}=_0x2c025c['user'],_0xffa043=_0x2c025c[_0x3d309d(0x26b)],_0xb53dc0=await profile[_0x3d309d(0x1ea)]({'email':_0xffa043['email']}),_0x3fe7fc=await master_shop[_0x3d309d(0x208)]();let _0x44c640;if(_0xffa043[_0x3d309d(0x218)]==_0x3d309d(0x242)){const _0x3afac3=await staff[_0x3d309d(0x1ea)]({'email':_0xffa043[_0x3d309d(0x287)]});_0x44c640=await warehouse[_0x3d309d(0x244)]([{'$match':{'status':_0x3d309d(0x249),'name':_0x3afac3[_0x3d309d(0x1e8)],'warehouse_category':_0x3d309d(0x265),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x3d309d(0x24f),'name':{'$first':_0x3d309d(0x24f)}}}]);}else _0x44c640=await warehouse[_0x3d309d(0x244)]([{'$match':{'status':_0x3d309d(0x249),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x3d309d(0x27e)}}},{'$group':{'_id':'$name','name':{'$first':_0x3d309d(0x24f)}}}]);const _0x50b688=await product[_0x3d309d(0x208)]({}),_0x4c322f=await adjustment_finished[_0x3d309d(0x208)]({}),_0x2a8c51=_0x4c322f[_0x3d309d(0x262)]+0x1,_0x54a751=_0x3d309d(0x276)+_0x2a8c51['toString']()[_0x3d309d(0x21b)](0x5,'0');var _0x2da44e=[_0x3d309d(0x204),_0x3d309d(0x1f5),_0x3d309d(0x271)];if(_0x3fe7fc[0x0][_0x3d309d(0x235)]==_0x3d309d(0x294))var _0x5f5a3c=users[_0x3d309d(0x239)];else{if(_0x3fe7fc[0x0][_0x3d309d(0x235)]==_0x3d309d(0x231))var _0x5f5a3c=users[_0x3d309d(0x231)];else{if(_0x3fe7fc[0x0][_0x3d309d(0x235)]==_0x3d309d(0x1fc))var _0x5f5a3c=users[_0x3d309d(0x1fc)];else{if(_0x3fe7fc[0x0][_0x3d309d(0x235)]==_0x3d309d(0x26c))var _0x5f5a3c=users[_0x3d309d(0x26c)];else{if(_0x3fe7fc[0x0][_0x3d309d(0x235)]==_0x3d309d(0x1f9))var _0x5f5a3c=users[_0x3d309d(0x1f9)];else{if(_0x3fe7fc[0x0][_0x3d309d(0x235)]==_0x3d309d(0x261))var _0x5f5a3c=users[_0x3d309d(0x237)];else{if(_0x3fe7fc[0x0][_0x3d309d(0x235)]==_0x3d309d(0x288))var _0x5f5a3c=users['Chinese'];else{if(_0x3fe7fc[0x0][_0x3d309d(0x235)]==_0x3d309d(0x219))var _0x5f5a3c=users[_0x3d309d(0x1f2)];}}}}}}}const _0x31ebbc=getRandom8DigitNumber();_0x31ebbc[_0x3d309d(0x1df)](_0x59376b=>{var _0x3d06c5=_0x3d309d;_0x24c073['render']('add_adjustment_finished',{'success':_0x2c025c['flash']('success'),'errors':_0x2c025c[_0x3d06c5(0x223)](_0x3d06c5(0x25f)),'role':_0xffa043,'profile':_0xb53dc0,'warehouse':_0x44c640,'product':_0x50b688,'master_shop':_0x3fe7fc,'language':_0x5f5a3c,'rooms_data':_0x2da44e,'invoice_no':_0x59376b});})[_0x3d309d(0x1d5)](_0x5c84f9=>{var _0x2a5534=_0x3d309d;_0x2c025c[_0x2a5534(0x223)](_0x2a5534(0x25f),_0x2a5534(0x1d9)),_0x24c073[_0x2a5534(0x282)]('/adjustment/view');});}catch(_0x2b0eb2){console[_0x3d309d(0x21d)](_0x2b0eb2);}}),router[a0_0x4b38d0(0x1ed)](a0_0x4b38d0(0x213),auth,async(_0x42d717,_0x5cfa45)=>{var _0xd2a4a0=a0_0x4b38d0;try{const {warehouse_name:_0x139ae3,date:_0x4d794e,prod_name:_0xc1994c,level:_0x3cdb2d,isle:_0x23550a,pallet:_0x2f63b7,stock:_0x58b7af,types:_0x2884bb,adjust_qty:_0x2c044b,new_adjust_qty:_0x4927a7,note:_0x4147ba,Room_name:_0x1de2d3,invoice:_0x25c25d,JO_number:_0x51c3b0,expiry_date:_0x34b207}=_0x42d717[_0xd2a4a0(0x22c)];if(typeof _0xc1994c=='string')var _0x3355bb=[_0x42d717['body'][_0xd2a4a0(0x22e)]],_0x298881=[_0x42d717['body'][_0xd2a4a0(0x238)]],_0x27e333=[_0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x1e9)]],_0x51ec84=[_0x42d717['body'][_0xd2a4a0(0x1d4)]],_0x5030b9=[_0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x211)]],_0x423105=[_0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x209)]],_0xfa7da1=[_0x42d717[_0xd2a4a0(0x22c)]['Primary_Units']],_0x54ec94=[_0x42d717['body'][_0xd2a4a0(0x27f)]],_0x549bce=[_0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x23d)]],_0x10a744=[_0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x202)]],_0x5f1e46=[_0x42d717['body'][_0xd2a4a0(0x240)]],_0x13dc4b=[_0x42d717[_0xd2a4a0(0x22c)]['product_date']],_0x3fefb0=[_0x42d717[_0xd2a4a0(0x22c)]['prod_cat']],_0x4c48f1=[_0x42d717['body'][_0xd2a4a0(0x281)]],_0x1c2393=[_0x42d717[_0xd2a4a0(0x22c)]['maxPerUnit']],_0x2b8bdd=[_0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x245)]];else var _0x3355bb=[..._0x42d717['body'][_0xd2a4a0(0x22e)]],_0x298881=[..._0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x238)]],_0x27e333=[..._0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x1e9)]],_0x51ec84=[..._0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x1d4)]],_0x5030b9=[..._0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x211)]],_0x423105=[..._0x42d717['body'][_0xd2a4a0(0x209)]],_0xfa7da1=[..._0x42d717['body']['Primary_Units']],_0x54ec94=[..._0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x27f)]],_0x549bce=[..._0x42d717['body']['prod_code']],_0x10a744=[..._0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x202)]],_0x5f1e46=[..._0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x240)]],_0x13dc4b=[..._0x42d717[_0xd2a4a0(0x22c)]['product_date']],_0x3fefb0=[..._0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x234)]],_0x4c48f1=[..._0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x281)]],_0x1c2393=[..._0x42d717['body'][_0xd2a4a0(0x200)]],_0x2b8bdd=[..._0x42d717[_0xd2a4a0(0x22c)][_0xd2a4a0(0x245)]];const _0xf8a745=_0x3355bb[_0xd2a4a0(0x272)](_0x392615=>{return _0x392615={'product_name':_0x392615};});_0x298881[_0xd2a4a0(0x269)]((_0x2848da,_0x48784a)=>{var _0x12454b=_0xd2a4a0;_0xf8a745[_0x48784a][_0x12454b(0x268)]=_0x2848da;}),_0x27e333[_0xd2a4a0(0x269)]((_0x1cca25,_0x236f3e)=>{_0xf8a745[_0x236f3e]['stockBefore']=_0x1cca25;}),_0x51ec84[_0xd2a4a0(0x269)]((_0xac4cfb,_0x347b08)=>{var _0x438ba7=_0xd2a4a0;_0xf8a745[_0x347b08][_0x438ba7(0x1d4)]=_0xac4cfb;}),_0x5030b9[_0xd2a4a0(0x269)]((_0x4ed684,_0x306ca4)=>{_0xf8a745[_0x306ca4]['adjust_qty']=_0x4ed684;}),_0x423105[_0xd2a4a0(0x269)]((_0x47d5cb,_0x35239e)=>{var _0x4c072e=_0xd2a4a0;_0xf8a745[_0x35239e][_0x4c072e(0x1de)]=_0x47d5cb;}),_0xfa7da1[_0xd2a4a0(0x269)]((_0x1ff6a3,_0x22b799)=>{var _0x318585=_0xd2a4a0;_0xf8a745[_0x22b799][_0x318585(0x28b)]=_0x1ff6a3;}),_0x54ec94[_0xd2a4a0(0x269)]((_0x69c645,_0x13bc34)=>{var _0xc2492e=_0xd2a4a0;_0xf8a745[_0x13bc34][_0xc2492e(0x23e)]=_0x69c645;}),_0x549bce[_0xd2a4a0(0x269)]((_0x343d4e,_0xdb14e5)=>{var _0x500710=_0xd2a4a0;_0xf8a745[_0xdb14e5][_0x500710(0x201)]=_0x343d4e;}),_0x10a744['forEach']((_0x43fb6f,_0x36e7eb)=>{var _0x4d7360=_0xd2a4a0;_0xf8a745[_0x36e7eb][_0x4d7360(0x202)]=_0x43fb6f;}),_0x5f1e46[_0xd2a4a0(0x269)]((_0x4d0fca,_0x1412c6)=>{var _0x4f38cd=_0xd2a4a0;_0xf8a745[_0x1412c6][_0x4f38cd(0x240)]=_0x4d0fca;}),_0x13dc4b[_0xd2a4a0(0x269)]((_0x4bcd68,_0x224b47)=>{var _0x43de09=_0xd2a4a0;_0xf8a745[_0x224b47][_0x43de09(0x241)]=_0x4bcd68;}),_0x3fefb0[_0xd2a4a0(0x269)]((_0x26934,_0x118e78)=>{var _0x51fafc=_0xd2a4a0;_0xf8a745[_0x118e78][_0x51fafc(0x234)]=_0x26934;}),_0x4c48f1['forEach']((_0x349ae0,_0x290e4b)=>{var _0x2f947c=_0xd2a4a0;_0xf8a745[_0x290e4b][_0x2f947c(0x1da)]=_0x349ae0;}),_0x1c2393[_0xd2a4a0(0x269)]((_0x26ffbc,_0x1567ab)=>{_0xf8a745[_0x1567ab]['maxPerUnit']=_0x26ffbc;}),_0x2b8bdd[_0xd2a4a0(0x269)]((_0x1c140f,_0x578d0b)=>{var _0x260525=_0xd2a4a0;_0xf8a745[_0x578d0b][_0x260525(0x1e1)]=_0x1c140f;});const _0x16a5f9=_0xf8a745[_0xd2a4a0(0x225)](_0x4e80ea=>_0x4e80ea['adjust_qty']!=='0'&&_0x4e80ea['adjust_qty']!=='');var _0x8af58e=0x0;_0x16a5f9['forEach'](_0x29134=>{var _0x3f3862=_0xd2a4a0;console[_0x3f3862(0x21d)](_0x3f3862(0x228),_0x29134),parseInt(_0x29134[_0x3f3862(0x21c)])<=0x0&&_0x8af58e++;});if(_0x8af58e!=0x0)return _0x42d717[_0xd2a4a0(0x223)](_0xd2a4a0(0x25f),_0xd2a4a0(0x20f)),_0x5cfa45[_0xd2a4a0(0x282)](_0xd2a4a0(0x20c));const _0x2b7e7b=new adjustment_finished({'warehouse_name':_0x139ae3,'date':_0x4d794e,'product':_0x16a5f9,'note':_0x4147ba,'room':_0x1de2d3,'invoice':_0x25c25d,'JO_number':_0x51c3b0,'expiry_date':_0x34b207}),_0x54afd9=await _0x2b7e7b[_0xd2a4a0(0x297)]();_0x42d717['flash'](_0xd2a4a0(0x203),_0xd2a4a0(0x1ef)),_0x5cfa45[_0xd2a4a0(0x282)]('/adjustment_finished/preview/'+_0x54afd9[_0xd2a4a0(0x25c)]);}catch(_0x403932){console['log'](_0x403932),_0x5cfa45[_0xd2a4a0(0x1f0)](0xc8)[_0xd2a4a0(0x279)]({'message':_0x403932['message']});}}),router[a0_0x4b38d0(0x26f)]('/preview/:id',auth,async(_0x4c5d67,_0x4aae05)=>{var _0x3808c7=a0_0x4b38d0;try{const {username:_0x2458db,email:_0x4b1ba8,role:_0x38a55c}=_0x4c5d67[_0x3808c7(0x26b)],_0x29bb79=_0x4c5d67[_0x3808c7(0x26b)],_0x54049d=await profile['findOne']({'email':_0x29bb79[_0x3808c7(0x287)]}),_0x5ba743=await master_shop[_0x3808c7(0x208)](),_0x1c0f91=_0x4c5d67[_0x3808c7(0x220)]['id'],_0x49fc15=await adjustment_finished[_0x3808c7(0x1e7)]({'_id':_0x1c0f91}),_0x7b17a8=await purchases[_0x3808c7(0x244)]([{'$match':{'warehouse_name':_0x49fc15[_0x3808c7(0x22a)]}},{'$unwind':_0x3808c7(0x224)},{'$group':{'_id':'$product.product_name'}}]);console[_0x3808c7(0x21d)](_0x3808c7(0x270),_0x7b17a8);const _0x4e3999=await product['find']({}),_0x141fd7=await warehouse[_0x3808c7(0x244)]([{'$match':{'name':_0x49fc15['warehouse_name'],'warehouse_category':_0x3808c7(0x265)}},{'$unwind':_0x3808c7(0x214)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3808c7(0x210)},'bin':{'$first':_0x3808c7(0x293)},'type':{'$first':_0x3808c7(0x274)},'floorlevel':{'$first':_0x3808c7(0x1fa)},'primary_code':{'$first':_0x3808c7(0x23f)},'secondary_code':{'$first':_0x3808c7(0x277)},'product_code':{'$first':_0x3808c7(0x24e)},'storage':{'$first':_0x3808c7(0x22f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3808c7(0x212)},'production_date':{'$first':_0x3808c7(0x23c)},'batch_code':{'$first':_0x3808c7(0x275)},'maxPerUnit':{'$first':_0x3808c7(0x222)},'room':{'$first':_0x3808c7(0x27b)}}}]);if(_0x5ba743[0x0][_0x3808c7(0x235)]==_0x3808c7(0x294)){var _0x67148d=users['English'];console[_0x3808c7(0x21d)](_0x67148d);}else{if(_0x5ba743[0x0][_0x3808c7(0x235)]==_0x3808c7(0x231))var _0x67148d=users[_0x3808c7(0x231)];else{if(_0x5ba743[0x0][_0x3808c7(0x235)]==_0x3808c7(0x1fc))var _0x67148d=users['German'];else{if(_0x5ba743[0x0]['language']=='Spanish')var _0x67148d=users[_0x3808c7(0x26c)];else{if(_0x5ba743[0x0]['language']==_0x3808c7(0x1f9))var _0x67148d=users['French'];else{if(_0x5ba743[0x0][_0x3808c7(0x235)]==_0x3808c7(0x261))var _0x67148d=users[_0x3808c7(0x237)];else{if(_0x5ba743[0x0][_0x3808c7(0x235)]==_0x3808c7(0x288))var _0x67148d=users['Chinese'];else{if(_0x5ba743[0x0][_0x3808c7(0x235)]==_0x3808c7(0x219))var _0x67148d=users[_0x3808c7(0x1f2)];}}}}}}}_0x4aae05[_0x3808c7(0x25a)](_0x3808c7(0x286),{'success':_0x4c5d67[_0x3808c7(0x223)](_0x3808c7(0x203)),'errors':_0x4c5d67[_0x3808c7(0x223)](_0x3808c7(0x25f)),'role':_0x29bb79,'profile':_0x54049d,'adjustment':_0x49fc15,'stock':_0x141fd7,'master_shop':_0x5ba743,'warehouse_name':_0x7b17a8,'unit':_0x4e3999,'language':_0x67148d});}catch(_0x33fafc){console[_0x3808c7(0x21d)](_0x33fafc),_0x4aae05[_0x3808c7(0x1f0)](0xc8)[_0x3808c7(0x279)]({'message':_0x33fafc[_0x3808c7(0x1ff)]});}}),router[a0_0x4b38d0(0x1ed)](a0_0x4b38d0(0x243),auth,async(_0x134f76,_0x2bea5e)=>{var _0x24901d=a0_0x4b38d0;try{const {invoice:_0x1404a1,warehouse_name:_0x35ed50,Room_name:_0x3a385e}=_0x134f76[_0x24901d(0x22c)],_0x158d20=_0x134f76[_0x24901d(0x220)]['id'],_0x188a05=await adjustment_finished[_0x24901d(0x1e7)]({'_id':_0x158d20});var _0x2bb438;const _0x499cd0=_0x188a05[_0x24901d(0x1f1)]['map'](async _0x1b85ab=>{var _0x291fbf=_0x24901d;if(_0x1b85ab[_0x291fbf(0x21c)]>0x0){_0x2bb438=await warehouse[_0x291fbf(0x1ea)]({'name':_0x35ed50,'room':_0x1b85ab[_0x291fbf(0x1da)],'warehouse_category':_0x291fbf(0x265)});const _0x267728=_0x2bb438[_0x291fbf(0x1d6)][_0x291fbf(0x272)](_0x36152b=>{var _0x19f0c2=_0x291fbf;console[_0x19f0c2(0x21d)](_0x1b85ab[_0x19f0c2(0x1d4)]);if(_0x1b85ab['types']==_0x19f0c2(0x236))_0x36152b['product_name']==_0x1b85ab[_0x19f0c2(0x1fe)]&&_0x36152b[_0x19f0c2(0x268)]==_0x1b85ab[_0x19f0c2(0x268)]&&_0x36152b[_0x19f0c2(0x240)]==_0x1b85ab[_0x19f0c2(0x240)]&&_0x36152b[_0x19f0c2(0x241)]==_0x1b85ab[_0x19f0c2(0x241)]&&_0x36152b[_0x19f0c2(0x202)]==_0x1b85ab['batch_code']&&_0x36152b[_0x19f0c2(0x1e1)]==_0x1b85ab[_0x19f0c2(0x1e1)]&&(_0x36152b[_0x19f0c2(0x1eb)]=_0x36152b[_0x19f0c2(0x1eb)]-_0x1b85ab['adjust_qty']);else _0x1b85ab['types']==_0x19f0c2(0x1fd)&&(_0x36152b[_0x19f0c2(0x1fe)]==_0x1b85ab['product_name']&&_0x36152b['bay']==_0x1b85ab[_0x19f0c2(0x268)]&&_0x36152b[_0x19f0c2(0x240)]==_0x1b85ab[_0x19f0c2(0x240)]&&_0x36152b[_0x19f0c2(0x241)]==_0x1b85ab[_0x19f0c2(0x241)]&&_0x36152b[_0x19f0c2(0x202)]==_0x1b85ab[_0x19f0c2(0x202)]&&_0x36152b['invoice']==_0x1b85ab[_0x19f0c2(0x1e1)]&&(_0x36152b[_0x19f0c2(0x1eb)]=_0x36152b['product_stock']+_0x1b85ab['adjust_qty']));});}return _0x2bb438;});Promise[_0x24901d(0x264)](_0x499cd0)[_0x24901d(0x1df)](async _0x508801=>{var _0x5f5991=_0x24901d;try{for(const _0x5f2407 of _0x508801){await _0x5f2407[_0x5f5991(0x297)]();}_0x188a05[_0x5f5991(0x20e)]=_0x5f5991(0x24c);const _0x19864f=await _0x188a05[_0x5f5991(0x297)](),_0x104b97=await master_shop[_0x5f5991(0x208)](),_0x24fac3=await email_settings[_0x5f5991(0x1ea)](),_0x2134f5=await supervisor_settings['find']();var _0x574893=_0x188a05['product'],_0x34a34e='',_0x583d48;for(_0x583d48 in _0x574893){var _0xde99a3='FG';_0x188a05[_0x5f5991(0x22a)]=='DRY\x20GOODS'&&(_0xde99a3='DG'),_0x34a34e+=_0x5f5991(0x1ec)+_0x5f5991(0x259)+_0x574893[_0x583d48][_0x5f5991(0x1fe)]+_0x5f5991(0x267)+_0x5f5991(0x259)+_0x574893[_0x583d48][_0x5f5991(0x201)]+_0x5f5991(0x267)+_0x5f5991(0x259)+_0x574893[_0x583d48][_0x5f5991(0x21c)]+_0x5f5991(0x267)+_0x5f5991(0x259)+_0x574893[_0x583d48][_0x5f5991(0x28b)]+_0x5f5991(0x267)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x574893[_0x583d48]['secondary_unit']+_0x5f5991(0x267)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x188a05[_0x5f5991(0x22a)]+_0x5f5991(0x267)+_0x5f5991(0x259)+_0x574893[_0x583d48][_0x5f5991(0x1da)]+_0x5f5991(0x267)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xde99a3+_0x574893[_0x583d48][_0x5f5991(0x268)]+_0x5f5991(0x267)+_0x5f5991(0x290);}let _0x117400=nodemailer[_0x5f5991(0x207)]({'host':_0x24fac3['host'],'port':Number(_0x24fac3[_0x5f5991(0x283)]),'secure':![],'auth':{'user':_0x24fac3['email'],'pass':_0x24fac3['password']}}),_0x505dc6={'from':_0x24fac3[_0x5f5991(0x287)],'to':_0x2134f5[0x0]['FGSEmail'],'subject':_0x5f5991(0x26d),'attachments':[{'filename':_0x5f5991(0x20d),'path':__dirname+_0x5f5991(0x1e3)+_0x5f5991(0x256)+_0x104b97[0x0][_0x5f5991(0x230)],'cid':'logo'}],'html':_0x5f5991(0x27a)+'<html><head><title></title>'+_0x5f5991(0x248)+'<div>'+_0x5f5991(0x24d)+'<div>'+_0x5f5991(0x1e4)+_0x5f5991(0x28a)+_0x5f5991(0x246)+'<h2>\x20'+_0x104b97[0x0][_0x5f5991(0x217)]+'\x20</h2>'+_0x5f5991(0x28a)+_0x5f5991(0x28a)+_0x5f5991(0x229)+'<div>'+_0x5f5991(0x1ee)+_0x5f5991(0x1d7)+_0x188a05[_0x5f5991(0x1e1)]+'\x20'+_0x5f5991(0x233)+_0x5f5991(0x26e)+_0x188a05[_0x5f5991(0x205)]+'\x20'+'</span>'+_0x5f5991(0x252)+_0x5f5991(0x28a)+_0x5f5991(0x28d)+_0x5f5991(0x257)+'<tr>'+_0x5f5991(0x260)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x5f5991(0x263)+_0x5f5991(0x1f6)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x5f5991(0x1d8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x5f5991(0x250)+_0x5f5991(0x290)+_0x5f5991(0x296)+_0x5f5991(0x22d)+'\x20'+_0x34a34e+'\x20'+_0x5f5991(0x253)+'</table>'+_0x5f5991(0x246)+'<strong>\x20Regards\x20</strong>'+_0x5f5991(0x227)+_0x104b97[0x0][_0x5f5991(0x217)]+_0x5f5991(0x252)+_0x5f5991(0x28a)+_0x5f5991(0x28a)+'</body></html>'};_0x117400[_0x5f5991(0x251)](_0x505dc6,function(_0xe19a17,_0x18b2c3){var _0xbafcdd=_0x5f5991;_0xe19a17?(console['log'](_0xe19a17),console[_0xbafcdd(0x21d)](_0xbafcdd(0x21f))):console[_0xbafcdd(0x21d)](_0xbafcdd(0x1fb));}),_0x134f76[_0x5f5991(0x223)](_0x5f5991(0x203),'Adjustment\x20Finalize\x20Successfully'),_0x2bea5e[_0x5f5991(0x282)](_0x5f5991(0x25e)+_0x19864f[_0x5f5991(0x25c)]);}catch(_0x37ea3e){console[_0x5f5991(0x216)](_0x37ea3e),_0x2bea5e[_0x5f5991(0x1f0)](0x1f4)[_0x5f5991(0x279)]({'error':_0x5f5991(0x21a)});}})[_0x24901d(0x1d5)](_0x225ee4=>{var _0x38f27a=_0x24901d;console[_0x38f27a(0x216)](_0x225ee4),_0x2bea5e['status'](0x1f4)[_0x38f27a(0x279)]({'error':_0x38f27a(0x1e6)});});}catch(_0x442803){_0x2bea5e[_0x24901d(0x279)]({'message':_0x442803[_0x24901d(0x1ff)]});}}),router[a0_0x4b38d0(0x26f)]('/view/:id',auth,async(_0x4f5f50,_0x430e05)=>{var _0x56690e=a0_0x4b38d0;try{const {username:_0x16585e,email:_0x5b9a4d,role:_0x36a744}=_0x4f5f50[_0x56690e(0x26b)],_0x325cae=_0x4f5f50[_0x56690e(0x26b)],_0x557ce8=await profile[_0x56690e(0x1ea)]({'email':_0x325cae[_0x56690e(0x287)]}),_0x48e547=await master_shop[_0x56690e(0x208)]();console[_0x56690e(0x21d)](_0x56690e(0x26a),_0x48e547);const _0x33dabd=_0x4f5f50['params']['id'],_0x359ce7=await adjustment_finished[_0x56690e(0x1e7)]({'_id':_0x33dabd});let _0xad7fbd=new Date(_0x359ce7[_0x56690e(0x240)]),_0x3d99dd=('0'+_0xad7fbd[_0x56690e(0x1dc)]())[_0x56690e(0x27d)](-0x2),_0x5a4e8d=('0'+(_0xad7fbd[_0x56690e(0x289)]()+0x1))[_0x56690e(0x27d)](-0x2),_0x31b4e5=_0xad7fbd[_0x56690e(0x24b)](),_0x575258=_0x31b4e5+'-'+_0x5a4e8d+'-'+_0x3d99dd;var _0x23725f=['Ambient',_0x56690e(0x1f5),_0x56690e(0x271)];const _0x5d8d68=await purchases['aggregate']([{'$match':{'warehouse_name':_0x359ce7['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]);console[_0x56690e(0x21d)](_0x56690e(0x270),_0x5d8d68);const _0x476815=await product[_0x56690e(0x208)]({}),_0x3a6e99=await warehouse[_0x56690e(0x244)]([{'$match':{'name':_0x359ce7[_0x56690e(0x22a)],'room':_0x359ce7[_0x56690e(0x292)]}},{'$unwind':_0x56690e(0x214)},{'$group':{'_id':_0x56690e(0x28e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x56690e(0x25b)},'bay':{'$first':_0x56690e(0x210)},'bin':{'$first':_0x56690e(0x293)},'type':{'$first':_0x56690e(0x274)},'floorlevel':{'$first':_0x56690e(0x1fa)},'primary_code':{'$first':_0x56690e(0x23f)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x56690e(0x24e)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x56690e(0x1e0)}}}]);if(_0x48e547[0x0][_0x56690e(0x235)]==_0x56690e(0x294)){var _0x3b7017=users[_0x56690e(0x239)];console[_0x56690e(0x21d)](_0x3b7017);}else{if(_0x48e547[0x0][_0x56690e(0x235)]==_0x56690e(0x231))var _0x3b7017=users['Hindi'];else{if(_0x48e547[0x0][_0x56690e(0x235)]=='German')var _0x3b7017=users[_0x56690e(0x1fc)];else{if(_0x48e547[0x0][_0x56690e(0x235)]=='Spanish')var _0x3b7017=users[_0x56690e(0x26c)];else{if(_0x48e547[0x0]['language']==_0x56690e(0x1f9))var _0x3b7017=users[_0x56690e(0x1f9)];else{if(_0x48e547[0x0]['language']==_0x56690e(0x261))var _0x3b7017=users[_0x56690e(0x237)];else{if(_0x48e547[0x0]['language']==_0x56690e(0x288))var _0x3b7017=users[_0x56690e(0x288)];else{if(_0x48e547[0x0][_0x56690e(0x235)]==_0x56690e(0x219))var _0x3b7017=users['Arabic'];}}}}}}}_0x430e05[_0x56690e(0x25a)](_0x56690e(0x1f8),{'success':_0x4f5f50['flash']('success'),'errors':_0x4f5f50[_0x56690e(0x223)](_0x56690e(0x25f)),'role':_0x325cae,'profile':_0x557ce8,'adjustment':_0x359ce7,'stock':_0x3a6e99,'master_shop':_0x48e547,'warehouse_name':_0x5d8d68,'unit':_0x476815,'language':_0x3b7017,'rooms_data':_0x23725f,'ed_fullDate':_0x575258});}catch(_0x40da27){console[_0x56690e(0x21d)](_0x40da27),_0x430e05[_0x56690e(0x1f0)](0xc8)[_0x56690e(0x279)]({'message':_0x40da27['message']});}}),router[a0_0x4b38d0(0x1ed)](a0_0x4b38d0(0x273),auth,async(_0x18fd5a,_0x11aa30)=>{var _0x3597b6=a0_0x4b38d0;try{const _0x20a64c=_0x18fd5a[_0x3597b6(0x220)]['id'],_0x49f128=await adjustment_finished[_0x3597b6(0x1e7)]({'_id':_0x20a64c}),_0x208609=await warehouse[_0x3597b6(0x1ea)]({'name':_0x49f128[_0x3597b6(0x22a)],'room':_0x49f128['room']}),{warehouse_name:_0x1699ac,date:_0x4e4d8d,prod_name:_0x238670,level:_0x2aad57,isle:_0x35c260,pallet:_0x212805,stock:_0x2c4b46,types:_0x39b350,adjust_qty:_0x5332b1,new_adjust_qty:_0xe0dd01,note:_0x188657,Room_name:_0x3815b0,invoice:_0x1c3cde,JO_number:_0x13cffe}=_0x18fd5a[_0x3597b6(0x22c)];if(typeof _0x238670==_0x3597b6(0x22b))var _0x4931d1=[_0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x22e)]],_0x52ca4d=[_0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x238)]],_0x452b28=[_0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x1e9)]],_0xa77e66=[_0x18fd5a[_0x3597b6(0x22c)]['types']],_0x3614ba=[_0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x21c)]],_0x12add6=[_0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x1de)]],_0x4162d4=[_0x18fd5a[_0x3597b6(0x22c)]['prod_code']],_0xe10965=[_0x18fd5a['body'][_0x3597b6(0x28b)]],_0x2cb748=[_0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x27f)]],_0x4779d3=[_0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x202)]],_0x33f211=[_0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x240)]];else var _0x4931d1=[..._0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x22e)]],_0x52ca4d=[..._0x18fd5a[_0x3597b6(0x22c)]['level']],_0x452b28=[..._0x18fd5a['body']['stock']],_0xa77e66=[..._0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x1d4)]],_0x3614ba=[..._0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x21c)]],_0x12add6=[..._0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x1de)]],_0x4162d4=[..._0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x23d)]],_0xe10965=[..._0x18fd5a[_0x3597b6(0x22c)]['unit']],_0x2cb748=[..._0x18fd5a[_0x3597b6(0x22c)]['Secondary_units']],_0x4779d3=[..._0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x202)]],_0x33f211=[..._0x18fd5a[_0x3597b6(0x22c)][_0x3597b6(0x240)]];const _0x500222=_0x4931d1[_0x3597b6(0x272)](_0x5de202=>{return _0x5de202={'product_name':_0x5de202};});_0x52ca4d['forEach']((_0x228a9f,_0x4885af)=>{var _0x87d8c9=_0x3597b6;_0x500222[_0x4885af][_0x87d8c9(0x268)]=_0x228a9f;}),_0x452b28[_0x3597b6(0x269)]((_0x1a71f3,_0x2e8c8c)=>{var _0x570214=_0x3597b6;_0x500222[_0x2e8c8c][_0x570214(0x28f)]=_0x1a71f3;}),_0xa77e66['forEach']((_0x4ea9e0,_0x245f9f)=>{var _0xd0ecbc=_0x3597b6;_0x500222[_0x245f9f][_0xd0ecbc(0x1d4)]=_0x4ea9e0;}),_0x3614ba[_0x3597b6(0x269)]((_0x2386cc,_0x2cda02)=>{var _0x307727=_0x3597b6;_0x500222[_0x2cda02][_0x307727(0x21c)]=_0x2386cc;}),_0x12add6[_0x3597b6(0x269)]((_0x333f24,_0x2b0f82)=>{var _0x29ba6b=_0x3597b6;_0x500222[_0x2b0f82][_0x29ba6b(0x1de)]=_0x333f24;}),_0xe10965[_0x3597b6(0x269)]((_0x3983ae,_0x3a136e)=>{_0x500222[_0x3a136e]['unit']=_0x3983ae;}),_0x2cb748['forEach']((_0x1ff750,_0x17e6e1)=>{_0x500222[_0x17e6e1]['secondary_unit']=_0x1ff750;}),_0x4162d4[_0x3597b6(0x269)]((_0x3b1fd9,_0x7e0066)=>{_0x500222[_0x7e0066]['product_code']=_0x3b1fd9;}),_0x4779d3[_0x3597b6(0x269)]((_0x1d3630,_0x516773)=>{var _0x45d0a9=_0x3597b6;_0x500222[_0x516773][_0x45d0a9(0x202)]=_0x1d3630;}),_0x33f211[_0x3597b6(0x269)]((_0x51f7ce,_0x2687db)=>{var _0x2dfa8e=_0x3597b6;_0x500222[_0x2687db][_0x2dfa8e(0x240)]=_0x51f7ce;});const _0x294a58=_0x500222[_0x3597b6(0x225)](_0x41772f=>_0x41772f[_0x3597b6(0x21c)]!=='0'&&_0x41772f[_0x3597b6(0x21c)]!=='');var _0x375fc8=0x0;_0x294a58[_0x3597b6(0x269)](_0x3a4bb1=>{var _0x469711=_0x3597b6;console[_0x469711(0x21d)](_0x469711(0x228),_0x3a4bb1),parseInt(_0x3a4bb1[_0x469711(0x21c)])<=0x0&&_0x375fc8++;});if(_0x375fc8!=0x0)return _0x18fd5a[_0x3597b6(0x223)]('errors',_0x3597b6(0x20f)),_0x11aa30[_0x3597b6(0x282)](_0x3597b6(0x20c));_0x49f128[_0x3597b6(0x22a)]=_0x1699ac,_0x49f128[_0x3597b6(0x205)]=_0x4e4d8d,_0x49f128[_0x3597b6(0x1f1)]=_0x294a58,_0x49f128['note']=_0x188657,_0x49f128[_0x3597b6(0x292)]=_0x3815b0,_0x49f128[_0x3597b6(0x1e1)]=_0x1c3cde,_0x49f128[_0x3597b6(0x284)]=_0x13cffe;const _0x536065=await _0x49f128['save'](),_0x377754=await warehouse[_0x3597b6(0x1ea)]({'name':_0x1699ac,'room':_0x3815b0});_0x536065[_0x3597b6(0x1f1)][_0x3597b6(0x269)](_0x19aecd=>{var _0x7a9927=_0x3597b6;const _0x55024e=_0x377754[_0x7a9927(0x1d6)][_0x7a9927(0x272)](_0x754e71=>{var _0x2edec7=_0x7a9927;_0x19aecd[_0x2edec7(0x1d4)]==_0x2edec7(0x236)?_0x754e71['product_name']==_0x19aecd['product_name']&&_0x754e71[_0x2edec7(0x268)]==_0x19aecd[_0x2edec7(0x268)]&&(_0x754e71[_0x2edec7(0x1eb)]=parseInt(_0x754e71['product_stock'])-parseInt(_0x19aecd['adjust_qty'])):_0x754e71[_0x2edec7(0x1fe)]==_0x19aecd[_0x2edec7(0x1fe)]&&_0x754e71[_0x2edec7(0x268)]==_0x19aecd[_0x2edec7(0x268)]&&(_0x754e71[_0x2edec7(0x1eb)]=parseInt(_0x754e71[_0x2edec7(0x1eb)])+parseInt(_0x19aecd[_0x2edec7(0x21c)]));});}),await _0x377754[_0x3597b6(0x297)](),_0x18fd5a[_0x3597b6(0x223)](_0x3597b6(0x203),_0x3597b6(0x23a)),_0x11aa30[_0x3597b6(0x282)]('/adjustment_finished/view');}catch(_0x52ba74){console['log'](_0x52ba74);}}),router[a0_0x4b38d0(0x1ed)](a0_0x4b38d0(0x254),async(_0x4a9336,_0x2df930)=>{var _0x14f40c=a0_0x4b38d0;const {primary_code:_0x1262c5,warehouse_data:_0x451cf8,rooms_data:_0x5f5987,Roomslist:_0x5ef382}=_0x4a9336[_0x14f40c(0x22c)],_0x4e6306=_0x5ef382[_0x14f40c(0x20a)](','),_0xf2ef71=[];async function _0x1954fa(_0x207623){var _0x4b6691=_0x14f40c;const _0x23e990=await warehouse['aggregate']([{'$match':{'name':_0x451cf8,'room':_0x207623}},{'$unwind':_0x4b6691(0x214)},{'$match':{'product_details.primary_code':_0x1262c5}},{'$group':{'_id':_0x4b6691(0x28e),'name':{'$first':_0x4b6691(0x25d)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x4b6691(0x23f)},'secondary_code':{'$first':_0x4b6691(0x277)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x4b6691(0x210)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x4b6691(0x274)},'pallet':{'$first':_0x4b6691(0x1fa)},'unit':{'$first':_0x4b6691(0x266)},'secondary_unit':{'$first':_0x4b6691(0x247)},'storage':{'$first':_0x4b6691(0x22f)},'rack':{'$first':_0x4b6691(0x1e0)},'expiry_date':{'$first':_0x4b6691(0x212)},'production_date':{'$first':_0x4b6691(0x23c)},'batch_code':{'$first':_0x4b6691(0x275)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x4b6691(0x222)},'roomNamed':{'$first':_0x4b6691(0x27b)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x478d2c=await warehouse[_0x4b6691(0x244)]([{'$match':{'name':_0x451cf8,'room':_0x207623}},{'$unwind':_0x4b6691(0x214)},{'$match':{'product_details.secondary_code':_0x1262c5}},{'$group':{'_id':_0x4b6691(0x28e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4b6691(0x25b)},'primary_code':{'$first':_0x4b6691(0x23f)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x4b6691(0x210)},'isle':{'$first':_0x4b6691(0x293)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x4b6691(0x1fa)},'unit':{'$first':_0x4b6691(0x266)},'secondary_unit':{'$first':_0x4b6691(0x247)},'storage':{'$first':_0x4b6691(0x22f)},'rack':{'$first':_0x4b6691(0x1e0)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4b6691(0x23c)},'batch_code':{'$first':_0x4b6691(0x275)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x4b6691(0x27c)}}}]);if(_0x23e990[_0x4b6691(0x262)]>0x0)_0xf2ef71[_0x4b6691(0x226)](_0x23e990);else _0x478d2c[_0x4b6691(0x262)]>0x0&&_0xf2ef71[_0x4b6691(0x226)](_0x478d2c);}const _0x498b2d=_0x4e6306[_0x14f40c(0x272)](_0x330c0f=>_0x1954fa(_0x330c0f));await Promise['all'](_0x498b2d),_0x2df930['json'](_0xf2ef71);}),router['post'](a0_0x4b38d0(0x232),async(_0x5edbd8,_0x4abde0)=>{var _0x361283=a0_0x4b38d0;const {productCode:_0x869975,bay:_0x181e62,warehouses:_0x5b0bdb,room:_0x455272}=_0x5edbd8[_0x361283(0x22c)];console[_0x361283(0x21d)](_0x5edbd8[_0x361283(0x22c)]);try{const _0x13a28a=await warehouse['aggregate']([{'$match':{'name':_0x5b0bdb,'room':_0x455272}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x181e62)}},{'$group':{'_id':_0x361283(0x28e),'name':{'$first':_0x361283(0x25d)},'product_stock':{'$first':_0x361283(0x25b)},'bay':{'$first':_0x361283(0x210)},'maxProducts':{'$first':_0x361283(0x24a)}}}]);_0x4abde0[_0x361283(0x1f0)](0xc8)[_0x361283(0x279)](_0x13a28a);}catch(_0x45f907){_0x4abde0[_0x361283(0x1f0)](0x194)['json']({'message':_0x45f907[_0x361283(0x1ff)]});}}),module[a0_0x4b38d0(0x215)]=router;