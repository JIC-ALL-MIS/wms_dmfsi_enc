function a0_0x553f(_0x5180cd,_0x9677a6){var _0x131297=a0_0x1312();return a0_0x553f=function(_0x553f2d,_0x529074){_0x553f2d=_0x553f2d-0xef;var _0x381267=_0x131297[_0x553f2d];return _0x381267;},a0_0x553f(_0x5180cd,_0x9677a6);}var a0_0x5a8988=a0_0x553f;(function(_0xde0225,_0x890c15){var _0x58ba92=a0_0x553f,_0x4d600f=_0xde0225();while(!![]){try{var _0x185fb9=parseInt(_0x58ba92(0x127))/0x1+parseInt(_0x58ba92(0xf1))/0x2+-parseInt(_0x58ba92(0x195))/0x3*(-parseInt(_0x58ba92(0x111))/0x4)+-parseInt(_0x58ba92(0x177))/0x5+parseInt(_0x58ba92(0x128))/0x6*(-parseInt(_0x58ba92(0x145))/0x7)+parseInt(_0x58ba92(0x135))/0x8+-parseInt(_0x58ba92(0x100))/0x9;if(_0x185fb9===_0x890c15)break;else _0x4d600f['push'](_0x4d600f['shift']());}catch(_0x4316d3){_0x4d600f['push'](_0x4d600f['shift']());}}}(a0_0x1312,0xa9fca));const express=require(a0_0x5a8988(0x142)),app=express(),router=express[a0_0x5a8988(0x125)](),auth=require(a0_0x5a8988(0x16e)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require('../models/all_models'),users=require(a0_0x5a8988(0x13a)),nodemailer=require('nodemailer');function a0_0x1312(){var _0x1f2542=['catch','prod_invoice','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<h5>','map','product_date','</h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','language','new_adjust_qty','$product_details._id','invoice','../middleware/auth','JO_number','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product.room_names','password','New_Qty_Converted','stock','room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','2295085tGKxGm','$product','post','Adjustment\x20Finalize\x20Successfully','/../public','types','adjust_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','English','FGSEmail','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','errors','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$room','json','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','get','/adjustment_finished/preview/','unit','<div>','New_Qty_Converted_adj','secondary_unit','$_id','$product_details.product_code','aggregate','sendMail','\x20</h2>','stockBefore','getDate','createTransport','73797kqGkfu','all','English\x20(US)','_id','floor','German','Arabic\x20(ae)','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$name','</div>','port','Adjustment\x20Mail','split','$product_details','back','add_adjustment_finished','<table\x20style=\x22width:\x20100%\x20!important;\x22>','prod_name','find','bay','Rooms','staff','<span\x20style=\x22float:\x20right;\x22>','</body></html>','/view/:id','QA\x20Warehouse','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</span>','$date','minus','$product_details.bay','$product_details.maxPerUnit','site_title','Secondary_units','$product_details.primary_code','1343106jqUNXh','room_names','note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','email','<h5\x20style=\x22text-align:\x20left;\x22>','random','log','Portuguese','</tr>','$invoice','render','French','params','<tr>','13229613ZQInfG','findOne','/view/add_adjustment','findById','Primary_Units','image','redirect','slice','/barcode_scanner','Chinese','level','status','$product_details.rack','<tbody\x20style=\x22text-align:\x20center;\x22>','forEach','prod_code','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','52yQgWPi','expiry_date','Portuguese\x20(BR)','batch_code','adjustment\x20add\x20successfull','prod_cat','production_date','<!DOCTYPE\x20html>','product_code','success','product_name','body','<h2>\x20','$product_details.bin','adjustment\x20data\x20update\x20successfully','host','toString','$product_details.invoice','Arabic','$product_details.storage','Router','maxPerUnit','858777MyDoWk','706740fHtRee','exports','date','$product_details.product_stock','$product_details.production_date','Finished\x20Goods','$product_details.unit','DRY\x20GOODS','ADJF-','$product_details.product_name','$product_details.batch_code','$product.product_name','warehouse','9027944egVnIf','getMonth','\x20Order\x20Date\x20:\x20','purchases_data','$finalize','../public/language/languages.json','add','then','<hr\x20class=\x22my-3\x22>','foreach\x20newproduct','Ambient','$warehouse_name','string','express','<html><head><title></title>','Enclosed','21EYTzTN','product_stock','message','</td>','adjustment_finished','length','push','$product_details.secondary_unit','Spanish','filter','role','/upload/','$product_details.expiry_date','flash','error','user','An\x20error\x20occurred.','save','$product_details.type','Enabled','warehouse_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','/view','product','Return\x20Rooms','$product_details.secondary_code','Hindi','$product_details.floorlevel','/CheckingWarehouse'];a0_0x1312=function(){return _0x1f2542;};return a0_0x1312();}router[a0_0x5a8988(0x187)](a0_0x5a8988(0x15b),auth,async(_0x2c6be8,_0x5b7676)=>{var _0x47ce5a=a0_0x5a8988;try{const {username:_0x4a8753,email:_0x39689d,role:_0x1d91d1}=_0x2c6be8[_0x47ce5a(0x154)],_0x469e54=_0x2c6be8[_0x47ce5a(0x154)],_0x913e03=await profile[_0x47ce5a(0x101)]({'email':_0x469e54[_0x47ce5a(0xf5)]}),_0x42a3ce=await master_shop[_0x47ce5a(0x1a7)]();let _0x227a43;if(_0x469e54[_0x47ce5a(0x14f)]==_0x47ce5a(0x1aa)){const _0x41e559=await staff[_0x47ce5a(0x101)]({'email':_0x469e54['email']});_0x227a43=await warehouse[_0x47ce5a(0x1a7)]({'status':_0x47ce5a(0x158),'name':_0x41e559[_0x47ce5a(0x134)]});}else _0x227a43=await warehouse[_0x47ce5a(0x1a7)]({'status':_0x47ce5a(0x158)});const _0x191a46=await product[_0x47ce5a(0x1a7)]();let _0x5d34b5;if(_0x469e54[_0x47ce5a(0x14f)]==_0x47ce5a(0x1aa)){const _0x245115=await staff[_0x47ce5a(0x101)]({'email':_0x469e54['email']});_0x5d34b5=await adjustment_finished[_0x47ce5a(0x1a7)]({'warehouse_name':_0x245115[_0x47ce5a(0x134)]});}else _0x5d34b5=await adjustment_finished[_0x47ce5a(0x18f)]([{'$unwind':_0x47ce5a(0x178)},{'$group':{'_id':_0x47ce5a(0x18d),'invoice':{'$first':_0x47ce5a(0xfb)},'date':{'$first':_0x47ce5a(0x1b1)},'warehouse_name':{'$first':_0x47ce5a(0x140)},'room':{'$addToSet':_0x47ce5a(0x171)},'finalize':{'$first':_0x47ce5a(0x139)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x42a3ce[0x0][_0x47ce5a(0x16a)]==_0x47ce5a(0x197)){var _0x2873c2=users['English'];console[_0x47ce5a(0xf8)](_0x2873c2);}else{if(_0x42a3ce[0x0][_0x47ce5a(0x16a)]=='Hindi')var _0x2873c2=users[_0x47ce5a(0x15f)];else{if(_0x42a3ce[0x0][_0x47ce5a(0x16a)]==_0x47ce5a(0x19a))var _0x2873c2=users[_0x47ce5a(0x19a)];else{if(_0x42a3ce[0x0]['language']=='Spanish')var _0x2873c2=users['Spanish'];else{if(_0x42a3ce[0x0][_0x47ce5a(0x16a)]=='French')var _0x2873c2=users[_0x47ce5a(0xfd)];else{if(_0x42a3ce[0x0][_0x47ce5a(0x16a)]=='Portuguese\x20(BR)')var _0x2873c2=users[_0x47ce5a(0xf9)];else{if(_0x42a3ce[0x0]['language']==_0x47ce5a(0x109))var _0x2873c2=users[_0x47ce5a(0x109)];else{if(_0x42a3ce[0x0][_0x47ce5a(0x16a)]=='Arabic\x20(ae)')var _0x2873c2=users['Arabic'];}}}}}}}_0x5b7676[_0x47ce5a(0xfc)](_0x47ce5a(0x149),{'success':_0x2c6be8['flash'](_0x47ce5a(0x11a)),'errors':_0x2c6be8['flash'](_0x47ce5a(0x182)),'role':_0x469e54,'profile':_0x913e03,'warehouse':_0x227a43,'product':_0x191a46,'adjustment':_0x5d34b5,'master_shop':_0x42a3ce,'language':_0x2873c2});}catch(_0x1436ef){console['log'](_0x1436ef);}});async function getRandom8DigitNumber(){var _0x249549=a0_0x5a8988;const _0x39fa67=0x989680,_0x2b0fb3=0x5f5e0ff,_0x3bcc93=Math[_0x249549(0x199)](Math[_0x249549(0xf7)]()*(_0x2b0fb3-_0x39fa67+0x1))+_0x39fa67;var _0x75d860;const _0x4c2df5=await adjustment_finished['findOne']({'invoice':_0x249549(0x130)+_0x3bcc93});return _0x4c2df5&&_0x4c2df5[_0x249549(0x14a)]>0x0?_0x75d860=_0x249549(0x130)+_0x3bcc93:_0x75d860=_0x249549(0x130)+_0x3bcc93,_0x75d860;}router[a0_0x5a8988(0x187)]('/view/add_adjustment',auth,async(_0x2a8145,_0x320c16)=>{var _0x555e62=a0_0x5a8988;try{const {username:_0x37b897,email:_0x65c816,role:_0x37739f}=_0x2a8145[_0x555e62(0x154)],_0x32c936=_0x2a8145[_0x555e62(0x154)],_0x2076a2=await profile['findOne']({'email':_0x32c936[_0x555e62(0xf5)]}),_0xffdd01=await master_shop[_0x555e62(0x1a7)]();let _0x25d816;if(_0x32c936[_0x555e62(0x14f)]==_0x555e62(0x1aa)){const _0x54af59=await staff[_0x555e62(0x101)]({'email':_0x32c936[_0x555e62(0xf5)]});_0x25d816=await warehouse[_0x555e62(0x18f)]([{'$match':{'status':'Enabled','name':_0x54af59[_0x555e62(0x134)],'warehouse_category':_0x555e62(0x12d),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':_0x555e62(0x19d)}}}]);}else _0x25d816=await warehouse[_0x555e62(0x18f)]([{'$match':{'status':'Enabled','warehouse_category':_0x555e62(0x12d),'name':{'$ne':_0x555e62(0x1ae)}}},{'$group':{'_id':'$name','name':{'$first':_0x555e62(0x19d)}}}]);const _0x489371=await product[_0x555e62(0x1a7)]({}),_0x30fa9b=await adjustment_finished['find']({}),_0x177328=_0x30fa9b[_0x555e62(0x14a)]+0x1,_0x242099=_0x555e62(0x130)+_0x177328[_0x555e62(0x121)]()['padStart'](0x5,'0');var _0xc1ba8f=[_0x555e62(0x13f),'Enclosed',_0x555e62(0x15d)];if(_0xffdd01[0x0][_0x555e62(0x16a)]=='English\x20(US)')var _0x56060b=users['English'];else{if(_0xffdd01[0x0][_0x555e62(0x16a)]=='Hindi')var _0x56060b=users['Hindi'];else{if(_0xffdd01[0x0]['language']==_0x555e62(0x19a))var _0x56060b=users[_0x555e62(0x19a)];else{if(_0xffdd01[0x0][_0x555e62(0x16a)]==_0x555e62(0x14d))var _0x56060b=users[_0x555e62(0x14d)];else{if(_0xffdd01[0x0]['language']==_0x555e62(0xfd))var _0x56060b=users[_0x555e62(0xfd)];else{if(_0xffdd01[0x0][_0x555e62(0x16a)]==_0x555e62(0x113))var _0x56060b=users[_0x555e62(0xf9)];else{if(_0xffdd01[0x0][_0x555e62(0x16a)]=='Chinese')var _0x56060b=users[_0x555e62(0x109)];else{if(_0xffdd01[0x0][_0x555e62(0x16a)]=='Arabic\x20(ae)')var _0x56060b=users[_0x555e62(0x123)];}}}}}}}const _0x5a08d0=getRandom8DigitNumber();_0x5a08d0['then'](_0x549d3b=>{var _0x326343=_0x555e62;_0x320c16[_0x326343(0xfc)](_0x326343(0x1a4),{'success':_0x2a8145['flash'](_0x326343(0x11a)),'errors':_0x2a8145[_0x326343(0x152)](_0x326343(0x182)),'role':_0x32c936,'profile':_0x2076a2,'warehouse':_0x25d816,'product':_0x489371,'master_shop':_0xffdd01,'language':_0x56060b,'rooms_data':_0xc1ba8f,'invoice_no':_0x549d3b});})[_0x555e62(0x162)](_0x4150a0=>{var _0x402993=_0x555e62;_0x2a8145[_0x402993(0x152)](_0x402993(0x182),_0x402993(0x19c)),_0x320c16[_0x402993(0x106)]('/adjustment/view');});}catch(_0x2e2772){console[_0x555e62(0xf8)](_0x2e2772);}}),router['post'](a0_0x5a8988(0x102),auth,async(_0x4ed77f,_0x35b1e3)=>{var _0x20eda7=a0_0x5a8988;try{const {warehouse_name:_0x29e3dc,date:_0x533207,prod_name:_0x594fae,level:_0x3bf288,isle:_0x4264b4,pallet:_0x217141,stock:_0x1a904b,types:_0x3234b7,adjust_qty:_0x2ed322,new_adjust_qty:_0x33e658,note:_0xa2b1d7,Room_name:_0x5a121b,invoice:_0x3dc71d,JO_number:_0x114587,expiry_date:_0x5b775e}=_0x4ed77f[_0x20eda7(0x11c)];if(typeof _0x594fae=='string')var _0x493bcd=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x1a6)]],_0x14172b=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x10a)]],_0x3cfade=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x174)]],_0x44af66=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x17c)]],_0x27a02e=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x18b)]],_0x137100=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x173)]],_0x218ebd=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x104)]],_0x1753b8=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0xef)]],_0x2f66e3=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x10f)]],_0x401107=[_0x4ed77f[_0x20eda7(0x11c)]['batch_code']],_0xa4adb9=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x112)]],_0x3ffcd2=[_0x4ed77f['body'][_0x20eda7(0x167)]],_0x46764f=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x116)]],_0x5e5f51=[_0x4ed77f['body'][_0x20eda7(0x1a9)]],_0x29605b=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x126)]],_0x3858d1=[_0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x163)]];else var _0x493bcd=[..._0x4ed77f['body'][_0x20eda7(0x1a6)]],_0x14172b=[..._0x4ed77f[_0x20eda7(0x11c)]['level']],_0x3cfade=[..._0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x174)]],_0x44af66=[..._0x4ed77f['body'][_0x20eda7(0x17c)]],_0x27a02e=[..._0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x18b)]],_0x137100=[..._0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x173)]],_0x218ebd=[..._0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x104)]],_0x1753b8=[..._0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0xef)]],_0x2f66e3=[..._0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x10f)]],_0x401107=[..._0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x114)]],_0xa4adb9=[..._0x4ed77f[_0x20eda7(0x11c)]['expiry_date']],_0x3ffcd2=[..._0x4ed77f['body']['product_date']],_0x46764f=[..._0x4ed77f[_0x20eda7(0x11c)]['prod_cat']],_0x5e5f51=[..._0x4ed77f['body']['Rooms']],_0x29605b=[..._0x4ed77f[_0x20eda7(0x11c)]['maxPerUnit']],_0x3858d1=[..._0x4ed77f[_0x20eda7(0x11c)][_0x20eda7(0x163)]];const _0x2fa8d9=_0x493bcd[_0x20eda7(0x166)](_0x57a0d8=>{return _0x57a0d8={'product_name':_0x57a0d8};});_0x14172b[_0x20eda7(0x10e)]((_0x3d685c,_0x3e8b03)=>{_0x2fa8d9[_0x3e8b03]['bay']=_0x3d685c;}),_0x3cfade[_0x20eda7(0x10e)]((_0x24830f,_0x20cc2b)=>{var _0xb01ae0=_0x20eda7;_0x2fa8d9[_0x20cc2b][_0xb01ae0(0x192)]=_0x24830f;}),_0x44af66[_0x20eda7(0x10e)]((_0xc1fa23,_0x30d104)=>{var _0x4b2319=_0x20eda7;_0x2fa8d9[_0x30d104][_0x4b2319(0x17c)]=_0xc1fa23;}),_0x27a02e[_0x20eda7(0x10e)]((_0x3a2d70,_0x1d9ee4)=>{var _0x302ab1=_0x20eda7;_0x2fa8d9[_0x1d9ee4][_0x302ab1(0x17d)]=_0x3a2d70;}),_0x137100[_0x20eda7(0x10e)]((_0x36615,_0x28d6b1)=>{_0x2fa8d9[_0x28d6b1]['new_adjust_qty']=_0x36615;}),_0x218ebd[_0x20eda7(0x10e)]((_0x53b6ce,_0x3aa392)=>{_0x2fa8d9[_0x3aa392]['unit']=_0x53b6ce;}),_0x1753b8[_0x20eda7(0x10e)]((_0x4b08d9,_0x463e0c)=>{var _0x2bb8d8=_0x20eda7;_0x2fa8d9[_0x463e0c][_0x2bb8d8(0x18c)]=_0x4b08d9;}),_0x2f66e3[_0x20eda7(0x10e)]((_0xe8cd7a,_0x4f0c26)=>{_0x2fa8d9[_0x4f0c26]['product_code']=_0xe8cd7a;}),_0x401107[_0x20eda7(0x10e)]((_0x45802f,_0x50127e)=>{_0x2fa8d9[_0x50127e]['batch_code']=_0x45802f;}),_0xa4adb9[_0x20eda7(0x10e)]((_0x5b39bb,_0x4cc76b)=>{var _0x2883b3=_0x20eda7;_0x2fa8d9[_0x4cc76b][_0x2883b3(0x112)]=_0x5b39bb;}),_0x3ffcd2[_0x20eda7(0x10e)]((_0x2b57c5,_0x580550)=>{var _0x5af47c=_0x20eda7;_0x2fa8d9[_0x580550][_0x5af47c(0x117)]=_0x2b57c5;}),_0x46764f[_0x20eda7(0x10e)]((_0x4cb758,_0x33a70f)=>{var _0x4ac34b=_0x20eda7;_0x2fa8d9[_0x33a70f][_0x4ac34b(0x116)]=_0x4cb758;}),_0x5e5f51['forEach']((_0x25811d,_0x6fb21d)=>{var _0x306cd3=_0x20eda7;_0x2fa8d9[_0x6fb21d][_0x306cd3(0xf2)]=_0x25811d;}),_0x29605b['forEach']((_0x5e1edd,_0x21def8)=>{var _0x2cc9c4=_0x20eda7;_0x2fa8d9[_0x21def8][_0x2cc9c4(0x126)]=_0x5e1edd;}),_0x3858d1[_0x20eda7(0x10e)]((_0x53612c,_0x531b17)=>{var _0x5da886=_0x20eda7;_0x2fa8d9[_0x531b17][_0x5da886(0x16d)]=_0x53612c;});const _0x3f2f5a=_0x2fa8d9[_0x20eda7(0x14e)](_0x21d7bf=>_0x21d7bf[_0x20eda7(0x17d)]!=='0'&&_0x21d7bf[_0x20eda7(0x17d)]!=='');var _0x57ed24=0x0;_0x3f2f5a['forEach'](_0x31dec5=>{var _0x34be63=_0x20eda7;console[_0x34be63(0xf8)](_0x34be63(0x13e),_0x31dec5),parseInt(_0x31dec5[_0x34be63(0x17d)])<=0x0&&_0x57ed24++;});if(_0x57ed24!=0x0)return _0x4ed77f[_0x20eda7(0x152)](_0x20eda7(0x182),_0x20eda7(0x110)),_0x35b1e3[_0x20eda7(0x106)](_0x20eda7(0x1a3));const _0x53b115=new adjustment_finished({'warehouse_name':_0x29e3dc,'date':_0x533207,'product':_0x3f2f5a,'note':_0xa2b1d7,'room':_0x5a121b,'invoice':_0x3dc71d,'JO_number':_0x114587,'expiry_date':_0x5b775e}),_0x50bb7d=await _0x53b115[_0x20eda7(0x156)]();_0x4ed77f[_0x20eda7(0x152)]('success',_0x20eda7(0x115)),_0x35b1e3[_0x20eda7(0x106)](_0x20eda7(0x188)+_0x50bb7d['_id']);}catch(_0x187e0e){console[_0x20eda7(0xf8)](_0x187e0e),_0x35b1e3[_0x20eda7(0x10b)](0xc8)['json']({'message':_0x187e0e[_0x20eda7(0x147)]});}}),router['get']('/preview/:id',auth,async(_0x5327e2,_0x437a32)=>{var _0x16f1a3=a0_0x5a8988;try{const {username:_0x169b14,email:_0x49ff7f,role:_0x2acd1d}=_0x5327e2[_0x16f1a3(0x154)],_0x492646=_0x5327e2[_0x16f1a3(0x154)],_0x59a860=await profile[_0x16f1a3(0x101)]({'email':_0x492646[_0x16f1a3(0xf5)]}),_0xf44333=await master_shop['find'](),_0x47e3ce=_0x5327e2[_0x16f1a3(0xfe)]['id'],_0x2dc5bb=await adjustment_finished[_0x16f1a3(0x103)]({'_id':_0x47e3ce}),_0x1fa112=await purchases[_0x16f1a3(0x18f)]([{'$match':{'warehouse_name':_0x2dc5bb[_0x16f1a3(0x159)]}},{'$unwind':_0x16f1a3(0x178)},{'$group':{'_id':_0x16f1a3(0x133)}}]);console[_0x16f1a3(0xf8)](_0x16f1a3(0x138),_0x1fa112);const _0x41b67f=await product[_0x16f1a3(0x1a7)]({}),_0x10b1f4=await warehouse['aggregate']([{'$match':{'name':_0x2dc5bb['warehouse_name'],'warehouse_category':'Finished\x20Goods'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x16f1a3(0x16c),'name':{'$first':_0x16f1a3(0x131)},'product_stock':{'$first':_0x16f1a3(0x12b)},'bay':{'$first':_0x16f1a3(0x1b3)},'bin':{'$first':_0x16f1a3(0x11e)},'type':{'$first':_0x16f1a3(0x157)},'floorlevel':{'$first':_0x16f1a3(0x160)},'primary_code':{'$first':_0x16f1a3(0xf0)},'secondary_code':{'$first':_0x16f1a3(0x15e)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x16f1a3(0x10c)},'expiry_date':{'$first':_0x16f1a3(0x151)},'production_date':{'$first':_0x16f1a3(0x12c)},'batch_code':{'$first':_0x16f1a3(0x132)},'maxPerUnit':{'$first':_0x16f1a3(0x1b4)},'room':{'$first':_0x16f1a3(0x184)}}}]);if(_0xf44333[0x0]['language']==_0x16f1a3(0x197)){var _0x3c7688=users['English'];console[_0x16f1a3(0xf8)](_0x3c7688);}else{if(_0xf44333[0x0]['language']==_0x16f1a3(0x15f))var _0x3c7688=users[_0x16f1a3(0x15f)];else{if(_0xf44333[0x0][_0x16f1a3(0x16a)]==_0x16f1a3(0x19a))var _0x3c7688=users['German'];else{if(_0xf44333[0x0][_0x16f1a3(0x16a)]==_0x16f1a3(0x14d))var _0x3c7688=users[_0x16f1a3(0x14d)];else{if(_0xf44333[0x0][_0x16f1a3(0x16a)]==_0x16f1a3(0xfd))var _0x3c7688=users[_0x16f1a3(0xfd)];else{if(_0xf44333[0x0][_0x16f1a3(0x16a)]==_0x16f1a3(0x113))var _0x3c7688=users[_0x16f1a3(0xf9)];else{if(_0xf44333[0x0]['language']==_0x16f1a3(0x109))var _0x3c7688=users[_0x16f1a3(0x109)];else{if(_0xf44333[0x0][_0x16f1a3(0x16a)]==_0x16f1a3(0x19b))var _0x3c7688=users['Arabic'];}}}}}}}_0x437a32[_0x16f1a3(0xfc)]('edit_adjustment_finished_view',{'success':_0x5327e2[_0x16f1a3(0x152)](_0x16f1a3(0x11a)),'errors':_0x5327e2[_0x16f1a3(0x152)]('errors'),'role':_0x492646,'profile':_0x59a860,'adjustment':_0x2dc5bb,'stock':_0x10b1f4,'master_shop':_0xf44333,'warehouse_name':_0x1fa112,'unit':_0x41b67f,'language':_0x3c7688});}catch(_0x525731){console[_0x16f1a3(0xf8)](_0x525731),_0x437a32['status'](0xc8)[_0x16f1a3(0x185)]({'message':_0x525731[_0x16f1a3(0x147)]});}}),router[a0_0x5a8988(0x179)]('/preview/:id',auth,async(_0x1021d5,_0x4a61ac)=>{var _0x488d86=a0_0x5a8988;try{const {invoice:_0x2207b1,warehouse_name:_0x3739bb,Room_name:_0x28c508}=_0x1021d5[_0x488d86(0x11c)],_0x3a301d=_0x1021d5['params']['id'],_0x4867de=await adjustment_finished[_0x488d86(0x103)]({'_id':_0x3a301d});var _0x4e5c3a;const _0x1d812e=_0x4867de[_0x488d86(0x15c)]['map'](async _0x1b64c2=>{var _0x2b7b02=_0x488d86;if(_0x1b64c2[_0x2b7b02(0x17d)]>0x0){_0x4e5c3a=await warehouse[_0x2b7b02(0x101)]({'name':_0x3739bb,'room':_0x1b64c2[_0x2b7b02(0xf2)],'warehouse_category':'Finished\x20Goods'});const _0x10b6e8=_0x4e5c3a['product_details'][_0x2b7b02(0x166)](_0x1159a5=>{var _0x225c91=_0x2b7b02;console[_0x225c91(0xf8)](_0x1b64c2[_0x225c91(0x17c)]);if(_0x1b64c2[_0x225c91(0x17c)]=='minus')_0x1159a5[_0x225c91(0x11b)]==_0x1b64c2['product_name']&&_0x1159a5[_0x225c91(0x1a8)]==_0x1b64c2['bay']&&_0x1159a5['expiry_date']==_0x1b64c2[_0x225c91(0x112)]&&_0x1159a5[_0x225c91(0x117)]==_0x1b64c2[_0x225c91(0x117)]&&_0x1159a5[_0x225c91(0x114)]==_0x1b64c2[_0x225c91(0x114)]&&_0x1159a5['invoice']==_0x1b64c2[_0x225c91(0x16d)]&&(_0x1159a5[_0x225c91(0x146)]=_0x1159a5[_0x225c91(0x146)]-_0x1b64c2[_0x225c91(0x17d)]);else _0x1b64c2['types']==_0x225c91(0x13b)&&(_0x1159a5['product_name']==_0x1b64c2[_0x225c91(0x11b)]&&_0x1159a5['bay']==_0x1b64c2[_0x225c91(0x1a8)]&&_0x1159a5[_0x225c91(0x112)]==_0x1b64c2[_0x225c91(0x112)]&&_0x1159a5[_0x225c91(0x117)]==_0x1b64c2[_0x225c91(0x117)]&&_0x1159a5[_0x225c91(0x114)]==_0x1b64c2[_0x225c91(0x114)]&&_0x1159a5[_0x225c91(0x16d)]==_0x1b64c2[_0x225c91(0x16d)]&&(_0x1159a5[_0x225c91(0x146)]=_0x1159a5[_0x225c91(0x146)]+_0x1b64c2['adjust_qty']));});}return _0x4e5c3a;});Promise[_0x488d86(0x196)](_0x1d812e)[_0x488d86(0x13c)](async _0xdae2c6=>{var _0x37b6b4=_0x488d86;try{for(const _0x4d1830 of _0xdae2c6){await _0x4d1830[_0x37b6b4(0x156)]();}_0x4867de['finalize']='True';const _0x191217=await _0x4867de[_0x37b6b4(0x156)](),_0x4c9de1=await master_shop[_0x37b6b4(0x1a7)](),_0x1f572a=await email_settings[_0x37b6b4(0x101)](),_0x3579d1=await supervisor_settings[_0x37b6b4(0x1a7)]();var _0x136761=_0x4867de[_0x37b6b4(0x15c)],_0x568830='',_0x5e0a80;for(_0x5e0a80 in _0x136761){var _0x1ab3a0='FG';_0x4867de[_0x37b6b4(0x159)]==_0x37b6b4(0x12f)&&(_0x1ab3a0='DG'),_0x568830+=_0x37b6b4(0xff)+_0x37b6b4(0x181)+_0x136761[_0x5e0a80][_0x37b6b4(0x11b)]+_0x37b6b4(0x148)+_0x37b6b4(0x181)+_0x136761[_0x5e0a80][_0x37b6b4(0x119)]+_0x37b6b4(0x148)+_0x37b6b4(0x181)+_0x136761[_0x5e0a80][_0x37b6b4(0x17d)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x136761[_0x5e0a80][_0x37b6b4(0x189)]+_0x37b6b4(0x148)+_0x37b6b4(0x181)+_0x136761[_0x5e0a80][_0x37b6b4(0x18c)]+_0x37b6b4(0x148)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4867de[_0x37b6b4(0x159)]+_0x37b6b4(0x148)+_0x37b6b4(0x181)+_0x136761[_0x5e0a80][_0x37b6b4(0xf2)]+_0x37b6b4(0x148)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1ab3a0+_0x136761[_0x5e0a80][_0x37b6b4(0x1a8)]+_0x37b6b4(0x148)+_0x37b6b4(0xfa);}let _0x5314b2=nodemailer[_0x37b6b4(0x194)]({'host':_0x1f572a[_0x37b6b4(0x120)],'port':Number(_0x1f572a[_0x37b6b4(0x19f)]),'secure':![],'auth':{'user':_0x1f572a[_0x37b6b4(0xf5)],'pass':_0x1f572a[_0x37b6b4(0x172)]}}),_0x178f0e={'from':_0x1f572a[_0x37b6b4(0xf5)],'to':_0x3579d1[0x0][_0x37b6b4(0x180)],'subject':_0x37b6b4(0x1a0),'attachments':[{'filename':'Logo.png','path':__dirname+_0x37b6b4(0x17b)+_0x37b6b4(0x150)+_0x4c9de1[0x0][_0x37b6b4(0x105)],'cid':'logo'}],'html':_0x37b6b4(0x118)+_0x37b6b4(0x143)+'</head><body>'+_0x37b6b4(0x18a)+_0x37b6b4(0x1af)+_0x37b6b4(0x18a)+_0x37b6b4(0x170)+_0x37b6b4(0x19e)+_0x37b6b4(0x18a)+_0x37b6b4(0x11d)+_0x4c9de1[0x0][_0x37b6b4(0x1b5)]+_0x37b6b4(0x191)+_0x37b6b4(0x19e)+'</div>'+_0x37b6b4(0x13d)+_0x37b6b4(0x18a)+_0x37b6b4(0xf6)+'\x20Order\x20Number\x20:\x20'+_0x4867de[_0x37b6b4(0x16d)]+'\x20'+_0x37b6b4(0x1ab)+_0x37b6b4(0x137)+_0x4867de[_0x37b6b4(0x12a)]+'\x20'+_0x37b6b4(0x1b0)+_0x37b6b4(0x168)+'</div>'+_0x37b6b4(0x1a5)+_0x37b6b4(0x164)+'<tr>'+_0x37b6b4(0x176)+_0x37b6b4(0x169)+_0x37b6b4(0x186)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x37b6b4(0x17e)+_0x37b6b4(0x183)+_0x37b6b4(0xf4)+_0x37b6b4(0x15a)+_0x37b6b4(0xfa)+'</thead>'+_0x37b6b4(0x10d)+'\x20'+_0x568830+'\x20'+'</tbody>'+'</table>'+_0x37b6b4(0x18a)+'<strong>\x20Regards\x20</strong>'+_0x37b6b4(0x165)+_0x4c9de1[0x0][_0x37b6b4(0x1b5)]+_0x37b6b4(0x168)+_0x37b6b4(0x19e)+_0x37b6b4(0x19e)+_0x37b6b4(0x1ac)};_0x5314b2[_0x37b6b4(0x190)](_0x178f0e,function(_0x3a7eb5,_0x1dab08){var _0x1906f5=_0x37b6b4;_0x3a7eb5?(console[_0x1906f5(0xf8)](_0x3a7eb5),console[_0x1906f5(0xf8)]('Error\x20Occurs')):console[_0x1906f5(0xf8)]('Email\x20sent\x20successfully');}),_0x1021d5[_0x37b6b4(0x152)](_0x37b6b4(0x11a),_0x37b6b4(0x17a)),_0x4a61ac['redirect']('/picking_list/PDF_adjustment/'+_0x191217[_0x37b6b4(0x198)]);}catch(_0x1923f5){console[_0x37b6b4(0x153)](_0x1923f5),_0x4a61ac[_0x37b6b4(0x10b)](0x1f4)[_0x37b6b4(0x185)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x488d86(0x162)](_0x47e4a5=>{var _0x3a747c=_0x488d86;console['error'](_0x47e4a5),_0x4a61ac[_0x3a747c(0x10b)](0x1f4)['json']({'error':_0x3a747c(0x155)});});}catch(_0x3ed2cd){_0x4a61ac[_0x488d86(0x185)]({'message':_0x3ed2cd['message']});}}),router[a0_0x5a8988(0x187)](a0_0x5a8988(0x1ad),auth,async(_0x687852,_0x15b5c6)=>{var _0x451288=a0_0x5a8988;try{const {username:_0x5b5cf9,email:_0x3011dd,role:_0x5b157e}=_0x687852[_0x451288(0x154)],_0x143915=_0x687852['user'],_0x11f108=await profile[_0x451288(0x101)]({'email':_0x143915['email']}),_0xedb639=await master_shop[_0x451288(0x1a7)]();console[_0x451288(0xf8)]('master',_0xedb639);const _0x40e86d=_0x687852[_0x451288(0xfe)]['id'],_0x3cf270=await adjustment_finished[_0x451288(0x103)]({'_id':_0x40e86d});let _0x27dfa1=new Date(_0x3cf270[_0x451288(0x112)]),_0x861232=('0'+_0x27dfa1[_0x451288(0x193)]())[_0x451288(0x107)](-0x2),_0x2ed206=('0'+(_0x27dfa1[_0x451288(0x136)]()+0x1))[_0x451288(0x107)](-0x2),_0x3da398=_0x27dfa1['getFullYear'](),_0x204cdf=_0x3da398+'-'+_0x2ed206+'-'+_0x861232;var _0x4c3f3f=[_0x451288(0x13f),_0x451288(0x144),'Return\x20Rooms'];const _0x3a15f5=await purchases[_0x451288(0x18f)]([{'$match':{'warehouse_name':_0x3cf270[_0x451288(0x159)]}},{'$unwind':_0x451288(0x178)},{'$group':{'_id':_0x451288(0x133)}}]);console[_0x451288(0xf8)](_0x451288(0x138),_0x3a15f5);const _0x15b8cd=await product['find']({}),_0x18998d=await warehouse[_0x451288(0x18f)]([{'$match':{'name':_0x3cf270[_0x451288(0x159)],'room':_0x3cf270[_0x451288(0x175)]}},{'$unwind':_0x451288(0x1a2)},{'$group':{'_id':_0x451288(0x16c),'name':{'$first':_0x451288(0x131)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x451288(0x1b3)},'bin':{'$first':_0x451288(0x11e)},'type':{'$first':_0x451288(0x157)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x451288(0xf0)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x451288(0x124)},'rack':{'$first':'$product_details.rack'}}}]);if(_0xedb639[0x0][_0x451288(0x16a)]==_0x451288(0x197)){var _0x2dfdca=users[_0x451288(0x17f)];console[_0x451288(0xf8)](_0x2dfdca);}else{if(_0xedb639[0x0][_0x451288(0x16a)]=='Hindi')var _0x2dfdca=users[_0x451288(0x15f)];else{if(_0xedb639[0x0][_0x451288(0x16a)]==_0x451288(0x19a))var _0x2dfdca=users[_0x451288(0x19a)];else{if(_0xedb639[0x0]['language']==_0x451288(0x14d))var _0x2dfdca=users['Spanish'];else{if(_0xedb639[0x0][_0x451288(0x16a)]==_0x451288(0xfd))var _0x2dfdca=users[_0x451288(0xfd)];else{if(_0xedb639[0x0][_0x451288(0x16a)]=='Portuguese\x20(BR)')var _0x2dfdca=users['Portuguese'];else{if(_0xedb639[0x0][_0x451288(0x16a)]=='Chinese')var _0x2dfdca=users[_0x451288(0x109)];else{if(_0xedb639[0x0][_0x451288(0x16a)]==_0x451288(0x19b))var _0x2dfdca=users[_0x451288(0x123)];}}}}}}}_0x15b5c6['render']('edit_adjustment_finished',{'success':_0x687852[_0x451288(0x152)]('success'),'errors':_0x687852[_0x451288(0x152)]('errors'),'role':_0x143915,'profile':_0x11f108,'adjustment':_0x3cf270,'stock':_0x18998d,'master_shop':_0xedb639,'warehouse_name':_0x3a15f5,'unit':_0x15b8cd,'language':_0x2dfdca,'rooms_data':_0x4c3f3f,'ed_fullDate':_0x204cdf});}catch(_0x21d5f4){console['log'](_0x21d5f4),_0x15b5c6[_0x451288(0x10b)](0xc8)['json']({'message':_0x21d5f4['message']});}}),router[a0_0x5a8988(0x179)](a0_0x5a8988(0x1ad),auth,async(_0x29468f,_0x18135e)=>{var _0x4adf2d=a0_0x5a8988;try{const _0x369d30=_0x29468f[_0x4adf2d(0xfe)]['id'],_0x3ad0fb=await adjustment_finished[_0x4adf2d(0x103)]({'_id':_0x369d30}),_0xa99e81=await warehouse[_0x4adf2d(0x101)]({'name':_0x3ad0fb['warehouse_name'],'room':_0x3ad0fb[_0x4adf2d(0x175)]}),{warehouse_name:_0x2775af,date:_0xfa8628,prod_name:_0x4122db,level:_0x352eee,isle:_0x2d7fcb,pallet:_0x3e99ba,stock:_0x500324,types:_0x1b47f0,adjust_qty:_0x943b01,new_adjust_qty:_0x190ae5,note:_0x8cf7ef,Room_name:_0x4f8813,invoice:_0x3fe86c,JO_number:_0x4e29b0}=_0x29468f[_0x4adf2d(0x11c)];if(typeof _0x4122db==_0x4adf2d(0x141))var _0x53edd7=[_0x29468f[_0x4adf2d(0x11c)]['prod_name']],_0x5e728c=[_0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x10a)]],_0x5a5010=[_0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x174)]],_0x55062f=[_0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x17c)]],_0x19acd5=[_0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x17d)]],_0x31f276=[_0x29468f[_0x4adf2d(0x11c)]['new_adjust_qty']],_0x384f59=[_0x29468f[_0x4adf2d(0x11c)]['prod_code']],_0x3d0bf0=[_0x29468f['body']['unit']],_0x8c5c3a=[_0x29468f['body'][_0x4adf2d(0xef)]],_0x582b8b=[_0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x114)]],_0x3e0320=[_0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x112)]];else var _0x53edd7=[..._0x29468f[_0x4adf2d(0x11c)]['prod_name']],_0x5e728c=[..._0x29468f[_0x4adf2d(0x11c)]['level']],_0x5a5010=[..._0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x174)]],_0x55062f=[..._0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x17c)]],_0x19acd5=[..._0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x17d)]],_0x31f276=[..._0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x16b)]],_0x384f59=[..._0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x10f)]],_0x3d0bf0=[..._0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x189)]],_0x8c5c3a=[..._0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0xef)]],_0x582b8b=[..._0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x114)]],_0x3e0320=[..._0x29468f[_0x4adf2d(0x11c)][_0x4adf2d(0x112)]];const _0x32f633=_0x53edd7[_0x4adf2d(0x166)](_0x4917c5=>{return _0x4917c5={'product_name':_0x4917c5};});_0x5e728c[_0x4adf2d(0x10e)]((_0x4eaac7,_0x50131b)=>{var _0x195bac=_0x4adf2d;_0x32f633[_0x50131b][_0x195bac(0x1a8)]=_0x4eaac7;}),_0x5a5010[_0x4adf2d(0x10e)]((_0x23d25e,_0x28244e)=>{var _0x7ff1df=_0x4adf2d;_0x32f633[_0x28244e][_0x7ff1df(0x192)]=_0x23d25e;}),_0x55062f[_0x4adf2d(0x10e)]((_0x2175f2,_0x27197a)=>{_0x32f633[_0x27197a]['types']=_0x2175f2;}),_0x19acd5[_0x4adf2d(0x10e)]((_0x19c04a,_0x44df54)=>{var _0x25c803=_0x4adf2d;_0x32f633[_0x44df54][_0x25c803(0x17d)]=_0x19c04a;}),_0x31f276[_0x4adf2d(0x10e)]((_0x3d6d99,_0x32d77b)=>{_0x32f633[_0x32d77b]['new_adjust_qty']=_0x3d6d99;}),_0x3d0bf0[_0x4adf2d(0x10e)]((_0x7f06b9,_0x268f36)=>{_0x32f633[_0x268f36]['unit']=_0x7f06b9;}),_0x8c5c3a[_0x4adf2d(0x10e)]((_0x82deed,_0x2bec07)=>{_0x32f633[_0x2bec07]['secondary_unit']=_0x82deed;}),_0x384f59[_0x4adf2d(0x10e)]((_0x27b48f,_0x3932f3)=>{var _0x3c5026=_0x4adf2d;_0x32f633[_0x3932f3][_0x3c5026(0x119)]=_0x27b48f;}),_0x582b8b[_0x4adf2d(0x10e)]((_0x361f3e,_0x3653f0)=>{var _0xf2c9e1=_0x4adf2d;_0x32f633[_0x3653f0][_0xf2c9e1(0x114)]=_0x361f3e;}),_0x3e0320[_0x4adf2d(0x10e)]((_0x318795,_0x5015a3)=>{var _0x292862=_0x4adf2d;_0x32f633[_0x5015a3][_0x292862(0x112)]=_0x318795;});const _0x4e4b02=_0x32f633[_0x4adf2d(0x14e)](_0x5acdd1=>_0x5acdd1['adjust_qty']!=='0'&&_0x5acdd1[_0x4adf2d(0x17d)]!=='');var _0x22c73f=0x0;_0x4e4b02['forEach'](_0x2193a6=>{var _0x4b58a3=_0x4adf2d;console[_0x4b58a3(0xf8)](_0x4b58a3(0x13e),_0x2193a6),parseInt(_0x2193a6['adjust_qty'])<=0x0&&_0x22c73f++;});if(_0x22c73f!=0x0)return _0x29468f[_0x4adf2d(0x152)](_0x4adf2d(0x182),_0x4adf2d(0x110)),_0x18135e[_0x4adf2d(0x106)](_0x4adf2d(0x1a3));_0x3ad0fb[_0x4adf2d(0x159)]=_0x2775af,_0x3ad0fb['date']=_0xfa8628,_0x3ad0fb[_0x4adf2d(0x15c)]=_0x4e4b02,_0x3ad0fb[_0x4adf2d(0xf3)]=_0x8cf7ef,_0x3ad0fb[_0x4adf2d(0x175)]=_0x4f8813,_0x3ad0fb[_0x4adf2d(0x16d)]=_0x3fe86c,_0x3ad0fb[_0x4adf2d(0x16f)]=_0x4e29b0;const _0x404836=await _0x3ad0fb[_0x4adf2d(0x156)](),_0xdfba97=await warehouse[_0x4adf2d(0x101)]({'name':_0x2775af,'room':_0x4f8813});_0x404836[_0x4adf2d(0x15c)][_0x4adf2d(0x10e)](_0x135206=>{var _0x4e00a1=_0x4adf2d;const _0x52989c=_0xdfba97['product_details'][_0x4e00a1(0x166)](_0x4b9ca2=>{var _0x1339cf=_0x4e00a1;_0x135206[_0x1339cf(0x17c)]==_0x1339cf(0x1b2)?_0x4b9ca2[_0x1339cf(0x11b)]==_0x135206[_0x1339cf(0x11b)]&&_0x4b9ca2['bay']==_0x135206['bay']&&(_0x4b9ca2['product_stock']=parseInt(_0x4b9ca2['product_stock'])-parseInt(_0x135206[_0x1339cf(0x17d)])):_0x4b9ca2['product_name']==_0x135206[_0x1339cf(0x11b)]&&_0x4b9ca2[_0x1339cf(0x1a8)]==_0x135206[_0x1339cf(0x1a8)]&&(_0x4b9ca2[_0x1339cf(0x146)]=parseInt(_0x4b9ca2[_0x1339cf(0x146)])+parseInt(_0x135206['adjust_qty']));});}),await _0xdfba97[_0x4adf2d(0x156)](),_0x29468f['flash'](_0x4adf2d(0x11a),_0x4adf2d(0x11f)),_0x18135e[_0x4adf2d(0x106)]('/adjustment_finished/view');}catch(_0x114e91){console[_0x4adf2d(0xf8)](_0x114e91);}}),router[a0_0x5a8988(0x179)](a0_0x5a8988(0x108),async(_0x4f63bd,_0x1a8b05)=>{var _0x530cb0=a0_0x5a8988;const {primary_code:_0x2e7ee7,warehouse_data:_0x4feffb,rooms_data:_0x345750,Roomslist:_0x1b654f}=_0x4f63bd[_0x530cb0(0x11c)],_0x298e2d=_0x1b654f[_0x530cb0(0x1a1)](','),_0x58ae98=[];async function _0x397e09(_0x222e12){var _0x38372d=_0x530cb0;const _0xf74266=await warehouse[_0x38372d(0x18f)]([{'$match':{'name':_0x4feffb,'room':_0x222e12}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x2e7ee7}},{'$group':{'_id':_0x38372d(0x16c),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x38372d(0x12b)},'primary_code':{'$first':_0x38372d(0xf0)},'secondary_code':{'$first':_0x38372d(0x15e)},'product_code':{'$first':_0x38372d(0x18e)},'level':{'$first':_0x38372d(0x1b3)},'isle':{'$first':_0x38372d(0x11e)},'type':{'$first':_0x38372d(0x157)},'pallet':{'$first':_0x38372d(0x160)},'unit':{'$first':_0x38372d(0x12e)},'secondary_unit':{'$first':_0x38372d(0x14c)},'storage':{'$first':_0x38372d(0x124)},'rack':{'$first':_0x38372d(0x10c)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x38372d(0x132)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x38372d(0x184)},'invoice':{'$first':_0x38372d(0x122)}}}]),_0x618de4=await warehouse[_0x38372d(0x18f)]([{'$match':{'name':_0x4feffb,'room':_0x222e12}},{'$unwind':_0x38372d(0x1a2)},{'$match':{'product_details.secondary_code':_0x2e7ee7}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x38372d(0x131)},'product_stock':{'$first':_0x38372d(0x12b)},'primary_code':{'$first':_0x38372d(0xf0)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x38372d(0x18e)},'level':{'$first':_0x38372d(0x1b3)},'isle':{'$first':_0x38372d(0x11e)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x38372d(0x160)},'unit':{'$first':_0x38372d(0x12e)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x38372d(0x124)},'rack':{'$first':_0x38372d(0x10c)},'expiry_date':{'$first':_0x38372d(0x151)},'production_date':{'$first':_0x38372d(0x12c)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x38372d(0x1b4)},'roomNamed':{'$first':_0x38372d(0x184)},'invoice':{'$first':_0x38372d(0x122)}}}]);if(_0xf74266['length']>0x0)_0x58ae98['push'](_0xf74266);else _0x618de4['length']>0x0&&_0x58ae98[_0x38372d(0x14b)](_0x618de4);}const _0xc3d259=_0x298e2d[_0x530cb0(0x166)](_0x4801b7=>_0x397e09(_0x4801b7));await Promise[_0x530cb0(0x196)](_0xc3d259),_0x1a8b05[_0x530cb0(0x185)](_0x58ae98);}),router[a0_0x5a8988(0x179)](a0_0x5a8988(0x161),async(_0x2a85d2,_0x1679a7)=>{var _0x16e636=a0_0x5a8988;const {productCode:_0x567187,bay:_0x26bf1c,warehouses:_0x6c304e,room:_0x2169f0}=_0x2a85d2[_0x16e636(0x11c)];console[_0x16e636(0xf8)](_0x2a85d2['body']);try{const _0x1275c1=await warehouse[_0x16e636(0x18f)]([{'$match':{'name':_0x6c304e,'room':_0x2169f0}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x26bf1c)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x16e636(0x131)},'product_stock':{'$first':_0x16e636(0x12b)},'bay':{'$first':_0x16e636(0x1b3)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x1679a7[_0x16e636(0x10b)](0xc8)[_0x16e636(0x185)](_0x1275c1);}catch(_0x502281){_0x1679a7[_0x16e636(0x10b)](0x194)[_0x16e636(0x185)]({'message':_0x502281['message']});}}),module[a0_0x5a8988(0x129)]=router;