function a0_0x12d3(){var _0x4a3992=['QA\x20Warehouse','DRY\x20GOODS','FGSEmail','<tbody\x20style=\x22text-align:\x20center;\x22>','getFullYear','True','Adjustment\x20Finalize\x20Successfully','Enclosed','adjustment_finished','</head><body>','56gvIznN','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<h2>\x20','/picking_list/PDF_adjustment/','$date','<!DOCTYPE\x20html>','9550630ltKECg','$product_details.secondary_code','/view/:id','Primary_Units','/preview/:id','foreach\x20newproduct','$product_details','$product_details.primary_code','/upload/','maxPerUnit','JO_number','$product_details.storage','prod_name','31545IFuLra','An\x20error\x20occurred.','then','$product_details.secondary_unit','</tbody>','$product_details.bin','$product','3533532CHMJQM','getMonth','json','../middleware/auth','../models/all_models','minus','/adjustment_finished/preview/','get','add_adjustment_finished','$product_details.product_code','findOne','$_id','user','expiry_date','$product_details.maxProducts','English','Portuguese','find','$product_details.maxPerUnit','room','sendMail','Finished\x20Goods','types','</td>','image','level','Hindi','Logo.png','$product_details.production_date','exports','$product_details.product_name','random','port','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','post','prod_cat','render','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','date','password','<html><head><title></title>','<div>','error','status','save','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','adjustment\x20add\x20successfull','</body></html>','redirect','findById','stock','errors','push','Arabic','product_name','$product_details.batch_code','master','$product_details.floorlevel','adjust_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','</table>','$product_details.invoice','all','\x20Order\x20Date\x20:\x20','$product_details.rack','map','site_title','Portuguese\x20(BR)','stockBefore','Chinese','French','prod_code','warehouse','/barcode_scanner','$warehouse_name','product_details','Arabic\x20(ae)','$product.product_name','$product_details._id','prod_invoice','Email\x20sent\x20successfully','express','purchases_data','</tr>','/CheckingWarehouse','$product.room_names','Spanish','Router','$product_details.type','\x20Order\x20Number\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','</span>','Return\x20Rooms','$invoice','params','split','padStart','message','English\x20(US)','3CWmOsq','language','/view/add_adjustment','/adjustment_finished/view','$finalize','$product_details.unit','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','German','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.bay','back','</div>','New_Qty_Converted','product','catch','</h5>','product_code','getDate','9zHdXpO','138774HWTnzx','forEach','length','success','Ambient','</thead>','Enabled','production_date','ADJF-','invoice','finalize','floor','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Secondary_units','logo','aggregate','product_stock','nodemailer','email','Rooms','<h5\x20style=\x22text-align:\x20left;\x22>','string','1696952rrsqWh','new_adjust_qty','\x20</h2>','role','548884tqFgeH','log','bay','createTransport','edit_adjustment_finished','filter','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','Error\x20Occurs','_id','add','unit','$room','flash','<h5>','/../public','body','batch_code','host','1867425mYpSwJ','warehouse_name','secondary_unit','$name','$product_details.product_stock','staff','$product_details.expiry_date','slice','Adjustment\x20Mail'];a0_0x12d3=function(){return _0x4a3992;};return a0_0x12d3();}function a0_0x183f(_0x32fa12,_0x54f115){var _0x12d37a=a0_0x12d3();return a0_0x183f=function(_0x183f47,_0x5c4b42){_0x183f47=_0x183f47-0x1aa;var _0x23f5a4=_0x12d37a[_0x183f47];return _0x23f5a4;},a0_0x183f(_0x32fa12,_0x54f115);}var a0_0x2e4581=a0_0x183f;(function(_0x132df6,_0x52dba2){var _0x8d5c38=a0_0x183f,_0x135614=_0x132df6();while(!![]){try{var _0x248891=-parseInt(_0x8d5c38(0x222))/0x1+parseInt(_0x8d5c38(0x23c))/0x2*(parseInt(_0x8d5c38(0x20e))/0x3)+parseInt(_0x8d5c38(0x261))/0x4*(-parseInt(_0x8d5c38(0x274))/0x5)+-parseInt(_0x8d5c38(0x27b))/0x6+-parseInt(_0x8d5c38(0x24e))/0x7+parseInt(_0x8d5c38(0x238))/0x8+-parseInt(_0x8d5c38(0x221))/0x9*(-parseInt(_0x8d5c38(0x267))/0xa);if(_0x248891===_0x52dba2)break;else _0x135614['push'](_0x135614['shift']());}catch(_0x34c2a0){_0x135614['push'](_0x135614['shift']());}}}(a0_0x12d3,0x579ab));const express=require(a0_0x2e4581(0x1fc)),app=express(),router=express[a0_0x2e4581(0x202)](),auth=require(a0_0x2e4581(0x1ac)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require(a0_0x2e4581(0x1ad)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x2e4581(0x233));router[a0_0x2e4581(0x1b0)]('/view',auth,async(_0x5d6f3d,_0x195cc3)=>{var _0x24a7b3=a0_0x2e4581;try{const {username:_0x21bce9,email:_0x138c76,role:_0x416c29}=_0x5d6f3d[_0x24a7b3(0x1b5)],_0x2dadeb=_0x5d6f3d[_0x24a7b3(0x1b5)],_0x5260eb=await profile[_0x24a7b3(0x1b3)]({'email':_0x2dadeb[_0x24a7b3(0x234)]}),_0x169eff=await master_shop[_0x24a7b3(0x1ba)]();let _0x51fd24;if(_0x2dadeb[_0x24a7b3(0x23b)]=='staff'){const _0x17f1cd=await staff['findOne']({'email':_0x2dadeb['email']});_0x51fd24=await warehouse[_0x24a7b3(0x1ba)]({'status':'Enabled','name':_0x17f1cd['warehouse']});}else _0x51fd24=await warehouse[_0x24a7b3(0x1ba)]({'status':'Enabled'});const _0x2e522f=await product[_0x24a7b3(0x1ba)]();let _0x332ace;if(_0x2dadeb['role']==_0x24a7b3(0x253)){const _0x28359a=await staff[_0x24a7b3(0x1b3)]({'email':_0x2dadeb[_0x24a7b3(0x234)]});_0x332ace=await adjustment_finished['find']({'warehouse_name':_0x28359a['warehouse']});}else _0x332ace=await adjustment_finished[_0x24a7b3(0x231)]([{'$unwind':'$product'},{'$group':{'_id':_0x24a7b3(0x1b4),'invoice':{'$first':_0x24a7b3(0x208)},'date':{'$first':_0x24a7b3(0x265)},'warehouse_name':{'$first':_0x24a7b3(0x1f5)},'room':{'$addToSet':_0x24a7b3(0x200)},'finalize':{'$first':_0x24a7b3(0x212)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x169eff[0x0][_0x24a7b3(0x20f)]==_0x24a7b3(0x20d)){var _0x2c8fa0=users[_0x24a7b3(0x1b8)];console[_0x24a7b3(0x23d)](_0x2c8fa0);}else{if(_0x169eff[0x0][_0x24a7b3(0x20f)]==_0x24a7b3(0x1c3))var _0x2c8fa0=users[_0x24a7b3(0x1c3)];else{if(_0x169eff[0x0][_0x24a7b3(0x20f)]==_0x24a7b3(0x216))var _0x2c8fa0=users[_0x24a7b3(0x216)];else{if(_0x169eff[0x0][_0x24a7b3(0x20f)]==_0x24a7b3(0x201))var _0x2c8fa0=users['Spanish'];else{if(_0x169eff[0x0]['language']==_0x24a7b3(0x1f1))var _0x2c8fa0=users[_0x24a7b3(0x1f1)];else{if(_0x169eff[0x0][_0x24a7b3(0x20f)]==_0x24a7b3(0x1ee))var _0x2c8fa0=users[_0x24a7b3(0x1b9)];else{if(_0x169eff[0x0]['language']==_0x24a7b3(0x1f0))var _0x2c8fa0=users['Chinese'];else{if(_0x169eff[0x0]['language']==_0x24a7b3(0x1f7))var _0x2c8fa0=users['Arabic'];}}}}}}}_0x195cc3[_0x24a7b3(0x1cd)](_0x24a7b3(0x25f),{'success':_0x5d6f3d[_0x24a7b3(0x248)](_0x24a7b3(0x225)),'errors':_0x5d6f3d['flash']('errors'),'role':_0x2dadeb,'profile':_0x5260eb,'warehouse':_0x51fd24,'product':_0x2e522f,'adjustment':_0x332ace,'master_shop':_0x169eff,'language':_0x2c8fa0});}catch(_0x538e4e){console[_0x24a7b3(0x23d)](_0x538e4e);}});async function getRandom8DigitNumber(){var _0x3a5bc8=a0_0x2e4581;const _0x4754e2=0x989680,_0x4ca6a9=0x5f5e0ff,_0x4521db=Math[_0x3a5bc8(0x22d)](Math[_0x3a5bc8(0x1c8)]()*(_0x4ca6a9-_0x4754e2+0x1))+_0x4754e2;var _0x10f73a;const _0x1021b7=await adjustment_finished[_0x3a5bc8(0x1b3)]({'invoice':_0x3a5bc8(0x22a)+_0x4521db});return _0x1021b7&&_0x1021b7['length']>0x0?_0x10f73a=_0x3a5bc8(0x22a)+_0x4521db:_0x10f73a=_0x3a5bc8(0x22a)+_0x4521db,_0x10f73a;}router[a0_0x2e4581(0x1b0)](a0_0x2e4581(0x210),auth,async(_0x53d16c,_0x1e0c95)=>{var _0x1b485b=a0_0x2e4581;try{const {username:_0x5b6073,email:_0x411b0e,role:_0x457075}=_0x53d16c[_0x1b485b(0x1b5)],_0x2f0843=_0x53d16c[_0x1b485b(0x1b5)],_0x48d4d2=await profile[_0x1b485b(0x1b3)]({'email':_0x2f0843[_0x1b485b(0x234)]}),_0x55011c=await master_shop[_0x1b485b(0x1ba)]();let _0x325a13;if(_0x2f0843['role']==_0x1b485b(0x253)){const _0x3718c0=await staff[_0x1b485b(0x1b3)]({'email':_0x2f0843[_0x1b485b(0x234)]});_0x325a13=await warehouse[_0x1b485b(0x231)]([{'$match':{'status':_0x1b485b(0x228),'name':_0x3718c0[_0x1b485b(0x1f3)],'warehouse_category':_0x1b485b(0x1be),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x1b485b(0x251),'name':{'$first':_0x1b485b(0x251)}}}]);}else _0x325a13=await warehouse['aggregate']([{'$match':{'status':_0x1b485b(0x228),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x1b485b(0x257)}}},{'$group':{'_id':'$name','name':{'$first':_0x1b485b(0x251)}}}]);const _0x24b012=await product[_0x1b485b(0x1ba)]({}),_0x45ed42=await adjustment_finished[_0x1b485b(0x1ba)]({}),_0x33f2c0=_0x45ed42[_0x1b485b(0x224)]+0x1,_0x5cbccd='ADJF-'+_0x33f2c0['toString']()[_0x1b485b(0x20b)](0x5,'0');var _0x128a2c=[_0x1b485b(0x226),_0x1b485b(0x25e),'Return\x20Rooms'];if(_0x55011c[0x0][_0x1b485b(0x20f)]==_0x1b485b(0x20d))var _0x460876=users[_0x1b485b(0x1b8)];else{if(_0x55011c[0x0][_0x1b485b(0x20f)]==_0x1b485b(0x1c3))var _0x460876=users[_0x1b485b(0x1c3)];else{if(_0x55011c[0x0][_0x1b485b(0x20f)]==_0x1b485b(0x216))var _0x460876=users['German'];else{if(_0x55011c[0x0][_0x1b485b(0x20f)]==_0x1b485b(0x201))var _0x460876=users[_0x1b485b(0x201)];else{if(_0x55011c[0x0][_0x1b485b(0x20f)]=='French')var _0x460876=users[_0x1b485b(0x1f1)];else{if(_0x55011c[0x0][_0x1b485b(0x20f)]==_0x1b485b(0x1ee))var _0x460876=users[_0x1b485b(0x1b9)];else{if(_0x55011c[0x0][_0x1b485b(0x20f)]==_0x1b485b(0x1f0))var _0x460876=users[_0x1b485b(0x1f0)];else{if(_0x55011c[0x0][_0x1b485b(0x20f)]==_0x1b485b(0x1f7))var _0x460876=users['Arabic'];}}}}}}}const _0x3a67d6=getRandom8DigitNumber();_0x3a67d6[_0x1b485b(0x276)](_0x2c34b6=>{var _0x124ea2=_0x1b485b;_0x1e0c95[_0x124ea2(0x1cd)](_0x124ea2(0x1b1),{'success':_0x53d16c[_0x124ea2(0x248)](_0x124ea2(0x225)),'errors':_0x53d16c['flash']('errors'),'role':_0x2f0843,'profile':_0x48d4d2,'warehouse':_0x325a13,'product':_0x24b012,'master_shop':_0x55011c,'language':_0x460876,'rooms_data':_0x128a2c,'invoice_no':_0x2c34b6});})[_0x1b485b(0x21d)](_0x1e4473=>{var _0x429d30=_0x1b485b;_0x53d16c['flash'](_0x429d30(0x1dd),_0x429d30(0x1cf)),_0x1e0c95[_0x429d30(0x1da)]('/adjustment/view');});}catch(_0x13309d){console[_0x1b485b(0x23d)](_0x13309d);}}),router[a0_0x2e4581(0x1cb)](a0_0x2e4581(0x210),auth,async(_0x3e19b4,_0x2dd376)=>{var _0x99cd7=a0_0x2e4581;try{const {warehouse_name:_0x3732c4,date:_0x31b8f2,prod_name:_0x2fcffc,level:_0x310e6c,isle:_0x69a56c,pallet:_0x1dff3a,stock:_0x41c374,types:_0x1382a2,adjust_qty:_0x3b818b,new_adjust_qty:_0x11f92a,note:_0x50c1dd,Room_name:_0x2b041c,invoice:_0x40808a,JO_number:_0x132434,expiry_date:_0x3ce53f}=_0x3e19b4[_0x99cd7(0x24b)];if(typeof _0x2fcffc=='string')var _0x6bdb79=[_0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x273)]],_0x271574=[_0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x1c2)]],_0x137c13=[_0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x1dc)]],_0x39054a=[_0x3e19b4['body'][_0x99cd7(0x1bf)]],_0x3ae78d=[_0x3e19b4[_0x99cd7(0x24b)]['New_Qty_Converted_adj']],_0x57400a=[_0x3e19b4['body'][_0x99cd7(0x21b)]],_0x287156=[_0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x26a)]],_0x185aaf=[_0x3e19b4[_0x99cd7(0x24b)]['Secondary_units']],_0x4f07f3=[_0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x1f2)]],_0x893ef1=[_0x3e19b4[_0x99cd7(0x24b)]['batch_code']],_0x35c0e5=[_0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x1b6)]],_0x40cf5d=[_0x3e19b4[_0x99cd7(0x24b)]['product_date']],_0x22095b=[_0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x1cc)]],_0x59d11c=[_0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x235)]],_0x27e41e=[_0x3e19b4['body'][_0x99cd7(0x270)]],_0x31b66e=[_0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x1fa)]];else var _0x6bdb79=[..._0x3e19b4['body'][_0x99cd7(0x273)]],_0x271574=[..._0x3e19b4['body'][_0x99cd7(0x1c2)]],_0x137c13=[..._0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x1dc)]],_0x39054a=[..._0x3e19b4['body'][_0x99cd7(0x1bf)]],_0x3ae78d=[..._0x3e19b4[_0x99cd7(0x24b)]['New_Qty_Converted_adj']],_0x57400a=[..._0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x21b)]],_0x287156=[..._0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x26a)]],_0x185aaf=[..._0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x22f)]],_0x4f07f3=[..._0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x1f2)]],_0x893ef1=[..._0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x24c)]],_0x35c0e5=[..._0x3e19b4['body'][_0x99cd7(0x1b6)]],_0x40cf5d=[..._0x3e19b4['body']['product_date']],_0x22095b=[..._0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x1cc)]],_0x59d11c=[..._0x3e19b4['body'][_0x99cd7(0x235)]],_0x27e41e=[..._0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x270)]],_0x31b66e=[..._0x3e19b4[_0x99cd7(0x24b)][_0x99cd7(0x1fa)]];const _0x3630d7=_0x6bdb79[_0x99cd7(0x1ec)](_0x5252ad=>{return _0x5252ad={'product_name':_0x5252ad};});_0x271574['forEach']((_0x4bb34f,_0x439694)=>{var _0x550041=_0x99cd7;_0x3630d7[_0x439694][_0x550041(0x23e)]=_0x4bb34f;}),_0x137c13[_0x99cd7(0x223)]((_0x1c3ac5,_0x25dffa)=>{var _0xd375ce=_0x99cd7;_0x3630d7[_0x25dffa][_0xd375ce(0x1ef)]=_0x1c3ac5;}),_0x39054a[_0x99cd7(0x223)]((_0x2a3ea4,_0x21a4c3)=>{_0x3630d7[_0x21a4c3]['types']=_0x2a3ea4;}),_0x3ae78d[_0x99cd7(0x223)]((_0x100ecd,_0x15a16a)=>{var _0x29f761=_0x99cd7;_0x3630d7[_0x15a16a][_0x29f761(0x1e4)]=_0x100ecd;}),_0x57400a[_0x99cd7(0x223)]((_0x18093a,_0x47813f)=>{var _0x27c233=_0x99cd7;_0x3630d7[_0x47813f][_0x27c233(0x239)]=_0x18093a;}),_0x287156[_0x99cd7(0x223)]((_0x2dab8f,_0x411f48)=>{_0x3630d7[_0x411f48]['unit']=_0x2dab8f;}),_0x185aaf[_0x99cd7(0x223)]((_0x408363,_0x10eca8)=>{var _0x1bf2aa=_0x99cd7;_0x3630d7[_0x10eca8][_0x1bf2aa(0x250)]=_0x408363;}),_0x4f07f3[_0x99cd7(0x223)]((_0x788992,_0x2889da)=>{var _0x433201=_0x99cd7;_0x3630d7[_0x2889da][_0x433201(0x21f)]=_0x788992;}),_0x893ef1['forEach']((_0x4413e5,_0x33e7be)=>{_0x3630d7[_0x33e7be]['batch_code']=_0x4413e5;}),_0x35c0e5[_0x99cd7(0x223)]((_0x226d04,_0x14ebf2)=>{var _0x47cf44=_0x99cd7;_0x3630d7[_0x14ebf2][_0x47cf44(0x1b6)]=_0x226d04;}),_0x40cf5d['forEach']((_0x2ff170,_0x3cf480)=>{_0x3630d7[_0x3cf480]['production_date']=_0x2ff170;}),_0x22095b['forEach']((_0x4ef24f,_0x5be8f7)=>{var _0x1ee181=_0x99cd7;_0x3630d7[_0x5be8f7][_0x1ee181(0x1cc)]=_0x4ef24f;}),_0x59d11c[_0x99cd7(0x223)]((_0x175b5b,_0x1a8737)=>{_0x3630d7[_0x1a8737]['room_names']=_0x175b5b;}),_0x27e41e['forEach']((_0x2af439,_0x356da8)=>{var _0x2e94e3=_0x99cd7;_0x3630d7[_0x356da8][_0x2e94e3(0x270)]=_0x2af439;}),_0x31b66e[_0x99cd7(0x223)]((_0x16c660,_0x512d7a)=>{var _0x572aef=_0x99cd7;_0x3630d7[_0x512d7a][_0x572aef(0x22b)]=_0x16c660;});const _0x37992e=_0x3630d7['filter'](_0x1f6506=>_0x1f6506['adjust_qty']!=='0'&&_0x1f6506[_0x99cd7(0x1e4)]!=='');var _0x2bc9e6=0x0;_0x37992e[_0x99cd7(0x223)](_0xde4a96=>{var _0x5eb2b1=_0x99cd7;console[_0x5eb2b1(0x23d)](_0x5eb2b1(0x26c),_0xde4a96),parseInt(_0xde4a96[_0x5eb2b1(0x1e4)])<=0x0&&_0x2bc9e6++;});if(_0x2bc9e6!=0x0)return _0x3e19b4['flash'](_0x99cd7(0x1dd),_0x99cd7(0x242)),_0x2dd376['redirect'](_0x99cd7(0x219));const _0x9dae99=new adjustment_finished({'warehouse_name':_0x3732c4,'date':_0x31b8f2,'product':_0x37992e,'note':_0x50c1dd,'room':_0x2b041c,'invoice':_0x40808a,'JO_number':_0x132434,'expiry_date':_0x3ce53f}),_0x3f548e=await _0x9dae99['save']();_0x3e19b4[_0x99cd7(0x248)](_0x99cd7(0x225),_0x99cd7(0x1d8)),_0x2dd376[_0x99cd7(0x1da)](_0x99cd7(0x1af)+_0x3f548e[_0x99cd7(0x244)]);}catch(_0x8da8da){console[_0x99cd7(0x23d)](_0x8da8da),_0x2dd376[_0x99cd7(0x1d5)](0xc8)[_0x99cd7(0x1ab)]({'message':_0x8da8da['message']});}}),router[a0_0x2e4581(0x1b0)](a0_0x2e4581(0x26b),auth,async(_0x37a5f6,_0x26a220)=>{var _0x31afd9=a0_0x2e4581;try{const {username:_0x49de11,email:_0x34a644,role:_0x31b8c7}=_0x37a5f6[_0x31afd9(0x1b5)],_0x462ac8=_0x37a5f6['user'],_0x54f72b=await profile[_0x31afd9(0x1b3)]({'email':_0x462ac8['email']}),_0x4b7962=await master_shop['find'](),_0x599882=_0x37a5f6[_0x31afd9(0x209)]['id'],_0x2caa6b=await adjustment_finished[_0x31afd9(0x1db)]({'_id':_0x599882}),_0x648611=await purchases['aggregate']([{'$match':{'warehouse_name':_0x2caa6b[_0x31afd9(0x24f)]}},{'$unwind':_0x31afd9(0x27a)},{'$group':{'_id':'$product.product_name'}}]);console[_0x31afd9(0x23d)](_0x31afd9(0x1fd),_0x648611);const _0x31643d=await product[_0x31afd9(0x1ba)]({}),_0x2ad05a=await warehouse[_0x31afd9(0x231)]([{'$match':{'name':_0x2caa6b[_0x31afd9(0x24f)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x31afd9(0x1f9),'name':{'$first':_0x31afd9(0x1c7)},'product_stock':{'$first':_0x31afd9(0x252)},'bay':{'$first':_0x31afd9(0x218)},'bin':{'$first':_0x31afd9(0x279)},'type':{'$first':_0x31afd9(0x203)},'floorlevel':{'$first':_0x31afd9(0x1e3)},'primary_code':{'$first':_0x31afd9(0x26e)},'secondary_code':{'$first':_0x31afd9(0x268)},'product_code':{'$first':_0x31afd9(0x1b2)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x31afd9(0x1eb)},'expiry_date':{'$first':_0x31afd9(0x254)},'production_date':{'$first':_0x31afd9(0x1c5)},'batch_code':{'$first':_0x31afd9(0x1e1)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':_0x31afd9(0x247)}}}]);if(_0x4b7962[0x0][_0x31afd9(0x20f)]==_0x31afd9(0x20d)){var _0x582d2f=users[_0x31afd9(0x1b8)];console['log'](_0x582d2f);}else{if(_0x4b7962[0x0][_0x31afd9(0x20f)]==_0x31afd9(0x1c3))var _0x582d2f=users['Hindi'];else{if(_0x4b7962[0x0][_0x31afd9(0x20f)]==_0x31afd9(0x216))var _0x582d2f=users['German'];else{if(_0x4b7962[0x0][_0x31afd9(0x20f)]=='Spanish')var _0x582d2f=users['Spanish'];else{if(_0x4b7962[0x0][_0x31afd9(0x20f)]==_0x31afd9(0x1f1))var _0x582d2f=users[_0x31afd9(0x1f1)];else{if(_0x4b7962[0x0][_0x31afd9(0x20f)]==_0x31afd9(0x1ee))var _0x582d2f=users[_0x31afd9(0x1b9)];else{if(_0x4b7962[0x0][_0x31afd9(0x20f)]==_0x31afd9(0x1f0))var _0x582d2f=users[_0x31afd9(0x1f0)];else{if(_0x4b7962[0x0]['language']=='Arabic\x20(ae)')var _0x582d2f=users[_0x31afd9(0x1df)];}}}}}}}_0x26a220[_0x31afd9(0x1cd)]('edit_adjustment_finished_view',{'success':_0x37a5f6[_0x31afd9(0x248)]('success'),'errors':_0x37a5f6[_0x31afd9(0x248)](_0x31afd9(0x1dd)),'role':_0x462ac8,'profile':_0x54f72b,'adjustment':_0x2caa6b,'stock':_0x2ad05a,'master_shop':_0x4b7962,'warehouse_name':_0x648611,'unit':_0x31643d,'language':_0x582d2f});}catch(_0x162d47){console[_0x31afd9(0x23d)](_0x162d47),_0x26a220[_0x31afd9(0x1d5)](0xc8)['json']({'message':_0x162d47['message']});}}),router[a0_0x2e4581(0x1cb)](a0_0x2e4581(0x26b),auth,async(_0x4a4e62,_0x2896d4)=>{var _0x43afcc=a0_0x2e4581;try{const {invoice:_0xc9acae,warehouse_name:_0x24e0c7,Room_name:_0x348e01}=_0x4a4e62[_0x43afcc(0x24b)],_0x4e6b10=_0x4a4e62[_0x43afcc(0x209)]['id'],_0x4fda95=await adjustment_finished[_0x43afcc(0x1db)]({'_id':_0x4e6b10});var _0x32d960;const _0x37136e=_0x4fda95[_0x43afcc(0x21c)][_0x43afcc(0x1ec)](async _0x597167=>{var _0x31e9b2=_0x43afcc;if(_0x597167[_0x31e9b2(0x1e4)]>0x0){_0x32d960=await warehouse[_0x31e9b2(0x1b3)]({'name':_0x24e0c7,'room':_0x597167['room_names'],'warehouse_category':'Finished\x20Goods'});const _0x308e6a=_0x32d960[_0x31e9b2(0x1f6)]['map'](_0x37c1ab=>{var _0x1e19ae=_0x31e9b2;console[_0x1e19ae(0x23d)](_0x597167[_0x1e19ae(0x1bf)]);if(_0x597167[_0x1e19ae(0x1bf)]==_0x1e19ae(0x1ae))_0x37c1ab[_0x1e19ae(0x1e0)]==_0x597167[_0x1e19ae(0x1e0)]&&_0x37c1ab['bay']==_0x597167[_0x1e19ae(0x23e)]&&_0x37c1ab['expiry_date']==_0x597167[_0x1e19ae(0x1b6)]&&_0x37c1ab['production_date']==_0x597167[_0x1e19ae(0x229)]&&_0x37c1ab['batch_code']==_0x597167[_0x1e19ae(0x24c)]&&_0x37c1ab[_0x1e19ae(0x22b)]==_0x597167['invoice']&&(_0x37c1ab[_0x1e19ae(0x232)]=_0x37c1ab[_0x1e19ae(0x232)]-_0x597167[_0x1e19ae(0x1e4)]);else _0x597167[_0x1e19ae(0x1bf)]==_0x1e19ae(0x245)&&(_0x37c1ab[_0x1e19ae(0x1e0)]==_0x597167[_0x1e19ae(0x1e0)]&&_0x37c1ab['bay']==_0x597167[_0x1e19ae(0x23e)]&&_0x37c1ab['expiry_date']==_0x597167['expiry_date']&&_0x37c1ab[_0x1e19ae(0x229)]==_0x597167[_0x1e19ae(0x229)]&&_0x37c1ab[_0x1e19ae(0x24c)]==_0x597167[_0x1e19ae(0x24c)]&&_0x37c1ab[_0x1e19ae(0x22b)]==_0x597167[_0x1e19ae(0x22b)]&&(_0x37c1ab['product_stock']=_0x37c1ab[_0x1e19ae(0x232)]+_0x597167[_0x1e19ae(0x1e4)]));});}return _0x32d960;});Promise[_0x43afcc(0x1e9)](_0x37136e)[_0x43afcc(0x276)](async _0x573b83=>{var _0xb58788=_0x43afcc;try{for(const _0x2ff7bc of _0x573b83){await _0x2ff7bc[_0xb58788(0x1d6)]();}_0x4fda95[_0xb58788(0x22c)]=_0xb58788(0x25c);const _0x35a056=await _0x4fda95[_0xb58788(0x1d6)](),_0x1c38e2=await master_shop[_0xb58788(0x1ba)](),_0x346ce1=await email_settings[_0xb58788(0x1b3)](),_0x2ddfbd=await supervisor_settings['find']();var _0x9359aa=_0x4fda95['product'],_0x7a209c='',_0x3bf29e;for(_0x3bf29e in _0x9359aa){var _0x1abe0d='FG';_0x4fda95['warehouse_name']==_0xb58788(0x258)&&(_0x1abe0d='DG'),_0x7a209c+='<tr>'+_0xb58788(0x1ca)+_0x9359aa[_0x3bf29e][_0xb58788(0x1e0)]+'</td>'+_0xb58788(0x1ca)+_0x9359aa[_0x3bf29e][_0xb58788(0x21f)]+_0xb58788(0x1c0)+_0xb58788(0x1ca)+_0x9359aa[_0x3bf29e][_0xb58788(0x1e4)]+'</td>'+_0xb58788(0x1ca)+_0x9359aa[_0x3bf29e]['unit']+'</td>'+_0xb58788(0x1ca)+_0x9359aa[_0x3bf29e][_0xb58788(0x250)]+_0xb58788(0x1c0)+_0xb58788(0x1ca)+_0x4fda95[_0xb58788(0x24f)]+_0xb58788(0x1c0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9359aa[_0x3bf29e]['room_names']+_0xb58788(0x1c0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1abe0d+_0x9359aa[_0x3bf29e]['bay']+_0xb58788(0x1c0)+'</tr>';}let _0x2dfee0=nodemailer[_0xb58788(0x23f)]({'host':_0x346ce1[_0xb58788(0x24d)],'port':Number(_0x346ce1[_0xb58788(0x1c9)]),'secure':![],'auth':{'user':_0x346ce1[_0xb58788(0x234)],'pass':_0x346ce1[_0xb58788(0x1d1)]}}),_0x37a741={'from':_0x346ce1[_0xb58788(0x234)],'to':_0x2ddfbd[0x0][_0xb58788(0x259)],'subject':_0xb58788(0x256),'attachments':[{'filename':_0xb58788(0x1c4),'path':__dirname+_0xb58788(0x24a)+_0xb58788(0x26f)+_0x1c38e2[0x0][_0xb58788(0x1c1)],'cid':_0xb58788(0x230)}],'html':_0xb58788(0x266)+_0xb58788(0x1d2)+_0xb58788(0x260)+_0xb58788(0x1d3)+_0xb58788(0x215)+_0xb58788(0x1d3)+_0xb58788(0x214)+'</div>'+_0xb58788(0x1d3)+_0xb58788(0x263)+_0x1c38e2[0x0][_0xb58788(0x1ed)]+_0xb58788(0x23a)+_0xb58788(0x21a)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0xb58788(0x1d3)+_0xb58788(0x236)+_0xb58788(0x204)+_0x4fda95[_0xb58788(0x22b)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0xb58788(0x1ea)+_0x4fda95[_0xb58788(0x1d0)]+'\x20'+_0xb58788(0x206)+_0xb58788(0x21e)+_0xb58788(0x21a)+_0xb58788(0x22e)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0xb58788(0x1d7)+_0xb58788(0x205)+_0xb58788(0x1e5)+_0xb58788(0x1e6)+_0xb58788(0x1ce)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0xb58788(0x217)+_0xb58788(0x262)+_0xb58788(0x1fe)+_0xb58788(0x227)+_0xb58788(0x25a)+'\x20'+_0x7a209c+'\x20'+_0xb58788(0x278)+_0xb58788(0x1e7)+_0xb58788(0x1d3)+'<strong>\x20Regards\x20</strong>'+_0xb58788(0x249)+_0x1c38e2[0x0][_0xb58788(0x1ed)]+'</h5>'+_0xb58788(0x21a)+_0xb58788(0x21a)+_0xb58788(0x1d9)};_0x2dfee0[_0xb58788(0x1bd)](_0x37a741,function(_0x16985a,_0x3bb3e6){var _0xdc5660=_0xb58788;_0x16985a?(console[_0xdc5660(0x23d)](_0x16985a),console[_0xdc5660(0x23d)](_0xdc5660(0x243))):console[_0xdc5660(0x23d)](_0xdc5660(0x1fb));}),_0x4a4e62[_0xb58788(0x248)](_0xb58788(0x225),_0xb58788(0x25d)),_0x2896d4[_0xb58788(0x1da)](_0xb58788(0x264)+_0x35a056['_id']);}catch(_0x5c9f1e){console['error'](_0x5c9f1e),_0x2896d4['status'](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x43afcc(0x21d)](_0x40efd1=>{var _0x5e11c8=_0x43afcc;console[_0x5e11c8(0x1d4)](_0x40efd1),_0x2896d4[_0x5e11c8(0x1d5)](0x1f4)[_0x5e11c8(0x1ab)]({'error':_0x5e11c8(0x275)});});}catch(_0x456a5e){_0x2896d4[_0x43afcc(0x1ab)]({'message':_0x456a5e[_0x43afcc(0x20c)]});}}),router[a0_0x2e4581(0x1b0)](a0_0x2e4581(0x269),auth,async(_0x260e3a,_0x1cc400)=>{var _0x32b1e8=a0_0x2e4581;try{const {username:_0x267d65,email:_0xbddad8,role:_0x270e08}=_0x260e3a['user'],_0x572067=_0x260e3a[_0x32b1e8(0x1b5)],_0x15032e=await profile[_0x32b1e8(0x1b3)]({'email':_0x572067[_0x32b1e8(0x234)]}),_0x3b98d9=await master_shop['find']();console[_0x32b1e8(0x23d)](_0x32b1e8(0x1e2),_0x3b98d9);const _0x17fc58=_0x260e3a[_0x32b1e8(0x209)]['id'],_0x2b2bdb=await adjustment_finished[_0x32b1e8(0x1db)]({'_id':_0x17fc58});let _0x85df4e=new Date(_0x2b2bdb[_0x32b1e8(0x1b6)]),_0x3417a0=('0'+_0x85df4e[_0x32b1e8(0x220)]())[_0x32b1e8(0x255)](-0x2),_0x5ac4f0=('0'+(_0x85df4e[_0x32b1e8(0x1aa)]()+0x1))[_0x32b1e8(0x255)](-0x2),_0x23d2a2=_0x85df4e[_0x32b1e8(0x25b)](),_0x391c53=_0x23d2a2+'-'+_0x5ac4f0+'-'+_0x3417a0;var _0x371654=['Ambient','Enclosed',_0x32b1e8(0x207)];const _0x4a1b75=await purchases[_0x32b1e8(0x231)]([{'$match':{'warehouse_name':_0x2b2bdb[_0x32b1e8(0x24f)]}},{'$unwind':_0x32b1e8(0x27a)},{'$group':{'_id':_0x32b1e8(0x1f8)}}]);console[_0x32b1e8(0x23d)](_0x32b1e8(0x1fd),_0x4a1b75);const _0x5cb26f=await product[_0x32b1e8(0x1ba)]({}),_0xe736b7=await warehouse['aggregate']([{'$match':{'name':_0x2b2bdb[_0x32b1e8(0x24f)],'room':_0x2b2bdb[_0x32b1e8(0x1bc)]}},{'$unwind':_0x32b1e8(0x26d)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x32b1e8(0x1c7)},'product_stock':{'$first':_0x32b1e8(0x252)},'bay':{'$first':_0x32b1e8(0x218)},'bin':{'$first':_0x32b1e8(0x279)},'type':{'$first':_0x32b1e8(0x203)},'floorlevel':{'$first':_0x32b1e8(0x1e3)},'primary_code':{'$first':_0x32b1e8(0x26e)},'secondary_code':{'$first':_0x32b1e8(0x268)},'product_code':{'$first':_0x32b1e8(0x1b2)},'storage':{'$first':_0x32b1e8(0x272)},'rack':{'$first':_0x32b1e8(0x1eb)}}}]);if(_0x3b98d9[0x0][_0x32b1e8(0x20f)]==_0x32b1e8(0x20d)){var _0x576b1b=users[_0x32b1e8(0x1b8)];console[_0x32b1e8(0x23d)](_0x576b1b);}else{if(_0x3b98d9[0x0][_0x32b1e8(0x20f)]=='Hindi')var _0x576b1b=users[_0x32b1e8(0x1c3)];else{if(_0x3b98d9[0x0][_0x32b1e8(0x20f)]=='German')var _0x576b1b=users[_0x32b1e8(0x216)];else{if(_0x3b98d9[0x0][_0x32b1e8(0x20f)]==_0x32b1e8(0x201))var _0x576b1b=users[_0x32b1e8(0x201)];else{if(_0x3b98d9[0x0]['language']==_0x32b1e8(0x1f1))var _0x576b1b=users[_0x32b1e8(0x1f1)];else{if(_0x3b98d9[0x0][_0x32b1e8(0x20f)]==_0x32b1e8(0x1ee))var _0x576b1b=users[_0x32b1e8(0x1b9)];else{if(_0x3b98d9[0x0][_0x32b1e8(0x20f)]==_0x32b1e8(0x1f0))var _0x576b1b=users[_0x32b1e8(0x1f0)];else{if(_0x3b98d9[0x0][_0x32b1e8(0x20f)]==_0x32b1e8(0x1f7))var _0x576b1b=users[_0x32b1e8(0x1df)];}}}}}}}_0x1cc400[_0x32b1e8(0x1cd)](_0x32b1e8(0x240),{'success':_0x260e3a[_0x32b1e8(0x248)](_0x32b1e8(0x225)),'errors':_0x260e3a[_0x32b1e8(0x248)]('errors'),'role':_0x572067,'profile':_0x15032e,'adjustment':_0x2b2bdb,'stock':_0xe736b7,'master_shop':_0x3b98d9,'warehouse_name':_0x4a1b75,'unit':_0x5cb26f,'language':_0x576b1b,'rooms_data':_0x371654,'ed_fullDate':_0x391c53});}catch(_0x1198f3){console['log'](_0x1198f3),_0x1cc400[_0x32b1e8(0x1d5)](0xc8)['json']({'message':_0x1198f3['message']});}}),router[a0_0x2e4581(0x1cb)](a0_0x2e4581(0x269),auth,async(_0x56b28d,_0x486f57)=>{var _0x21d389=a0_0x2e4581;try{const _0xee6960=_0x56b28d[_0x21d389(0x209)]['id'],_0x902262=await adjustment_finished[_0x21d389(0x1db)]({'_id':_0xee6960}),_0xc199a3=await warehouse[_0x21d389(0x1b3)]({'name':_0x902262[_0x21d389(0x24f)],'room':_0x902262[_0x21d389(0x1bc)]}),{warehouse_name:_0x3c6cf0,date:_0x2534b6,prod_name:_0xe3bb3c,level:_0x46a26b,isle:_0x4760c4,pallet:_0x5cc826,stock:_0x2c9e4f,types:_0x12a14b,adjust_qty:_0x10eb9e,new_adjust_qty:_0x583c9f,note:_0x57aab9,Room_name:_0x135428,invoice:_0x3d42de,JO_number:_0x8c5e30}=_0x56b28d['body'];if(typeof _0xe3bb3c==_0x21d389(0x237))var _0x5f45cf=[_0x56b28d[_0x21d389(0x24b)][_0x21d389(0x273)]],_0xe0021f=[_0x56b28d[_0x21d389(0x24b)][_0x21d389(0x1c2)]],_0x27f879=[_0x56b28d[_0x21d389(0x24b)][_0x21d389(0x1dc)]],_0x5a0b65=[_0x56b28d[_0x21d389(0x24b)][_0x21d389(0x1bf)]],_0x58e30b=[_0x56b28d[_0x21d389(0x24b)][_0x21d389(0x1e4)]],_0x93a840=[_0x56b28d['body'][_0x21d389(0x239)]],_0x390cc0=[_0x56b28d[_0x21d389(0x24b)][_0x21d389(0x1f2)]],_0x1c5fbc=[_0x56b28d[_0x21d389(0x24b)][_0x21d389(0x246)]],_0x43e3e7=[_0x56b28d[_0x21d389(0x24b)][_0x21d389(0x22f)]],_0x52542c=[_0x56b28d['body'][_0x21d389(0x24c)]],_0xa5ef42=[_0x56b28d['body'][_0x21d389(0x1b6)]];else var _0x5f45cf=[..._0x56b28d[_0x21d389(0x24b)][_0x21d389(0x273)]],_0xe0021f=[..._0x56b28d[_0x21d389(0x24b)][_0x21d389(0x1c2)]],_0x27f879=[..._0x56b28d[_0x21d389(0x24b)][_0x21d389(0x1dc)]],_0x5a0b65=[..._0x56b28d[_0x21d389(0x24b)]['types']],_0x58e30b=[..._0x56b28d[_0x21d389(0x24b)][_0x21d389(0x1e4)]],_0x93a840=[..._0x56b28d['body'][_0x21d389(0x239)]],_0x390cc0=[..._0x56b28d[_0x21d389(0x24b)][_0x21d389(0x1f2)]],_0x1c5fbc=[..._0x56b28d[_0x21d389(0x24b)]['unit']],_0x43e3e7=[..._0x56b28d[_0x21d389(0x24b)][_0x21d389(0x22f)]],_0x52542c=[..._0x56b28d[_0x21d389(0x24b)]['batch_code']],_0xa5ef42=[..._0x56b28d[_0x21d389(0x24b)][_0x21d389(0x1b6)]];const _0x42c5ea=_0x5f45cf[_0x21d389(0x1ec)](_0x24562d=>{return _0x24562d={'product_name':_0x24562d};});_0xe0021f[_0x21d389(0x223)]((_0x2819a9,_0x48207c)=>{var _0x5b752c=_0x21d389;_0x42c5ea[_0x48207c][_0x5b752c(0x23e)]=_0x2819a9;}),_0x27f879[_0x21d389(0x223)]((_0x2385e3,_0x14eacf)=>{var _0x2dcb96=_0x21d389;_0x42c5ea[_0x14eacf][_0x2dcb96(0x1ef)]=_0x2385e3;}),_0x5a0b65[_0x21d389(0x223)]((_0x4b644b,_0x5ea2ec)=>{var _0x492755=_0x21d389;_0x42c5ea[_0x5ea2ec][_0x492755(0x1bf)]=_0x4b644b;}),_0x58e30b[_0x21d389(0x223)]((_0x26fc8d,_0x2d28cc)=>{var _0x5658a9=_0x21d389;_0x42c5ea[_0x2d28cc][_0x5658a9(0x1e4)]=_0x26fc8d;}),_0x93a840['forEach']((_0x5a4194,_0x551395)=>{var _0x2cd217=_0x21d389;_0x42c5ea[_0x551395][_0x2cd217(0x239)]=_0x5a4194;}),_0x1c5fbc[_0x21d389(0x223)]((_0x10ae73,_0x1a902b)=>{var _0x36685a=_0x21d389;_0x42c5ea[_0x1a902b][_0x36685a(0x246)]=_0x10ae73;}),_0x43e3e7[_0x21d389(0x223)]((_0x44e9e7,_0x8016ef)=>{var _0x1a7c9d=_0x21d389;_0x42c5ea[_0x8016ef][_0x1a7c9d(0x250)]=_0x44e9e7;}),_0x390cc0[_0x21d389(0x223)]((_0x5b51eb,_0x1d2f9b)=>{var _0x3a795f=_0x21d389;_0x42c5ea[_0x1d2f9b][_0x3a795f(0x21f)]=_0x5b51eb;}),_0x52542c['forEach']((_0x128829,_0x512542)=>{var _0x5e7bed=_0x21d389;_0x42c5ea[_0x512542][_0x5e7bed(0x24c)]=_0x128829;}),_0xa5ef42[_0x21d389(0x223)]((_0x59519b,_0x576ef1)=>{_0x42c5ea[_0x576ef1]['expiry_date']=_0x59519b;});const _0x4e62fb=_0x42c5ea[_0x21d389(0x241)](_0x3cb243=>_0x3cb243[_0x21d389(0x1e4)]!=='0'&&_0x3cb243[_0x21d389(0x1e4)]!=='');var _0x5b2a7e=0x0;_0x4e62fb['forEach'](_0x3024bb=>{var _0x3662c6=_0x21d389;console['log'](_0x3662c6(0x26c),_0x3024bb),parseInt(_0x3024bb[_0x3662c6(0x1e4)])<=0x0&&_0x5b2a7e++;});if(_0x5b2a7e!=0x0)return _0x56b28d['flash'](_0x21d389(0x1dd),_0x21d389(0x242)),_0x486f57[_0x21d389(0x1da)]('back');_0x902262['warehouse_name']=_0x3c6cf0,_0x902262[_0x21d389(0x1d0)]=_0x2534b6,_0x902262[_0x21d389(0x21c)]=_0x4e62fb,_0x902262['note']=_0x57aab9,_0x902262[_0x21d389(0x1bc)]=_0x135428,_0x902262['invoice']=_0x3d42de,_0x902262[_0x21d389(0x271)]=_0x8c5e30;const _0x2b6401=await _0x902262[_0x21d389(0x1d6)](),_0x2376d0=await warehouse[_0x21d389(0x1b3)]({'name':_0x3c6cf0,'room':_0x135428});_0x2b6401[_0x21d389(0x21c)]['forEach'](_0x4facbf=>{var _0x51d24c=_0x21d389;const _0x2a3033=_0x2376d0[_0x51d24c(0x1f6)]['map'](_0x38bbb3=>{var _0x3d952d=_0x51d24c;_0x4facbf[_0x3d952d(0x1bf)]=='minus'?_0x38bbb3['product_name']==_0x4facbf[_0x3d952d(0x1e0)]&&_0x38bbb3[_0x3d952d(0x23e)]==_0x4facbf[_0x3d952d(0x23e)]&&(_0x38bbb3[_0x3d952d(0x232)]=parseInt(_0x38bbb3[_0x3d952d(0x232)])-parseInt(_0x4facbf['adjust_qty'])):_0x38bbb3[_0x3d952d(0x1e0)]==_0x4facbf['product_name']&&_0x38bbb3[_0x3d952d(0x23e)]==_0x4facbf[_0x3d952d(0x23e)]&&(_0x38bbb3[_0x3d952d(0x232)]=parseInt(_0x38bbb3['product_stock'])+parseInt(_0x4facbf[_0x3d952d(0x1e4)]));});}),await _0x2376d0[_0x21d389(0x1d6)](),_0x56b28d[_0x21d389(0x248)](_0x21d389(0x225),'adjustment\x20data\x20update\x20successfully'),_0x486f57['redirect'](_0x21d389(0x211));}catch(_0x3106c6){console['log'](_0x3106c6);}}),router[a0_0x2e4581(0x1cb)](a0_0x2e4581(0x1f4),async(_0x2b9ecf,_0x21dc29)=>{var _0x261d04=a0_0x2e4581;const {primary_code:_0x519763,warehouse_data:_0x47abba,rooms_data:_0x3121e1,Roomslist:_0x5c611f}=_0x2b9ecf['body'],_0x4ae982=_0x5c611f[_0x261d04(0x20a)](','),_0x4b39b8=[];async function _0x20c680(_0x3edfce){var _0xc954ec=_0x261d04;const _0x44d1a7=await warehouse['aggregate']([{'$match':{'name':_0x47abba,'room':_0x3edfce}},{'$unwind':_0xc954ec(0x26d)},{'$match':{'product_details.primary_code':_0x519763}},{'$group':{'_id':_0xc954ec(0x1f9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xc954ec(0x252)},'primary_code':{'$first':_0xc954ec(0x26e)},'secondary_code':{'$first':_0xc954ec(0x268)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0xc954ec(0x279)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0xc954ec(0x1e3)},'unit':{'$first':_0xc954ec(0x213)},'secondary_unit':{'$first':_0xc954ec(0x277)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xc954ec(0x254)},'production_date':{'$first':_0xc954ec(0x1c5)},'batch_code':{'$first':_0xc954ec(0x1e1)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0xc954ec(0x247)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x5c7ad0=await warehouse[_0xc954ec(0x231)]([{'$match':{'name':_0x47abba,'room':_0x3edfce}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x519763}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xc954ec(0x1c7)},'product_stock':{'$first':_0xc954ec(0x252)},'primary_code':{'$first':_0xc954ec(0x26e)},'secondary_code':{'$first':_0xc954ec(0x268)},'product_code':{'$first':_0xc954ec(0x1b2)},'level':{'$first':_0xc954ec(0x218)},'isle':{'$first':_0xc954ec(0x279)},'type':{'$first':_0xc954ec(0x203)},'pallet':{'$first':_0xc954ec(0x1e3)},'unit':{'$first':_0xc954ec(0x213)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0xc954ec(0x272)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xc954ec(0x254)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0xc954ec(0x1e1)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0xc954ec(0x1bb)},'roomNamed':{'$first':_0xc954ec(0x247)},'invoice':{'$first':_0xc954ec(0x1e8)}}}]);if(_0x44d1a7[_0xc954ec(0x224)]>0x0)_0x4b39b8[_0xc954ec(0x1de)](_0x44d1a7);else _0x5c7ad0['length']>0x0&&_0x4b39b8[_0xc954ec(0x1de)](_0x5c7ad0);}const _0x495e00=_0x4ae982['map'](_0x4a8c49=>_0x20c680(_0x4a8c49));await Promise[_0x261d04(0x1e9)](_0x495e00),_0x21dc29[_0x261d04(0x1ab)](_0x4b39b8);}),router['post'](a0_0x2e4581(0x1ff),async(_0x299ed6,_0x4198a7)=>{var _0x420c75=a0_0x2e4581;const {productCode:_0x30f63c,bay:_0x55a901,warehouses:_0x280926,room:_0x2e54c7}=_0x299ed6['body'];console[_0x420c75(0x23d)](_0x299ed6[_0x420c75(0x24b)]);try{const _0x3b2394=await warehouse[_0x420c75(0x231)]([{'$match':{'name':_0x280926,'room':_0x2e54c7}},{'$unwind':_0x420c75(0x26d)},{'$match':{'product_details.bay':parseInt(_0x55a901)}},{'$group':{'_id':_0x420c75(0x1f9),'name':{'$first':_0x420c75(0x1c7)},'product_stock':{'$first':_0x420c75(0x252)},'bay':{'$first':_0x420c75(0x218)},'maxProducts':{'$first':_0x420c75(0x1b7)}}}]);_0x4198a7[_0x420c75(0x1d5)](0xc8)[_0x420c75(0x1ab)](_0x3b2394);}catch(_0x39b1fb){_0x4198a7['status'](0x194)[_0x420c75(0x1ab)]({'message':_0x39b1fb[_0x420c75(0x20c)]});}}),module[a0_0x2e4581(0x1c6)]=router;