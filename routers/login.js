const a0_0x58e65e=a0_0x192a;function a0_0x192a(_0x58fc17,_0x345aff){const _0xb17d2c=a0_0xb17d();return a0_0x192a=function(_0x192ad8,_0x5b2c7a){_0x192ad8=_0x192ad8-0xef;let _0x57cd3d=_0xb17d2c[_0x192ad8];return _0x57cd3d;},a0_0x192a(_0x58fc17,_0x345aff);}(function(_0x24cd51,_0x3e8aab){const _0x5452b9=a0_0x192a,_0x118695=_0x24cd51();while(!![]){try{const _0x90fec2=-parseInt(_0x5452b9(0x115))/0x1+parseInt(_0x5452b9(0x10d))/0x2+parseInt(_0x5452b9(0xef))/0x3*(parseInt(_0x5452b9(0xfd))/0x4)+parseInt(_0x5452b9(0xf9))/0x5+parseInt(_0x5452b9(0xfe))/0x6+parseInt(_0x5452b9(0x100))/0x7*(-parseInt(_0x5452b9(0x106))/0x8)+-parseInt(_0x5452b9(0x110))/0x9*(parseInt(_0x5452b9(0x103))/0xa);if(_0x90fec2===_0x3e8aab)break;else _0x118695['push'](_0x118695['shift']());}catch(_0x519ce5){_0x118695['push'](_0x118695['shift']());}}}(a0_0xb17d,0xaf1f0));const express=require('express'),app=express(),router=express['Router'](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require(a0_0x58e65e(0xfb)),jwt=require('jsonwebtoken'),auth=require(a0_0x58e65e(0x107));router[a0_0x58e65e(0x10c)]('/',async(_0x4da3d7,_0x4f9c5f)=>{const _0x37b57d=a0_0x58e65e;try{const _0x225e83=await master_shop['find']();_0x4f9c5f[_0x37b57d(0xf5)](_0x37b57d(0x11f),{'success':_0x4da3d7[_0x37b57d(0x116)](_0x37b57d(0x118)),'errors':_0x4da3d7['flash'](_0x37b57d(0x11a)),'master_shop':_0x225e83});}catch(_0x2b35aa){console[_0x37b57d(0x113)](_0x2b35aa);}}),router[a0_0x58e65e(0x10c)](a0_0x58e65e(0x10e),async(_0x173e5b,_0x535362)=>{const _0x137334=a0_0x58e65e;try{const _0x4eb6d1=await master_shop[_0x137334(0x10f)]();_0x535362[_0x137334(0xf5)](_0x137334(0x105),{'success':_0x173e5b[_0x137334(0x116)](_0x137334(0x118)),'errors':_0x173e5b[_0x137334(0x116)](_0x137334(0x11a)),'master_shop':_0x4eb6d1});}catch(_0x36fffa){console[_0x137334(0x113)](_0x36fffa);}}),router[a0_0x58e65e(0x10c)](a0_0x58e65e(0xf2),async(_0x2a3efb,_0x56032c)=>{const _0x2a9478=a0_0x58e65e;try{const _0x892ba3=await master_shop['find']();console[_0x2a9478(0x113)](_0x2a9478(0x101),_0x892ba3),_0x56032c['render'](_0x2a9478(0x11f),{'success':_0x2a3efb[_0x2a9478(0x116)](_0x2a9478(0x118)),'errors':_0x2a3efb[_0x2a9478(0x116)](_0x2a9478(0x11a)),'master_shop':_0x892ba3});}catch(_0x241854){console[_0x2a9478(0x113)](_0x241854);}}),router['post'](a0_0x58e65e(0xf2),async(_0x473de2,_0x5a3aad)=>{const _0x198526=a0_0x58e65e;try{const _0x11b756=_0x473de2['body']['email'],_0x284ecf=await sing_up[_0x198526(0x114)]({'email':_0x11b756});if(!_0x284ecf)return _0x473de2['flash']('errors',_0x198526(0x120)),_0x5a3aad['redirect'](_0x198526(0xf2));var _0x4bea88=_0x198526(0x11d);if(_0x284ecf[_0x198526(0xff)]==_0x198526(0xf6)){const _0x4e1918=await staff[_0x198526(0x114)]({'name':_0x284ecf[_0x198526(0xf4)]});if(_0x4e1918[_0x198526(0x111)]=='Disabled')return _0x473de2['flash']('errors',_0x198526(0xf7)),_0x5a3aad[_0x198526(0x119)]('/login');_0x4bea88=_0x4e1918[_0x198526(0xf1)];}const _0x41a241=_0x473de2[_0x198526(0x11c)][_0x198526(0xfc)],_0x36121b=await bcrypt[_0x198526(0x10b)](_0x41a241,_0x284ecf[_0x198526(0xfc)]);if(_0x36121b==![])return _0x473de2[_0x198526(0x116)](_0x198526(0x11a),_0x198526(0xfa)),_0x5a3aad[_0x198526(0x119)]('/login');const _0x573fea=jwt[_0x198526(0x117)]({'username':_0x284ecf[_0x198526(0x10a)],'email':_0x284ecf[_0x198526(0x109)],'role':_0x284ecf['role'],'warehouse_category':_0x4bea88},process[_0x198526(0x112)][_0x198526(0xf3)]);_0x5a3aad[_0x198526(0x108)](_0x198526(0x11b),_0x573fea,{'expires':new Date(0xe677d213a700)}),_0x473de2['flash'](_0x198526(0x118),_0x198526(0xf0)),_0x5a3aad[_0x198526(0x119)](_0x198526(0xf8));}catch(_0x1ec048){console['log'](_0x1ec048);}}),router[a0_0x58e65e(0x10c)]('/staff/:id',async(_0x4c44e1,_0x278921)=>{const _0x54746f=a0_0x58e65e;try{const _0x1dfad8=_0x4c44e1[_0x54746f(0x102)]['id'],_0x36f839=await staff[_0x54746f(0x104)]({'_id':_0x1dfad8});_0x36f839[_0x54746f(0x111)]=='Disabled'&&(_0x4c44e1['flash'](_0x54746f(0x11a),_0x54746f(0xf7)),_0x278921['redirect']('/staff/view'));const _0x180a73=await sing_up[_0x54746f(0x114)]({'email':_0x36f839[_0x54746f(0x109)]});var _0x2a9b08=_0x54746f(0x11d);if(_0x180a73[_0x54746f(0xff)]=='staff'){const _0x5ae116=await staff[_0x54746f(0x114)]({'name':_0x180a73['name']});_0x2a9b08=_0x5ae116['warehouse_category'];}const _0x5e27d3=jwt[_0x54746f(0x117)]({'username':_0x180a73[_0x54746f(0x10a)],'email':_0x180a73['email'],'role':_0x180a73['role'],'warehouse_category':_0x2a9b08},process[_0x54746f(0x112)][_0x54746f(0xf3)]);_0x278921[_0x54746f(0x108)](_0x54746f(0x11b),_0x5e27d3,{'expires':new Date(0xe677d213a700)}),_0x4c44e1[_0x54746f(0x116)]('success',_0x54746f(0xf0)),_0x278921[_0x54746f(0x119)](_0x54746f(0xf8));}catch(_0x485903){console['log'](_0x485903);}}),router[a0_0x58e65e(0x10c)](a0_0x58e65e(0x11e),(_0x4214ca,_0x183b11)=>{const _0x431e80=a0_0x58e65e;_0x183b11['clearCookie']('jwt'),_0x183b11[_0x431e80(0x119)](_0x431e80(0xf2));}),module['exports']=router;function a0_0xb17d(){const _0x30f0f2=['18655Zefysh','login\x20master','params','70pLkYGW','findById','validate','2696jDGWBz','../middleware/auth','cookie','email','username','compare','get','536268dOymqs','/validate','find','70974lKIubP','status','env','log','findOne','27336ipypTY','flash','sign','success','redirect','errors','jwt','body','All','/logout','login','your\x20email\x20is\x20not\x20register','126294toikdH','login\x20successfully','warehouse_category','/login','secret_key','name','render','staff','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','/index','4562110LMAlxj','your\x20password\x20is\x20wrong','bcryptjs','password','28kqNBlU','1336182RFjfrA','role'];a0_0xb17d=function(){return _0x30f0f2;};return a0_0xb17d();}