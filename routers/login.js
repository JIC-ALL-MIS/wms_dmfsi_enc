const a0_0x28df9a=a0_0x3411;function a0_0x3387(){const _0x10b082=['role','post','username','/index','staff','jsonwebtoken','log','express','Disabled','body','get','params','619135RpRGiG','jwt','63hfIyGh','login\x20successfully','../models/all_models','email','status','login','Router','redirect','render','197875VcZFjj','env','/login','6RHkQtZ','find','errors','warehouse_category','4QAQXQc','958618aQDvRM','/logout','name','success','compare','flash','1945850cwrnuR','validate','cookie','5923134vATAux','clearCookie','findOne','3104862UrCwbG','sign','950360ePsvVz','../middleware/auth','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','secret_key','password'];a0_0x3387=function(){return _0x10b082;};return a0_0x3387();}(function(_0x1a96c3,_0x3bc8a3){const _0x433a6d=a0_0x3411,_0x137474=_0x1a96c3();while(!![]){try{const _0x59a8fe=parseInt(_0x433a6d(0x119))/0x1+-parseInt(_0x433a6d(0xfa))/0x2*(-parseInt(_0x433a6d(0xf5))/0x3)+-parseInt(_0x433a6d(0xf9))/0x4*(parseInt(_0x433a6d(0x124))/0x5)+parseInt(_0x433a6d(0x106))/0x6+-parseInt(_0x433a6d(0x103))/0x7+-parseInt(_0x433a6d(0x108))/0x8*(parseInt(_0x433a6d(0x11b))/0x9)+parseInt(_0x433a6d(0x100))/0xa;if(_0x59a8fe===_0x3bc8a3)break;else _0x137474['push'](_0x137474['shift']());}catch(_0x34441f){_0x137474['push'](_0x137474['shift']());}}}(a0_0x3387,0x8bc61));function a0_0x3411(_0x49debc,_0x479df3){const _0x3387dd=a0_0x3387();return a0_0x3411=function(_0x34116a,_0x5587bf){_0x34116a=_0x34116a-0xf3;let _0xafbb65=_0x3387dd[_0x34116a];return _0xafbb65;},a0_0x3411(_0x49debc,_0x479df3);}const express=require(a0_0x28df9a(0x114)),app=express(),router=express[a0_0x28df9a(0x121)](),{sing_up,staff,profile,master_shop}=require(a0_0x28df9a(0x11d)),bcrypt=require('bcryptjs'),jwt=require(a0_0x28df9a(0x112)),auth=require(a0_0x28df9a(0x109));router['get']('/',async(_0x22722d,_0x17c736)=>{const _0x94ef59=a0_0x28df9a;try{const _0x10df95=await master_shop[_0x94ef59(0xf6)]();_0x17c736[_0x94ef59(0x123)](_0x94ef59(0x120),{'success':_0x22722d[_0x94ef59(0xff)]('success'),'errors':_0x22722d[_0x94ef59(0xff)](_0x94ef59(0xf7)),'master_shop':_0x10df95});}catch(_0x576fd8){console[_0x94ef59(0x113)](_0x576fd8);}}),router['get']('/validate',async(_0x301bc0,_0x172c29)=>{const _0x3135ee=a0_0x28df9a;try{const _0x190df4=await master_shop['find']();_0x172c29['render'](_0x3135ee(0x101),{'success':_0x301bc0[_0x3135ee(0xff)](_0x3135ee(0xfd)),'errors':_0x301bc0['flash'](_0x3135ee(0xf7)),'master_shop':_0x190df4});}catch(_0x202be6){console[_0x3135ee(0x113)](_0x202be6);}}),router[a0_0x28df9a(0x117)]('/login',async(_0x4b3ed6,_0x46ba0a)=>{const _0x52cad5=a0_0x28df9a;try{const _0x1f3af6=await master_shop[_0x52cad5(0xf6)]();console['log']('login\x20master',_0x1f3af6),_0x46ba0a[_0x52cad5(0x123)](_0x52cad5(0x120),{'success':_0x4b3ed6[_0x52cad5(0xff)](_0x52cad5(0xfd)),'errors':_0x4b3ed6[_0x52cad5(0xff)](_0x52cad5(0xf7)),'master_shop':_0x1f3af6});}catch(_0x2cc315){console[_0x52cad5(0x113)](_0x2cc315);}}),router[a0_0x28df9a(0x10e)](a0_0x28df9a(0xf4),async(_0x4701ab,_0x2bb723)=>{const _0x424b7e=a0_0x28df9a;try{const _0x1a0277=_0x4701ab[_0x424b7e(0x116)][_0x424b7e(0x11e)],_0x49c3c0=await sing_up[_0x424b7e(0x105)]({'email':_0x1a0277});if(!_0x49c3c0)return _0x4701ab[_0x424b7e(0xff)]('errors','your\x20email\x20is\x20not\x20register'),_0x2bb723[_0x424b7e(0x122)](_0x424b7e(0xf4));const _0x5ef2d1=await staff[_0x424b7e(0x105)]({'email':_0x49c3c0[_0x424b7e(0x11e)]});var _0x3a0efa=_0x5ef2d1[_0x424b7e(0xf8)];if(_0x49c3c0['role']=='staff'){const _0x46b53d=await staff[_0x424b7e(0x105)]({'email':_0x49c3c0[_0x424b7e(0x11e)]});if(_0x46b53d[_0x424b7e(0x11f)]=='Disabled')return _0x4701ab[_0x424b7e(0xff)](_0x424b7e(0xf7),'Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.'),_0x2bb723[_0x424b7e(0x122)](_0x424b7e(0xf4));_0x3a0efa=_0x46b53d[_0x424b7e(0xf8)];}const _0x23519f=_0x4701ab[_0x424b7e(0x116)][_0x424b7e(0x10c)],_0x5ee5b7=await bcrypt[_0x424b7e(0xfe)](_0x23519f,_0x49c3c0[_0x424b7e(0x10c)]);if(_0x5ee5b7==![])return _0x4701ab['flash'](_0x424b7e(0xf7),'your\x20password\x20is\x20wrong'),_0x2bb723[_0x424b7e(0x122)](_0x424b7e(0xf4));const _0x55dc79=jwt['sign']({'username':_0x49c3c0[_0x424b7e(0x10f)],'email':_0x49c3c0['email'],'role':_0x49c3c0['role'],'warehouse_category':_0x3a0efa},process[_0x424b7e(0xf3)][_0x424b7e(0x10b)]);_0x2bb723[_0x424b7e(0x102)](_0x424b7e(0x11a),_0x55dc79,{'expires':new Date(0xe677d213a700)}),_0x4701ab[_0x424b7e(0xff)](_0x424b7e(0xfd),'login\x20successfully'),_0x2bb723[_0x424b7e(0x122)](_0x424b7e(0x110));}catch(_0x5996ad){console[_0x424b7e(0x113)](_0x5996ad);}}),router[a0_0x28df9a(0x117)]('/staff/:id',async(_0x1886dc,_0x199749)=>{const _0x181597=a0_0x28df9a;try{const _0x590398=_0x1886dc[_0x181597(0x118)]['id'],_0x204b9e=await staff['findById']({'_id':_0x590398});_0x204b9e['status']==_0x181597(0x115)&&(_0x1886dc['flash'](_0x181597(0xf7),_0x181597(0x10a)),_0x199749[_0x181597(0x122)]('/staff/view'));const _0x4c9ed7=await sing_up[_0x181597(0x105)]({'email':_0x204b9e[_0x181597(0x11e)]});var _0x2d7927=_0x204b9e[_0x181597(0xf8)];if(_0x4c9ed7[_0x181597(0x10d)]==_0x181597(0x111)){const _0x1f67c3=await staff['findOne']({'name':_0x4c9ed7[_0x181597(0xfc)]});_0x2d7927=_0x1f67c3['warehouse_category'];}const _0x2e0c57=jwt[_0x181597(0x107)]({'username':_0x4c9ed7['username'],'email':_0x4c9ed7[_0x181597(0x11e)],'role':_0x4c9ed7[_0x181597(0x10d)],'warehouse_category':_0x2d7927},process[_0x181597(0xf3)][_0x181597(0x10b)]);_0x199749[_0x181597(0x102)]('jwt',_0x2e0c57,{'expires':new Date(0xe677d213a700)}),_0x1886dc[_0x181597(0xff)](_0x181597(0xfd),_0x181597(0x11c)),_0x199749[_0x181597(0x122)](_0x181597(0x110));}catch(_0x5cdab7){console[_0x181597(0x113)](_0x5cdab7);}}),router[a0_0x28df9a(0x117)](a0_0x28df9a(0xfb),(_0x4925c2,_0x22fe97)=>{const _0x132038=a0_0x28df9a;_0x22fe97[_0x132038(0x104)](_0x132038(0x11a)),_0x22fe97[_0x132038(0x122)]('/login');}),module['exports']=router;