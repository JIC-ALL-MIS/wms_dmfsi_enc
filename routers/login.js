const a0_0x5014d5=a0_0x2ac3;(function(_0x4c1a65,_0x5429c0){const _0x4c51cb=a0_0x2ac3,_0x435817=_0x4c1a65();while(!![]){try{const _0x358073=parseInt(_0x4c51cb(0x10e))/0x1*(-parseInt(_0x4c51cb(0x128))/0x2)+parseInt(_0x4c51cb(0x12c))/0x3*(-parseInt(_0x4c51cb(0x103))/0x4)+parseInt(_0x4c51cb(0x11f))/0x5*(parseInt(_0x4c51cb(0x10a))/0x6)+parseInt(_0x4c51cb(0x108))/0x7*(parseInt(_0x4c51cb(0x118))/0x8)+-parseInt(_0x4c51cb(0x125))/0x9+-parseInt(_0x4c51cb(0x10d))/0xa*(parseInt(_0x4c51cb(0x110))/0xb)+parseInt(_0x4c51cb(0x12b))/0xc*(parseInt(_0x4c51cb(0x11a))/0xd);if(_0x358073===_0x5429c0)break;else _0x435817['push'](_0x435817['shift']());}catch(_0x92c9f0){_0x435817['push'](_0x435817['shift']());}}}(a0_0x4bbd,0x711a3));const express=require('express'),app=express(),router=express[a0_0x5014d5(0x102)](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require(a0_0x5014d5(0x129)),jwt=require('jsonwebtoken'),auth=require(a0_0x5014d5(0x116));function a0_0x2ac3(_0x320882,_0xa1bfe7){const _0x4bbd32=a0_0x4bbd();return a0_0x2ac3=function(_0x2ac350,_0x3edc71){_0x2ac350=_0x2ac350-0x100;let _0x1baa94=_0x4bbd32[_0x2ac350];return _0x1baa94;},a0_0x2ac3(_0x320882,_0xa1bfe7);}router[a0_0x5014d5(0x121)]('/',async(_0x4a7ff5,_0x534a17)=>{const _0x30fb5c=a0_0x5014d5;try{const _0x2e95f7=await master_shop[_0x30fb5c(0x107)]();_0x534a17[_0x30fb5c(0x122)]('login',{'success':_0x4a7ff5['flash'](_0x30fb5c(0x11b)),'errors':_0x4a7ff5[_0x30fb5c(0x101)](_0x30fb5c(0x12f)),'master_shop':_0x2e95f7});}catch(_0x3e2aeb){console[_0x30fb5c(0x10b)](_0x3e2aeb);}}),router[a0_0x5014d5(0x121)](a0_0x5014d5(0x105),async(_0x4158b4,_0x5830e0)=>{const _0x636ef2=a0_0x5014d5;try{const _0x192244=await master_shop['find']();_0x5830e0[_0x636ef2(0x122)](_0x636ef2(0x124),{'success':_0x4158b4[_0x636ef2(0x101)](_0x636ef2(0x11b)),'errors':_0x4158b4[_0x636ef2(0x101)](_0x636ef2(0x12f)),'master_shop':_0x192244});}catch(_0x5bb51c){console[_0x636ef2(0x10b)](_0x5bb51c);}}),router[a0_0x5014d5(0x121)](a0_0x5014d5(0x12e),async(_0x335257,_0x35dd6e)=>{const _0x3e8cdb=a0_0x5014d5;try{const _0xb25469=await master_shop['find']();console[_0x3e8cdb(0x10b)](_0x3e8cdb(0x127),_0xb25469),_0x35dd6e[_0x3e8cdb(0x122)]('login',{'success':_0x335257[_0x3e8cdb(0x101)](_0x3e8cdb(0x11b)),'errors':_0x335257['flash'](_0x3e8cdb(0x12f)),'master_shop':_0xb25469});}catch(_0x172ba0){console[_0x3e8cdb(0x10b)](_0x172ba0);}}),router[a0_0x5014d5(0x111)](a0_0x5014d5(0x12e),async(_0x31529b,_0x418a27)=>{const _0x2bd472=a0_0x5014d5;try{const _0x576f16=_0x31529b[_0x2bd472(0x133)]['email'],_0x38aeb5=await sing_up[_0x2bd472(0x11d)]({'email':_0x576f16});if(!_0x38aeb5)return _0x31529b[_0x2bd472(0x101)]('errors','your\x20email\x20is\x20not\x20register'),_0x418a27[_0x2bd472(0x130)](_0x2bd472(0x12e));var _0x35cc57=_0x2bd472(0x126);if(_0x38aeb5['role']==_0x2bd472(0x104)){const _0xf72fa0=await staff['findOne']({'name':_0x38aeb5[_0x2bd472(0x106)]});if(_0xf72fa0[_0x2bd472(0x117)]=='Disabled')return _0x31529b[_0x2bd472(0x101)](_0x2bd472(0x12f),_0x2bd472(0x131)),_0x418a27['redirect'](_0x2bd472(0x12e));_0x35cc57=_0xf72fa0[_0x2bd472(0x134)];}const _0x1c74b1=_0x31529b[_0x2bd472(0x133)][_0x2bd472(0x12a)],_0x10583d=await bcrypt[_0x2bd472(0x119)](_0x1c74b1,_0x38aeb5[_0x2bd472(0x12a)]);if(_0x10583d==![])return _0x31529b[_0x2bd472(0x101)](_0x2bd472(0x12f),_0x2bd472(0x12d)),_0x418a27[_0x2bd472(0x130)](_0x2bd472(0x12e));const _0x48f54a=jwt[_0x2bd472(0x100)]({'username':_0x38aeb5['username'],'email':_0x38aeb5[_0x2bd472(0x120)],'role':_0x38aeb5[_0x2bd472(0x10c)],'warehouse_category':_0x35cc57},process['env']['secret_key']);_0x418a27[_0x2bd472(0x11e)](_0x2bd472(0x109),_0x48f54a,{'expires':new Date(0xe677d213a700)}),_0x31529b[_0x2bd472(0x101)]('success',_0x2bd472(0x114)),_0x418a27[_0x2bd472(0x130)](_0x2bd472(0x132));}catch(_0x35dbd1){console['log'](_0x35dbd1);}}),router[a0_0x5014d5(0x121)](a0_0x5014d5(0x10f),async(_0x1dcd04,_0xe52c2c)=>{const _0x437a5a=a0_0x5014d5;try{const _0x2f088e=_0x1dcd04[_0x437a5a(0x11c)]['id'],_0x44cb9f=await staff[_0x437a5a(0x113)]({'_id':_0x2f088e});_0x44cb9f[_0x437a5a(0x117)]=='Disabled'&&(_0x1dcd04['flash'](_0x437a5a(0x12f),_0x437a5a(0x131)),_0xe52c2c[_0x437a5a(0x130)]('/staff/view'));const _0x3a43c8=await sing_up[_0x437a5a(0x11d)]({'email':_0x44cb9f[_0x437a5a(0x120)]});var _0xb13303=_0x437a5a(0x126);if(_0x3a43c8['role']=='staff'){const _0x39a92b=await staff[_0x437a5a(0x11d)]({'name':_0x3a43c8['name']});_0xb13303=_0x39a92b[_0x437a5a(0x134)];}const _0x34831e=jwt[_0x437a5a(0x100)]({'username':_0x3a43c8[_0x437a5a(0x123)],'email':_0x3a43c8['email'],'role':_0x3a43c8[_0x437a5a(0x10c)],'warehouse_category':_0xb13303},process[_0x437a5a(0x115)]['secret_key']);_0xe52c2c[_0x437a5a(0x11e)](_0x437a5a(0x109),_0x34831e,{'expires':new Date(0xe677d213a700)}),_0x1dcd04[_0x437a5a(0x101)](_0x437a5a(0x11b),_0x437a5a(0x114)),_0xe52c2c[_0x437a5a(0x130)]('/index');}catch(_0x53c4af){console[_0x437a5a(0x10b)](_0x53c4af);}}),router[a0_0x5014d5(0x121)](a0_0x5014d5(0x112),(_0x59dbb7,_0x151fbc)=>{const _0x1294b7=a0_0x5014d5;_0x151fbc['clearCookie']('jwt'),_0x151fbc[_0x1294b7(0x130)]('/login');}),module['exports']=router;function a0_0x4bbd(){const _0x5e0f04=['username','validate','4922739rfZvLO','All','login\x20master','385202eFxRSj','bcryptjs','password','833916ETNvES','145392xhkUmQ','your\x20password\x20is\x20wrong','/login','errors','redirect','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','/index','body','warehouse_category','sign','flash','Router','20ZDRNVc','staff','/validate','name','find','1043aQQKoi','jwt','3310866ncEsDi','log','role','1186820NHnJAX','4XuVZwU','/staff/:id','22eakhqa','post','/logout','findById','login\x20successfully','env','../middleware/auth','status','39496blJQCi','compare','182AyvEco','success','params','findOne','cookie','5psYruK','email','get','render'];a0_0x4bbd=function(){return _0x5e0f04;};return a0_0x4bbd();}