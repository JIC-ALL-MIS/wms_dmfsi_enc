const a0_0x40f8f6=a0_0xef02;function a0_0xef02(_0x44b378,_0x5a97c4){const _0x5dd60c=a0_0x5dd6();return a0_0xef02=function(_0xef023f,_0x418d8d){_0xef023f=_0xef023f-0x7d;let _0x3a67d0=_0x5dd60c[_0xef023f];return _0x3a67d0;},a0_0xef02(_0x44b378,_0x5a97c4);}function a0_0x5dd6(){const _0x10b7c6=['1034010QxhuDw','$product.bay','name','$product.bin','1119954CrFHbf','$invoice','$primary_code','length','json','$unit','$category','$date','184XOulWG','1116ynPYLP','$product.room_name','path','$name','$product.quantity','express','$paid_amount','Raw\x20Materials','3956634cSdTmp','$finalize','/view','742ExcDrI','1841396lkRmZG','ejs','suppliers_docs','$suppliers','$product.floorlevel','/barcode_scanner','$product','$alertquantity','status','$brand','message','start','893640QnNzGT','$return_data','log','nodemailer','291886lNIpDe','$product_code','../public/language/languages.json','Router','$note','aggregate','$due_amount','suppliers','$maxProdPerUnit','$suppliers_docs','exports','$secondary_unit','end','post','table\x20page','$secondary_code','query','../models/all_models','$batch_code','$_id'];a0_0x5dd6=function(){return _0x10b7c6;};return a0_0x5dd6();}(function(_0x57b5e9,_0x457937){const _0x3d38c8=a0_0xef02,_0x43e34c=_0x57b5e9();while(!![]){try{const _0x576bc7=parseInt(_0x3d38c8(0xb0))/0x1*(-parseInt(_0x3d38c8(0xa5))/0x2)+parseInt(_0x3d38c8(0x98))/0x3+parseInt(_0x3d38c8(0xb1))/0x4+-parseInt(_0x3d38c8(0x80))/0x5+-parseInt(_0x3d38c8(0x9c))/0x6+-parseInt(_0x3d38c8(0x84))/0x7*(-parseInt(_0x3d38c8(0xa4))/0x8)+-parseInt(_0x3d38c8(0xad))/0x9;if(_0x576bc7===_0x457937)break;else _0x43e34c['push'](_0x43e34c['shift']());}catch(_0x37680c){_0x43e34c['push'](_0x43e34c['shift']());}}}(a0_0x5dd6,0x85100));const express=require(a0_0x40f8f6(0xaa)),app=express(),router=express[a0_0x40f8f6(0x87)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x40f8f6(0x95)),auth=require('../middleware/auth'),nodemailer=require(a0_0x40f8f6(0x83));var ejs=require(a0_0x40f8f6(0xb2));const path=require(a0_0x40f8f6(0xa7)),users=require(a0_0x40f8f6(0x86));router['get'](a0_0x40f8f6(0xaf),async(_0x476f62,_0x413ba0)=>{const _0x19a49e=a0_0x40f8f6;try{const _0x5ed570=parseInt(_0x476f62[_0x19a49e(0x94)][_0x19a49e(0x7f)])||0x0,_0x133762=parseInt(_0x476f62[_0x19a49e(0x94)][_0x19a49e(0x90)])||0xa;let _0x57f8e1;_0x57f8e1=await purchases['aggregate']([{'$lookup':{'from':'suppliers','localField':_0x19a49e(0x8b),'foreignField':_0x19a49e(0x9a),'as':_0x19a49e(0xb3)}},{'$unwind':_0x19a49e(0x8d)},{'$unwind':_0x19a49e(0xb7)},{'$group':{'_id':'$_id','invoice':{'$first':_0x19a49e(0x9d)},'suppliers':{'$first':_0x19a49e(0xb4)},'date':{'$first':_0x19a49e(0xa3)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x19a49e(0xa6)},'product':{'$push':_0x19a49e(0xb7)},'note':{'$first':_0x19a49e(0x88)},'paid_amount':{'$first':_0x19a49e(0xab)},'due_amount':{'$first':_0x19a49e(0x8a)},'return_data':{'$first':_0x19a49e(0x81)},'batch_code':{'$first':_0x19a49e(0x96)},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':'$suppliers_docs'},'total_product_quantity':{'$sum':_0x19a49e(0xa9)},'level':{'$addToSet':_0x19a49e(0x99)},'isle':{'$addToSet':_0x19a49e(0x9b)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0x19a49e(0xb5)},'finalize':{'$first':_0x19a49e(0xae)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x5ed570},{'$limit':_0x133762-_0x5ed570}]),_0x413ba0['json'](_0x57f8e1);}catch(_0x1af6c5){console[_0x19a49e(0x82)](_0x19a49e(0x92),_0x1af6c5),_0x413ba0[_0x19a49e(0xb9)](0xc8)['json']({'message':_0x1af6c5[_0x19a49e(0x7e)]});}}),router[a0_0x40f8f6(0x91)](a0_0x40f8f6(0xb6),async(_0x204965,_0x4c4537)=>{const _0x356dbd=a0_0x40f8f6,{product_code:_0x355076}=_0x204965['body'];var _0xe98ee7;const _0x4024a0=await product[_0x356dbd(0x89)]([{'$match':{'primary_code':_0x355076,'product_category':_0x356dbd(0xac)}},{'$group':{'_id':_0x356dbd(0x97),'name':{'$first':_0x356dbd(0xa8)},'category':{'$first':'$category'},'brand':{'$first':_0x356dbd(0x7d)},'unit':{'$first':_0x356dbd(0xa1)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x356dbd(0x85)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x356dbd(0x8c)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x356dbd(0x8f)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x35e450=await product[_0x356dbd(0x89)]([{'$match':{'secondary_code':_0x355076,'product_category':_0x356dbd(0xac)}},{'$group':{'_id':_0x356dbd(0x97),'name':{'$first':_0x356dbd(0xa8)},'category':{'$first':_0x356dbd(0xa2)},'brand':{'$first':_0x356dbd(0x7d)},'unit':{'$first':_0x356dbd(0xa1)},'alertquantity':{'$first':_0x356dbd(0xb8)},'product_code':{'$first':_0x356dbd(0x85)},'primary_code':{'$first':_0x356dbd(0x9e)},'secondary_code':{'$first':_0x356dbd(0x93)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x356dbd(0x8c)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x4024a0[_0x356dbd(0x9f)]>0x0)_0xe98ee7=_0x4024a0;else _0x35e450[_0x356dbd(0x9f)]>0x0&&(_0xe98ee7=_0x35e450);_0x4c4537[_0x356dbd(0xa0)](_0xe98ee7);}),module[a0_0x40f8f6(0x8e)]=router;