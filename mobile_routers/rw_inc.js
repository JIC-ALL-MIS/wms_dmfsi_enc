const a0_0x18d802=a0_0x2f17;(function(_0x425323,_0x2069f6){const _0x3e0194=a0_0x2f17,_0x136f9b=_0x425323();while(!![]){try{const _0xe6983e=-parseInt(_0x3e0194(0xe1))/0x1*(-parseInt(_0x3e0194(0xc5))/0x2)+-parseInt(_0x3e0194(0xe0))/0x3+parseInt(_0x3e0194(0xe2))/0x4*(parseInt(_0x3e0194(0xc2))/0x5)+-parseInt(_0x3e0194(0xd9))/0x6+parseInt(_0x3e0194(0xbb))/0x7*(parseInt(_0x3e0194(0xed))/0x8)+-parseInt(_0x3e0194(0xdd))/0x9+parseInt(_0x3e0194(0xc8))/0xa;if(_0xe6983e===_0x2069f6)break;else _0x136f9b['push'](_0x136f9b['shift']());}catch(_0x1d51e0){_0x136f9b['push'](_0x136f9b['shift']());}}}(a0_0x2553,0x7857e));function a0_0x2553(){const _0x127a17=['path','../middleware/auth','$product.bay','$secondary_code','575085LHeeuD','$category','$_id','nodemailer','$product.quantity','$brand','log','480sBeXxc','length','body','718222cAFcdv','$date','$maxStocks','8836630vOeCOs','$maxProdPerUnit','/view','Raw\x20Materials','$batch_code','$name','start','message','$primary_code','$unit','suppliers_docs','$suppliers_docs','$product','$invoice','$product_code','$alertquantity','exports','2894160lcePRO','aggregate','name','status','8795439flRgnQ','$note','$warehouse_name','591360dWXyKm','1zEQEBF','20672umEKFW','../models/all_models','json','/barcode_scanner','suppliers','$product.bin','$secondary_unit','$expiry_date','ejs','$product.room_name','$product.floorlevel','40cScwFh','query','../public/language/languages.json'];a0_0x2553=function(){return _0x127a17;};return a0_0x2553();}function a0_0x2f17(_0x1d5bcb,_0xca1448){const _0x2553c5=a0_0x2553();return a0_0x2f17=function(_0x2f17a6,_0x366f30){_0x2f17a6=_0x2f17a6-0xb6;let _0x3e9b5d=_0x2553c5[_0x2f17a6];return _0x3e9b5d;},a0_0x2f17(_0x1d5bcb,_0xca1448);}const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x18d802(0xe3)),auth=require(a0_0x18d802(0xb8)),nodemailer=require(a0_0x18d802(0xbe));var ejs=require(a0_0x18d802(0xea));const path=require(a0_0x18d802(0xb7)),users=require(a0_0x18d802(0xb6));router['get'](a0_0x18d802(0xca),async(_0x252e50,_0x580d70)=>{const _0x42b0a3=a0_0x18d802;try{const _0x8a8222=parseInt(_0x252e50[_0x42b0a3(0xee)][_0x42b0a3(0xce)])||0x0,_0x22f1de=parseInt(_0x252e50[_0x42b0a3(0xee)]['end'])||0xa;let _0x4497a8;_0x4497a8=await purchases[_0x42b0a3(0xda)]([{'$lookup':{'from':'suppliers','localField':_0x42b0a3(0xe6),'foreignField':_0x42b0a3(0xdb),'as':_0x42b0a3(0xd2)}},{'$unwind':_0x42b0a3(0xd3)},{'$unwind':_0x42b0a3(0xd4)},{'$group':{'_id':_0x42b0a3(0xbd),'invoice':{'$first':_0x42b0a3(0xd5)},'suppliers':{'$first':'$suppliers'},'date':{'$first':_0x42b0a3(0xc6)},'warehouse_name':{'$first':_0x42b0a3(0xdf)},'room':{'$addToSet':_0x42b0a3(0xeb)},'product':{'$push':_0x42b0a3(0xd4)},'note':{'$first':_0x42b0a3(0xde)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':'$due_amount'},'return_data':{'$first':'$return_data'},'batch_code':{'$first':_0x42b0a3(0xcc)},'expiry_date':{'$first':_0x42b0a3(0xe9)},'suppliers_docs':{'$first':_0x42b0a3(0xd3)},'total_product_quantity':{'$sum':_0x42b0a3(0xbf)},'level':{'$addToSet':_0x42b0a3(0xb9)},'isle':{'$addToSet':_0x42b0a3(0xe7)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0x42b0a3(0xec)},'finalize':{'$first':'$finalize'}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x8a8222},{'$limit':_0x22f1de-_0x8a8222}]),_0x580d70[_0x42b0a3(0xe4)](_0x4497a8);}catch(_0x394a28){console[_0x42b0a3(0xc1)]('table\x20page',_0x394a28),_0x580d70[_0x42b0a3(0xdc)](0xc8)['json']({'message':_0x394a28[_0x42b0a3(0xcf)]});}}),router['post'](a0_0x18d802(0xe5),async(_0x545614,_0x57d5af)=>{const _0x3ed88a=a0_0x18d802,{product_code:_0x5f31ae}=_0x545614[_0x3ed88a(0xc4)];var _0x1ac6a0;const _0x2e81b2=await product['aggregate']([{'$match':{'primary_code':_0x5f31ae,'product_category':_0x3ed88a(0xcb)}},{'$group':{'_id':_0x3ed88a(0xbd),'name':{'$first':_0x3ed88a(0xcd)},'category':{'$first':_0x3ed88a(0xbc)},'brand':{'$first':_0x3ed88a(0xc0)},'unit':{'$first':_0x3ed88a(0xd1)},'alertquantity':{'$first':_0x3ed88a(0xd7)},'product_code':{'$first':_0x3ed88a(0xd6)},'primary_code':{'$first':_0x3ed88a(0xd0)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x3ed88a(0xc7)},'maxProdPerUnit':{'$first':_0x3ed88a(0xc9)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x3ed88a(0xe8)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0xcfd395=await product['aggregate']([{'$match':{'secondary_code':_0x5f31ae,'product_category':_0x3ed88a(0xcb)}},{'$group':{'_id':'$_id','name':{'$first':_0x3ed88a(0xcd)},'category':{'$first':_0x3ed88a(0xbc)},'brand':{'$first':_0x3ed88a(0xc0)},'unit':{'$first':_0x3ed88a(0xd1)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x3ed88a(0xd6)},'primary_code':{'$first':_0x3ed88a(0xd0)},'secondary_code':{'$first':_0x3ed88a(0xba)},'maxStocks':{'$first':_0x3ed88a(0xc7)},'maxProdPerUnit':{'$first':_0x3ed88a(0xc9)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x3ed88a(0xe8)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x2e81b2[_0x3ed88a(0xc3)]>0x0)_0x1ac6a0=_0x2e81b2;else _0xcfd395[_0x3ed88a(0xc3)]>0x0&&(_0x1ac6a0=_0xcfd395);_0x57d5af['json'](_0x1ac6a0);}),module[a0_0x18d802(0xd8)]=router;