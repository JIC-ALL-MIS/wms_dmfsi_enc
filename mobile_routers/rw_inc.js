const a0_0x67c224=a0_0x6691;function a0_0x2ce8(){const _0x3ba42b=['846QHzRnM','name','/barcode_scanner','query','body','$note','$due_amount','start','$maxStocks','$paid_amount','$secondary_code','../models/all_models','2218520DrDXlY','14tnoarp','suppliers_docs','get','$unit','$product.quantity','length','nodemailer','$product.bin','17805LMxOYw','$warehouse_name','log','$finalize','$category','/view','aggregate','12469512BqvzHp','../public/language/languages.json','$brand','137yuIzLs','$product','$maxProdPerUnit','$name','76490rVifAk','$product.floorlevel','$_id','1608618VnZlvx','$primary_code','$invoice','ejs','Raw\x20Materials','5882HJLXkO','$product_code','$date','suppliers','$expiry_date','$product.room_name','340rNeoIf','end','$suppliers_docs','post','$batch_code','67317cXiCwF','$secondary_unit','exports'];a0_0x2ce8=function(){return _0x3ba42b;};return a0_0x2ce8();}function a0_0x6691(_0x257fe0,_0x23e438){const _0x2ce80e=a0_0x2ce8();return a0_0x6691=function(_0x6691da,_0x14b0a3){_0x6691da=_0x6691da-0x19e;let _0x58625=_0x2ce80e[_0x6691da];return _0x58625;},a0_0x6691(_0x257fe0,_0x23e438);}(function(_0x434ca6,_0x5219f3){const _0x196230=a0_0x6691,_0x5cc230=_0x434ca6();while(!![]){try{const _0x4d20bd=-parseInt(_0x196230(0x1a6))/0x1*(-parseInt(_0x196230(0x1b2))/0x2)+-parseInt(_0x196230(0x1bd))/0x3+parseInt(_0x196230(0x1b8))/0x4*(parseInt(_0x196230(0x1d5))/0x5)+-parseInt(_0x196230(0x1ad))/0x6+parseInt(_0x196230(0x1cd))/0x7*(parseInt(_0x196230(0x1cc))/0x8)+-parseInt(_0x196230(0x1c0))/0x9*(-parseInt(_0x196230(0x1aa))/0xa)+-parseInt(_0x196230(0x1a3))/0xb;if(_0x4d20bd===_0x5219f3)break;else _0x5cc230['push'](_0x5cc230['shift']());}catch(_0x155a98){_0x5cc230['push'](_0x5cc230['shift']());}}}(a0_0x2ce8,0x87860));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x67c224(0x1cb)),auth=require('../middleware/auth'),nodemailer=require(a0_0x67c224(0x1d3));var ejs=require(a0_0x67c224(0x1b0));const path=require('path'),users=require(a0_0x67c224(0x1a4));router[a0_0x67c224(0x1cf)](a0_0x67c224(0x1a1),async(_0x5c0995,_0x43f936)=>{const _0xafd626=a0_0x67c224;try{const _0xf6d299=parseInt(_0x5c0995[_0xafd626(0x1c3)][_0xafd626(0x1c7)])||0x0,_0x8bd796=parseInt(_0x5c0995['query'][_0xafd626(0x1b9)])||0xa;let _0x3401e4;_0x3401e4=await purchases[_0xafd626(0x1a2)]([{'$lookup':{'from':_0xafd626(0x1b5),'localField':_0xafd626(0x1b5),'foreignField':_0xafd626(0x1c1),'as':_0xafd626(0x1ce)}},{'$unwind':_0xafd626(0x1ba)},{'$unwind':'$product'},{'$group':{'_id':_0xafd626(0x1ac),'invoice':{'$first':_0xafd626(0x1af)},'suppliers':{'$first':'$suppliers'},'date':{'$first':_0xafd626(0x1b4)},'warehouse_name':{'$first':_0xafd626(0x1d6)},'room':{'$addToSet':_0xafd626(0x1b7)},'product':{'$push':_0xafd626(0x1a7)},'note':{'$first':_0xafd626(0x1c5)},'paid_amount':{'$first':_0xafd626(0x1c9)},'due_amount':{'$first':_0xafd626(0x1c6)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':_0xafd626(0x1bc)},'expiry_date':{'$first':_0xafd626(0x1b6)},'suppliers_docs':{'$first':_0xafd626(0x1ba)},'total_product_quantity':{'$sum':_0xafd626(0x1d1)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':_0xafd626(0x1d4)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0xafd626(0x1ab)},'finalize':{'$first':_0xafd626(0x19f)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0xf6d299},{'$limit':_0x8bd796-_0xf6d299}]),_0x43f936['json'](_0x3401e4);}catch(_0x40b39f){console[_0xafd626(0x19e)]('table\x20page',_0x40b39f),_0x43f936['status'](0xc8)['json']({'message':_0x40b39f['message']});}}),router[a0_0x67c224(0x1bb)](a0_0x67c224(0x1c2),async(_0x507e3b,_0x17cccd)=>{const _0x430f34=a0_0x67c224,{product_code:_0x34946f}=_0x507e3b[_0x430f34(0x1c4)];var _0x534aec;const _0x1d9e91=await product[_0x430f34(0x1a2)]([{'$match':{'primary_code':_0x34946f,'product_category':_0x430f34(0x1b1)}},{'$group':{'_id':'$_id','name':{'$first':_0x430f34(0x1a9)},'category':{'$first':_0x430f34(0x1a0)},'brand':{'$first':_0x430f34(0x1a5)},'unit':{'$first':_0x430f34(0x1d0)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x430f34(0x1b3)},'primary_code':{'$first':_0x430f34(0x1ae)},'secondary_code':{'$first':_0x430f34(0x1ca)},'maxStocks':{'$first':_0x430f34(0x1c8)},'maxProdPerUnit':{'$first':_0x430f34(0x1a8)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x430f34(0x1be)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x3c0d27=await product['aggregate']([{'$match':{'secondary_code':_0x34946f,'product_category':_0x430f34(0x1b1)}},{'$group':{'_id':_0x430f34(0x1ac),'name':{'$first':'$name'},'category':{'$first':'$category'},'brand':{'$first':_0x430f34(0x1a5)},'unit':{'$first':_0x430f34(0x1d0)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x430f34(0x1b3)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x430f34(0x1ca)},'maxStocks':{'$first':_0x430f34(0x1c8)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x430f34(0x1be)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x1d9e91['length']>0x0)_0x534aec=_0x1d9e91;else _0x3c0d27[_0x430f34(0x1d2)]>0x0&&(_0x534aec=_0x3c0d27);_0x17cccd['json'](_0x534aec);}),module[a0_0x67c224(0x1bf)]=router;