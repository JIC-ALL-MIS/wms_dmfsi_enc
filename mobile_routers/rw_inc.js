const a0_0x457824=a0_0x2035;(function(_0x1ee97d,_0x421c66){const _0x130a87=a0_0x2035,_0x2940a5=_0x1ee97d();while(!![]){try{const _0x5d550f=parseInt(_0x130a87(0x16d))/0x1+-parseInt(_0x130a87(0x175))/0x2+-parseInt(_0x130a87(0x16f))/0x3*(parseInt(_0x130a87(0x161))/0x4)+-parseInt(_0x130a87(0x15b))/0x5*(parseInt(_0x130a87(0x147))/0x6)+-parseInt(_0x130a87(0x143))/0x7+-parseInt(_0x130a87(0x144))/0x8*(-parseInt(_0x130a87(0x146))/0x9)+parseInt(_0x130a87(0x13e))/0xa*(parseInt(_0x130a87(0x174))/0xb);if(_0x5d550f===_0x421c66)break;else _0x2940a5['push'](_0x2940a5['shift']());}catch(_0x59fc6f){_0x2940a5['push'](_0x2940a5['shift']());}}}(a0_0x4cdd,0x70a70));function a0_0x4cdd(){const _0x358b74=['5438799NFDunT','498CsaVbF','end','$suppliers_docs','suppliers','$product.floorlevel','$finalize','body','$maxStocks','$name','Raw\x20Materials','$note','nodemailer','../middleware/auth','$return_data','$product.quantity','../public/language/languages.json','/barcode_scanner','status','log','$product.room_name','15110VmImgz','$batch_code','ejs','/view','$alertquantity','$_id','4HdyIsW','$product','length','Router','$unit','start','$brand','aggregate','express','../models/all_models','$product.type','$secondary_unit','814027zPGsXY','table\x20page','743079efHfdy','$product.bin','post','$paid_amount','$category','407duHPZT','784590JvqJgb','$invoice','$secondary_code','$product_code','json','query','$expiry_date','name','$warehouse_name','162290DfbREr','$primary_code','path','$due_amount','$maxProdPerUnit','4666011bXAwyG','8mcWWOL','exports'];a0_0x4cdd=function(){return _0x358b74;};return a0_0x4cdd();}const express=require(a0_0x457824(0x169)),app=express(),router=express[a0_0x457824(0x164)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x457824(0x16a)),auth=require(a0_0x457824(0x153)),nodemailer=require(a0_0x457824(0x152));var ejs=require(a0_0x457824(0x15d));const path=require(a0_0x457824(0x140)),users=require(a0_0x457824(0x156));function a0_0x2035(_0x5bf38c,_0x1b3324){const _0x4cddf6=a0_0x4cdd();return a0_0x2035=function(_0x20354f,_0x19971a){_0x20354f=_0x20354f-0x138;let _0x38c4df=_0x4cddf6[_0x20354f];return _0x38c4df;},a0_0x2035(_0x5bf38c,_0x1b3324);}router['get'](a0_0x457824(0x15e),async(_0x41ff82,_0x3e0f94)=>{const _0x4c2d4c=a0_0x457824;try{const _0x1a41a9=parseInt(_0x41ff82[_0x4c2d4c(0x13a)][_0x4c2d4c(0x166)])||0x0,_0x46dd32=parseInt(_0x41ff82['query'][_0x4c2d4c(0x148)])||0xa;let _0x133a2d;_0x133a2d=await purchases[_0x4c2d4c(0x168)]([{'$lookup':{'from':_0x4c2d4c(0x14a),'localField':'suppliers','foreignField':_0x4c2d4c(0x13c),'as':'suppliers_docs'}},{'$unwind':_0x4c2d4c(0x149)},{'$unwind':_0x4c2d4c(0x162)},{'$group':{'_id':_0x4c2d4c(0x160),'invoice':{'$first':_0x4c2d4c(0x176)},'suppliers':{'$first':'$suppliers'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x4c2d4c(0x13d)},'room':{'$addToSet':_0x4c2d4c(0x15a)},'product':{'$push':_0x4c2d4c(0x162)},'note':{'$first':_0x4c2d4c(0x151)},'paid_amount':{'$first':_0x4c2d4c(0x172)},'due_amount':{'$first':_0x4c2d4c(0x141)},'return_data':{'$first':_0x4c2d4c(0x154)},'batch_code':{'$first':_0x4c2d4c(0x15c)},'expiry_date':{'$first':_0x4c2d4c(0x13b)},'suppliers_docs':{'$first':_0x4c2d4c(0x149)},'total_product_quantity':{'$sum':_0x4c2d4c(0x155)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':_0x4c2d4c(0x170)},'type':{'$addToSet':_0x4c2d4c(0x16b)},'floorlevel':{'$addToSet':_0x4c2d4c(0x14b)},'finalize':{'$first':_0x4c2d4c(0x14c)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x1a41a9},{'$limit':_0x46dd32-_0x1a41a9}]),_0x3e0f94[_0x4c2d4c(0x139)](_0x133a2d);}catch(_0x144cce){console[_0x4c2d4c(0x159)](_0x4c2d4c(0x16e),_0x144cce),_0x3e0f94[_0x4c2d4c(0x158)](0xc8)[_0x4c2d4c(0x139)]({'message':_0x144cce['message']});}}),router[a0_0x457824(0x171)](a0_0x457824(0x157),async(_0x4be5ed,_0x451187)=>{const _0x5a1e48=a0_0x457824,{product_code:_0x42b5ab}=_0x4be5ed[_0x5a1e48(0x14d)];var _0x4816a1;const _0x4233f0=await product[_0x5a1e48(0x168)]([{'$match':{'primary_code':_0x42b5ab,'product_category':_0x5a1e48(0x150)}},{'$group':{'_id':_0x5a1e48(0x160),'name':{'$first':'$name'},'category':{'$first':'$category'},'brand':{'$first':_0x5a1e48(0x167)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x5a1e48(0x15f)},'product_code':{'$first':_0x5a1e48(0x138)},'primary_code':{'$first':_0x5a1e48(0x13f)},'secondary_code':{'$first':_0x5a1e48(0x177)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x5a1e48(0x142)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x5a1e48(0x16c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x40d0e3=await product[_0x5a1e48(0x168)]([{'$match':{'secondary_code':_0x42b5ab,'product_category':'Raw\x20Materials'}},{'$group':{'_id':'$_id','name':{'$first':_0x5a1e48(0x14f)},'category':{'$first':_0x5a1e48(0x173)},'brand':{'$first':_0x5a1e48(0x167)},'unit':{'$first':_0x5a1e48(0x165)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x5a1e48(0x138)},'primary_code':{'$first':_0x5a1e48(0x13f)},'secondary_code':{'$first':_0x5a1e48(0x177)},'maxStocks':{'$first':_0x5a1e48(0x14e)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x5a1e48(0x16c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x4233f0[_0x5a1e48(0x163)]>0x0)_0x4816a1=_0x4233f0;else _0x40d0e3[_0x5a1e48(0x163)]>0x0&&(_0x4816a1=_0x40d0e3);_0x451187[_0x5a1e48(0x139)](_0x4816a1);}),module[a0_0x457824(0x145)]=router;