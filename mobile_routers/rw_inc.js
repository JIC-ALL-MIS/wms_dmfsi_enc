const a0_0x49919b=a0_0x2803;(function(_0x85ab21,_0x18a3fc){const _0x148287=a0_0x2803,_0x58d1a8=_0x85ab21();while(!![]){try{const _0x30e35b=parseInt(_0x148287(0x147))/0x1*(-parseInt(_0x148287(0x156))/0x2)+parseInt(_0x148287(0x148))/0x3+-parseInt(_0x148287(0x131))/0x4+parseInt(_0x148287(0x150))/0x5+parseInt(_0x148287(0x13e))/0x6*(-parseInt(_0x148287(0x15a))/0x7)+parseInt(_0x148287(0x136))/0x8*(parseInt(_0x148287(0x15c))/0x9)+parseInt(_0x148287(0x151))/0xa*(parseInt(_0x148287(0x14f))/0xb);if(_0x30e35b===_0x18a3fc)break;else _0x58d1a8['push'](_0x58d1a8['shift']());}catch(_0x1c21b3){_0x58d1a8['push'](_0x58d1a8['shift']());}}}(a0_0x42fc,0x66ac5));const express=require(a0_0x49919b(0x123)),app=express(),router=express[a0_0x49919b(0x142)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x49919b(0x158)),auth=require(a0_0x49919b(0x15e)),nodemailer=require(a0_0x49919b(0x14b));var ejs=require(a0_0x49919b(0x145));function a0_0x2803(_0x10bbc8,_0x801a8f){const _0x42fc30=a0_0x42fc();return a0_0x2803=function(_0x28033f,_0x3cf5d4){_0x28033f=_0x28033f-0x123;let _0x843a6b=_0x42fc30[_0x28033f];return _0x843a6b;},a0_0x2803(_0x10bbc8,_0x801a8f);}const path=require(a0_0x49919b(0x13c)),users=require(a0_0x49919b(0x14d));router[a0_0x49919b(0x12e)](a0_0x49919b(0x141),async(_0x2917fc,_0x12f479)=>{const _0x4bb5b1=a0_0x49919b;try{const _0x21cd06=parseInt(_0x2917fc[_0x4bb5b1(0x154)][_0x4bb5b1(0x155)])||0x0,_0x4095c1=parseInt(_0x2917fc[_0x4bb5b1(0x154)]['end'])||0xa;let _0x2b4e37;_0x2b4e37=await purchases[_0x4bb5b1(0x14e)]([{'$lookup':{'from':_0x4bb5b1(0x124),'localField':_0x4bb5b1(0x124),'foreignField':_0x4bb5b1(0x132),'as':'suppliers_docs'}},{'$unwind':_0x4bb5b1(0x138)},{'$unwind':_0x4bb5b1(0x13d)},{'$group':{'_id':_0x4bb5b1(0x12b),'invoice':{'$first':_0x4bb5b1(0x143)},'suppliers':{'$first':_0x4bb5b1(0x153)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x4bb5b1(0x14a)},'room':{'$addToSet':_0x4bb5b1(0x144)},'product':{'$push':_0x4bb5b1(0x13d)},'note':{'$first':_0x4bb5b1(0x13a)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':'$due_amount'},'return_data':{'$first':_0x4bb5b1(0x128)},'batch_code':{'$first':_0x4bb5b1(0x146)},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':_0x4bb5b1(0x138)},'total_product_quantity':{'$sum':_0x4bb5b1(0x12f)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':_0x4bb5b1(0x149)},'type':{'$addToSet':_0x4bb5b1(0x13b)},'floorlevel':{'$addToSet':_0x4bb5b1(0x13f)},'finalize':{'$first':_0x4bb5b1(0x135)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x21cd06},{'$limit':_0x4095c1-_0x21cd06}]),_0x12f479[_0x4bb5b1(0x130)](_0x2b4e37);}catch(_0x38d817){console['log'](_0x4bb5b1(0x133),_0x38d817),_0x12f479[_0x4bb5b1(0x157)](0xc8)['json']({'message':_0x38d817[_0x4bb5b1(0x152)]});}}),router[a0_0x49919b(0x134)](a0_0x49919b(0x125),async(_0x875688,_0x1bc751)=>{const _0x2b14e9=a0_0x49919b,{product_code:_0x306519}=_0x875688[_0x2b14e9(0x129)];var _0x40995e;const _0x5233a8=await product[_0x2b14e9(0x14e)]([{'$match':{'primary_code':_0x306519,'product_category':_0x2b14e9(0x137)}},{'$group':{'_id':_0x2b14e9(0x12b),'name':{'$first':'$name'},'category':{'$first':'$category'},'brand':{'$first':'$brand'},'unit':{'$first':_0x2b14e9(0x12c)},'alertquantity':{'$first':_0x2b14e9(0x12d)},'product_code':{'$first':_0x2b14e9(0x15b)},'primary_code':{'$first':_0x2b14e9(0x15d)},'secondary_code':{'$first':_0x2b14e9(0x12a)},'maxStocks':{'$first':_0x2b14e9(0x127)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x2b14e9(0x14c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x592ead=await product['aggregate']([{'$match':{'secondary_code':_0x306519,'product_category':_0x2b14e9(0x137)}},{'$group':{'_id':_0x2b14e9(0x12b),'name':{'$first':_0x2b14e9(0x140)},'category':{'$first':'$category'},'brand':{'$first':_0x2b14e9(0x159)},'unit':{'$first':_0x2b14e9(0x12c)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x2b14e9(0x15b)},'primary_code':{'$first':_0x2b14e9(0x15d)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x2b14e9(0x126)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x2b14e9(0x14c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x5233a8['length']>0x0)_0x40995e=_0x5233a8;else _0x592ead[_0x2b14e9(0x139)]>0x0&&(_0x40995e=_0x592ead);_0x1bc751[_0x2b14e9(0x130)](_0x40995e);}),module['exports']=router;function a0_0x42fc(){const _0x39fbf1=['$maxStocks','$return_data','body','$secondary_code','$_id','$unit','$alertquantity','get','$product.quantity','json','2245708aTbEgb','name','table\x20page','post','$finalize','290584eNQrHL','Raw\x20Materials','$suppliers_docs','length','$note','$product.type','path','$product','82680ksxAgc','$product.floorlevel','$name','/view','Router','$invoice','$product.room_name','ejs','$batch_code','1dwKiTm','1728762fTjwnx','$product.bin','$warehouse_name','nodemailer','$secondary_unit','../public/language/languages.json','aggregate','176VDclCe','4173180LtRtFf','9430HtKLPN','message','$suppliers','query','start','1391442xoBAoI','status','../models/all_models','$brand','112XpONcw','$product_code','117JUkryE','$primary_code','../middleware/auth','express','suppliers','/barcode_scanner','$maxProdPerUnit'];a0_0x42fc=function(){return _0x39fbf1;};return a0_0x42fc();}