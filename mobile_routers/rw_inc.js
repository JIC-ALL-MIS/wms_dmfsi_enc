const a0_0x4288fb=a0_0x52a8;(function(_0x9f6021,_0x5dc2af){const _0x50767b=a0_0x52a8,_0x4c7618=_0x9f6021();while(!![]){try{const _0x14bb7a=parseInt(_0x50767b(0xe8))/0x1+parseInt(_0x50767b(0xce))/0x2+-parseInt(_0x50767b(0xb8))/0x3*(parseInt(_0x50767b(0xc4))/0x4)+-parseInt(_0x50767b(0xe2))/0x5*(-parseInt(_0x50767b(0xe9))/0x6)+-parseInt(_0x50767b(0xbd))/0x7*(parseInt(_0x50767b(0xe6))/0x8)+parseInt(_0x50767b(0xc7))/0x9*(-parseInt(_0x50767b(0xd7))/0xa)+-parseInt(_0x50767b(0xb3))/0xb*(-parseInt(_0x50767b(0xe3))/0xc);if(_0x14bb7a===_0x5dc2af)break;else _0x4c7618['push'](_0x4c7618['shift']());}catch(_0x47acbb){_0x4c7618['push'](_0x4c7618['shift']());}}}(a0_0x5a3a,0x9489b));const express=require(a0_0x4288fb(0xea)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),nodemailer=require('nodemailer');var ejs=require(a0_0x4288fb(0xc9));function a0_0x52a8(_0x58e374,_0x3f4e5e){const _0x5a3afa=a0_0x5a3a();return a0_0x52a8=function(_0x52a8d9,_0x2ffa31){_0x52a8d9=_0x52a8d9-0xad;let _0x11d0f9=_0x5a3afa[_0x52a8d9];return _0x11d0f9;},a0_0x52a8(_0x58e374,_0x3f4e5e);}const path=require(a0_0x4288fb(0xb1)),users=require(a0_0x4288fb(0xcf));function a0_0x5a3a(){const _0x24b86e=['suppliers','$suppliers','$secondary_code','$batch_code','390714UnPKHj','../public/language/languages.json','table\x20page','$alertquantity','suppliers_docs','$suppliers_docs','length','$product.quantity','$category','10bHCiSP','body','$maxProdPerUnit','/view','$return_data','$product_code','$paid_amount','$note','$product.floorlevel','$maxStocks','$expiry_date','5ixOSTS','60OVBZNT','/barcode_scanner','get','8SITzxD','$invoice','1056332EQBmvp','5337510nCgjmx','express','log','json','$secondary_unit','$finalize','path','Raw\x20Materials','1173447PJDfTf','query','$product.bay','$unit','$product','118647sdsuXB','$brand','$name','$warehouse_name','start','4033295DDnLpv','$product.bin','$product.type','exports','post','status','$primary_code','120cnWSzQ','aggregate','$due_amount','2732337PsXnic','$_id','ejs'];a0_0x5a3a=function(){return _0x24b86e;};return a0_0x5a3a();}router[a0_0x4288fb(0xe5)](a0_0x4288fb(0xda),async(_0x568a2c,_0x49228d)=>{const _0x373d28=a0_0x4288fb;try{const _0x3254ac=parseInt(_0x568a2c[_0x373d28(0xb4)][_0x373d28(0xbc)])||0x0,_0x75db0=parseInt(_0x568a2c[_0x373d28(0xb4)]['end'])||0xa;let _0x495192;_0x495192=await purchases[_0x373d28(0xc5)]([{'$lookup':{'from':'suppliers','localField':_0x373d28(0xca),'foreignField':'name','as':_0x373d28(0xd2)}},{'$unwind':'$suppliers_docs'},{'$unwind':_0x373d28(0xb7)},{'$group':{'_id':_0x373d28(0xc8),'invoice':{'$first':_0x373d28(0xe7)},'suppliers':{'$first':_0x373d28(0xcb)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x373d28(0xbb)},'room':{'$addToSet':'$product.room_name'},'product':{'$push':_0x373d28(0xb7)},'note':{'$first':_0x373d28(0xde)},'paid_amount':{'$first':_0x373d28(0xdd)},'due_amount':{'$first':_0x373d28(0xc6)},'return_data':{'$first':_0x373d28(0xdb)},'batch_code':{'$first':_0x373d28(0xcd)},'expiry_date':{'$first':_0x373d28(0xe1)},'suppliers_docs':{'$first':_0x373d28(0xd3)},'total_product_quantity':{'$sum':_0x373d28(0xd5)},'level':{'$addToSet':_0x373d28(0xb5)},'isle':{'$addToSet':_0x373d28(0xbe)},'type':{'$addToSet':_0x373d28(0xbf)},'floorlevel':{'$addToSet':_0x373d28(0xdf)},'finalize':{'$first':_0x373d28(0xb0)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x3254ac},{'$limit':_0x75db0-_0x3254ac}]),_0x49228d[_0x373d28(0xae)](_0x495192);}catch(_0x40b9d2){console[_0x373d28(0xad)](_0x373d28(0xd0),_0x40b9d2),_0x49228d[_0x373d28(0xc2)](0xc8)[_0x373d28(0xae)]({'message':_0x40b9d2['message']});}}),router[a0_0x4288fb(0xc1)](a0_0x4288fb(0xe4),async(_0x4f069c,_0x4f143e)=>{const _0x8080ae=a0_0x4288fb,{product_code:_0x2285f7}=_0x4f069c[_0x8080ae(0xd8)];var _0x580f48;const _0x23178e=await product[_0x8080ae(0xc5)]([{'$match':{'primary_code':_0x2285f7,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x8080ae(0xc8),'name':{'$first':_0x8080ae(0xba)},'category':{'$first':_0x8080ae(0xd6)},'brand':{'$first':_0x8080ae(0xb9)},'unit':{'$first':_0x8080ae(0xb6)},'alertquantity':{'$first':_0x8080ae(0xd1)},'product_code':{'$first':_0x8080ae(0xdc)},'primary_code':{'$first':_0x8080ae(0xc3)},'secondary_code':{'$first':_0x8080ae(0xcc)},'maxStocks':{'$first':_0x8080ae(0xe0)},'maxProdPerUnit':{'$first':_0x8080ae(0xd9)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x8080ae(0xaf)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x5652c9=await product[_0x8080ae(0xc5)]([{'$match':{'secondary_code':_0x2285f7,'product_category':_0x8080ae(0xb2)}},{'$group':{'_id':'$_id','name':{'$first':_0x8080ae(0xba)},'category':{'$first':'$category'},'brand':{'$first':'$brand'},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x8080ae(0xd1)},'product_code':{'$first':_0x8080ae(0xdc)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x8080ae(0xcc)},'maxStocks':{'$first':_0x8080ae(0xe0)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x8080ae(0xaf)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x23178e[_0x8080ae(0xd4)]>0x0)_0x580f48=_0x23178e;else _0x5652c9[_0x8080ae(0xd4)]>0x0&&(_0x580f48=_0x5652c9);_0x4f143e[_0x8080ae(0xae)](_0x580f48);}),module[a0_0x4288fb(0xc0)]=router;