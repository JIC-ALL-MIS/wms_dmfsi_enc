const a0_0x4a0ba0=a0_0x4d71;(function(_0x1b425d,_0x1a3901){const _0x86981b=a0_0x4d71,_0x5ad60f=_0x1b425d();while(!![]){try{const _0xef86fd=parseInt(_0x86981b(0x1c3))/0x1+-parseInt(_0x86981b(0x1aa))/0x2+-parseInt(_0x86981b(0x1cd))/0x3*(-parseInt(_0x86981b(0x1a2))/0x4)+-parseInt(_0x86981b(0x1c8))/0x5+parseInt(_0x86981b(0x1ab))/0x6+-parseInt(_0x86981b(0x19a))/0x7+-parseInt(_0x86981b(0x1be))/0x8*(parseInt(_0x86981b(0x196))/0x9);if(_0xef86fd===_0x1a3901)break;else _0x5ad60f['push'](_0x5ad60f['shift']());}catch(_0x4877ad){_0x5ad60f['push'](_0x5ad60f['shift']());}}}(a0_0x3f6c,0x42c1e));const express=require(a0_0x4a0ba0(0x1a1)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x4a0ba0(0x194)),auth=require(a0_0x4a0ba0(0x1ae)),nodemailer=require(a0_0x4a0ba0(0x1c4));var ejs=require(a0_0x4a0ba0(0x1ac));function a0_0x4d71(_0x9145b4,_0x24fb95){const _0x3f6c0f=a0_0x3f6c();return a0_0x4d71=function(_0x4d71dc,_0x599aa8){_0x4d71dc=_0x4d71dc-0x193;let _0x408a46=_0x3f6c0f[_0x4d71dc];return _0x408a46;},a0_0x4d71(_0x9145b4,_0x24fb95);}const path=require(a0_0x4a0ba0(0x1c1)),users=require('../public/language/languages.json');router[a0_0x4a0ba0(0x19d)](a0_0x4a0ba0(0x19b),async(_0x1062ee,_0xc66874)=>{const _0x3933ff=a0_0x4a0ba0;try{const _0x2ad2e7=parseInt(_0x1062ee[_0x3933ff(0x199)][_0x3933ff(0x198)])||0x0,_0x54ed47=parseInt(_0x1062ee['query']['end'])||0xa;let _0x456dac;_0x456dac=await purchases['aggregate']([{'$lookup':{'from':_0x3933ff(0x1a8),'localField':_0x3933ff(0x1a8),'foreignField':_0x3933ff(0x1ad),'as':'suppliers_docs'}},{'$unwind':_0x3933ff(0x19c)},{'$unwind':_0x3933ff(0x1b4)},{'$group':{'_id':_0x3933ff(0x1a6),'invoice':{'$first':_0x3933ff(0x1bc)},'suppliers':{'$first':_0x3933ff(0x1af)},'date':{'$first':_0x3933ff(0x19f)},'warehouse_name':{'$first':_0x3933ff(0x1a5)},'room':{'$addToSet':_0x3933ff(0x1b7)},'product':{'$push':_0x3933ff(0x1b4)},'note':{'$first':_0x3933ff(0x1b8)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x3933ff(0x1a0)},'return_data':{'$first':_0x3933ff(0x1c0)},'batch_code':{'$first':_0x3933ff(0x1bb)},'expiry_date':{'$first':_0x3933ff(0x1c7)},'suppliers_docs':{'$first':_0x3933ff(0x19c)},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0x3933ff(0x1c9)},'isle':{'$addToSet':_0x3933ff(0x1cc)},'type':{'$addToSet':_0x3933ff(0x1c5)},'floorlevel':{'$addToSet':_0x3933ff(0x1ca)},'finalize':{'$first':_0x3933ff(0x1bf)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x2ad2e7},{'$limit':_0x54ed47-_0x2ad2e7}]),_0xc66874['json'](_0x456dac);}catch(_0x12b1f0){console[_0x3933ff(0x1c6)]('table\x20page',_0x12b1f0),_0xc66874[_0x3933ff(0x1cb)](0xc8)[_0x3933ff(0x197)]({'message':_0x12b1f0[_0x3933ff(0x193)]});}}),router[a0_0x4a0ba0(0x1b9)]('/barcode_scanner',async(_0x2a77d1,_0x32ea98)=>{const _0x14b7b2=a0_0x4a0ba0,{product_code:_0x3fc636}=_0x2a77d1[_0x14b7b2(0x195)];var _0x1736b6;const _0x1d0f8c=await product[_0x14b7b2(0x1a9)]([{'$match':{'primary_code':_0x3fc636,'product_category':_0x14b7b2(0x1b6)}},{'$group':{'_id':_0x14b7b2(0x1a6),'name':{'$first':_0x14b7b2(0x1b2)},'category':{'$first':'$category'},'brand':{'$first':_0x14b7b2(0x1b5)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x14b7b2(0x1b3)},'product_code':{'$first':_0x14b7b2(0x1b0)},'primary_code':{'$first':_0x14b7b2(0x1c2)},'secondary_code':{'$first':_0x14b7b2(0x1a4)},'maxStocks':{'$first':_0x14b7b2(0x1a3)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x14b7b2(0x1ba)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x4d5709=await product[_0x14b7b2(0x1a9)]([{'$match':{'secondary_code':_0x3fc636,'product_category':_0x14b7b2(0x1b6)}},{'$group':{'_id':_0x14b7b2(0x1a6),'name':{'$first':'$name'},'category':{'$first':_0x14b7b2(0x1bd)},'brand':{'$first':_0x14b7b2(0x1b5)},'unit':{'$first':_0x14b7b2(0x1a7)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x14b7b2(0x1b0)},'primary_code':{'$first':_0x14b7b2(0x1c2)},'secondary_code':{'$first':_0x14b7b2(0x1a4)},'maxStocks':{'$first':_0x14b7b2(0x1a3)},'maxProdPerUnit':{'$first':_0x14b7b2(0x1b1)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x1d0f8c['length']>0x0)_0x1736b6=_0x1d0f8c;else _0x4d5709['length']>0x0&&(_0x1736b6=_0x4d5709);_0x32ea98[_0x14b7b2(0x197)](_0x1736b6);}),module[a0_0x4a0ba0(0x19e)]=router;function a0_0x3f6c(){const _0x26115b=['$batch_code','$invoice','$category','8ZjQlSG','$finalize','$return_data','path','$primary_code','247475ZNdZAE','nodemailer','$product.type','log','$expiry_date','1616085zyhvnG','$product.bay','$product.floorlevel','status','$product.bin','6024wJXIBM','message','../models/all_models','body','1285731rTDLPH','json','start','query','490595qZqNld','/view','$suppliers_docs','get','exports','$date','$due_amount','express','1052ASJbHT','$maxStocks','$secondary_code','$warehouse_name','$_id','$unit','suppliers','aggregate','468158WUajhv','1608594qfWlmk','ejs','name','../middleware/auth','$suppliers','$product_code','$maxProdPerUnit','$name','$alertquantity','$product','$brand','Raw\x20Materials','$product.room_name','$note','post','$secondary_unit'];a0_0x3f6c=function(){return _0x26115b;};return a0_0x3f6c();}