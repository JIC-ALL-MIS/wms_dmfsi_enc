const a0_0x44accf=a0_0x39b4;(function(_0x415c11,_0x4ee0c5){const _0x16d273=a0_0x39b4,_0x9db091=_0x415c11();while(!![]){try{const _0x5e8f5c=-parseInt(_0x16d273(0xe7))/0x1*(parseInt(_0x16d273(0xd2))/0x2)+-parseInt(_0x16d273(0xd8))/0x3+-parseInt(_0x16d273(0xec))/0x4+-parseInt(_0x16d273(0xb5))/0x5*(parseInt(_0x16d273(0xcd))/0x6)+-parseInt(_0x16d273(0xc4))/0x7*(parseInt(_0x16d273(0xd7))/0x8)+-parseInt(_0x16d273(0xe8))/0x9+-parseInt(_0x16d273(0xca))/0xa*(-parseInt(_0x16d273(0xe9))/0xb);if(_0x5e8f5c===_0x4ee0c5)break;else _0x9db091['push'](_0x9db091['shift']());}catch(_0x325a54){_0x9db091['push'](_0x9db091['shift']());}}}(a0_0x42b2,0xdb7ea));function a0_0x42b2(){const _0x55c5c6=['$maxStocks','suppliers_docs','401insSpg','5776137URuxfv','80208887rZZpOx','../middleware/auth','$product.bin','4060672jTzTWI','$return_data','Router','$secondary_unit','../public/language/languages.json','$product','json','806385anfoQL','$product_code','name','$unit','exports','start','$warehouse_name','$suppliers_docs','$primary_code','$product.floorlevel','$name','$invoice','$batch_code','aggregate','$alertquantity','1615369LNvhtv','$suppliers','$_id','$due_amount','post','query','10QvwnVI','$product.bay','end','60hyMiVN','length','$product.quantity','table\x20page','$maxProdPerUnit','6158MxnJUQ','nodemailer','body','path','$date','56Alaehn','818664uJXkFE','$category','/view','$note','$product.type','$finalize','ejs','log','message','$secondary_code','$expiry_date','../models/all_models','$paid_amount'];a0_0x42b2=function(){return _0x55c5c6;};return a0_0x42b2();}const express=require('express'),app=express(),router=express[a0_0x44accf(0xee)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x44accf(0xe3)),auth=require(a0_0x44accf(0xea)),nodemailer=require(a0_0x44accf(0xd3));var ejs=require(a0_0x44accf(0xde));const path=require(a0_0x44accf(0xd5)),users=require(a0_0x44accf(0xb2));function a0_0x39b4(_0x510ae9,_0x3a561c){const _0x42b2e4=a0_0x42b2();return a0_0x39b4=function(_0x39b452,_0x4accf5){_0x39b452=_0x39b452-0xb2;let _0x555349=_0x42b2e4[_0x39b452];return _0x555349;},a0_0x39b4(_0x510ae9,_0x3a561c);}router['get'](a0_0x44accf(0xda),async(_0x2ad572,_0x59195b)=>{const _0x4501c0=a0_0x44accf;try{const _0x55954e=parseInt(_0x2ad572[_0x4501c0(0xc9)][_0x4501c0(0xba)])||0x0,_0x47e90d=parseInt(_0x2ad572['query'][_0x4501c0(0xcc)])||0xa;let _0x112750;_0x112750=await purchases[_0x4501c0(0xc2)]([{'$lookup':{'from':'suppliers','localField':'suppliers','foreignField':_0x4501c0(0xb7),'as':_0x4501c0(0xe6)}},{'$unwind':_0x4501c0(0xbc)},{'$unwind':_0x4501c0(0xb3)},{'$group':{'_id':_0x4501c0(0xc6),'invoice':{'$first':_0x4501c0(0xc0)},'suppliers':{'$first':_0x4501c0(0xc5)},'date':{'$first':_0x4501c0(0xd6)},'warehouse_name':{'$first':_0x4501c0(0xbb)},'room':{'$addToSet':'$product.room_name'},'product':{'$push':_0x4501c0(0xb3)},'note':{'$first':_0x4501c0(0xdb)},'paid_amount':{'$first':_0x4501c0(0xe4)},'due_amount':{'$first':_0x4501c0(0xc7)},'return_data':{'$first':_0x4501c0(0xed)},'batch_code':{'$first':_0x4501c0(0xc1)},'expiry_date':{'$first':_0x4501c0(0xe2)},'suppliers_docs':{'$first':_0x4501c0(0xbc)},'total_product_quantity':{'$sum':_0x4501c0(0xcf)},'level':{'$addToSet':_0x4501c0(0xcb)},'isle':{'$addToSet':_0x4501c0(0xeb)},'type':{'$addToSet':_0x4501c0(0xdc)},'floorlevel':{'$addToSet':_0x4501c0(0xbe)},'finalize':{'$first':_0x4501c0(0xdd)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x55954e},{'$limit':_0x47e90d-_0x55954e}]),_0x59195b[_0x4501c0(0xb4)](_0x112750);}catch(_0xdc0476){console[_0x4501c0(0xdf)](_0x4501c0(0xd0),_0xdc0476),_0x59195b['status'](0xc8)[_0x4501c0(0xb4)]({'message':_0xdc0476[_0x4501c0(0xe0)]});}}),router[a0_0x44accf(0xc8)]('/barcode_scanner',async(_0x526fe7,_0x5e4aab)=>{const _0x598e7f=a0_0x44accf,{product_code:_0x3db12b}=_0x526fe7[_0x598e7f(0xd4)];var _0x27ca9f;const _0x31f873=await product['aggregate']([{'$match':{'primary_code':_0x3db12b,'product_category':'Raw\x20Materials'}},{'$group':{'_id':'$_id','name':{'$first':_0x598e7f(0xbf)},'category':{'$first':_0x598e7f(0xd9)},'brand':{'$first':'$brand'},'unit':{'$first':'$unit'},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x598e7f(0xb6)},'primary_code':{'$first':_0x598e7f(0xbd)},'secondary_code':{'$first':_0x598e7f(0xe1)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x598e7f(0xd1)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x9a79a8=await product[_0x598e7f(0xc2)]([{'$match':{'secondary_code':_0x3db12b,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x598e7f(0xc6),'name':{'$first':_0x598e7f(0xbf)},'category':{'$first':_0x598e7f(0xd9)},'brand':{'$first':'$brand'},'unit':{'$first':_0x598e7f(0xb8)},'alertquantity':{'$first':_0x598e7f(0xc3)},'product_code':{'$first':_0x598e7f(0xb6)},'primary_code':{'$first':_0x598e7f(0xbd)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x598e7f(0xe5)},'maxProdPerUnit':{'$first':_0x598e7f(0xd1)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x598e7f(0xef)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x31f873[_0x598e7f(0xce)]>0x0)_0x27ca9f=_0x31f873;else _0x9a79a8[_0x598e7f(0xce)]>0x0&&(_0x27ca9f=_0x9a79a8);_0x5e4aab[_0x598e7f(0xb4)](_0x27ca9f);}),module[a0_0x44accf(0xb9)]=router;