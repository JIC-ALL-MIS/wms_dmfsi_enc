const a0_0x477fd9=a0_0xfbe7;(function(_0x25d68e,_0x36f3ce){const _0x18a026=a0_0xfbe7,_0x126580=_0x25d68e();while(!![]){try{const _0x1cfc9a=parseInt(_0x18a026(0x130))/0x1+-parseInt(_0x18a026(0x12b))/0x2+-parseInt(_0x18a026(0x142))/0x3*(parseInt(_0x18a026(0x121))/0x4)+-parseInt(_0x18a026(0x112))/0x5+parseInt(_0x18a026(0x12f))/0x6*(parseInt(_0x18a026(0x146))/0x7)+-parseInt(_0x18a026(0x11d))/0x8*(parseInt(_0x18a026(0x113))/0x9)+parseInt(_0x18a026(0x114))/0xa*(parseInt(_0x18a026(0x134))/0xb);if(_0x1cfc9a===_0x36f3ce)break;else _0x126580['push'](_0x126580['shift']());}catch(_0x21e3fe){_0x126580['push'](_0x126580['shift']());}}}(a0_0x2214,0x89e19));const express=require(a0_0x477fd9(0x126)),app=express(),router=express[a0_0x477fd9(0x141)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x477fd9(0x128)),auth=require(a0_0x477fd9(0x13c)),nodemailer=require(a0_0x477fd9(0x131));var ejs=require(a0_0x477fd9(0x11f));function a0_0xfbe7(_0x43b6c5,_0x29cc79){const _0x22141b=a0_0x2214();return a0_0xfbe7=function(_0xfbe7f5,_0x28669b){_0xfbe7f5=_0xfbe7f5-0x10d;let _0x10cf3a=_0x22141b[_0xfbe7f5];return _0x10cf3a;},a0_0xfbe7(_0x43b6c5,_0x29cc79);}const path=require('path'),users=require(a0_0x477fd9(0x137));function a0_0x2214(){const _0x107e85=['length','aggregate','$unit','14tOgMnb','$product','exports','$brand','$product_code','$secondary_unit','table\x20page','$name','$invoice','$product.quantity','593585KXWNAP','81DEhkxM','6879110KPjmdk','$maxStocks','query','$due_amount','get','/barcode_scanner','/view','$primary_code','$date','618552olJDAW','log','ejs','$product.floorlevel','4rxTESu','json','suppliers_docs','$product.bin','$_id','express','$secondary_code','../models/all_models','$product.type','name','1729340vZMskd','Raw\x20Materials','$expiry_date','$note','423042XKumFv','242703JIzuxK','nodemailer','end','message','33vsEwTD','post','$suppliers_docs','../public/language/languages.json','$finalize','$alertquantity','$product.bay','$warehouse_name','../middleware/auth','$product.room_name','$batch_code','$return_data','$maxProdPerUnit','Router','610293PxUOSF'];a0_0x2214=function(){return _0x107e85;};return a0_0x2214();}router[a0_0x477fd9(0x118)](a0_0x477fd9(0x11a),async(_0x14e59c,_0x166bdd)=>{const _0x19cb1e=a0_0x477fd9;try{const _0x469556=parseInt(_0x14e59c[_0x19cb1e(0x116)]['start'])||0x0,_0x49a85f=parseInt(_0x14e59c[_0x19cb1e(0x116)][_0x19cb1e(0x132)])||0xa;let _0x375b3d;_0x375b3d=await purchases[_0x19cb1e(0x144)]([{'$lookup':{'from':'suppliers','localField':'suppliers','foreignField':_0x19cb1e(0x12a),'as':_0x19cb1e(0x123)}},{'$unwind':'$suppliers_docs'},{'$unwind':_0x19cb1e(0x147)},{'$group':{'_id':_0x19cb1e(0x125),'invoice':{'$first':_0x19cb1e(0x110)},'suppliers':{'$first':'$suppliers'},'date':{'$first':_0x19cb1e(0x11c)},'warehouse_name':{'$first':_0x19cb1e(0x13b)},'room':{'$addToSet':_0x19cb1e(0x13d)},'product':{'$push':_0x19cb1e(0x147)},'note':{'$first':_0x19cb1e(0x12e)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x19cb1e(0x117)},'return_data':{'$first':_0x19cb1e(0x13f)},'batch_code':{'$first':_0x19cb1e(0x13e)},'expiry_date':{'$first':_0x19cb1e(0x12d)},'suppliers_docs':{'$first':_0x19cb1e(0x136)},'total_product_quantity':{'$sum':_0x19cb1e(0x111)},'level':{'$addToSet':_0x19cb1e(0x13a)},'isle':{'$addToSet':_0x19cb1e(0x124)},'type':{'$addToSet':_0x19cb1e(0x129)},'floorlevel':{'$addToSet':_0x19cb1e(0x120)},'finalize':{'$first':_0x19cb1e(0x138)}}},{'$sort':{'_id':0x1}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}},{'$skip':_0x469556},{'$limit':_0x49a85f-_0x469556}]),_0x166bdd['json'](_0x375b3d);}catch(_0x5629fa){console[_0x19cb1e(0x11e)](_0x19cb1e(0x10e),_0x5629fa),_0x166bdd['status'](0xc8)[_0x19cb1e(0x122)]({'message':_0x5629fa[_0x19cb1e(0x133)]});}}),router[a0_0x477fd9(0x135)](a0_0x477fd9(0x119),async(_0x1c593e,_0x2266e3)=>{const _0x25f377=a0_0x477fd9,{product_code:_0x3ac032}=_0x1c593e['body'];var _0x274c92;const _0x56e2c1=await product[_0x25f377(0x144)]([{'$match':{'primary_code':_0x3ac032,'product_category':_0x25f377(0x12c)}},{'$group':{'_id':_0x25f377(0x125),'name':{'$first':_0x25f377(0x10f)},'category':{'$first':'$category'},'brand':{'$first':'$brand'},'unit':{'$first':_0x25f377(0x145)},'alertquantity':{'$first':_0x25f377(0x139)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x25f377(0x115)},'maxProdPerUnit':{'$first':_0x25f377(0x140)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x1beafe=await product[_0x25f377(0x144)]([{'$match':{'secondary_code':_0x3ac032,'product_category':_0x25f377(0x12c)}},{'$group':{'_id':'$_id','name':{'$first':'$name'},'category':{'$first':'$category'},'brand':{'$first':_0x25f377(0x149)},'unit':{'$first':_0x25f377(0x145)},'alertquantity':{'$first':_0x25f377(0x139)},'product_code':{'$first':_0x25f377(0x14a)},'primary_code':{'$first':_0x25f377(0x11b)},'secondary_code':{'$first':_0x25f377(0x127)},'maxStocks':{'$first':_0x25f377(0x115)},'maxProdPerUnit':{'$first':_0x25f377(0x140)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x25f377(0x10d)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x56e2c1[_0x25f377(0x143)]>0x0)_0x274c92=_0x56e2c1;else _0x1beafe[_0x25f377(0x143)]>0x0&&(_0x274c92=_0x1beafe);_0x2266e3[_0x25f377(0x122)](_0x274c92);}),module[a0_0x477fd9(0x148)]=router;