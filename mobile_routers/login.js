const a0_0x5a7354=a0_0x140c;function a0_0x3af0(){const _0x19271b=['170pYbEFY','password','jsonwebtoken','7gPAOUx','exports','104CYezHN','../models/all_models','email','secret_key','env','sign','113800fTJHyo','1650546KsMAhQ','2RyJJDN','/logout','613974GcVuTY','redirect','body','post','jwt','staff','your\x20email\x20is\x20not\x20register','login\x20failed.','2077615NMzWNl','433191SzUdnG','/login','express','findOne','compare','status','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','login\x20successfully.','bcryptjs','../middleware/auth','66213wArfSX','json','1281444dvkEki','log','warehouse_category','username'];a0_0x3af0=function(){return _0x19271b;};return a0_0x3af0();}function a0_0x140c(_0x28e437,_0x47f1df){const _0x3af0bb=a0_0x3af0();return a0_0x140c=function(_0x140cdf,_0x367bae){_0x140cdf=_0x140cdf-0x107;let _0x2a8cf1=_0x3af0bb[_0x140cdf];return _0x2a8cf1;},a0_0x140c(_0x28e437,_0x47f1df);}(function(_0x4b4f05,_0x4646bb){const _0x4bef8e=a0_0x140c,_0x5c5415=_0x4b4f05();while(!![]){try{const _0x5cbf78=-parseInt(_0x4bef8e(0x114))/0x1+parseInt(_0x4bef8e(0x116))/0x2*(-parseInt(_0x4bef8e(0x115))/0x3)+-parseInt(_0x4bef8e(0x12d))/0x4+parseInt(_0x4bef8e(0x120))/0x5+-parseInt(_0x4bef8e(0x118))/0x6*(-parseInt(_0x4bef8e(0x10c))/0x7)+-parseInt(_0x4bef8e(0x10e))/0x8*(-parseInt(_0x4bef8e(0x12b))/0x9)+-parseInt(_0x4bef8e(0x109))/0xa*(-parseInt(_0x4bef8e(0x121))/0xb);if(_0x5cbf78===_0x4646bb)break;else _0x5c5415['push'](_0x5c5415['shift']());}catch(_0x696232){_0x5c5415['push'](_0x5c5415['shift']());}}}(a0_0x3af0,0x48e83));const express=require(a0_0x5a7354(0x123)),app=express(),router=express['Router'](),{sing_up,staff,profile,master_shop}=require(a0_0x5a7354(0x10f)),bcrypt=require(a0_0x5a7354(0x129)),jwt=require(a0_0x5a7354(0x10b)),auth=require(a0_0x5a7354(0x12a));router[a0_0x5a7354(0x11b)](a0_0x5a7354(0x122),async(_0x4e7560,_0x23abf6)=>{const _0x282e47=a0_0x5a7354;try{const _0x402331=_0x4e7560[_0x282e47(0x11a)]['email'],_0x3b8222=await sing_up[_0x282e47(0x124)]({'email':_0x402331});!_0x3b8222&&_0x23abf6['json']({'msgbox':_0x282e47(0x11e)});const _0x3e6bd8=await staff[_0x282e47(0x124)]({'email':_0x3b8222[_0x282e47(0x110)]});var _0x5539f8=_0x3e6bd8['warehouse_category'];if(_0x3b8222['role']==_0x282e47(0x11d)){const _0x37a3e7=await staff['findOne']({'email':_0x3b8222[_0x282e47(0x110)]});_0x37a3e7[_0x282e47(0x126)]=='Disabled'&&_0x23abf6[_0x282e47(0x12c)]({'msgbox':_0x282e47(0x127),'data':_0x3e6bd8}),_0x5539f8=_0x37a3e7[_0x282e47(0x107)];}const _0x290d34=_0x4e7560[_0x282e47(0x11a)][_0x282e47(0x10a)],_0x169807=await bcrypt[_0x282e47(0x125)](_0x290d34,_0x3b8222[_0x282e47(0x10a)]);_0x169807==![]&&_0x23abf6[_0x282e47(0x12c)]({'msgbox':_0x282e47(0x11f),'token':null,'isValid':_0x169807,'data':null});const _0x54af00=jwt[_0x282e47(0x113)]({'username':_0x3b8222[_0x282e47(0x108)],'email':_0x3b8222[_0x282e47(0x110)],'role':_0x3b8222['role'],'warehouse_category':_0x5539f8},process[_0x282e47(0x112)][_0x282e47(0x111)]);_0x23abf6['cookie'](_0x282e47(0x11c),_0x54af00,{'expires':new Date(0xe677d213a700)}),_0x23abf6[_0x282e47(0x12c)]({'msgbox':_0x282e47(0x128),'token':_0x54af00,'isValid':_0x169807,'data':_0x3e6bd8});}catch(_0x32a3e7){console[_0x282e47(0x12e)](_0x32a3e7);}}),router['get'](a0_0x5a7354(0x117),(_0x1ecc9e,_0x202435)=>{const _0x3281a8=a0_0x5a7354;_0x202435['clearCookie']('jwt'),_0x202435[_0x3281a8(0x119)](_0x3281a8(0x122));}),module[a0_0x5a7354(0x10d)]=router;