const a0_0x130458=a0_0x1086;function a0_0x6103(){const _0x54912b=['../middleware/auth','6JyiArv','bcryptjs','warehouse_category','Router','1547161duqhYT','login\x20successfully.','jwt','status','express','2402322WGRZyP','compare','5293632TaIHYP','get','password','/login','post','1717362Peyabx','email','93bTxCVW','login\x20failed.','/logout','username','clearCookie','64180DqfZds','83406VMtVCA','findOne','343240SlrEYm','role','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','staff','cookie','your\x20email\x20is\x20not\x20register','json','body'];a0_0x6103=function(){return _0x54912b;};return a0_0x6103();}(function(_0x1e17fa,_0x5a0d4e){const _0x43ed7c=a0_0x1086,_0x18e8a0=_0x1e17fa();while(!![]){try{const _0x8d5dcf=parseInt(_0x43ed7c(0x1ad))/0x1*(parseInt(_0x43ed7c(0x1a2))/0x2)+parseInt(_0x43ed7c(0x19c))/0x3*(-parseInt(_0x43ed7c(0x1a1))/0x4)+-parseInt(_0x43ed7c(0x1a4))/0x5+-parseInt(_0x43ed7c(0x1b6))/0x6+parseInt(_0x43ed7c(0x1b1))/0x7+parseInt(_0x43ed7c(0x1b8))/0x8+parseInt(_0x43ed7c(0x19a))/0x9;if(_0x8d5dcf===_0x5a0d4e)break;else _0x18e8a0['push'](_0x18e8a0['shift']());}catch(_0x502445){_0x18e8a0['push'](_0x18e8a0['shift']());}}}(a0_0x6103,0x573d5));function a0_0x1086(_0xb481f2,_0x8c000b){const _0x6103=a0_0x6103();return a0_0x1086=function(_0x108619,_0x269f1f){_0x108619=_0x108619-0x19a;let _0xfb9cb=_0x6103[_0x108619];return _0xfb9cb;},a0_0x1086(_0xb481f2,_0x8c000b);}const express=require(a0_0x130458(0x1b5)),app=express(),router=express[a0_0x130458(0x1b0)](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require(a0_0x130458(0x1ae)),jwt=require('jsonwebtoken'),auth=require(a0_0x130458(0x1ac));router[a0_0x130458(0x1bc)](a0_0x130458(0x1bb),async(_0x4f8eb8,_0x4766e7)=>{const _0x47e7d8=a0_0x130458;try{const _0x4281db=_0x4f8eb8[_0x47e7d8(0x1ab)][_0x47e7d8(0x19b)],_0x2d6191=await sing_up[_0x47e7d8(0x1a3)]({'email':_0x4281db});!_0x2d6191&&_0x4766e7['json']({'msgbox':_0x47e7d8(0x1a9)});const _0x32f1c3=await staff[_0x47e7d8(0x1a3)]({'email':_0x2d6191['email']});var _0x1d474c=_0x32f1c3[_0x47e7d8(0x1af)];if(_0x2d6191['role']==_0x47e7d8(0x1a7)){const _0x161c33=await staff[_0x47e7d8(0x1a3)]({'email':_0x2d6191[_0x47e7d8(0x19b)]});_0x161c33[_0x47e7d8(0x1b4)]=='Disabled'&&_0x4766e7[_0x47e7d8(0x1aa)]({'msgbox':_0x47e7d8(0x1a6),'data':_0x32f1c3}),_0x1d474c=_0x161c33[_0x47e7d8(0x1af)];}const _0x32b51f=_0x4f8eb8[_0x47e7d8(0x1ab)][_0x47e7d8(0x1ba)],_0x5d1758=await bcrypt[_0x47e7d8(0x1b7)](_0x32b51f,_0x2d6191['password']);_0x5d1758==![]&&_0x4766e7[_0x47e7d8(0x1aa)]({'msgbox':_0x47e7d8(0x19d),'token':null,'isValid':_0x5d1758,'data':null});const _0x40af1a=jwt['sign']({'username':_0x2d6191[_0x47e7d8(0x19f)],'email':_0x2d6191[_0x47e7d8(0x19b)],'role':_0x2d6191[_0x47e7d8(0x1a5)],'warehouse_category':_0x1d474c},process['env']['secret_key']);_0x4766e7[_0x47e7d8(0x1a8)](_0x47e7d8(0x1b3),_0x40af1a,{'expires':new Date(0xe677d213a700)}),_0x4766e7['json']({'msgbox':_0x47e7d8(0x1b2),'token':_0x40af1a,'isValid':_0x5d1758,'data':_0x32f1c3});}catch(_0x64e47e){console['log'](_0x64e47e);}}),router[a0_0x130458(0x1b9)](a0_0x130458(0x19e),(_0x118cbc,_0x4c7ec0)=>{const _0x4434e2=a0_0x130458;_0x4c7ec0[_0x4434e2(0x1a0)](_0x4434e2(0x1b3)),_0x4c7ec0['redirect']('/login');}),module['exports']=router;