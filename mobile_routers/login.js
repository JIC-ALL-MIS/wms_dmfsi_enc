const a0_0x1df8ba=a0_0x5adc;(function(_0x2d6d03,_0x46986c){const _0x3fff02=a0_0x5adc,_0x15c2b2=_0x2d6d03();while(!![]){try{const _0x304c04=-parseInt(_0x3fff02(0x1cf))/0x1+-parseInt(_0x3fff02(0x1db))/0x2*(parseInt(_0x3fff02(0x1c2))/0x3)+parseInt(_0x3fff02(0x1de))/0x4+-parseInt(_0x3fff02(0x1c1))/0x5*(-parseInt(_0x3fff02(0x1cd))/0x6)+-parseInt(_0x3fff02(0x1e2))/0x7+parseInt(_0x3fff02(0x1c3))/0x8+-parseInt(_0x3fff02(0x1d1))/0x9*(-parseInt(_0x3fff02(0x1d0))/0xa);if(_0x304c04===_0x46986c)break;else _0x15c2b2['push'](_0x15c2b2['shift']());}catch(_0x185c77){_0x15c2b2['push'](_0x15c2b2['shift']());}}}(a0_0x1138,0x758ae));function a0_0x5adc(_0x2edd3e,_0x3b87d5){const _0x1138af=a0_0x1138();return a0_0x5adc=function(_0x5adc06,_0x4c1ce7){_0x5adc06=_0x5adc06-0x1bf;let _0x30bee8=_0x1138af[_0x5adc06];return _0x30bee8;},a0_0x5adc(_0x2edd3e,_0x3b87d5);}function a0_0x1138(){const _0x4488e4=['json','434329JKZKhc','email','exports','66715zkkraE','21otqjWc','5516016SiVWxl','login\x20failed.','username','../models/all_models','Router','Disabled','warehouse_category','password','bcryptjs','redirect','6UKTRkW','status','881123XPNVrs','10nGpIdm','5577885kVpWIa','/login','env','secret_key','cookie','role','login\x20successfully.','jwt','express','../middleware/auth','117054ZkrDPt','body','clearCookie','2046812gbwsvd','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','findOne'];a0_0x1138=function(){return _0x4488e4;};return a0_0x1138();}const express=require(a0_0x1df8ba(0x1d9)),app=express(),router=express[a0_0x1df8ba(0x1c7)](),{sing_up,staff,profile,master_shop}=require(a0_0x1df8ba(0x1c6)),bcrypt=require(a0_0x1df8ba(0x1cb)),jwt=require('jsonwebtoken'),auth=require(a0_0x1df8ba(0x1da));router['post']('/login',async(_0x276f0f,_0x4cf660)=>{const _0x4f5114=a0_0x1df8ba;try{const _0x27948=_0x276f0f[_0x4f5114(0x1dc)][_0x4f5114(0x1bf)],_0x4660cd=await sing_up['findOne']({'email':_0x27948});!_0x4660cd&&_0x4cf660[_0x4f5114(0x1e1)]({'msgbox':'your\x20email\x20is\x20not\x20register'});const _0xae86e=await staff[_0x4f5114(0x1e0)]({'email':_0x4660cd[_0x4f5114(0x1bf)]});var _0x46c6d7=_0xae86e[_0x4f5114(0x1c9)];if(_0x4660cd['role']=='staff'){const _0x12bd33=await staff[_0x4f5114(0x1e0)]({'email':_0x4660cd[_0x4f5114(0x1bf)]});_0x12bd33[_0x4f5114(0x1ce)]==_0x4f5114(0x1c8)&&_0x4cf660[_0x4f5114(0x1e1)]({'msgbox':_0x4f5114(0x1df),'data':_0xae86e}),_0x46c6d7=_0x12bd33[_0x4f5114(0x1c9)];}const _0x8f3125=_0x276f0f['body'][_0x4f5114(0x1ca)],_0x4e6e18=await bcrypt['compare'](_0x8f3125,_0x4660cd[_0x4f5114(0x1ca)]);_0x4e6e18==![]&&_0x4cf660[_0x4f5114(0x1e1)]({'msgbox':_0x4f5114(0x1c4),'token':null,'isValid':_0x4e6e18,'data':null});const _0x1d5def=jwt['sign']({'username':_0x4660cd[_0x4f5114(0x1c5)],'email':_0x4660cd[_0x4f5114(0x1bf)],'role':_0x4660cd[_0x4f5114(0x1d6)],'warehouse_category':_0x46c6d7},process[_0x4f5114(0x1d3)][_0x4f5114(0x1d4)]);_0x4cf660[_0x4f5114(0x1d5)](_0x4f5114(0x1d8),_0x1d5def,{'expires':new Date(0xe677d213a700)}),_0x4cf660[_0x4f5114(0x1e1)]({'msgbox':_0x4f5114(0x1d7),'token':_0x1d5def,'isValid':_0x4e6e18,'data':_0xae86e});}catch(_0x5415e5){console['log'](_0x5415e5);}}),router['get']('/logout',(_0x2457aa,_0x3f5b71)=>{const _0x1d41c4=a0_0x1df8ba;_0x3f5b71[_0x1d41c4(0x1dd)](_0x1d41c4(0x1d8)),_0x3f5b71[_0x1d41c4(0x1cc)](_0x1d41c4(0x1d2));}),module[a0_0x1df8ba(0x1c0)]=router;