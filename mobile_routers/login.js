const a0_0x3397d4=a0_0x2525;function a0_0x4ae6(){const _0x19c956=['jwt','exports','warehouse_category','compare','17320992RCFjgn','login\x20successfully.','1614GpsvVa','cookie','4637773pPFLAY','status','log','express','4828885qlIcuU','secret_key','28662sEjlai','your\x20email\x20is\x20not\x20register','../middleware/auth','login\x20failed.','/logout','password','2567312wVAoyf','bcryptjs','Disabled','json','body','jsonwebtoken','get','Router','redirect','env','6195504JULqyG','email','role','1093RbxRiM','findOne','/login'];a0_0x4ae6=function(){return _0x19c956;};return a0_0x4ae6();}(function(_0x183657,_0x9227){const _0x1562f3=a0_0x2525,_0x1ad56e=_0x183657();while(!![]){try{const _0x19d6ae=-parseInt(_0x1562f3(0x170))/0x1*(-parseInt(_0x1562f3(0x155))/0x2)+-parseInt(_0x1562f3(0x15d))/0x3+parseInt(_0x1562f3(0x163))/0x4+parseInt(_0x1562f3(0x15b))/0x5+parseInt(_0x1562f3(0x16d))/0x6+-parseInt(_0x1562f3(0x157))/0x7+-parseInt(_0x1562f3(0x153))/0x8;if(_0x19d6ae===_0x9227)break;else _0x1ad56e['push'](_0x1ad56e['shift']());}catch(_0x3ef6da){_0x1ad56e['push'](_0x1ad56e['shift']());}}}(a0_0x4ae6,0xa73df));const express=require(a0_0x3397d4(0x15a)),app=express(),router=express[a0_0x3397d4(0x16a)](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require(a0_0x3397d4(0x164)),jwt=require(a0_0x3397d4(0x168)),auth=require(a0_0x3397d4(0x15f));function a0_0x2525(_0x37b115,_0xf343b5){const _0x4ae6d4=a0_0x4ae6();return a0_0x2525=function(_0x25257e,_0x4b8120){_0x25257e=_0x25257e-0x152;let _0x444ecb=_0x4ae6d4[_0x25257e];return _0x444ecb;},a0_0x2525(_0x37b115,_0xf343b5);}router['post'](a0_0x3397d4(0x172),async(_0x7bf6c9,_0x5b15e6)=>{const _0x5c2b4a=a0_0x3397d4;try{const _0x4a590e=_0x7bf6c9[_0x5c2b4a(0x167)][_0x5c2b4a(0x16e)],_0x187b4a=await sing_up[_0x5c2b4a(0x171)]({'email':_0x4a590e});!_0x187b4a&&_0x5b15e6[_0x5c2b4a(0x166)]({'msgbox':_0x5c2b4a(0x15e)});const _0xe5d154=await staff[_0x5c2b4a(0x171)]({'email':_0x187b4a['email']});var _0x2e2ee1=_0xe5d154[_0x5c2b4a(0x175)];if(_0x187b4a[_0x5c2b4a(0x16f)]=='staff'){const _0x17aacb=await staff['findOne']({'email':_0x187b4a[_0x5c2b4a(0x16e)]});_0x17aacb[_0x5c2b4a(0x158)]==_0x5c2b4a(0x165)&&_0x5b15e6[_0x5c2b4a(0x166)]({'msgbox':'Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','data':_0xe5d154}),_0x2e2ee1=_0x17aacb[_0x5c2b4a(0x175)];}const _0x1972e6=_0x7bf6c9[_0x5c2b4a(0x167)][_0x5c2b4a(0x162)],_0x2c1150=await bcrypt[_0x5c2b4a(0x152)](_0x1972e6,_0x187b4a['password']);_0x2c1150==![]&&_0x5b15e6['json']({'msgbox':_0x5c2b4a(0x160),'token':null,'isValid':_0x2c1150,'data':null});const _0x44e910=jwt['sign']({'username':_0x187b4a['username'],'email':_0x187b4a[_0x5c2b4a(0x16e)],'role':_0x187b4a[_0x5c2b4a(0x16f)],'warehouse_category':_0x2e2ee1},process[_0x5c2b4a(0x16c)][_0x5c2b4a(0x15c)]);_0x5b15e6[_0x5c2b4a(0x156)](_0x5c2b4a(0x173),_0x44e910,{'expires':new Date(0xe677d213a700)}),_0x5b15e6[_0x5c2b4a(0x166)]({'msgbox':_0x5c2b4a(0x154),'token':_0x44e910,'isValid':_0x2c1150,'data':_0xe5d154});}catch(_0x544e6e){console[_0x5c2b4a(0x159)](_0x544e6e);}}),router[a0_0x3397d4(0x169)](a0_0x3397d4(0x161),(_0x2249fe,_0x3254cc)=>{const _0x4c3d95=a0_0x3397d4;_0x3254cc['clearCookie'](_0x4c3d95(0x173)),_0x3254cc[_0x4c3d95(0x16b)](_0x4c3d95(0x172));}),module[a0_0x3397d4(0x174)]=router;