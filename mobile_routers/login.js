const a0_0x55e358=a0_0x2e7d;function a0_0x2e7d(_0x216345,_0x5916dd){const _0x1243c2=a0_0x1243();return a0_0x2e7d=function(_0x2e7d0c,_0x5c2130){_0x2e7d0c=_0x2e7d0c-0x113;let _0x177c0d=_0x1243c2[_0x2e7d0c];return _0x177c0d;},a0_0x2e7d(_0x216345,_0x5916dd);}(function(_0x5007cb,_0x4dbefb){const _0xa87cc3=a0_0x2e7d,_0x514b00=_0x5007cb();while(!![]){try{const _0x3e3b55=parseInt(_0xa87cc3(0x12e))/0x1*(-parseInt(_0xa87cc3(0x131))/0x2)+-parseInt(_0xa87cc3(0x126))/0x3*(-parseInt(_0xa87cc3(0x11f))/0x4)+-parseInt(_0xa87cc3(0x121))/0x5*(parseInt(_0xa87cc3(0x139))/0x6)+-parseInt(_0xa87cc3(0x113))/0x7*(parseInt(_0xa87cc3(0x114))/0x8)+-parseInt(_0xa87cc3(0x136))/0x9*(parseInt(_0xa87cc3(0x11d))/0xa)+-parseInt(_0xa87cc3(0x130))/0xb+-parseInt(_0xa87cc3(0x120))/0xc*(-parseInt(_0xa87cc3(0x135))/0xd);if(_0x3e3b55===_0x4dbefb)break;else _0x514b00['push'](_0x514b00['shift']());}catch(_0x55b4a6){_0x514b00['push'](_0x514b00['shift']());}}}(a0_0x1243,0x5e879));function a0_0x1243(){const _0xeb71ed=['6577142WHXlIm','4294oxIozR','staff','jsonwebtoken','secret_key','24358997bMVitj','64638dNhyrv','Router','cookie','111846EAJMlV','bcryptjs','your\x20email\x20is\x20not\x20register','findOne','95354DmZMkY','112lEBCOd','../models/all_models','exports','sign','get','json','redirect','clearCookie','login\x20failed.','390rxLTtn','log','4QhGaUg','12UimMHl','45YGRqCl','compare','express','password','email','1117653zibMZX','status','/login','jwt','role','username','warehouse_category','/logout','290EnQgTo','body'];a0_0x1243=function(){return _0xeb71ed;};return a0_0x1243();}const express=require(a0_0x55e358(0x123)),app=express(),router=express[a0_0x55e358(0x137)](),{sing_up,staff,profile,master_shop}=require(a0_0x55e358(0x115)),bcrypt=require(a0_0x55e358(0x13a)),jwt=require(a0_0x55e358(0x133)),auth=require('../middleware/auth');router['post']('/login',async(_0x2fdc8f,_0x231310)=>{const _0x1ce310=a0_0x55e358;try{const _0x355b4e=_0x2fdc8f[_0x1ce310(0x12f)][_0x1ce310(0x125)],_0x3eaff1=await sing_up[_0x1ce310(0x13c)]({'email':_0x355b4e});!_0x3eaff1&&_0x231310[_0x1ce310(0x119)]({'msgbox':_0x1ce310(0x13b)});const _0x8db158=await staff[_0x1ce310(0x13c)]({'email':_0x3eaff1[_0x1ce310(0x125)]});var _0x11efa3=_0x8db158[_0x1ce310(0x12c)];if(_0x3eaff1['role']==_0x1ce310(0x132)){const _0x8d2abb=await staff[_0x1ce310(0x13c)]({'email':_0x3eaff1['email']});_0x8d2abb[_0x1ce310(0x127)]=='Disabled'&&_0x231310['json']({'msgbox':'Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','data':_0x8db158}),_0x11efa3=_0x8d2abb[_0x1ce310(0x12c)];}const _0x3c6fec=_0x2fdc8f[_0x1ce310(0x12f)][_0x1ce310(0x124)],_0x1f71de=await bcrypt[_0x1ce310(0x122)](_0x3c6fec,_0x3eaff1[_0x1ce310(0x124)]);_0x1f71de==![]&&_0x231310[_0x1ce310(0x119)]({'msgbox':_0x1ce310(0x11c),'token':null,'isValid':_0x1f71de,'data':null});const _0x45f167=jwt[_0x1ce310(0x117)]({'username':_0x3eaff1[_0x1ce310(0x12b)],'email':_0x3eaff1['email'],'role':_0x3eaff1[_0x1ce310(0x12a)],'warehouse_category':_0x11efa3},process['env'][_0x1ce310(0x134)]);_0x231310[_0x1ce310(0x138)]('jwt',_0x45f167,{'expires':new Date(0xe677d213a700)}),_0x231310[_0x1ce310(0x119)]({'msgbox':'login\x20successfully.','token':_0x45f167,'isValid':_0x1f71de,'data':_0x8db158});}catch(_0xc00034){console[_0x1ce310(0x11e)](_0xc00034);}}),router[a0_0x55e358(0x118)](a0_0x55e358(0x12d),(_0x60d51c,_0x169d0d)=>{const _0x335425=a0_0x55e358;_0x169d0d[_0x335425(0x11b)](_0x335425(0x129)),_0x169d0d[_0x335425(0x11a)](_0x335425(0x128));}),module[a0_0x55e358(0x116)]=router;