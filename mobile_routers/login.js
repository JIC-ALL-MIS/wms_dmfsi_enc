const a0_0x3ad0e8=a0_0x4a06;(function(_0x4b1f57,_0x27d8b0){const _0x13dc6b=a0_0x4a06,_0x136b35=_0x4b1f57();while(!![]){try{const _0xcd59de=-parseInt(_0x13dc6b(0xc4))/0x1*(-parseInt(_0x13dc6b(0xc8))/0x2)+-parseInt(_0x13dc6b(0xbe))/0x3+parseInt(_0x13dc6b(0xb4))/0x4*(-parseInt(_0x13dc6b(0xc9))/0x5)+-parseInt(_0x13dc6b(0xbf))/0x6+-parseInt(_0x13dc6b(0xc5))/0x7+-parseInt(_0x13dc6b(0xcb))/0x8+parseInt(_0x13dc6b(0xbd))/0x9*(parseInt(_0x13dc6b(0xc3))/0xa);if(_0xcd59de===_0x27d8b0)break;else _0x136b35['push'](_0x136b35['shift']());}catch(_0x250086){_0x136b35['push'](_0x136b35['shift']());}}}(a0_0x3da6,0x3b919));function a0_0x3da6(){const _0x144895=['login\x20successfully.','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','sign','password','status','jwt','43304CAmAff','json','Router','env','jsonwebtoken','post','staff','../middleware/auth','role','10250010QxCBIN','147939XxOUZA','1358136gCPdkn','email','express','exports','10Fssegl','2MnAQoe','2380203DvFXea','log','bcryptjs','52900fkokAv','70zsAYTL','get','1444280KPSWQg','compare','Disabled','secret_key','clearCookie','warehouse_category','findOne','/login','redirect'];a0_0x3da6=function(){return _0x144895;};return a0_0x3da6();}const express=require(a0_0x3ad0e8(0xc1)),app=express(),router=express[a0_0x3ad0e8(0xb6)](),{sing_up,staff,profile,master_shop}=require('../models/all_models'),bcrypt=require(a0_0x3ad0e8(0xc7)),jwt=require(a0_0x3ad0e8(0xb8)),auth=require(a0_0x3ad0e8(0xbb));function a0_0x4a06(_0x39c680,_0x11f8de){const _0x3da6c9=a0_0x3da6();return a0_0x4a06=function(_0x4a0657,_0x58c529){_0x4a0657=_0x4a0657-0xb2;let _0x318304=_0x3da6c9[_0x4a0657];return _0x318304;},a0_0x4a06(_0x39c680,_0x11f8de);}router[a0_0x3ad0e8(0xb9)](a0_0x3ad0e8(0xd2),async(_0x20920d,_0x2c8b79)=>{const _0x4ceaa8=a0_0x3ad0e8;try{const _0xaf7297=_0x20920d['body']['email'],_0x23d06e=await sing_up['findOne']({'email':_0xaf7297});!_0x23d06e&&_0x2c8b79[_0x4ceaa8(0xb5)]({'msgbox':'your\x20email\x20is\x20not\x20register'});const _0x2fab09=await staff[_0x4ceaa8(0xd1)]({'email':_0x23d06e[_0x4ceaa8(0xc0)]});var _0x5ec37e=_0x2fab09['warehouse_category'];if(_0x23d06e[_0x4ceaa8(0xbc)]==_0x4ceaa8(0xba)){const _0x493751=await staff['findOne']({'email':_0x23d06e['email']});_0x493751[_0x4ceaa8(0xb2)]==_0x4ceaa8(0xcd)&&_0x2c8b79[_0x4ceaa8(0xb5)]({'msgbox':_0x4ceaa8(0xd5),'data':_0x2fab09}),_0x5ec37e=_0x493751[_0x4ceaa8(0xd0)];}const _0x34c964=_0x20920d['body'][_0x4ceaa8(0xd7)],_0x42130c=await bcrypt[_0x4ceaa8(0xcc)](_0x34c964,_0x23d06e[_0x4ceaa8(0xd7)]);_0x42130c==![]&&_0x2c8b79[_0x4ceaa8(0xb5)]({'msgbox':'login\x20failed.','token':null,'isValid':_0x42130c,'data':null});const _0x39d7de=jwt[_0x4ceaa8(0xd6)]({'username':_0x23d06e['username'],'email':_0x23d06e['email'],'role':_0x23d06e[_0x4ceaa8(0xbc)],'warehouse_category':_0x5ec37e},process[_0x4ceaa8(0xb7)][_0x4ceaa8(0xce)]);_0x2c8b79['cookie'](_0x4ceaa8(0xb3),_0x39d7de,{'expires':new Date(0xe677d213a700)}),_0x2c8b79[_0x4ceaa8(0xb5)]({'msgbox':_0x4ceaa8(0xd4),'token':_0x39d7de,'isValid':_0x42130c,'data':_0x2fab09});}catch(_0x3b4623){console[_0x4ceaa8(0xc6)](_0x3b4623);}}),router[a0_0x3ad0e8(0xca)]('/logout',(_0x1aa6d9,_0x308644)=>{const _0x2eeea6=a0_0x3ad0e8;_0x308644[_0x2eeea6(0xcf)](_0x2eeea6(0xb3)),_0x308644[_0x2eeea6(0xd3)]('/login');}),module[a0_0x3ad0e8(0xc2)]=router;