const a0_0x539e86=a0_0x3d36;function a0_0x18c0(){const _0xf74be6=['bcryptjs','your\x20email\x20is\x20not\x20register','9jIrfrH','body','../middleware/auth','secret_key','log','json','clearCookie','/logout','email','findOne','jwt','cookie','411108GWFwMf','Disabled','get','/login','../models/all_models','jsonwebtoken','redirect','Router','password','post','login\x20successfully.','100185vDnQpC','20LgolbQ','sign','Your\x20account\x20is\x20currently\x20disabled\x20by\x20the\x20Admin.','1382710TPBOEI','951174bhTumJ','warehouse_category','7004392fiROgB','username','role','compare','624520XfcbZL','3985650APCZZn'];a0_0x18c0=function(){return _0xf74be6;};return a0_0x18c0();}function a0_0x3d36(_0x129696,_0x277d8b){const _0x18c0e5=a0_0x18c0();return a0_0x3d36=function(_0x3d36ce,_0x4ed9df){_0x3d36ce=_0x3d36ce-0x9b;let _0xcbf449=_0x18c0e5[_0x3d36ce];return _0xcbf449;},a0_0x3d36(_0x129696,_0x277d8b);}(function(_0x391f12,_0x45f07b){const _0x3b4f6d=a0_0x3d36,_0x26512d=_0x391f12();while(!![]){try{const _0x45a228=parseInt(_0x3b4f6d(0xad))/0x1+parseInt(_0x3b4f6d(0xbd))/0x2+parseInt(_0x3b4f6d(0xa2))/0x3*(parseInt(_0x3b4f6d(0xa3))/0x4)+-parseInt(_0x3b4f6d(0xa6))/0x5+parseInt(_0x3b4f6d(0xae))/0x6+-parseInt(_0x3b4f6d(0xa7))/0x7+parseInt(_0x3b4f6d(0xa9))/0x8*(-parseInt(_0x3b4f6d(0xb1))/0x9);if(_0x45a228===_0x45f07b)break;else _0x26512d['push'](_0x26512d['shift']());}catch(_0x2dba88){_0x26512d['push'](_0x26512d['shift']());}}}(a0_0x18c0,0x5b267));const express=require('express'),app=express(),router=express[a0_0x539e86(0x9e)](),{sing_up,staff,profile,master_shop}=require(a0_0x539e86(0x9b)),bcrypt=require(a0_0x539e86(0xaf)),jwt=require(a0_0x539e86(0x9c)),auth=require(a0_0x539e86(0xb3));router[a0_0x539e86(0xa0)](a0_0x539e86(0xc0),async(_0x5d2203,_0x290155)=>{const _0x466200=a0_0x539e86;try{const _0x56fa54=_0x5d2203[_0x466200(0xb2)][_0x466200(0xb9)],_0x534cea=await sing_up['findOne']({'email':_0x56fa54});!_0x534cea&&_0x290155['json']({'msgbox':_0x466200(0xb0)});const _0x17265a=await staff[_0x466200(0xba)]({'email':_0x534cea[_0x466200(0xb9)]});var _0x156dc1=_0x17265a[_0x466200(0xa8)];if(_0x534cea[_0x466200(0xab)]=='staff'){const _0x31a081=await staff[_0x466200(0xba)]({'email':_0x534cea[_0x466200(0xb9)]});_0x31a081['status']==_0x466200(0xbe)&&_0x290155[_0x466200(0xb6)]({'msgbox':_0x466200(0xa5),'data':_0x17265a}),_0x156dc1=_0x31a081[_0x466200(0xa8)];}const _0x55a6b9=_0x5d2203[_0x466200(0xb2)][_0x466200(0x9f)],_0x242756=await bcrypt[_0x466200(0xac)](_0x55a6b9,_0x534cea[_0x466200(0x9f)]);_0x242756==![]&&_0x290155[_0x466200(0xb6)]({'msgbox':'login\x20failed.','token':null,'isValid':_0x242756,'data':null});const _0x5c13e7=jwt[_0x466200(0xa4)]({'username':_0x534cea[_0x466200(0xaa)],'email':_0x534cea['email'],'role':_0x534cea[_0x466200(0xab)],'warehouse_category':_0x156dc1},process['env'][_0x466200(0xb4)]);_0x290155[_0x466200(0xbc)](_0x466200(0xbb),_0x5c13e7,{'expires':new Date(0xe677d213a700)}),_0x290155[_0x466200(0xb6)]({'msgbox':_0x466200(0xa1),'token':_0x5c13e7,'isValid':_0x242756,'data':_0x17265a});}catch(_0x19ba1d){console[_0x466200(0xb5)](_0x19ba1d);}}),router[a0_0x539e86(0xbf)](a0_0x539e86(0xb8),(_0x2a6991,_0x47c987)=>{const _0x4c92ce=a0_0x539e86;_0x47c987[_0x4c92ce(0xb7)](_0x4c92ce(0xbb)),_0x47c987[_0x4c92ce(0x9d)](_0x4c92ce(0xc0));}),module['exports']=router;